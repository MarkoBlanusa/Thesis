{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 0.00010000000000000002, "total_loss": -0.0609374166589061, "policy_loss": 0.08939616360302105, "vf_loss": 0.029234690431674773, "vf_explained_var": 0.7103762502020056, "kl": 0.2708262487500958, "entropy": 16.7567312448675, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 981350, "num_env_steps_trained": 981350, "num_agent_steps_sampled": 981350, "num_agent_steps_trained": 981350}, "sampler_results": {"episode_reward_max": 25.970871476491663, "episode_reward_min": 20.2708302309076, "episode_reward_mean": 23.075712397519474, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.413129778181343, 23.536743492438205, 22.379344457631387, 24.90506228653632, 25.970871476491663, 23.794822139158423, 20.2708302309076, 22.501956106180963, 21.62223452155007, 23.261274840795984, 22.304984447512297, 24.927881722725353, 23.940327677627174, 22.230510387535826], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3409978586056033, "mean_inference_ms": 7.696635227144877, "mean_action_processing_ms": 0.5324616201875035, "mean_env_wait_ms": 24.060611130177985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014317035675048828, "StateBufferConnector_ms": 0.03573894500732422, "ViewRequirementAgentConnector_ms": 1.0861550058637346}}, "episode_reward_max": 25.970871476491663, "episode_reward_min": 20.2708302309076, "episode_reward_mean": 23.075712397519474, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.413129778181343, 23.536743492438205, 22.379344457631387, 24.90506228653632, 25.970871476491663, 23.794822139158423, 20.2708302309076, 22.501956106180963, 21.62223452155007, 23.261274840795984, 22.304984447512297, 24.927881722725353, 23.940327677627174, 22.230510387535826], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3409978586056033, "mean_inference_ms": 7.696635227144877, "mean_action_processing_ms": 0.5324616201875035, "mean_env_wait_ms": 24.060611130177985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014317035675048828, "StateBufferConnector_ms": 0.03573894500732422, "ViewRequirementAgentConnector_ms": 1.0861550058637346}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 981350, "num_agent_steps_trained": 981350, "num_env_steps_sampled": 981350, "num_env_steps_trained": 981350, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 270.5445851859429, "num_env_steps_trained_throughput_per_sec": 270.5445851859429, "timesteps_total": 981350, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 981350, "timers": {"training_iteration_time_ms": 57801.933, "sample_time_ms": 42569.892, "load_time_ms": 3589.319, "load_throughput": 4356.816, "learn_time_ms": 10990.657, "learn_throughput": 1422.845, "synch_weights_time_ms": 418.811}, "counters": {"num_env_steps_sampled": 981350, "num_env_steps_trained": 981350, "num_agent_steps_sampled": 981350, "num_agent_steps_trained": 981350}, "done": false, "episodes_total": 14, "training_iteration": 67, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-30-16", "timestamp": 1749241816, "time_this_iter_s": 57.813920736312866, "time_total_s": 57.813920736312866, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 57.813920736312866, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 74.67352941176472, "ram_util_percent": 63.4735294117647, "gpu_util_percent0": 0.07102941176470588, "vram_util_percent0": 0.12743183210784315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.046875, "cur_lr": 9.018649999999997e-05, "total_loss": -0.08711100830823522, "policy_loss": 0.015790892474628476, "vf_loss": 0.019704839452593163, "vf_explained_var": 0.7819139242172242, "kl": 0.06526080428877143, "entropy": 16.62583155892112, "entropy_coeff": 0.006728833333333336}, "model": {}, "num_grad_updates_lifetime": 825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 996988, "num_env_steps_trained": 996988, "num_agent_steps_sampled": 996988, "num_agent_steps_trained": 996988}, "sampler_results": {"episode_reward_max": 25.970871476491663, "episode_reward_min": 18.725239934123408, "episode_reward_mean": 22.64721185940754, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.413129778181343, 23.536743492438205, 22.379344457631387, 24.90506228653632, 25.970871476491663, 23.794822139158423, 20.2708302309076, 22.501956106180963, 21.62223452155007, 23.261274840795984, 22.304984447512297, 24.927881722725353, 23.940327677627174, 22.230510387535826, 22.66674454785223, 24.92038835483226, 20.12649201801178, 23.939076379181028, 19.62171158467943, 22.754106356778394, 22.402068436951275, 24.457083887553317, 22.010018652875836, 18.725239934123408, 24.630360832743534, 23.251088094233943, 21.25019186287259, 20.307387555449345], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.28270050522483, "mean_inference_ms": 7.672852472472333, "mean_action_processing_ms": 0.5274900109875061, "mean_env_wait_ms": 23.81475261986206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019257409232003347, "StateBufferConnector_ms": 0.028545515877859935, "ViewRequirementAgentConnector_ms": 1.0127672127314977}}, "episode_reward_max": 25.970871476491663, "episode_reward_min": 18.725239934123408, "episode_reward_mean": 22.64721185940754, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.413129778181343, 23.536743492438205, 22.379344457631387, 24.90506228653632, 25.970871476491663, 23.794822139158423, 20.2708302309076, 22.501956106180963, 21.62223452155007, 23.261274840795984, 22.304984447512297, 24.927881722725353, 23.940327677627174, 22.230510387535826, 22.66674454785223, 24.92038835483226, 20.12649201801178, 23.939076379181028, 19.62171158467943, 22.754106356778394, 22.402068436951275, 24.457083887553317, 22.010018652875836, 18.725239934123408, 24.630360832743534, 23.251088094233943, 21.25019186287259, 20.307387555449345], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.28270050522483, "mean_inference_ms": 7.672852472472333, "mean_action_processing_ms": 0.5274900109875061, "mean_env_wait_ms": 23.81475261986206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019257409232003347, "StateBufferConnector_ms": 0.028545515877859935, "ViewRequirementAgentConnector_ms": 1.0127672127314977}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996988, "num_agent_steps_trained": 996988, "num_env_steps_sampled": 996988, "num_env_steps_trained": 996988, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 290.39500843362947, "num_env_steps_trained_throughput_per_sec": 290.39500843362947, "timesteps_total": 996988, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 996988, "timers": {"training_iteration_time_ms": 55826.36, "sample_time_ms": 41428.952, "load_time_ms": 2862.515, "load_throughput": 5463.028, "learn_time_ms": 10916.261, "learn_throughput": 1432.542, "synch_weights_time_ms": 429.466}, "counters": {"num_env_steps_sampled": 996988, "num_env_steps_trained": 996988, "num_agent_steps_sampled": 996988, "num_agent_steps_trained": 996988}, "done": false, "episodes_total": 28, "training_iteration": 68, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-31-09", "timestamp": 1749241869, "time_this_iter_s": 53.863810777664185, "time_total_s": 111.67773151397705, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 111.67773151397705, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 76.68548387096776, "ram_util_percent": 70.60806451612906, "gpu_util_percent0": 0.08096774193548387, "vram_util_percent0": 0.5520833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0703125, "cur_lr": 9.003012e-05, "total_loss": -0.08817304678811606, "policy_loss": 0.014728257577146657, "vf_loss": 0.016413717015053737, "vf_explained_var": 0.8222900775345889, "kl": 0.05857643942475658, "entropy": 16.76636138049039, "entropy_coeff": 0.006676706666666669}, "model": {}, "num_grad_updates_lifetime": 1375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1012626, "num_env_steps_trained": 1012626, "num_agent_steps_sampled": 1012626, "num_agent_steps_trained": 1012626}, "sampler_results": {"episode_reward_max": 25.970871476491663, "episode_reward_min": 18.725239934123408, "episode_reward_mean": 22.818245729799337, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.413129778181343, 23.536743492438205, 22.379344457631387, 24.90506228653632, 25.970871476491663, 23.794822139158423, 20.2708302309076, 22.501956106180963, 21.62223452155007, 23.261274840795984, 22.304984447512297, 24.927881722725353, 23.940327677627174, 22.230510387535826, 22.66674454785223, 24.92038835483226, 20.12649201801178, 23.939076379181028, 19.62171158467943, 22.754106356778394, 22.402068436951275, 24.457083887553317, 22.010018652875836, 18.725239934123408, 24.630360832743534, 23.251088094233943, 21.25019186287259, 20.307387555449345, 24.203244074834213, 22.698960080202998, 20.536411894833186, 24.42062552316341, 22.767772213720708, 23.37766052395094, 23.770605101361767, 24.752470963944738, 24.532764424780137, 23.253794434233786, 22.368628332738076, 22.78137351900695, 22.347794131541374, 22.43228336984888], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2513343432171276, "mean_inference_ms": 7.6639318547682285, "mean_action_processing_ms": 0.5259238850359572, "mean_env_wait_ms": 23.704777190513557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017612888699486143, "StateBufferConnector_ms": 0.023835045950753347, "ViewRequirementAgentConnector_ms": 0.9325265884399414}}, "episode_reward_max": 25.970871476491663, "episode_reward_min": 18.725239934123408, "episode_reward_mean": 22.818245729799337, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.413129778181343, 23.536743492438205, 22.379344457631387, 24.90506228653632, 25.970871476491663, 23.794822139158423, 20.2708302309076, 22.501956106180963, 21.62223452155007, 23.261274840795984, 22.304984447512297, 24.927881722725353, 23.940327677627174, 22.230510387535826, 22.66674454785223, 24.92038835483226, 20.12649201801178, 23.939076379181028, 19.62171158467943, 22.754106356778394, 22.402068436951275, 24.457083887553317, 22.010018652875836, 18.725239934123408, 24.630360832743534, 23.251088094233943, 21.25019186287259, 20.307387555449345, 24.203244074834213, 22.698960080202998, 20.536411894833186, 24.42062552316341, 22.767772213720708, 23.37766052395094, 23.770605101361767, 24.752470963944738, 24.532764424780137, 23.253794434233786, 22.368628332738076, 22.78137351900695, 22.347794131541374, 22.43228336984888], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2513343432171276, "mean_inference_ms": 7.6639318547682285, "mean_action_processing_ms": 0.5259238850359572, "mean_env_wait_ms": 23.704777190513557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017612888699486143, "StateBufferConnector_ms": 0.023835045950753347, "ViewRequirementAgentConnector_ms": 0.9325265884399414}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1012626, "num_agent_steps_trained": 1012626, "num_env_steps_sampled": 1012626, "num_env_steps_trained": 1012626, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 291.446431540111, "num_env_steps_trained_throughput_per_sec": 291.446431540111, "timesteps_total": 1012626, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1012626, "timers": {"training_iteration_time_ms": 55103.079, "sample_time_ms": 41079.319, "load_time_ms": 2580.068, "load_throughput": 6061.081, "learn_time_ms": 10842.132, "learn_throughput": 1442.336, "synch_weights_time_ms": 437.932}, "counters": {"num_env_steps_sampled": 1012626, "num_env_steps_trained": 1012626, "num_agent_steps_sampled": 1012626, "num_agent_steps_trained": 1012626}, "done": false, "episodes_total": 42, "training_iteration": 69, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-32-03", "timestamp": 1749241923, "time_this_iter_s": 53.672502517700195, "time_total_s": 165.35023403167725, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 165.35023403167725, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 77.47419354838712, "ram_util_percent": 69.54354838709679, "gpu_util_percent0": 0.07645161290322582, "vram_util_percent0": 0.8592122395833335}}
{"evaluation": {"sampler_results": {"episode_reward_max": 1.1652724748753842, "episode_reward_min": -4.3477569739637305, "episode_reward_mean": -1.0816834851505237, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3235701676087266, 0.5241997433396356, -0.4265625023951806, 1.1652724748753842, -4.3477569739637305], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4982070777884784, "mean_inference_ms": 3.646038254231506, "mean_action_processing_ms": 0.28268806838575067, "mean_env_wait_ms": 10.820673032381636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3799581527709961}}, "episode_reward_max": 1.1652724748753842, "episode_reward_min": -4.3477569739637305, "episode_reward_mean": -1.0816834851505237, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3235701676087266, 0.5241997433396356, -0.4265625023951806, 1.1652724748753842, -4.3477569739637305], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4982070777884784, "mean_inference_ms": 3.646038254231506, "mean_action_processing_ms": 0.28268806838575067, "mean_env_wait_ms": 10.820673032381636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3799581527709961}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10546875, "cur_lr": 8.987374000000002e-05, "total_loss": -0.0853696029565551, "policy_loss": 0.015519243823919995, "vf_loss": 0.01731764598495581, "vf_explained_var": 0.8330879217928107, "kl": 0.05087020916145117, "entropy": 16.823611578507858, "entropy_coeff": 0.006624579999999999}, "model": {}, "num_grad_updates_lifetime": 1925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1028264, "num_env_steps_trained": 1028264, "num_agent_steps_sampled": 1028264, "num_agent_steps_trained": 1028264}, "sampler_results": {"episode_reward_max": 25.970871476491663, "episode_reward_min": 18.725239934123408, "episode_reward_mean": 22.69961830781181, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.413129778181343, 23.536743492438205, 22.379344457631387, 24.90506228653632, 25.970871476491663, 23.794822139158423, 20.2708302309076, 22.501956106180963, 21.62223452155007, 23.261274840795984, 22.304984447512297, 24.927881722725353, 23.940327677627174, 22.230510387535826, 22.66674454785223, 24.92038835483226, 20.12649201801178, 23.939076379181028, 19.62171158467943, 22.754106356778394, 22.402068436951275, 24.457083887553317, 22.010018652875836, 18.725239934123408, 24.630360832743534, 23.251088094233943, 21.25019186287259, 20.307387555449345, 24.203244074834213, 22.698960080202998, 20.536411894833186, 24.42062552316341, 22.767772213720708, 23.37766052395094, 23.770605101361767, 24.752470963944738, 24.532764424780137, 23.253794434233786, 22.368628332738076, 22.78137351900695, 22.347794131541374, 22.43228336984888, 22.09637385345212, 22.304743455875357, 25.637466759033163, 21.331323637445685, 23.306887434864876, 23.13763987780974, 20.648530062265948, 19.895195958915757, 23.065980090668774, 19.33720934325314, 22.536518506887507, 24.048878043895193, 22.016953458739387, 23.448604102782557], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.234031013994488, "mean_inference_ms": 7.668287552451225, "mean_action_processing_ms": 0.5254178035274002, "mean_env_wait_ms": 23.66327484714631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020372867584228516, "StateBufferConnector_ms": 0.031831009047372, "ViewRequirementAgentConnector_ms": 0.9831581796918597}}, "episode_reward_max": 25.970871476491663, "episode_reward_min": 18.725239934123408, "episode_reward_mean": 22.69961830781181, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.413129778181343, 23.536743492438205, 22.379344457631387, 24.90506228653632, 25.970871476491663, 23.794822139158423, 20.2708302309076, 22.501956106180963, 21.62223452155007, 23.261274840795984, 22.304984447512297, 24.927881722725353, 23.940327677627174, 22.230510387535826, 22.66674454785223, 24.92038835483226, 20.12649201801178, 23.939076379181028, 19.62171158467943, 22.754106356778394, 22.402068436951275, 24.457083887553317, 22.010018652875836, 18.725239934123408, 24.630360832743534, 23.251088094233943, 21.25019186287259, 20.307387555449345, 24.203244074834213, 22.698960080202998, 20.536411894833186, 24.42062552316341, 22.767772213720708, 23.37766052395094, 23.770605101361767, 24.752470963944738, 24.532764424780137, 23.253794434233786, 22.368628332738076, 22.78137351900695, 22.347794131541374, 22.43228336984888, 22.09637385345212, 22.304743455875357, 25.637466759033163, 21.331323637445685, 23.306887434864876, 23.13763987780974, 20.648530062265948, 19.895195958915757, 23.065980090668774, 19.33720934325314, 22.536518506887507, 24.048878043895193, 22.016953458739387, 23.448604102782557], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.234031013994488, "mean_inference_ms": 7.668287552451225, "mean_action_processing_ms": 0.5254178035274002, "mean_env_wait_ms": 23.66327484714631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020372867584228516, "StateBufferConnector_ms": 0.031831009047372, "ViewRequirementAgentConnector_ms": 0.9831581796918597}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1028264, "num_agent_steps_trained": 1028264, "num_env_steps_sampled": 1028264, "num_env_steps_trained": 1028264, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 287.39915478071754, "num_env_steps_trained_throughput_per_sec": 287.39915478071754, "timesteps_total": 1028264, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1028264, "timers": {"training_iteration_time_ms": 54930.341, "sample_time_ms": 41099.666, "load_time_ms": 2431.543, "load_throughput": 6431.307, "learn_time_ms": 10812.699, "learn_throughput": 1446.262, "synch_weights_time_ms": 435.183}, "counters": {"num_env_steps_sampled": 1028264, "num_env_steps_trained": 1028264, "num_agent_steps_sampled": 1028264, "num_agent_steps_trained": 1028264}, "done": false, "episodes_total": 56, "training_iteration": 70, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-33-13", "timestamp": 1749241993, "time_this_iter_s": 69.55463576316833, "time_total_s": 234.90486979484558, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 234.90486979484558, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 64.42317073170732, "ram_util_percent": 69.48658536585364, "gpu_util_percent0": 0.06609756097560976, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.158203125, "cur_lr": 8.971736e-05, "total_loss": -0.10428136513356796, "policy_loss": -0.004615811118002801, "vf_loss": 0.01684012582483278, "vf_explained_var": 0.8471851605718786, "kl": 0.0422933527903512, "entropy": 16.950829183405094, "entropy_coeff": 0.006572453333333333}, "model": {}, "num_grad_updates_lifetime": 2475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1043902, "num_env_steps_trained": 1043902, "num_agent_steps_sampled": 1043902, "num_agent_steps_trained": 1043902}, "sampler_results": {"episode_reward_max": 25.970871476491663, "episode_reward_min": 18.725239934123408, "episode_reward_mean": 22.65249200121173, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.413129778181343, 23.536743492438205, 22.379344457631387, 24.90506228653632, 25.970871476491663, 23.794822139158423, 20.2708302309076, 22.501956106180963, 21.62223452155007, 23.261274840795984, 22.304984447512297, 24.927881722725353, 23.940327677627174, 22.230510387535826, 22.66674454785223, 24.92038835483226, 20.12649201801178, 23.939076379181028, 19.62171158467943, 22.754106356778394, 22.402068436951275, 24.457083887553317, 22.010018652875836, 18.725239934123408, 24.630360832743534, 23.251088094233943, 21.25019186287259, 20.307387555449345, 24.203244074834213, 22.698960080202998, 20.536411894833186, 24.42062552316341, 22.767772213720708, 23.37766052395094, 23.770605101361767, 24.752470963944738, 24.532764424780137, 23.253794434233786, 22.368628332738076, 22.78137351900695, 22.347794131541374, 22.43228336984888, 22.09637385345212, 22.304743455875357, 25.637466759033163, 21.331323637445685, 23.306887434864876, 23.13763987780974, 20.648530062265948, 19.895195958915757, 23.065980090668774, 19.33720934325314, 22.536518506887507, 24.048878043895193, 22.016953458739387, 23.448604102782557, 24.58190009506521, 21.608166532090284, 20.683665900125913, 23.664139585742408, 20.807549478167015, 24.901300632447963, 21.928585319826922, 24.23557474570301, 23.829787708267293, 20.263079960259528, 24.277252982243944, 22.160359056884843, 20.98430078960285, 20.57015206093271], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.219114803386073, "mean_inference_ms": 7.671533878902627, "mean_action_processing_ms": 0.5253426938963109, "mean_env_wait_ms": 23.632104968781054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02490724836077009, "StateBufferConnector_ms": 0.02689361572265625, "ViewRequirementAgentConnector_ms": 0.964397702898298}}, "episode_reward_max": 25.970871476491663, "episode_reward_min": 18.725239934123408, "episode_reward_mean": 22.65249200121173, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.413129778181343, 23.536743492438205, 22.379344457631387, 24.90506228653632, 25.970871476491663, 23.794822139158423, 20.2708302309076, 22.501956106180963, 21.62223452155007, 23.261274840795984, 22.304984447512297, 24.927881722725353, 23.940327677627174, 22.230510387535826, 22.66674454785223, 24.92038835483226, 20.12649201801178, 23.939076379181028, 19.62171158467943, 22.754106356778394, 22.402068436951275, 24.457083887553317, 22.010018652875836, 18.725239934123408, 24.630360832743534, 23.251088094233943, 21.25019186287259, 20.307387555449345, 24.203244074834213, 22.698960080202998, 20.536411894833186, 24.42062552316341, 22.767772213720708, 23.37766052395094, 23.770605101361767, 24.752470963944738, 24.532764424780137, 23.253794434233786, 22.368628332738076, 22.78137351900695, 22.347794131541374, 22.43228336984888, 22.09637385345212, 22.304743455875357, 25.637466759033163, 21.331323637445685, 23.306887434864876, 23.13763987780974, 20.648530062265948, 19.895195958915757, 23.065980090668774, 19.33720934325314, 22.536518506887507, 24.048878043895193, 22.016953458739387, 23.448604102782557, 24.58190009506521, 21.608166532090284, 20.683665900125913, 23.664139585742408, 20.807549478167015, 24.901300632447963, 21.928585319826922, 24.23557474570301, 23.829787708267293, 20.263079960259528, 24.277252982243944, 22.160359056884843, 20.98430078960285, 20.57015206093271], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.219114803386073, "mean_inference_ms": 7.671533878902627, "mean_action_processing_ms": 0.5253426938963109, "mean_env_wait_ms": 23.632104968781054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02490724836077009, "StateBufferConnector_ms": 0.02689361572265625, "ViewRequirementAgentConnector_ms": 0.964397702898298}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1043902, "num_agent_steps_trained": 1043902, "num_env_steps_sampled": 1043902, "num_env_steps_trained": 1043902, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 291.9080174993871, "num_env_steps_trained_throughput_per_sec": 291.9080174993871, "timesteps_total": 1043902, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1043902, "timers": {"training_iteration_time_ms": 54658.607, "sample_time_ms": 41013.752, "load_time_ms": 2322.437, "load_throughput": 6733.444, "learn_time_ms": 10746.004, "learn_throughput": 1455.239, "synch_weights_time_ms": 424.754}, "counters": {"num_env_steps_sampled": 1043902, "num_env_steps_trained": 1043902, "num_agent_steps_sampled": 1043902, "num_agent_steps_trained": 1043902}, "done": false, "episodes_total": 70, "training_iteration": 71, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-34-06", "timestamp": 1749242046, "time_this_iter_s": 53.5871479511261, "time_total_s": 288.4920177459717, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 288.4920177459717, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 76.45161290322581, "ram_util_percent": 70.10645161290323, "gpu_util_percent0": 0.07806451612903227, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2373046875, "cur_lr": 8.956098e-05, "total_loss": -0.09554549619005147, "policy_loss": 0.001327245855460536, "vf_loss": 0.014437648515978998, "vf_explained_var": 0.8702028247443112, "kl": 0.03849917160575141, "entropy": 16.922475551258433, "entropy_coeff": 0.006520326666666666}, "model": {}, "num_grad_updates_lifetime": 3025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1059540, "num_env_steps_trained": 1059540, "num_agent_steps_sampled": 1059540, "num_agent_steps_trained": 1059540}, "sampler_results": {"episode_reward_max": 25.970871476491663, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.642958661216124, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.413129778181343, 23.536743492438205, 22.379344457631387, 24.90506228653632, 25.970871476491663, 23.794822139158423, 20.2708302309076, 22.501956106180963, 21.62223452155007, 23.261274840795984, 22.304984447512297, 24.927881722725353, 23.940327677627174, 22.230510387535826, 22.66674454785223, 24.92038835483226, 20.12649201801178, 23.939076379181028, 19.62171158467943, 22.754106356778394, 22.402068436951275, 24.457083887553317, 22.010018652875836, 18.725239934123408, 24.630360832743534, 23.251088094233943, 21.25019186287259, 20.307387555449345, 24.203244074834213, 22.698960080202998, 20.536411894833186, 24.42062552316341, 22.767772213720708, 23.37766052395094, 23.770605101361767, 24.752470963944738, 24.532764424780137, 23.253794434233786, 22.368628332738076, 22.78137351900695, 22.347794131541374, 22.43228336984888, 22.09637385345212, 22.304743455875357, 25.637466759033163, 21.331323637445685, 23.306887434864876, 23.13763987780974, 20.648530062265948, 19.895195958915757, 23.065980090668774, 19.33720934325314, 22.536518506887507, 24.048878043895193, 22.016953458739387, 23.448604102782557, 24.58190009506521, 21.608166532090284, 20.683665900125913, 23.664139585742408, 20.807549478167015, 24.901300632447963, 21.928585319826922, 24.23557474570301, 23.829787708267293, 20.263079960259528, 24.277252982243944, 22.160359056884843, 20.98430078960285, 20.57015206093271, 20.669128785959288, 24.112912101230265, 20.69039253136415, 23.310208909846654, 21.028755794891083, 22.037102945274963, 25.10109473175017, 23.631580506447133, 24.766413371367282, 22.89169277894475, 25.288268368703314, 22.399901692846445, 18.102214443706476, 22.304420495001295], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.208889861618146, "mean_inference_ms": 7.672461019094086, "mean_action_processing_ms": 0.5254644773420927, "mean_env_wait_ms": 23.60600487562079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02998397463843936, "StateBufferConnector_ms": 0.030022008078438894, "ViewRequirementAgentConnector_ms": 1.0086130528222947}}, "episode_reward_max": 25.970871476491663, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.642958661216124, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.413129778181343, 23.536743492438205, 22.379344457631387, 24.90506228653632, 25.970871476491663, 23.794822139158423, 20.2708302309076, 22.501956106180963, 21.62223452155007, 23.261274840795984, 22.304984447512297, 24.927881722725353, 23.940327677627174, 22.230510387535826, 22.66674454785223, 24.92038835483226, 20.12649201801178, 23.939076379181028, 19.62171158467943, 22.754106356778394, 22.402068436951275, 24.457083887553317, 22.010018652875836, 18.725239934123408, 24.630360832743534, 23.251088094233943, 21.25019186287259, 20.307387555449345, 24.203244074834213, 22.698960080202998, 20.536411894833186, 24.42062552316341, 22.767772213720708, 23.37766052395094, 23.770605101361767, 24.752470963944738, 24.532764424780137, 23.253794434233786, 22.368628332738076, 22.78137351900695, 22.347794131541374, 22.43228336984888, 22.09637385345212, 22.304743455875357, 25.637466759033163, 21.331323637445685, 23.306887434864876, 23.13763987780974, 20.648530062265948, 19.895195958915757, 23.065980090668774, 19.33720934325314, 22.536518506887507, 24.048878043895193, 22.016953458739387, 23.448604102782557, 24.58190009506521, 21.608166532090284, 20.683665900125913, 23.664139585742408, 20.807549478167015, 24.901300632447963, 21.928585319826922, 24.23557474570301, 23.829787708267293, 20.263079960259528, 24.277252982243944, 22.160359056884843, 20.98430078960285, 20.57015206093271, 20.669128785959288, 24.112912101230265, 20.69039253136415, 23.310208909846654, 21.028755794891083, 22.037102945274963, 25.10109473175017, 23.631580506447133, 24.766413371367282, 22.89169277894475, 25.288268368703314, 22.399901692846445, 18.102214443706476, 22.304420495001295], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.208889861618146, "mean_inference_ms": 7.672461019094086, "mean_action_processing_ms": 0.5254644773420927, "mean_env_wait_ms": 23.60600487562079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02998397463843936, "StateBufferConnector_ms": 0.030022008078438894, "ViewRequirementAgentConnector_ms": 1.0086130528222947}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1059540, "num_agent_steps_trained": 1059540, "num_env_steps_sampled": 1059540, "num_env_steps_trained": 1059540, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 286.8764541707277, "num_env_steps_trained_throughput_per_sec": 286.8764541707277, "timesteps_total": 1059540, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1059540, "timers": {"training_iteration_time_ms": 54634.051, "sample_time_ms": 40966.395, "load_time_ms": 2276.522, "load_throughput": 6869.252, "learn_time_ms": 10814.318, "learn_throughput": 1446.046, "synch_weights_time_ms": 432.515}, "counters": {"num_env_steps_sampled": 1059540, "num_env_steps_trained": 1059540, "num_agent_steps_sampled": 1059540, "num_agent_steps_trained": 1059540}, "done": false, "episodes_total": 84, "training_iteration": 72, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-35-01", "timestamp": 1749242101, "time_this_iter_s": 54.52728247642517, "time_total_s": 343.01930022239685, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 343.01930022239685, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 77.50322580645162, "ram_util_percent": 70.40322580645162, "gpu_util_percent0": 0.08129032258064518, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.35595703125, "cur_lr": 8.940459999999999e-05, "total_loss": -0.09676305439492518, "policy_loss": -0.0035132268277547236, "vf_loss": 0.01604112279305065, "vf_explained_var": 0.8544377451593226, "kl": 0.032633605589882174, "entropy": 16.956544971466066, "entropy_coeff": 0.0064682}, "model": {}, "num_grad_updates_lifetime": 3575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1075178, "num_env_steps_trained": 1075178, "num_agent_steps_sampled": 1075178, "num_agent_steps_trained": 1075178}, "sampler_results": {"episode_reward_max": 25.970871476491663, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.559819492473448, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.413129778181343, 23.536743492438205, 22.379344457631387, 24.90506228653632, 25.970871476491663, 23.794822139158423, 20.2708302309076, 22.501956106180963, 21.62223452155007, 23.261274840795984, 22.304984447512297, 24.927881722725353, 23.940327677627174, 22.230510387535826, 22.66674454785223, 24.92038835483226, 20.12649201801178, 23.939076379181028, 19.62171158467943, 22.754106356778394, 22.402068436951275, 24.457083887553317, 22.010018652875836, 18.725239934123408, 24.630360832743534, 23.251088094233943, 21.25019186287259, 20.307387555449345, 24.203244074834213, 22.698960080202998, 20.536411894833186, 24.42062552316341, 22.767772213720708, 23.37766052395094, 23.770605101361767, 24.752470963944738, 24.532764424780137, 23.253794434233786, 22.368628332738076, 22.78137351900695, 22.347794131541374, 22.43228336984888, 22.09637385345212, 22.304743455875357, 25.637466759033163, 21.331323637445685, 23.306887434864876, 23.13763987780974, 20.648530062265948, 19.895195958915757, 23.065980090668774, 19.33720934325314, 22.536518506887507, 24.048878043895193, 22.016953458739387, 23.448604102782557, 24.58190009506521, 21.608166532090284, 20.683665900125913, 23.664139585742408, 20.807549478167015, 24.901300632447963, 21.928585319826922, 24.23557474570301, 23.829787708267293, 20.263079960259528, 24.277252982243944, 22.160359056884843, 20.98430078960285, 20.57015206093271, 20.669128785959288, 24.112912101230265, 20.69039253136415, 23.310208909846654, 21.028755794891083, 22.037102945274963, 25.10109473175017, 23.631580506447133, 24.766413371367282, 22.89169277894475, 25.288268368703314, 22.399901692846445, 18.102214443706476, 22.304420495001295, 21.672815948845702, 23.34076949009847, 21.220168393502444, 22.738075802344834, 20.99244876609409, 24.877147625587575, 23.714888053623955, 20.802947644165954, 19.898177030091734, 23.517270870802903, 21.827491597808006, 20.875732662654528, 21.276818845677614, 22.09902998894544], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2046987674907657, "mean_inference_ms": 7.698379003941357, "mean_action_processing_ms": 0.5270757830991415, "mean_env_wait_ms": 23.640925131568014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03387879352180325, "StateBufferConnector_ms": 0.03079832816610531, "ViewRequirementAgentConnector_ms": 0.974186829158238}}, "episode_reward_max": 25.970871476491663, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.559819492473448, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.413129778181343, 23.536743492438205, 22.379344457631387, 24.90506228653632, 25.970871476491663, 23.794822139158423, 20.2708302309076, 22.501956106180963, 21.62223452155007, 23.261274840795984, 22.304984447512297, 24.927881722725353, 23.940327677627174, 22.230510387535826, 22.66674454785223, 24.92038835483226, 20.12649201801178, 23.939076379181028, 19.62171158467943, 22.754106356778394, 22.402068436951275, 24.457083887553317, 22.010018652875836, 18.725239934123408, 24.630360832743534, 23.251088094233943, 21.25019186287259, 20.307387555449345, 24.203244074834213, 22.698960080202998, 20.536411894833186, 24.42062552316341, 22.767772213720708, 23.37766052395094, 23.770605101361767, 24.752470963944738, 24.532764424780137, 23.253794434233786, 22.368628332738076, 22.78137351900695, 22.347794131541374, 22.43228336984888, 22.09637385345212, 22.304743455875357, 25.637466759033163, 21.331323637445685, 23.306887434864876, 23.13763987780974, 20.648530062265948, 19.895195958915757, 23.065980090668774, 19.33720934325314, 22.536518506887507, 24.048878043895193, 22.016953458739387, 23.448604102782557, 24.58190009506521, 21.608166532090284, 20.683665900125913, 23.664139585742408, 20.807549478167015, 24.901300632447963, 21.928585319826922, 24.23557474570301, 23.829787708267293, 20.263079960259528, 24.277252982243944, 22.160359056884843, 20.98430078960285, 20.57015206093271, 20.669128785959288, 24.112912101230265, 20.69039253136415, 23.310208909846654, 21.028755794891083, 22.037102945274963, 25.10109473175017, 23.631580506447133, 24.766413371367282, 22.89169277894475, 25.288268368703314, 22.399901692846445, 18.102214443706476, 22.304420495001295, 21.672815948845702, 23.34076949009847, 21.220168393502444, 22.738075802344834, 20.99244876609409, 24.877147625587575, 23.714888053623955, 20.802947644165954, 19.898177030091734, 23.517270870802903, 21.827491597808006, 20.875732662654528, 21.276818845677614, 22.09902998894544], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2046987674907657, "mean_inference_ms": 7.698379003941357, "mean_action_processing_ms": 0.5270757830991415, "mean_env_wait_ms": 23.640925131568014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03387879352180325, "StateBufferConnector_ms": 0.03079832816610531, "ViewRequirementAgentConnector_ms": 0.974186829158238}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1075178, "num_agent_steps_trained": 1075178, "num_env_steps_sampled": 1075178, "num_env_steps_trained": 1075178, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 261.71473670387877, "num_env_steps_trained_throughput_per_sec": 261.71473670387877, "timesteps_total": 1075178, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1075178, "timers": {"training_iteration_time_ms": 55365.198, "sample_time_ms": 41581.288, "load_time_ms": 2230.916, "load_throughput": 7009.676, "learn_time_ms": 10983.724, "learn_throughput": 1423.743, "synch_weights_time_ms": 429.596}, "counters": {"num_env_steps_sampled": 1075178, "num_env_steps_trained": 1075178, "num_agent_steps_sampled": 1075178, "num_agent_steps_trained": 1075178}, "done": false, "episodes_total": 98, "training_iteration": 73, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-36-01", "timestamp": 1749242161, "time_this_iter_s": 59.77208209037781, "time_total_s": 402.79138231277466, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 402.79138231277466, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 77.93970588235294, "ram_util_percent": 70.85147058823529, "gpu_util_percent0": 0.07470588235294119, "vram_util_percent0": 0.8592122395833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.924821999999998e-05, "total_loss": -0.0929767839987339, "policy_loss": -0.0038724436387763653, "vf_loss": 0.016715336383997716, "vf_explained_var": 0.8734609695998106, "kl": 0.027639251389035734, "entropy": 16.969338065060704, "entropy_coeff": 0.006416073333333334}, "model": {}, "num_grad_updates_lifetime": 4125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1090816, "num_env_steps_trained": 1090816, "num_agent_steps_sampled": 1090816, "num_agent_steps_trained": 1090816}, "sampler_results": {"episode_reward_max": 25.637466759033163, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.53263296550189, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.940327677627174, 22.230510387535826, 22.66674454785223, 24.92038835483226, 20.12649201801178, 23.939076379181028, 19.62171158467943, 22.754106356778394, 22.402068436951275, 24.457083887553317, 22.010018652875836, 18.725239934123408, 24.630360832743534, 23.251088094233943, 21.25019186287259, 20.307387555449345, 24.203244074834213, 22.698960080202998, 20.536411894833186, 24.42062552316341, 22.767772213720708, 23.37766052395094, 23.770605101361767, 24.752470963944738, 24.532764424780137, 23.253794434233786, 22.368628332738076, 22.78137351900695, 22.347794131541374, 22.43228336984888, 22.09637385345212, 22.304743455875357, 25.637466759033163, 21.331323637445685, 23.306887434864876, 23.13763987780974, 20.648530062265948, 19.895195958915757, 23.065980090668774, 19.33720934325314, 22.536518506887507, 24.048878043895193, 22.016953458739387, 23.448604102782557, 24.58190009506521, 21.608166532090284, 20.683665900125913, 23.664139585742408, 20.807549478167015, 24.901300632447963, 21.928585319826922, 24.23557474570301, 23.829787708267293, 20.263079960259528, 24.277252982243944, 22.160359056884843, 20.98430078960285, 20.57015206093271, 20.669128785959288, 24.112912101230265, 20.69039253136415, 23.310208909846654, 21.028755794891083, 22.037102945274963, 25.10109473175017, 23.631580506447133, 24.766413371367282, 22.89169277894475, 25.288268368703314, 22.399901692846445, 18.102214443706476, 22.304420495001295, 21.672815948845702, 23.34076949009847, 21.220168393502444, 22.738075802344834, 20.99244876609409, 24.877147625587575, 23.714888053623955, 20.802947644165954, 19.898177030091734, 23.517270870802903, 21.827491597808006, 20.875732662654528, 21.276818845677614, 22.09902998894544, 20.03602391652661, 20.248328917952243, 23.52289456285049, 21.141414572752165, 22.008344256556356, 23.955449483816917, 21.86823057363579, 22.28933948970024, 24.01236961854361, 22.45273979572666, 24.665092327334634, 23.61340311107874, 24.039635287537894, 25.436855873888145], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1886919930896545, "mean_inference_ms": 7.7228582900444405, "mean_action_processing_ms": 0.5276982078213326, "mean_env_wait_ms": 23.6246930132704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036177873611450195, "StateBufferConnector_ms": 0.029184341430664062, "ViewRequirementAgentConnector_ms": 0.9478731155395508}}, "episode_reward_max": 25.637466759033163, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.53263296550189, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.940327677627174, 22.230510387535826, 22.66674454785223, 24.92038835483226, 20.12649201801178, 23.939076379181028, 19.62171158467943, 22.754106356778394, 22.402068436951275, 24.457083887553317, 22.010018652875836, 18.725239934123408, 24.630360832743534, 23.251088094233943, 21.25019186287259, 20.307387555449345, 24.203244074834213, 22.698960080202998, 20.536411894833186, 24.42062552316341, 22.767772213720708, 23.37766052395094, 23.770605101361767, 24.752470963944738, 24.532764424780137, 23.253794434233786, 22.368628332738076, 22.78137351900695, 22.347794131541374, 22.43228336984888, 22.09637385345212, 22.304743455875357, 25.637466759033163, 21.331323637445685, 23.306887434864876, 23.13763987780974, 20.648530062265948, 19.895195958915757, 23.065980090668774, 19.33720934325314, 22.536518506887507, 24.048878043895193, 22.016953458739387, 23.448604102782557, 24.58190009506521, 21.608166532090284, 20.683665900125913, 23.664139585742408, 20.807549478167015, 24.901300632447963, 21.928585319826922, 24.23557474570301, 23.829787708267293, 20.263079960259528, 24.277252982243944, 22.160359056884843, 20.98430078960285, 20.57015206093271, 20.669128785959288, 24.112912101230265, 20.69039253136415, 23.310208909846654, 21.028755794891083, 22.037102945274963, 25.10109473175017, 23.631580506447133, 24.766413371367282, 22.89169277894475, 25.288268368703314, 22.399901692846445, 18.102214443706476, 22.304420495001295, 21.672815948845702, 23.34076949009847, 21.220168393502444, 22.738075802344834, 20.99244876609409, 24.877147625587575, 23.714888053623955, 20.802947644165954, 19.898177030091734, 23.517270870802903, 21.827491597808006, 20.875732662654528, 21.276818845677614, 22.09902998894544, 20.03602391652661, 20.248328917952243, 23.52289456285049, 21.141414572752165, 22.008344256556356, 23.955449483816917, 21.86823057363579, 22.28933948970024, 24.01236961854361, 22.45273979572666, 24.665092327334634, 23.61340311107874, 24.039635287537894, 25.436855873888145], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1886919930896545, "mean_inference_ms": 7.7228582900444405, "mean_action_processing_ms": 0.5276982078213326, "mean_env_wait_ms": 23.6246930132704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036177873611450195, "StateBufferConnector_ms": 0.029184341430664062, "ViewRequirementAgentConnector_ms": 0.9478731155395508}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1090816, "num_agent_steps_trained": 1090816, "num_env_steps_sampled": 1090816, "num_env_steps_trained": 1090816, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.1971997488894, "num_env_steps_trained_throughput_per_sec": 284.1971997488894, "timesteps_total": 1090816, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1090816, "timers": {"training_iteration_time_ms": 55322.695, "sample_time_ms": 41537.081, "load_time_ms": 2209.518, "load_throughput": 7077.563, "learn_time_ms": 11012.362, "learn_throughput": 1420.041, "synch_weights_time_ms": 427.702}, "counters": {"num_env_steps_sampled": 1090816, "num_env_steps_trained": 1090816, "num_agent_steps_sampled": 1090816, "num_agent_steps_trained": 1090816}, "done": false, "episodes_total": 112, "training_iteration": 74, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-36-56", "timestamp": 1749242216, "time_this_iter_s": 55.04517984390259, "time_total_s": 457.83656215667725, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 457.83656215667725, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 76.15396825396826, "ram_util_percent": 68.93015873015874, "gpu_util_percent0": 0.08095238095238096, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.909184000000001e-05, "total_loss": -0.09918424198149957, "policy_loss": -0.009867309357485449, "vf_loss": 0.014989095124924048, "vf_explained_var": 0.8661901769854806, "kl": 0.02741060252471035, "entropy": 17.041179826909847, "entropy_coeff": 0.006363946666666668}, "model": {}, "num_grad_updates_lifetime": 4675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1106454, "num_env_steps_trained": 1106454, "num_agent_steps_sampled": 1106454, "num_agent_steps_trained": 1106454}, "sampler_results": {"episode_reward_max": 25.637466759033163, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.46990397375764, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.25019186287259, 20.307387555449345, 24.203244074834213, 22.698960080202998, 20.536411894833186, 24.42062552316341, 22.767772213720708, 23.37766052395094, 23.770605101361767, 24.752470963944738, 24.532764424780137, 23.253794434233786, 22.368628332738076, 22.78137351900695, 22.347794131541374, 22.43228336984888, 22.09637385345212, 22.304743455875357, 25.637466759033163, 21.331323637445685, 23.306887434864876, 23.13763987780974, 20.648530062265948, 19.895195958915757, 23.065980090668774, 19.33720934325314, 22.536518506887507, 24.048878043895193, 22.016953458739387, 23.448604102782557, 24.58190009506521, 21.608166532090284, 20.683665900125913, 23.664139585742408, 20.807549478167015, 24.901300632447963, 21.928585319826922, 24.23557474570301, 23.829787708267293, 20.263079960259528, 24.277252982243944, 22.160359056884843, 20.98430078960285, 20.57015206093271, 20.669128785959288, 24.112912101230265, 20.69039253136415, 23.310208909846654, 21.028755794891083, 22.037102945274963, 25.10109473175017, 23.631580506447133, 24.766413371367282, 22.89169277894475, 25.288268368703314, 22.399901692846445, 18.102214443706476, 22.304420495001295, 21.672815948845702, 23.34076949009847, 21.220168393502444, 22.738075802344834, 20.99244876609409, 24.877147625587575, 23.714888053623955, 20.802947644165954, 19.898177030091734, 23.517270870802903, 21.827491597808006, 20.875732662654528, 21.276818845677614, 22.09902998894544, 20.03602391652661, 20.248328917952243, 23.52289456285049, 21.141414572752165, 22.008344256556356, 23.955449483816917, 21.86823057363579, 22.28933948970024, 24.01236961854361, 22.45273979572666, 24.665092327334634, 23.61340311107874, 24.039635287537894, 25.436855873888145, 21.05597187259168, 25.143884754842333, 23.849272757487725, 22.016731473890005, 18.9812116219547, 20.371053795024594, 24.597683695714306, 24.501006990147218, 21.022189974946464, 22.45375097324691, 22.25398077945472, 21.515918074525846, 22.191219512823178, 19.448441693905494], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1791761407466548, "mean_inference_ms": 7.756345214179475, "mean_action_processing_ms": 0.5300821372348159, "mean_env_wait_ms": 23.640043247944913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037837982177734375, "StateBufferConnector_ms": 0.030191659927368164, "ViewRequirementAgentConnector_ms": 0.9093992710113525}}, "episode_reward_max": 25.637466759033163, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.46990397375764, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.25019186287259, 20.307387555449345, 24.203244074834213, 22.698960080202998, 20.536411894833186, 24.42062552316341, 22.767772213720708, 23.37766052395094, 23.770605101361767, 24.752470963944738, 24.532764424780137, 23.253794434233786, 22.368628332738076, 22.78137351900695, 22.347794131541374, 22.43228336984888, 22.09637385345212, 22.304743455875357, 25.637466759033163, 21.331323637445685, 23.306887434864876, 23.13763987780974, 20.648530062265948, 19.895195958915757, 23.065980090668774, 19.33720934325314, 22.536518506887507, 24.048878043895193, 22.016953458739387, 23.448604102782557, 24.58190009506521, 21.608166532090284, 20.683665900125913, 23.664139585742408, 20.807549478167015, 24.901300632447963, 21.928585319826922, 24.23557474570301, 23.829787708267293, 20.263079960259528, 24.277252982243944, 22.160359056884843, 20.98430078960285, 20.57015206093271, 20.669128785959288, 24.112912101230265, 20.69039253136415, 23.310208909846654, 21.028755794891083, 22.037102945274963, 25.10109473175017, 23.631580506447133, 24.766413371367282, 22.89169277894475, 25.288268368703314, 22.399901692846445, 18.102214443706476, 22.304420495001295, 21.672815948845702, 23.34076949009847, 21.220168393502444, 22.738075802344834, 20.99244876609409, 24.877147625587575, 23.714888053623955, 20.802947644165954, 19.898177030091734, 23.517270870802903, 21.827491597808006, 20.875732662654528, 21.276818845677614, 22.09902998894544, 20.03602391652661, 20.248328917952243, 23.52289456285049, 21.141414572752165, 22.008344256556356, 23.955449483816917, 21.86823057363579, 22.28933948970024, 24.01236961854361, 22.45273979572666, 24.665092327334634, 23.61340311107874, 24.039635287537894, 25.436855873888145, 21.05597187259168, 25.143884754842333, 23.849272757487725, 22.016731473890005, 18.9812116219547, 20.371053795024594, 24.597683695714306, 24.501006990147218, 21.022189974946464, 22.45375097324691, 22.25398077945472, 21.515918074525846, 22.191219512823178, 19.448441693905494], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1791761407466548, "mean_inference_ms": 7.756345214179475, "mean_action_processing_ms": 0.5300821372348159, "mean_env_wait_ms": 23.640043247944913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037837982177734375, "StateBufferConnector_ms": 0.030191659927368164, "ViewRequirementAgentConnector_ms": 0.9093992710113525}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1106454, "num_agent_steps_trained": 1106454, "num_env_steps_sampled": 1106454, "num_env_steps_trained": 1106454, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.82620144260096, "num_env_steps_trained_throughput_per_sec": 283.82620144260096, "timesteps_total": 1106454, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1106454, "timers": {"training_iteration_time_ms": 55297.629, "sample_time_ms": 41526.594, "load_time_ms": 2177.36, "load_throughput": 7182.091, "learn_time_ms": 11031.656, "learn_throughput": 1417.557, "synch_weights_time_ms": 430.013}, "counters": {"num_env_steps_sampled": 1106454, "num_env_steps_trained": 1106454, "num_agent_steps_sampled": 1106454, "num_agent_steps_trained": 1106454}, "done": false, "episodes_total": 126, "training_iteration": 75, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-37-51", "timestamp": 1749242271, "time_this_iter_s": 55.11319017410278, "time_total_s": 512.94975233078, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 512.94975233078, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 76.4046875, "ram_util_percent": 69.28125, "gpu_util_percent0": 0.08515624999999999, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.893545999999999e-05, "total_loss": -0.1036231921680949, "policy_loss": -0.014489253681306515, "vf_loss": 0.013734296552667563, "vf_explained_var": 0.8839258830113844, "kl": 0.026301260134844698, "entropy": 16.99944033536044, "entropy_coeff": 0.006311820000000003}, "model": {}, "num_grad_updates_lifetime": 5225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1122092, "num_env_steps_trained": 1122092, "num_agent_steps_sampled": 1122092, "num_agent_steps_trained": 1122092}, "sampler_results": {"episode_reward_max": 25.8392189593022, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.416540077486747, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.347794131541374, 22.43228336984888, 22.09637385345212, 22.304743455875357, 25.637466759033163, 21.331323637445685, 23.306887434864876, 23.13763987780974, 20.648530062265948, 19.895195958915757, 23.065980090668774, 19.33720934325314, 22.536518506887507, 24.048878043895193, 22.016953458739387, 23.448604102782557, 24.58190009506521, 21.608166532090284, 20.683665900125913, 23.664139585742408, 20.807549478167015, 24.901300632447963, 21.928585319826922, 24.23557474570301, 23.829787708267293, 20.263079960259528, 24.277252982243944, 22.160359056884843, 20.98430078960285, 20.57015206093271, 20.669128785959288, 24.112912101230265, 20.69039253136415, 23.310208909846654, 21.028755794891083, 22.037102945274963, 25.10109473175017, 23.631580506447133, 24.766413371367282, 22.89169277894475, 25.288268368703314, 22.399901692846445, 18.102214443706476, 22.304420495001295, 21.672815948845702, 23.34076949009847, 21.220168393502444, 22.738075802344834, 20.99244876609409, 24.877147625587575, 23.714888053623955, 20.802947644165954, 19.898177030091734, 23.517270870802903, 21.827491597808006, 20.875732662654528, 21.276818845677614, 22.09902998894544, 20.03602391652661, 20.248328917952243, 23.52289456285049, 21.141414572752165, 22.008344256556356, 23.955449483816917, 21.86823057363579, 22.28933948970024, 24.01236961854361, 22.45273979572666, 24.665092327334634, 23.61340311107874, 24.039635287537894, 25.436855873888145, 21.05597187259168, 25.143884754842333, 23.849272757487725, 22.016731473890005, 18.9812116219547, 20.371053795024594, 24.597683695714306, 24.501006990147218, 21.022189974946464, 22.45375097324691, 22.25398077945472, 21.515918074525846, 22.191219512823178, 19.448441693905494, 22.636245063922626, 20.072754081385984, 19.00326716799424, 20.94956283142918, 23.010684997303763, 25.8392189593022, 21.738662626269754, 24.26097625797979, 20.400128355349405, 24.975150982338903, 24.50065830588207, 23.350660206586106, 22.3336440418024, 22.613887000456568], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1737715582196118, "mean_inference_ms": 7.792223375373871, "mean_action_processing_ms": 0.5325854324366062, "mean_env_wait_ms": 23.679586439916772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03482389450073242, "StateBufferConnector_ms": 0.031152009963989258, "ViewRequirementAgentConnector_ms": 0.9188010692596436}}, "episode_reward_max": 25.8392189593022, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.416540077486747, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.347794131541374, 22.43228336984888, 22.09637385345212, 22.304743455875357, 25.637466759033163, 21.331323637445685, 23.306887434864876, 23.13763987780974, 20.648530062265948, 19.895195958915757, 23.065980090668774, 19.33720934325314, 22.536518506887507, 24.048878043895193, 22.016953458739387, 23.448604102782557, 24.58190009506521, 21.608166532090284, 20.683665900125913, 23.664139585742408, 20.807549478167015, 24.901300632447963, 21.928585319826922, 24.23557474570301, 23.829787708267293, 20.263079960259528, 24.277252982243944, 22.160359056884843, 20.98430078960285, 20.57015206093271, 20.669128785959288, 24.112912101230265, 20.69039253136415, 23.310208909846654, 21.028755794891083, 22.037102945274963, 25.10109473175017, 23.631580506447133, 24.766413371367282, 22.89169277894475, 25.288268368703314, 22.399901692846445, 18.102214443706476, 22.304420495001295, 21.672815948845702, 23.34076949009847, 21.220168393502444, 22.738075802344834, 20.99244876609409, 24.877147625587575, 23.714888053623955, 20.802947644165954, 19.898177030091734, 23.517270870802903, 21.827491597808006, 20.875732662654528, 21.276818845677614, 22.09902998894544, 20.03602391652661, 20.248328917952243, 23.52289456285049, 21.141414572752165, 22.008344256556356, 23.955449483816917, 21.86823057363579, 22.28933948970024, 24.01236961854361, 22.45273979572666, 24.665092327334634, 23.61340311107874, 24.039635287537894, 25.436855873888145, 21.05597187259168, 25.143884754842333, 23.849272757487725, 22.016731473890005, 18.9812116219547, 20.371053795024594, 24.597683695714306, 24.501006990147218, 21.022189974946464, 22.45375097324691, 22.25398077945472, 21.515918074525846, 22.191219512823178, 19.448441693905494, 22.636245063922626, 20.072754081385984, 19.00326716799424, 20.94956283142918, 23.010684997303763, 25.8392189593022, 21.738662626269754, 24.26097625797979, 20.400128355349405, 24.975150982338903, 24.50065830588207, 23.350660206586106, 22.3336440418024, 22.613887000456568], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1737715582196118, "mean_inference_ms": 7.792223375373871, "mean_action_processing_ms": 0.5325854324366062, "mean_env_wait_ms": 23.679586439916772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03482389450073242, "StateBufferConnector_ms": 0.031152009963989258, "ViewRequirementAgentConnector_ms": 0.9188010692596436}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1122092, "num_agent_steps_trained": 1122092, "num_env_steps_sampled": 1122092, "num_env_steps_trained": 1122092, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.6125182024678, "num_env_steps_trained_throughput_per_sec": 283.6125182024678, "timesteps_total": 1122092, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1122092, "timers": {"training_iteration_time_ms": 55281.727, "sample_time_ms": 41499.05, "load_time_ms": 2146.139, "load_throughput": 7286.574, "learn_time_ms": 11076.771, "learn_throughput": 1411.783, "synch_weights_time_ms": 430.742}, "counters": {"num_env_steps_sampled": 1122092, "num_env_steps_trained": 1122092, "num_agent_steps_sampled": 1122092, "num_agent_steps_trained": 1122092}, "done": false, "episodes_total": 140, "training_iteration": 76, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-38-47", "timestamp": 1749242327, "time_this_iter_s": 55.36274838447571, "time_total_s": 568.3125007152557, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 568.3125007152557, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 76.30307692307692, "ram_util_percent": 69.70153846153845, "gpu_util_percent0": 0.08123076923076923, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.877908000000002e-05, "total_loss": -0.09169415421953256, "policy_loss": -0.004300806817164729, "vf_loss": 0.014747946728444235, "vf_explained_var": 0.8978416362675754, "kl": 0.028061781236482918, "entropy": 17.06168496912176, "entropy_coeff": 0.006259693333333332}, "model": {}, "num_grad_updates_lifetime": 5775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1137730, "num_env_steps_trained": 1137730, "num_agent_steps_sampled": 1137730, "num_agent_steps_trained": 1137730}, "sampler_results": {"episode_reward_max": 25.8392189593022, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.350407457020065, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.016953458739387, 23.448604102782557, 24.58190009506521, 21.608166532090284, 20.683665900125913, 23.664139585742408, 20.807549478167015, 24.901300632447963, 21.928585319826922, 24.23557474570301, 23.829787708267293, 20.263079960259528, 24.277252982243944, 22.160359056884843, 20.98430078960285, 20.57015206093271, 20.669128785959288, 24.112912101230265, 20.69039253136415, 23.310208909846654, 21.028755794891083, 22.037102945274963, 25.10109473175017, 23.631580506447133, 24.766413371367282, 22.89169277894475, 25.288268368703314, 22.399901692846445, 18.102214443706476, 22.304420495001295, 21.672815948845702, 23.34076949009847, 21.220168393502444, 22.738075802344834, 20.99244876609409, 24.877147625587575, 23.714888053623955, 20.802947644165954, 19.898177030091734, 23.517270870802903, 21.827491597808006, 20.875732662654528, 21.276818845677614, 22.09902998894544, 20.03602391652661, 20.248328917952243, 23.52289456285049, 21.141414572752165, 22.008344256556356, 23.955449483816917, 21.86823057363579, 22.28933948970024, 24.01236961854361, 22.45273979572666, 24.665092327334634, 23.61340311107874, 24.039635287537894, 25.436855873888145, 21.05597187259168, 25.143884754842333, 23.849272757487725, 22.016731473890005, 18.9812116219547, 20.371053795024594, 24.597683695714306, 24.501006990147218, 21.022189974946464, 22.45375097324691, 22.25398077945472, 21.515918074525846, 22.191219512823178, 19.448441693905494, 22.636245063922626, 20.072754081385984, 19.00326716799424, 20.94956283142918, 23.010684997303763, 25.8392189593022, 21.738662626269754, 24.26097625797979, 20.400128355349405, 24.975150982338903, 24.50065830588207, 23.350660206586106, 22.3336440418024, 22.613887000456568, 22.850064925438158, 21.187635624121057, 23.690368943726327, 22.472206738956086, 21.876513890480783, 19.598363458018472, 21.388221803268117, 19.072328927628412, 23.02360948355095, 20.233379381526753, 23.263254201643374, 23.72553795433528, 22.680769062135447, 20.451308084260322], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1726719131817576, "mean_inference_ms": 7.827606159598477, "mean_action_processing_ms": 0.5350773367666333, "mean_env_wait_ms": 23.717787278762415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03479886054992676, "StateBufferConnector_ms": 0.028335094451904297, "ViewRequirementAgentConnector_ms": 0.9404382705688477}}, "episode_reward_max": 25.8392189593022, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.350407457020065, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.016953458739387, 23.448604102782557, 24.58190009506521, 21.608166532090284, 20.683665900125913, 23.664139585742408, 20.807549478167015, 24.901300632447963, 21.928585319826922, 24.23557474570301, 23.829787708267293, 20.263079960259528, 24.277252982243944, 22.160359056884843, 20.98430078960285, 20.57015206093271, 20.669128785959288, 24.112912101230265, 20.69039253136415, 23.310208909846654, 21.028755794891083, 22.037102945274963, 25.10109473175017, 23.631580506447133, 24.766413371367282, 22.89169277894475, 25.288268368703314, 22.399901692846445, 18.102214443706476, 22.304420495001295, 21.672815948845702, 23.34076949009847, 21.220168393502444, 22.738075802344834, 20.99244876609409, 24.877147625587575, 23.714888053623955, 20.802947644165954, 19.898177030091734, 23.517270870802903, 21.827491597808006, 20.875732662654528, 21.276818845677614, 22.09902998894544, 20.03602391652661, 20.248328917952243, 23.52289456285049, 21.141414572752165, 22.008344256556356, 23.955449483816917, 21.86823057363579, 22.28933948970024, 24.01236961854361, 22.45273979572666, 24.665092327334634, 23.61340311107874, 24.039635287537894, 25.436855873888145, 21.05597187259168, 25.143884754842333, 23.849272757487725, 22.016731473890005, 18.9812116219547, 20.371053795024594, 24.597683695714306, 24.501006990147218, 21.022189974946464, 22.45375097324691, 22.25398077945472, 21.515918074525846, 22.191219512823178, 19.448441693905494, 22.636245063922626, 20.072754081385984, 19.00326716799424, 20.94956283142918, 23.010684997303763, 25.8392189593022, 21.738662626269754, 24.26097625797979, 20.400128355349405, 24.975150982338903, 24.50065830588207, 23.350660206586106, 22.3336440418024, 22.613887000456568, 22.850064925438158, 21.187635624121057, 23.690368943726327, 22.472206738956086, 21.876513890480783, 19.598363458018472, 21.388221803268117, 19.072328927628412, 23.02360948355095, 20.233379381526753, 23.263254201643374, 23.72553795433528, 22.680769062135447, 20.451308084260322], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1726719131817576, "mean_inference_ms": 7.827606159598477, "mean_action_processing_ms": 0.5350773367666333, "mean_env_wait_ms": 23.717787278762415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03479886054992676, "StateBufferConnector_ms": 0.028335094451904297, "ViewRequirementAgentConnector_ms": 0.9404382705688477}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1137730, "num_agent_steps_trained": 1137730, "num_env_steps_sampled": 1137730, "num_env_steps_trained": 1137730, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.61073031169894, "num_env_steps_trained_throughput_per_sec": 280.61073031169894, "timesteps_total": 1137730, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1137730, "timers": {"training_iteration_time_ms": 55074.378, "sample_time_ms": 41423.972, "load_time_ms": 1987.332, "load_throughput": 7868.842, "learn_time_ms": 11110.405, "learn_throughput": 1407.51, "synch_weights_time_ms": 430.216}, "counters": {"num_env_steps_sampled": 1137730, "num_env_steps_trained": 1137730, "num_agent_steps_sampled": 1137730, "num_agent_steps_trained": 1137730}, "done": false, "episodes_total": 154, "training_iteration": 77, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-39-42", "timestamp": 1749242382, "time_this_iter_s": 55.744354248046875, "time_total_s": 624.0568549633026, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 624.0568549633026, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 75.89375, "ram_util_percent": 69.9703125, "gpu_util_percent0": 0.07906250000000001, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.862270000000001e-05, "total_loss": -0.09773052539676427, "policy_loss": -0.010342098903069696, "vf_loss": 0.015586519990624352, "vf_explained_var": 0.9056604821031744, "kl": 0.026450461552647703, "entropy": 17.10609476436268, "entropy_coeff": 0.006207566666666667}, "model": {}, "num_grad_updates_lifetime": 6325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1153368, "num_env_steps_trained": 1153368, "num_agent_steps_sampled": 1153368, "num_agent_steps_trained": 1153368}, "sampler_results": {"episode_reward_max": 26.13984926834643, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.438276877510486, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.98430078960285, 20.57015206093271, 20.669128785959288, 24.112912101230265, 20.69039253136415, 23.310208909846654, 21.028755794891083, 22.037102945274963, 25.10109473175017, 23.631580506447133, 24.766413371367282, 22.89169277894475, 25.288268368703314, 22.399901692846445, 18.102214443706476, 22.304420495001295, 21.672815948845702, 23.34076949009847, 21.220168393502444, 22.738075802344834, 20.99244876609409, 24.877147625587575, 23.714888053623955, 20.802947644165954, 19.898177030091734, 23.517270870802903, 21.827491597808006, 20.875732662654528, 21.276818845677614, 22.09902998894544, 20.03602391652661, 20.248328917952243, 23.52289456285049, 21.141414572752165, 22.008344256556356, 23.955449483816917, 21.86823057363579, 22.28933948970024, 24.01236961854361, 22.45273979572666, 24.665092327334634, 23.61340311107874, 24.039635287537894, 25.436855873888145, 21.05597187259168, 25.143884754842333, 23.849272757487725, 22.016731473890005, 18.9812116219547, 20.371053795024594, 24.597683695714306, 24.501006990147218, 21.022189974946464, 22.45375097324691, 22.25398077945472, 21.515918074525846, 22.191219512823178, 19.448441693905494, 22.636245063922626, 20.072754081385984, 19.00326716799424, 20.94956283142918, 23.010684997303763, 25.8392189593022, 21.738662626269754, 24.26097625797979, 20.400128355349405, 24.975150982338903, 24.50065830588207, 23.350660206586106, 22.3336440418024, 22.613887000456568, 22.850064925438158, 21.187635624121057, 23.690368943726327, 22.472206738956086, 21.876513890480783, 19.598363458018472, 21.388221803268117, 19.072328927628412, 23.02360948355095, 20.233379381526753, 23.263254201643374, 23.72553795433528, 22.680769062135447, 20.451308084260322, 24.548118221962234, 22.8012320625375, 25.214545403181287, 24.25467256776865, 22.748611503208323, 22.71895643394349, 22.33845966179514, 23.219974027150688, 22.406238108629914, 21.63723324466628, 24.30567941989387, 22.731452374630997, 22.128839309673438, 26.13984926834643], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.173342219664129, "mean_inference_ms": 7.861099631236848, "mean_action_processing_ms": 0.5374440032935204, "mean_env_wait_ms": 23.753849432872308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033884525299072266, "StateBufferConnector_ms": 0.031392574310302734, "ViewRequirementAgentConnector_ms": 0.8945462703704834}}, "episode_reward_max": 26.13984926834643, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.438276877510486, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.98430078960285, 20.57015206093271, 20.669128785959288, 24.112912101230265, 20.69039253136415, 23.310208909846654, 21.028755794891083, 22.037102945274963, 25.10109473175017, 23.631580506447133, 24.766413371367282, 22.89169277894475, 25.288268368703314, 22.399901692846445, 18.102214443706476, 22.304420495001295, 21.672815948845702, 23.34076949009847, 21.220168393502444, 22.738075802344834, 20.99244876609409, 24.877147625587575, 23.714888053623955, 20.802947644165954, 19.898177030091734, 23.517270870802903, 21.827491597808006, 20.875732662654528, 21.276818845677614, 22.09902998894544, 20.03602391652661, 20.248328917952243, 23.52289456285049, 21.141414572752165, 22.008344256556356, 23.955449483816917, 21.86823057363579, 22.28933948970024, 24.01236961854361, 22.45273979572666, 24.665092327334634, 23.61340311107874, 24.039635287537894, 25.436855873888145, 21.05597187259168, 25.143884754842333, 23.849272757487725, 22.016731473890005, 18.9812116219547, 20.371053795024594, 24.597683695714306, 24.501006990147218, 21.022189974946464, 22.45375097324691, 22.25398077945472, 21.515918074525846, 22.191219512823178, 19.448441693905494, 22.636245063922626, 20.072754081385984, 19.00326716799424, 20.94956283142918, 23.010684997303763, 25.8392189593022, 21.738662626269754, 24.26097625797979, 20.400128355349405, 24.975150982338903, 24.50065830588207, 23.350660206586106, 22.3336440418024, 22.613887000456568, 22.850064925438158, 21.187635624121057, 23.690368943726327, 22.472206738956086, 21.876513890480783, 19.598363458018472, 21.388221803268117, 19.072328927628412, 23.02360948355095, 20.233379381526753, 23.263254201643374, 23.72553795433528, 22.680769062135447, 20.451308084260322, 24.548118221962234, 22.8012320625375, 25.214545403181287, 24.25467256776865, 22.748611503208323, 22.71895643394349, 22.33845966179514, 23.219974027150688, 22.406238108629914, 21.63723324466628, 24.30567941989387, 22.731452374630997, 22.128839309673438, 26.13984926834643], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.173342219664129, "mean_inference_ms": 7.861099631236848, "mean_action_processing_ms": 0.5374440032935204, "mean_env_wait_ms": 23.753849432872308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033884525299072266, "StateBufferConnector_ms": 0.031392574310302734, "ViewRequirementAgentConnector_ms": 0.8945462703704834}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1153368, "num_agent_steps_trained": 1153368, "num_env_steps_sampled": 1153368, "num_env_steps_trained": 1153368, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.3262814153288, "num_env_steps_trained_throughput_per_sec": 285.3262814153288, "timesteps_total": 1153368, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1153368, "timers": {"training_iteration_time_ms": 55170.042, "sample_time_ms": 41489.503, "load_time_ms": 1964.018, "load_throughput": 7962.248, "learn_time_ms": 11162.54, "learn_throughput": 1400.936, "synch_weights_time_ms": 436.533}, "counters": {"num_env_steps_sampled": 1153368, "num_env_steps_trained": 1153368, "num_agent_steps_sampled": 1153368, "num_agent_steps_trained": 1153368}, "done": false, "episodes_total": 168, "training_iteration": 78, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-40-37", "timestamp": 1749242437, "time_this_iter_s": 54.83925104141235, "time_total_s": 678.896106004715, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 678.896106004715, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 76.29841269841269, "ram_util_percent": 70.5126984126984, "gpu_util_percent0": 0.07746031746031744, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.846631999999998e-05, "total_loss": -0.10766539029015058, "policy_loss": -0.019279419632088818, "vf_loss": 0.012874097531153397, "vf_explained_var": 0.9130589821121909, "kl": 0.025673108245193196, "entropy": 17.2133890394731, "entropy_coeff": 0.006155439999999999}, "model": {}, "num_grad_updates_lifetime": 6875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1169006, "num_env_steps_trained": 1169006, "num_agent_steps_sampled": 1169006, "num_agent_steps_trained": 1169006}, "sampler_results": {"episode_reward_max": 26.13984926834643, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.471979672217017, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.102214443706476, 22.304420495001295, 21.672815948845702, 23.34076949009847, 21.220168393502444, 22.738075802344834, 20.99244876609409, 24.877147625587575, 23.714888053623955, 20.802947644165954, 19.898177030091734, 23.517270870802903, 21.827491597808006, 20.875732662654528, 21.276818845677614, 22.09902998894544, 20.03602391652661, 20.248328917952243, 23.52289456285049, 21.141414572752165, 22.008344256556356, 23.955449483816917, 21.86823057363579, 22.28933948970024, 24.01236961854361, 22.45273979572666, 24.665092327334634, 23.61340311107874, 24.039635287537894, 25.436855873888145, 21.05597187259168, 25.143884754842333, 23.849272757487725, 22.016731473890005, 18.9812116219547, 20.371053795024594, 24.597683695714306, 24.501006990147218, 21.022189974946464, 22.45375097324691, 22.25398077945472, 21.515918074525846, 22.191219512823178, 19.448441693905494, 22.636245063922626, 20.072754081385984, 19.00326716799424, 20.94956283142918, 23.010684997303763, 25.8392189593022, 21.738662626269754, 24.26097625797979, 20.400128355349405, 24.975150982338903, 24.50065830588207, 23.350660206586106, 22.3336440418024, 22.613887000456568, 22.850064925438158, 21.187635624121057, 23.690368943726327, 22.472206738956086, 21.876513890480783, 19.598363458018472, 21.388221803268117, 19.072328927628412, 23.02360948355095, 20.233379381526753, 23.263254201643374, 23.72553795433528, 22.680769062135447, 20.451308084260322, 24.548118221962234, 22.8012320625375, 25.214545403181287, 24.25467256776865, 22.748611503208323, 22.71895643394349, 22.33845966179514, 23.219974027150688, 22.406238108629914, 21.63723324466628, 24.30567941989387, 22.731452374630997, 22.128839309673438, 26.13984926834643, 25.62496087230194, 22.517524940367515, 22.691925416415245, 23.194699699022596, 23.72144767602135, 19.718862874938107, 21.91255678049079, 23.888161443687313, 22.46520407284585, 23.825685447112456, 23.17546890121712, 21.897355022287712, 22.858792204190916, 23.359539488915168], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.174748542587624, "mean_inference_ms": 7.900352519744056, "mean_action_processing_ms": 0.5400842040122975, "mean_env_wait_ms": 23.79969439922809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032213449478149414, "StateBufferConnector_ms": 0.035095930099487305, "ViewRequirementAgentConnector_ms": 0.8346729278564453}}, "episode_reward_max": 26.13984926834643, "episode_reward_min": 18.102214443706476, "episode_reward_mean": 22.471979672217017, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.102214443706476, 22.304420495001295, 21.672815948845702, 23.34076949009847, 21.220168393502444, 22.738075802344834, 20.99244876609409, 24.877147625587575, 23.714888053623955, 20.802947644165954, 19.898177030091734, 23.517270870802903, 21.827491597808006, 20.875732662654528, 21.276818845677614, 22.09902998894544, 20.03602391652661, 20.248328917952243, 23.52289456285049, 21.141414572752165, 22.008344256556356, 23.955449483816917, 21.86823057363579, 22.28933948970024, 24.01236961854361, 22.45273979572666, 24.665092327334634, 23.61340311107874, 24.039635287537894, 25.436855873888145, 21.05597187259168, 25.143884754842333, 23.849272757487725, 22.016731473890005, 18.9812116219547, 20.371053795024594, 24.597683695714306, 24.501006990147218, 21.022189974946464, 22.45375097324691, 22.25398077945472, 21.515918074525846, 22.191219512823178, 19.448441693905494, 22.636245063922626, 20.072754081385984, 19.00326716799424, 20.94956283142918, 23.010684997303763, 25.8392189593022, 21.738662626269754, 24.26097625797979, 20.400128355349405, 24.975150982338903, 24.50065830588207, 23.350660206586106, 22.3336440418024, 22.613887000456568, 22.850064925438158, 21.187635624121057, 23.690368943726327, 22.472206738956086, 21.876513890480783, 19.598363458018472, 21.388221803268117, 19.072328927628412, 23.02360948355095, 20.233379381526753, 23.263254201643374, 23.72553795433528, 22.680769062135447, 20.451308084260322, 24.548118221962234, 22.8012320625375, 25.214545403181287, 24.25467256776865, 22.748611503208323, 22.71895643394349, 22.33845966179514, 23.219974027150688, 22.406238108629914, 21.63723324466628, 24.30567941989387, 22.731452374630997, 22.128839309673438, 26.13984926834643, 25.62496087230194, 22.517524940367515, 22.691925416415245, 23.194699699022596, 23.72144767602135, 19.718862874938107, 21.91255678049079, 23.888161443687313, 22.46520407284585, 23.825685447112456, 23.17546890121712, 21.897355022287712, 22.858792204190916, 23.359539488915168], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.174748542587624, "mean_inference_ms": 7.900352519744056, "mean_action_processing_ms": 0.5400842040122975, "mean_env_wait_ms": 23.79969439922809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032213449478149414, "StateBufferConnector_ms": 0.035095930099487305, "ViewRequirementAgentConnector_ms": 0.8346729278564453}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1169006, "num_agent_steps_trained": 1169006, "num_env_steps_sampled": 1169006, "num_env_steps_trained": 1169006, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 270.82322697957756, "num_env_steps_trained_throughput_per_sec": 270.82322697957756, "timesteps_total": 1169006, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1169006, "timers": {"training_iteration_time_ms": 55578.637, "sample_time_ms": 41709.703, "load_time_ms": 1974.682, "load_throughput": 7919.251, "learn_time_ms": 11342.192, "learn_throughput": 1378.746, "synch_weights_time_ms": 434.612}, "counters": {"num_env_steps_sampled": 1169006, "num_env_steps_trained": 1169006, "num_agent_steps_sampled": 1169006, "num_agent_steps_trained": 1169006}, "done": false, "episodes_total": 182, "training_iteration": 79, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-41-35", "timestamp": 1749242495, "time_this_iter_s": 57.761476039886475, "time_total_s": 736.6575820446014, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 736.6575820446014, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 77.21492537313434, "ram_util_percent": 68.33880597014924, "gpu_util_percent0": 0.08328358208955224, "vram_util_percent0": 0.8592122395833334}}
{"evaluation": {"sampler_results": {"episode_reward_max": 1.0132235080052103, "episode_reward_min": -4.114218340494613, "episode_reward_mean": -1.921794171068667, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.8563536699419199, -3.7017278078317273, 1.0132235080052103, -1.9498945450802851, -4.114218340494613], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5949130641060767, "mean_inference_ms": 3.5577284001190335, "mean_action_processing_ms": 0.3151809437517107, "mean_env_wait_ms": 11.533029049651121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02003192901611328, "ViewRequirementAgentConnector_ms": 0.5368614196777344}}, "episode_reward_max": 1.0132235080052103, "episode_reward_min": -4.114218340494613, "episode_reward_mean": -1.921794171068667, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.8563536699419199, -3.7017278078317273, 1.0132235080052103, -1.9498945450802851, -4.114218340494613], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5949130641060767, "mean_inference_ms": 3.5577284001190335, "mean_action_processing_ms": 0.3151809437517107, "mean_env_wait_ms": 11.533029049651121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02003192901611328, "ViewRequirementAgentConnector_ms": 0.5368614196777344}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.830994e-05, "total_loss": -0.10767416978424246, "policy_loss": -0.020235792834216476, "vf_loss": 0.013715985678983005, "vf_explained_var": 0.9083974289894104, "kl": 0.025359409309884506, "entropy": 17.21908312190663, "entropy_coeff": 0.006103313333333334}, "model": {}, "num_grad_updates_lifetime": 7425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1184644, "num_env_steps_trained": 1184644, "num_agent_steps_sampled": 1184644, "num_agent_steps_trained": 1184644}, "sampler_results": {"episode_reward_max": 26.13984926834643, "episode_reward_min": 18.01033732773941, "episode_reward_mean": 22.627470334331992, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.276818845677614, 22.09902998894544, 20.03602391652661, 20.248328917952243, 23.52289456285049, 21.141414572752165, 22.008344256556356, 23.955449483816917, 21.86823057363579, 22.28933948970024, 24.01236961854361, 22.45273979572666, 24.665092327334634, 23.61340311107874, 24.039635287537894, 25.436855873888145, 21.05597187259168, 25.143884754842333, 23.849272757487725, 22.016731473890005, 18.9812116219547, 20.371053795024594, 24.597683695714306, 24.501006990147218, 21.022189974946464, 22.45375097324691, 22.25398077945472, 21.515918074525846, 22.191219512823178, 19.448441693905494, 22.636245063922626, 20.072754081385984, 19.00326716799424, 20.94956283142918, 23.010684997303763, 25.8392189593022, 21.738662626269754, 24.26097625797979, 20.400128355349405, 24.975150982338903, 24.50065830588207, 23.350660206586106, 22.3336440418024, 22.613887000456568, 22.850064925438158, 21.187635624121057, 23.690368943726327, 22.472206738956086, 21.876513890480783, 19.598363458018472, 21.388221803268117, 19.072328927628412, 23.02360948355095, 20.233379381526753, 23.263254201643374, 23.72553795433528, 22.680769062135447, 20.451308084260322, 24.548118221962234, 22.8012320625375, 25.214545403181287, 24.25467256776865, 22.748611503208323, 22.71895643394349, 22.33845966179514, 23.219974027150688, 22.406238108629914, 21.63723324466628, 24.30567941989387, 22.731452374630997, 22.128839309673438, 26.13984926834643, 25.62496087230194, 22.517524940367515, 22.691925416415245, 23.194699699022596, 23.72144767602135, 19.718862874938107, 21.91255678049079, 23.888161443687313, 22.46520407284585, 23.825685447112456, 23.17546890121712, 21.897355022287712, 22.858792204190916, 23.359539488915168, 25.527870619500938, 23.855185996792727, 20.91547679444987, 22.364634269821156, 18.01033732773941, 23.799435512840898, 22.966669756779268, 24.26104022174454, 21.029067735958385, 25.45818605593226, 22.363778748972596, 24.66460665978846, 22.61546394358936, 23.60188139191574], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1743949796489717, "mean_inference_ms": 7.919902347621347, "mean_action_processing_ms": 0.5414417733242501, "mean_env_wait_ms": 23.799030920306773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02824234962463379, "StateBufferConnector_ms": 0.03561902046203613, "ViewRequirementAgentConnector_ms": 0.839724063873291}}, "episode_reward_max": 26.13984926834643, "episode_reward_min": 18.01033732773941, "episode_reward_mean": 22.627470334331992, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.276818845677614, 22.09902998894544, 20.03602391652661, 20.248328917952243, 23.52289456285049, 21.141414572752165, 22.008344256556356, 23.955449483816917, 21.86823057363579, 22.28933948970024, 24.01236961854361, 22.45273979572666, 24.665092327334634, 23.61340311107874, 24.039635287537894, 25.436855873888145, 21.05597187259168, 25.143884754842333, 23.849272757487725, 22.016731473890005, 18.9812116219547, 20.371053795024594, 24.597683695714306, 24.501006990147218, 21.022189974946464, 22.45375097324691, 22.25398077945472, 21.515918074525846, 22.191219512823178, 19.448441693905494, 22.636245063922626, 20.072754081385984, 19.00326716799424, 20.94956283142918, 23.010684997303763, 25.8392189593022, 21.738662626269754, 24.26097625797979, 20.400128355349405, 24.975150982338903, 24.50065830588207, 23.350660206586106, 22.3336440418024, 22.613887000456568, 22.850064925438158, 21.187635624121057, 23.690368943726327, 22.472206738956086, 21.876513890480783, 19.598363458018472, 21.388221803268117, 19.072328927628412, 23.02360948355095, 20.233379381526753, 23.263254201643374, 23.72553795433528, 22.680769062135447, 20.451308084260322, 24.548118221962234, 22.8012320625375, 25.214545403181287, 24.25467256776865, 22.748611503208323, 22.71895643394349, 22.33845966179514, 23.219974027150688, 22.406238108629914, 21.63723324466628, 24.30567941989387, 22.731452374630997, 22.128839309673438, 26.13984926834643, 25.62496087230194, 22.517524940367515, 22.691925416415245, 23.194699699022596, 23.72144767602135, 19.718862874938107, 21.91255678049079, 23.888161443687313, 22.46520407284585, 23.825685447112456, 23.17546890121712, 21.897355022287712, 22.858792204190916, 23.359539488915168, 25.527870619500938, 23.855185996792727, 20.91547679444987, 22.364634269821156, 18.01033732773941, 23.799435512840898, 22.966669756779268, 24.26104022174454, 21.029067735958385, 25.45818605593226, 22.363778748972596, 24.66460665978846, 22.61546394358936, 23.60188139191574], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1743949796489717, "mean_inference_ms": 7.919902347621347, "mean_action_processing_ms": 0.5414417733242501, "mean_env_wait_ms": 23.799030920306773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02824234962463379, "StateBufferConnector_ms": 0.03561902046203613, "ViewRequirementAgentConnector_ms": 0.839724063873291}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184644, "num_agent_steps_trained": 1184644, "num_env_steps_sampled": 1184644, "num_env_steps_trained": 1184644, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.56155425745317, "num_env_steps_trained_throughput_per_sec": 284.56155425745317, "timesteps_total": 1184644, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1184644, "timers": {"training_iteration_time_ms": 55632.896, "sample_time_ms": 41718.909, "load_time_ms": 1972.982, "load_throughput": 7926.075, "learn_time_ms": 11388.976, "learn_throughput": 1373.082, "synch_weights_time_ms": 433.605}, "counters": {"num_env_steps_sampled": 1184644, "num_env_steps_trained": 1184644, "num_agent_steps_sampled": 1184644, "num_agent_steps_trained": 1184644}, "done": false, "episodes_total": 196, "training_iteration": 80, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-42-47", "timestamp": 1749242567, "time_this_iter_s": 71.46170711517334, "time_total_s": 808.1192891597748, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 808.1192891597748, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 62.7, "ram_util_percent": 63.01176470588236, "gpu_util_percent0": 0.06399999999999999, "vram_util_percent0": 0.8592122395833329}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.815356000000002e-05, "total_loss": -0.09787751579657197, "policy_loss": -0.011272177738006286, "vf_loss": 0.013849448719146576, "vf_explained_var": 0.903696701743386, "kl": 0.02536463792351427, "entropy": 17.236826979897238, "entropy_coeff": 0.006051186666666667}, "model": {}, "num_grad_updates_lifetime": 7975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1200282, "num_env_steps_trained": 1200282, "num_agent_steps_sampled": 1200282, "num_agent_steps_trained": 1200282}, "sampler_results": {"episode_reward_max": 26.13984926834643, "episode_reward_min": 18.01033732773941, "episode_reward_mean": 22.56231550074175, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.039635287537894, 25.436855873888145, 21.05597187259168, 25.143884754842333, 23.849272757487725, 22.016731473890005, 18.9812116219547, 20.371053795024594, 24.597683695714306, 24.501006990147218, 21.022189974946464, 22.45375097324691, 22.25398077945472, 21.515918074525846, 22.191219512823178, 19.448441693905494, 22.636245063922626, 20.072754081385984, 19.00326716799424, 20.94956283142918, 23.010684997303763, 25.8392189593022, 21.738662626269754, 24.26097625797979, 20.400128355349405, 24.975150982338903, 24.50065830588207, 23.350660206586106, 22.3336440418024, 22.613887000456568, 22.850064925438158, 21.187635624121057, 23.690368943726327, 22.472206738956086, 21.876513890480783, 19.598363458018472, 21.388221803268117, 19.072328927628412, 23.02360948355095, 20.233379381526753, 23.263254201643374, 23.72553795433528, 22.680769062135447, 20.451308084260322, 24.548118221962234, 22.8012320625375, 25.214545403181287, 24.25467256776865, 22.748611503208323, 22.71895643394349, 22.33845966179514, 23.219974027150688, 22.406238108629914, 21.63723324466628, 24.30567941989387, 22.731452374630997, 22.128839309673438, 26.13984926834643, 25.62496087230194, 22.517524940367515, 22.691925416415245, 23.194699699022596, 23.72144767602135, 19.718862874938107, 21.91255678049079, 23.888161443687313, 22.46520407284585, 23.825685447112456, 23.17546890121712, 21.897355022287712, 22.858792204190916, 23.359539488915168, 25.527870619500938, 23.855185996792727, 20.91547679444987, 22.364634269821156, 18.01033732773941, 23.799435512840898, 22.966669756779268, 24.26104022174454, 21.029067735958385, 25.45818605593226, 22.363778748972596, 24.66460665978846, 22.61546394358936, 23.60188139191574, 21.128168088370334, 21.886493941851267, 21.991972509312603, 22.203353479580922, 21.812248320862476, 22.148180086560792, 23.716458002360966, 20.87178904658187, 21.99322400019369, 23.037685847859546, 23.00430533399321, 22.056618486992846, 19.04488747642382, 21.778611481129236], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.173269094060925, "mean_inference_ms": 7.942153214201589, "mean_action_processing_ms": 0.5428815275865183, "mean_env_wait_ms": 23.803017528014415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027289867401123047, "StateBufferConnector_ms": 0.04360508918762207, "ViewRequirementAgentConnector_ms": 0.8675193786621094}}, "episode_reward_max": 26.13984926834643, "episode_reward_min": 18.01033732773941, "episode_reward_mean": 22.56231550074175, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.039635287537894, 25.436855873888145, 21.05597187259168, 25.143884754842333, 23.849272757487725, 22.016731473890005, 18.9812116219547, 20.371053795024594, 24.597683695714306, 24.501006990147218, 21.022189974946464, 22.45375097324691, 22.25398077945472, 21.515918074525846, 22.191219512823178, 19.448441693905494, 22.636245063922626, 20.072754081385984, 19.00326716799424, 20.94956283142918, 23.010684997303763, 25.8392189593022, 21.738662626269754, 24.26097625797979, 20.400128355349405, 24.975150982338903, 24.50065830588207, 23.350660206586106, 22.3336440418024, 22.613887000456568, 22.850064925438158, 21.187635624121057, 23.690368943726327, 22.472206738956086, 21.876513890480783, 19.598363458018472, 21.388221803268117, 19.072328927628412, 23.02360948355095, 20.233379381526753, 23.263254201643374, 23.72553795433528, 22.680769062135447, 20.451308084260322, 24.548118221962234, 22.8012320625375, 25.214545403181287, 24.25467256776865, 22.748611503208323, 22.71895643394349, 22.33845966179514, 23.219974027150688, 22.406238108629914, 21.63723324466628, 24.30567941989387, 22.731452374630997, 22.128839309673438, 26.13984926834643, 25.62496087230194, 22.517524940367515, 22.691925416415245, 23.194699699022596, 23.72144767602135, 19.718862874938107, 21.91255678049079, 23.888161443687313, 22.46520407284585, 23.825685447112456, 23.17546890121712, 21.897355022287712, 22.858792204190916, 23.359539488915168, 25.527870619500938, 23.855185996792727, 20.91547679444987, 22.364634269821156, 18.01033732773941, 23.799435512840898, 22.966669756779268, 24.26104022174454, 21.029067735958385, 25.45818605593226, 22.363778748972596, 24.66460665978846, 22.61546394358936, 23.60188139191574, 21.128168088370334, 21.886493941851267, 21.991972509312603, 22.203353479580922, 21.812248320862476, 22.148180086560792, 23.716458002360966, 20.87178904658187, 21.99322400019369, 23.037685847859546, 23.00430533399321, 22.056618486992846, 19.04488747642382, 21.778611481129236], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.173269094060925, "mean_inference_ms": 7.942153214201589, "mean_action_processing_ms": 0.5428815275865183, "mean_env_wait_ms": 23.803017528014415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027289867401123047, "StateBufferConnector_ms": 0.04360508918762207, "ViewRequirementAgentConnector_ms": 0.8675193786621094}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200282, "num_agent_steps_trained": 1200282, "num_env_steps_sampled": 1200282, "num_env_steps_trained": 1200282, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 262.92577249269453, "num_env_steps_trained_throughput_per_sec": 262.92577249269453, "timesteps_total": 1200282, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1200282, "timers": {"training_iteration_time_ms": 56223.415, "sample_time_ms": 42010.683, "load_time_ms": 1987.28, "load_throughput": 7869.046, "learn_time_ms": 11669.476, "learn_throughput": 1340.077, "synch_weights_time_ms": 437.276}, "counters": {"num_env_steps_sampled": 1200282, "num_env_steps_trained": 1200282, "num_agent_steps_sampled": 1200282, "num_agent_steps_trained": 1200282}, "done": false, "episodes_total": 210, "training_iteration": 81, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-43-46", "timestamp": 1749242626, "time_this_iter_s": 59.489861249923706, "time_total_s": 867.6091504096985, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 867.6091504096985, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 76.90579710144927, "ram_util_percent": 63.95942028985507, "gpu_util_percent0": 0.08115942028985507, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.799717999999999e-05, "total_loss": -0.10574442129074173, "policy_loss": -0.018805000166916712, "vf_loss": 0.013843488127247176, "vf_explained_var": 0.8986034129966389, "kl": 0.024332495422782492, "entropy": 17.350127208016136, "entropy_coeff": 0.0059990600000000005}, "model": {}, "num_grad_updates_lifetime": 8525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1215920, "num_env_steps_trained": 1215920, "num_agent_steps_sampled": 1215920, "num_agent_steps_trained": 1215920}, "sampler_results": {"episode_reward_max": 26.13984926834643, "episode_reward_min": 18.01033732773941, "episode_reward_mean": 22.479339381846213, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.191219512823178, 19.448441693905494, 22.636245063922626, 20.072754081385984, 19.00326716799424, 20.94956283142918, 23.010684997303763, 25.8392189593022, 21.738662626269754, 24.26097625797979, 20.400128355349405, 24.975150982338903, 24.50065830588207, 23.350660206586106, 22.3336440418024, 22.613887000456568, 22.850064925438158, 21.187635624121057, 23.690368943726327, 22.472206738956086, 21.876513890480783, 19.598363458018472, 21.388221803268117, 19.072328927628412, 23.02360948355095, 20.233379381526753, 23.263254201643374, 23.72553795433528, 22.680769062135447, 20.451308084260322, 24.548118221962234, 22.8012320625375, 25.214545403181287, 24.25467256776865, 22.748611503208323, 22.71895643394349, 22.33845966179514, 23.219974027150688, 22.406238108629914, 21.63723324466628, 24.30567941989387, 22.731452374630997, 22.128839309673438, 26.13984926834643, 25.62496087230194, 22.517524940367515, 22.691925416415245, 23.194699699022596, 23.72144767602135, 19.718862874938107, 21.91255678049079, 23.888161443687313, 22.46520407284585, 23.825685447112456, 23.17546890121712, 21.897355022287712, 22.858792204190916, 23.359539488915168, 25.527870619500938, 23.855185996792727, 20.91547679444987, 22.364634269821156, 18.01033732773941, 23.799435512840898, 22.966669756779268, 24.26104022174454, 21.029067735958385, 25.45818605593226, 22.363778748972596, 24.66460665978846, 22.61546394358936, 23.60188139191574, 21.128168088370334, 21.886493941851267, 21.991972509312603, 22.203353479580922, 21.812248320862476, 22.148180086560792, 23.716458002360966, 20.87178904658187, 21.99322400019369, 23.037685847859546, 23.00430533399321, 22.056618486992846, 19.04488747642382, 21.778611481129236, 24.45061090739029, 21.231596074823813, 19.999075821346196, 23.406327134736465, 21.76730164530991, 23.68295098382843, 18.17860143728194, 22.018639586115878, 20.35024343062527, 19.73822802253452, 24.735110042324997, 22.48176972693894, 23.36183582004175, 23.5392454024002], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1719791309643908, "mean_inference_ms": 7.965534096722317, "mean_action_processing_ms": 0.544245799098838, "mean_env_wait_ms": 23.817184921054935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02725529670715332, "StateBufferConnector_ms": 0.04673051834106445, "ViewRequirementAgentConnector_ms": 0.8909168243408203}}, "episode_reward_max": 26.13984926834643, "episode_reward_min": 18.01033732773941, "episode_reward_mean": 22.479339381846213, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.191219512823178, 19.448441693905494, 22.636245063922626, 20.072754081385984, 19.00326716799424, 20.94956283142918, 23.010684997303763, 25.8392189593022, 21.738662626269754, 24.26097625797979, 20.400128355349405, 24.975150982338903, 24.50065830588207, 23.350660206586106, 22.3336440418024, 22.613887000456568, 22.850064925438158, 21.187635624121057, 23.690368943726327, 22.472206738956086, 21.876513890480783, 19.598363458018472, 21.388221803268117, 19.072328927628412, 23.02360948355095, 20.233379381526753, 23.263254201643374, 23.72553795433528, 22.680769062135447, 20.451308084260322, 24.548118221962234, 22.8012320625375, 25.214545403181287, 24.25467256776865, 22.748611503208323, 22.71895643394349, 22.33845966179514, 23.219974027150688, 22.406238108629914, 21.63723324466628, 24.30567941989387, 22.731452374630997, 22.128839309673438, 26.13984926834643, 25.62496087230194, 22.517524940367515, 22.691925416415245, 23.194699699022596, 23.72144767602135, 19.718862874938107, 21.91255678049079, 23.888161443687313, 22.46520407284585, 23.825685447112456, 23.17546890121712, 21.897355022287712, 22.858792204190916, 23.359539488915168, 25.527870619500938, 23.855185996792727, 20.91547679444987, 22.364634269821156, 18.01033732773941, 23.799435512840898, 22.966669756779268, 24.26104022174454, 21.029067735958385, 25.45818605593226, 22.363778748972596, 24.66460665978846, 22.61546394358936, 23.60188139191574, 21.128168088370334, 21.886493941851267, 21.991972509312603, 22.203353479580922, 21.812248320862476, 22.148180086560792, 23.716458002360966, 20.87178904658187, 21.99322400019369, 23.037685847859546, 23.00430533399321, 22.056618486992846, 19.04488747642382, 21.778611481129236, 24.45061090739029, 21.231596074823813, 19.999075821346196, 23.406327134736465, 21.76730164530991, 23.68295098382843, 18.17860143728194, 22.018639586115878, 20.35024343062527, 19.73822802253452, 24.735110042324997, 22.48176972693894, 23.36183582004175, 23.5392454024002], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1719791309643908, "mean_inference_ms": 7.965534096722317, "mean_action_processing_ms": 0.544245799098838, "mean_env_wait_ms": 23.817184921054935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02725529670715332, "StateBufferConnector_ms": 0.04673051834106445, "ViewRequirementAgentConnector_ms": 0.8909168243408203}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1215920, "num_agent_steps_trained": 1215920, "num_env_steps_sampled": 1215920, "num_env_steps_trained": 1215920, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 268.0107662563315, "num_env_steps_trained_throughput_per_sec": 268.0107662563315, "timesteps_total": 1215920, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1215920, "timers": {"training_iteration_time_ms": 56607.128, "sample_time_ms": 42232.007, "load_time_ms": 1973.367, "load_throughput": 7924.526, "learn_time_ms": 11843.994, "learn_throughput": 1320.332, "synch_weights_time_ms": 438.644}, "counters": {"num_env_steps_sampled": 1215920, "num_env_steps_trained": 1215920, "num_agent_steps_sampled": 1215920, "num_agent_steps_trained": 1215920}, "done": false, "episodes_total": 224, "training_iteration": 82, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-44-45", "timestamp": 1749242685, "time_this_iter_s": 58.36437273025513, "time_total_s": 925.9735231399536, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 925.9735231399536, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 76.67611940298508, "ram_util_percent": 64.30746268656716, "gpu_util_percent0": 0.08119402985074628, "vram_util_percent0": 0.8592122395833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.78408e-05, "total_loss": -0.10141521416562187, "policy_loss": -0.014723502177459357, "vf_loss": 0.014427591747688977, "vf_explained_var": 0.886564425013282, "kl": 0.023480195865323624, "entropy": 17.41349600011652, "entropy_coeff": 0.005946933333333334}, "model": {}, "num_grad_updates_lifetime": 9075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1231558, "num_env_steps_trained": 1231558, "num_agent_steps_sampled": 1231558, "num_agent_steps_trained": 1231558}, "sampler_results": {"episode_reward_max": 26.13984926834643, "episode_reward_min": 18.01033732773941, "episode_reward_mean": 22.377398819777632, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.3336440418024, 22.613887000456568, 22.850064925438158, 21.187635624121057, 23.690368943726327, 22.472206738956086, 21.876513890480783, 19.598363458018472, 21.388221803268117, 19.072328927628412, 23.02360948355095, 20.233379381526753, 23.263254201643374, 23.72553795433528, 22.680769062135447, 20.451308084260322, 24.548118221962234, 22.8012320625375, 25.214545403181287, 24.25467256776865, 22.748611503208323, 22.71895643394349, 22.33845966179514, 23.219974027150688, 22.406238108629914, 21.63723324466628, 24.30567941989387, 22.731452374630997, 22.128839309673438, 26.13984926834643, 25.62496087230194, 22.517524940367515, 22.691925416415245, 23.194699699022596, 23.72144767602135, 19.718862874938107, 21.91255678049079, 23.888161443687313, 22.46520407284585, 23.825685447112456, 23.17546890121712, 21.897355022287712, 22.858792204190916, 23.359539488915168, 25.527870619500938, 23.855185996792727, 20.91547679444987, 22.364634269821156, 18.01033732773941, 23.799435512840898, 22.966669756779268, 24.26104022174454, 21.029067735958385, 25.45818605593226, 22.363778748972596, 24.66460665978846, 22.61546394358936, 23.60188139191574, 21.128168088370334, 21.886493941851267, 21.991972509312603, 22.203353479580922, 21.812248320862476, 22.148180086560792, 23.716458002360966, 20.87178904658187, 21.99322400019369, 23.037685847859546, 23.00430533399321, 22.056618486992846, 19.04488747642382, 21.778611481129236, 24.45061090739029, 21.231596074823813, 19.999075821346196, 23.406327134736465, 21.76730164530991, 23.68295098382843, 18.17860143728194, 22.018639586115878, 20.35024343062527, 19.73822802253452, 24.735110042324997, 22.48176972693894, 23.36183582004175, 23.5392454024002, 19.46520083488604, 21.35487236577829, 23.59496674669479, 21.199625886998604, 20.174536431610008, 18.753558293098763, 19.99695456961108, 22.881552125202305, 22.45212693393226, 23.78287780746215, 25.586904232523942, 19.78285548323449, 21.891367492684427, 21.266175631897642], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.170656659054863, "mean_inference_ms": 7.991506697737574, "mean_action_processing_ms": 0.5458976156543067, "mean_env_wait_ms": 23.834726894707398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02828192710876465, "StateBufferConnector_ms": 0.04882311820983887, "ViewRequirementAgentConnector_ms": 0.8899540901184082}}, "episode_reward_max": 26.13984926834643, "episode_reward_min": 18.01033732773941, "episode_reward_mean": 22.377398819777632, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.3336440418024, 22.613887000456568, 22.850064925438158, 21.187635624121057, 23.690368943726327, 22.472206738956086, 21.876513890480783, 19.598363458018472, 21.388221803268117, 19.072328927628412, 23.02360948355095, 20.233379381526753, 23.263254201643374, 23.72553795433528, 22.680769062135447, 20.451308084260322, 24.548118221962234, 22.8012320625375, 25.214545403181287, 24.25467256776865, 22.748611503208323, 22.71895643394349, 22.33845966179514, 23.219974027150688, 22.406238108629914, 21.63723324466628, 24.30567941989387, 22.731452374630997, 22.128839309673438, 26.13984926834643, 25.62496087230194, 22.517524940367515, 22.691925416415245, 23.194699699022596, 23.72144767602135, 19.718862874938107, 21.91255678049079, 23.888161443687313, 22.46520407284585, 23.825685447112456, 23.17546890121712, 21.897355022287712, 22.858792204190916, 23.359539488915168, 25.527870619500938, 23.855185996792727, 20.91547679444987, 22.364634269821156, 18.01033732773941, 23.799435512840898, 22.966669756779268, 24.26104022174454, 21.029067735958385, 25.45818605593226, 22.363778748972596, 24.66460665978846, 22.61546394358936, 23.60188139191574, 21.128168088370334, 21.886493941851267, 21.991972509312603, 22.203353479580922, 21.812248320862476, 22.148180086560792, 23.716458002360966, 20.87178904658187, 21.99322400019369, 23.037685847859546, 23.00430533399321, 22.056618486992846, 19.04488747642382, 21.778611481129236, 24.45061090739029, 21.231596074823813, 19.999075821346196, 23.406327134736465, 21.76730164530991, 23.68295098382843, 18.17860143728194, 22.018639586115878, 20.35024343062527, 19.73822802253452, 24.735110042324997, 22.48176972693894, 23.36183582004175, 23.5392454024002, 19.46520083488604, 21.35487236577829, 23.59496674669479, 21.199625886998604, 20.174536431610008, 18.753558293098763, 19.99695456961108, 22.881552125202305, 22.45212693393226, 23.78287780746215, 25.586904232523942, 19.78285548323449, 21.891367492684427, 21.266175631897642], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.170656659054863, "mean_inference_ms": 7.991506697737574, "mean_action_processing_ms": 0.5458976156543067, "mean_env_wait_ms": 23.834726894707398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02828192710876465, "StateBufferConnector_ms": 0.04882311820983887, "ViewRequirementAgentConnector_ms": 0.8899540901184082}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1231558, "num_agent_steps_trained": 1231558, "num_env_steps_sampled": 1231558, "num_env_steps_trained": 1231558, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 268.7401646590031, "num_env_steps_trained_throughput_per_sec": 268.7401646590031, "timesteps_total": 1231558, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1231558, "timers": {"training_iteration_time_ms": 56450.924, "sample_time_ms": 41957.728, "load_time_ms": 1970.052, "load_throughput": 7937.86, "learn_time_ms": 11958.163, "learn_throughput": 1307.726, "synch_weights_time_ms": 445.826}, "counters": {"num_env_steps_sampled": 1231558, "num_env_steps_trained": 1231558, "num_agent_steps_sampled": 1231558, "num_agent_steps_trained": 1231558}, "done": false, "episodes_total": 238, "training_iteration": 83, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-45-43", "timestamp": 1749242743, "time_this_iter_s": 58.22195887565613, "time_total_s": 984.1954820156097, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 984.1954820156097, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 76.56119402985074, "ram_util_percent": 64.16119402985076, "gpu_util_percent0": 0.08238805970149254, "vram_util_percent0": 0.8592122395833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.768442000000003e-05, "total_loss": -0.10901723145337945, "policy_loss": -0.0221289992843363, "vf_loss": 0.012830085452138023, "vf_explained_var": 0.8979573350602931, "kl": 0.023037303879182527, "entropy": 17.479401378631593, "entropy_coeff": 0.005894806666666668}, "model": {}, "num_grad_updates_lifetime": 9625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1247196, "num_env_steps_trained": 1247196, "num_agent_steps_sampled": 1247196, "num_agent_steps_trained": 1247196}, "sampler_results": {"episode_reward_max": 26.13984926834643, "episode_reward_min": 18.01033732773941, "episode_reward_mean": 22.256941139675664, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.680769062135447, 20.451308084260322, 24.548118221962234, 22.8012320625375, 25.214545403181287, 24.25467256776865, 22.748611503208323, 22.71895643394349, 22.33845966179514, 23.219974027150688, 22.406238108629914, 21.63723324466628, 24.30567941989387, 22.731452374630997, 22.128839309673438, 26.13984926834643, 25.62496087230194, 22.517524940367515, 22.691925416415245, 23.194699699022596, 23.72144767602135, 19.718862874938107, 21.91255678049079, 23.888161443687313, 22.46520407284585, 23.825685447112456, 23.17546890121712, 21.897355022287712, 22.858792204190916, 23.359539488915168, 25.527870619500938, 23.855185996792727, 20.91547679444987, 22.364634269821156, 18.01033732773941, 23.799435512840898, 22.966669756779268, 24.26104022174454, 21.029067735958385, 25.45818605593226, 22.363778748972596, 24.66460665978846, 22.61546394358936, 23.60188139191574, 21.128168088370334, 21.886493941851267, 21.991972509312603, 22.203353479580922, 21.812248320862476, 22.148180086560792, 23.716458002360966, 20.87178904658187, 21.99322400019369, 23.037685847859546, 23.00430533399321, 22.056618486992846, 19.04488747642382, 21.778611481129236, 24.45061090739029, 21.231596074823813, 19.999075821346196, 23.406327134736465, 21.76730164530991, 23.68295098382843, 18.17860143728194, 22.018639586115878, 20.35024343062527, 19.73822802253452, 24.735110042324997, 22.48176972693894, 23.36183582004175, 23.5392454024002, 19.46520083488604, 21.35487236577829, 23.59496674669479, 21.199625886998604, 20.174536431610008, 18.753558293098763, 19.99695456961108, 22.881552125202305, 22.45212693393226, 23.78287780746215, 25.586904232523942, 19.78285548323449, 21.891367492684427, 21.266175631897642, 23.38897752683579, 20.326555630266814, 21.559289803008593, 18.940090319142325, 21.479401932442688, 21.451625547252544, 19.077064137154107, 20.92997806011142, 21.58077458080186, 23.329106629066025, 21.35731455677816, 20.392953199732936, 20.02436640437912, 21.445750037783583], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1673076753999356, "mean_inference_ms": 8.017333601370197, "mean_action_processing_ms": 0.5475107893593737, "mean_env_wait_ms": 23.853534862751346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026285648345947266, "StateBufferConnector_ms": 0.04784107208251953, "ViewRequirementAgentConnector_ms": 0.8770163059234619}}, "episode_reward_max": 26.13984926834643, "episode_reward_min": 18.01033732773941, "episode_reward_mean": 22.256941139675664, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.680769062135447, 20.451308084260322, 24.548118221962234, 22.8012320625375, 25.214545403181287, 24.25467256776865, 22.748611503208323, 22.71895643394349, 22.33845966179514, 23.219974027150688, 22.406238108629914, 21.63723324466628, 24.30567941989387, 22.731452374630997, 22.128839309673438, 26.13984926834643, 25.62496087230194, 22.517524940367515, 22.691925416415245, 23.194699699022596, 23.72144767602135, 19.718862874938107, 21.91255678049079, 23.888161443687313, 22.46520407284585, 23.825685447112456, 23.17546890121712, 21.897355022287712, 22.858792204190916, 23.359539488915168, 25.527870619500938, 23.855185996792727, 20.91547679444987, 22.364634269821156, 18.01033732773941, 23.799435512840898, 22.966669756779268, 24.26104022174454, 21.029067735958385, 25.45818605593226, 22.363778748972596, 24.66460665978846, 22.61546394358936, 23.60188139191574, 21.128168088370334, 21.886493941851267, 21.991972509312603, 22.203353479580922, 21.812248320862476, 22.148180086560792, 23.716458002360966, 20.87178904658187, 21.99322400019369, 23.037685847859546, 23.00430533399321, 22.056618486992846, 19.04488747642382, 21.778611481129236, 24.45061090739029, 21.231596074823813, 19.999075821346196, 23.406327134736465, 21.76730164530991, 23.68295098382843, 18.17860143728194, 22.018639586115878, 20.35024343062527, 19.73822802253452, 24.735110042324997, 22.48176972693894, 23.36183582004175, 23.5392454024002, 19.46520083488604, 21.35487236577829, 23.59496674669479, 21.199625886998604, 20.174536431610008, 18.753558293098763, 19.99695456961108, 22.881552125202305, 22.45212693393226, 23.78287780746215, 25.586904232523942, 19.78285548323449, 21.891367492684427, 21.266175631897642, 23.38897752683579, 20.326555630266814, 21.559289803008593, 18.940090319142325, 21.479401932442688, 21.451625547252544, 19.077064137154107, 20.92997806011142, 21.58077458080186, 23.329106629066025, 21.35731455677816, 20.392953199732936, 20.02436640437912, 21.445750037783583], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1673076753999356, "mean_inference_ms": 8.017333601370197, "mean_action_processing_ms": 0.5475107893593737, "mean_env_wait_ms": 23.853534862751346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026285648345947266, "StateBufferConnector_ms": 0.04784107208251953, "ViewRequirementAgentConnector_ms": 0.8770163059234619}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1247196, "num_agent_steps_trained": 1247196, "num_env_steps_sampled": 1247196, "num_env_steps_trained": 1247196, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 272.495170247751, "num_env_steps_trained_throughput_per_sec": 272.495170247751, "timesteps_total": 1247196, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1247196, "timers": {"training_iteration_time_ms": 56687.224, "sample_time_ms": 42052.487, "load_time_ms": 1938.674, "load_throughput": 8066.339, "learn_time_ms": 12119.547, "learn_throughput": 1290.312, "synch_weights_time_ms": 457.464}, "counters": {"num_env_steps_sampled": 1247196, "num_env_steps_trained": 1247196, "num_agent_steps_sampled": 1247196, "num_agent_steps_trained": 1247196}, "done": false, "episodes_total": 252, "training_iteration": 84, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-46-41", "timestamp": 1749242801, "time_this_iter_s": 57.409340381622314, "time_total_s": 1041.604822397232, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1041.604822397232, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 76.83181818181819, "ram_util_percent": 64.25909090909092, "gpu_util_percent0": 0.07984848484848484, "vram_util_percent0": 0.8592122395833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.752804e-05, "total_loss": -0.10371363653293388, "policy_loss": -0.01834117637293027, "vf_loss": 0.015318241484717212, "vf_explained_var": 0.885541968128898, "kl": 0.023166257670490686, "entropy": 17.51545847979459, "entropy_coeff": 0.005842680000000001}, "model": {}, "num_grad_updates_lifetime": 10175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1262834, "num_env_steps_trained": 1262834, "num_agent_steps_sampled": 1262834, "num_agent_steps_trained": 1262834}, "sampler_results": {"episode_reward_max": 26.13984926834643, "episode_reward_min": 17.602498479052844, "episode_reward_mean": 21.931362380060747, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.128839309673438, 26.13984926834643, 25.62496087230194, 22.517524940367515, 22.691925416415245, 23.194699699022596, 23.72144767602135, 19.718862874938107, 21.91255678049079, 23.888161443687313, 22.46520407284585, 23.825685447112456, 23.17546890121712, 21.897355022287712, 22.858792204190916, 23.359539488915168, 25.527870619500938, 23.855185996792727, 20.91547679444987, 22.364634269821156, 18.01033732773941, 23.799435512840898, 22.966669756779268, 24.26104022174454, 21.029067735958385, 25.45818605593226, 22.363778748972596, 24.66460665978846, 22.61546394358936, 23.60188139191574, 21.128168088370334, 21.886493941851267, 21.991972509312603, 22.203353479580922, 21.812248320862476, 22.148180086560792, 23.716458002360966, 20.87178904658187, 21.99322400019369, 23.037685847859546, 23.00430533399321, 22.056618486992846, 19.04488747642382, 21.778611481129236, 24.45061090739029, 21.231596074823813, 19.999075821346196, 23.406327134736465, 21.76730164530991, 23.68295098382843, 18.17860143728194, 22.018639586115878, 20.35024343062527, 19.73822802253452, 24.735110042324997, 22.48176972693894, 23.36183582004175, 23.5392454024002, 19.46520083488604, 21.35487236577829, 23.59496674669479, 21.199625886998604, 20.174536431610008, 18.753558293098763, 19.99695456961108, 22.881552125202305, 22.45212693393226, 23.78287780746215, 25.586904232523942, 19.78285548323449, 21.891367492684427, 21.266175631897642, 23.38897752683579, 20.326555630266814, 21.559289803008593, 18.940090319142325, 21.479401932442688, 21.451625547252544, 19.077064137154107, 20.92997806011142, 21.58077458080186, 23.329106629066025, 21.35731455677816, 20.392953199732936, 20.02436640437912, 21.445750037783583, 17.602498479052844, 20.837912711217875, 19.443745616693622, 19.82815192829091, 21.638192724813862, 19.014833678902253, 20.75209985786703, 18.66005086942291, 21.069068940100248, 21.617860151102118, 22.070951480720563, 20.243765945072028, 22.938513260009614, 23.781728571006038], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1639915977280824, "mean_inference_ms": 8.044985444437692, "mean_action_processing_ms": 0.5490965451116999, "mean_env_wait_ms": 23.879142529453024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030286788940429688, "StateBufferConnector_ms": 0.04875922203063965, "ViewRequirementAgentConnector_ms": 0.8810291290283203}}, "episode_reward_max": 26.13984926834643, "episode_reward_min": 17.602498479052844, "episode_reward_mean": 21.931362380060747, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.128839309673438, 26.13984926834643, 25.62496087230194, 22.517524940367515, 22.691925416415245, 23.194699699022596, 23.72144767602135, 19.718862874938107, 21.91255678049079, 23.888161443687313, 22.46520407284585, 23.825685447112456, 23.17546890121712, 21.897355022287712, 22.858792204190916, 23.359539488915168, 25.527870619500938, 23.855185996792727, 20.91547679444987, 22.364634269821156, 18.01033732773941, 23.799435512840898, 22.966669756779268, 24.26104022174454, 21.029067735958385, 25.45818605593226, 22.363778748972596, 24.66460665978846, 22.61546394358936, 23.60188139191574, 21.128168088370334, 21.886493941851267, 21.991972509312603, 22.203353479580922, 21.812248320862476, 22.148180086560792, 23.716458002360966, 20.87178904658187, 21.99322400019369, 23.037685847859546, 23.00430533399321, 22.056618486992846, 19.04488747642382, 21.778611481129236, 24.45061090739029, 21.231596074823813, 19.999075821346196, 23.406327134736465, 21.76730164530991, 23.68295098382843, 18.17860143728194, 22.018639586115878, 20.35024343062527, 19.73822802253452, 24.735110042324997, 22.48176972693894, 23.36183582004175, 23.5392454024002, 19.46520083488604, 21.35487236577829, 23.59496674669479, 21.199625886998604, 20.174536431610008, 18.753558293098763, 19.99695456961108, 22.881552125202305, 22.45212693393226, 23.78287780746215, 25.586904232523942, 19.78285548323449, 21.891367492684427, 21.266175631897642, 23.38897752683579, 20.326555630266814, 21.559289803008593, 18.940090319142325, 21.479401932442688, 21.451625547252544, 19.077064137154107, 20.92997806011142, 21.58077458080186, 23.329106629066025, 21.35731455677816, 20.392953199732936, 20.02436640437912, 21.445750037783583, 17.602498479052844, 20.837912711217875, 19.443745616693622, 19.82815192829091, 21.638192724813862, 19.014833678902253, 20.75209985786703, 18.66005086942291, 21.069068940100248, 21.617860151102118, 22.070951480720563, 20.243765945072028, 22.938513260009614, 23.781728571006038], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1639915977280824, "mean_inference_ms": 8.044985444437692, "mean_action_processing_ms": 0.5490965451116999, "mean_env_wait_ms": 23.879142529453024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030286788940429688, "StateBufferConnector_ms": 0.04875922203063965, "ViewRequirementAgentConnector_ms": 0.8810291290283203}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1262834, "num_agent_steps_trained": 1262834, "num_env_steps_sampled": 1262834, "num_env_steps_trained": 1262834, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 274.14508662319673, "num_env_steps_trained_throughput_per_sec": 274.14508662319673, "timesteps_total": 1262834, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1262834, "timers": {"training_iteration_time_ms": 56881.793, "sample_time_ms": 42165.889, "load_time_ms": 1927.882, "load_throughput": 8111.494, "learn_time_ms": 12211.385, "learn_throughput": 1280.608, "synch_weights_time_ms": 456.687}, "counters": {"num_env_steps_sampled": 1262834, "num_env_steps_trained": 1262834, "num_agent_steps_sampled": 1262834, "num_agent_steps_trained": 1262834}, "done": false, "episodes_total": 266, "training_iteration": 85, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-47-38", "timestamp": 1749242858, "time_this_iter_s": 57.0627863407135, "time_total_s": 1098.6676087379456, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1098.6676087379456, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 76.08333333333333, "ram_util_percent": 64.7287878787879, "gpu_util_percent0": 0.07772727272727273, "vram_util_percent0": 0.8592122395833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.737166e-05, "total_loss": -0.10023205055982214, "policy_loss": -0.015259647762891704, "vf_loss": 0.014283523742024871, "vf_explained_var": 0.8961282023516568, "kl": 0.022594262201009213, "entropy": 17.497694996920497, "entropy_coeff": 0.0057905533333333335}, "model": {}, "num_grad_updates_lifetime": 10725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1278472, "num_env_steps_trained": 1278472, "num_agent_steps_sampled": 1278472, "num_agent_steps_trained": 1278472}, "sampler_results": {"episode_reward_max": 25.586904232523942, "episode_reward_min": 17.602498479052844, "episode_reward_mean": 21.732977419094016, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.858792204190916, 23.359539488915168, 25.527870619500938, 23.855185996792727, 20.91547679444987, 22.364634269821156, 18.01033732773941, 23.799435512840898, 22.966669756779268, 24.26104022174454, 21.029067735958385, 25.45818605593226, 22.363778748972596, 24.66460665978846, 22.61546394358936, 23.60188139191574, 21.128168088370334, 21.886493941851267, 21.991972509312603, 22.203353479580922, 21.812248320862476, 22.148180086560792, 23.716458002360966, 20.87178904658187, 21.99322400019369, 23.037685847859546, 23.00430533399321, 22.056618486992846, 19.04488747642382, 21.778611481129236, 24.45061090739029, 21.231596074823813, 19.999075821346196, 23.406327134736465, 21.76730164530991, 23.68295098382843, 18.17860143728194, 22.018639586115878, 20.35024343062527, 19.73822802253452, 24.735110042324997, 22.48176972693894, 23.36183582004175, 23.5392454024002, 19.46520083488604, 21.35487236577829, 23.59496674669479, 21.199625886998604, 20.174536431610008, 18.753558293098763, 19.99695456961108, 22.881552125202305, 22.45212693393226, 23.78287780746215, 25.586904232523942, 19.78285548323449, 21.891367492684427, 21.266175631897642, 23.38897752683579, 20.326555630266814, 21.559289803008593, 18.940090319142325, 21.479401932442688, 21.451625547252544, 19.077064137154107, 20.92997806011142, 21.58077458080186, 23.329106629066025, 21.35731455677816, 20.392953199732936, 20.02436640437912, 21.445750037783583, 17.602498479052844, 20.837912711217875, 19.443745616693622, 19.82815192829091, 21.638192724813862, 19.014833678902253, 20.75209985786703, 18.66005086942291, 21.069068940100248, 21.617860151102118, 22.070951480720563, 20.243765945072028, 22.938513260009614, 23.781728571006038, 23.821132042753508, 21.077045821469873, 22.393852031341584, 18.35410240932903, 20.581720249553914, 18.78390861920236, 19.3797370228005, 23.158449335883173, 22.482979204500808, 23.387499890502944, 22.681141106706665, 22.792387505846733, 21.536017476106515, 22.634072912057686], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.162389320280687, "mean_inference_ms": 8.068717439674518, "mean_action_processing_ms": 0.5503802588392206, "mean_env_wait_ms": 23.900700122392774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0251772403717041, "StateBufferConnector_ms": 0.041651248931884766, "ViewRequirementAgentConnector_ms": 0.9152820110321045}}, "episode_reward_max": 25.586904232523942, "episode_reward_min": 17.602498479052844, "episode_reward_mean": 21.732977419094016, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.858792204190916, 23.359539488915168, 25.527870619500938, 23.855185996792727, 20.91547679444987, 22.364634269821156, 18.01033732773941, 23.799435512840898, 22.966669756779268, 24.26104022174454, 21.029067735958385, 25.45818605593226, 22.363778748972596, 24.66460665978846, 22.61546394358936, 23.60188139191574, 21.128168088370334, 21.886493941851267, 21.991972509312603, 22.203353479580922, 21.812248320862476, 22.148180086560792, 23.716458002360966, 20.87178904658187, 21.99322400019369, 23.037685847859546, 23.00430533399321, 22.056618486992846, 19.04488747642382, 21.778611481129236, 24.45061090739029, 21.231596074823813, 19.999075821346196, 23.406327134736465, 21.76730164530991, 23.68295098382843, 18.17860143728194, 22.018639586115878, 20.35024343062527, 19.73822802253452, 24.735110042324997, 22.48176972693894, 23.36183582004175, 23.5392454024002, 19.46520083488604, 21.35487236577829, 23.59496674669479, 21.199625886998604, 20.174536431610008, 18.753558293098763, 19.99695456961108, 22.881552125202305, 22.45212693393226, 23.78287780746215, 25.586904232523942, 19.78285548323449, 21.891367492684427, 21.266175631897642, 23.38897752683579, 20.326555630266814, 21.559289803008593, 18.940090319142325, 21.479401932442688, 21.451625547252544, 19.077064137154107, 20.92997806011142, 21.58077458080186, 23.329106629066025, 21.35731455677816, 20.392953199732936, 20.02436640437912, 21.445750037783583, 17.602498479052844, 20.837912711217875, 19.443745616693622, 19.82815192829091, 21.638192724813862, 19.014833678902253, 20.75209985786703, 18.66005086942291, 21.069068940100248, 21.617860151102118, 22.070951480720563, 20.243765945072028, 22.938513260009614, 23.781728571006038, 23.821132042753508, 21.077045821469873, 22.393852031341584, 18.35410240932903, 20.581720249553914, 18.78390861920236, 19.3797370228005, 23.158449335883173, 22.482979204500808, 23.387499890502944, 22.681141106706665, 22.792387505846733, 21.536017476106515, 22.634072912057686], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.162389320280687, "mean_inference_ms": 8.068717439674518, "mean_action_processing_ms": 0.5503802588392206, "mean_env_wait_ms": 23.900700122392774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0251772403717041, "StateBufferConnector_ms": 0.041651248931884766, "ViewRequirementAgentConnector_ms": 0.9152820110321045}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1278472, "num_agent_steps_trained": 1278472, "num_env_steps_sampled": 1278472, "num_env_steps_trained": 1278472, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 276.24505775063204, "num_env_steps_trained_throughput_per_sec": 276.24505775063204, "timesteps_total": 1278472, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1278472, "timers": {"training_iteration_time_ms": 57028.848, "sample_time_ms": 42300.818, "load_time_ms": 1939.317, "load_throughput": 8063.665, "learn_time_ms": 12210.305, "learn_throughput": 1280.722, "synch_weights_time_ms": 457.433}, "counters": {"num_env_steps_sampled": 1278472, "num_env_steps_trained": 1278472, "num_agent_steps_sampled": 1278472, "num_agent_steps_trained": 1278472}, "done": false, "episodes_total": 280, "training_iteration": 86, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-48-35", "timestamp": 1749242915, "time_this_iter_s": 56.62503957748413, "time_total_s": 1155.2926483154297, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1155.2926483154297, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 77.2439393939394, "ram_util_percent": 64.80757575757575, "gpu_util_percent0": 0.07863636363636364, "vram_util_percent0": 0.8592122395833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.721528000000002e-05, "total_loss": -0.11647839081134986, "policy_loss": -0.03123597610456107, "vf_loss": 0.01394336479419673, "vf_explained_var": 0.8780319346081127, "kl": 0.02176896581238411, "entropy": 17.60912169716575, "entropy_coeff": 0.005738426666666666}, "model": {}, "num_grad_updates_lifetime": 11275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1294110, "num_env_steps_trained": 1294110, "num_agent_steps_sampled": 1294110, "num_agent_steps_trained": 1294110}, "sampler_results": {"episode_reward_max": 25.586904232523942, "episode_reward_min": 17.602498479052844, "episode_reward_mean": 21.554570498960828, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.61546394358936, 23.60188139191574, 21.128168088370334, 21.886493941851267, 21.991972509312603, 22.203353479580922, 21.812248320862476, 22.148180086560792, 23.716458002360966, 20.87178904658187, 21.99322400019369, 23.037685847859546, 23.00430533399321, 22.056618486992846, 19.04488747642382, 21.778611481129236, 24.45061090739029, 21.231596074823813, 19.999075821346196, 23.406327134736465, 21.76730164530991, 23.68295098382843, 18.17860143728194, 22.018639586115878, 20.35024343062527, 19.73822802253452, 24.735110042324997, 22.48176972693894, 23.36183582004175, 23.5392454024002, 19.46520083488604, 21.35487236577829, 23.59496674669479, 21.199625886998604, 20.174536431610008, 18.753558293098763, 19.99695456961108, 22.881552125202305, 22.45212693393226, 23.78287780746215, 25.586904232523942, 19.78285548323449, 21.891367492684427, 21.266175631897642, 23.38897752683579, 20.326555630266814, 21.559289803008593, 18.940090319142325, 21.479401932442688, 21.451625547252544, 19.077064137154107, 20.92997806011142, 21.58077458080186, 23.329106629066025, 21.35731455677816, 20.392953199732936, 20.02436640437912, 21.445750037783583, 17.602498479052844, 20.837912711217875, 19.443745616693622, 19.82815192829091, 21.638192724813862, 19.014833678902253, 20.75209985786703, 18.66005086942291, 21.069068940100248, 21.617860151102118, 22.070951480720563, 20.243765945072028, 22.938513260009614, 23.781728571006038, 23.821132042753508, 21.077045821469873, 22.393852031341584, 18.35410240932903, 20.581720249553914, 18.78390861920236, 19.3797370228005, 23.158449335883173, 22.482979204500808, 23.387499890502944, 22.681141106706665, 22.792387505846733, 21.536017476106515, 22.634072912057686, 22.59259328183013, 21.902977525827378, 22.670504509953066, 20.686047980123956, 24.19209987511649, 20.7590804753633, 22.734411774826924, 23.16066066570879, 21.40803291698924, 19.655596326152093, 21.93634874340342, 20.261041124220192, 21.94717244673106, 19.68736173386117], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1594468793485113, "mean_inference_ms": 8.09056119756129, "mean_action_processing_ms": 0.5515422278526628, "mean_env_wait_ms": 23.92152733110546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0252227783203125, "StateBufferConnector_ms": 0.04218888282775879, "ViewRequirementAgentConnector_ms": 0.9174416065216064}}, "episode_reward_max": 25.586904232523942, "episode_reward_min": 17.602498479052844, "episode_reward_mean": 21.554570498960828, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.61546394358936, 23.60188139191574, 21.128168088370334, 21.886493941851267, 21.991972509312603, 22.203353479580922, 21.812248320862476, 22.148180086560792, 23.716458002360966, 20.87178904658187, 21.99322400019369, 23.037685847859546, 23.00430533399321, 22.056618486992846, 19.04488747642382, 21.778611481129236, 24.45061090739029, 21.231596074823813, 19.999075821346196, 23.406327134736465, 21.76730164530991, 23.68295098382843, 18.17860143728194, 22.018639586115878, 20.35024343062527, 19.73822802253452, 24.735110042324997, 22.48176972693894, 23.36183582004175, 23.5392454024002, 19.46520083488604, 21.35487236577829, 23.59496674669479, 21.199625886998604, 20.174536431610008, 18.753558293098763, 19.99695456961108, 22.881552125202305, 22.45212693393226, 23.78287780746215, 25.586904232523942, 19.78285548323449, 21.891367492684427, 21.266175631897642, 23.38897752683579, 20.326555630266814, 21.559289803008593, 18.940090319142325, 21.479401932442688, 21.451625547252544, 19.077064137154107, 20.92997806011142, 21.58077458080186, 23.329106629066025, 21.35731455677816, 20.392953199732936, 20.02436640437912, 21.445750037783583, 17.602498479052844, 20.837912711217875, 19.443745616693622, 19.82815192829091, 21.638192724813862, 19.014833678902253, 20.75209985786703, 18.66005086942291, 21.069068940100248, 21.617860151102118, 22.070951480720563, 20.243765945072028, 22.938513260009614, 23.781728571006038, 23.821132042753508, 21.077045821469873, 22.393852031341584, 18.35410240932903, 20.581720249553914, 18.78390861920236, 19.3797370228005, 23.158449335883173, 22.482979204500808, 23.387499890502944, 22.681141106706665, 22.792387505846733, 21.536017476106515, 22.634072912057686, 22.59259328183013, 21.902977525827378, 22.670504509953066, 20.686047980123956, 24.19209987511649, 20.7590804753633, 22.734411774826924, 23.16066066570879, 21.40803291698924, 19.655596326152093, 21.93634874340342, 20.261041124220192, 21.94717244673106, 19.68736173386117], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1594468793485113, "mean_inference_ms": 8.09056119756129, "mean_action_processing_ms": 0.5515422278526628, "mean_env_wait_ms": 23.92152733110546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0252227783203125, "StateBufferConnector_ms": 0.04218888282775879, "ViewRequirementAgentConnector_ms": 0.9174416065216064}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1294110, "num_agent_steps_trained": 1294110, "num_env_steps_sampled": 1294110, "num_env_steps_trained": 1294110, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.36631455222835, "num_env_steps_trained_throughput_per_sec": 285.36631455222835, "timesteps_total": 1294110, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1294110, "timers": {"training_iteration_time_ms": 56935.977, "sample_time_ms": 42237.411, "load_time_ms": 1924.088, "load_throughput": 8127.486, "learn_time_ms": 12200.395, "learn_throughput": 1281.762, "synch_weights_time_ms": 459.037}, "counters": {"num_env_steps_sampled": 1294110, "num_env_steps_trained": 1294110, "num_agent_steps_sampled": 1294110, "num_agent_steps_trained": 1294110}, "done": false, "episodes_total": 294, "training_iteration": 87, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-49-29", "timestamp": 1749242969, "time_this_iter_s": 54.82327342033386, "time_total_s": 1210.1159217357635, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1210.1159217357635, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 76.32222222222224, "ram_util_percent": 64.6936507936508, "gpu_util_percent0": 0.07666666666666665, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.705889999999999e-05, "total_loss": -0.10389531564771791, "policy_loss": -0.01877382761129411, "vf_loss": 0.013513958222148093, "vf_explained_var": 0.8747735582698475, "kl": 0.021725447314837727, "entropy": 17.722537710016425, "entropy_coeff": 0.005686299999999998}, "model": {}, "num_grad_updates_lifetime": 11825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1309748, "num_env_steps_trained": 1309748, "num_agent_steps_sampled": 1309748, "num_agent_steps_trained": 1309748}, "sampler_results": {"episode_reward_max": 25.586904232523942, "episode_reward_min": 17.602498479052844, "episode_reward_mean": 21.329964282060836, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.04488747642382, 21.778611481129236, 24.45061090739029, 21.231596074823813, 19.999075821346196, 23.406327134736465, 21.76730164530991, 23.68295098382843, 18.17860143728194, 22.018639586115878, 20.35024343062527, 19.73822802253452, 24.735110042324997, 22.48176972693894, 23.36183582004175, 23.5392454024002, 19.46520083488604, 21.35487236577829, 23.59496674669479, 21.199625886998604, 20.174536431610008, 18.753558293098763, 19.99695456961108, 22.881552125202305, 22.45212693393226, 23.78287780746215, 25.586904232523942, 19.78285548323449, 21.891367492684427, 21.266175631897642, 23.38897752683579, 20.326555630266814, 21.559289803008593, 18.940090319142325, 21.479401932442688, 21.451625547252544, 19.077064137154107, 20.92997806011142, 21.58077458080186, 23.329106629066025, 21.35731455677816, 20.392953199732936, 20.02436640437912, 21.445750037783583, 17.602498479052844, 20.837912711217875, 19.443745616693622, 19.82815192829091, 21.638192724813862, 19.014833678902253, 20.75209985786703, 18.66005086942291, 21.069068940100248, 21.617860151102118, 22.070951480720563, 20.243765945072028, 22.938513260009614, 23.781728571006038, 23.821132042753508, 21.077045821469873, 22.393852031341584, 18.35410240932903, 20.581720249553914, 18.78390861920236, 19.3797370228005, 23.158449335883173, 22.482979204500808, 23.387499890502944, 22.681141106706665, 22.792387505846733, 21.536017476106515, 22.634072912057686, 22.59259328183013, 21.902977525827378, 22.670504509953066, 20.686047980123956, 24.19209987511649, 20.7590804753633, 22.734411774826924, 23.16066066570879, 21.40803291698924, 19.655596326152093, 21.93634874340342, 20.261041124220192, 21.94717244673106, 19.68736173386117, 20.041114145544523, 21.795834427891702, 22.684648836325493, 22.005451609691434, 21.23359550694179, 19.467373479173876, 22.296393412385616, 20.20725743426758, 19.711275546384428, 22.203796336369315, 19.385694555162544, 20.442844589871576, 19.394938803997018, 18.73700210602056], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.156779108658115, "mean_inference_ms": 8.103888725676066, "mean_action_processing_ms": 0.5522336904913828, "mean_env_wait_ms": 23.93598746005776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02233147621154785, "StateBufferConnector_ms": 0.04129528999328613, "ViewRequirementAgentConnector_ms": 0.9324474334716797}}, "episode_reward_max": 25.586904232523942, "episode_reward_min": 17.602498479052844, "episode_reward_mean": 21.329964282060836, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.04488747642382, 21.778611481129236, 24.45061090739029, 21.231596074823813, 19.999075821346196, 23.406327134736465, 21.76730164530991, 23.68295098382843, 18.17860143728194, 22.018639586115878, 20.35024343062527, 19.73822802253452, 24.735110042324997, 22.48176972693894, 23.36183582004175, 23.5392454024002, 19.46520083488604, 21.35487236577829, 23.59496674669479, 21.199625886998604, 20.174536431610008, 18.753558293098763, 19.99695456961108, 22.881552125202305, 22.45212693393226, 23.78287780746215, 25.586904232523942, 19.78285548323449, 21.891367492684427, 21.266175631897642, 23.38897752683579, 20.326555630266814, 21.559289803008593, 18.940090319142325, 21.479401932442688, 21.451625547252544, 19.077064137154107, 20.92997806011142, 21.58077458080186, 23.329106629066025, 21.35731455677816, 20.392953199732936, 20.02436640437912, 21.445750037783583, 17.602498479052844, 20.837912711217875, 19.443745616693622, 19.82815192829091, 21.638192724813862, 19.014833678902253, 20.75209985786703, 18.66005086942291, 21.069068940100248, 21.617860151102118, 22.070951480720563, 20.243765945072028, 22.938513260009614, 23.781728571006038, 23.821132042753508, 21.077045821469873, 22.393852031341584, 18.35410240932903, 20.581720249553914, 18.78390861920236, 19.3797370228005, 23.158449335883173, 22.482979204500808, 23.387499890502944, 22.681141106706665, 22.792387505846733, 21.536017476106515, 22.634072912057686, 22.59259328183013, 21.902977525827378, 22.670504509953066, 20.686047980123956, 24.19209987511649, 20.7590804753633, 22.734411774826924, 23.16066066570879, 21.40803291698924, 19.655596326152093, 21.93634874340342, 20.261041124220192, 21.94717244673106, 19.68736173386117, 20.041114145544523, 21.795834427891702, 22.684648836325493, 22.005451609691434, 21.23359550694179, 19.467373479173876, 22.296393412385616, 20.20725743426758, 19.711275546384428, 22.203796336369315, 19.385694555162544, 20.442844589871576, 19.394938803997018, 18.73700210602056], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.156779108658115, "mean_inference_ms": 8.103888725676066, "mean_action_processing_ms": 0.5522336904913828, "mean_env_wait_ms": 23.93598746005776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02233147621154785, "StateBufferConnector_ms": 0.04129528999328613, "ViewRequirementAgentConnector_ms": 0.9324474334716797}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1309748, "num_agent_steps_trained": 1309748, "num_env_steps_sampled": 1309748, "num_env_steps_trained": 1309748, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 277.98941793174185, "num_env_steps_trained_throughput_per_sec": 277.98941793174185, "timesteps_total": 1309748, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1309748, "timers": {"training_iteration_time_ms": 57080.628, "sample_time_ms": 42311.641, "load_time_ms": 1905.536, "load_throughput": 8206.613, "learn_time_ms": 12291.481, "learn_throughput": 1272.263, "synch_weights_time_ms": 455.676}, "counters": {"num_env_steps_sampled": 1309748, "num_env_steps_trained": 1309748, "num_agent_steps_sampled": 1309748, "num_agent_steps_trained": 1309748}, "done": false, "episodes_total": 308, "training_iteration": 88, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-50-26", "timestamp": 1749243026, "time_this_iter_s": 56.27097010612488, "time_total_s": 1266.3868918418884, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1266.3868918418884, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 75.67076923076922, "ram_util_percent": 64.92769230769231, "gpu_util_percent0": 0.08353846153846153, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.690252000000001e-05, "total_loss": -0.10973506574180315, "policy_loss": -0.0249032539806715, "vf_loss": 0.014300726538693362, "vf_explained_var": 0.8822428568926725, "kl": 0.02091502502766988, "entropy": 17.80018121545965, "entropy_coeff": 0.005634173333333333}, "model": {}, "num_grad_updates_lifetime": 12375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1325386, "num_env_steps_trained": 1325386, "num_agent_steps_sampled": 1325386, "num_agent_steps_trained": 1325386}, "sampler_results": {"episode_reward_max": 25.586904232523942, "episode_reward_min": 17.602498479052844, "episode_reward_mean": 21.306808612441852, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.36183582004175, 23.5392454024002, 19.46520083488604, 21.35487236577829, 23.59496674669479, 21.199625886998604, 20.174536431610008, 18.753558293098763, 19.99695456961108, 22.881552125202305, 22.45212693393226, 23.78287780746215, 25.586904232523942, 19.78285548323449, 21.891367492684427, 21.266175631897642, 23.38897752683579, 20.326555630266814, 21.559289803008593, 18.940090319142325, 21.479401932442688, 21.451625547252544, 19.077064137154107, 20.92997806011142, 21.58077458080186, 23.329106629066025, 21.35731455677816, 20.392953199732936, 20.02436640437912, 21.445750037783583, 17.602498479052844, 20.837912711217875, 19.443745616693622, 19.82815192829091, 21.638192724813862, 19.014833678902253, 20.75209985786703, 18.66005086942291, 21.069068940100248, 21.617860151102118, 22.070951480720563, 20.243765945072028, 22.938513260009614, 23.781728571006038, 23.821132042753508, 21.077045821469873, 22.393852031341584, 18.35410240932903, 20.581720249553914, 18.78390861920236, 19.3797370228005, 23.158449335883173, 22.482979204500808, 23.387499890502944, 22.681141106706665, 22.792387505846733, 21.536017476106515, 22.634072912057686, 22.59259328183013, 21.902977525827378, 22.670504509953066, 20.686047980123956, 24.19209987511649, 20.7590804753633, 22.734411774826924, 23.16066066570879, 21.40803291698924, 19.655596326152093, 21.93634874340342, 20.261041124220192, 21.94717244673106, 19.68736173386117, 20.041114145544523, 21.795834427891702, 22.684648836325493, 22.005451609691434, 21.23359550694179, 19.467373479173876, 22.296393412385616, 20.20725743426758, 19.711275546384428, 22.203796336369315, 19.385694555162544, 20.442844589871576, 19.394938803997018, 18.73700210602056, 22.126555071376238, 22.03125082526857, 24.794493485286868, 22.686607038970322, 19.173283526038226, 21.35556276773917, 19.12957862925238, 21.47506271889428, 22.14480565657219, 22.182738886527854, 20.71937099675393, 21.657726231125434, 22.204722445234065, 18.866628529870873], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.153426329785196, "mean_inference_ms": 8.112930666761535, "mean_action_processing_ms": 0.5526497071667067, "mean_env_wait_ms": 23.943282734347036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024357318878173828, "StateBufferConnector_ms": 0.03316068649291992, "ViewRequirementAgentConnector_ms": 0.953798770904541}}, "episode_reward_max": 25.586904232523942, "episode_reward_min": 17.602498479052844, "episode_reward_mean": 21.306808612441852, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.36183582004175, 23.5392454024002, 19.46520083488604, 21.35487236577829, 23.59496674669479, 21.199625886998604, 20.174536431610008, 18.753558293098763, 19.99695456961108, 22.881552125202305, 22.45212693393226, 23.78287780746215, 25.586904232523942, 19.78285548323449, 21.891367492684427, 21.266175631897642, 23.38897752683579, 20.326555630266814, 21.559289803008593, 18.940090319142325, 21.479401932442688, 21.451625547252544, 19.077064137154107, 20.92997806011142, 21.58077458080186, 23.329106629066025, 21.35731455677816, 20.392953199732936, 20.02436640437912, 21.445750037783583, 17.602498479052844, 20.837912711217875, 19.443745616693622, 19.82815192829091, 21.638192724813862, 19.014833678902253, 20.75209985786703, 18.66005086942291, 21.069068940100248, 21.617860151102118, 22.070951480720563, 20.243765945072028, 22.938513260009614, 23.781728571006038, 23.821132042753508, 21.077045821469873, 22.393852031341584, 18.35410240932903, 20.581720249553914, 18.78390861920236, 19.3797370228005, 23.158449335883173, 22.482979204500808, 23.387499890502944, 22.681141106706665, 22.792387505846733, 21.536017476106515, 22.634072912057686, 22.59259328183013, 21.902977525827378, 22.670504509953066, 20.686047980123956, 24.19209987511649, 20.7590804753633, 22.734411774826924, 23.16066066570879, 21.40803291698924, 19.655596326152093, 21.93634874340342, 20.261041124220192, 21.94717244673106, 19.68736173386117, 20.041114145544523, 21.795834427891702, 22.684648836325493, 22.005451609691434, 21.23359550694179, 19.467373479173876, 22.296393412385616, 20.20725743426758, 19.711275546384428, 22.203796336369315, 19.385694555162544, 20.442844589871576, 19.394938803997018, 18.73700210602056, 22.126555071376238, 22.03125082526857, 24.794493485286868, 22.686607038970322, 19.173283526038226, 21.35556276773917, 19.12957862925238, 21.47506271889428, 22.14480565657219, 22.182738886527854, 20.71937099675393, 21.657726231125434, 22.204722445234065, 18.866628529870873], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.153426329785196, "mean_inference_ms": 8.112930666761535, "mean_action_processing_ms": 0.5526497071667067, "mean_env_wait_ms": 23.943282734347036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024357318878173828, "StateBufferConnector_ms": 0.03316068649291992, "ViewRequirementAgentConnector_ms": 0.953798770904541}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1325386, "num_agent_steps_trained": 1325386, "num_env_steps_sampled": 1325386, "num_env_steps_trained": 1325386, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.4242371782404, "num_env_steps_trained_throughput_per_sec": 281.4242371782404, "timesteps_total": 1325386, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1325386, "timers": {"training_iteration_time_ms": 56863.117, "sample_time_ms": 42225.065, "load_time_ms": 1877.441, "load_throughput": 8329.424, "learn_time_ms": 12190.465, "learn_throughput": 1282.806, "synch_weights_time_ms": 453.652}, "counters": {"num_env_steps_sampled": 1325386, "num_env_steps_trained": 1325386, "num_agent_steps_sampled": 1325386, "num_agent_steps_trained": 1325386}, "done": false, "episodes_total": 322, "training_iteration": 89, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-51-22", "timestamp": 1749243082, "time_this_iter_s": 55.58533549308777, "time_total_s": 1321.9722273349762, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1321.9722273349762, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 77.1953125, "ram_util_percent": 65.0375, "gpu_util_percent0": 0.08515625, "vram_util_percent0": 0.8592122395833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": 2.4406686039647054, "episode_reward_min": -3.8090036796832476, "episode_reward_mean": -0.849337401289502, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8090036796832476, 2.4406686039647054, -1.4533210685901088, -1.5242890146659769, 0.09925815252711823], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5835269816065993, "mean_inference_ms": 3.6106753806971157, "mean_action_processing_ms": 0.3104891219203, "mean_env_wait_ms": 11.687505508583122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.6234979629516602}}, "episode_reward_max": 2.4406686039647054, "episode_reward_min": -3.8090036796832476, "episode_reward_mean": -0.849337401289502, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8090036796832476, 2.4406686039647054, -1.4533210685901088, -1.5242890146659769, 0.09925815252711823], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5835269816065993, "mean_inference_ms": 3.6106753806971157, "mean_action_processing_ms": 0.3104891219203, "mean_env_wait_ms": 11.687505508583122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.6234979629516602}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.674614000000002e-05, "total_loss": -0.11122806480704722, "policy_loss": -0.02719853454369348, "vf_loss": 0.013263485744934191, "vf_explained_var": 0.9016912392052737, "kl": 0.021304881336244127, "entropy": 17.804223937988283, "entropy_coeff": 0.0055820466666666665}, "model": {}, "num_grad_updates_lifetime": 12925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1341024, "num_env_steps_trained": 1341024, "num_agent_steps_sampled": 1341024, "num_agent_steps_trained": 1341024}, "sampler_results": {"episode_reward_max": 24.794493485286868, "episode_reward_min": 17.602498479052844, "episode_reward_mean": 21.270831113199584, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.891367492684427, 21.266175631897642, 23.38897752683579, 20.326555630266814, 21.559289803008593, 18.940090319142325, 21.479401932442688, 21.451625547252544, 19.077064137154107, 20.92997806011142, 21.58077458080186, 23.329106629066025, 21.35731455677816, 20.392953199732936, 20.02436640437912, 21.445750037783583, 17.602498479052844, 20.837912711217875, 19.443745616693622, 19.82815192829091, 21.638192724813862, 19.014833678902253, 20.75209985786703, 18.66005086942291, 21.069068940100248, 21.617860151102118, 22.070951480720563, 20.243765945072028, 22.938513260009614, 23.781728571006038, 23.821132042753508, 21.077045821469873, 22.393852031341584, 18.35410240932903, 20.581720249553914, 18.78390861920236, 19.3797370228005, 23.158449335883173, 22.482979204500808, 23.387499890502944, 22.681141106706665, 22.792387505846733, 21.536017476106515, 22.634072912057686, 22.59259328183013, 21.902977525827378, 22.670504509953066, 20.686047980123956, 24.19209987511649, 20.7590804753633, 22.734411774826924, 23.16066066570879, 21.40803291698924, 19.655596326152093, 21.93634874340342, 20.261041124220192, 21.94717244673106, 19.68736173386117, 20.041114145544523, 21.795834427891702, 22.684648836325493, 22.005451609691434, 21.23359550694179, 19.467373479173876, 22.296393412385616, 20.20725743426758, 19.711275546384428, 22.203796336369315, 19.385694555162544, 20.442844589871576, 19.394938803997018, 18.73700210602056, 22.126555071376238, 22.03125082526857, 24.794493485286868, 22.686607038970322, 19.173283526038226, 21.35556276773917, 19.12957862925238, 21.47506271889428, 22.14480565657219, 22.182738886527854, 20.71937099675393, 21.657726231125434, 22.204722445234065, 18.866628529870873, 21.864067942830964, 21.742919362047733, 21.836896332895932, 24.34804349483203, 19.166447186979106, 19.602507685431544, 22.139954547572145, 18.246901914559093, 22.40362094923109, 21.039652566711222, 21.520354686272768, 23.311552176590222, 22.817512615387564, 22.288931547906675], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1501527504355256, "mean_inference_ms": 8.117353367488038, "mean_action_processing_ms": 0.5528545804701183, "mean_env_wait_ms": 23.94437981947033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021318435668945312, "StateBufferConnector_ms": 0.027852535247802734, "ViewRequirementAgentConnector_ms": 0.9462368488311768}}, "episode_reward_max": 24.794493485286868, "episode_reward_min": 17.602498479052844, "episode_reward_mean": 21.270831113199584, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.891367492684427, 21.266175631897642, 23.38897752683579, 20.326555630266814, 21.559289803008593, 18.940090319142325, 21.479401932442688, 21.451625547252544, 19.077064137154107, 20.92997806011142, 21.58077458080186, 23.329106629066025, 21.35731455677816, 20.392953199732936, 20.02436640437912, 21.445750037783583, 17.602498479052844, 20.837912711217875, 19.443745616693622, 19.82815192829091, 21.638192724813862, 19.014833678902253, 20.75209985786703, 18.66005086942291, 21.069068940100248, 21.617860151102118, 22.070951480720563, 20.243765945072028, 22.938513260009614, 23.781728571006038, 23.821132042753508, 21.077045821469873, 22.393852031341584, 18.35410240932903, 20.581720249553914, 18.78390861920236, 19.3797370228005, 23.158449335883173, 22.482979204500808, 23.387499890502944, 22.681141106706665, 22.792387505846733, 21.536017476106515, 22.634072912057686, 22.59259328183013, 21.902977525827378, 22.670504509953066, 20.686047980123956, 24.19209987511649, 20.7590804753633, 22.734411774826924, 23.16066066570879, 21.40803291698924, 19.655596326152093, 21.93634874340342, 20.261041124220192, 21.94717244673106, 19.68736173386117, 20.041114145544523, 21.795834427891702, 22.684648836325493, 22.005451609691434, 21.23359550694179, 19.467373479173876, 22.296393412385616, 20.20725743426758, 19.711275546384428, 22.203796336369315, 19.385694555162544, 20.442844589871576, 19.394938803997018, 18.73700210602056, 22.126555071376238, 22.03125082526857, 24.794493485286868, 22.686607038970322, 19.173283526038226, 21.35556276773917, 19.12957862925238, 21.47506271889428, 22.14480565657219, 22.182738886527854, 20.71937099675393, 21.657726231125434, 22.204722445234065, 18.866628529870873, 21.864067942830964, 21.742919362047733, 21.836896332895932, 24.34804349483203, 19.166447186979106, 19.602507685431544, 22.139954547572145, 18.246901914559093, 22.40362094923109, 21.039652566711222, 21.520354686272768, 23.311552176590222, 22.817512615387564, 22.288931547906675], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1501527504355256, "mean_inference_ms": 8.117353367488038, "mean_action_processing_ms": 0.5528545804701183, "mean_env_wait_ms": 23.94437981947033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021318435668945312, "StateBufferConnector_ms": 0.027852535247802734, "ViewRequirementAgentConnector_ms": 0.9462368488311768}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1341024, "num_agent_steps_trained": 1341024, "num_env_steps_sampled": 1341024, "num_env_steps_trained": 1341024, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.1145666993838, "num_env_steps_trained_throughput_per_sec": 285.1145666993838, "timesteps_total": 1341024, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1341024, "timers": {"training_iteration_time_ms": 56852.458, "sample_time_ms": 42186.581, "load_time_ms": 1864.373, "load_throughput": 8387.805, "learn_time_ms": 12230.876, "learn_throughput": 1278.567, "synch_weights_time_ms": 455.153}, "counters": {"num_env_steps_sampled": 1341024, "num_env_steps_trained": 1341024, "num_agent_steps_sampled": 1341024, "num_agent_steps_trained": 1341024}, "done": false, "episodes_total": 336, "training_iteration": 90, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-52-33", "timestamp": 1749243153, "time_this_iter_s": 71.1888575553894, "time_total_s": 1393.1610848903656, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1393.1610848903656, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 61.98690476190477, "ram_util_percent": 64.64999999999999, "gpu_util_percent0": 0.06678571428571428, "vram_util_percent0": 0.859212239583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.658976e-05, "total_loss": -0.1124793918739835, "policy_loss": -0.029955346803815865, "vf_loss": 0.014006967236795885, "vf_explained_var": 0.8915387308597564, "kl": 0.021668829593108965, "entropy": 17.775282674269242, "entropy_coeff": 0.005529920000000001}, "model": {}, "num_grad_updates_lifetime": 13475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1356662, "num_env_steps_trained": 1356662, "num_agent_steps_sampled": 1356662, "num_agent_steps_trained": 1356662}, "sampler_results": {"episode_reward_max": 24.794493485286868, "episode_reward_min": 17.602498479052844, "episode_reward_mean": 21.239155028546573, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.02436640437912, 21.445750037783583, 17.602498479052844, 20.837912711217875, 19.443745616693622, 19.82815192829091, 21.638192724813862, 19.014833678902253, 20.75209985786703, 18.66005086942291, 21.069068940100248, 21.617860151102118, 22.070951480720563, 20.243765945072028, 22.938513260009614, 23.781728571006038, 23.821132042753508, 21.077045821469873, 22.393852031341584, 18.35410240932903, 20.581720249553914, 18.78390861920236, 19.3797370228005, 23.158449335883173, 22.482979204500808, 23.387499890502944, 22.681141106706665, 22.792387505846733, 21.536017476106515, 22.634072912057686, 22.59259328183013, 21.902977525827378, 22.670504509953066, 20.686047980123956, 24.19209987511649, 20.7590804753633, 22.734411774826924, 23.16066066570879, 21.40803291698924, 19.655596326152093, 21.93634874340342, 20.261041124220192, 21.94717244673106, 19.68736173386117, 20.041114145544523, 21.795834427891702, 22.684648836325493, 22.005451609691434, 21.23359550694179, 19.467373479173876, 22.296393412385616, 20.20725743426758, 19.711275546384428, 22.203796336369315, 19.385694555162544, 20.442844589871576, 19.394938803997018, 18.73700210602056, 22.126555071376238, 22.03125082526857, 24.794493485286868, 22.686607038970322, 19.173283526038226, 21.35556276773917, 19.12957862925238, 21.47506271889428, 22.14480565657219, 22.182738886527854, 20.71937099675393, 21.657726231125434, 22.204722445234065, 18.866628529870873, 21.864067942830964, 21.742919362047733, 21.836896332895932, 24.34804349483203, 19.166447186979106, 19.602507685431544, 22.139954547572145, 18.246901914559093, 22.40362094923109, 21.039652566711222, 21.520354686272768, 23.311552176590222, 22.817512615387564, 22.288931547906675, 18.475470616221727, 23.827430694538023, 20.24501003588574, 19.74212270597911, 20.47763759078116, 20.854004046651596, 22.475434432235726, 21.77153516790571, 21.436166231228842, 21.825736700997815, 20.91334595026642, 18.713089700611985, 20.129746446914144, 22.9163362616569], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1478421821850486, "mean_inference_ms": 8.119031677112371, "mean_action_processing_ms": 0.5529778438554754, "mean_env_wait_ms": 23.94365190460181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026300668716430664, "StateBufferConnector_ms": 0.030823469161987305, "ViewRequirementAgentConnector_ms": 0.9470038414001465}}, "episode_reward_max": 24.794493485286868, "episode_reward_min": 17.602498479052844, "episode_reward_mean": 21.239155028546573, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.02436640437912, 21.445750037783583, 17.602498479052844, 20.837912711217875, 19.443745616693622, 19.82815192829091, 21.638192724813862, 19.014833678902253, 20.75209985786703, 18.66005086942291, 21.069068940100248, 21.617860151102118, 22.070951480720563, 20.243765945072028, 22.938513260009614, 23.781728571006038, 23.821132042753508, 21.077045821469873, 22.393852031341584, 18.35410240932903, 20.581720249553914, 18.78390861920236, 19.3797370228005, 23.158449335883173, 22.482979204500808, 23.387499890502944, 22.681141106706665, 22.792387505846733, 21.536017476106515, 22.634072912057686, 22.59259328183013, 21.902977525827378, 22.670504509953066, 20.686047980123956, 24.19209987511649, 20.7590804753633, 22.734411774826924, 23.16066066570879, 21.40803291698924, 19.655596326152093, 21.93634874340342, 20.261041124220192, 21.94717244673106, 19.68736173386117, 20.041114145544523, 21.795834427891702, 22.684648836325493, 22.005451609691434, 21.23359550694179, 19.467373479173876, 22.296393412385616, 20.20725743426758, 19.711275546384428, 22.203796336369315, 19.385694555162544, 20.442844589871576, 19.394938803997018, 18.73700210602056, 22.126555071376238, 22.03125082526857, 24.794493485286868, 22.686607038970322, 19.173283526038226, 21.35556276773917, 19.12957862925238, 21.47506271889428, 22.14480565657219, 22.182738886527854, 20.71937099675393, 21.657726231125434, 22.204722445234065, 18.866628529870873, 21.864067942830964, 21.742919362047733, 21.836896332895932, 24.34804349483203, 19.166447186979106, 19.602507685431544, 22.139954547572145, 18.246901914559093, 22.40362094923109, 21.039652566711222, 21.520354686272768, 23.311552176590222, 22.817512615387564, 22.288931547906675, 18.475470616221727, 23.827430694538023, 20.24501003588574, 19.74212270597911, 20.47763759078116, 20.854004046651596, 22.475434432235726, 21.77153516790571, 21.436166231228842, 21.825736700997815, 20.91334595026642, 18.713089700611985, 20.129746446914144, 22.9163362616569], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1478421821850486, "mean_inference_ms": 8.119031677112371, "mean_action_processing_ms": 0.5529778438554754, "mean_env_wait_ms": 23.94365190460181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026300668716430664, "StateBufferConnector_ms": 0.030823469161987305, "ViewRequirementAgentConnector_ms": 0.9470038414001465}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356662, "num_agent_steps_trained": 1356662, "num_env_steps_sampled": 1356662, "num_env_steps_trained": 1356662, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.3155944161188, "num_env_steps_trained_throughput_per_sec": 280.3155944161188, "timesteps_total": 1356662, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1356662, "timers": {"training_iteration_time_ms": 56483.484, "sample_time_ms": 42019.446, "load_time_ms": 1863.065, "load_throughput": 8393.696, "learn_time_ms": 12034.088, "learn_throughput": 1299.475, "synch_weights_time_ms": 456.06}, "counters": {"num_env_steps_sampled": 1356662, "num_env_steps_trained": 1356662, "num_agent_steps_sampled": 1356662, "num_agent_steps_trained": 1356662}, "done": false, "episodes_total": 350, "training_iteration": 91, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-53-29", "timestamp": 1749243209, "time_this_iter_s": 55.80711078643799, "time_total_s": 1448.9681956768036, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1448.9681956768036, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 76.0, "ram_util_percent": 65.22615384615385, "gpu_util_percent0": 0.07630769230769231, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.643338e-05, "total_loss": -0.1104078021662479, "policy_loss": -0.028625146680913698, "vf_loss": 0.014446422872556881, "vf_explained_var": 0.8935857672041113, "kl": 0.02114619266125673, "entropy": 17.782212201898748, "entropy_coeff": 0.005477793333333334}, "model": {}, "num_grad_updates_lifetime": 14025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1372300, "num_env_steps_trained": 1372300, "num_agent_steps_sampled": 1372300, "num_agent_steps_trained": 1372300}, "sampler_results": {"episode_reward_max": 24.794493485286868, "episode_reward_min": 18.246901914559093, "episode_reward_mean": 21.38789422781204, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.938513260009614, 23.781728571006038, 23.821132042753508, 21.077045821469873, 22.393852031341584, 18.35410240932903, 20.581720249553914, 18.78390861920236, 19.3797370228005, 23.158449335883173, 22.482979204500808, 23.387499890502944, 22.681141106706665, 22.792387505846733, 21.536017476106515, 22.634072912057686, 22.59259328183013, 21.902977525827378, 22.670504509953066, 20.686047980123956, 24.19209987511649, 20.7590804753633, 22.734411774826924, 23.16066066570879, 21.40803291698924, 19.655596326152093, 21.93634874340342, 20.261041124220192, 21.94717244673106, 19.68736173386117, 20.041114145544523, 21.795834427891702, 22.684648836325493, 22.005451609691434, 21.23359550694179, 19.467373479173876, 22.296393412385616, 20.20725743426758, 19.711275546384428, 22.203796336369315, 19.385694555162544, 20.442844589871576, 19.394938803997018, 18.73700210602056, 22.126555071376238, 22.03125082526857, 24.794493485286868, 22.686607038970322, 19.173283526038226, 21.35556276773917, 19.12957862925238, 21.47506271889428, 22.14480565657219, 22.182738886527854, 20.71937099675393, 21.657726231125434, 22.204722445234065, 18.866628529870873, 21.864067942830964, 21.742919362047733, 21.836896332895932, 24.34804349483203, 19.166447186979106, 19.602507685431544, 22.139954547572145, 18.246901914559093, 22.40362094923109, 21.039652566711222, 21.520354686272768, 23.311552176590222, 22.817512615387564, 22.288931547906675, 18.475470616221727, 23.827430694538023, 20.24501003588574, 19.74212270597911, 20.47763759078116, 20.854004046651596, 22.475434432235726, 21.77153516790571, 21.436166231228842, 21.825736700997815, 20.91334595026642, 18.713089700611985, 20.129746446914144, 22.9163362616569, 20.76215641885743, 22.27495633672546, 21.958295069663503, 18.541028110416896, 22.946840444133304, 21.98581537109219, 20.36405455232142, 20.75981158053166, 20.96638945613514, 19.79226033053671, 21.055085277332562, 23.07230137484918, 23.863170041502553, 20.781004387866673], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1467942777172597, "mean_inference_ms": 8.118328870034663, "mean_action_processing_ms": 0.5529715468115165, "mean_env_wait_ms": 23.93814556070662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026283740997314453, "StateBufferConnector_ms": 0.03762984275817871, "ViewRequirementAgentConnector_ms": 0.9554181098937988}}, "episode_reward_max": 24.794493485286868, "episode_reward_min": 18.246901914559093, "episode_reward_mean": 21.38789422781204, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.938513260009614, 23.781728571006038, 23.821132042753508, 21.077045821469873, 22.393852031341584, 18.35410240932903, 20.581720249553914, 18.78390861920236, 19.3797370228005, 23.158449335883173, 22.482979204500808, 23.387499890502944, 22.681141106706665, 22.792387505846733, 21.536017476106515, 22.634072912057686, 22.59259328183013, 21.902977525827378, 22.670504509953066, 20.686047980123956, 24.19209987511649, 20.7590804753633, 22.734411774826924, 23.16066066570879, 21.40803291698924, 19.655596326152093, 21.93634874340342, 20.261041124220192, 21.94717244673106, 19.68736173386117, 20.041114145544523, 21.795834427891702, 22.684648836325493, 22.005451609691434, 21.23359550694179, 19.467373479173876, 22.296393412385616, 20.20725743426758, 19.711275546384428, 22.203796336369315, 19.385694555162544, 20.442844589871576, 19.394938803997018, 18.73700210602056, 22.126555071376238, 22.03125082526857, 24.794493485286868, 22.686607038970322, 19.173283526038226, 21.35556276773917, 19.12957862925238, 21.47506271889428, 22.14480565657219, 22.182738886527854, 20.71937099675393, 21.657726231125434, 22.204722445234065, 18.866628529870873, 21.864067942830964, 21.742919362047733, 21.836896332895932, 24.34804349483203, 19.166447186979106, 19.602507685431544, 22.139954547572145, 18.246901914559093, 22.40362094923109, 21.039652566711222, 21.520354686272768, 23.311552176590222, 22.817512615387564, 22.288931547906675, 18.475470616221727, 23.827430694538023, 20.24501003588574, 19.74212270597911, 20.47763759078116, 20.854004046651596, 22.475434432235726, 21.77153516790571, 21.436166231228842, 21.825736700997815, 20.91334595026642, 18.713089700611985, 20.129746446914144, 22.9163362616569, 20.76215641885743, 22.27495633672546, 21.958295069663503, 18.541028110416896, 22.946840444133304, 21.98581537109219, 20.36405455232142, 20.75981158053166, 20.96638945613514, 19.79226033053671, 21.055085277332562, 23.07230137484918, 23.863170041502553, 20.781004387866673], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1467942777172597, "mean_inference_ms": 8.118328870034663, "mean_action_processing_ms": 0.5529715468115165, "mean_env_wait_ms": 23.93814556070662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026283740997314453, "StateBufferConnector_ms": 0.03762984275817871, "ViewRequirementAgentConnector_ms": 0.9554181098937988}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1372300, "num_agent_steps_trained": 1372300, "num_env_steps_sampled": 1372300, "num_env_steps_trained": 1372300, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.09869967754327, "num_env_steps_trained_throughput_per_sec": 283.09869967754327, "timesteps_total": 1372300, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1372300, "timers": {"training_iteration_time_ms": 56172.512, "sample_time_ms": 41893.835, "load_time_ms": 1853.845, "load_throughput": 8435.443, "learn_time_ms": 11861.405, "learn_throughput": 1318.394, "synch_weights_time_ms": 452.021}, "counters": {"num_env_steps_sampled": 1372300, "num_env_steps_trained": 1372300, "num_agent_steps_sampled": 1372300, "num_agent_steps_trained": 1372300}, "done": false, "episodes_total": 364, "training_iteration": 92, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-54-24", "timestamp": 1749243264, "time_this_iter_s": 55.256690979003906, "time_total_s": 1504.2248866558075, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1504.2248866558075, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 76.31718749999999, "ram_util_percent": 65.19375, "gpu_util_percent0": 0.0884375, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.627700000000001e-05, "total_loss": -0.11039490058383142, "policy_loss": -0.027926816252398897, "vf_loss": 0.013217605702494356, "vf_explained_var": 0.8760139696164565, "kl": 0.019815406986771533, "entropy": 17.880479327115147, "entropy_coeff": 0.005425666666666667}, "model": {}, "num_grad_updates_lifetime": 14575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1387938, "num_env_steps_trained": 1387938, "num_agent_steps_sampled": 1387938, "num_agent_steps_trained": 1387938}, "sampler_results": {"episode_reward_max": 24.794493485286868, "episode_reward_min": 15.997507865119855, "episode_reward_mean": 21.222949889065077, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.536017476106515, 22.634072912057686, 22.59259328183013, 21.902977525827378, 22.670504509953066, 20.686047980123956, 24.19209987511649, 20.7590804753633, 22.734411774826924, 23.16066066570879, 21.40803291698924, 19.655596326152093, 21.93634874340342, 20.261041124220192, 21.94717244673106, 19.68736173386117, 20.041114145544523, 21.795834427891702, 22.684648836325493, 22.005451609691434, 21.23359550694179, 19.467373479173876, 22.296393412385616, 20.20725743426758, 19.711275546384428, 22.203796336369315, 19.385694555162544, 20.442844589871576, 19.394938803997018, 18.73700210602056, 22.126555071376238, 22.03125082526857, 24.794493485286868, 22.686607038970322, 19.173283526038226, 21.35556276773917, 19.12957862925238, 21.47506271889428, 22.14480565657219, 22.182738886527854, 20.71937099675393, 21.657726231125434, 22.204722445234065, 18.866628529870873, 21.864067942830964, 21.742919362047733, 21.836896332895932, 24.34804349483203, 19.166447186979106, 19.602507685431544, 22.139954547572145, 18.246901914559093, 22.40362094923109, 21.039652566711222, 21.520354686272768, 23.311552176590222, 22.817512615387564, 22.288931547906675, 18.475470616221727, 23.827430694538023, 20.24501003588574, 19.74212270597911, 20.47763759078116, 20.854004046651596, 22.475434432235726, 21.77153516790571, 21.436166231228842, 21.825736700997815, 20.91334595026642, 18.713089700611985, 20.129746446914144, 22.9163362616569, 20.76215641885743, 22.27495633672546, 21.958295069663503, 18.541028110416896, 22.946840444133304, 21.98581537109219, 20.36405455232142, 20.75981158053166, 20.96638945613514, 19.79226033053671, 21.055085277332562, 23.07230137484918, 23.863170041502553, 20.781004387866673, 22.76743975106754, 15.997507865119855, 20.553969223369666, 20.182470173288245, 19.06709800043322, 22.337212659946537, 20.83516439904232, 20.089472060823404, 22.783626085236172, 20.743783959180657, 18.628563074633732, 21.7262822364072, 20.997559799426003, 22.40961390823597], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1432677354323078, "mean_inference_ms": 8.116643574589808, "mean_action_processing_ms": 0.55295902597441, "mean_env_wait_ms": 23.929464613177252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023279666900634766, "StateBufferConnector_ms": 0.03864288330078125, "ViewRequirementAgentConnector_ms": 0.9563243389129639}}, "episode_reward_max": 24.794493485286868, "episode_reward_min": 15.997507865119855, "episode_reward_mean": 21.222949889065077, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.536017476106515, 22.634072912057686, 22.59259328183013, 21.902977525827378, 22.670504509953066, 20.686047980123956, 24.19209987511649, 20.7590804753633, 22.734411774826924, 23.16066066570879, 21.40803291698924, 19.655596326152093, 21.93634874340342, 20.261041124220192, 21.94717244673106, 19.68736173386117, 20.041114145544523, 21.795834427891702, 22.684648836325493, 22.005451609691434, 21.23359550694179, 19.467373479173876, 22.296393412385616, 20.20725743426758, 19.711275546384428, 22.203796336369315, 19.385694555162544, 20.442844589871576, 19.394938803997018, 18.73700210602056, 22.126555071376238, 22.03125082526857, 24.794493485286868, 22.686607038970322, 19.173283526038226, 21.35556276773917, 19.12957862925238, 21.47506271889428, 22.14480565657219, 22.182738886527854, 20.71937099675393, 21.657726231125434, 22.204722445234065, 18.866628529870873, 21.864067942830964, 21.742919362047733, 21.836896332895932, 24.34804349483203, 19.166447186979106, 19.602507685431544, 22.139954547572145, 18.246901914559093, 22.40362094923109, 21.039652566711222, 21.520354686272768, 23.311552176590222, 22.817512615387564, 22.288931547906675, 18.475470616221727, 23.827430694538023, 20.24501003588574, 19.74212270597911, 20.47763759078116, 20.854004046651596, 22.475434432235726, 21.77153516790571, 21.436166231228842, 21.825736700997815, 20.91334595026642, 18.713089700611985, 20.129746446914144, 22.9163362616569, 20.76215641885743, 22.27495633672546, 21.958295069663503, 18.541028110416896, 22.946840444133304, 21.98581537109219, 20.36405455232142, 20.75981158053166, 20.96638945613514, 19.79226033053671, 21.055085277332562, 23.07230137484918, 23.863170041502553, 20.781004387866673, 22.76743975106754, 15.997507865119855, 20.553969223369666, 20.182470173288245, 19.06709800043322, 22.337212659946537, 20.83516439904232, 20.089472060823404, 22.783626085236172, 20.743783959180657, 18.628563074633732, 21.7262822364072, 20.997559799426003, 22.40961390823597], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1432677354323078, "mean_inference_ms": 8.116643574589808, "mean_action_processing_ms": 0.55295902597441, "mean_env_wait_ms": 23.929464613177252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023279666900634766, "StateBufferConnector_ms": 0.03864288330078125, "ViewRequirementAgentConnector_ms": 0.9563243389129639}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1387938, "num_agent_steps_trained": 1387938, "num_env_steps_sampled": 1387938, "num_env_steps_trained": 1387938, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.21925126727217, "num_env_steps_trained_throughput_per_sec": 282.21925126727217, "timesteps_total": 1387938, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1387938, "timers": {"training_iteration_time_ms": 55894.591, "sample_time_ms": 41755.344, "load_time_ms": 1841.874, "load_throughput": 8490.264, "learn_time_ms": 11733.562, "learn_throughput": 1332.758, "synch_weights_time_ms": 451.088}, "counters": {"num_env_steps_sampled": 1387938, "num_env_steps_trained": 1387938, "num_agent_steps_sampled": 1387938, "num_agent_steps_trained": 1387938}, "done": false, "episodes_total": 378, "training_iteration": 93, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-55-20", "timestamp": 1749243320, "time_this_iter_s": 55.430405378341675, "time_total_s": 1559.6552920341492, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1559.6552920341492, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 75.34843749999999, "ram_util_percent": 65.265625, "gpu_util_percent0": 0.0796875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.612062000000001e-05, "total_loss": -0.09825261265335773, "policy_loss": -0.016474185840197605, "vf_loss": 0.012893426410261203, "vf_explained_var": 0.8904477738250386, "kl": 0.020129400116142775, "entropy": 17.93868827646429, "entropy_coeff": 0.005373540000000002}, "model": {}, "num_grad_updates_lifetime": 15125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1403576, "num_env_steps_trained": 1403576, "num_agent_steps_sampled": 1403576, "num_agent_steps_trained": 1403576}, "sampler_results": {"episode_reward_max": 24.794493485286868, "episode_reward_min": 15.997507865119855, "episode_reward_mean": 21.138402062230938, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.94717244673106, 19.68736173386117, 20.041114145544523, 21.795834427891702, 22.684648836325493, 22.005451609691434, 21.23359550694179, 19.467373479173876, 22.296393412385616, 20.20725743426758, 19.711275546384428, 22.203796336369315, 19.385694555162544, 20.442844589871576, 19.394938803997018, 18.73700210602056, 22.126555071376238, 22.03125082526857, 24.794493485286868, 22.686607038970322, 19.173283526038226, 21.35556276773917, 19.12957862925238, 21.47506271889428, 22.14480565657219, 22.182738886527854, 20.71937099675393, 21.657726231125434, 22.204722445234065, 18.866628529870873, 21.864067942830964, 21.742919362047733, 21.836896332895932, 24.34804349483203, 19.166447186979106, 19.602507685431544, 22.139954547572145, 18.246901914559093, 22.40362094923109, 21.039652566711222, 21.520354686272768, 23.311552176590222, 22.817512615387564, 22.288931547906675, 18.475470616221727, 23.827430694538023, 20.24501003588574, 19.74212270597911, 20.47763759078116, 20.854004046651596, 22.475434432235726, 21.77153516790571, 21.436166231228842, 21.825736700997815, 20.91334595026642, 18.713089700611985, 20.129746446914144, 22.9163362616569, 20.76215641885743, 22.27495633672546, 21.958295069663503, 18.541028110416896, 22.946840444133304, 21.98581537109219, 20.36405455232142, 20.75981158053166, 20.96638945613514, 19.79226033053671, 21.055085277332562, 23.07230137484918, 23.863170041502553, 20.781004387866673, 22.76743975106754, 15.997507865119855, 20.553969223369666, 20.182470173288245, 19.06709800043322, 22.337212659946537, 20.83516439904232, 20.089472060823404, 22.783626085236172, 20.743783959180657, 18.628563074633732, 21.7262822364072, 20.997559799426003, 22.40961390823597, 21.8854734339828, 22.368092368677612, 21.403478781829858, 22.2503363126857, 21.633562638607632, 24.468571429829073, 17.88546046249539, 20.846562855253868, 19.97943616933243, 17.630386530646057, 23.785545847005725, 21.513439786760536, 22.015549210029675, 20.0088070771292], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1401431380709197, "mean_inference_ms": 8.114305580503718, "mean_action_processing_ms": 0.552915332987416, "mean_env_wait_ms": 23.920905454631434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026165008544921875, "StateBufferConnector_ms": 0.03666543960571289, "ViewRequirementAgentConnector_ms": 0.9312961101531982}}, "episode_reward_max": 24.794493485286868, "episode_reward_min": 15.997507865119855, "episode_reward_mean": 21.138402062230938, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.94717244673106, 19.68736173386117, 20.041114145544523, 21.795834427891702, 22.684648836325493, 22.005451609691434, 21.23359550694179, 19.467373479173876, 22.296393412385616, 20.20725743426758, 19.711275546384428, 22.203796336369315, 19.385694555162544, 20.442844589871576, 19.394938803997018, 18.73700210602056, 22.126555071376238, 22.03125082526857, 24.794493485286868, 22.686607038970322, 19.173283526038226, 21.35556276773917, 19.12957862925238, 21.47506271889428, 22.14480565657219, 22.182738886527854, 20.71937099675393, 21.657726231125434, 22.204722445234065, 18.866628529870873, 21.864067942830964, 21.742919362047733, 21.836896332895932, 24.34804349483203, 19.166447186979106, 19.602507685431544, 22.139954547572145, 18.246901914559093, 22.40362094923109, 21.039652566711222, 21.520354686272768, 23.311552176590222, 22.817512615387564, 22.288931547906675, 18.475470616221727, 23.827430694538023, 20.24501003588574, 19.74212270597911, 20.47763759078116, 20.854004046651596, 22.475434432235726, 21.77153516790571, 21.436166231228842, 21.825736700997815, 20.91334595026642, 18.713089700611985, 20.129746446914144, 22.9163362616569, 20.76215641885743, 22.27495633672546, 21.958295069663503, 18.541028110416896, 22.946840444133304, 21.98581537109219, 20.36405455232142, 20.75981158053166, 20.96638945613514, 19.79226033053671, 21.055085277332562, 23.07230137484918, 23.863170041502553, 20.781004387866673, 22.76743975106754, 15.997507865119855, 20.553969223369666, 20.182470173288245, 19.06709800043322, 22.337212659946537, 20.83516439904232, 20.089472060823404, 22.783626085236172, 20.743783959180657, 18.628563074633732, 21.7262822364072, 20.997559799426003, 22.40961390823597, 21.8854734339828, 22.368092368677612, 21.403478781829858, 22.2503363126857, 21.633562638607632, 24.468571429829073, 17.88546046249539, 20.846562855253868, 19.97943616933243, 17.630386530646057, 23.785545847005725, 21.513439786760536, 22.015549210029675, 20.0088070771292], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1401431380709197, "mean_inference_ms": 8.114305580503718, "mean_action_processing_ms": 0.552915332987416, "mean_env_wait_ms": 23.920905454631434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026165008544921875, "StateBufferConnector_ms": 0.03666543960571289, "ViewRequirementAgentConnector_ms": 0.9312961101531982}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1403576, "num_agent_steps_trained": 1403576, "num_env_steps_sampled": 1403576, "num_env_steps_trained": 1403576, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.4855678562728, "num_env_steps_trained_throughput_per_sec": 281.4855678562728, "timesteps_total": 1403576, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1403576, "timers": {"training_iteration_time_ms": 55711.298, "sample_time_ms": 41659.405, "load_time_ms": 1849.818, "load_throughput": 8453.806, "learn_time_ms": 11648.718, "learn_throughput": 1342.465, "synch_weights_time_ms": 440.44}, "counters": {"num_env_steps_sampled": 1403576, "num_env_steps_trained": 1403576, "num_agent_steps_sampled": 1403576, "num_agent_steps_trained": 1403576}, "done": false, "episodes_total": 392, "training_iteration": 94, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-56-15", "timestamp": 1749243375, "time_this_iter_s": 55.58696246147156, "time_total_s": 1615.2422544956207, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1615.2422544956207, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 76.725, "ram_util_percent": 65.228125, "gpu_util_percent0": 0.07796875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.596424000000001e-05, "total_loss": -0.10858217291830277, "policy_loss": -0.027907641445953313, "vf_loss": 0.01361611633434553, "vf_explained_var": 0.8846607199582187, "kl": 0.020243121298160763, "entropy": 17.959118201515892, "entropy_coeff": 0.0053214133333333346}, "model": {}, "num_grad_updates_lifetime": 15675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1419214, "num_env_steps_trained": 1419214, "num_agent_steps_sampled": 1419214, "num_agent_steps_trained": 1419214}, "sampler_results": {"episode_reward_max": 24.794493485286868, "episode_reward_min": 15.997507865119855, "episode_reward_mean": 21.13920365986616, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.394938803997018, 18.73700210602056, 22.126555071376238, 22.03125082526857, 24.794493485286868, 22.686607038970322, 19.173283526038226, 21.35556276773917, 19.12957862925238, 21.47506271889428, 22.14480565657219, 22.182738886527854, 20.71937099675393, 21.657726231125434, 22.204722445234065, 18.866628529870873, 21.864067942830964, 21.742919362047733, 21.836896332895932, 24.34804349483203, 19.166447186979106, 19.602507685431544, 22.139954547572145, 18.246901914559093, 22.40362094923109, 21.039652566711222, 21.520354686272768, 23.311552176590222, 22.817512615387564, 22.288931547906675, 18.475470616221727, 23.827430694538023, 20.24501003588574, 19.74212270597911, 20.47763759078116, 20.854004046651596, 22.475434432235726, 21.77153516790571, 21.436166231228842, 21.825736700997815, 20.91334595026642, 18.713089700611985, 20.129746446914144, 22.9163362616569, 20.76215641885743, 22.27495633672546, 21.958295069663503, 18.541028110416896, 22.946840444133304, 21.98581537109219, 20.36405455232142, 20.75981158053166, 20.96638945613514, 19.79226033053671, 21.055085277332562, 23.07230137484918, 23.863170041502553, 20.781004387866673, 22.76743975106754, 15.997507865119855, 20.553969223369666, 20.182470173288245, 19.06709800043322, 22.337212659946537, 20.83516439904232, 20.089472060823404, 22.783626085236172, 20.743783959180657, 18.628563074633732, 21.7262822364072, 20.997559799426003, 22.40961390823597, 21.8854734339828, 22.368092368677612, 21.403478781829858, 22.2503363126857, 21.633562638607632, 24.468571429829073, 17.88546046249539, 20.846562855253868, 19.97943616933243, 17.630386530646057, 23.785545847005725, 21.513439786760536, 22.015549210029675, 20.0088070771292, 23.283710665979623, 19.321414534493627, 21.003674793843558, 20.077737318921006, 18.771629158021856, 18.91249574948055, 21.505302862394693, 22.42010191011831, 21.195874691899867, 20.983920530680212, 21.380066640816512, 19.941635550383868, 21.706589967623476, 22.685819449466745], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1366733458443745, "mean_inference_ms": 8.111930988724279, "mean_action_processing_ms": 0.5529552293530346, "mean_env_wait_ms": 23.9126370141043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029543161392211914, "StateBufferConnector_ms": 0.030574798583984375, "ViewRequirementAgentConnector_ms": 0.9040312767028809}}, "episode_reward_max": 24.794493485286868, "episode_reward_min": 15.997507865119855, "episode_reward_mean": 21.13920365986616, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.394938803997018, 18.73700210602056, 22.126555071376238, 22.03125082526857, 24.794493485286868, 22.686607038970322, 19.173283526038226, 21.35556276773917, 19.12957862925238, 21.47506271889428, 22.14480565657219, 22.182738886527854, 20.71937099675393, 21.657726231125434, 22.204722445234065, 18.866628529870873, 21.864067942830964, 21.742919362047733, 21.836896332895932, 24.34804349483203, 19.166447186979106, 19.602507685431544, 22.139954547572145, 18.246901914559093, 22.40362094923109, 21.039652566711222, 21.520354686272768, 23.311552176590222, 22.817512615387564, 22.288931547906675, 18.475470616221727, 23.827430694538023, 20.24501003588574, 19.74212270597911, 20.47763759078116, 20.854004046651596, 22.475434432235726, 21.77153516790571, 21.436166231228842, 21.825736700997815, 20.91334595026642, 18.713089700611985, 20.129746446914144, 22.9163362616569, 20.76215641885743, 22.27495633672546, 21.958295069663503, 18.541028110416896, 22.946840444133304, 21.98581537109219, 20.36405455232142, 20.75981158053166, 20.96638945613514, 19.79226033053671, 21.055085277332562, 23.07230137484918, 23.863170041502553, 20.781004387866673, 22.76743975106754, 15.997507865119855, 20.553969223369666, 20.182470173288245, 19.06709800043322, 22.337212659946537, 20.83516439904232, 20.089472060823404, 22.783626085236172, 20.743783959180657, 18.628563074633732, 21.7262822364072, 20.997559799426003, 22.40961390823597, 21.8854734339828, 22.368092368677612, 21.403478781829858, 22.2503363126857, 21.633562638607632, 24.468571429829073, 17.88546046249539, 20.846562855253868, 19.97943616933243, 17.630386530646057, 23.785545847005725, 21.513439786760536, 22.015549210029675, 20.0088070771292, 23.283710665979623, 19.321414534493627, 21.003674793843558, 20.077737318921006, 18.771629158021856, 18.91249574948055, 21.505302862394693, 22.42010191011831, 21.195874691899867, 20.983920530680212, 21.380066640816512, 19.941635550383868, 21.706589967623476, 22.685819449466745], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1366733458443745, "mean_inference_ms": 8.111930988724279, "mean_action_processing_ms": 0.5529552293530346, "mean_env_wait_ms": 23.9126370141043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029543161392211914, "StateBufferConnector_ms": 0.030574798583984375, "ViewRequirementAgentConnector_ms": 0.9040312767028809}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1419214, "num_agent_steps_trained": 1419214, "num_env_steps_sampled": 1419214, "num_env_steps_trained": 1419214, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.3296897303909, "num_env_steps_trained_throughput_per_sec": 284.3296897303909, "timesteps_total": 1419214, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1419214, "timers": {"training_iteration_time_ms": 55506.972, "sample_time_ms": 41533.584, "load_time_ms": 1842.143, "load_throughput": 8489.024, "learn_time_ms": 11573.981, "learn_throughput": 1351.134, "synch_weights_time_ms": 442.88}, "counters": {"num_env_steps_sampled": 1419214, "num_env_steps_trained": 1419214, "num_agent_steps_sampled": 1419214, "num_agent_steps_trained": 1419214}, "done": false, "episodes_total": 406, "training_iteration": 95, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-57-10", "timestamp": 1749243430, "time_this_iter_s": 55.017531871795654, "time_total_s": 1670.2597863674164, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1670.2597863674164, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 76.17656249999999, "ram_util_percent": 63.765625, "gpu_util_percent0": 0.07796875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.580786000000002e-05, "total_loss": -0.09821656460873783, "policy_loss": -0.01866232417668057, "vf_loss": 0.014633916307410056, "vf_explained_var": 0.882965496561744, "kl": 0.02020847408783838, "entropy": 17.978607822765003, "entropy_coeff": 0.005269286666666666}, "model": {}, "num_grad_updates_lifetime": 16225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1434852, "num_env_steps_trained": 1434852, "num_agent_steps_sampled": 1434852, "num_agent_steps_trained": 1434852}, "sampler_results": {"episode_reward_max": 24.468571429829073, "episode_reward_min": 15.997507865119855, "episode_reward_mean": 21.0083392754453, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.204722445234065, 18.866628529870873, 21.864067942830964, 21.742919362047733, 21.836896332895932, 24.34804349483203, 19.166447186979106, 19.602507685431544, 22.139954547572145, 18.246901914559093, 22.40362094923109, 21.039652566711222, 21.520354686272768, 23.311552176590222, 22.817512615387564, 22.288931547906675, 18.475470616221727, 23.827430694538023, 20.24501003588574, 19.74212270597911, 20.47763759078116, 20.854004046651596, 22.475434432235726, 21.77153516790571, 21.436166231228842, 21.825736700997815, 20.91334595026642, 18.713089700611985, 20.129746446914144, 22.9163362616569, 20.76215641885743, 22.27495633672546, 21.958295069663503, 18.541028110416896, 22.946840444133304, 21.98581537109219, 20.36405455232142, 20.75981158053166, 20.96638945613514, 19.79226033053671, 21.055085277332562, 23.07230137484918, 23.863170041502553, 20.781004387866673, 22.76743975106754, 15.997507865119855, 20.553969223369666, 20.182470173288245, 19.06709800043322, 22.337212659946537, 20.83516439904232, 20.089472060823404, 22.783626085236172, 20.743783959180657, 18.628563074633732, 21.7262822364072, 20.997559799426003, 22.40961390823597, 21.8854734339828, 22.368092368677612, 21.403478781829858, 22.2503363126857, 21.633562638607632, 24.468571429829073, 17.88546046249539, 20.846562855253868, 19.97943616933243, 17.630386530646057, 23.785545847005725, 21.513439786760536, 22.015549210029675, 20.0088070771292, 23.283710665979623, 19.321414534493627, 21.003674793843558, 20.077737318921006, 18.771629158021856, 18.91249574948055, 21.505302862394693, 22.42010191011831, 21.195874691899867, 20.983920530680212, 21.380066640816512, 19.941635550383868, 21.706589967623476, 22.685819449466745, 18.78123385225375, 21.83038327326554, 23.19222792986773, 21.63030799563401, 20.548441145199657, 20.931952124437657, 21.500751462003702, 19.260818773695824, 20.107947639059667, 18.94179893333976, 20.154921683344686, 18.45795242068934, 19.078135180330897, 20.105665888615416], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1332060112274354, "mean_inference_ms": 8.109183951314925, "mean_action_processing_ms": 0.5530749645705666, "mean_env_wait_ms": 23.902763074465298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028528451919555664, "StateBufferConnector_ms": 0.033631324768066406, "ViewRequirementAgentConnector_ms": 0.8807222843170166}}, "episode_reward_max": 24.468571429829073, "episode_reward_min": 15.997507865119855, "episode_reward_mean": 21.0083392754453, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.204722445234065, 18.866628529870873, 21.864067942830964, 21.742919362047733, 21.836896332895932, 24.34804349483203, 19.166447186979106, 19.602507685431544, 22.139954547572145, 18.246901914559093, 22.40362094923109, 21.039652566711222, 21.520354686272768, 23.311552176590222, 22.817512615387564, 22.288931547906675, 18.475470616221727, 23.827430694538023, 20.24501003588574, 19.74212270597911, 20.47763759078116, 20.854004046651596, 22.475434432235726, 21.77153516790571, 21.436166231228842, 21.825736700997815, 20.91334595026642, 18.713089700611985, 20.129746446914144, 22.9163362616569, 20.76215641885743, 22.27495633672546, 21.958295069663503, 18.541028110416896, 22.946840444133304, 21.98581537109219, 20.36405455232142, 20.75981158053166, 20.96638945613514, 19.79226033053671, 21.055085277332562, 23.07230137484918, 23.863170041502553, 20.781004387866673, 22.76743975106754, 15.997507865119855, 20.553969223369666, 20.182470173288245, 19.06709800043322, 22.337212659946537, 20.83516439904232, 20.089472060823404, 22.783626085236172, 20.743783959180657, 18.628563074633732, 21.7262822364072, 20.997559799426003, 22.40961390823597, 21.8854734339828, 22.368092368677612, 21.403478781829858, 22.2503363126857, 21.633562638607632, 24.468571429829073, 17.88546046249539, 20.846562855253868, 19.97943616933243, 17.630386530646057, 23.785545847005725, 21.513439786760536, 22.015549210029675, 20.0088070771292, 23.283710665979623, 19.321414534493627, 21.003674793843558, 20.077737318921006, 18.771629158021856, 18.91249574948055, 21.505302862394693, 22.42010191011831, 21.195874691899867, 20.983920530680212, 21.380066640816512, 19.941635550383868, 21.706589967623476, 22.685819449466745, 18.78123385225375, 21.83038327326554, 23.19222792986773, 21.63030799563401, 20.548441145199657, 20.931952124437657, 21.500751462003702, 19.260818773695824, 20.107947639059667, 18.94179893333976, 20.154921683344686, 18.45795242068934, 19.078135180330897, 20.105665888615416], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1332060112274354, "mean_inference_ms": 8.109183951314925, "mean_action_processing_ms": 0.5530749645705666, "mean_env_wait_ms": 23.902763074465298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028528451919555664, "StateBufferConnector_ms": 0.033631324768066406, "ViewRequirementAgentConnector_ms": 0.8807222843170166}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1434852, "num_agent_steps_trained": 1434852, "num_env_steps_sampled": 1434852, "num_env_steps_trained": 1434852, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 288.2464404596704, "num_env_steps_trained_throughput_per_sec": 288.2464404596704, "timesteps_total": 1434852, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1434852, "timers": {"training_iteration_time_ms": 55271.275, "sample_time_ms": 41347.084, "load_time_ms": 1815.226, "load_throughput": 8614.904, "learn_time_ms": 11553.486, "learn_throughput": 1353.531, "synch_weights_time_ms": 441.483}, "counters": {"num_env_steps_sampled": 1434852, "num_env_steps_trained": 1434852, "num_agent_steps_sampled": 1434852, "num_agent_steps_trained": 1434852}, "done": false, "episodes_total": 420, "training_iteration": 96, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-58-05", "timestamp": 1749243485, "time_this_iter_s": 54.27218770980835, "time_total_s": 1724.5319740772247, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1724.5319740772247, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 76.078125, "ram_util_percent": 63.7625, "gpu_util_percent0": 0.08171875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.565148e-05, "total_loss": -0.09675765941512178, "policy_loss": -0.018342488604499853, "vf_loss": 0.013802325797097927, "vf_explained_var": 0.8723519708893516, "kl": 0.020778031440174562, "entropy": 17.950378456115722, "entropy_coeff": 0.005217159999999999}, "model": {}, "num_grad_updates_lifetime": 16775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1450490, "num_env_steps_trained": 1450490, "num_agent_steps_sampled": 1450490, "num_agent_steps_trained": 1450490}, "sampler_results": {"episode_reward_max": 24.468571429829073, "episode_reward_min": 15.997507865119855, "episode_reward_mean": 20.908997696770456, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.817512615387564, 22.288931547906675, 18.475470616221727, 23.827430694538023, 20.24501003588574, 19.74212270597911, 20.47763759078116, 20.854004046651596, 22.475434432235726, 21.77153516790571, 21.436166231228842, 21.825736700997815, 20.91334595026642, 18.713089700611985, 20.129746446914144, 22.9163362616569, 20.76215641885743, 22.27495633672546, 21.958295069663503, 18.541028110416896, 22.946840444133304, 21.98581537109219, 20.36405455232142, 20.75981158053166, 20.96638945613514, 19.79226033053671, 21.055085277332562, 23.07230137484918, 23.863170041502553, 20.781004387866673, 22.76743975106754, 15.997507865119855, 20.553969223369666, 20.182470173288245, 19.06709800043322, 22.337212659946537, 20.83516439904232, 20.089472060823404, 22.783626085236172, 20.743783959180657, 18.628563074633732, 21.7262822364072, 20.997559799426003, 22.40961390823597, 21.8854734339828, 22.368092368677612, 21.403478781829858, 22.2503363126857, 21.633562638607632, 24.468571429829073, 17.88546046249539, 20.846562855253868, 19.97943616933243, 17.630386530646057, 23.785545847005725, 21.513439786760536, 22.015549210029675, 20.0088070771292, 23.283710665979623, 19.321414534493627, 21.003674793843558, 20.077737318921006, 18.771629158021856, 18.91249574948055, 21.505302862394693, 22.42010191011831, 21.195874691899867, 20.983920530680212, 21.380066640816512, 19.941635550383868, 21.706589967623476, 22.685819449466745, 18.78123385225375, 21.83038327326554, 23.19222792986773, 21.63030799563401, 20.548441145199657, 20.931952124437657, 21.500751462003702, 19.260818773695824, 20.107947639059667, 18.94179893333976, 20.154921683344686, 18.45795242068934, 19.078135180330897, 20.105665888615416, 19.42640397979736, 20.638775591590953, 23.05518896041495, 21.13836037773619, 20.508097629821716, 18.413770997873645, 20.835123239186547, 20.1178498777808, 19.59041265086129, 20.912243219917183, 20.52120542825196, 19.539074942976402, 21.22973732703943, 22.433867730325876], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1297954674405406, "mean_inference_ms": 8.107158883328621, "mean_action_processing_ms": 0.5531701443626431, "mean_env_wait_ms": 23.894232265390375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026529788970947266, "StateBufferConnector_ms": 0.03185868263244629, "ViewRequirementAgentConnector_ms": 0.8723127841949463}}, "episode_reward_max": 24.468571429829073, "episode_reward_min": 15.997507865119855, "episode_reward_mean": 20.908997696770456, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.817512615387564, 22.288931547906675, 18.475470616221727, 23.827430694538023, 20.24501003588574, 19.74212270597911, 20.47763759078116, 20.854004046651596, 22.475434432235726, 21.77153516790571, 21.436166231228842, 21.825736700997815, 20.91334595026642, 18.713089700611985, 20.129746446914144, 22.9163362616569, 20.76215641885743, 22.27495633672546, 21.958295069663503, 18.541028110416896, 22.946840444133304, 21.98581537109219, 20.36405455232142, 20.75981158053166, 20.96638945613514, 19.79226033053671, 21.055085277332562, 23.07230137484918, 23.863170041502553, 20.781004387866673, 22.76743975106754, 15.997507865119855, 20.553969223369666, 20.182470173288245, 19.06709800043322, 22.337212659946537, 20.83516439904232, 20.089472060823404, 22.783626085236172, 20.743783959180657, 18.628563074633732, 21.7262822364072, 20.997559799426003, 22.40961390823597, 21.8854734339828, 22.368092368677612, 21.403478781829858, 22.2503363126857, 21.633562638607632, 24.468571429829073, 17.88546046249539, 20.846562855253868, 19.97943616933243, 17.630386530646057, 23.785545847005725, 21.513439786760536, 22.015549210029675, 20.0088070771292, 23.283710665979623, 19.321414534493627, 21.003674793843558, 20.077737318921006, 18.771629158021856, 18.91249574948055, 21.505302862394693, 22.42010191011831, 21.195874691899867, 20.983920530680212, 21.380066640816512, 19.941635550383868, 21.706589967623476, 22.685819449466745, 18.78123385225375, 21.83038327326554, 23.19222792986773, 21.63030799563401, 20.548441145199657, 20.931952124437657, 21.500751462003702, 19.260818773695824, 20.107947639059667, 18.94179893333976, 20.154921683344686, 18.45795242068934, 19.078135180330897, 20.105665888615416, 19.42640397979736, 20.638775591590953, 23.05518896041495, 21.13836037773619, 20.508097629821716, 18.413770997873645, 20.835123239186547, 20.1178498777808, 19.59041265086129, 20.912243219917183, 20.52120542825196, 19.539074942976402, 21.22973732703943, 22.433867730325876], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1297954674405406, "mean_inference_ms": 8.107158883328621, "mean_action_processing_ms": 0.5531701443626431, "mean_env_wait_ms": 23.894232265390375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026529788970947266, "StateBufferConnector_ms": 0.03185868263244629, "ViewRequirementAgentConnector_ms": 0.8723127841949463}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1450490, "num_agent_steps_trained": 1450490, "num_env_steps_sampled": 1450490, "num_env_steps_trained": 1450490, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.4691842621348, "num_env_steps_trained_throughput_per_sec": 285.4691842621348, "timesteps_total": 1450490, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1450490, "timers": {"training_iteration_time_ms": 55269.301, "sample_time_ms": 41338.69, "load_time_ms": 1814.202, "load_throughput": 8619.766, "learn_time_ms": 11553.599, "learn_throughput": 1353.518, "synch_weights_time_ms": 446.432}, "counters": {"num_env_steps_sampled": 1450490, "num_env_steps_trained": 1450490, "num_agent_steps_sampled": 1450490, "num_agent_steps_trained": 1450490}, "done": false, "episodes_total": 434, "training_iteration": 97, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-59-00", "timestamp": 1749243540, "time_this_iter_s": 54.79999303817749, "time_total_s": 1779.3319671154022, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1779.3319671154022, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 76.165625, "ram_util_percent": 64.26249999999999, "gpu_util_percent0": 0.08750000000000001, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.549510000000001e-05, "total_loss": -0.08983779978218742, "policy_loss": -0.011934040023267947, "vf_loss": 0.014566526625474746, "vf_explained_var": 0.8772460737011649, "kl": 0.019700784648408774, "entropy": 17.96554990941828, "entropy_coeff": 0.0051650333333333335}, "model": {}, "num_grad_updates_lifetime": 17325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1466128, "num_env_steps_trained": 1466128, "num_agent_steps_sampled": 1466128, "num_agent_steps_trained": 1466128}, "sampler_results": {"episode_reward_max": 24.676267235987513, "episode_reward_min": 15.997507865119855, "episode_reward_mean": 20.8070604066481, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.129746446914144, 22.9163362616569, 20.76215641885743, 22.27495633672546, 21.958295069663503, 18.541028110416896, 22.946840444133304, 21.98581537109219, 20.36405455232142, 20.75981158053166, 20.96638945613514, 19.79226033053671, 21.055085277332562, 23.07230137484918, 23.863170041502553, 20.781004387866673, 22.76743975106754, 15.997507865119855, 20.553969223369666, 20.182470173288245, 19.06709800043322, 22.337212659946537, 20.83516439904232, 20.089472060823404, 22.783626085236172, 20.743783959180657, 18.628563074633732, 21.7262822364072, 20.997559799426003, 22.40961390823597, 21.8854734339828, 22.368092368677612, 21.403478781829858, 22.2503363126857, 21.633562638607632, 24.468571429829073, 17.88546046249539, 20.846562855253868, 19.97943616933243, 17.630386530646057, 23.785545847005725, 21.513439786760536, 22.015549210029675, 20.0088070771292, 23.283710665979623, 19.321414534493627, 21.003674793843558, 20.077737318921006, 18.771629158021856, 18.91249574948055, 21.505302862394693, 22.42010191011831, 21.195874691899867, 20.983920530680212, 21.380066640816512, 19.941635550383868, 21.706589967623476, 22.685819449466745, 18.78123385225375, 21.83038327326554, 23.19222792986773, 21.63030799563401, 20.548441145199657, 20.931952124437657, 21.500751462003702, 19.260818773695824, 20.107947639059667, 18.94179893333976, 20.154921683344686, 18.45795242068934, 19.078135180330897, 20.105665888615416, 19.42640397979736, 20.638775591590953, 23.05518896041495, 21.13836037773619, 20.508097629821716, 18.413770997873645, 20.835123239186547, 20.1178498777808, 19.59041265086129, 20.912243219917183, 20.52120542825196, 19.539074942976402, 21.22973732703943, 22.433867730325876, 20.89417485075876, 22.379036299700818, 18.100984664044592, 19.95120910387633, 23.470017999938534, 19.716628033601268, 20.351958113669852, 17.841838491514952, 23.914474416917933, 18.482429667193564, 16.569814939023157, 20.669658845145193, 18.651206362989807, 24.676267235987513], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1261992629000894, "mean_inference_ms": 8.106233094630957, "mean_action_processing_ms": 0.5532610219276934, "mean_env_wait_ms": 23.888612701310766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028548240661621094, "StateBufferConnector_ms": 0.03885006904602051, "ViewRequirementAgentConnector_ms": 0.8828849792480469}}, "episode_reward_max": 24.676267235987513, "episode_reward_min": 15.997507865119855, "episode_reward_mean": 20.8070604066481, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.129746446914144, 22.9163362616569, 20.76215641885743, 22.27495633672546, 21.958295069663503, 18.541028110416896, 22.946840444133304, 21.98581537109219, 20.36405455232142, 20.75981158053166, 20.96638945613514, 19.79226033053671, 21.055085277332562, 23.07230137484918, 23.863170041502553, 20.781004387866673, 22.76743975106754, 15.997507865119855, 20.553969223369666, 20.182470173288245, 19.06709800043322, 22.337212659946537, 20.83516439904232, 20.089472060823404, 22.783626085236172, 20.743783959180657, 18.628563074633732, 21.7262822364072, 20.997559799426003, 22.40961390823597, 21.8854734339828, 22.368092368677612, 21.403478781829858, 22.2503363126857, 21.633562638607632, 24.468571429829073, 17.88546046249539, 20.846562855253868, 19.97943616933243, 17.630386530646057, 23.785545847005725, 21.513439786760536, 22.015549210029675, 20.0088070771292, 23.283710665979623, 19.321414534493627, 21.003674793843558, 20.077737318921006, 18.771629158021856, 18.91249574948055, 21.505302862394693, 22.42010191011831, 21.195874691899867, 20.983920530680212, 21.380066640816512, 19.941635550383868, 21.706589967623476, 22.685819449466745, 18.78123385225375, 21.83038327326554, 23.19222792986773, 21.63030799563401, 20.548441145199657, 20.931952124437657, 21.500751462003702, 19.260818773695824, 20.107947639059667, 18.94179893333976, 20.154921683344686, 18.45795242068934, 19.078135180330897, 20.105665888615416, 19.42640397979736, 20.638775591590953, 23.05518896041495, 21.13836037773619, 20.508097629821716, 18.413770997873645, 20.835123239186547, 20.1178498777808, 19.59041265086129, 20.912243219917183, 20.52120542825196, 19.539074942976402, 21.22973732703943, 22.433867730325876, 20.89417485075876, 22.379036299700818, 18.100984664044592, 19.95120910387633, 23.470017999938534, 19.716628033601268, 20.351958113669852, 17.841838491514952, 23.914474416917933, 18.482429667193564, 16.569814939023157, 20.669658845145193, 18.651206362989807, 24.676267235987513], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1261992629000894, "mean_inference_ms": 8.106233094630957, "mean_action_processing_ms": 0.5532610219276934, "mean_env_wait_ms": 23.888612701310766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028548240661621094, "StateBufferConnector_ms": 0.03885006904602051, "ViewRequirementAgentConnector_ms": 0.8828849792480469}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1466128, "num_agent_steps_trained": 1466128, "num_env_steps_sampled": 1466128, "num_env_steps_trained": 1466128, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 277.5590913425511, "num_env_steps_trained_throughput_per_sec": 277.5590913425511, "timesteps_total": 1466128, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1466128, "timers": {"training_iteration_time_ms": 55278.022, "sample_time_ms": 41433.351, "load_time_ms": 1817.958, "load_throughput": 8601.958, "learn_time_ms": 11460.255, "learn_throughput": 1364.542, "synch_weights_time_ms": 443.92}, "counters": {"num_env_steps_sampled": 1466128, "num_env_steps_trained": 1466128, "num_agent_steps_sampled": 1466128, "num_agent_steps_trained": 1466128}, "done": false, "episodes_total": 448, "training_iteration": 98, "trial_id": "c0a6f_00000", "date": "2025-06-06_22-59-56", "timestamp": 1749243596, "time_this_iter_s": 56.357155084609985, "time_total_s": 1835.6891222000122, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1835.6891222000122, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 76.86461538461538, "ram_util_percent": 64.09846153846154, "gpu_util_percent0": 0.07923076923076923, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.533872e-05, "total_loss": -0.11134656346572394, "policy_loss": -0.033414316961332756, "vf_loss": 0.013869367942891338, "vf_explained_var": 0.8906373112851923, "kl": 0.019301519857481277, "entropy": 18.07168295253407, "entropy_coeff": 0.005112906666666667}, "model": {}, "num_grad_updates_lifetime": 17875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1481766, "num_env_steps_trained": 1481766, "num_agent_steps_sampled": 1481766, "num_agent_steps_trained": 1481766}, "sampler_results": {"episode_reward_max": 24.676267235987513, "episode_reward_min": 15.997507865119855, "episode_reward_mean": 20.7244463254217, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.863170041502553, 20.781004387866673, 22.76743975106754, 15.997507865119855, 20.553969223369666, 20.182470173288245, 19.06709800043322, 22.337212659946537, 20.83516439904232, 20.089472060823404, 22.783626085236172, 20.743783959180657, 18.628563074633732, 21.7262822364072, 20.997559799426003, 22.40961390823597, 21.8854734339828, 22.368092368677612, 21.403478781829858, 22.2503363126857, 21.633562638607632, 24.468571429829073, 17.88546046249539, 20.846562855253868, 19.97943616933243, 17.630386530646057, 23.785545847005725, 21.513439786760536, 22.015549210029675, 20.0088070771292, 23.283710665979623, 19.321414534493627, 21.003674793843558, 20.077737318921006, 18.771629158021856, 18.91249574948055, 21.505302862394693, 22.42010191011831, 21.195874691899867, 20.983920530680212, 21.380066640816512, 19.941635550383868, 21.706589967623476, 22.685819449466745, 18.78123385225375, 21.83038327326554, 23.19222792986773, 21.63030799563401, 20.548441145199657, 20.931952124437657, 21.500751462003702, 19.260818773695824, 20.107947639059667, 18.94179893333976, 20.154921683344686, 18.45795242068934, 19.078135180330897, 20.105665888615416, 19.42640397979736, 20.638775591590953, 23.05518896041495, 21.13836037773619, 20.508097629821716, 18.413770997873645, 20.835123239186547, 20.1178498777808, 19.59041265086129, 20.912243219917183, 20.52120542825196, 19.539074942976402, 21.22973732703943, 22.433867730325876, 20.89417485075876, 22.379036299700818, 18.100984664044592, 19.95120910387633, 23.470017999938534, 19.716628033601268, 20.351958113669852, 17.841838491514952, 23.914474416917933, 18.482429667193564, 16.569814939023157, 20.669658845145193, 18.651206362989807, 24.676267235987513, 17.944442847480012, 20.942180668783344, 18.75837890647202, 23.56210714755948, 21.877497947911944, 22.792700235468306, 19.726492418706837, 18.646887098169078, 22.38009981270724, 21.775970527799235, 20.92451731170576, 18.885601615134657, 21.733288241656414, 19.31350412897258], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1222226191048876, "mean_inference_ms": 8.105162230385373, "mean_action_processing_ms": 0.5532888493671922, "mean_env_wait_ms": 23.8823421990871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029475688934326172, "StateBufferConnector_ms": 0.029999971389770508, "ViewRequirementAgentConnector_ms": 0.8666236400604248}}, "episode_reward_max": 24.676267235987513, "episode_reward_min": 15.997507865119855, "episode_reward_mean": 20.7244463254217, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.863170041502553, 20.781004387866673, 22.76743975106754, 15.997507865119855, 20.553969223369666, 20.182470173288245, 19.06709800043322, 22.337212659946537, 20.83516439904232, 20.089472060823404, 22.783626085236172, 20.743783959180657, 18.628563074633732, 21.7262822364072, 20.997559799426003, 22.40961390823597, 21.8854734339828, 22.368092368677612, 21.403478781829858, 22.2503363126857, 21.633562638607632, 24.468571429829073, 17.88546046249539, 20.846562855253868, 19.97943616933243, 17.630386530646057, 23.785545847005725, 21.513439786760536, 22.015549210029675, 20.0088070771292, 23.283710665979623, 19.321414534493627, 21.003674793843558, 20.077737318921006, 18.771629158021856, 18.91249574948055, 21.505302862394693, 22.42010191011831, 21.195874691899867, 20.983920530680212, 21.380066640816512, 19.941635550383868, 21.706589967623476, 22.685819449466745, 18.78123385225375, 21.83038327326554, 23.19222792986773, 21.63030799563401, 20.548441145199657, 20.931952124437657, 21.500751462003702, 19.260818773695824, 20.107947639059667, 18.94179893333976, 20.154921683344686, 18.45795242068934, 19.078135180330897, 20.105665888615416, 19.42640397979736, 20.638775591590953, 23.05518896041495, 21.13836037773619, 20.508097629821716, 18.413770997873645, 20.835123239186547, 20.1178498777808, 19.59041265086129, 20.912243219917183, 20.52120542825196, 19.539074942976402, 21.22973732703943, 22.433867730325876, 20.89417485075876, 22.379036299700818, 18.100984664044592, 19.95120910387633, 23.470017999938534, 19.716628033601268, 20.351958113669852, 17.841838491514952, 23.914474416917933, 18.482429667193564, 16.569814939023157, 20.669658845145193, 18.651206362989807, 24.676267235987513, 17.944442847480012, 20.942180668783344, 18.75837890647202, 23.56210714755948, 21.877497947911944, 22.792700235468306, 19.726492418706837, 18.646887098169078, 22.38009981270724, 21.775970527799235, 20.92451731170576, 18.885601615134657, 21.733288241656414, 19.31350412897258], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1222226191048876, "mean_inference_ms": 8.105162230385373, "mean_action_processing_ms": 0.5532888493671922, "mean_env_wait_ms": 23.8823421990871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029475688934326172, "StateBufferConnector_ms": 0.029999971389770508, "ViewRequirementAgentConnector_ms": 0.8666236400604248}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1481766, "num_agent_steps_trained": 1481766, "num_env_steps_sampled": 1481766, "num_env_steps_trained": 1481766, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.08016171138945, "num_env_steps_trained_throughput_per_sec": 284.08016171138945, "timesteps_total": 1481766, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1481766, "timers": {"training_iteration_time_ms": 55226.071, "sample_time_ms": 41385.962, "load_time_ms": 1821.443, "load_throughput": 8585.501, "learn_time_ms": 11448.675, "learn_throughput": 1365.922, "synch_weights_time_ms": 447.66}, "counters": {"num_env_steps_sampled": 1481766, "num_env_steps_trained": 1481766, "num_agent_steps_sampled": 1481766, "num_agent_steps_trained": 1481766}, "done": false, "episodes_total": 462, "training_iteration": 99, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-00-51", "timestamp": 1749243651, "time_this_iter_s": 55.06484079360962, "time_total_s": 1890.7539629936218, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1890.7539629936218, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 76.3515625, "ram_util_percent": 64.27031249999999, "gpu_util_percent0": 0.07906250000000001, "vram_util_percent0": 0.8592122395833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2.095784004849432, "episode_reward_min": -4.138608029055044, "episode_reward_mean": -2.8016752751223457, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.210046539834765, -2.5725862171321485, -2.095784004849432, -4.138608029055044, -2.9913515847403387], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6470026043697856, "mean_inference_ms": 3.719611065571025, "mean_action_processing_ms": 0.3005782083077652, "mean_env_wait_ms": 11.630682024221258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3399515151977539, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.6284284591674805}}, "episode_reward_max": -2.095784004849432, "episode_reward_min": -4.138608029055044, "episode_reward_mean": -2.8016752751223457, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.210046539834765, -2.5725862171321485, -2.095784004849432, -4.138608029055044, -2.9913515847403387], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6470026043697856, "mean_inference_ms": 3.719611065571025, "mean_action_processing_ms": 0.3005782083077652, "mean_env_wait_ms": 11.630682024221258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3399515151977539, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.6284284591674805}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.518234000000001e-05, "total_loss": -0.09992194865660911, "policy_loss": -0.02363974861059846, "vf_loss": 0.01507369914219122, "vf_explained_var": 0.8836175279183821, "kl": 0.02018084882483634, "entropy": 18.09594246604226, "entropy_coeff": 0.00506078}, "model": {}, "num_grad_updates_lifetime": 18425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1497404, "num_env_steps_trained": 1497404, "num_agent_steps_sampled": 1497404, "num_agent_steps_trained": 1497404}, "sampler_results": {"episode_reward_max": 24.676267235987513, "episode_reward_min": 16.48677691681774, "episode_reward_mean": 20.598871246027247, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.997559799426003, 22.40961390823597, 21.8854734339828, 22.368092368677612, 21.403478781829858, 22.2503363126857, 21.633562638607632, 24.468571429829073, 17.88546046249539, 20.846562855253868, 19.97943616933243, 17.630386530646057, 23.785545847005725, 21.513439786760536, 22.015549210029675, 20.0088070771292, 23.283710665979623, 19.321414534493627, 21.003674793843558, 20.077737318921006, 18.771629158021856, 18.91249574948055, 21.505302862394693, 22.42010191011831, 21.195874691899867, 20.983920530680212, 21.380066640816512, 19.941635550383868, 21.706589967623476, 22.685819449466745, 18.78123385225375, 21.83038327326554, 23.19222792986773, 21.63030799563401, 20.548441145199657, 20.931952124437657, 21.500751462003702, 19.260818773695824, 20.107947639059667, 18.94179893333976, 20.154921683344686, 18.45795242068934, 19.078135180330897, 20.105665888615416, 19.42640397979736, 20.638775591590953, 23.05518896041495, 21.13836037773619, 20.508097629821716, 18.413770997873645, 20.835123239186547, 20.1178498777808, 19.59041265086129, 20.912243219917183, 20.52120542825196, 19.539074942976402, 21.22973732703943, 22.433867730325876, 20.89417485075876, 22.379036299700818, 18.100984664044592, 19.95120910387633, 23.470017999938534, 19.716628033601268, 20.351958113669852, 17.841838491514952, 23.914474416917933, 18.482429667193564, 16.569814939023157, 20.669658845145193, 18.651206362989807, 24.676267235987513, 17.944442847480012, 20.942180668783344, 18.75837890647202, 23.56210714755948, 21.877497947911944, 22.792700235468306, 19.726492418706837, 18.646887098169078, 22.38009981270724, 21.775970527799235, 20.92451731170576, 18.885601615134657, 21.733288241656414, 19.31350412897258, 18.86549632845636, 20.243737400315457, 21.90422725041467, 19.644121489017003, 21.543707890765255, 20.613771299315008, 19.304297638312146, 18.836654452380827, 19.567881002519467, 21.689839213565932, 16.48677691681774, 22.0236822629948, 17.264784037095474, 19.81027879650193], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.118306487728818, "mean_inference_ms": 8.10457664474433, "mean_action_processing_ms": 0.5533508255863071, "mean_env_wait_ms": 23.87726394495436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031501054763793945, "StateBufferConnector_ms": 0.024019241333007812, "ViewRequirementAgentConnector_ms": 0.8601148128509521}}, "episode_reward_max": 24.676267235987513, "episode_reward_min": 16.48677691681774, "episode_reward_mean": 20.598871246027247, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.997559799426003, 22.40961390823597, 21.8854734339828, 22.368092368677612, 21.403478781829858, 22.2503363126857, 21.633562638607632, 24.468571429829073, 17.88546046249539, 20.846562855253868, 19.97943616933243, 17.630386530646057, 23.785545847005725, 21.513439786760536, 22.015549210029675, 20.0088070771292, 23.283710665979623, 19.321414534493627, 21.003674793843558, 20.077737318921006, 18.771629158021856, 18.91249574948055, 21.505302862394693, 22.42010191011831, 21.195874691899867, 20.983920530680212, 21.380066640816512, 19.941635550383868, 21.706589967623476, 22.685819449466745, 18.78123385225375, 21.83038327326554, 23.19222792986773, 21.63030799563401, 20.548441145199657, 20.931952124437657, 21.500751462003702, 19.260818773695824, 20.107947639059667, 18.94179893333976, 20.154921683344686, 18.45795242068934, 19.078135180330897, 20.105665888615416, 19.42640397979736, 20.638775591590953, 23.05518896041495, 21.13836037773619, 20.508097629821716, 18.413770997873645, 20.835123239186547, 20.1178498777808, 19.59041265086129, 20.912243219917183, 20.52120542825196, 19.539074942976402, 21.22973732703943, 22.433867730325876, 20.89417485075876, 22.379036299700818, 18.100984664044592, 19.95120910387633, 23.470017999938534, 19.716628033601268, 20.351958113669852, 17.841838491514952, 23.914474416917933, 18.482429667193564, 16.569814939023157, 20.669658845145193, 18.651206362989807, 24.676267235987513, 17.944442847480012, 20.942180668783344, 18.75837890647202, 23.56210714755948, 21.877497947911944, 22.792700235468306, 19.726492418706837, 18.646887098169078, 22.38009981270724, 21.775970527799235, 20.92451731170576, 18.885601615134657, 21.733288241656414, 19.31350412897258, 18.86549632845636, 20.243737400315457, 21.90422725041467, 19.644121489017003, 21.543707890765255, 20.613771299315008, 19.304297638312146, 18.836654452380827, 19.567881002519467, 21.689839213565932, 16.48677691681774, 22.0236822629948, 17.264784037095474, 19.81027879650193], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.118306487728818, "mean_inference_ms": 8.10457664474433, "mean_action_processing_ms": 0.5533508255863071, "mean_env_wait_ms": 23.87726394495436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031501054763793945, "StateBufferConnector_ms": 0.024019241333007812, "ViewRequirementAgentConnector_ms": 0.8601148128509521}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1497404, "num_agent_steps_trained": 1497404, "num_env_steps_sampled": 1497404, "num_env_steps_trained": 1497404, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.7932255612993, "num_env_steps_trained_throughput_per_sec": 281.7932255612993, "timesteps_total": 1497404, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1497404, "timers": {"training_iteration_time_ms": 55290.718, "sample_time_ms": 41451.874, "load_time_ms": 1816.419, "load_throughput": 8609.248, "learn_time_ms": 11456.122, "learn_throughput": 1365.034, "synch_weights_time_ms": 444.179}, "counters": {"num_env_steps_sampled": 1497404, "num_env_steps_trained": 1497404, "num_agent_steps_sampled": 1497404, "num_agent_steps_trained": 1497404}, "done": false, "episodes_total": 476, "training_iteration": 100, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-02-03", "timestamp": 1749243723, "time_this_iter_s": 71.87309050559998, "time_total_s": 1962.6270534992218, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1962.6270534992218, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 62.40588235294118, "ram_util_percent": 63.904705882352935, "gpu_util_percent0": 0.0648235294117647, "vram_util_percent0": 0.8592122395833329}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.502596000000003e-05, "total_loss": -0.09079750633459877, "policy_loss": -0.015188947121760893, "vf_loss": 0.014390221851962533, "vf_explained_var": 0.8856256708231839, "kl": 0.020421405366664244, "entropy": 18.13448348825628, "entropy_coeff": 0.005008653333333334}, "model": {}, "num_grad_updates_lifetime": 18975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1513042, "num_env_steps_trained": 1513042, "num_agent_steps_sampled": 1513042, "num_agent_steps_trained": 1513042}, "sampler_results": {"episode_reward_max": 24.676267235987513, "episode_reward_min": 16.48677691681774, "episode_reward_mean": 20.38625284688529, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.015549210029675, 20.0088070771292, 23.283710665979623, 19.321414534493627, 21.003674793843558, 20.077737318921006, 18.771629158021856, 18.91249574948055, 21.505302862394693, 22.42010191011831, 21.195874691899867, 20.983920530680212, 21.380066640816512, 19.941635550383868, 21.706589967623476, 22.685819449466745, 18.78123385225375, 21.83038327326554, 23.19222792986773, 21.63030799563401, 20.548441145199657, 20.931952124437657, 21.500751462003702, 19.260818773695824, 20.107947639059667, 18.94179893333976, 20.154921683344686, 18.45795242068934, 19.078135180330897, 20.105665888615416, 19.42640397979736, 20.638775591590953, 23.05518896041495, 21.13836037773619, 20.508097629821716, 18.413770997873645, 20.835123239186547, 20.1178498777808, 19.59041265086129, 20.912243219917183, 20.52120542825196, 19.539074942976402, 21.22973732703943, 22.433867730325876, 20.89417485075876, 22.379036299700818, 18.100984664044592, 19.95120910387633, 23.470017999938534, 19.716628033601268, 20.351958113669852, 17.841838491514952, 23.914474416917933, 18.482429667193564, 16.569814939023157, 20.669658845145193, 18.651206362989807, 24.676267235987513, 17.944442847480012, 20.942180668783344, 18.75837890647202, 23.56210714755948, 21.877497947911944, 22.792700235468306, 19.726492418706837, 18.646887098169078, 22.38009981270724, 21.775970527799235, 20.92451731170576, 18.885601615134657, 21.733288241656414, 19.31350412897258, 18.86549632845636, 20.243737400315457, 21.90422725041467, 19.644121489017003, 21.543707890765255, 20.613771299315008, 19.304297638312146, 18.836654452380827, 19.567881002519467, 21.689839213565932, 16.48677691681774, 22.0236822629948, 17.264784037095474, 19.81027879650193, 18.94500652894944, 17.67026193553448, 17.713070909866282, 20.27233142414783, 21.357242354775433, 21.867128743455815, 21.560105574076392, 17.53653321742118, 20.22666664734038, 19.58769990788312, 19.735988717555742, 21.775425792331397, 19.235524253309734, 20.31269440392591], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.114540772782653, "mean_inference_ms": 8.104354250957886, "mean_action_processing_ms": 0.5534565788208414, "mean_env_wait_ms": 23.87395178334094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029522418975830078, "StateBufferConnector_ms": 0.03195786476135254, "ViewRequirementAgentConnector_ms": 0.8771142959594727}}, "episode_reward_max": 24.676267235987513, "episode_reward_min": 16.48677691681774, "episode_reward_mean": 20.38625284688529, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.015549210029675, 20.0088070771292, 23.283710665979623, 19.321414534493627, 21.003674793843558, 20.077737318921006, 18.771629158021856, 18.91249574948055, 21.505302862394693, 22.42010191011831, 21.195874691899867, 20.983920530680212, 21.380066640816512, 19.941635550383868, 21.706589967623476, 22.685819449466745, 18.78123385225375, 21.83038327326554, 23.19222792986773, 21.63030799563401, 20.548441145199657, 20.931952124437657, 21.500751462003702, 19.260818773695824, 20.107947639059667, 18.94179893333976, 20.154921683344686, 18.45795242068934, 19.078135180330897, 20.105665888615416, 19.42640397979736, 20.638775591590953, 23.05518896041495, 21.13836037773619, 20.508097629821716, 18.413770997873645, 20.835123239186547, 20.1178498777808, 19.59041265086129, 20.912243219917183, 20.52120542825196, 19.539074942976402, 21.22973732703943, 22.433867730325876, 20.89417485075876, 22.379036299700818, 18.100984664044592, 19.95120910387633, 23.470017999938534, 19.716628033601268, 20.351958113669852, 17.841838491514952, 23.914474416917933, 18.482429667193564, 16.569814939023157, 20.669658845145193, 18.651206362989807, 24.676267235987513, 17.944442847480012, 20.942180668783344, 18.75837890647202, 23.56210714755948, 21.877497947911944, 22.792700235468306, 19.726492418706837, 18.646887098169078, 22.38009981270724, 21.775970527799235, 20.92451731170576, 18.885601615134657, 21.733288241656414, 19.31350412897258, 18.86549632845636, 20.243737400315457, 21.90422725041467, 19.644121489017003, 21.543707890765255, 20.613771299315008, 19.304297638312146, 18.836654452380827, 19.567881002519467, 21.689839213565932, 16.48677691681774, 22.0236822629948, 17.264784037095474, 19.81027879650193, 18.94500652894944, 17.67026193553448, 17.713070909866282, 20.27233142414783, 21.357242354775433, 21.867128743455815, 21.560105574076392, 17.53653321742118, 20.22666664734038, 19.58769990788312, 19.735988717555742, 21.775425792331397, 19.235524253309734, 20.31269440392591], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.114540772782653, "mean_inference_ms": 8.104354250957886, "mean_action_processing_ms": 0.5534565788208414, "mean_env_wait_ms": 23.87395178334094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029522418975830078, "StateBufferConnector_ms": 0.03195786476135254, "ViewRequirementAgentConnector_ms": 0.8771142959594727}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1513042, "num_agent_steps_trained": 1513042, "num_env_steps_sampled": 1513042, "num_env_steps_trained": 1513042, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.5919307323854, "num_env_steps_trained_throughput_per_sec": 283.5919307323854, "timesteps_total": 1513042, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1513042, "timers": {"training_iteration_time_ms": 55226.267, "sample_time_ms": 41428.809, "load_time_ms": 1791.599, "load_throughput": 8728.517, "learn_time_ms": 11438.169, "learn_throughput": 1367.177, "synch_weights_time_ms": 445.364}, "counters": {"num_env_steps_sampled": 1513042, "num_env_steps_trained": 1513042, "num_agent_steps_sampled": 1513042, "num_agent_steps_trained": 1513042}, "done": false, "episodes_total": 490, "training_iteration": 101, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-02-58", "timestamp": 1749243778, "time_this_iter_s": 55.16260766983032, "time_total_s": 2017.7896611690521, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2017.7896611690521, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 76.65781249999999, "ram_util_percent": 64.4328125, "gpu_util_percent0": 0.0753125, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.486957999999999e-05, "total_loss": -0.09364721878474071, "policy_loss": -0.018762806949883023, "vf_loss": 0.01507307765963064, "vf_explained_var": 0.8712834318117662, "kl": 0.019741656121017984, "entropy": 18.08376140767878, "entropy_coeff": 0.004973916000000001}, "model": {}, "num_grad_updates_lifetime": 19525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1528680, "num_env_steps_trained": 1528680, "num_agent_steps_sampled": 1528680, "num_agent_steps_trained": 1528680}, "sampler_results": {"episode_reward_max": 24.676267235987513, "episode_reward_min": 16.48677691681774, "episode_reward_mean": 20.340344189384485, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.706589967623476, 22.685819449466745, 18.78123385225375, 21.83038327326554, 23.19222792986773, 21.63030799563401, 20.548441145199657, 20.931952124437657, 21.500751462003702, 19.260818773695824, 20.107947639059667, 18.94179893333976, 20.154921683344686, 18.45795242068934, 19.078135180330897, 20.105665888615416, 19.42640397979736, 20.638775591590953, 23.05518896041495, 21.13836037773619, 20.508097629821716, 18.413770997873645, 20.835123239186547, 20.1178498777808, 19.59041265086129, 20.912243219917183, 20.52120542825196, 19.539074942976402, 21.22973732703943, 22.433867730325876, 20.89417485075876, 22.379036299700818, 18.100984664044592, 19.95120910387633, 23.470017999938534, 19.716628033601268, 20.351958113669852, 17.841838491514952, 23.914474416917933, 18.482429667193564, 16.569814939023157, 20.669658845145193, 18.651206362989807, 24.676267235987513, 17.944442847480012, 20.942180668783344, 18.75837890647202, 23.56210714755948, 21.877497947911944, 22.792700235468306, 19.726492418706837, 18.646887098169078, 22.38009981270724, 21.775970527799235, 20.92451731170576, 18.885601615134657, 21.733288241656414, 19.31350412897258, 18.86549632845636, 20.243737400315457, 21.90422725041467, 19.644121489017003, 21.543707890765255, 20.613771299315008, 19.304297638312146, 18.836654452380827, 19.567881002519467, 21.689839213565932, 16.48677691681774, 22.0236822629948, 17.264784037095474, 19.81027879650193, 18.94500652894944, 17.67026193553448, 17.713070909866282, 20.27233142414783, 21.357242354775433, 21.867128743455815, 21.560105574076392, 17.53653321742118, 20.22666664734038, 19.58769990788312, 19.735988717555742, 21.775425792331397, 19.235524253309734, 20.31269440392591, 20.167529277546965, 21.85448487248491, 19.46599309537712, 20.01658961124941, 20.397154447091495, 18.94003089608895, 19.952832047509087, 20.3579116416652, 21.515373681904254, 19.58558664630141, 20.51639827832074, 21.2546622670221, 21.558141594276982, 20.648366587273422], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.111132665723976, "mean_inference_ms": 8.104741117400838, "mean_action_processing_ms": 0.5536081554592837, "mean_env_wait_ms": 23.870775787004888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024546384811401367, "StateBufferConnector_ms": 0.0350344181060791, "ViewRequirementAgentConnector_ms": 0.9084389209747314}}, "episode_reward_max": 24.676267235987513, "episode_reward_min": 16.48677691681774, "episode_reward_mean": 20.340344189384485, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.706589967623476, 22.685819449466745, 18.78123385225375, 21.83038327326554, 23.19222792986773, 21.63030799563401, 20.548441145199657, 20.931952124437657, 21.500751462003702, 19.260818773695824, 20.107947639059667, 18.94179893333976, 20.154921683344686, 18.45795242068934, 19.078135180330897, 20.105665888615416, 19.42640397979736, 20.638775591590953, 23.05518896041495, 21.13836037773619, 20.508097629821716, 18.413770997873645, 20.835123239186547, 20.1178498777808, 19.59041265086129, 20.912243219917183, 20.52120542825196, 19.539074942976402, 21.22973732703943, 22.433867730325876, 20.89417485075876, 22.379036299700818, 18.100984664044592, 19.95120910387633, 23.470017999938534, 19.716628033601268, 20.351958113669852, 17.841838491514952, 23.914474416917933, 18.482429667193564, 16.569814939023157, 20.669658845145193, 18.651206362989807, 24.676267235987513, 17.944442847480012, 20.942180668783344, 18.75837890647202, 23.56210714755948, 21.877497947911944, 22.792700235468306, 19.726492418706837, 18.646887098169078, 22.38009981270724, 21.775970527799235, 20.92451731170576, 18.885601615134657, 21.733288241656414, 19.31350412897258, 18.86549632845636, 20.243737400315457, 21.90422725041467, 19.644121489017003, 21.543707890765255, 20.613771299315008, 19.304297638312146, 18.836654452380827, 19.567881002519467, 21.689839213565932, 16.48677691681774, 22.0236822629948, 17.264784037095474, 19.81027879650193, 18.94500652894944, 17.67026193553448, 17.713070909866282, 20.27233142414783, 21.357242354775433, 21.867128743455815, 21.560105574076392, 17.53653321742118, 20.22666664734038, 19.58769990788312, 19.735988717555742, 21.775425792331397, 19.235524253309734, 20.31269440392591, 20.167529277546965, 21.85448487248491, 19.46599309537712, 20.01658961124941, 20.397154447091495, 18.94003089608895, 19.952832047509087, 20.3579116416652, 21.515373681904254, 19.58558664630141, 20.51639827832074, 21.2546622670221, 21.558141594276982, 20.648366587273422], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.111132665723976, "mean_inference_ms": 8.104741117400838, "mean_action_processing_ms": 0.5536081554592837, "mean_env_wait_ms": 23.870775787004888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024546384811401367, "StateBufferConnector_ms": 0.0350344181060791, "ViewRequirementAgentConnector_ms": 0.9084389209747314}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1528680, "num_agent_steps_trained": 1528680, "num_env_steps_sampled": 1528680, "num_env_steps_trained": 1528680, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.41072104652835, "num_env_steps_trained_throughput_per_sec": 282.41072104652835, "timesteps_total": 1528680, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1528680, "timers": {"training_iteration_time_ms": 55239.723, "sample_time_ms": 41410.775, "load_time_ms": 1784.377, "load_throughput": 8763.844, "learn_time_ms": 11475.806, "learn_throughput": 1362.693, "synch_weights_time_ms": 447.056}, "counters": {"num_env_steps_sampled": 1528680, "num_env_steps_trained": 1528680, "num_agent_steps_sampled": 1528680, "num_agent_steps_trained": 1528680}, "done": false, "episodes_total": 504, "training_iteration": 102, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-03-54", "timestamp": 1749243834, "time_this_iter_s": 55.394493103027344, "time_total_s": 2073.1841542720795, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2073.1841542720795, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 76.1875, "ram_util_percent": 64.53125, "gpu_util_percent0": 0.08578125, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.471319999999999e-05, "total_loss": -0.09579401902134785, "policy_loss": -0.020626153644301336, "vf_loss": 0.013312781020914289, "vf_explained_var": 0.8819502394849604, "kl": 0.01902162466735533, "entropy": 18.070912921211935, "entropy_coeff": 0.004942639999999998}, "model": {}, "num_grad_updates_lifetime": 20075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1544318, "num_env_steps_trained": 1544318, "num_agent_steps_sampled": 1544318, "num_agent_steps_trained": 1544318}, "sampler_results": {"episode_reward_max": 24.676267235987513, "episode_reward_min": 16.48677691681774, "episode_reward_mean": 20.341592027487813, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.078135180330897, 20.105665888615416, 19.42640397979736, 20.638775591590953, 23.05518896041495, 21.13836037773619, 20.508097629821716, 18.413770997873645, 20.835123239186547, 20.1178498777808, 19.59041265086129, 20.912243219917183, 20.52120542825196, 19.539074942976402, 21.22973732703943, 22.433867730325876, 20.89417485075876, 22.379036299700818, 18.100984664044592, 19.95120910387633, 23.470017999938534, 19.716628033601268, 20.351958113669852, 17.841838491514952, 23.914474416917933, 18.482429667193564, 16.569814939023157, 20.669658845145193, 18.651206362989807, 24.676267235987513, 17.944442847480012, 20.942180668783344, 18.75837890647202, 23.56210714755948, 21.877497947911944, 22.792700235468306, 19.726492418706837, 18.646887098169078, 22.38009981270724, 21.775970527799235, 20.92451731170576, 18.885601615134657, 21.733288241656414, 19.31350412897258, 18.86549632845636, 20.243737400315457, 21.90422725041467, 19.644121489017003, 21.543707890765255, 20.613771299315008, 19.304297638312146, 18.836654452380827, 19.567881002519467, 21.689839213565932, 16.48677691681774, 22.0236822629948, 17.264784037095474, 19.81027879650193, 18.94500652894944, 17.67026193553448, 17.713070909866282, 20.27233142414783, 21.357242354775433, 21.867128743455815, 21.560105574076392, 17.53653321742118, 20.22666664734038, 19.58769990788312, 19.735988717555742, 21.775425792331397, 19.235524253309734, 20.31269440392591, 20.167529277546965, 21.85448487248491, 19.46599309537712, 20.01658961124941, 20.397154447091495, 18.94003089608895, 19.952832047509087, 20.3579116416652, 21.515373681904254, 19.58558664630141, 20.51639827832074, 21.2546622670221, 21.558141594276982, 20.648366587273422, 19.265791313838005, 19.355845838890986, 23.345777081849896, 18.77422501384491, 19.29519018868632, 18.88425080641328, 21.668826416341993, 20.672060813985357, 21.28980544816792, 21.2752908666004, 21.74466671207645, 20.165470966835503, 20.435170302661753, 23.68355869002125], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1082934373473314, "mean_inference_ms": 8.105856308690228, "mean_action_processing_ms": 0.5537491538088777, "mean_env_wait_ms": 23.86877608787072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026037931442260742, "StateBufferConnector_ms": 0.034029245376586914, "ViewRequirementAgentConnector_ms": 0.8881244659423828}}, "episode_reward_max": 24.676267235987513, "episode_reward_min": 16.48677691681774, "episode_reward_mean": 20.341592027487813, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.078135180330897, 20.105665888615416, 19.42640397979736, 20.638775591590953, 23.05518896041495, 21.13836037773619, 20.508097629821716, 18.413770997873645, 20.835123239186547, 20.1178498777808, 19.59041265086129, 20.912243219917183, 20.52120542825196, 19.539074942976402, 21.22973732703943, 22.433867730325876, 20.89417485075876, 22.379036299700818, 18.100984664044592, 19.95120910387633, 23.470017999938534, 19.716628033601268, 20.351958113669852, 17.841838491514952, 23.914474416917933, 18.482429667193564, 16.569814939023157, 20.669658845145193, 18.651206362989807, 24.676267235987513, 17.944442847480012, 20.942180668783344, 18.75837890647202, 23.56210714755948, 21.877497947911944, 22.792700235468306, 19.726492418706837, 18.646887098169078, 22.38009981270724, 21.775970527799235, 20.92451731170576, 18.885601615134657, 21.733288241656414, 19.31350412897258, 18.86549632845636, 20.243737400315457, 21.90422725041467, 19.644121489017003, 21.543707890765255, 20.613771299315008, 19.304297638312146, 18.836654452380827, 19.567881002519467, 21.689839213565932, 16.48677691681774, 22.0236822629948, 17.264784037095474, 19.81027879650193, 18.94500652894944, 17.67026193553448, 17.713070909866282, 20.27233142414783, 21.357242354775433, 21.867128743455815, 21.560105574076392, 17.53653321742118, 20.22666664734038, 19.58769990788312, 19.735988717555742, 21.775425792331397, 19.235524253309734, 20.31269440392591, 20.167529277546965, 21.85448487248491, 19.46599309537712, 20.01658961124941, 20.397154447091495, 18.94003089608895, 19.952832047509087, 20.3579116416652, 21.515373681904254, 19.58558664630141, 20.51639827832074, 21.2546622670221, 21.558141594276982, 20.648366587273422, 19.265791313838005, 19.355845838890986, 23.345777081849896, 18.77422501384491, 19.29519018868632, 18.88425080641328, 21.668826416341993, 20.672060813985357, 21.28980544816792, 21.2752908666004, 21.74466671207645, 20.165470966835503, 20.435170302661753, 23.68355869002125], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1082934373473314, "mean_inference_ms": 8.105856308690228, "mean_action_processing_ms": 0.5537491538088777, "mean_env_wait_ms": 23.86877608787072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026037931442260742, "StateBufferConnector_ms": 0.034029245376586914, "ViewRequirementAgentConnector_ms": 0.8881244659423828}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1544318, "num_agent_steps_trained": 1544318, "num_env_steps_sampled": 1544318, "num_env_steps_trained": 1544318, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.48723093894404, "num_env_steps_trained_throughput_per_sec": 283.48723093894404, "timesteps_total": 1544318, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1544318, "timers": {"training_iteration_time_ms": 55214.939, "sample_time_ms": 41434.642, "load_time_ms": 1783.832, "load_throughput": 8766.518, "learn_time_ms": 11432.113, "learn_throughput": 1367.901, "synch_weights_time_ms": 444.071}, "counters": {"num_env_steps_sampled": 1544318, "num_env_steps_trained": 1544318, "num_agent_steps_sampled": 1544318, "num_agent_steps_trained": 1544318}, "done": false, "episodes_total": 518, "training_iteration": 103, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-04-49", "timestamp": 1749243889, "time_this_iter_s": 55.17897963523865, "time_total_s": 2128.363133907318, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2128.363133907318, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 76.1484375, "ram_util_percent": 64.859375, "gpu_util_percent0": 0.08109374999999999, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.455682000000003e-05, "total_loss": -0.0889446744564074, "policy_loss": -0.014456255839746022, "vf_loss": 0.013501842126080936, "vf_explained_var": 0.8913220198587938, "kl": 0.019529555804742114, "entropy": 18.11441669290716, "entropy_coeff": 0.0049113640000000005}, "model": {}, "num_grad_updates_lifetime": 20625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1559956, "num_env_steps_trained": 1559956, "num_agent_steps_sampled": 1559956, "num_agent_steps_trained": 1559956}, "sampler_results": {"episode_reward_max": 24.676267235987513, "episode_reward_min": 16.48677691681774, "episode_reward_mean": 20.37682172387359, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.22973732703943, 22.433867730325876, 20.89417485075876, 22.379036299700818, 18.100984664044592, 19.95120910387633, 23.470017999938534, 19.716628033601268, 20.351958113669852, 17.841838491514952, 23.914474416917933, 18.482429667193564, 16.569814939023157, 20.669658845145193, 18.651206362989807, 24.676267235987513, 17.944442847480012, 20.942180668783344, 18.75837890647202, 23.56210714755948, 21.877497947911944, 22.792700235468306, 19.726492418706837, 18.646887098169078, 22.38009981270724, 21.775970527799235, 20.92451731170576, 18.885601615134657, 21.733288241656414, 19.31350412897258, 18.86549632845636, 20.243737400315457, 21.90422725041467, 19.644121489017003, 21.543707890765255, 20.613771299315008, 19.304297638312146, 18.836654452380827, 19.567881002519467, 21.689839213565932, 16.48677691681774, 22.0236822629948, 17.264784037095474, 19.81027879650193, 18.94500652894944, 17.67026193553448, 17.713070909866282, 20.27233142414783, 21.357242354775433, 21.867128743455815, 21.560105574076392, 17.53653321742118, 20.22666664734038, 19.58769990788312, 19.735988717555742, 21.775425792331397, 19.235524253309734, 20.31269440392591, 20.167529277546965, 21.85448487248491, 19.46599309537712, 20.01658961124941, 20.397154447091495, 18.94003089608895, 19.952832047509087, 20.3579116416652, 21.515373681904254, 19.58558664630141, 20.51639827832074, 21.2546622670221, 21.558141594276982, 20.648366587273422, 19.265791313838005, 19.355845838890986, 23.345777081849896, 18.77422501384491, 19.29519018868632, 18.88425080641328, 21.668826416341993, 20.672060813985357, 21.28980544816792, 21.2752908666004, 21.74466671207645, 20.165470966835503, 20.435170302661753, 23.68355869002125, 19.82734494835512, 18.41238565078685, 21.5988375983969, 21.787145744617654, 19.715439394336787, 19.574449489282422, 20.192484577192552, 19.7213282104484, 21.481548541087133, 20.656552710677612, 20.838325913224384, 23.08800246274921, 19.526482343787393, 20.98295001879058], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1057186745817758, "mean_inference_ms": 8.106977575036753, "mean_action_processing_ms": 0.5539013956890781, "mean_env_wait_ms": 23.86849597210188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03104877471923828, "StateBufferConnector_ms": 0.03600716590881348, "ViewRequirementAgentConnector_ms": 0.8835015296936035}}, "episode_reward_max": 24.676267235987513, "episode_reward_min": 16.48677691681774, "episode_reward_mean": 20.37682172387359, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.22973732703943, 22.433867730325876, 20.89417485075876, 22.379036299700818, 18.100984664044592, 19.95120910387633, 23.470017999938534, 19.716628033601268, 20.351958113669852, 17.841838491514952, 23.914474416917933, 18.482429667193564, 16.569814939023157, 20.669658845145193, 18.651206362989807, 24.676267235987513, 17.944442847480012, 20.942180668783344, 18.75837890647202, 23.56210714755948, 21.877497947911944, 22.792700235468306, 19.726492418706837, 18.646887098169078, 22.38009981270724, 21.775970527799235, 20.92451731170576, 18.885601615134657, 21.733288241656414, 19.31350412897258, 18.86549632845636, 20.243737400315457, 21.90422725041467, 19.644121489017003, 21.543707890765255, 20.613771299315008, 19.304297638312146, 18.836654452380827, 19.567881002519467, 21.689839213565932, 16.48677691681774, 22.0236822629948, 17.264784037095474, 19.81027879650193, 18.94500652894944, 17.67026193553448, 17.713070909866282, 20.27233142414783, 21.357242354775433, 21.867128743455815, 21.560105574076392, 17.53653321742118, 20.22666664734038, 19.58769990788312, 19.735988717555742, 21.775425792331397, 19.235524253309734, 20.31269440392591, 20.167529277546965, 21.85448487248491, 19.46599309537712, 20.01658961124941, 20.397154447091495, 18.94003089608895, 19.952832047509087, 20.3579116416652, 21.515373681904254, 19.58558664630141, 20.51639827832074, 21.2546622670221, 21.558141594276982, 20.648366587273422, 19.265791313838005, 19.355845838890986, 23.345777081849896, 18.77422501384491, 19.29519018868632, 18.88425080641328, 21.668826416341993, 20.672060813985357, 21.28980544816792, 21.2752908666004, 21.74466671207645, 20.165470966835503, 20.435170302661753, 23.68355869002125, 19.82734494835512, 18.41238565078685, 21.5988375983969, 21.787145744617654, 19.715439394336787, 19.574449489282422, 20.192484577192552, 19.7213282104484, 21.481548541087133, 20.656552710677612, 20.838325913224384, 23.08800246274921, 19.526482343787393, 20.98295001879058], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1057186745817758, "mean_inference_ms": 8.106977575036753, "mean_action_processing_ms": 0.5539013956890781, "mean_env_wait_ms": 23.86849597210188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03104877471923828, "StateBufferConnector_ms": 0.03600716590881348, "ViewRequirementAgentConnector_ms": 0.8835015296936035}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1559956, "num_agent_steps_trained": 1559956, "num_env_steps_sampled": 1559956, "num_env_steps_trained": 1559956, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.4461185145469, "num_env_steps_trained_throughput_per_sec": 281.4461185145469, "timesteps_total": 1559956, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1559956, "timers": {"training_iteration_time_ms": 55215.718, "sample_time_ms": 41478.416, "load_time_ms": 1781.301, "load_throughput": 8778.975, "learn_time_ms": 11393.645, "learn_throughput": 1372.52, "synch_weights_time_ms": 442.159}, "counters": {"num_env_steps_sampled": 1559956, "num_env_steps_trained": 1559956, "num_agent_steps_sampled": 1559956, "num_agent_steps_trained": 1559956}, "done": false, "episodes_total": 532, "training_iteration": 104, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-05-45", "timestamp": 1749243945, "time_this_iter_s": 55.58501625061035, "time_total_s": 2183.9481501579285, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2183.9481501579285, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 76.8125, "ram_util_percent": 64.509375, "gpu_util_percent0": 0.0815625, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.440043999999998e-05, "total_loss": -0.09798561774744567, "policy_loss": -0.024520454181897963, "vf_loss": 0.014552044536156411, "vf_explained_var": 0.8849944776838476, "kl": 0.019772744572152237, "entropy": 18.11199915972623, "entropy_coeff": 0.004880088}, "model": {}, "num_grad_updates_lifetime": 21175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1575594, "num_env_steps_trained": 1575594, "num_agent_steps_sampled": 1575594, "num_agent_steps_trained": 1575594}, "sampler_results": {"episode_reward_max": 24.676267235987513, "episode_reward_min": 16.48677691681774, "episode_reward_mean": 20.356777367782865, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.651206362989807, 24.676267235987513, 17.944442847480012, 20.942180668783344, 18.75837890647202, 23.56210714755948, 21.877497947911944, 22.792700235468306, 19.726492418706837, 18.646887098169078, 22.38009981270724, 21.775970527799235, 20.92451731170576, 18.885601615134657, 21.733288241656414, 19.31350412897258, 18.86549632845636, 20.243737400315457, 21.90422725041467, 19.644121489017003, 21.543707890765255, 20.613771299315008, 19.304297638312146, 18.836654452380827, 19.567881002519467, 21.689839213565932, 16.48677691681774, 22.0236822629948, 17.264784037095474, 19.81027879650193, 18.94500652894944, 17.67026193553448, 17.713070909866282, 20.27233142414783, 21.357242354775433, 21.867128743455815, 21.560105574076392, 17.53653321742118, 20.22666664734038, 19.58769990788312, 19.735988717555742, 21.775425792331397, 19.235524253309734, 20.31269440392591, 20.167529277546965, 21.85448487248491, 19.46599309537712, 20.01658961124941, 20.397154447091495, 18.94003089608895, 19.952832047509087, 20.3579116416652, 21.515373681904254, 19.58558664630141, 20.51639827832074, 21.2546622670221, 21.558141594276982, 20.648366587273422, 19.265791313838005, 19.355845838890986, 23.345777081849896, 18.77422501384491, 19.29519018868632, 18.88425080641328, 21.668826416341993, 20.672060813985357, 21.28980544816792, 21.2752908666004, 21.74466671207645, 20.165470966835503, 20.435170302661753, 23.68355869002125, 19.82734494835512, 18.41238565078685, 21.5988375983969, 21.787145744617654, 19.715439394336787, 19.574449489282422, 20.192484577192552, 19.7213282104484, 21.481548541087133, 20.656552710677612, 20.838325913224384, 23.08800246274921, 19.526482343787393, 20.98295001879058, 20.971903547920657, 20.323906932282373, 21.03723815599221, 18.42491380429579, 20.56163225265246, 22.09996413336959, 20.334182416107705, 20.56776216314002, 19.45497714841275, 20.77673102532019, 18.5819478570175, 19.575337377053135, 19.120957623564067, 22.16994043654988], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1034997816566543, "mean_inference_ms": 8.107382612329248, "mean_action_processing_ms": 0.5540405476740464, "mean_env_wait_ms": 23.86561787579077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0320284366607666, "StateBufferConnector_ms": 0.03298187255859375, "ViewRequirementAgentConnector_ms": 0.8665151596069336}}, "episode_reward_max": 24.676267235987513, "episode_reward_min": 16.48677691681774, "episode_reward_mean": 20.356777367782865, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.651206362989807, 24.676267235987513, 17.944442847480012, 20.942180668783344, 18.75837890647202, 23.56210714755948, 21.877497947911944, 22.792700235468306, 19.726492418706837, 18.646887098169078, 22.38009981270724, 21.775970527799235, 20.92451731170576, 18.885601615134657, 21.733288241656414, 19.31350412897258, 18.86549632845636, 20.243737400315457, 21.90422725041467, 19.644121489017003, 21.543707890765255, 20.613771299315008, 19.304297638312146, 18.836654452380827, 19.567881002519467, 21.689839213565932, 16.48677691681774, 22.0236822629948, 17.264784037095474, 19.81027879650193, 18.94500652894944, 17.67026193553448, 17.713070909866282, 20.27233142414783, 21.357242354775433, 21.867128743455815, 21.560105574076392, 17.53653321742118, 20.22666664734038, 19.58769990788312, 19.735988717555742, 21.775425792331397, 19.235524253309734, 20.31269440392591, 20.167529277546965, 21.85448487248491, 19.46599309537712, 20.01658961124941, 20.397154447091495, 18.94003089608895, 19.952832047509087, 20.3579116416652, 21.515373681904254, 19.58558664630141, 20.51639827832074, 21.2546622670221, 21.558141594276982, 20.648366587273422, 19.265791313838005, 19.355845838890986, 23.345777081849896, 18.77422501384491, 19.29519018868632, 18.88425080641328, 21.668826416341993, 20.672060813985357, 21.28980544816792, 21.2752908666004, 21.74466671207645, 20.165470966835503, 20.435170302661753, 23.68355869002125, 19.82734494835512, 18.41238565078685, 21.5988375983969, 21.787145744617654, 19.715439394336787, 19.574449489282422, 20.192484577192552, 19.7213282104484, 21.481548541087133, 20.656552710677612, 20.838325913224384, 23.08800246274921, 19.526482343787393, 20.98295001879058, 20.971903547920657, 20.323906932282373, 21.03723815599221, 18.42491380429579, 20.56163225265246, 22.09996413336959, 20.334182416107705, 20.56776216314002, 19.45497714841275, 20.77673102532019, 18.5819478570175, 19.575337377053135, 19.120957623564067, 22.16994043654988], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1034997816566543, "mean_inference_ms": 8.107382612329248, "mean_action_processing_ms": 0.5540405476740464, "mean_env_wait_ms": 23.86561787579077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0320284366607666, "StateBufferConnector_ms": 0.03298187255859375, "ViewRequirementAgentConnector_ms": 0.8665151596069336}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1575594, "num_agent_steps_trained": 1575594, "num_env_steps_sampled": 1575594, "num_env_steps_trained": 1575594, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.1625376579495, "num_env_steps_trained_throughput_per_sec": 284.1625376579495, "timesteps_total": 1575594, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1575594, "timers": {"training_iteration_time_ms": 55218.953, "sample_time_ms": 41496.614, "load_time_ms": 1779.544, "load_throughput": 8787.646, "learn_time_ms": 11383.443, "learn_throughput": 1373.75, "synch_weights_time_ms": 440.14}, "counters": {"num_env_steps_sampled": 1575594, "num_env_steps_trained": 1575594, "num_agent_steps_sampled": 1575594, "num_agent_steps_trained": 1575594}, "done": false, "episodes_total": 546, "training_iteration": 105, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-06-40", "timestamp": 1749244000, "time_this_iter_s": 55.05743193626404, "time_total_s": 2239.0055820941925, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2239.0055820941925, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 75.82857142857142, "ram_util_percent": 63.97301587301588, "gpu_util_percent0": 0.07857142857142857, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.424406e-05, "total_loss": -0.08955783598886972, "policy_loss": -0.016412968610781137, "vf_loss": 0.015443762572990223, "vf_explained_var": 0.8637857232310555, "kl": 0.0189638312701267, "entropy": 18.128866036155006, "entropy_coeff": 0.004848811999999999}, "model": {}, "num_grad_updates_lifetime": 21725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1591232, "num_env_steps_trained": 1591232, "num_agent_steps_sampled": 1591232, "num_agent_steps_trained": 1591232}, "sampler_results": {"episode_reward_max": 23.68355869002125, "episode_reward_min": 16.48677691681774, "episode_reward_mean": 20.199412050095656, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.733288241656414, 19.31350412897258, 18.86549632845636, 20.243737400315457, 21.90422725041467, 19.644121489017003, 21.543707890765255, 20.613771299315008, 19.304297638312146, 18.836654452380827, 19.567881002519467, 21.689839213565932, 16.48677691681774, 22.0236822629948, 17.264784037095474, 19.81027879650193, 18.94500652894944, 17.67026193553448, 17.713070909866282, 20.27233142414783, 21.357242354775433, 21.867128743455815, 21.560105574076392, 17.53653321742118, 20.22666664734038, 19.58769990788312, 19.735988717555742, 21.775425792331397, 19.235524253309734, 20.31269440392591, 20.167529277546965, 21.85448487248491, 19.46599309537712, 20.01658961124941, 20.397154447091495, 18.94003089608895, 19.952832047509087, 20.3579116416652, 21.515373681904254, 19.58558664630141, 20.51639827832074, 21.2546622670221, 21.558141594276982, 20.648366587273422, 19.265791313838005, 19.355845838890986, 23.345777081849896, 18.77422501384491, 19.29519018868632, 18.88425080641328, 21.668826416341993, 20.672060813985357, 21.28980544816792, 21.2752908666004, 21.74466671207645, 20.165470966835503, 20.435170302661753, 23.68355869002125, 19.82734494835512, 18.41238565078685, 21.5988375983969, 21.787145744617654, 19.715439394336787, 19.574449489282422, 20.192484577192552, 19.7213282104484, 21.481548541087133, 20.656552710677612, 20.838325913224384, 23.08800246274921, 19.526482343787393, 20.98295001879058, 20.971903547920657, 20.323906932282373, 21.03723815599221, 18.42491380429579, 20.56163225265246, 22.09996413336959, 20.334182416107705, 20.56776216314002, 19.45497714841275, 20.77673102532019, 18.5819478570175, 19.575337377053135, 19.120957623564067, 22.16994043654988, 17.282937765053383, 22.061207249221862, 19.96445289440971, 19.93460889161007, 19.99377962748594, 20.343509364138107, 21.44206121767222, 18.20273021699322, 20.027922322589482, 17.831212404711412, 18.61960349811972, 20.566670421795358, 20.773910872243466, 18.763211622110045], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.100938462386724, "mean_inference_ms": 8.107769568316462, "mean_action_processing_ms": 0.5541348580663742, "mean_env_wait_ms": 23.863317677102717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02807140350341797, "StateBufferConnector_ms": 0.03207731246948242, "ViewRequirementAgentConnector_ms": 0.8812017440795898}}, "episode_reward_max": 23.68355869002125, "episode_reward_min": 16.48677691681774, "episode_reward_mean": 20.199412050095656, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.733288241656414, 19.31350412897258, 18.86549632845636, 20.243737400315457, 21.90422725041467, 19.644121489017003, 21.543707890765255, 20.613771299315008, 19.304297638312146, 18.836654452380827, 19.567881002519467, 21.689839213565932, 16.48677691681774, 22.0236822629948, 17.264784037095474, 19.81027879650193, 18.94500652894944, 17.67026193553448, 17.713070909866282, 20.27233142414783, 21.357242354775433, 21.867128743455815, 21.560105574076392, 17.53653321742118, 20.22666664734038, 19.58769990788312, 19.735988717555742, 21.775425792331397, 19.235524253309734, 20.31269440392591, 20.167529277546965, 21.85448487248491, 19.46599309537712, 20.01658961124941, 20.397154447091495, 18.94003089608895, 19.952832047509087, 20.3579116416652, 21.515373681904254, 19.58558664630141, 20.51639827832074, 21.2546622670221, 21.558141594276982, 20.648366587273422, 19.265791313838005, 19.355845838890986, 23.345777081849896, 18.77422501384491, 19.29519018868632, 18.88425080641328, 21.668826416341993, 20.672060813985357, 21.28980544816792, 21.2752908666004, 21.74466671207645, 20.165470966835503, 20.435170302661753, 23.68355869002125, 19.82734494835512, 18.41238565078685, 21.5988375983969, 21.787145744617654, 19.715439394336787, 19.574449489282422, 20.192484577192552, 19.7213282104484, 21.481548541087133, 20.656552710677612, 20.838325913224384, 23.08800246274921, 19.526482343787393, 20.98295001879058, 20.971903547920657, 20.323906932282373, 21.03723815599221, 18.42491380429579, 20.56163225265246, 22.09996413336959, 20.334182416107705, 20.56776216314002, 19.45497714841275, 20.77673102532019, 18.5819478570175, 19.575337377053135, 19.120957623564067, 22.16994043654988, 17.282937765053383, 22.061207249221862, 19.96445289440971, 19.93460889161007, 19.99377962748594, 20.343509364138107, 21.44206121767222, 18.20273021699322, 20.027922322589482, 17.831212404711412, 18.61960349811972, 20.566670421795358, 20.773910872243466, 18.763211622110045], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.100938462386724, "mean_inference_ms": 8.107769568316462, "mean_action_processing_ms": 0.5541348580663742, "mean_env_wait_ms": 23.863317677102717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02807140350341797, "StateBufferConnector_ms": 0.03207731246948242, "ViewRequirementAgentConnector_ms": 0.8812017440795898}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1591232, "num_agent_steps_trained": 1591232, "num_env_steps_sampled": 1591232, "num_env_steps_trained": 1591232, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.5365265497796, "num_env_steps_trained_throughput_per_sec": 283.5365265497796, "timesteps_total": 1591232, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1591232, "timers": {"training_iteration_time_ms": 55309.073, "sample_time_ms": 41569.973, "load_time_ms": 1784.868, "load_throughput": 8761.434, "learn_time_ms": 11393.646, "learn_throughput": 1372.519, "synch_weights_time_ms": 438.367}, "counters": {"num_env_steps_sampled": 1591232, "num_env_steps_trained": 1591232, "num_agent_steps_sampled": 1591232, "num_agent_steps_trained": 1591232}, "done": false, "episodes_total": 560, "training_iteration": 106, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-07-35", "timestamp": 1749244055, "time_this_iter_s": 55.17319655418396, "time_total_s": 2294.1787786483765, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2294.1787786483765, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 75.9234375, "ram_util_percent": 63.743750000000006, "gpu_util_percent0": 0.07593749999999999, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.408768e-05, "total_loss": -0.09602280937854878, "policy_loss": -0.022847979914143005, "vf_loss": 0.014889451585794715, "vf_explained_var": 0.8732667822187598, "kl": 0.01860319661812603, "entropy": 18.17829072258689, "entropy_coeff": 0.004817536}, "model": {}, "num_grad_updates_lifetime": 22275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1606870, "num_env_steps_trained": 1606870, "num_agent_steps_sampled": 1606870, "num_agent_steps_trained": 1606870}, "sampler_results": {"episode_reward_max": 23.68355869002125, "episode_reward_min": 16.477158023411114, "episode_reward_mean": 20.15287728362233, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.264784037095474, 19.81027879650193, 18.94500652894944, 17.67026193553448, 17.713070909866282, 20.27233142414783, 21.357242354775433, 21.867128743455815, 21.560105574076392, 17.53653321742118, 20.22666664734038, 19.58769990788312, 19.735988717555742, 21.775425792331397, 19.235524253309734, 20.31269440392591, 20.167529277546965, 21.85448487248491, 19.46599309537712, 20.01658961124941, 20.397154447091495, 18.94003089608895, 19.952832047509087, 20.3579116416652, 21.515373681904254, 19.58558664630141, 20.51639827832074, 21.2546622670221, 21.558141594276982, 20.648366587273422, 19.265791313838005, 19.355845838890986, 23.345777081849896, 18.77422501384491, 19.29519018868632, 18.88425080641328, 21.668826416341993, 20.672060813985357, 21.28980544816792, 21.2752908666004, 21.74466671207645, 20.165470966835503, 20.435170302661753, 23.68355869002125, 19.82734494835512, 18.41238565078685, 21.5988375983969, 21.787145744617654, 19.715439394336787, 19.574449489282422, 20.192484577192552, 19.7213282104484, 21.481548541087133, 20.656552710677612, 20.838325913224384, 23.08800246274921, 19.526482343787393, 20.98295001879058, 20.971903547920657, 20.323906932282373, 21.03723815599221, 18.42491380429579, 20.56163225265246, 22.09996413336959, 20.334182416107705, 20.56776216314002, 19.45497714841275, 20.77673102532019, 18.5819478570175, 19.575337377053135, 19.120957623564067, 22.16994043654988, 17.282937765053383, 22.061207249221862, 19.96445289440971, 19.93460889161007, 19.99377962748594, 20.343509364138107, 21.44206121767222, 18.20273021699322, 20.027922322589482, 17.831212404711412, 18.61960349811972, 20.566670421795358, 20.773910872243466, 18.763211622110045, 20.263262757599037, 18.915921276757338, 18.99758180748409, 16.477158023411114, 17.248915186487274, 22.96376840966921, 20.869161058337134, 18.217854743846996, 19.475656740994452, 22.119082187048953, 18.218647361688483, 21.327756793445385, 21.107810811925823, 20.914931709475965], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.098821640085248, "mean_inference_ms": 8.108571546304745, "mean_action_processing_ms": 0.5542114075696074, "mean_env_wait_ms": 23.863244601288894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029062986373901367, "StateBufferConnector_ms": 0.04427599906921387, "ViewRequirementAgentConnector_ms": 0.8630406856536865}}, "episode_reward_max": 23.68355869002125, "episode_reward_min": 16.477158023411114, "episode_reward_mean": 20.15287728362233, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.264784037095474, 19.81027879650193, 18.94500652894944, 17.67026193553448, 17.713070909866282, 20.27233142414783, 21.357242354775433, 21.867128743455815, 21.560105574076392, 17.53653321742118, 20.22666664734038, 19.58769990788312, 19.735988717555742, 21.775425792331397, 19.235524253309734, 20.31269440392591, 20.167529277546965, 21.85448487248491, 19.46599309537712, 20.01658961124941, 20.397154447091495, 18.94003089608895, 19.952832047509087, 20.3579116416652, 21.515373681904254, 19.58558664630141, 20.51639827832074, 21.2546622670221, 21.558141594276982, 20.648366587273422, 19.265791313838005, 19.355845838890986, 23.345777081849896, 18.77422501384491, 19.29519018868632, 18.88425080641328, 21.668826416341993, 20.672060813985357, 21.28980544816792, 21.2752908666004, 21.74466671207645, 20.165470966835503, 20.435170302661753, 23.68355869002125, 19.82734494835512, 18.41238565078685, 21.5988375983969, 21.787145744617654, 19.715439394336787, 19.574449489282422, 20.192484577192552, 19.7213282104484, 21.481548541087133, 20.656552710677612, 20.838325913224384, 23.08800246274921, 19.526482343787393, 20.98295001879058, 20.971903547920657, 20.323906932282373, 21.03723815599221, 18.42491380429579, 20.56163225265246, 22.09996413336959, 20.334182416107705, 20.56776216314002, 19.45497714841275, 20.77673102532019, 18.5819478570175, 19.575337377053135, 19.120957623564067, 22.16994043654988, 17.282937765053383, 22.061207249221862, 19.96445289440971, 19.93460889161007, 19.99377962748594, 20.343509364138107, 21.44206121767222, 18.20273021699322, 20.027922322589482, 17.831212404711412, 18.61960349811972, 20.566670421795358, 20.773910872243466, 18.763211622110045, 20.263262757599037, 18.915921276757338, 18.99758180748409, 16.477158023411114, 17.248915186487274, 22.96376840966921, 20.869161058337134, 18.217854743846996, 19.475656740994452, 22.119082187048953, 18.218647361688483, 21.327756793445385, 21.107810811925823, 20.914931709475965], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.098821640085248, "mean_inference_ms": 8.108571546304745, "mean_action_processing_ms": 0.5542114075696074, "mean_env_wait_ms": 23.863244601288894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029062986373901367, "StateBufferConnector_ms": 0.04427599906921387, "ViewRequirementAgentConnector_ms": 0.8630406856536865}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1606870, "num_agent_steps_trained": 1606870, "num_env_steps_sampled": 1606870, "num_env_steps_trained": 1606870, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.7500844642093, "num_env_steps_trained_throughput_per_sec": 281.7500844642093, "timesteps_total": 1606870, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1606870, "timers": {"training_iteration_time_ms": 55381.383, "sample_time_ms": 41675.834, "load_time_ms": 1767.41, "load_throughput": 8847.976, "learn_time_ms": 11388.108, "learn_throughput": 1373.187, "synch_weights_time_ms": 424.388}, "counters": {"num_env_steps_sampled": 1606870, "num_env_steps_trained": 1606870, "num_agent_steps_sampled": 1606870, "num_agent_steps_trained": 1606870}, "done": false, "episodes_total": 574, "training_iteration": 107, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-08-31", "timestamp": 1749244111, "time_this_iter_s": 55.52109622955322, "time_total_s": 2349.6998748779297, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2349.6998748779297, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 76.6875, "ram_util_percent": 63.606249999999996, "gpu_util_percent0": 0.07375000000000001, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.393129999999999e-05, "total_loss": -0.09914410858584398, "policy_loss": -0.02693838671384252, "vf_loss": 0.01396034267688678, "vf_explained_var": 0.8861768024617975, "kl": 0.01963686751757602, "entropy": 18.151677332791415, "entropy_coeff": 0.0047862600000000005}, "model": {}, "num_grad_updates_lifetime": 22825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1622508, "num_env_steps_trained": 1622508, "num_agent_steps_sampled": 1622508, "num_agent_steps_trained": 1622508}, "sampler_results": {"episode_reward_max": 23.68355869002125, "episode_reward_min": 16.477158023411114, "episode_reward_mean": 20.321645619152356, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.235524253309734, 20.31269440392591, 20.167529277546965, 21.85448487248491, 19.46599309537712, 20.01658961124941, 20.397154447091495, 18.94003089608895, 19.952832047509087, 20.3579116416652, 21.515373681904254, 19.58558664630141, 20.51639827832074, 21.2546622670221, 21.558141594276982, 20.648366587273422, 19.265791313838005, 19.355845838890986, 23.345777081849896, 18.77422501384491, 19.29519018868632, 18.88425080641328, 21.668826416341993, 20.672060813985357, 21.28980544816792, 21.2752908666004, 21.74466671207645, 20.165470966835503, 20.435170302661753, 23.68355869002125, 19.82734494835512, 18.41238565078685, 21.5988375983969, 21.787145744617654, 19.715439394336787, 19.574449489282422, 20.192484577192552, 19.7213282104484, 21.481548541087133, 20.656552710677612, 20.838325913224384, 23.08800246274921, 19.526482343787393, 20.98295001879058, 20.971903547920657, 20.323906932282373, 21.03723815599221, 18.42491380429579, 20.56163225265246, 22.09996413336959, 20.334182416107705, 20.56776216314002, 19.45497714841275, 20.77673102532019, 18.5819478570175, 19.575337377053135, 19.120957623564067, 22.16994043654988, 17.282937765053383, 22.061207249221862, 19.96445289440971, 19.93460889161007, 19.99377962748594, 20.343509364138107, 21.44206121767222, 18.20273021699322, 20.027922322589482, 17.831212404711412, 18.61960349811972, 20.566670421795358, 20.773910872243466, 18.763211622110045, 20.263262757599037, 18.915921276757338, 18.99758180748409, 16.477158023411114, 17.248915186487274, 22.96376840966921, 20.869161058337134, 18.217854743846996, 19.475656740994452, 22.119082187048953, 18.218647361688483, 21.327756793445385, 21.107810811925823, 20.914931709475965, 20.092363061486395, 19.803263037985776, 22.20513481941599, 22.233268419393628, 20.872015907654493, 21.49191035484908, 19.32927357129212, 22.728773369174416, 18.89385477254785, 20.72904260461701, 20.817555925419796, 18.77079888720475, 21.458633981465002, 22.773469427430648], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.096910073827018, "mean_inference_ms": 8.109231040088623, "mean_action_processing_ms": 0.5541983332492163, "mean_env_wait_ms": 23.862227554114153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031116247177124023, "StateBufferConnector_ms": 0.035288333892822266, "ViewRequirementAgentConnector_ms": 0.8829092979431152}}, "episode_reward_max": 23.68355869002125, "episode_reward_min": 16.477158023411114, "episode_reward_mean": 20.321645619152356, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.235524253309734, 20.31269440392591, 20.167529277546965, 21.85448487248491, 19.46599309537712, 20.01658961124941, 20.397154447091495, 18.94003089608895, 19.952832047509087, 20.3579116416652, 21.515373681904254, 19.58558664630141, 20.51639827832074, 21.2546622670221, 21.558141594276982, 20.648366587273422, 19.265791313838005, 19.355845838890986, 23.345777081849896, 18.77422501384491, 19.29519018868632, 18.88425080641328, 21.668826416341993, 20.672060813985357, 21.28980544816792, 21.2752908666004, 21.74466671207645, 20.165470966835503, 20.435170302661753, 23.68355869002125, 19.82734494835512, 18.41238565078685, 21.5988375983969, 21.787145744617654, 19.715439394336787, 19.574449489282422, 20.192484577192552, 19.7213282104484, 21.481548541087133, 20.656552710677612, 20.838325913224384, 23.08800246274921, 19.526482343787393, 20.98295001879058, 20.971903547920657, 20.323906932282373, 21.03723815599221, 18.42491380429579, 20.56163225265246, 22.09996413336959, 20.334182416107705, 20.56776216314002, 19.45497714841275, 20.77673102532019, 18.5819478570175, 19.575337377053135, 19.120957623564067, 22.16994043654988, 17.282937765053383, 22.061207249221862, 19.96445289440971, 19.93460889161007, 19.99377962748594, 20.343509364138107, 21.44206121767222, 18.20273021699322, 20.027922322589482, 17.831212404711412, 18.61960349811972, 20.566670421795358, 20.773910872243466, 18.763211622110045, 20.263262757599037, 18.915921276757338, 18.99758180748409, 16.477158023411114, 17.248915186487274, 22.96376840966921, 20.869161058337134, 18.217854743846996, 19.475656740994452, 22.119082187048953, 18.218647361688483, 21.327756793445385, 21.107810811925823, 20.914931709475965, 20.092363061486395, 19.803263037985776, 22.20513481941599, 22.233268419393628, 20.872015907654493, 21.49191035484908, 19.32927357129212, 22.728773369174416, 18.89385477254785, 20.72904260461701, 20.817555925419796, 18.77079888720475, 21.458633981465002, 22.773469427430648], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.096910073827018, "mean_inference_ms": 8.109231040088623, "mean_action_processing_ms": 0.5541983332492163, "mean_env_wait_ms": 23.862227554114153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031116247177124023, "StateBufferConnector_ms": 0.035288333892822266, "ViewRequirementAgentConnector_ms": 0.8829092979431152}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1622508, "num_agent_steps_trained": 1622508, "num_env_steps_sampled": 1622508, "num_env_steps_trained": 1622508, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.13675465552, "num_env_steps_trained_throughput_per_sec": 284.13675465552, "timesteps_total": 1622508, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1622508, "timers": {"training_iteration_time_ms": 55250.955, "sample_time_ms": 41539.513, "load_time_ms": 1770.563, "load_throughput": 8832.22, "learn_time_ms": 11395.358, "learn_throughput": 1372.313, "synch_weights_time_ms": 424.686}, "counters": {"num_env_steps_sampled": 1622508, "num_env_steps_trained": 1622508, "num_agent_steps_sampled": 1622508, "num_agent_steps_trained": 1622508}, "done": false, "episodes_total": 588, "training_iteration": 108, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-09-26", "timestamp": 1749244166, "time_this_iter_s": 55.05688977241516, "time_total_s": 2404.756764650345, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2404.756764650345, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 75.915625, "ram_util_percent": 63.646875, "gpu_util_percent0": 0.079375, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.377492000000001e-05, "total_loss": -0.10229106043825265, "policy_loss": -0.0300263315751429, "vf_loss": 0.01468860115644268, "vf_explained_var": 0.8783935261856426, "kl": 0.01855845284786057, "entropy": 18.208332479650323, "entropy_coeff": 0.004754984000000001}, "model": {}, "num_grad_updates_lifetime": 23375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1638146, "num_env_steps_trained": 1638146, "num_agent_steps_sampled": 1638146, "num_agent_steps_trained": 1638146}, "sampler_results": {"episode_reward_max": 23.702196151496302, "episode_reward_min": 16.477158023411114, "episode_reward_mean": 20.366672037830295, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.558141594276982, 20.648366587273422, 19.265791313838005, 19.355845838890986, 23.345777081849896, 18.77422501384491, 19.29519018868632, 18.88425080641328, 21.668826416341993, 20.672060813985357, 21.28980544816792, 21.2752908666004, 21.74466671207645, 20.165470966835503, 20.435170302661753, 23.68355869002125, 19.82734494835512, 18.41238565078685, 21.5988375983969, 21.787145744617654, 19.715439394336787, 19.574449489282422, 20.192484577192552, 19.7213282104484, 21.481548541087133, 20.656552710677612, 20.838325913224384, 23.08800246274921, 19.526482343787393, 20.98295001879058, 20.971903547920657, 20.323906932282373, 21.03723815599221, 18.42491380429579, 20.56163225265246, 22.09996413336959, 20.334182416107705, 20.56776216314002, 19.45497714841275, 20.77673102532019, 18.5819478570175, 19.575337377053135, 19.120957623564067, 22.16994043654988, 17.282937765053383, 22.061207249221862, 19.96445289440971, 19.93460889161007, 19.99377962748594, 20.343509364138107, 21.44206121767222, 18.20273021699322, 20.027922322589482, 17.831212404711412, 18.61960349811972, 20.566670421795358, 20.773910872243466, 18.763211622110045, 20.263262757599037, 18.915921276757338, 18.99758180748409, 16.477158023411114, 17.248915186487274, 22.96376840966921, 20.869161058337134, 18.217854743846996, 19.475656740994452, 22.119082187048953, 18.218647361688483, 21.327756793445385, 21.107810811925823, 20.914931709475965, 20.092363061486395, 19.803263037985776, 22.20513481941599, 22.233268419393628, 20.872015907654493, 21.49191035484908, 19.32927357129212, 22.728773369174416, 18.89385477254785, 20.72904260461701, 20.817555925419796, 18.77079888720475, 21.458633981465002, 22.773469427430648, 17.106690372377496, 22.343640782371523, 20.345326724862293, 19.355547406372263, 19.67330388529373, 23.702196151496302, 22.17018469171696, 21.539411795731873, 19.422318336684242, 19.051453710578528, 20.03048489941098, 20.26438411082563, 22.724993160041272, 20.345471259828347], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.095114543677649, "mean_inference_ms": 8.10991115171683, "mean_action_processing_ms": 0.5541985728692765, "mean_env_wait_ms": 23.86111192103825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0321192741394043, "StateBufferConnector_ms": 0.03223085403442383, "ViewRequirementAgentConnector_ms": 0.8475408554077148}}, "episode_reward_max": 23.702196151496302, "episode_reward_min": 16.477158023411114, "episode_reward_mean": 20.366672037830295, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.558141594276982, 20.648366587273422, 19.265791313838005, 19.355845838890986, 23.345777081849896, 18.77422501384491, 19.29519018868632, 18.88425080641328, 21.668826416341993, 20.672060813985357, 21.28980544816792, 21.2752908666004, 21.74466671207645, 20.165470966835503, 20.435170302661753, 23.68355869002125, 19.82734494835512, 18.41238565078685, 21.5988375983969, 21.787145744617654, 19.715439394336787, 19.574449489282422, 20.192484577192552, 19.7213282104484, 21.481548541087133, 20.656552710677612, 20.838325913224384, 23.08800246274921, 19.526482343787393, 20.98295001879058, 20.971903547920657, 20.323906932282373, 21.03723815599221, 18.42491380429579, 20.56163225265246, 22.09996413336959, 20.334182416107705, 20.56776216314002, 19.45497714841275, 20.77673102532019, 18.5819478570175, 19.575337377053135, 19.120957623564067, 22.16994043654988, 17.282937765053383, 22.061207249221862, 19.96445289440971, 19.93460889161007, 19.99377962748594, 20.343509364138107, 21.44206121767222, 18.20273021699322, 20.027922322589482, 17.831212404711412, 18.61960349811972, 20.566670421795358, 20.773910872243466, 18.763211622110045, 20.263262757599037, 18.915921276757338, 18.99758180748409, 16.477158023411114, 17.248915186487274, 22.96376840966921, 20.869161058337134, 18.217854743846996, 19.475656740994452, 22.119082187048953, 18.218647361688483, 21.327756793445385, 21.107810811925823, 20.914931709475965, 20.092363061486395, 19.803263037985776, 22.20513481941599, 22.233268419393628, 20.872015907654493, 21.49191035484908, 19.32927357129212, 22.728773369174416, 18.89385477254785, 20.72904260461701, 20.817555925419796, 18.77079888720475, 21.458633981465002, 22.773469427430648, 17.106690372377496, 22.343640782371523, 20.345326724862293, 19.355547406372263, 19.67330388529373, 23.702196151496302, 22.17018469171696, 21.539411795731873, 19.422318336684242, 19.051453710578528, 20.03048489941098, 20.26438411082563, 22.724993160041272, 20.345471259828347], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.095114543677649, "mean_inference_ms": 8.10991115171683, "mean_action_processing_ms": 0.5541985728692765, "mean_env_wait_ms": 23.86111192103825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0321192741394043, "StateBufferConnector_ms": 0.03223085403442383, "ViewRequirementAgentConnector_ms": 0.8475408554077148}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1638146, "num_agent_steps_trained": 1638146, "num_env_steps_sampled": 1638146, "num_env_steps_trained": 1638146, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.88332711115766, "num_env_steps_trained_throughput_per_sec": 282.88332711115766, "timesteps_total": 1638146, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1638146, "timers": {"training_iteration_time_ms": 55274.245, "sample_time_ms": 41545.026, "load_time_ms": 1781.596, "load_throughput": 8777.523, "learn_time_ms": 11405.451, "learn_throughput": 1371.099, "synch_weights_time_ms": 422.938}, "counters": {"num_env_steps_sampled": 1638146, "num_env_steps_trained": 1638146, "num_agent_steps_sampled": 1638146, "num_agent_steps_trained": 1638146}, "done": false, "episodes_total": 602, "training_iteration": 109, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-10-21", "timestamp": 1749244221, "time_this_iter_s": 55.29648447036743, "time_total_s": 2460.0532491207123, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2460.0532491207123, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 75.75625, "ram_util_percent": 63.815625000000004, "gpu_util_percent0": 0.08265625, "vram_util_percent0": 0.8592122395833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": 0.8182133489180696, "episode_reward_min": -6.907452345756338, "episode_reward_mean": -1.9883653689577105, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.907452345756338, -1.651130951289228, -0.40780893905562315, -1.7936479576054334, 0.8182133489180696], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6241028007800824, "mean_inference_ms": 3.771694243874039, "mean_action_processing_ms": 0.29926490742236317, "mean_env_wait_ms": 11.647542127705844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.04032135009765625, "ViewRequirementAgentConnector_ms": 0.36374568939208984}}, "episode_reward_max": 0.8182133489180696, "episode_reward_min": -6.907452345756338, "episode_reward_mean": -1.9883653689577105, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.907452345756338, -1.651130951289228, -0.40780893905562315, -1.7936479576054334, 0.8182133489180696], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6241028007800824, "mean_inference_ms": 3.771694243874039, "mean_action_processing_ms": 0.29926490742236317, "mean_env_wait_ms": 11.647542127705844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.04032135009765625, "ViewRequirementAgentConnector_ms": 0.36374568939208984}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.361854e-05, "total_loss": -0.09979807412336496, "policy_loss": -0.027656419355612756, "vf_loss": 0.014342496283775704, "vf_explained_var": 0.8772533520785245, "kl": 0.01820655061080426, "entropy": 18.241077880859375, "entropy_coeff": 0.004723707999999999}, "model": {}, "num_grad_updates_lifetime": 23925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1653784, "num_env_steps_trained": 1653784, "num_agent_steps_sampled": 1653784, "num_agent_steps_trained": 1653784}, "sampler_results": {"episode_reward_max": 23.702196151496302, "episode_reward_min": 16.401306088626075, "episode_reward_mean": 20.23444168440657, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.435170302661753, 23.68355869002125, 19.82734494835512, 18.41238565078685, 21.5988375983969, 21.787145744617654, 19.715439394336787, 19.574449489282422, 20.192484577192552, 19.7213282104484, 21.481548541087133, 20.656552710677612, 20.838325913224384, 23.08800246274921, 19.526482343787393, 20.98295001879058, 20.971903547920657, 20.323906932282373, 21.03723815599221, 18.42491380429579, 20.56163225265246, 22.09996413336959, 20.334182416107705, 20.56776216314002, 19.45497714841275, 20.77673102532019, 18.5819478570175, 19.575337377053135, 19.120957623564067, 22.16994043654988, 17.282937765053383, 22.061207249221862, 19.96445289440971, 19.93460889161007, 19.99377962748594, 20.343509364138107, 21.44206121767222, 18.20273021699322, 20.027922322589482, 17.831212404711412, 18.61960349811972, 20.566670421795358, 20.773910872243466, 18.763211622110045, 20.263262757599037, 18.915921276757338, 18.99758180748409, 16.477158023411114, 17.248915186487274, 22.96376840966921, 20.869161058337134, 18.217854743846996, 19.475656740994452, 22.119082187048953, 18.218647361688483, 21.327756793445385, 21.107810811925823, 20.914931709475965, 20.092363061486395, 19.803263037985776, 22.20513481941599, 22.233268419393628, 20.872015907654493, 21.49191035484908, 19.32927357129212, 22.728773369174416, 18.89385477254785, 20.72904260461701, 20.817555925419796, 18.77079888720475, 21.458633981465002, 22.773469427430648, 17.106690372377496, 22.343640782371523, 20.345326724862293, 19.355547406372263, 19.67330388529373, 23.702196151496302, 22.17018469171696, 21.539411795731873, 19.422318336684242, 19.051453710578528, 20.03048489941098, 20.26438411082563, 22.724993160041272, 20.345471259828347, 20.96763073570681, 22.81945220908284, 20.039006523598886, 20.255382055909763, 21.425960568371444, 16.46506255772547, 18.2252909296445, 19.585487286994884, 16.401306088626075, 20.586254297305437, 18.92992501288818, 21.179388386215543, 20.761180095772147, 17.07934755886715], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0932198006736, "mean_inference_ms": 8.110507483906325, "mean_action_processing_ms": 0.554176727504819, "mean_env_wait_ms": 23.86074166677843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02812671661376953, "StateBufferConnector_ms": 0.04345226287841797, "ViewRequirementAgentConnector_ms": 0.8254318237304688}}, "episode_reward_max": 23.702196151496302, "episode_reward_min": 16.401306088626075, "episode_reward_mean": 20.23444168440657, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.435170302661753, 23.68355869002125, 19.82734494835512, 18.41238565078685, 21.5988375983969, 21.787145744617654, 19.715439394336787, 19.574449489282422, 20.192484577192552, 19.7213282104484, 21.481548541087133, 20.656552710677612, 20.838325913224384, 23.08800246274921, 19.526482343787393, 20.98295001879058, 20.971903547920657, 20.323906932282373, 21.03723815599221, 18.42491380429579, 20.56163225265246, 22.09996413336959, 20.334182416107705, 20.56776216314002, 19.45497714841275, 20.77673102532019, 18.5819478570175, 19.575337377053135, 19.120957623564067, 22.16994043654988, 17.282937765053383, 22.061207249221862, 19.96445289440971, 19.93460889161007, 19.99377962748594, 20.343509364138107, 21.44206121767222, 18.20273021699322, 20.027922322589482, 17.831212404711412, 18.61960349811972, 20.566670421795358, 20.773910872243466, 18.763211622110045, 20.263262757599037, 18.915921276757338, 18.99758180748409, 16.477158023411114, 17.248915186487274, 22.96376840966921, 20.869161058337134, 18.217854743846996, 19.475656740994452, 22.119082187048953, 18.218647361688483, 21.327756793445385, 21.107810811925823, 20.914931709475965, 20.092363061486395, 19.803263037985776, 22.20513481941599, 22.233268419393628, 20.872015907654493, 21.49191035484908, 19.32927357129212, 22.728773369174416, 18.89385477254785, 20.72904260461701, 20.817555925419796, 18.77079888720475, 21.458633981465002, 22.773469427430648, 17.106690372377496, 22.343640782371523, 20.345326724862293, 19.355547406372263, 19.67330388529373, 23.702196151496302, 22.17018469171696, 21.539411795731873, 19.422318336684242, 19.051453710578528, 20.03048489941098, 20.26438411082563, 22.724993160041272, 20.345471259828347, 20.96763073570681, 22.81945220908284, 20.039006523598886, 20.255382055909763, 21.425960568371444, 16.46506255772547, 18.2252909296445, 19.585487286994884, 16.401306088626075, 20.586254297305437, 18.92992501288818, 21.179388386215543, 20.761180095772147, 17.07934755886715], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0932198006736, "mean_inference_ms": 8.110507483906325, "mean_action_processing_ms": 0.554176727504819, "mean_env_wait_ms": 23.86074166677843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02812671661376953, "StateBufferConnector_ms": 0.04345226287841797, "ViewRequirementAgentConnector_ms": 0.8254318237304688}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1653784, "num_agent_steps_trained": 1653784, "num_env_steps_sampled": 1653784, "num_env_steps_trained": 1653784, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.9628202598142, "num_env_steps_trained_throughput_per_sec": 280.9628202598142, "timesteps_total": 1653784, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1653784, "timers": {"training_iteration_time_ms": 55290.647, "sample_time_ms": 41536.545, "load_time_ms": 1769.371, "load_throughput": 8838.168, "learn_time_ms": 11439.26, "learn_throughput": 1367.046, "synch_weights_time_ms": 426.221}, "counters": {"num_env_steps_sampled": 1653784, "num_env_steps_trained": 1653784, "num_agent_steps_sampled": 1653784, "num_agent_steps_trained": 1653784}, "done": false, "episodes_total": 616, "training_iteration": 110, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-11-33", "timestamp": 1749244293, "time_this_iter_s": 71.92393469810486, "time_total_s": 2531.977183818817, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2531.977183818817, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 62.713095238095235, "ram_util_percent": 63.464285714285715, "gpu_util_percent0": 0.06166666666666666, "vram_util_percent0": 0.859212239583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.346215999999998e-05, "total_loss": -0.09156988947990943, "policy_loss": -0.020450494792735713, "vf_loss": 0.013764500142159786, "vf_explained_var": 0.8857689422910864, "kl": 0.01926308691851174, "entropy": 18.228073369806463, "entropy_coeff": 0.004692432}, "model": {}, "num_grad_updates_lifetime": 24475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1669422, "num_env_steps_trained": 1669422, "num_agent_steps_sampled": 1669422, "num_agent_steps_trained": 1669422}, "sampler_results": {"episode_reward_max": 23.702196151496302, "episode_reward_min": 16.401306088626075, "episode_reward_mean": 20.172591348763884, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.526482343787393, 20.98295001879058, 20.971903547920657, 20.323906932282373, 21.03723815599221, 18.42491380429579, 20.56163225265246, 22.09996413336959, 20.334182416107705, 20.56776216314002, 19.45497714841275, 20.77673102532019, 18.5819478570175, 19.575337377053135, 19.120957623564067, 22.16994043654988, 17.282937765053383, 22.061207249221862, 19.96445289440971, 19.93460889161007, 19.99377962748594, 20.343509364138107, 21.44206121767222, 18.20273021699322, 20.027922322589482, 17.831212404711412, 18.61960349811972, 20.566670421795358, 20.773910872243466, 18.763211622110045, 20.263262757599037, 18.915921276757338, 18.99758180748409, 16.477158023411114, 17.248915186487274, 22.96376840966921, 20.869161058337134, 18.217854743846996, 19.475656740994452, 22.119082187048953, 18.218647361688483, 21.327756793445385, 21.107810811925823, 20.914931709475965, 20.092363061486395, 19.803263037985776, 22.20513481941599, 22.233268419393628, 20.872015907654493, 21.49191035484908, 19.32927357129212, 22.728773369174416, 18.89385477254785, 20.72904260461701, 20.817555925419796, 18.77079888720475, 21.458633981465002, 22.773469427430648, 17.106690372377496, 22.343640782371523, 20.345326724862293, 19.355547406372263, 19.67330388529373, 23.702196151496302, 22.17018469171696, 21.539411795731873, 19.422318336684242, 19.051453710578528, 20.03048489941098, 20.26438411082563, 22.724993160041272, 20.345471259828347, 20.96763073570681, 22.81945220908284, 20.039006523598886, 20.255382055909763, 21.425960568371444, 16.46506255772547, 18.2252909296445, 19.585487286994884, 16.401306088626075, 20.586254297305437, 18.92992501288818, 21.179388386215543, 20.761180095772147, 17.07934755886715, 23.119074613225305, 19.204433421203873, 21.990740561717033, 21.786529811214958, 20.00564884969609, 18.487062568626833, 18.483538033037778, 20.06292747579429, 16.965542678536558, 19.31832226107072, 23.26796915853548, 19.672868311557988, 21.264569589901733, 21.198313335450777], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.091182316406597, "mean_inference_ms": 8.111162026603685, "mean_action_processing_ms": 0.5542212625179371, "mean_env_wait_ms": 23.860297641286106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02715444564819336, "StateBufferConnector_ms": 0.040477752685546875, "ViewRequirementAgentConnector_ms": 0.8479571342468262}}, "episode_reward_max": 23.702196151496302, "episode_reward_min": 16.401306088626075, "episode_reward_mean": 20.172591348763884, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.526482343787393, 20.98295001879058, 20.971903547920657, 20.323906932282373, 21.03723815599221, 18.42491380429579, 20.56163225265246, 22.09996413336959, 20.334182416107705, 20.56776216314002, 19.45497714841275, 20.77673102532019, 18.5819478570175, 19.575337377053135, 19.120957623564067, 22.16994043654988, 17.282937765053383, 22.061207249221862, 19.96445289440971, 19.93460889161007, 19.99377962748594, 20.343509364138107, 21.44206121767222, 18.20273021699322, 20.027922322589482, 17.831212404711412, 18.61960349811972, 20.566670421795358, 20.773910872243466, 18.763211622110045, 20.263262757599037, 18.915921276757338, 18.99758180748409, 16.477158023411114, 17.248915186487274, 22.96376840966921, 20.869161058337134, 18.217854743846996, 19.475656740994452, 22.119082187048953, 18.218647361688483, 21.327756793445385, 21.107810811925823, 20.914931709475965, 20.092363061486395, 19.803263037985776, 22.20513481941599, 22.233268419393628, 20.872015907654493, 21.49191035484908, 19.32927357129212, 22.728773369174416, 18.89385477254785, 20.72904260461701, 20.817555925419796, 18.77079888720475, 21.458633981465002, 22.773469427430648, 17.106690372377496, 22.343640782371523, 20.345326724862293, 19.355547406372263, 19.67330388529373, 23.702196151496302, 22.17018469171696, 21.539411795731873, 19.422318336684242, 19.051453710578528, 20.03048489941098, 20.26438411082563, 22.724993160041272, 20.345471259828347, 20.96763073570681, 22.81945220908284, 20.039006523598886, 20.255382055909763, 21.425960568371444, 16.46506255772547, 18.2252909296445, 19.585487286994884, 16.401306088626075, 20.586254297305437, 18.92992501288818, 21.179388386215543, 20.761180095772147, 17.07934755886715, 23.119074613225305, 19.204433421203873, 21.990740561717033, 21.786529811214958, 20.00564884969609, 18.487062568626833, 18.483538033037778, 20.06292747579429, 16.965542678536558, 19.31832226107072, 23.26796915853548, 19.672868311557988, 21.264569589901733, 21.198313335450777], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.091182316406597, "mean_inference_ms": 8.111162026603685, "mean_action_processing_ms": 0.5542212625179371, "mean_env_wait_ms": 23.860297641286106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02715444564819336, "StateBufferConnector_ms": 0.040477752685546875, "ViewRequirementAgentConnector_ms": 0.8479571342468262}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1669422, "num_agent_steps_trained": 1669422, "num_env_steps_sampled": 1669422, "num_env_steps_trained": 1669422, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.7054841300971, "num_env_steps_trained_throughput_per_sec": 283.7054841300971, "timesteps_total": 1669422, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1669422, "timers": {"training_iteration_time_ms": 55288.44, "sample_time_ms": 41532.31, "load_time_ms": 1763.714, "load_throughput": 8866.518, "learn_time_ms": 11444.885, "learn_throughput": 1366.375, "synch_weights_time_ms": 427.084}, "counters": {"num_env_steps_sampled": 1669422, "num_env_steps_trained": 1669422, "num_agent_steps_sampled": 1669422, "num_agent_steps_trained": 1669422}, "done": false, "episodes_total": 630, "training_iteration": 111, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-12-28", "timestamp": 1749244348, "time_this_iter_s": 55.14256167411804, "time_total_s": 2587.119745492935, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2587.119745492935, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 76.0875, "ram_util_percent": 63.954687500000006, "gpu_util_percent0": 0.07421875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.330578e-05, "total_loss": -0.09271610863252797, "policy_loss": -0.021886018298391718, "vf_loss": 0.01417416591239585, "vf_explained_var": 0.8866989745877006, "kl": 0.01886214412111175, "entropy": 18.268753877119586, "entropy_coeff": 0.004661156}, "model": {}, "num_grad_updates_lifetime": 25025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1685060, "num_env_steps_trained": 1685060, "num_agent_steps_sampled": 1685060, "num_agent_steps_trained": 1685060}, "sampler_results": {"episode_reward_max": 23.702196151496302, "episode_reward_min": 16.401306088626075, "episode_reward_mean": 20.119669732860913, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.120957623564067, 22.16994043654988, 17.282937765053383, 22.061207249221862, 19.96445289440971, 19.93460889161007, 19.99377962748594, 20.343509364138107, 21.44206121767222, 18.20273021699322, 20.027922322589482, 17.831212404711412, 18.61960349811972, 20.566670421795358, 20.773910872243466, 18.763211622110045, 20.263262757599037, 18.915921276757338, 18.99758180748409, 16.477158023411114, 17.248915186487274, 22.96376840966921, 20.869161058337134, 18.217854743846996, 19.475656740994452, 22.119082187048953, 18.218647361688483, 21.327756793445385, 21.107810811925823, 20.914931709475965, 20.092363061486395, 19.803263037985776, 22.20513481941599, 22.233268419393628, 20.872015907654493, 21.49191035484908, 19.32927357129212, 22.728773369174416, 18.89385477254785, 20.72904260461701, 20.817555925419796, 18.77079888720475, 21.458633981465002, 22.773469427430648, 17.106690372377496, 22.343640782371523, 20.345326724862293, 19.355547406372263, 19.67330388529373, 23.702196151496302, 22.17018469171696, 21.539411795731873, 19.422318336684242, 19.051453710578528, 20.03048489941098, 20.26438411082563, 22.724993160041272, 20.345471259828347, 20.96763073570681, 22.81945220908284, 20.039006523598886, 20.255382055909763, 21.425960568371444, 16.46506255772547, 18.2252909296445, 19.585487286994884, 16.401306088626075, 20.586254297305437, 18.92992501288818, 21.179388386215543, 20.761180095772147, 17.07934755886715, 23.119074613225305, 19.204433421203873, 21.990740561717033, 21.786529811214958, 20.00564884969609, 18.487062568626833, 18.483538033037778, 20.06292747579429, 16.965542678536558, 19.31832226107072, 23.26796915853548, 19.672868311557988, 21.264569589901733, 21.198313335450777, 20.232655038448826, 20.732898603970334, 20.81898080385268, 18.585076687906128, 18.024402900468573, 20.282230990554293, 19.687882539504557, 18.76443826447407, 21.591507844039196, 21.002442774827994, 21.524819231401285, 20.65124435358427, 16.719074567987693, 19.310112984825256], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0893089154411073, "mean_inference_ms": 8.111159050677328, "mean_action_processing_ms": 0.5542043853999257, "mean_env_wait_ms": 23.85930317851752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02925395965576172, "StateBufferConnector_ms": 0.03649616241455078, "ViewRequirementAgentConnector_ms": 0.8420989513397217}}, "episode_reward_max": 23.702196151496302, "episode_reward_min": 16.401306088626075, "episode_reward_mean": 20.119669732860913, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.120957623564067, 22.16994043654988, 17.282937765053383, 22.061207249221862, 19.96445289440971, 19.93460889161007, 19.99377962748594, 20.343509364138107, 21.44206121767222, 18.20273021699322, 20.027922322589482, 17.831212404711412, 18.61960349811972, 20.566670421795358, 20.773910872243466, 18.763211622110045, 20.263262757599037, 18.915921276757338, 18.99758180748409, 16.477158023411114, 17.248915186487274, 22.96376840966921, 20.869161058337134, 18.217854743846996, 19.475656740994452, 22.119082187048953, 18.218647361688483, 21.327756793445385, 21.107810811925823, 20.914931709475965, 20.092363061486395, 19.803263037985776, 22.20513481941599, 22.233268419393628, 20.872015907654493, 21.49191035484908, 19.32927357129212, 22.728773369174416, 18.89385477254785, 20.72904260461701, 20.817555925419796, 18.77079888720475, 21.458633981465002, 22.773469427430648, 17.106690372377496, 22.343640782371523, 20.345326724862293, 19.355547406372263, 19.67330388529373, 23.702196151496302, 22.17018469171696, 21.539411795731873, 19.422318336684242, 19.051453710578528, 20.03048489941098, 20.26438411082563, 22.724993160041272, 20.345471259828347, 20.96763073570681, 22.81945220908284, 20.039006523598886, 20.255382055909763, 21.425960568371444, 16.46506255772547, 18.2252909296445, 19.585487286994884, 16.401306088626075, 20.586254297305437, 18.92992501288818, 21.179388386215543, 20.761180095772147, 17.07934755886715, 23.119074613225305, 19.204433421203873, 21.990740561717033, 21.786529811214958, 20.00564884969609, 18.487062568626833, 18.483538033037778, 20.06292747579429, 16.965542678536558, 19.31832226107072, 23.26796915853548, 19.672868311557988, 21.264569589901733, 21.198313335450777, 20.232655038448826, 20.732898603970334, 20.81898080385268, 18.585076687906128, 18.024402900468573, 20.282230990554293, 19.687882539504557, 18.76443826447407, 21.591507844039196, 21.002442774827994, 21.524819231401285, 20.65124435358427, 16.719074567987693, 19.310112984825256], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0893089154411073, "mean_inference_ms": 8.111159050677328, "mean_action_processing_ms": 0.5542043853999257, "mean_env_wait_ms": 23.85930317851752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02925395965576172, "StateBufferConnector_ms": 0.03649616241455078, "ViewRequirementAgentConnector_ms": 0.8420989513397217}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1685060, "num_agent_steps_trained": 1685060, "num_env_steps_sampled": 1685060, "num_env_steps_trained": 1685060, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.3071865602256, "num_env_steps_trained_throughput_per_sec": 283.3071865602256, "timesteps_total": 1685060, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1685060, "timers": {"training_iteration_time_ms": 55270.918, "sample_time_ms": 41504.621, "load_time_ms": 1800.263, "load_throughput": 8686.509, "learn_time_ms": 11421.775, "learn_throughput": 1369.139, "synch_weights_time_ms": 423.351}, "counters": {"num_env_steps_sampled": 1685060, "num_env_steps_trained": 1685060, "num_agent_steps_sampled": 1685060, "num_agent_steps_trained": 1685060}, "done": false, "episodes_total": 644, "training_iteration": 112, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-13-24", "timestamp": 1749244404, "time_this_iter_s": 55.21788144111633, "time_total_s": 2642.3376269340515, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2642.3376269340515, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 76.38125, "ram_util_percent": 64.18125, "gpu_util_percent0": 0.0821875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.31494e-05, "total_loss": -0.09637728388082575, "policy_loss": -0.02540484861994628, "vf_loss": 0.013736939364620908, "vf_explained_var": 0.8850855912945488, "kl": 0.01782869352493664, "entropy": 18.275395388169724, "entropy_coeff": 0.00462988}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1700698, "num_env_steps_trained": 1700698, "num_agent_steps_sampled": 1700698, "num_agent_steps_trained": 1700698}, "sampler_results": {"episode_reward_max": 23.702196151496302, "episode_reward_min": 16.401306088626075, "episode_reward_mean": 20.02862393497204, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.773910872243466, 18.763211622110045, 20.263262757599037, 18.915921276757338, 18.99758180748409, 16.477158023411114, 17.248915186487274, 22.96376840966921, 20.869161058337134, 18.217854743846996, 19.475656740994452, 22.119082187048953, 18.218647361688483, 21.327756793445385, 21.107810811925823, 20.914931709475965, 20.092363061486395, 19.803263037985776, 22.20513481941599, 22.233268419393628, 20.872015907654493, 21.49191035484908, 19.32927357129212, 22.728773369174416, 18.89385477254785, 20.72904260461701, 20.817555925419796, 18.77079888720475, 21.458633981465002, 22.773469427430648, 17.106690372377496, 22.343640782371523, 20.345326724862293, 19.355547406372263, 19.67330388529373, 23.702196151496302, 22.17018469171696, 21.539411795731873, 19.422318336684242, 19.051453710578528, 20.03048489941098, 20.26438411082563, 22.724993160041272, 20.345471259828347, 20.96763073570681, 22.81945220908284, 20.039006523598886, 20.255382055909763, 21.425960568371444, 16.46506255772547, 18.2252909296445, 19.585487286994884, 16.401306088626075, 20.586254297305437, 18.92992501288818, 21.179388386215543, 20.761180095772147, 17.07934755886715, 23.119074613225305, 19.204433421203873, 21.990740561717033, 21.786529811214958, 20.00564884969609, 18.487062568626833, 18.483538033037778, 20.06292747579429, 16.965542678536558, 19.31832226107072, 23.26796915853548, 19.672868311557988, 21.264569589901733, 21.198313335450777, 20.232655038448826, 20.732898603970334, 20.81898080385268, 18.585076687906128, 18.024402900468573, 20.282230990554293, 19.687882539504557, 18.76443826447407, 21.591507844039196, 21.002442774827994, 21.524819231401285, 20.65124435358427, 16.719074567987693, 19.310112984825256, 19.034535589683365, 18.827935635674525, 18.46222371294726, 18.848177201351387, 17.03231371369316, 18.848680163940536, 18.01206350657105, 20.715451232678106, 20.760533698131955, 19.364668114524182, 19.121164935612665, 19.258407042739734, 20.107302844928096, 20.06355675255081], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0874495577358014, "mean_inference_ms": 8.11130312697514, "mean_action_processing_ms": 0.5542911060702851, "mean_env_wait_ms": 23.858872950896043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03127932548522949, "StateBufferConnector_ms": 0.03944230079650879, "ViewRequirementAgentConnector_ms": 0.8456783294677734}}, "episode_reward_max": 23.702196151496302, "episode_reward_min": 16.401306088626075, "episode_reward_mean": 20.02862393497204, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.773910872243466, 18.763211622110045, 20.263262757599037, 18.915921276757338, 18.99758180748409, 16.477158023411114, 17.248915186487274, 22.96376840966921, 20.869161058337134, 18.217854743846996, 19.475656740994452, 22.119082187048953, 18.218647361688483, 21.327756793445385, 21.107810811925823, 20.914931709475965, 20.092363061486395, 19.803263037985776, 22.20513481941599, 22.233268419393628, 20.872015907654493, 21.49191035484908, 19.32927357129212, 22.728773369174416, 18.89385477254785, 20.72904260461701, 20.817555925419796, 18.77079888720475, 21.458633981465002, 22.773469427430648, 17.106690372377496, 22.343640782371523, 20.345326724862293, 19.355547406372263, 19.67330388529373, 23.702196151496302, 22.17018469171696, 21.539411795731873, 19.422318336684242, 19.051453710578528, 20.03048489941098, 20.26438411082563, 22.724993160041272, 20.345471259828347, 20.96763073570681, 22.81945220908284, 20.039006523598886, 20.255382055909763, 21.425960568371444, 16.46506255772547, 18.2252909296445, 19.585487286994884, 16.401306088626075, 20.586254297305437, 18.92992501288818, 21.179388386215543, 20.761180095772147, 17.07934755886715, 23.119074613225305, 19.204433421203873, 21.990740561717033, 21.786529811214958, 20.00564884969609, 18.487062568626833, 18.483538033037778, 20.06292747579429, 16.965542678536558, 19.31832226107072, 23.26796915853548, 19.672868311557988, 21.264569589901733, 21.198313335450777, 20.232655038448826, 20.732898603970334, 20.81898080385268, 18.585076687906128, 18.024402900468573, 20.282230990554293, 19.687882539504557, 18.76443826447407, 21.591507844039196, 21.002442774827994, 21.524819231401285, 20.65124435358427, 16.719074567987693, 19.310112984825256, 19.034535589683365, 18.827935635674525, 18.46222371294726, 18.848177201351387, 17.03231371369316, 18.848680163940536, 18.01206350657105, 20.715451232678106, 20.760533698131955, 19.364668114524182, 19.121164935612665, 19.258407042739734, 20.107302844928096, 20.06355675255081], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0874495577358014, "mean_inference_ms": 8.11130312697514, "mean_action_processing_ms": 0.5542911060702851, "mean_env_wait_ms": 23.858872950896043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03127932548522949, "StateBufferConnector_ms": 0.03944230079650879, "ViewRequirementAgentConnector_ms": 0.8456783294677734}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1700698, "num_agent_steps_trained": 1700698, "num_env_steps_sampled": 1700698, "num_env_steps_trained": 1700698, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.803665416104, "num_env_steps_trained_throughput_per_sec": 281.803665416104, "timesteps_total": 1700698, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1700698, "timers": {"training_iteration_time_ms": 55303.874, "sample_time_ms": 41533.56, "load_time_ms": 1795.423, "load_throughput": 8709.924, "learn_time_ms": 11432.938, "learn_throughput": 1367.802, "synch_weights_time_ms": 420.907}, "counters": {"num_env_steps_sampled": 1700698, "num_env_steps_trained": 1700698, "num_agent_steps_sampled": 1700698, "num_agent_steps_trained": 1700698}, "done": false, "episodes_total": 658, "training_iteration": 113, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-14-19", "timestamp": 1749244459, "time_this_iter_s": 55.510539293289185, "time_total_s": 2697.8481662273407, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2697.8481662273407, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 77.7109375, "ram_util_percent": 64.0515625, "gpu_util_percent0": 0.08234375, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.299302000000001e-05, "total_loss": -0.10038387697359377, "policy_loss": -0.02988946703167378, "vf_loss": 0.013280443161387335, "vf_explained_var": 0.8823804167183963, "kl": 0.018003727897091516, "entropy": 18.286282246329566, "entropy_coeff": 0.004598604}, "model": {}, "num_grad_updates_lifetime": 26125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1716336, "num_env_steps_trained": 1716336, "num_agent_steps_sampled": 1716336, "num_agent_steps_trained": 1716336}, "sampler_results": {"episode_reward_max": 23.702196151496302, "episode_reward_min": 16.401306088626075, "episode_reward_mean": 20.043944746993688, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.107810811925823, 20.914931709475965, 20.092363061486395, 19.803263037985776, 22.20513481941599, 22.233268419393628, 20.872015907654493, 21.49191035484908, 19.32927357129212, 22.728773369174416, 18.89385477254785, 20.72904260461701, 20.817555925419796, 18.77079888720475, 21.458633981465002, 22.773469427430648, 17.106690372377496, 22.343640782371523, 20.345326724862293, 19.355547406372263, 19.67330388529373, 23.702196151496302, 22.17018469171696, 21.539411795731873, 19.422318336684242, 19.051453710578528, 20.03048489941098, 20.26438411082563, 22.724993160041272, 20.345471259828347, 20.96763073570681, 22.81945220908284, 20.039006523598886, 20.255382055909763, 21.425960568371444, 16.46506255772547, 18.2252909296445, 19.585487286994884, 16.401306088626075, 20.586254297305437, 18.92992501288818, 21.179388386215543, 20.761180095772147, 17.07934755886715, 23.119074613225305, 19.204433421203873, 21.990740561717033, 21.786529811214958, 20.00564884969609, 18.487062568626833, 18.483538033037778, 20.06292747579429, 16.965542678536558, 19.31832226107072, 23.26796915853548, 19.672868311557988, 21.264569589901733, 21.198313335450777, 20.232655038448826, 20.732898603970334, 20.81898080385268, 18.585076687906128, 18.024402900468573, 20.282230990554293, 19.687882539504557, 18.76443826447407, 21.591507844039196, 21.002442774827994, 21.524819231401285, 20.65124435358427, 16.719074567987693, 19.310112984825256, 19.034535589683365, 18.827935635674525, 18.46222371294726, 18.848177201351387, 17.03231371369316, 18.848680163940536, 18.01206350657105, 20.715451232678106, 20.760533698131955, 19.364668114524182, 19.121164935612665, 19.258407042739734, 20.107302844928096, 20.06355675255081, 19.19313308571357, 19.670160484635467, 21.840671576262835, 20.60937692937687, 19.46502056379238, 19.255537953708107, 18.845722977071453, 19.00897712120794, 20.690542864103808, 19.52619806740985, 20.60787639817874, 20.914650766905297, 18.016268476237034, 18.519832778684737], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0856689655078666, "mean_inference_ms": 8.111080744969234, "mean_action_processing_ms": 0.5543463524671361, "mean_env_wait_ms": 23.8571288977767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03530073165893555, "StateBufferConnector_ms": 0.03333115577697754, "ViewRequirementAgentConnector_ms": 0.8644423484802246}}, "episode_reward_max": 23.702196151496302, "episode_reward_min": 16.401306088626075, "episode_reward_mean": 20.043944746993688, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.107810811925823, 20.914931709475965, 20.092363061486395, 19.803263037985776, 22.20513481941599, 22.233268419393628, 20.872015907654493, 21.49191035484908, 19.32927357129212, 22.728773369174416, 18.89385477254785, 20.72904260461701, 20.817555925419796, 18.77079888720475, 21.458633981465002, 22.773469427430648, 17.106690372377496, 22.343640782371523, 20.345326724862293, 19.355547406372263, 19.67330388529373, 23.702196151496302, 22.17018469171696, 21.539411795731873, 19.422318336684242, 19.051453710578528, 20.03048489941098, 20.26438411082563, 22.724993160041272, 20.345471259828347, 20.96763073570681, 22.81945220908284, 20.039006523598886, 20.255382055909763, 21.425960568371444, 16.46506255772547, 18.2252909296445, 19.585487286994884, 16.401306088626075, 20.586254297305437, 18.92992501288818, 21.179388386215543, 20.761180095772147, 17.07934755886715, 23.119074613225305, 19.204433421203873, 21.990740561717033, 21.786529811214958, 20.00564884969609, 18.487062568626833, 18.483538033037778, 20.06292747579429, 16.965542678536558, 19.31832226107072, 23.26796915853548, 19.672868311557988, 21.264569589901733, 21.198313335450777, 20.232655038448826, 20.732898603970334, 20.81898080385268, 18.585076687906128, 18.024402900468573, 20.282230990554293, 19.687882539504557, 18.76443826447407, 21.591507844039196, 21.002442774827994, 21.524819231401285, 20.65124435358427, 16.719074567987693, 19.310112984825256, 19.034535589683365, 18.827935635674525, 18.46222371294726, 18.848177201351387, 17.03231371369316, 18.848680163940536, 18.01206350657105, 20.715451232678106, 20.760533698131955, 19.364668114524182, 19.121164935612665, 19.258407042739734, 20.107302844928096, 20.06355675255081, 19.19313308571357, 19.670160484635467, 21.840671576262835, 20.60937692937687, 19.46502056379238, 19.255537953708107, 18.845722977071453, 19.00897712120794, 20.690542864103808, 19.52619806740985, 20.60787639817874, 20.914650766905297, 18.016268476237034, 18.519832778684737], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0856689655078666, "mean_inference_ms": 8.111080744969234, "mean_action_processing_ms": 0.5543463524671361, "mean_env_wait_ms": 23.8571288977767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03530073165893555, "StateBufferConnector_ms": 0.03333115577697754, "ViewRequirementAgentConnector_ms": 0.8644423484802246}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1716336, "num_agent_steps_trained": 1716336, "num_env_steps_sampled": 1716336, "num_env_steps_trained": 1716336, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.72655452377734, "num_env_steps_trained_throughput_per_sec": 280.72655452377734, "timesteps_total": 1716336, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1716336, "timers": {"training_iteration_time_ms": 55318.116, "sample_time_ms": 41529.227, "load_time_ms": 1782.241, "load_throughput": 8774.349, "learn_time_ms": 11459.643, "learn_throughput": 1364.615, "synch_weights_time_ms": 425.165}, "counters": {"num_env_steps_sampled": 1716336, "num_env_steps_trained": 1716336, "num_agent_steps_sampled": 1716336, "num_agent_steps_trained": 1716336}, "done": false, "episodes_total": 672, "training_iteration": 114, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-15-15", "timestamp": 1749244515, "time_this_iter_s": 55.72502684593201, "time_total_s": 2753.5731930732727, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2753.5731930732727, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 75.48461538461538, "ram_util_percent": 64.15230769230769, "gpu_util_percent0": 0.08753846153846155, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.283664000000001e-05, "total_loss": -0.09392716969744387, "policy_loss": -0.024107615819666535, "vf_loss": 0.013201429471796887, "vf_explained_var": 0.8968962012637746, "kl": 0.01841814671897418, "entropy": 18.307003042047675, "entropy_coeff": 0.004567327999999999}, "model": {}, "num_grad_updates_lifetime": 26675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1731974, "num_env_steps_trained": 1731974, "num_agent_steps_sampled": 1731974, "num_agent_steps_trained": 1731974}, "sampler_results": {"episode_reward_max": 23.702196151496302, "episode_reward_min": 16.401306088626075, "episode_reward_mean": 20.03703503722594, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.458633981465002, 22.773469427430648, 17.106690372377496, 22.343640782371523, 20.345326724862293, 19.355547406372263, 19.67330388529373, 23.702196151496302, 22.17018469171696, 21.539411795731873, 19.422318336684242, 19.051453710578528, 20.03048489941098, 20.26438411082563, 22.724993160041272, 20.345471259828347, 20.96763073570681, 22.81945220908284, 20.039006523598886, 20.255382055909763, 21.425960568371444, 16.46506255772547, 18.2252909296445, 19.585487286994884, 16.401306088626075, 20.586254297305437, 18.92992501288818, 21.179388386215543, 20.761180095772147, 17.07934755886715, 23.119074613225305, 19.204433421203873, 21.990740561717033, 21.786529811214958, 20.00564884969609, 18.487062568626833, 18.483538033037778, 20.06292747579429, 16.965542678536558, 19.31832226107072, 23.26796915853548, 19.672868311557988, 21.264569589901733, 21.198313335450777, 20.232655038448826, 20.732898603970334, 20.81898080385268, 18.585076687906128, 18.024402900468573, 20.282230990554293, 19.687882539504557, 18.76443826447407, 21.591507844039196, 21.002442774827994, 21.524819231401285, 20.65124435358427, 16.719074567987693, 19.310112984825256, 19.034535589683365, 18.827935635674525, 18.46222371294726, 18.848177201351387, 17.03231371369316, 18.848680163940536, 18.01206350657105, 20.715451232678106, 20.760533698131955, 19.364668114524182, 19.121164935612665, 19.258407042739734, 20.107302844928096, 20.06355675255081, 19.19313308571357, 19.670160484635467, 21.840671576262835, 20.60937692937687, 19.46502056379238, 19.255537953708107, 18.845722977071453, 19.00897712120794, 20.690542864103808, 19.52619806740985, 20.60787639817874, 20.914650766905297, 18.016268476237034, 18.519832778684737, 21.703558932230084, 20.329456150442727, 20.40300014924163, 21.63852214561055, 22.422745419186416, 19.62597684531405, 21.656950298224363, 20.874599328216913, 20.60570981395718, 20.425755435799523, 21.502270017961173, 19.115592754504785, 18.793854703982255, 20.20103428099652], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.083448151603111, "mean_inference_ms": 8.110640396675118, "mean_action_processing_ms": 0.5543726316320109, "mean_env_wait_ms": 23.855105217041324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03227663040161133, "StateBufferConnector_ms": 0.032204389572143555, "ViewRequirementAgentConnector_ms": 0.8511006832122803}}, "episode_reward_max": 23.702196151496302, "episode_reward_min": 16.401306088626075, "episode_reward_mean": 20.03703503722594, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.458633981465002, 22.773469427430648, 17.106690372377496, 22.343640782371523, 20.345326724862293, 19.355547406372263, 19.67330388529373, 23.702196151496302, 22.17018469171696, 21.539411795731873, 19.422318336684242, 19.051453710578528, 20.03048489941098, 20.26438411082563, 22.724993160041272, 20.345471259828347, 20.96763073570681, 22.81945220908284, 20.039006523598886, 20.255382055909763, 21.425960568371444, 16.46506255772547, 18.2252909296445, 19.585487286994884, 16.401306088626075, 20.586254297305437, 18.92992501288818, 21.179388386215543, 20.761180095772147, 17.07934755886715, 23.119074613225305, 19.204433421203873, 21.990740561717033, 21.786529811214958, 20.00564884969609, 18.487062568626833, 18.483538033037778, 20.06292747579429, 16.965542678536558, 19.31832226107072, 23.26796915853548, 19.672868311557988, 21.264569589901733, 21.198313335450777, 20.232655038448826, 20.732898603970334, 20.81898080385268, 18.585076687906128, 18.024402900468573, 20.282230990554293, 19.687882539504557, 18.76443826447407, 21.591507844039196, 21.002442774827994, 21.524819231401285, 20.65124435358427, 16.719074567987693, 19.310112984825256, 19.034535589683365, 18.827935635674525, 18.46222371294726, 18.848177201351387, 17.03231371369316, 18.848680163940536, 18.01206350657105, 20.715451232678106, 20.760533698131955, 19.364668114524182, 19.121164935612665, 19.258407042739734, 20.107302844928096, 20.06355675255081, 19.19313308571357, 19.670160484635467, 21.840671576262835, 20.60937692937687, 19.46502056379238, 19.255537953708107, 18.845722977071453, 19.00897712120794, 20.690542864103808, 19.52619806740985, 20.60787639817874, 20.914650766905297, 18.016268476237034, 18.519832778684737, 21.703558932230084, 20.329456150442727, 20.40300014924163, 21.63852214561055, 22.422745419186416, 19.62597684531405, 21.656950298224363, 20.874599328216913, 20.60570981395718, 20.425755435799523, 21.502270017961173, 19.115592754504785, 18.793854703982255, 20.20103428099652], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.083448151603111, "mean_inference_ms": 8.110640396675118, "mean_action_processing_ms": 0.5543726316320109, "mean_env_wait_ms": 23.855105217041324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03227663040161133, "StateBufferConnector_ms": 0.032204389572143555, "ViewRequirementAgentConnector_ms": 0.8511006832122803}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1731974, "num_agent_steps_trained": 1731974, "num_env_steps_sampled": 1731974, "num_env_steps_trained": 1731974, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 285.0057366210759, "num_env_steps_trained_throughput_per_sec": 285.0057366210759, "timesteps_total": 1731974, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1731974, "timers": {"training_iteration_time_ms": 55301.834, "sample_time_ms": 41476.792, "load_time_ms": 1793.148, "load_throughput": 8720.973, "learn_time_ms": 11482.093, "learn_throughput": 1361.947, "synch_weights_time_ms": 427.094}, "counters": {"num_env_steps_sampled": 1731974, "num_env_steps_trained": 1731974, "num_agent_steps_sampled": 1731974, "num_agent_steps_trained": 1731974}, "done": false, "episodes_total": 686, "training_iteration": 115, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-16-10", "timestamp": 1749244570, "time_this_iter_s": 54.87415027618408, "time_total_s": 2808.447343349457, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2808.447343349457, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 76.5640625, "ram_util_percent": 64.540625, "gpu_util_percent0": 0.07718749999999999, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.268025999999999e-05, "total_loss": -0.09183294843416662, "policy_loss": -0.023586585774583828, "vf_loss": 0.014454175630499694, "vf_explained_var": 0.890762968713587, "kl": 0.01895285029668431, "entropy": 18.232202522971413, "entropy_coeff": 0.004536052}, "model": {}, "num_grad_updates_lifetime": 27225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1747612, "num_env_steps_trained": 1747612, "num_agent_steps_sampled": 1747612, "num_agent_steps_trained": 1747612}, "sampler_results": {"episode_reward_max": 23.26796915853548, "episode_reward_min": 16.401306088626075, "episode_reward_mean": 19.915494811649616, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.724993160041272, 20.345471259828347, 20.96763073570681, 22.81945220908284, 20.039006523598886, 20.255382055909763, 21.425960568371444, 16.46506255772547, 18.2252909296445, 19.585487286994884, 16.401306088626075, 20.586254297305437, 18.92992501288818, 21.179388386215543, 20.761180095772147, 17.07934755886715, 23.119074613225305, 19.204433421203873, 21.990740561717033, 21.786529811214958, 20.00564884969609, 18.487062568626833, 18.483538033037778, 20.06292747579429, 16.965542678536558, 19.31832226107072, 23.26796915853548, 19.672868311557988, 21.264569589901733, 21.198313335450777, 20.232655038448826, 20.732898603970334, 20.81898080385268, 18.585076687906128, 18.024402900468573, 20.282230990554293, 19.687882539504557, 18.76443826447407, 21.591507844039196, 21.002442774827994, 21.524819231401285, 20.65124435358427, 16.719074567987693, 19.310112984825256, 19.034535589683365, 18.827935635674525, 18.46222371294726, 18.848177201351387, 17.03231371369316, 18.848680163940536, 18.01206350657105, 20.715451232678106, 20.760533698131955, 19.364668114524182, 19.121164935612665, 19.258407042739734, 20.107302844928096, 20.06355675255081, 19.19313308571357, 19.670160484635467, 21.840671576262835, 20.60937692937687, 19.46502056379238, 19.255537953708107, 18.845722977071453, 19.00897712120794, 20.690542864103808, 19.52619806740985, 20.60787639817874, 20.914650766905297, 18.016268476237034, 18.519832778684737, 21.703558932230084, 20.329456150442727, 20.40300014924163, 21.63852214561055, 22.422745419186416, 19.62597684531405, 21.656950298224363, 20.874599328216913, 20.60570981395718, 20.425755435799523, 21.502270017961173, 19.115592754504785, 18.793854703982255, 20.20103428099652, 19.327422604617443, 22.183628157978532, 19.318081530036615, 20.07049314495354, 20.604462275437818, 16.547979190810803, 21.89298966661648, 21.842192160477328, 19.142474523007504, 18.882555546204603, 20.316523850446107, 18.501063604492877, 20.885312291724883, 17.56784517218096], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.081143187264251, "mean_inference_ms": 8.110283482536898, "mean_action_processing_ms": 0.5544134696016179, "mean_env_wait_ms": 23.853480523908164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03428983688354492, "StateBufferConnector_ms": 0.0336766242980957, "ViewRequirementAgentConnector_ms": 0.8578395843505859}}, "episode_reward_max": 23.26796915853548, "episode_reward_min": 16.401306088626075, "episode_reward_mean": 19.915494811649616, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.724993160041272, 20.345471259828347, 20.96763073570681, 22.81945220908284, 20.039006523598886, 20.255382055909763, 21.425960568371444, 16.46506255772547, 18.2252909296445, 19.585487286994884, 16.401306088626075, 20.586254297305437, 18.92992501288818, 21.179388386215543, 20.761180095772147, 17.07934755886715, 23.119074613225305, 19.204433421203873, 21.990740561717033, 21.786529811214958, 20.00564884969609, 18.487062568626833, 18.483538033037778, 20.06292747579429, 16.965542678536558, 19.31832226107072, 23.26796915853548, 19.672868311557988, 21.264569589901733, 21.198313335450777, 20.232655038448826, 20.732898603970334, 20.81898080385268, 18.585076687906128, 18.024402900468573, 20.282230990554293, 19.687882539504557, 18.76443826447407, 21.591507844039196, 21.002442774827994, 21.524819231401285, 20.65124435358427, 16.719074567987693, 19.310112984825256, 19.034535589683365, 18.827935635674525, 18.46222371294726, 18.848177201351387, 17.03231371369316, 18.848680163940536, 18.01206350657105, 20.715451232678106, 20.760533698131955, 19.364668114524182, 19.121164935612665, 19.258407042739734, 20.107302844928096, 20.06355675255081, 19.19313308571357, 19.670160484635467, 21.840671576262835, 20.60937692937687, 19.46502056379238, 19.255537953708107, 18.845722977071453, 19.00897712120794, 20.690542864103808, 19.52619806740985, 20.60787639817874, 20.914650766905297, 18.016268476237034, 18.519832778684737, 21.703558932230084, 20.329456150442727, 20.40300014924163, 21.63852214561055, 22.422745419186416, 19.62597684531405, 21.656950298224363, 20.874599328216913, 20.60570981395718, 20.425755435799523, 21.502270017961173, 19.115592754504785, 18.793854703982255, 20.20103428099652, 19.327422604617443, 22.183628157978532, 19.318081530036615, 20.07049314495354, 20.604462275437818, 16.547979190810803, 21.89298966661648, 21.842192160477328, 19.142474523007504, 18.882555546204603, 20.316523850446107, 18.501063604492877, 20.885312291724883, 17.56784517218096], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.081143187264251, "mean_inference_ms": 8.110283482536898, "mean_action_processing_ms": 0.5544134696016179, "mean_env_wait_ms": 23.853480523908164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03428983688354492, "StateBufferConnector_ms": 0.0336766242980957, "ViewRequirementAgentConnector_ms": 0.8578395843505859}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1747612, "num_agent_steps_trained": 1747612, "num_env_steps_sampled": 1747612, "num_env_steps_trained": 1747612, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 284.5105366736606, "num_env_steps_trained_throughput_per_sec": 284.5105366736606, "timesteps_total": 1747612, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1747612, "timers": {"training_iteration_time_ms": 55282.953, "sample_time_ms": 41471.034, "load_time_ms": 1782.172, "load_throughput": 8774.684, "learn_time_ms": 11483.442, "learn_throughput": 1361.787, "synch_weights_time_ms": 425.908}, "counters": {"num_env_steps_sampled": 1747612, "num_env_steps_trained": 1747612, "num_agent_steps_sampled": 1747612, "num_agent_steps_trained": 1747612}, "done": false, "episodes_total": 700, "training_iteration": 116, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-17-05", "timestamp": 1749244625, "time_this_iter_s": 54.985573053359985, "time_total_s": 2863.4329164028168, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2863.4329164028168, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 76.64920634920635, "ram_util_percent": 64.29365079365078, "gpu_util_percent0": 0.07809523809523809, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.252387999999999e-05, "total_loss": -0.0827077616988258, "policy_loss": -0.015312870075709228, "vf_loss": 0.016083832793361084, "vf_explained_var": 0.898856029510498, "kl": 0.018299738335298417, "entropy": 18.200887534401634, "entropy_coeff": 0.004504776}, "model": {}, "num_grad_updates_lifetime": 27775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1763250, "num_env_steps_trained": 1763250, "num_agent_steps_sampled": 1763250, "num_agent_steps_trained": 1763250}, "sampler_results": {"episode_reward_max": 23.26796915853548, "episode_reward_min": 16.547979190810803, "episode_reward_mean": 19.846799789726802, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.761180095772147, 17.07934755886715, 23.119074613225305, 19.204433421203873, 21.990740561717033, 21.786529811214958, 20.00564884969609, 18.487062568626833, 18.483538033037778, 20.06292747579429, 16.965542678536558, 19.31832226107072, 23.26796915853548, 19.672868311557988, 21.264569589901733, 21.198313335450777, 20.232655038448826, 20.732898603970334, 20.81898080385268, 18.585076687906128, 18.024402900468573, 20.282230990554293, 19.687882539504557, 18.76443826447407, 21.591507844039196, 21.002442774827994, 21.524819231401285, 20.65124435358427, 16.719074567987693, 19.310112984825256, 19.034535589683365, 18.827935635674525, 18.46222371294726, 18.848177201351387, 17.03231371369316, 18.848680163940536, 18.01206350657105, 20.715451232678106, 20.760533698131955, 19.364668114524182, 19.121164935612665, 19.258407042739734, 20.107302844928096, 20.06355675255081, 19.19313308571357, 19.670160484635467, 21.840671576262835, 20.60937692937687, 19.46502056379238, 19.255537953708107, 18.845722977071453, 19.00897712120794, 20.690542864103808, 19.52619806740985, 20.60787639817874, 20.914650766905297, 18.016268476237034, 18.519832778684737, 21.703558932230084, 20.329456150442727, 20.40300014924163, 21.63852214561055, 22.422745419186416, 19.62597684531405, 21.656950298224363, 20.874599328216913, 20.60570981395718, 20.425755435799523, 21.502270017961173, 19.115592754504785, 18.793854703982255, 20.20103428099652, 19.327422604617443, 22.183628157978532, 19.318081530036615, 20.07049314495354, 20.604462275437818, 16.547979190810803, 21.89298966661648, 21.842192160477328, 19.142474523007504, 18.882555546204603, 20.316523850446107, 18.501063604492877, 20.885312291724883, 17.56784517218096, 23.025959653347282, 19.587319526243267, 18.070531838817615, 20.03515127889643, 20.224928350034553, 20.136750936665177, 17.705378420782353, 17.796829508006454, 19.313119123400828, 17.690676775806246, 20.737227353682396, 19.13074447161347, 21.25781802199998, 18.36867362036173], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.079116979524163, "mean_inference_ms": 8.110130565367177, "mean_action_processing_ms": 0.5544842905640366, "mean_env_wait_ms": 23.852292952011645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03825974464416504, "StateBufferConnector_ms": 0.028523683547973633, "ViewRequirementAgentConnector_ms": 0.8829548358917236}}, "episode_reward_max": 23.26796915853548, "episode_reward_min": 16.547979190810803, "episode_reward_mean": 19.846799789726802, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.761180095772147, 17.07934755886715, 23.119074613225305, 19.204433421203873, 21.990740561717033, 21.786529811214958, 20.00564884969609, 18.487062568626833, 18.483538033037778, 20.06292747579429, 16.965542678536558, 19.31832226107072, 23.26796915853548, 19.672868311557988, 21.264569589901733, 21.198313335450777, 20.232655038448826, 20.732898603970334, 20.81898080385268, 18.585076687906128, 18.024402900468573, 20.282230990554293, 19.687882539504557, 18.76443826447407, 21.591507844039196, 21.002442774827994, 21.524819231401285, 20.65124435358427, 16.719074567987693, 19.310112984825256, 19.034535589683365, 18.827935635674525, 18.46222371294726, 18.848177201351387, 17.03231371369316, 18.848680163940536, 18.01206350657105, 20.715451232678106, 20.760533698131955, 19.364668114524182, 19.121164935612665, 19.258407042739734, 20.107302844928096, 20.06355675255081, 19.19313308571357, 19.670160484635467, 21.840671576262835, 20.60937692937687, 19.46502056379238, 19.255537953708107, 18.845722977071453, 19.00897712120794, 20.690542864103808, 19.52619806740985, 20.60787639817874, 20.914650766905297, 18.016268476237034, 18.519832778684737, 21.703558932230084, 20.329456150442727, 20.40300014924163, 21.63852214561055, 22.422745419186416, 19.62597684531405, 21.656950298224363, 20.874599328216913, 20.60570981395718, 20.425755435799523, 21.502270017961173, 19.115592754504785, 18.793854703982255, 20.20103428099652, 19.327422604617443, 22.183628157978532, 19.318081530036615, 20.07049314495354, 20.604462275437818, 16.547979190810803, 21.89298966661648, 21.842192160477328, 19.142474523007504, 18.882555546204603, 20.316523850446107, 18.501063604492877, 20.885312291724883, 17.56784517218096, 23.025959653347282, 19.587319526243267, 18.070531838817615, 20.03515127889643, 20.224928350034553, 20.136750936665177, 17.705378420782353, 17.796829508006454, 19.313119123400828, 17.690676775806246, 20.737227353682396, 19.13074447161347, 21.25781802199998, 18.36867362036173], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.079116979524163, "mean_inference_ms": 8.110130565367177, "mean_action_processing_ms": 0.5544842905640366, "mean_env_wait_ms": 23.852292952011645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03825974464416504, "StateBufferConnector_ms": 0.028523683547973633, "ViewRequirementAgentConnector_ms": 0.8829548358917236}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1763250, "num_agent_steps_trained": 1763250, "num_env_steps_sampled": 1763250, "num_env_steps_trained": 1763250, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.69379673240314, "num_env_steps_trained_throughput_per_sec": 282.69379673240314, "timesteps_total": 1763250, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1763250, "timers": {"training_iteration_time_ms": 55264.424, "sample_time_ms": 41431.248, "load_time_ms": 1785.447, "load_throughput": 8758.592, "learn_time_ms": 11493.654, "learn_throughput": 1360.577, "synch_weights_time_ms": 436.152}, "counters": {"num_env_steps_sampled": 1763250, "num_env_steps_trained": 1763250, "num_agent_steps_sampled": 1763250, "num_agent_steps_trained": 1763250}, "done": false, "episodes_total": 714, "training_iteration": 117, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-18-01", "timestamp": 1749244681, "time_this_iter_s": 55.33781170845032, "time_total_s": 2918.770728111267, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2918.770728111267, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 76.428125, "ram_util_percent": 64.275, "gpu_util_percent0": 0.07546875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.236750000000001e-05, "total_loss": -0.08866357240571894, "policy_loss": -0.021192353403986834, "vf_loss": 0.015039323170838708, "vf_explained_var": 0.8922243924574419, "kl": 0.01797790021987484, "entropy": 18.236739987460048, "entropy_coeff": 0.0044735}, "model": {}, "num_grad_updates_lifetime": 28325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1778888, "num_env_steps_trained": 1778888, "num_agent_steps_sampled": 1778888, "num_agent_steps_trained": 1778888}, "sampler_results": {"episode_reward_max": 23.315289147101, "episode_reward_min": 16.547979190810803, "episode_reward_mean": 19.904685537157988, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.264569589901733, 21.198313335450777, 20.232655038448826, 20.732898603970334, 20.81898080385268, 18.585076687906128, 18.024402900468573, 20.282230990554293, 19.687882539504557, 18.76443826447407, 21.591507844039196, 21.002442774827994, 21.524819231401285, 20.65124435358427, 16.719074567987693, 19.310112984825256, 19.034535589683365, 18.827935635674525, 18.46222371294726, 18.848177201351387, 17.03231371369316, 18.848680163940536, 18.01206350657105, 20.715451232678106, 20.760533698131955, 19.364668114524182, 19.121164935612665, 19.258407042739734, 20.107302844928096, 20.06355675255081, 19.19313308571357, 19.670160484635467, 21.840671576262835, 20.60937692937687, 19.46502056379238, 19.255537953708107, 18.845722977071453, 19.00897712120794, 20.690542864103808, 19.52619806740985, 20.60787639817874, 20.914650766905297, 18.016268476237034, 18.519832778684737, 21.703558932230084, 20.329456150442727, 20.40300014924163, 21.63852214561055, 22.422745419186416, 19.62597684531405, 21.656950298224363, 20.874599328216913, 20.60570981395718, 20.425755435799523, 21.502270017961173, 19.115592754504785, 18.793854703982255, 20.20103428099652, 19.327422604617443, 22.183628157978532, 19.318081530036615, 20.07049314495354, 20.604462275437818, 16.547979190810803, 21.89298966661648, 21.842192160477328, 19.142474523007504, 18.882555546204603, 20.316523850446107, 18.501063604492877, 20.885312291724883, 17.56784517218096, 23.025959653347282, 19.587319526243267, 18.070531838817615, 20.03515127889643, 20.224928350034553, 20.136750936665177, 17.705378420782353, 17.796829508006454, 19.313119123400828, 17.690676775806246, 20.737227353682396, 19.13074447161347, 21.25781802199998, 18.36867362036173, 21.177954471211358, 21.02001515501652, 21.26982012440026, 19.923759989422738, 19.112307943724876, 20.738764323622075, 19.78831532998281, 19.682514776418, 20.625837100811513, 18.94015244384149, 23.315289147101, 20.37923993065928, 18.968760449308228, 21.051028956454463], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.077990935383257, "mean_inference_ms": 8.10995699345238, "mean_action_processing_ms": 0.55450961808217, "mean_env_wait_ms": 23.85071889034293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0409395694732666, "StateBufferConnector_ms": 0.023402690887451172, "ViewRequirementAgentConnector_ms": 0.9014897346496582}}, "episode_reward_max": 23.315289147101, "episode_reward_min": 16.547979190810803, "episode_reward_mean": 19.904685537157988, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.264569589901733, 21.198313335450777, 20.232655038448826, 20.732898603970334, 20.81898080385268, 18.585076687906128, 18.024402900468573, 20.282230990554293, 19.687882539504557, 18.76443826447407, 21.591507844039196, 21.002442774827994, 21.524819231401285, 20.65124435358427, 16.719074567987693, 19.310112984825256, 19.034535589683365, 18.827935635674525, 18.46222371294726, 18.848177201351387, 17.03231371369316, 18.848680163940536, 18.01206350657105, 20.715451232678106, 20.760533698131955, 19.364668114524182, 19.121164935612665, 19.258407042739734, 20.107302844928096, 20.06355675255081, 19.19313308571357, 19.670160484635467, 21.840671576262835, 20.60937692937687, 19.46502056379238, 19.255537953708107, 18.845722977071453, 19.00897712120794, 20.690542864103808, 19.52619806740985, 20.60787639817874, 20.914650766905297, 18.016268476237034, 18.519832778684737, 21.703558932230084, 20.329456150442727, 20.40300014924163, 21.63852214561055, 22.422745419186416, 19.62597684531405, 21.656950298224363, 20.874599328216913, 20.60570981395718, 20.425755435799523, 21.502270017961173, 19.115592754504785, 18.793854703982255, 20.20103428099652, 19.327422604617443, 22.183628157978532, 19.318081530036615, 20.07049314495354, 20.604462275437818, 16.547979190810803, 21.89298966661648, 21.842192160477328, 19.142474523007504, 18.882555546204603, 20.316523850446107, 18.501063604492877, 20.885312291724883, 17.56784517218096, 23.025959653347282, 19.587319526243267, 18.070531838817615, 20.03515127889643, 20.224928350034553, 20.136750936665177, 17.705378420782353, 17.796829508006454, 19.313119123400828, 17.690676775806246, 20.737227353682396, 19.13074447161347, 21.25781802199998, 18.36867362036173, 21.177954471211358, 21.02001515501652, 21.26982012440026, 19.923759989422738, 19.112307943724876, 20.738764323622075, 19.78831532998281, 19.682514776418, 20.625837100811513, 18.94015244384149, 23.315289147101, 20.37923993065928, 18.968760449308228, 21.051028956454463], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.077990935383257, "mean_inference_ms": 8.10995699345238, "mean_action_processing_ms": 0.55450961808217, "mean_env_wait_ms": 23.85071889034293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0409395694732666, "StateBufferConnector_ms": 0.023402690887451172, "ViewRequirementAgentConnector_ms": 0.9014897346496582}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1778888, "num_agent_steps_trained": 1778888, "num_env_steps_sampled": 1778888, "num_env_steps_trained": 1778888, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.3700297617519, "num_env_steps_trained_throughput_per_sec": 282.3700297617519, "timesteps_total": 1778888, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1778888, "timers": {"training_iteration_time_ms": 55298.86, "sample_time_ms": 41479.146, "load_time_ms": 1786.832, "load_throughput": 8751.8, "learn_time_ms": 11478.637, "learn_throughput": 1362.357, "synch_weights_time_ms": 437.406}, "counters": {"num_env_steps_sampled": 1778888, "num_env_steps_trained": 1778888, "num_agent_steps_sampled": 1778888, "num_agent_steps_trained": 1778888}, "done": false, "episodes_total": 728, "training_iteration": 118, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-18-56", "timestamp": 1749244736, "time_this_iter_s": 55.39709830284119, "time_total_s": 2974.1678264141083, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2974.1678264141083, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 76.265625, "ram_util_percent": 64.478125, "gpu_util_percent0": 0.07734375, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.221111999999997e-05, "total_loss": -0.09082484708633273, "policy_loss": -0.023688909008821857, "vf_loss": 0.014801628466864879, "vf_explained_var": 0.8897883636301214, "kl": 0.017932356677355224, "entropy": 18.268135960318826, "entropy_coeff": 0.004442224000000001}, "model": {}, "num_grad_updates_lifetime": 28875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1794526, "num_env_steps_trained": 1794526, "num_agent_steps_sampled": 1794526, "num_agent_steps_trained": 1794526}, "sampler_results": {"episode_reward_max": 23.315289147101, "episode_reward_min": 16.547979190810803, "episode_reward_mean": 19.927244284001755, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.719074567987693, 19.310112984825256, 19.034535589683365, 18.827935635674525, 18.46222371294726, 18.848177201351387, 17.03231371369316, 18.848680163940536, 18.01206350657105, 20.715451232678106, 20.760533698131955, 19.364668114524182, 19.121164935612665, 19.258407042739734, 20.107302844928096, 20.06355675255081, 19.19313308571357, 19.670160484635467, 21.840671576262835, 20.60937692937687, 19.46502056379238, 19.255537953708107, 18.845722977071453, 19.00897712120794, 20.690542864103808, 19.52619806740985, 20.60787639817874, 20.914650766905297, 18.016268476237034, 18.519832778684737, 21.703558932230084, 20.329456150442727, 20.40300014924163, 21.63852214561055, 22.422745419186416, 19.62597684531405, 21.656950298224363, 20.874599328216913, 20.60570981395718, 20.425755435799523, 21.502270017961173, 19.115592754504785, 18.793854703982255, 20.20103428099652, 19.327422604617443, 22.183628157978532, 19.318081530036615, 20.07049314495354, 20.604462275437818, 16.547979190810803, 21.89298966661648, 21.842192160477328, 19.142474523007504, 18.882555546204603, 20.316523850446107, 18.501063604492877, 20.885312291724883, 17.56784517218096, 23.025959653347282, 19.587319526243267, 18.070531838817615, 20.03515127889643, 20.224928350034553, 20.136750936665177, 17.705378420782353, 17.796829508006454, 19.313119123400828, 17.690676775806246, 20.737227353682396, 19.13074447161347, 21.25781802199998, 18.36867362036173, 21.177954471211358, 21.02001515501652, 21.26982012440026, 19.923759989422738, 19.112307943724876, 20.738764323622075, 19.78831532998281, 19.682514776418, 20.625837100811513, 18.94015244384149, 23.315289147101, 20.37923993065928, 18.968760449308228, 21.051028956454463, 19.28046445752962, 20.12534178548301, 22.99383608325281, 20.41375465802527, 19.318752684110493, 21.076340063951584, 22.746271209566352, 19.75777110342138, 20.66512226231658, 20.92722388210879, 20.84314087064376, 17.29226701438167, 20.56056836104422, 20.616483206925654], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.076863890773795, "mean_inference_ms": 8.110803112480042, "mean_action_processing_ms": 0.5545841748375167, "mean_env_wait_ms": 23.850263548249277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0358431339263916, "StateBufferConnector_ms": 0.025402307510375977, "ViewRequirementAgentConnector_ms": 0.9160928726196289}}, "episode_reward_max": 23.315289147101, "episode_reward_min": 16.547979190810803, "episode_reward_mean": 19.927244284001755, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.719074567987693, 19.310112984825256, 19.034535589683365, 18.827935635674525, 18.46222371294726, 18.848177201351387, 17.03231371369316, 18.848680163940536, 18.01206350657105, 20.715451232678106, 20.760533698131955, 19.364668114524182, 19.121164935612665, 19.258407042739734, 20.107302844928096, 20.06355675255081, 19.19313308571357, 19.670160484635467, 21.840671576262835, 20.60937692937687, 19.46502056379238, 19.255537953708107, 18.845722977071453, 19.00897712120794, 20.690542864103808, 19.52619806740985, 20.60787639817874, 20.914650766905297, 18.016268476237034, 18.519832778684737, 21.703558932230084, 20.329456150442727, 20.40300014924163, 21.63852214561055, 22.422745419186416, 19.62597684531405, 21.656950298224363, 20.874599328216913, 20.60570981395718, 20.425755435799523, 21.502270017961173, 19.115592754504785, 18.793854703982255, 20.20103428099652, 19.327422604617443, 22.183628157978532, 19.318081530036615, 20.07049314495354, 20.604462275437818, 16.547979190810803, 21.89298966661648, 21.842192160477328, 19.142474523007504, 18.882555546204603, 20.316523850446107, 18.501063604492877, 20.885312291724883, 17.56784517218096, 23.025959653347282, 19.587319526243267, 18.070531838817615, 20.03515127889643, 20.224928350034553, 20.136750936665177, 17.705378420782353, 17.796829508006454, 19.313119123400828, 17.690676775806246, 20.737227353682396, 19.13074447161347, 21.25781802199998, 18.36867362036173, 21.177954471211358, 21.02001515501652, 21.26982012440026, 19.923759989422738, 19.112307943724876, 20.738764323622075, 19.78831532998281, 19.682514776418, 20.625837100811513, 18.94015244384149, 23.315289147101, 20.37923993065928, 18.968760449308228, 21.051028956454463, 19.28046445752962, 20.12534178548301, 22.99383608325281, 20.41375465802527, 19.318752684110493, 21.076340063951584, 22.746271209566352, 19.75777110342138, 20.66512226231658, 20.92722388210879, 20.84314087064376, 17.29226701438167, 20.56056836104422, 20.616483206925654], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.076863890773795, "mean_inference_ms": 8.110803112480042, "mean_action_processing_ms": 0.5545841748375167, "mean_env_wait_ms": 23.850263548249277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0358431339263916, "StateBufferConnector_ms": 0.025402307510375977, "ViewRequirementAgentConnector_ms": 0.9160928726196289}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1794526, "num_agent_steps_trained": 1794526, "num_env_steps_sampled": 1794526, "num_env_steps_trained": 1794526, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.29211936073466, "num_env_steps_trained_throughput_per_sec": 280.29211936073466, "timesteps_total": 1794526, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1794526, "timers": {"training_iteration_time_ms": 55349.965, "sample_time_ms": 41566.825, "load_time_ms": 1764.732, "load_throughput": 8861.405, "learn_time_ms": 11461.228, "learn_throughput": 1364.426, "synch_weights_time_ms": 438.741}, "counters": {"num_env_steps_sampled": 1794526, "num_env_steps_trained": 1794526, "num_agent_steps_sampled": 1794526, "num_agent_steps_trained": 1794526}, "done": false, "episodes_total": 742, "training_iteration": 119, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-19-52", "timestamp": 1749244792, "time_this_iter_s": 55.80979323387146, "time_total_s": 3029.9776196479797, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3029.9776196479797, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 76.6234375, "ram_util_percent": 64.3953125, "gpu_util_percent0": 0.08031250000000001, "vram_util_percent0": 0.8592122395833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": 1.285901316840866, "episode_reward_min": -2.0645034394866943, "episode_reward_mean": -0.8023520217177215, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4984255179588894, -1.9452656285934133, -2.0645034394866943, -0.7894668393904761, 1.285901316840866], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6297049937829484, "mean_inference_ms": 3.7740390600015497, "mean_action_processing_ms": 0.2907266912199496, "mean_env_wait_ms": 11.675759602059404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.04008293151855469, "ViewRequirementAgentConnector_ms": 0.5256557464599609}}, "episode_reward_max": 1.285901316840866, "episode_reward_min": -2.0645034394866943, "episode_reward_mean": -0.8023520217177215, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.4984255179588894, -1.9452656285934133, -2.0645034394866943, -0.7894668393904761, 1.285901316840866], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6297049937829484, "mean_inference_ms": 3.7740390600015497, "mean_action_processing_ms": 0.2907266912199496, "mean_env_wait_ms": 11.675759602059404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.04008293151855469, "ViewRequirementAgentConnector_ms": 0.5256557464599609}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.205474000000002e-05, "total_loss": -0.08416010118089616, "policy_loss": -0.017371241486398504, "vf_loss": 0.014805506175722589, "vf_explained_var": 0.8827070849592036, "kl": 0.017592384328017942, "entropy": 18.278090907010164, "entropy_coeff": 0.004410948}, "model": {}, "num_grad_updates_lifetime": 29425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1810164, "num_env_steps_trained": 1810164, "num_agent_steps_sampled": 1810164, "num_agent_steps_trained": 1810164}, "sampler_results": {"episode_reward_max": 23.315289147101, "episode_reward_min": 16.547979190810803, "episode_reward_mean": 20.023039211220283, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.107302844928096, 20.06355675255081, 19.19313308571357, 19.670160484635467, 21.840671576262835, 20.60937692937687, 19.46502056379238, 19.255537953708107, 18.845722977071453, 19.00897712120794, 20.690542864103808, 19.52619806740985, 20.60787639817874, 20.914650766905297, 18.016268476237034, 18.519832778684737, 21.703558932230084, 20.329456150442727, 20.40300014924163, 21.63852214561055, 22.422745419186416, 19.62597684531405, 21.656950298224363, 20.874599328216913, 20.60570981395718, 20.425755435799523, 21.502270017961173, 19.115592754504785, 18.793854703982255, 20.20103428099652, 19.327422604617443, 22.183628157978532, 19.318081530036615, 20.07049314495354, 20.604462275437818, 16.547979190810803, 21.89298966661648, 21.842192160477328, 19.142474523007504, 18.882555546204603, 20.316523850446107, 18.501063604492877, 20.885312291724883, 17.56784517218096, 23.025959653347282, 19.587319526243267, 18.070531838817615, 20.03515127889643, 20.224928350034553, 20.136750936665177, 17.705378420782353, 17.796829508006454, 19.313119123400828, 17.690676775806246, 20.737227353682396, 19.13074447161347, 21.25781802199998, 18.36867362036173, 21.177954471211358, 21.02001515501652, 21.26982012440026, 19.923759989422738, 19.112307943724876, 20.738764323622075, 19.78831532998281, 19.682514776418, 20.625837100811513, 18.94015244384149, 23.315289147101, 20.37923993065928, 18.968760449308228, 21.051028956454463, 19.28046445752962, 20.12534178548301, 22.99383608325281, 20.41375465802527, 19.318752684110493, 21.076340063951584, 22.746271209566352, 19.75777110342138, 20.66512226231658, 20.92722388210879, 20.84314087064376, 17.29226701438167, 20.56056836104422, 20.616483206925654, 19.044515630726806, 19.764299411433996, 18.34994448739045, 18.530395065925255, 19.751945915475, 19.37264910885252, 20.555498397080676, 20.1976655558037, 18.962429220540493, 18.743528500124057, 17.27194044716122, 19.620545552685957, 21.646277524504594, 22.083200004509326], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.076039610058095, "mean_inference_ms": 8.111604520452476, "mean_action_processing_ms": 0.554649973447765, "mean_env_wait_ms": 23.84998916691779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03240180015563965, "StateBufferConnector_ms": 0.02249765396118164, "ViewRequirementAgentConnector_ms": 0.9008004665374756}}, "episode_reward_max": 23.315289147101, "episode_reward_min": 16.547979190810803, "episode_reward_mean": 20.023039211220283, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.107302844928096, 20.06355675255081, 19.19313308571357, 19.670160484635467, 21.840671576262835, 20.60937692937687, 19.46502056379238, 19.255537953708107, 18.845722977071453, 19.00897712120794, 20.690542864103808, 19.52619806740985, 20.60787639817874, 20.914650766905297, 18.016268476237034, 18.519832778684737, 21.703558932230084, 20.329456150442727, 20.40300014924163, 21.63852214561055, 22.422745419186416, 19.62597684531405, 21.656950298224363, 20.874599328216913, 20.60570981395718, 20.425755435799523, 21.502270017961173, 19.115592754504785, 18.793854703982255, 20.20103428099652, 19.327422604617443, 22.183628157978532, 19.318081530036615, 20.07049314495354, 20.604462275437818, 16.547979190810803, 21.89298966661648, 21.842192160477328, 19.142474523007504, 18.882555546204603, 20.316523850446107, 18.501063604492877, 20.885312291724883, 17.56784517218096, 23.025959653347282, 19.587319526243267, 18.070531838817615, 20.03515127889643, 20.224928350034553, 20.136750936665177, 17.705378420782353, 17.796829508006454, 19.313119123400828, 17.690676775806246, 20.737227353682396, 19.13074447161347, 21.25781802199998, 18.36867362036173, 21.177954471211358, 21.02001515501652, 21.26982012440026, 19.923759989422738, 19.112307943724876, 20.738764323622075, 19.78831532998281, 19.682514776418, 20.625837100811513, 18.94015244384149, 23.315289147101, 20.37923993065928, 18.968760449308228, 21.051028956454463, 19.28046445752962, 20.12534178548301, 22.99383608325281, 20.41375465802527, 19.318752684110493, 21.076340063951584, 22.746271209566352, 19.75777110342138, 20.66512226231658, 20.92722388210879, 20.84314087064376, 17.29226701438167, 20.56056836104422, 20.616483206925654, 19.044515630726806, 19.764299411433996, 18.34994448739045, 18.530395065925255, 19.751945915475, 19.37264910885252, 20.555498397080676, 20.1976655558037, 18.962429220540493, 18.743528500124057, 17.27194044716122, 19.620545552685957, 21.646277524504594, 22.083200004509326], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.076039610058095, "mean_inference_ms": 8.111604520452476, "mean_action_processing_ms": 0.554649973447765, "mean_env_wait_ms": 23.84998916691779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03240180015563965, "StateBufferConnector_ms": 0.02249765396118164, "ViewRequirementAgentConnector_ms": 0.9008004665374756}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1810164, "num_agent_steps_trained": 1810164, "num_env_steps_sampled": 1810164, "num_env_steps_trained": 1810164, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.458302048758, "num_env_steps_trained_throughput_per_sec": 281.458302048758, "timesteps_total": 1810164, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1810164, "timers": {"training_iteration_time_ms": 55340.167, "sample_time_ms": 41598.597, "load_time_ms": 1765.928, "load_throughput": 8855.402, "learn_time_ms": 11417.783, "learn_throughput": 1369.618, "synch_weights_time_ms": 438.39}, "counters": {"num_env_steps_sampled": 1810164, "num_env_steps_trained": 1810164, "num_agent_steps_sampled": 1810164, "num_agent_steps_trained": 1810164}, "done": false, "episodes_total": 756, "training_iteration": 120, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-21-04", "timestamp": 1749244864, "time_this_iter_s": 71.83462142944336, "time_total_s": 3101.812241077423, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3101.812241077423, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 62.709411764705884, "ram_util_percent": 63.85411764705881, "gpu_util_percent0": 0.0616470588235294, "vram_util_percent0": 0.8592122395833329}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.189836000000002e-05, "total_loss": -0.0896080146861178, "policy_loss": -0.023718030738818924, "vf_loss": 0.014048016731288623, "vf_explained_var": 0.8583200049400329, "kl": 0.018332673548405485, "entropy": 18.24174395301125, "entropy_coeff": 0.004379672}, "model": {}, "num_grad_updates_lifetime": 29975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1825802, "num_env_steps_trained": 1825802, "num_agent_steps_sampled": 1825802, "num_agent_steps_trained": 1825802}, "sampler_results": {"episode_reward_max": 23.315289147101, "episode_reward_min": 15.520819173544496, "episode_reward_mean": 19.853051513918004, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.016268476237034, 18.519832778684737, 21.703558932230084, 20.329456150442727, 20.40300014924163, 21.63852214561055, 22.422745419186416, 19.62597684531405, 21.656950298224363, 20.874599328216913, 20.60570981395718, 20.425755435799523, 21.502270017961173, 19.115592754504785, 18.793854703982255, 20.20103428099652, 19.327422604617443, 22.183628157978532, 19.318081530036615, 20.07049314495354, 20.604462275437818, 16.547979190810803, 21.89298966661648, 21.842192160477328, 19.142474523007504, 18.882555546204603, 20.316523850446107, 18.501063604492877, 20.885312291724883, 17.56784517218096, 23.025959653347282, 19.587319526243267, 18.070531838817615, 20.03515127889643, 20.224928350034553, 20.136750936665177, 17.705378420782353, 17.796829508006454, 19.313119123400828, 17.690676775806246, 20.737227353682396, 19.13074447161347, 21.25781802199998, 18.36867362036173, 21.177954471211358, 21.02001515501652, 21.26982012440026, 19.923759989422738, 19.112307943724876, 20.738764323622075, 19.78831532998281, 19.682514776418, 20.625837100811513, 18.94015244384149, 23.315289147101, 20.37923993065928, 18.968760449308228, 21.051028956454463, 19.28046445752962, 20.12534178548301, 22.99383608325281, 20.41375465802527, 19.318752684110493, 21.076340063951584, 22.746271209566352, 19.75777110342138, 20.66512226231658, 20.92722388210879, 20.84314087064376, 17.29226701438167, 20.56056836104422, 20.616483206925654, 19.044515630726806, 19.764299411433996, 18.34994448739045, 18.530395065925255, 19.751945915475, 19.37264910885252, 20.555498397080676, 20.1976655558037, 18.962429220540493, 18.743528500124057, 17.27194044716122, 19.620545552685957, 21.646277524504594, 22.083200004509326, 18.287114860224175, 15.520819173544496, 20.07448014105135, 18.515084242195492, 19.821053479731187, 17.61166067825923, 16.242674726995322, 17.627242925014208, 21.50511846381994, 21.52156609136213, 18.02286644991969, 18.144803044768693, 18.100627057529532, 21.80484732120188], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.075495963693236, "mean_inference_ms": 8.113041467651112, "mean_action_processing_ms": 0.5547242088824642, "mean_env_wait_ms": 23.850333164908626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030415058135986328, "StateBufferConnector_ms": 0.025466442108154297, "ViewRequirementAgentConnector_ms": 0.89601731300354}}, "episode_reward_max": 23.315289147101, "episode_reward_min": 15.520819173544496, "episode_reward_mean": 19.853051513918004, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.016268476237034, 18.519832778684737, 21.703558932230084, 20.329456150442727, 20.40300014924163, 21.63852214561055, 22.422745419186416, 19.62597684531405, 21.656950298224363, 20.874599328216913, 20.60570981395718, 20.425755435799523, 21.502270017961173, 19.115592754504785, 18.793854703982255, 20.20103428099652, 19.327422604617443, 22.183628157978532, 19.318081530036615, 20.07049314495354, 20.604462275437818, 16.547979190810803, 21.89298966661648, 21.842192160477328, 19.142474523007504, 18.882555546204603, 20.316523850446107, 18.501063604492877, 20.885312291724883, 17.56784517218096, 23.025959653347282, 19.587319526243267, 18.070531838817615, 20.03515127889643, 20.224928350034553, 20.136750936665177, 17.705378420782353, 17.796829508006454, 19.313119123400828, 17.690676775806246, 20.737227353682396, 19.13074447161347, 21.25781802199998, 18.36867362036173, 21.177954471211358, 21.02001515501652, 21.26982012440026, 19.923759989422738, 19.112307943724876, 20.738764323622075, 19.78831532998281, 19.682514776418, 20.625837100811513, 18.94015244384149, 23.315289147101, 20.37923993065928, 18.968760449308228, 21.051028956454463, 19.28046445752962, 20.12534178548301, 22.99383608325281, 20.41375465802527, 19.318752684110493, 21.076340063951584, 22.746271209566352, 19.75777110342138, 20.66512226231658, 20.92722388210879, 20.84314087064376, 17.29226701438167, 20.56056836104422, 20.616483206925654, 19.044515630726806, 19.764299411433996, 18.34994448739045, 18.530395065925255, 19.751945915475, 19.37264910885252, 20.555498397080676, 20.1976655558037, 18.962429220540493, 18.743528500124057, 17.27194044716122, 19.620545552685957, 21.646277524504594, 22.083200004509326, 18.287114860224175, 15.520819173544496, 20.07448014105135, 18.515084242195492, 19.821053479731187, 17.61166067825923, 16.242674726995322, 17.627242925014208, 21.50511846381994, 21.52156609136213, 18.02286644991969, 18.144803044768693, 18.100627057529532, 21.80484732120188], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.075495963693236, "mean_inference_ms": 8.113041467651112, "mean_action_processing_ms": 0.5547242088824642, "mean_env_wait_ms": 23.850333164908626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030415058135986328, "StateBufferConnector_ms": 0.025466442108154297, "ViewRequirementAgentConnector_ms": 0.89601731300354}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1825802, "num_agent_steps_trained": 1825802, "num_env_steps_sampled": 1825802, "num_env_steps_trained": 1825802, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.293135090285, "num_env_steps_trained_throughput_per_sec": 280.293135090285, "timesteps_total": 1825802, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1825802, "timers": {"training_iteration_time_ms": 55407.272, "sample_time_ms": 41640.292, "load_time_ms": 1778.845, "load_throughput": 8791.099, "learn_time_ms": 11432.424, "learn_throughput": 1367.864, "synch_weights_time_ms": 436.987}, "counters": {"num_env_steps_sampled": 1825802, "num_env_steps_trained": 1825802, "num_agent_steps_sampled": 1825802, "num_agent_steps_trained": 1825802}, "done": false, "episodes_total": 770, "training_iteration": 121, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-22-00", "timestamp": 1749244920, "time_this_iter_s": 55.8415904045105, "time_total_s": 3157.6538314819336, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3157.6538314819336, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 76.46, "ram_util_percent": 64.5446153846154, "gpu_util_percent0": 0.07984615384615384, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.174197999999999e-05, "total_loss": -0.08841257086362352, "policy_loss": -0.023345203503691167, "vf_loss": 0.014400802866386418, "vf_explained_var": 0.8804748085412112, "kl": 0.018277935596682473, "entropy": 18.201389734094793, "entropy_coeff": 0.004348395999999999}, "model": {}, "num_grad_updates_lifetime": 30525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1841440, "num_env_steps_trained": 1841440, "num_agent_steps_sampled": 1841440, "num_agent_steps_trained": 1841440}, "sampler_results": {"episode_reward_max": 23.315289147101, "episode_reward_min": 15.520819173544496, "episode_reward_mean": 19.73521025262662, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.793854703982255, 20.20103428099652, 19.327422604617443, 22.183628157978532, 19.318081530036615, 20.07049314495354, 20.604462275437818, 16.547979190810803, 21.89298966661648, 21.842192160477328, 19.142474523007504, 18.882555546204603, 20.316523850446107, 18.501063604492877, 20.885312291724883, 17.56784517218096, 23.025959653347282, 19.587319526243267, 18.070531838817615, 20.03515127889643, 20.224928350034553, 20.136750936665177, 17.705378420782353, 17.796829508006454, 19.313119123400828, 17.690676775806246, 20.737227353682396, 19.13074447161347, 21.25781802199998, 18.36867362036173, 21.177954471211358, 21.02001515501652, 21.26982012440026, 19.923759989422738, 19.112307943724876, 20.738764323622075, 19.78831532998281, 19.682514776418, 20.625837100811513, 18.94015244384149, 23.315289147101, 20.37923993065928, 18.968760449308228, 21.051028956454463, 19.28046445752962, 20.12534178548301, 22.99383608325281, 20.41375465802527, 19.318752684110493, 21.076340063951584, 22.746271209566352, 19.75777110342138, 20.66512226231658, 20.92722388210879, 20.84314087064376, 17.29226701438167, 20.56056836104422, 20.616483206925654, 19.044515630726806, 19.764299411433996, 18.34994448739045, 18.530395065925255, 19.751945915475, 19.37264910885252, 20.555498397080676, 20.1976655558037, 18.962429220540493, 18.743528500124057, 17.27194044716122, 19.620545552685957, 21.646277524504594, 22.083200004509326, 18.287114860224175, 15.520819173544496, 20.07448014105135, 18.515084242195492, 19.821053479731187, 17.61166067825923, 16.242674726995322, 17.627242925014208, 21.50511846381994, 21.52156609136213, 18.02286644991969, 18.144803044768693, 18.100627057529532, 21.80484732120188, 20.555585876268132, 19.07996013017871, 18.238168884377384, 17.031786591085847, 20.883512532533256, 19.265358485383576, 20.254367035939957, 21.677526540784832, 18.119153691858127, 22.095543618689632, 18.895542748983594, 20.9139728285529, 18.053210631213176, 19.99242282062356], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0758095827234677, "mean_inference_ms": 8.114717021183246, "mean_action_processing_ms": 0.5548536708083678, "mean_env_wait_ms": 23.85055659706169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03640246391296387, "StateBufferConnector_ms": 0.02547001838684082, "ViewRequirementAgentConnector_ms": 0.8996307849884033}}, "episode_reward_max": 23.315289147101, "episode_reward_min": 15.520819173544496, "episode_reward_mean": 19.73521025262662, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.793854703982255, 20.20103428099652, 19.327422604617443, 22.183628157978532, 19.318081530036615, 20.07049314495354, 20.604462275437818, 16.547979190810803, 21.89298966661648, 21.842192160477328, 19.142474523007504, 18.882555546204603, 20.316523850446107, 18.501063604492877, 20.885312291724883, 17.56784517218096, 23.025959653347282, 19.587319526243267, 18.070531838817615, 20.03515127889643, 20.224928350034553, 20.136750936665177, 17.705378420782353, 17.796829508006454, 19.313119123400828, 17.690676775806246, 20.737227353682396, 19.13074447161347, 21.25781802199998, 18.36867362036173, 21.177954471211358, 21.02001515501652, 21.26982012440026, 19.923759989422738, 19.112307943724876, 20.738764323622075, 19.78831532998281, 19.682514776418, 20.625837100811513, 18.94015244384149, 23.315289147101, 20.37923993065928, 18.968760449308228, 21.051028956454463, 19.28046445752962, 20.12534178548301, 22.99383608325281, 20.41375465802527, 19.318752684110493, 21.076340063951584, 22.746271209566352, 19.75777110342138, 20.66512226231658, 20.92722388210879, 20.84314087064376, 17.29226701438167, 20.56056836104422, 20.616483206925654, 19.044515630726806, 19.764299411433996, 18.34994448739045, 18.530395065925255, 19.751945915475, 19.37264910885252, 20.555498397080676, 20.1976655558037, 18.962429220540493, 18.743528500124057, 17.27194044716122, 19.620545552685957, 21.646277524504594, 22.083200004509326, 18.287114860224175, 15.520819173544496, 20.07448014105135, 18.515084242195492, 19.821053479731187, 17.61166067825923, 16.242674726995322, 17.627242925014208, 21.50511846381994, 21.52156609136213, 18.02286644991969, 18.144803044768693, 18.100627057529532, 21.80484732120188, 20.555585876268132, 19.07996013017871, 18.238168884377384, 17.031786591085847, 20.883512532533256, 19.265358485383576, 20.254367035939957, 21.677526540784832, 18.119153691858127, 22.095543618689632, 18.895542748983594, 20.9139728285529, 18.053210631213176, 19.99242282062356], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0758095827234677, "mean_inference_ms": 8.114717021183246, "mean_action_processing_ms": 0.5548536708083678, "mean_env_wait_ms": 23.85055659706169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03640246391296387, "StateBufferConnector_ms": 0.02547001838684082, "ViewRequirementAgentConnector_ms": 0.8996307849884033}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1841440, "num_agent_steps_trained": 1841440, "num_env_steps_sampled": 1841440, "num_env_steps_trained": 1841440, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.06974978638743, "num_env_steps_trained_throughput_per_sec": 283.06974978638743, "timesteps_total": 1841440, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1841440, "timers": {"training_iteration_time_ms": 55411.902, "sample_time_ms": 41677.29, "load_time_ms": 1750.2, "load_throughput": 8934.981, "learn_time_ms": 11432.248, "learn_throughput": 1367.885, "synch_weights_time_ms": 434.377}, "counters": {"num_env_steps_sampled": 1841440, "num_env_steps_trained": 1841440, "num_agent_steps_sampled": 1841440, "num_agent_steps_trained": 1841440}, "done": false, "episodes_total": 784, "training_iteration": 122, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-22-55", "timestamp": 1749244975, "time_this_iter_s": 55.40179967880249, "time_total_s": 3213.055631160736, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3213.055631160736, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 76.67777777777779, "ram_util_percent": 64.43968253968255, "gpu_util_percent0": 0.0784126984126984, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.15856e-05, "total_loss": -0.09245252044617452, "policy_loss": -0.02754912719479762, "vf_loss": 0.014087341966700147, "vf_explained_var": 0.8710119692845778, "kl": 0.018157893892125663, "entropy": 18.258639314824883, "entropy_coeff": 0.00431712}, "model": {}, "num_grad_updates_lifetime": 31075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1857078, "num_env_steps_trained": 1857078, "num_agent_steps_sampled": 1857078, "num_agent_steps_trained": 1857078}, "sampler_results": {"episode_reward_max": 23.315289147101, "episode_reward_min": 15.520819173544496, "episode_reward_mean": 19.688165470054766, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.885312291724883, 17.56784517218096, 23.025959653347282, 19.587319526243267, 18.070531838817615, 20.03515127889643, 20.224928350034553, 20.136750936665177, 17.705378420782353, 17.796829508006454, 19.313119123400828, 17.690676775806246, 20.737227353682396, 19.13074447161347, 21.25781802199998, 18.36867362036173, 21.177954471211358, 21.02001515501652, 21.26982012440026, 19.923759989422738, 19.112307943724876, 20.738764323622075, 19.78831532998281, 19.682514776418, 20.625837100811513, 18.94015244384149, 23.315289147101, 20.37923993065928, 18.968760449308228, 21.051028956454463, 19.28046445752962, 20.12534178548301, 22.99383608325281, 20.41375465802527, 19.318752684110493, 21.076340063951584, 22.746271209566352, 19.75777110342138, 20.66512226231658, 20.92722388210879, 20.84314087064376, 17.29226701438167, 20.56056836104422, 20.616483206925654, 19.044515630726806, 19.764299411433996, 18.34994448739045, 18.530395065925255, 19.751945915475, 19.37264910885252, 20.555498397080676, 20.1976655558037, 18.962429220540493, 18.743528500124057, 17.27194044716122, 19.620545552685957, 21.646277524504594, 22.083200004509326, 18.287114860224175, 15.520819173544496, 20.07448014105135, 18.515084242195492, 19.821053479731187, 17.61166067825923, 16.242674726995322, 17.627242925014208, 21.50511846381994, 21.52156609136213, 18.02286644991969, 18.144803044768693, 18.100627057529532, 21.80484732120188, 20.555585876268132, 19.07996013017871, 18.238168884377384, 17.031786591085847, 20.883512532533256, 19.265358485383576, 20.254367035939957, 21.677526540784832, 18.119153691858127, 22.095543618689632, 18.895542748983594, 20.9139728285529, 18.053210631213176, 19.99242282062356, 17.98966737826062, 17.18549474620994, 20.211879118679587, 20.671415821335998, 20.66498606104103, 21.30655428284756, 21.689141072563892, 18.583842593068507, 19.841313233004964, 21.218817142388545, 18.380139278561767, 18.31858274738084, 19.11675985687575, 17.74168365065434], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0761219761448855, "mean_inference_ms": 8.116658103766555, "mean_action_processing_ms": 0.5549742338575295, "mean_env_wait_ms": 23.851704498262244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03934907913208008, "StateBufferConnector_ms": 0.021978139877319336, "ViewRequirementAgentConnector_ms": 0.9258496761322021}}, "episode_reward_max": 23.315289147101, "episode_reward_min": 15.520819173544496, "episode_reward_mean": 19.688165470054766, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.885312291724883, 17.56784517218096, 23.025959653347282, 19.587319526243267, 18.070531838817615, 20.03515127889643, 20.224928350034553, 20.136750936665177, 17.705378420782353, 17.796829508006454, 19.313119123400828, 17.690676775806246, 20.737227353682396, 19.13074447161347, 21.25781802199998, 18.36867362036173, 21.177954471211358, 21.02001515501652, 21.26982012440026, 19.923759989422738, 19.112307943724876, 20.738764323622075, 19.78831532998281, 19.682514776418, 20.625837100811513, 18.94015244384149, 23.315289147101, 20.37923993065928, 18.968760449308228, 21.051028956454463, 19.28046445752962, 20.12534178548301, 22.99383608325281, 20.41375465802527, 19.318752684110493, 21.076340063951584, 22.746271209566352, 19.75777110342138, 20.66512226231658, 20.92722388210879, 20.84314087064376, 17.29226701438167, 20.56056836104422, 20.616483206925654, 19.044515630726806, 19.764299411433996, 18.34994448739045, 18.530395065925255, 19.751945915475, 19.37264910885252, 20.555498397080676, 20.1976655558037, 18.962429220540493, 18.743528500124057, 17.27194044716122, 19.620545552685957, 21.646277524504594, 22.083200004509326, 18.287114860224175, 15.520819173544496, 20.07448014105135, 18.515084242195492, 19.821053479731187, 17.61166067825923, 16.242674726995322, 17.627242925014208, 21.50511846381994, 21.52156609136213, 18.02286644991969, 18.144803044768693, 18.100627057529532, 21.80484732120188, 20.555585876268132, 19.07996013017871, 18.238168884377384, 17.031786591085847, 20.883512532533256, 19.265358485383576, 20.254367035939957, 21.677526540784832, 18.119153691858127, 22.095543618689632, 18.895542748983594, 20.9139728285529, 18.053210631213176, 19.99242282062356, 17.98966737826062, 17.18549474620994, 20.211879118679587, 20.671415821335998, 20.66498606104103, 21.30655428284756, 21.689141072563892, 18.583842593068507, 19.841313233004964, 21.218817142388545, 18.380139278561767, 18.31858274738084, 19.11675985687575, 17.74168365065434], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0761219761448855, "mean_inference_ms": 8.116658103766555, "mean_action_processing_ms": 0.5549742338575295, "mean_env_wait_ms": 23.851704498262244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03934907913208008, "StateBufferConnector_ms": 0.021978139877319336, "ViewRequirementAgentConnector_ms": 0.9258496761322021}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1857078, "num_agent_steps_trained": 1857078, "num_env_steps_sampled": 1857078, "num_env_steps_trained": 1857078, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.5136902734144, "num_env_steps_trained_throughput_per_sec": 280.5136902734144, "timesteps_total": 1857078, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1857078, "timers": {"training_iteration_time_ms": 55437.42, "sample_time_ms": 41695.583, "load_time_ms": 1772.466, "load_throughput": 8822.739, "learn_time_ms": 11413.659, "learn_throughput": 1370.113, "synch_weights_time_ms": 437.992}, "counters": {"num_env_steps_sampled": 1857078, "num_env_steps_trained": 1857078, "num_agent_steps_sampled": 1857078, "num_agent_steps_trained": 1857078}, "done": false, "episodes_total": 798, "training_iteration": 123, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-23-51", "timestamp": 1749245031, "time_this_iter_s": 55.76381754875183, "time_total_s": 3268.819448709488, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3268.819448709488, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 76.89687500000001, "ram_util_percent": 64.59375, "gpu_util_percent0": 0.0834375, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.142922000000002e-05, "total_loss": -0.0918957467796281, "policy_loss": -0.02676760896384208, "vf_loss": 0.014040582628328014, "vf_explained_var": 0.8802784254334189, "kl": 0.016762375093940962, "entropy": 18.267193173495205, "entropy_coeff": 0.0042858440000000005}, "model": {}, "num_grad_updates_lifetime": 31625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1872716, "num_env_steps_trained": 1872716, "num_agent_steps_sampled": 1872716, "num_agent_steps_trained": 1872716}, "sampler_results": {"episode_reward_max": 23.315289147101, "episode_reward_min": 15.520819173544496, "episode_reward_mean": 19.673423532539037, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.25781802199998, 18.36867362036173, 21.177954471211358, 21.02001515501652, 21.26982012440026, 19.923759989422738, 19.112307943724876, 20.738764323622075, 19.78831532998281, 19.682514776418, 20.625837100811513, 18.94015244384149, 23.315289147101, 20.37923993065928, 18.968760449308228, 21.051028956454463, 19.28046445752962, 20.12534178548301, 22.99383608325281, 20.41375465802527, 19.318752684110493, 21.076340063951584, 22.746271209566352, 19.75777110342138, 20.66512226231658, 20.92722388210879, 20.84314087064376, 17.29226701438167, 20.56056836104422, 20.616483206925654, 19.044515630726806, 19.764299411433996, 18.34994448739045, 18.530395065925255, 19.751945915475, 19.37264910885252, 20.555498397080676, 20.1976655558037, 18.962429220540493, 18.743528500124057, 17.27194044716122, 19.620545552685957, 21.646277524504594, 22.083200004509326, 18.287114860224175, 15.520819173544496, 20.07448014105135, 18.515084242195492, 19.821053479731187, 17.61166067825923, 16.242674726995322, 17.627242925014208, 21.50511846381994, 21.52156609136213, 18.02286644991969, 18.144803044768693, 18.100627057529532, 21.80484732120188, 20.555585876268132, 19.07996013017871, 18.238168884377384, 17.031786591085847, 20.883512532533256, 19.265358485383576, 20.254367035939957, 21.677526540784832, 18.119153691858127, 22.095543618689632, 18.895542748983594, 20.9139728285529, 18.053210631213176, 19.99242282062356, 17.98966737826062, 17.18549474620994, 20.211879118679587, 20.671415821335998, 20.66498606104103, 21.30655428284756, 21.689141072563892, 18.583842593068507, 19.841313233004964, 21.218817142388545, 18.380139278561767, 18.31858274738084, 19.11675985687575, 17.74168365065434, 18.835056495063128, 18.59991246846613, 19.285120666039347, 19.2621856858946, 20.880972007282768, 18.98876125387093, 19.731887187193408, 22.17319478126974, 20.91514401678687, 18.76015320936007, 19.63859139760376, 18.86946271445948, 16.9306449302967, 17.562494136041668], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0765965040291077, "mean_inference_ms": 8.118693116640191, "mean_action_processing_ms": 0.5550996781528865, "mean_env_wait_ms": 23.852266911451224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03941178321838379, "StateBufferConnector_ms": 0.025084972381591797, "ViewRequirementAgentConnector_ms": 0.9060747623443604}}, "episode_reward_max": 23.315289147101, "episode_reward_min": 15.520819173544496, "episode_reward_mean": 19.673423532539037, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.25781802199998, 18.36867362036173, 21.177954471211358, 21.02001515501652, 21.26982012440026, 19.923759989422738, 19.112307943724876, 20.738764323622075, 19.78831532998281, 19.682514776418, 20.625837100811513, 18.94015244384149, 23.315289147101, 20.37923993065928, 18.968760449308228, 21.051028956454463, 19.28046445752962, 20.12534178548301, 22.99383608325281, 20.41375465802527, 19.318752684110493, 21.076340063951584, 22.746271209566352, 19.75777110342138, 20.66512226231658, 20.92722388210879, 20.84314087064376, 17.29226701438167, 20.56056836104422, 20.616483206925654, 19.044515630726806, 19.764299411433996, 18.34994448739045, 18.530395065925255, 19.751945915475, 19.37264910885252, 20.555498397080676, 20.1976655558037, 18.962429220540493, 18.743528500124057, 17.27194044716122, 19.620545552685957, 21.646277524504594, 22.083200004509326, 18.287114860224175, 15.520819173544496, 20.07448014105135, 18.515084242195492, 19.821053479731187, 17.61166067825923, 16.242674726995322, 17.627242925014208, 21.50511846381994, 21.52156609136213, 18.02286644991969, 18.144803044768693, 18.100627057529532, 21.80484732120188, 20.555585876268132, 19.07996013017871, 18.238168884377384, 17.031786591085847, 20.883512532533256, 19.265358485383576, 20.254367035939957, 21.677526540784832, 18.119153691858127, 22.095543618689632, 18.895542748983594, 20.9139728285529, 18.053210631213176, 19.99242282062356, 17.98966737826062, 17.18549474620994, 20.211879118679587, 20.671415821335998, 20.66498606104103, 21.30655428284756, 21.689141072563892, 18.583842593068507, 19.841313233004964, 21.218817142388545, 18.380139278561767, 18.31858274738084, 19.11675985687575, 17.74168365065434, 18.835056495063128, 18.59991246846613, 19.285120666039347, 19.2621856858946, 20.880972007282768, 18.98876125387093, 19.731887187193408, 22.17319478126974, 20.91514401678687, 18.76015320936007, 19.63859139760376, 18.86946271445948, 16.9306449302967, 17.562494136041668], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0765965040291077, "mean_inference_ms": 8.118693116640191, "mean_action_processing_ms": 0.5550996781528865, "mean_env_wait_ms": 23.852266911451224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03941178321838379, "StateBufferConnector_ms": 0.025084972381591797, "ViewRequirementAgentConnector_ms": 0.9060747623443604}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872716, "num_agent_steps_trained": 1872716, "num_env_steps_sampled": 1872716, "num_env_steps_trained": 1872716, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.36386672771715, "num_env_steps_trained_throughput_per_sec": 282.36386672771715, "timesteps_total": 1872716, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1872716, "timers": {"training_iteration_time_ms": 55405.119, "sample_time_ms": 41694.779, "load_time_ms": 1774.193, "load_throughput": 8814.148, "learn_time_ms": 11385.08, "learn_throughput": 1373.552, "synch_weights_time_ms": 432.911}, "counters": {"num_env_steps_sampled": 1872716, "num_env_steps_trained": 1872716, "num_agent_steps_sampled": 1872716, "num_agent_steps_trained": 1872716}, "done": false, "episodes_total": 812, "training_iteration": 124, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-24-47", "timestamp": 1749245087, "time_this_iter_s": 55.40384531021118, "time_total_s": 3324.223294019699, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3324.223294019699, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 76.69999999999999, "ram_util_percent": 64.6765625, "gpu_util_percent0": 0.08109375, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.127283999999998e-05, "total_loss": -0.08919940444259819, "policy_loss": -0.02552174566038461, "vf_loss": 0.015405383547344668, "vf_explained_var": 0.8753585228053006, "kl": 0.017310750277432486, "entropy": 18.225610812794077, "entropy_coeff": 0.004254568}, "model": {}, "num_grad_updates_lifetime": 32175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1888354, "num_env_steps_trained": 1888354, "num_agent_steps_sampled": 1888354, "num_agent_steps_trained": 1888354}, "sampler_results": {"episode_reward_max": 22.99383608325281, "episode_reward_min": 15.013037951167872, "episode_reward_mean": 19.465516210916956, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.968760449308228, 21.051028956454463, 19.28046445752962, 20.12534178548301, 22.99383608325281, 20.41375465802527, 19.318752684110493, 21.076340063951584, 22.746271209566352, 19.75777110342138, 20.66512226231658, 20.92722388210879, 20.84314087064376, 17.29226701438167, 20.56056836104422, 20.616483206925654, 19.044515630726806, 19.764299411433996, 18.34994448739045, 18.530395065925255, 19.751945915475, 19.37264910885252, 20.555498397080676, 20.1976655558037, 18.962429220540493, 18.743528500124057, 17.27194044716122, 19.620545552685957, 21.646277524504594, 22.083200004509326, 18.287114860224175, 15.520819173544496, 20.07448014105135, 18.515084242195492, 19.821053479731187, 17.61166067825923, 16.242674726995322, 17.627242925014208, 21.50511846381994, 21.52156609136213, 18.02286644991969, 18.144803044768693, 18.100627057529532, 21.80484732120188, 20.555585876268132, 19.07996013017871, 18.238168884377384, 17.031786591085847, 20.883512532533256, 19.265358485383576, 20.254367035939957, 21.677526540784832, 18.119153691858127, 22.095543618689632, 18.895542748983594, 20.9139728285529, 18.053210631213176, 19.99242282062356, 17.98966737826062, 17.18549474620994, 20.211879118679587, 20.671415821335998, 20.66498606104103, 21.30655428284756, 21.689141072563892, 18.583842593068507, 19.841313233004964, 21.218817142388545, 18.380139278561767, 18.31858274738084, 19.11675985687575, 17.74168365065434, 18.835056495063128, 18.59991246846613, 19.285120666039347, 19.2621856858946, 20.880972007282768, 18.98876125387093, 19.731887187193408, 22.17319478126974, 20.91514401678687, 18.76015320936007, 19.63859139760376, 18.86946271445948, 16.9306449302967, 17.562494136041668, 21.91390449611238, 20.579087749299056, 15.013037951167872, 16.173685181079485, 20.091426821513156, 20.303681715284707, 19.4082566725481, 17.22808925514762, 16.726263920859093, 20.730186085676113, 21.44329242524424, 19.35771797065298, 19.42515454799451, 16.415945423786273], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.076507260149211, "mean_inference_ms": 8.120840701874762, "mean_action_processing_ms": 0.5552541912095399, "mean_env_wait_ms": 23.852633808629633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037636518478393555, "StateBufferConnector_ms": 0.025089740753173828, "ViewRequirementAgentConnector_ms": 0.8758811950683594}}, "episode_reward_max": 22.99383608325281, "episode_reward_min": 15.013037951167872, "episode_reward_mean": 19.465516210916956, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.968760449308228, 21.051028956454463, 19.28046445752962, 20.12534178548301, 22.99383608325281, 20.41375465802527, 19.318752684110493, 21.076340063951584, 22.746271209566352, 19.75777110342138, 20.66512226231658, 20.92722388210879, 20.84314087064376, 17.29226701438167, 20.56056836104422, 20.616483206925654, 19.044515630726806, 19.764299411433996, 18.34994448739045, 18.530395065925255, 19.751945915475, 19.37264910885252, 20.555498397080676, 20.1976655558037, 18.962429220540493, 18.743528500124057, 17.27194044716122, 19.620545552685957, 21.646277524504594, 22.083200004509326, 18.287114860224175, 15.520819173544496, 20.07448014105135, 18.515084242195492, 19.821053479731187, 17.61166067825923, 16.242674726995322, 17.627242925014208, 21.50511846381994, 21.52156609136213, 18.02286644991969, 18.144803044768693, 18.100627057529532, 21.80484732120188, 20.555585876268132, 19.07996013017871, 18.238168884377384, 17.031786591085847, 20.883512532533256, 19.265358485383576, 20.254367035939957, 21.677526540784832, 18.119153691858127, 22.095543618689632, 18.895542748983594, 20.9139728285529, 18.053210631213176, 19.99242282062356, 17.98966737826062, 17.18549474620994, 20.211879118679587, 20.671415821335998, 20.66498606104103, 21.30655428284756, 21.689141072563892, 18.583842593068507, 19.841313233004964, 21.218817142388545, 18.380139278561767, 18.31858274738084, 19.11675985687575, 17.74168365065434, 18.835056495063128, 18.59991246846613, 19.285120666039347, 19.2621856858946, 20.880972007282768, 18.98876125387093, 19.731887187193408, 22.17319478126974, 20.91514401678687, 18.76015320936007, 19.63859139760376, 18.86946271445948, 16.9306449302967, 17.562494136041668, 21.91390449611238, 20.579087749299056, 15.013037951167872, 16.173685181079485, 20.091426821513156, 20.303681715284707, 19.4082566725481, 17.22808925514762, 16.726263920859093, 20.730186085676113, 21.44329242524424, 19.35771797065298, 19.42515454799451, 16.415945423786273], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.076507260149211, "mean_inference_ms": 8.120840701874762, "mean_action_processing_ms": 0.5552541912095399, "mean_env_wait_ms": 23.852633808629633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037636518478393555, "StateBufferConnector_ms": 0.025089740753173828, "ViewRequirementAgentConnector_ms": 0.8758811950683594}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1888354, "num_agent_steps_trained": 1888354, "num_env_steps_sampled": 1888354, "num_env_steps_trained": 1888354, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.1939724992923, "num_env_steps_trained_throughput_per_sec": 283.1939724992923, "timesteps_total": 1888354, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1888354, "timers": {"training_iteration_time_ms": 55440.222, "sample_time_ms": 41724.207, "load_time_ms": 1781.378, "load_throughput": 8778.598, "learn_time_ms": 11388.008, "learn_throughput": 1373.199, "synch_weights_time_ms": 430.046}, "counters": {"num_env_steps_sampled": 1888354, "num_env_steps_trained": 1888354, "num_agent_steps_sampled": 1888354, "num_agent_steps_trained": 1888354}, "done": false, "episodes_total": 826, "training_iteration": 125, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-25-42", "timestamp": 1749245142, "time_this_iter_s": 55.23610234260559, "time_total_s": 3379.4593963623047, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3379.4593963623047, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 76.0, "ram_util_percent": 64.74531250000001, "gpu_util_percent0": 0.0846875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.111646e-05, "total_loss": -0.08741389491214333, "policy_loss": -0.024131074118459682, "vf_loss": 0.014444620910693299, "vf_explained_var": 0.8801264716278423, "kl": 0.017582130392732903, "entropy": 18.233152751922606, "entropy_coeff": 0.004223292000000001}, "model": {}, "num_grad_updates_lifetime": 32725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1903992, "num_env_steps_trained": 1903992, "num_agent_steps_sampled": 1903992, "num_agent_steps_trained": 1903992}, "sampler_results": {"episode_reward_max": 22.7168529611231, "episode_reward_min": 15.013037951167872, "episode_reward_mean": 19.355864450766397, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.56056836104422, 20.616483206925654, 19.044515630726806, 19.764299411433996, 18.34994448739045, 18.530395065925255, 19.751945915475, 19.37264910885252, 20.555498397080676, 20.1976655558037, 18.962429220540493, 18.743528500124057, 17.27194044716122, 19.620545552685957, 21.646277524504594, 22.083200004509326, 18.287114860224175, 15.520819173544496, 20.07448014105135, 18.515084242195492, 19.821053479731187, 17.61166067825923, 16.242674726995322, 17.627242925014208, 21.50511846381994, 21.52156609136213, 18.02286644991969, 18.144803044768693, 18.100627057529532, 21.80484732120188, 20.555585876268132, 19.07996013017871, 18.238168884377384, 17.031786591085847, 20.883512532533256, 19.265358485383576, 20.254367035939957, 21.677526540784832, 18.119153691858127, 22.095543618689632, 18.895542748983594, 20.9139728285529, 18.053210631213176, 19.99242282062356, 17.98966737826062, 17.18549474620994, 20.211879118679587, 20.671415821335998, 20.66498606104103, 21.30655428284756, 21.689141072563892, 18.583842593068507, 19.841313233004964, 21.218817142388545, 18.380139278561767, 18.31858274738084, 19.11675985687575, 17.74168365065434, 18.835056495063128, 18.59991246846613, 19.285120666039347, 19.2621856858946, 20.880972007282768, 18.98876125387093, 19.731887187193408, 22.17319478126974, 20.91514401678687, 18.76015320936007, 19.63859139760376, 18.86946271445948, 16.9306449302967, 17.562494136041668, 21.91390449611238, 20.579087749299056, 15.013037951167872, 16.173685181079485, 20.091426821513156, 20.303681715284707, 19.4082566725481, 17.22808925514762, 16.726263920859093, 20.730186085676113, 21.44329242524424, 19.35771797065298, 19.42515454799451, 16.415945423786273, 16.77947187366657, 19.08476125172428, 20.432537006592415, 19.011859705327353, 22.7168529611231, 17.92399313293177, 19.814497148475397, 19.047352761328114, 20.75095362721824, 18.35684023049411, 18.818514208091237, 20.718148462789916, 20.32538433027812, 20.713732765457827], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0764942372411967, "mean_inference_ms": 8.122338444891604, "mean_action_processing_ms": 0.5553949593817586, "mean_env_wait_ms": 23.85312310635433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03960418701171875, "StateBufferConnector_ms": 0.02711033821105957, "ViewRequirementAgentConnector_ms": 0.8737986087799072}}, "episode_reward_max": 22.7168529611231, "episode_reward_min": 15.013037951167872, "episode_reward_mean": 19.355864450766397, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.56056836104422, 20.616483206925654, 19.044515630726806, 19.764299411433996, 18.34994448739045, 18.530395065925255, 19.751945915475, 19.37264910885252, 20.555498397080676, 20.1976655558037, 18.962429220540493, 18.743528500124057, 17.27194044716122, 19.620545552685957, 21.646277524504594, 22.083200004509326, 18.287114860224175, 15.520819173544496, 20.07448014105135, 18.515084242195492, 19.821053479731187, 17.61166067825923, 16.242674726995322, 17.627242925014208, 21.50511846381994, 21.52156609136213, 18.02286644991969, 18.144803044768693, 18.100627057529532, 21.80484732120188, 20.555585876268132, 19.07996013017871, 18.238168884377384, 17.031786591085847, 20.883512532533256, 19.265358485383576, 20.254367035939957, 21.677526540784832, 18.119153691858127, 22.095543618689632, 18.895542748983594, 20.9139728285529, 18.053210631213176, 19.99242282062356, 17.98966737826062, 17.18549474620994, 20.211879118679587, 20.671415821335998, 20.66498606104103, 21.30655428284756, 21.689141072563892, 18.583842593068507, 19.841313233004964, 21.218817142388545, 18.380139278561767, 18.31858274738084, 19.11675985687575, 17.74168365065434, 18.835056495063128, 18.59991246846613, 19.285120666039347, 19.2621856858946, 20.880972007282768, 18.98876125387093, 19.731887187193408, 22.17319478126974, 20.91514401678687, 18.76015320936007, 19.63859139760376, 18.86946271445948, 16.9306449302967, 17.562494136041668, 21.91390449611238, 20.579087749299056, 15.013037951167872, 16.173685181079485, 20.091426821513156, 20.303681715284707, 19.4082566725481, 17.22808925514762, 16.726263920859093, 20.730186085676113, 21.44329242524424, 19.35771797065298, 19.42515454799451, 16.415945423786273, 16.77947187366657, 19.08476125172428, 20.432537006592415, 19.011859705327353, 22.7168529611231, 17.92399313293177, 19.814497148475397, 19.047352761328114, 20.75095362721824, 18.35684023049411, 18.818514208091237, 20.718148462789916, 20.32538433027812, 20.713732765457827], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0764942372411967, "mean_inference_ms": 8.122338444891604, "mean_action_processing_ms": 0.5553949593817586, "mean_env_wait_ms": 23.85312310635433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03960418701171875, "StateBufferConnector_ms": 0.02711033821105957, "ViewRequirementAgentConnector_ms": 0.8737986087799072}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1903992, "num_agent_steps_trained": 1903992, "num_env_steps_sampled": 1903992, "num_env_steps_trained": 1903992, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.7579139615306, "num_env_steps_trained_throughput_per_sec": 282.7579139615306, "timesteps_total": 1903992, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1903992, "timers": {"training_iteration_time_ms": 55474.291, "sample_time_ms": 41757.164, "load_time_ms": 1785.575, "load_throughput": 8757.964, "learn_time_ms": 11385.703, "learn_throughput": 1373.477, "synch_weights_time_ms": 431.21}, "counters": {"num_env_steps_sampled": 1903992, "num_env_steps_trained": 1903992, "num_agent_steps_sampled": 1903992, "num_agent_steps_trained": 1903992}, "done": false, "episodes_total": 840, "training_iteration": 126, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-26-37", "timestamp": 1749245197, "time_this_iter_s": 55.37135720252991, "time_total_s": 3434.8307535648346, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3434.8307535648346, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 76.46249999999999, "ram_util_percent": 64.7640625, "gpu_util_percent0": 0.0875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.096008e-05, "total_loss": -0.09140245444225994, "policy_loss": -0.028255192174216393, "vf_loss": 0.014946683461947198, "vf_explained_var": 0.8698384610089389, "kl": 0.01667570606292322, "entropy": 18.25732994252985, "entropy_coeff": 0.004192016}, "model": {}, "num_grad_updates_lifetime": 33275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1919630, "num_env_steps_trained": 1919630, "num_agent_steps_sampled": 1919630, "num_agent_steps_trained": 1919630}, "sampler_results": {"episode_reward_max": 22.7168529611231, "episode_reward_min": 15.013037951167872, "episode_reward_mean": 19.178317725834173, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.646277524504594, 22.083200004509326, 18.287114860224175, 15.520819173544496, 20.07448014105135, 18.515084242195492, 19.821053479731187, 17.61166067825923, 16.242674726995322, 17.627242925014208, 21.50511846381994, 21.52156609136213, 18.02286644991969, 18.144803044768693, 18.100627057529532, 21.80484732120188, 20.555585876268132, 19.07996013017871, 18.238168884377384, 17.031786591085847, 20.883512532533256, 19.265358485383576, 20.254367035939957, 21.677526540784832, 18.119153691858127, 22.095543618689632, 18.895542748983594, 20.9139728285529, 18.053210631213176, 19.99242282062356, 17.98966737826062, 17.18549474620994, 20.211879118679587, 20.671415821335998, 20.66498606104103, 21.30655428284756, 21.689141072563892, 18.583842593068507, 19.841313233004964, 21.218817142388545, 18.380139278561767, 18.31858274738084, 19.11675985687575, 17.74168365065434, 18.835056495063128, 18.59991246846613, 19.285120666039347, 19.2621856858946, 20.880972007282768, 18.98876125387093, 19.731887187193408, 22.17319478126974, 20.91514401678687, 18.76015320936007, 19.63859139760376, 18.86946271445948, 16.9306449302967, 17.562494136041668, 21.91390449611238, 20.579087749299056, 15.013037951167872, 16.173685181079485, 20.091426821513156, 20.303681715284707, 19.4082566725481, 17.22808925514762, 16.726263920859093, 20.730186085676113, 21.44329242524424, 19.35771797065298, 19.42515454799451, 16.415945423786273, 16.77947187366657, 19.08476125172428, 20.432537006592415, 19.011859705327353, 22.7168529611231, 17.92399313293177, 19.814497148475397, 19.047352761328114, 20.75095362721824, 18.35684023049411, 18.818514208091237, 20.718148462789916, 20.32538433027812, 20.713732765457827, 18.43682353174899, 15.730531190606214, 21.452265370269238, 17.795441572590494, 18.116969150031462, 18.547927020673676, 18.590651412296644, 15.956816745701335, 19.31174901165023, 20.555630479160317, 18.46472207282492, 15.87897746396637, 17.637236621888853, 17.111994724538587], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0763842959380194, "mean_inference_ms": 8.124127659464504, "mean_action_processing_ms": 0.5555192952452257, "mean_env_wait_ms": 23.853630513226825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03659820556640625, "StateBufferConnector_ms": 0.02714824676513672, "ViewRequirementAgentConnector_ms": 0.8787825107574463}}, "episode_reward_max": 22.7168529611231, "episode_reward_min": 15.013037951167872, "episode_reward_mean": 19.178317725834173, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.646277524504594, 22.083200004509326, 18.287114860224175, 15.520819173544496, 20.07448014105135, 18.515084242195492, 19.821053479731187, 17.61166067825923, 16.242674726995322, 17.627242925014208, 21.50511846381994, 21.52156609136213, 18.02286644991969, 18.144803044768693, 18.100627057529532, 21.80484732120188, 20.555585876268132, 19.07996013017871, 18.238168884377384, 17.031786591085847, 20.883512532533256, 19.265358485383576, 20.254367035939957, 21.677526540784832, 18.119153691858127, 22.095543618689632, 18.895542748983594, 20.9139728285529, 18.053210631213176, 19.99242282062356, 17.98966737826062, 17.18549474620994, 20.211879118679587, 20.671415821335998, 20.66498606104103, 21.30655428284756, 21.689141072563892, 18.583842593068507, 19.841313233004964, 21.218817142388545, 18.380139278561767, 18.31858274738084, 19.11675985687575, 17.74168365065434, 18.835056495063128, 18.59991246846613, 19.285120666039347, 19.2621856858946, 20.880972007282768, 18.98876125387093, 19.731887187193408, 22.17319478126974, 20.91514401678687, 18.76015320936007, 19.63859139760376, 18.86946271445948, 16.9306449302967, 17.562494136041668, 21.91390449611238, 20.579087749299056, 15.013037951167872, 16.173685181079485, 20.091426821513156, 20.303681715284707, 19.4082566725481, 17.22808925514762, 16.726263920859093, 20.730186085676113, 21.44329242524424, 19.35771797065298, 19.42515454799451, 16.415945423786273, 16.77947187366657, 19.08476125172428, 20.432537006592415, 19.011859705327353, 22.7168529611231, 17.92399313293177, 19.814497148475397, 19.047352761328114, 20.75095362721824, 18.35684023049411, 18.818514208091237, 20.718148462789916, 20.32538433027812, 20.713732765457827, 18.43682353174899, 15.730531190606214, 21.452265370269238, 17.795441572590494, 18.116969150031462, 18.547927020673676, 18.590651412296644, 15.956816745701335, 19.31174901165023, 20.555630479160317, 18.46472207282492, 15.87897746396637, 17.637236621888853, 17.111994724538587], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0763842959380194, "mean_inference_ms": 8.124127659464504, "mean_action_processing_ms": 0.5555192952452257, "mean_env_wait_ms": 23.853630513226825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03659820556640625, "StateBufferConnector_ms": 0.02714824676513672, "ViewRequirementAgentConnector_ms": 0.8787825107574463}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1919630, "num_agent_steps_trained": 1919630, "num_env_steps_sampled": 1919630, "num_env_steps_trained": 1919630, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.3510355177161, "num_env_steps_trained_throughput_per_sec": 281.3510355177161, "timesteps_total": 1919630, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1919630, "timers": {"training_iteration_time_ms": 55500.692, "sample_time_ms": 41773.91, "load_time_ms": 1795.265, "load_throughput": 8710.694, "learn_time_ms": 11392.185, "learn_throughput": 1372.695, "synch_weights_time_ms": 427.074}, "counters": {"num_env_steps_sampled": 1919630, "num_env_steps_trained": 1919630, "num_agent_steps_sampled": 1919630, "num_agent_steps_trained": 1919630}, "done": false, "episodes_total": 854, "training_iteration": 127, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-27-33", "timestamp": 1749245253, "time_this_iter_s": 55.597845792770386, "time_total_s": 3490.428599357605, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3490.428599357605, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 77.37656249999999, "ram_util_percent": 64.871875, "gpu_util_percent0": 0.07421875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.080369999999999e-05, "total_loss": -0.0984472275546498, "policy_loss": -0.03568550755115046, "vf_loss": 0.01527444304983047, "vf_explained_var": 0.8728747948733243, "kl": 0.0162377814474453, "entropy": 18.269342287236995, "entropy_coeff": 0.004160739999999999}, "model": {}, "num_grad_updates_lifetime": 33825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1935268, "num_env_steps_trained": 1935268, "num_agent_steps_sampled": 1935268, "num_agent_steps_trained": 1935268}, "sampler_results": {"episode_reward_max": 22.7168529611231, "episode_reward_min": 15.013037951167872, "episode_reward_mean": 19.291541029561305, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.100627057529532, 21.80484732120188, 20.555585876268132, 19.07996013017871, 18.238168884377384, 17.031786591085847, 20.883512532533256, 19.265358485383576, 20.254367035939957, 21.677526540784832, 18.119153691858127, 22.095543618689632, 18.895542748983594, 20.9139728285529, 18.053210631213176, 19.99242282062356, 17.98966737826062, 17.18549474620994, 20.211879118679587, 20.671415821335998, 20.66498606104103, 21.30655428284756, 21.689141072563892, 18.583842593068507, 19.841313233004964, 21.218817142388545, 18.380139278561767, 18.31858274738084, 19.11675985687575, 17.74168365065434, 18.835056495063128, 18.59991246846613, 19.285120666039347, 19.2621856858946, 20.880972007282768, 18.98876125387093, 19.731887187193408, 22.17319478126974, 20.91514401678687, 18.76015320936007, 19.63859139760376, 18.86946271445948, 16.9306449302967, 17.562494136041668, 21.91390449611238, 20.579087749299056, 15.013037951167872, 16.173685181079485, 20.091426821513156, 20.303681715284707, 19.4082566725481, 17.22808925514762, 16.726263920859093, 20.730186085676113, 21.44329242524424, 19.35771797065298, 19.42515454799451, 16.415945423786273, 16.77947187366657, 19.08476125172428, 20.432537006592415, 19.011859705327353, 22.7168529611231, 17.92399313293177, 19.814497148475397, 19.047352761328114, 20.75095362721824, 18.35684023049411, 18.818514208091237, 20.718148462789916, 20.32538433027812, 20.713732765457827, 18.43682353174899, 15.730531190606214, 21.452265370269238, 17.795441572590494, 18.116969150031462, 18.547927020673676, 18.590651412296644, 15.956816745701335, 19.31174901165023, 20.555630479160317, 18.46472207282492, 15.87897746396637, 17.637236621888853, 17.111994724538587, 19.12373876682147, 18.128063719794905, 18.872314294867294, 19.789138428760594, 20.889441764531274, 22.436372830546595, 21.96426479688199, 18.23230606917139, 19.091953525853828, 16.43902167852495, 22.212396672867982, 19.85084250067394, 20.015268847457012, 20.901168281859846], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0760865109873112, "mean_inference_ms": 8.125287021657249, "mean_action_processing_ms": 0.5556049429201535, "mean_env_wait_ms": 23.853350817744232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300356864929199, "StateBufferConnector_ms": 0.03084254264831543, "ViewRequirementAgentConnector_ms": 0.8866887092590332}}, "episode_reward_max": 22.7168529611231, "episode_reward_min": 15.013037951167872, "episode_reward_mean": 19.291541029561305, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.100627057529532, 21.80484732120188, 20.555585876268132, 19.07996013017871, 18.238168884377384, 17.031786591085847, 20.883512532533256, 19.265358485383576, 20.254367035939957, 21.677526540784832, 18.119153691858127, 22.095543618689632, 18.895542748983594, 20.9139728285529, 18.053210631213176, 19.99242282062356, 17.98966737826062, 17.18549474620994, 20.211879118679587, 20.671415821335998, 20.66498606104103, 21.30655428284756, 21.689141072563892, 18.583842593068507, 19.841313233004964, 21.218817142388545, 18.380139278561767, 18.31858274738084, 19.11675985687575, 17.74168365065434, 18.835056495063128, 18.59991246846613, 19.285120666039347, 19.2621856858946, 20.880972007282768, 18.98876125387093, 19.731887187193408, 22.17319478126974, 20.91514401678687, 18.76015320936007, 19.63859139760376, 18.86946271445948, 16.9306449302967, 17.562494136041668, 21.91390449611238, 20.579087749299056, 15.013037951167872, 16.173685181079485, 20.091426821513156, 20.303681715284707, 19.4082566725481, 17.22808925514762, 16.726263920859093, 20.730186085676113, 21.44329242524424, 19.35771797065298, 19.42515454799451, 16.415945423786273, 16.77947187366657, 19.08476125172428, 20.432537006592415, 19.011859705327353, 22.7168529611231, 17.92399313293177, 19.814497148475397, 19.047352761328114, 20.75095362721824, 18.35684023049411, 18.818514208091237, 20.718148462789916, 20.32538433027812, 20.713732765457827, 18.43682353174899, 15.730531190606214, 21.452265370269238, 17.795441572590494, 18.116969150031462, 18.547927020673676, 18.590651412296644, 15.956816745701335, 19.31174901165023, 20.555630479160317, 18.46472207282492, 15.87897746396637, 17.637236621888853, 17.111994724538587, 19.12373876682147, 18.128063719794905, 18.872314294867294, 19.789138428760594, 20.889441764531274, 22.436372830546595, 21.96426479688199, 18.23230606917139, 19.091953525853828, 16.43902167852495, 22.212396672867982, 19.85084250067394, 20.015268847457012, 20.901168281859846], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0760865109873112, "mean_inference_ms": 8.125287021657249, "mean_action_processing_ms": 0.5556049429201535, "mean_env_wait_ms": 23.853350817744232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300356864929199, "StateBufferConnector_ms": 0.03084254264831543, "ViewRequirementAgentConnector_ms": 0.8866887092590332}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1935268, "num_agent_steps_trained": 1935268, "num_env_steps_sampled": 1935268, "num_env_steps_trained": 1935268, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.44321295004534, "num_env_steps_trained_throughput_per_sec": 282.44321295004534, "timesteps_total": 1935268, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1935268, "timers": {"training_iteration_time_ms": 55499.257, "sample_time_ms": 41748.714, "load_time_ms": 1790.876, "load_throughput": 8732.038, "learn_time_ms": 11396.791, "learn_throughput": 1372.141, "synch_weights_time_ms": 452.056}, "counters": {"num_env_steps_sampled": 1935268, "num_env_steps_trained": 1935268, "num_agent_steps_sampled": 1935268, "num_agent_steps_trained": 1935268}, "done": false, "episodes_total": 868, "training_iteration": 128, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-28-29", "timestamp": 1749245309, "time_this_iter_s": 55.38475942611694, "time_total_s": 3545.813358783722, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3545.813358783722, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 75.9109375, "ram_util_percent": 64.90625, "gpu_util_percent0": 0.08328125, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.064732000000001e-05, "total_loss": -0.08200922673070718, "policy_loss": -0.020044694703432137, "vf_loss": 0.014748208785683593, "vf_explained_var": 0.8639611330899325, "kl": 0.016912023281011816, "entropy": 18.26361163226041, "entropy_coeff": 0.004129464}, "model": {}, "num_grad_updates_lifetime": 34375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1950906, "num_env_steps_trained": 1950906, "num_agent_steps_sampled": 1950906, "num_agent_steps_trained": 1950906}, "sampler_results": {"episode_reward_max": 22.7168529611231, "episode_reward_min": 13.714556908996178, "episode_reward_mean": 19.149421954259783, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.053210631213176, 19.99242282062356, 17.98966737826062, 17.18549474620994, 20.211879118679587, 20.671415821335998, 20.66498606104103, 21.30655428284756, 21.689141072563892, 18.583842593068507, 19.841313233004964, 21.218817142388545, 18.380139278561767, 18.31858274738084, 19.11675985687575, 17.74168365065434, 18.835056495063128, 18.59991246846613, 19.285120666039347, 19.2621856858946, 20.880972007282768, 18.98876125387093, 19.731887187193408, 22.17319478126974, 20.91514401678687, 18.76015320936007, 19.63859139760376, 18.86946271445948, 16.9306449302967, 17.562494136041668, 21.91390449611238, 20.579087749299056, 15.013037951167872, 16.173685181079485, 20.091426821513156, 20.303681715284707, 19.4082566725481, 17.22808925514762, 16.726263920859093, 20.730186085676113, 21.44329242524424, 19.35771797065298, 19.42515454799451, 16.415945423786273, 16.77947187366657, 19.08476125172428, 20.432537006592415, 19.011859705327353, 22.7168529611231, 17.92399313293177, 19.814497148475397, 19.047352761328114, 20.75095362721824, 18.35684023049411, 18.818514208091237, 20.718148462789916, 20.32538433027812, 20.713732765457827, 18.43682353174899, 15.730531190606214, 21.452265370269238, 17.795441572590494, 18.116969150031462, 18.547927020673676, 18.590651412296644, 15.956816745701335, 19.31174901165023, 20.555630479160317, 18.46472207282492, 15.87897746396637, 17.637236621888853, 17.111994724538587, 19.12373876682147, 18.128063719794905, 18.872314294867294, 19.789138428760594, 20.889441764531274, 22.436372830546595, 21.96426479688199, 18.23230606917139, 19.091953525853828, 16.43902167852495, 22.212396672867982, 19.85084250067394, 20.015268847457012, 20.901168281859846, 20.023493696927385, 18.2592912599253, 20.840527870958912, 19.51470935112363, 21.179942045129557, 18.72494771518337, 19.095521454029214, 18.94579926093532, 18.988000733784904, 13.714556908996178, 20.772565069142164, 16.157055251561097, 18.47976490775199, 18.00787028776594], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.075384658335577, "mean_inference_ms": 8.12633872839912, "mean_action_processing_ms": 0.5556771413328864, "mean_env_wait_ms": 23.85364048803948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029068708419799805, "StateBufferConnector_ms": 0.032933950424194336, "ViewRequirementAgentConnector_ms": 0.8766214847564697}}, "episode_reward_max": 22.7168529611231, "episode_reward_min": 13.714556908996178, "episode_reward_mean": 19.149421954259783, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.053210631213176, 19.99242282062356, 17.98966737826062, 17.18549474620994, 20.211879118679587, 20.671415821335998, 20.66498606104103, 21.30655428284756, 21.689141072563892, 18.583842593068507, 19.841313233004964, 21.218817142388545, 18.380139278561767, 18.31858274738084, 19.11675985687575, 17.74168365065434, 18.835056495063128, 18.59991246846613, 19.285120666039347, 19.2621856858946, 20.880972007282768, 18.98876125387093, 19.731887187193408, 22.17319478126974, 20.91514401678687, 18.76015320936007, 19.63859139760376, 18.86946271445948, 16.9306449302967, 17.562494136041668, 21.91390449611238, 20.579087749299056, 15.013037951167872, 16.173685181079485, 20.091426821513156, 20.303681715284707, 19.4082566725481, 17.22808925514762, 16.726263920859093, 20.730186085676113, 21.44329242524424, 19.35771797065298, 19.42515454799451, 16.415945423786273, 16.77947187366657, 19.08476125172428, 20.432537006592415, 19.011859705327353, 22.7168529611231, 17.92399313293177, 19.814497148475397, 19.047352761328114, 20.75095362721824, 18.35684023049411, 18.818514208091237, 20.718148462789916, 20.32538433027812, 20.713732765457827, 18.43682353174899, 15.730531190606214, 21.452265370269238, 17.795441572590494, 18.116969150031462, 18.547927020673676, 18.590651412296644, 15.956816745701335, 19.31174901165023, 20.555630479160317, 18.46472207282492, 15.87897746396637, 17.637236621888853, 17.111994724538587, 19.12373876682147, 18.128063719794905, 18.872314294867294, 19.789138428760594, 20.889441764531274, 22.436372830546595, 21.96426479688199, 18.23230606917139, 19.091953525853828, 16.43902167852495, 22.212396672867982, 19.85084250067394, 20.015268847457012, 20.901168281859846, 20.023493696927385, 18.2592912599253, 20.840527870958912, 19.51470935112363, 21.179942045129557, 18.72494771518337, 19.095521454029214, 18.94579926093532, 18.988000733784904, 13.714556908996178, 20.772565069142164, 16.157055251561097, 18.47976490775199, 18.00787028776594], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.075384658335577, "mean_inference_ms": 8.12633872839912, "mean_action_processing_ms": 0.5556771413328864, "mean_env_wait_ms": 23.85364048803948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029068708419799805, "StateBufferConnector_ms": 0.032933950424194336, "ViewRequirementAgentConnector_ms": 0.8766214847564697}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1950906, "num_agent_steps_trained": 1950906, "num_env_steps_sampled": 1950906, "num_env_steps_trained": 1950906, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.3036132377684, "num_env_steps_trained_throughput_per_sec": 282.3036132377684, "timesteps_total": 1950906, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1950906, "timers": {"training_iteration_time_ms": 55459.503, "sample_time_ms": 41707.545, "load_time_ms": 1794.989, "load_throughput": 8712.033, "learn_time_ms": 11395.11, "learn_throughput": 1372.343, "synch_weights_time_ms": 450.931}, "counters": {"num_env_steps_sampled": 1950906, "num_env_steps_trained": 1950906, "num_agent_steps_sampled": 1950906, "num_agent_steps_trained": 1950906}, "done": false, "episodes_total": 882, "training_iteration": 129, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-29-24", "timestamp": 1749245364, "time_this_iter_s": 55.413862228393555, "time_total_s": 3601.2272210121155, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3601.2272210121155, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 76.52, "ram_util_percent": 64.96923076923076, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.8592122395833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": 1.6631465836820254, "episode_reward_min": -3.2298671823678267, "episode_reward_mean": -0.4304216780409014, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6631465836820254, 1.1812677138050525, -3.2298671823678267, 0.19349273422620017, -1.9601482395499585], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6042327792021527, "mean_inference_ms": 3.738736573296144, "mean_action_processing_ms": 0.3001545919540635, "mean_env_wait_ms": 11.743443664825588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020041465759277344, "ViewRequirementAgentConnector_ms": 0.3307151794433594}}, "episode_reward_max": 1.6631465836820254, "episode_reward_min": -3.2298671823678267, "episode_reward_mean": -0.4304216780409014, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6631465836820254, 1.1812677138050525, -3.2298671823678267, 0.19349273422620017, -1.9601482395499585], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6042327792021527, "mean_inference_ms": 3.738736573296144, "mean_action_processing_ms": 0.3001545919540635, "mean_env_wait_ms": 11.743443664825588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020041465759277344, "ViewRequirementAgentConnector_ms": 0.3307151794433594}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.049094000000002e-05, "total_loss": -0.08313134922730651, "policy_loss": -0.022255803613013336, "vf_loss": 0.016492825552228498, "vf_explained_var": 0.8534208092906258, "kl": 0.016886115417265417, "entropy": 18.261604179035533, "entropy_coeff": 0.004098188}, "model": {}, "num_grad_updates_lifetime": 34925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1966544, "num_env_steps_trained": 1966544, "num_agent_steps_sampled": 1966544, "num_agent_steps_trained": 1966544}, "sampler_results": {"episode_reward_max": 22.7168529611231, "episode_reward_min": 13.714556908996178, "episode_reward_mean": 19.061363234541915, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.11675985687575, 17.74168365065434, 18.835056495063128, 18.59991246846613, 19.285120666039347, 19.2621856858946, 20.880972007282768, 18.98876125387093, 19.731887187193408, 22.17319478126974, 20.91514401678687, 18.76015320936007, 19.63859139760376, 18.86946271445948, 16.9306449302967, 17.562494136041668, 21.91390449611238, 20.579087749299056, 15.013037951167872, 16.173685181079485, 20.091426821513156, 20.303681715284707, 19.4082566725481, 17.22808925514762, 16.726263920859093, 20.730186085676113, 21.44329242524424, 19.35771797065298, 19.42515454799451, 16.415945423786273, 16.77947187366657, 19.08476125172428, 20.432537006592415, 19.011859705327353, 22.7168529611231, 17.92399313293177, 19.814497148475397, 19.047352761328114, 20.75095362721824, 18.35684023049411, 18.818514208091237, 20.718148462789916, 20.32538433027812, 20.713732765457827, 18.43682353174899, 15.730531190606214, 21.452265370269238, 17.795441572590494, 18.116969150031462, 18.547927020673676, 18.590651412296644, 15.956816745701335, 19.31174901165023, 20.555630479160317, 18.46472207282492, 15.87897746396637, 17.637236621888853, 17.111994724538587, 19.12373876682147, 18.128063719794905, 18.872314294867294, 19.789138428760594, 20.889441764531274, 22.436372830546595, 21.96426479688199, 18.23230606917139, 19.091953525853828, 16.43902167852495, 22.212396672867982, 19.85084250067394, 20.015268847457012, 20.901168281859846, 20.023493696927385, 18.2592912599253, 20.840527870958912, 19.51470935112363, 21.179942045129557, 18.72494771518337, 19.095521454029214, 18.94579926093532, 18.988000733784904, 13.714556908996178, 20.772565069142164, 16.157055251561097, 18.47976490775199, 18.00787028776594, 20.692481527610447, 15.497010576640855, 20.072170866957283, 18.892833189039855, 18.740055022239606, 15.819645851371352, 20.07261562527922, 16.200297588149557, 18.866768155341493, 19.781388417174792, 20.91161154484317, 20.92062142649608, 18.26965524254187, 20.56443992170757], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0748737785728264, "mean_inference_ms": 8.127230693771041, "mean_action_processing_ms": 0.5557592052580359, "mean_env_wait_ms": 23.853556080196018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02913188934326172, "StateBufferConnector_ms": 0.02994847297668457, "ViewRequirementAgentConnector_ms": 0.8749642372131348}}, "episode_reward_max": 22.7168529611231, "episode_reward_min": 13.714556908996178, "episode_reward_mean": 19.061363234541915, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.11675985687575, 17.74168365065434, 18.835056495063128, 18.59991246846613, 19.285120666039347, 19.2621856858946, 20.880972007282768, 18.98876125387093, 19.731887187193408, 22.17319478126974, 20.91514401678687, 18.76015320936007, 19.63859139760376, 18.86946271445948, 16.9306449302967, 17.562494136041668, 21.91390449611238, 20.579087749299056, 15.013037951167872, 16.173685181079485, 20.091426821513156, 20.303681715284707, 19.4082566725481, 17.22808925514762, 16.726263920859093, 20.730186085676113, 21.44329242524424, 19.35771797065298, 19.42515454799451, 16.415945423786273, 16.77947187366657, 19.08476125172428, 20.432537006592415, 19.011859705327353, 22.7168529611231, 17.92399313293177, 19.814497148475397, 19.047352761328114, 20.75095362721824, 18.35684023049411, 18.818514208091237, 20.718148462789916, 20.32538433027812, 20.713732765457827, 18.43682353174899, 15.730531190606214, 21.452265370269238, 17.795441572590494, 18.116969150031462, 18.547927020673676, 18.590651412296644, 15.956816745701335, 19.31174901165023, 20.555630479160317, 18.46472207282492, 15.87897746396637, 17.637236621888853, 17.111994724538587, 19.12373876682147, 18.128063719794905, 18.872314294867294, 19.789138428760594, 20.889441764531274, 22.436372830546595, 21.96426479688199, 18.23230606917139, 19.091953525853828, 16.43902167852495, 22.212396672867982, 19.85084250067394, 20.015268847457012, 20.901168281859846, 20.023493696927385, 18.2592912599253, 20.840527870958912, 19.51470935112363, 21.179942045129557, 18.72494771518337, 19.095521454029214, 18.94579926093532, 18.988000733784904, 13.714556908996178, 20.772565069142164, 16.157055251561097, 18.47976490775199, 18.00787028776594, 20.692481527610447, 15.497010576640855, 20.072170866957283, 18.892833189039855, 18.740055022239606, 15.819645851371352, 20.07261562527922, 16.200297588149557, 18.866768155341493, 19.781388417174792, 20.91161154484317, 20.92062142649608, 18.26965524254187, 20.56443992170757], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0748737785728264, "mean_inference_ms": 8.127230693771041, "mean_action_processing_ms": 0.5557592052580359, "mean_env_wait_ms": 23.853556080196018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02913188934326172, "StateBufferConnector_ms": 0.02994847297668457, "ViewRequirementAgentConnector_ms": 0.8749642372131348}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1966544, "num_agent_steps_trained": 1966544, "num_env_steps_sampled": 1966544, "num_env_steps_trained": 1966544, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.5240811248437, "num_env_steps_trained_throughput_per_sec": 280.5240811248437, "timesteps_total": 1966544, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1966544, "timers": {"training_iteration_time_ms": 55478.007, "sample_time_ms": 41712.336, "load_time_ms": 1805.779, "load_throughput": 8659.977, "learn_time_ms": 11396.858, "learn_throughput": 1372.133, "synch_weights_time_ms": 453.565}, "counters": {"num_env_steps_sampled": 1966544, "num_env_steps_trained": 1966544, "num_agent_steps_sampled": 1966544, "num_agent_steps_trained": 1966544}, "done": false, "episodes_total": 896, "training_iteration": 130, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-30-36", "timestamp": 1749245436, "time_this_iter_s": 71.99390983581543, "time_total_s": 3673.221130847931, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3673.221130847931, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 62.64047619047619, "ram_util_percent": 64.45714285714286, "gpu_util_percent0": 0.06357142857142857, "vram_util_percent0": 0.859212239583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.033455999999999e-05, "total_loss": -0.08552102897400883, "policy_loss": -0.02413855138356501, "vf_loss": 0.014684269153089687, "vf_explained_var": 0.8363923871517182, "kl": 0.016360318591204386, "entropy": 18.324250498684968, "entropy_coeff": 0.004066912}, "model": {}, "num_grad_updates_lifetime": 35475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1982182, "num_env_steps_trained": 1982182, "num_agent_steps_sampled": 1982182, "num_agent_steps_trained": 1982182}, "sampler_results": {"episode_reward_max": 22.7168529611231, "episode_reward_min": 13.714556908996178, "episode_reward_mean": 18.918162793575362, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.9306449302967, 17.562494136041668, 21.91390449611238, 20.579087749299056, 15.013037951167872, 16.173685181079485, 20.091426821513156, 20.303681715284707, 19.4082566725481, 17.22808925514762, 16.726263920859093, 20.730186085676113, 21.44329242524424, 19.35771797065298, 19.42515454799451, 16.415945423786273, 16.77947187366657, 19.08476125172428, 20.432537006592415, 19.011859705327353, 22.7168529611231, 17.92399313293177, 19.814497148475397, 19.047352761328114, 20.75095362721824, 18.35684023049411, 18.818514208091237, 20.718148462789916, 20.32538433027812, 20.713732765457827, 18.43682353174899, 15.730531190606214, 21.452265370269238, 17.795441572590494, 18.116969150031462, 18.547927020673676, 18.590651412296644, 15.956816745701335, 19.31174901165023, 20.555630479160317, 18.46472207282492, 15.87897746396637, 17.637236621888853, 17.111994724538587, 19.12373876682147, 18.128063719794905, 18.872314294867294, 19.789138428760594, 20.889441764531274, 22.436372830546595, 21.96426479688199, 18.23230606917139, 19.091953525853828, 16.43902167852495, 22.212396672867982, 19.85084250067394, 20.015268847457012, 20.901168281859846, 20.023493696927385, 18.2592912599253, 20.840527870958912, 19.51470935112363, 21.179942045129557, 18.72494771518337, 19.095521454029214, 18.94579926093532, 18.988000733784904, 13.714556908996178, 20.772565069142164, 16.157055251561097, 18.47976490775199, 18.00787028776594, 20.692481527610447, 15.497010576640855, 20.072170866957283, 18.892833189039855, 18.740055022239606, 15.819645851371352, 20.07261562527922, 16.200297588149557, 18.866768155341493, 19.781388417174792, 20.91161154484317, 20.92062142649608, 18.26965524254187, 20.56443992170757, 20.227639056224966, 20.64097310309847, 18.8882487314081, 19.78480070161403, 18.86131028949858, 17.032803315037633, 15.53300334756394, 18.998075784397432, 21.13861964450679, 18.362940877021483, 17.210269728737252, 17.716187029110017, 15.315019144981106, 18.768950540965296], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.074504690592544, "mean_inference_ms": 8.128476951625561, "mean_action_processing_ms": 0.5558680326576896, "mean_env_wait_ms": 23.854646644858466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027085542678833008, "StateBufferConnector_ms": 0.030767440795898438, "ViewRequirementAgentConnector_ms": 0.8945307731628418}}, "episode_reward_max": 22.7168529611231, "episode_reward_min": 13.714556908996178, "episode_reward_mean": 18.918162793575362, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.9306449302967, 17.562494136041668, 21.91390449611238, 20.579087749299056, 15.013037951167872, 16.173685181079485, 20.091426821513156, 20.303681715284707, 19.4082566725481, 17.22808925514762, 16.726263920859093, 20.730186085676113, 21.44329242524424, 19.35771797065298, 19.42515454799451, 16.415945423786273, 16.77947187366657, 19.08476125172428, 20.432537006592415, 19.011859705327353, 22.7168529611231, 17.92399313293177, 19.814497148475397, 19.047352761328114, 20.75095362721824, 18.35684023049411, 18.818514208091237, 20.718148462789916, 20.32538433027812, 20.713732765457827, 18.43682353174899, 15.730531190606214, 21.452265370269238, 17.795441572590494, 18.116969150031462, 18.547927020673676, 18.590651412296644, 15.956816745701335, 19.31174901165023, 20.555630479160317, 18.46472207282492, 15.87897746396637, 17.637236621888853, 17.111994724538587, 19.12373876682147, 18.128063719794905, 18.872314294867294, 19.789138428760594, 20.889441764531274, 22.436372830546595, 21.96426479688199, 18.23230606917139, 19.091953525853828, 16.43902167852495, 22.212396672867982, 19.85084250067394, 20.015268847457012, 20.901168281859846, 20.023493696927385, 18.2592912599253, 20.840527870958912, 19.51470935112363, 21.179942045129557, 18.72494771518337, 19.095521454029214, 18.94579926093532, 18.988000733784904, 13.714556908996178, 20.772565069142164, 16.157055251561097, 18.47976490775199, 18.00787028776594, 20.692481527610447, 15.497010576640855, 20.072170866957283, 18.892833189039855, 18.740055022239606, 15.819645851371352, 20.07261562527922, 16.200297588149557, 18.866768155341493, 19.781388417174792, 20.91161154484317, 20.92062142649608, 18.26965524254187, 20.56443992170757, 20.227639056224966, 20.64097310309847, 18.8882487314081, 19.78480070161403, 18.86131028949858, 17.032803315037633, 15.53300334756394, 18.998075784397432, 21.13861964450679, 18.362940877021483, 17.210269728737252, 17.716187029110017, 15.315019144981106, 18.768950540965296], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.074504690592544, "mean_inference_ms": 8.128476951625561, "mean_action_processing_ms": 0.5558680326576896, "mean_env_wait_ms": 23.854646644858466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027085542678833008, "StateBufferConnector_ms": 0.030767440795898438, "ViewRequirementAgentConnector_ms": 0.8945307731628418}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1982182, "num_agent_steps_trained": 1982182, "num_env_steps_sampled": 1982182, "num_env_steps_trained": 1982182, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.7834693872746, "num_env_steps_trained_throughput_per_sec": 278.7834693872746, "timesteps_total": 1982182, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1982182, "timers": {"training_iteration_time_ms": 55508.119, "sample_time_ms": 41740.105, "load_time_ms": 1792.572, "load_throughput": 8723.779, "learn_time_ms": 11411.968, "learn_throughput": 1370.316, "synch_weights_time_ms": 454.96}, "counters": {"num_env_steps_sampled": 1982182, "num_env_steps_trained": 1982182, "num_agent_steps_sampled": 1982182, "num_agent_steps_trained": 1982182}, "done": false, "episodes_total": 910, "training_iteration": 131, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-31-32", "timestamp": 1749245492, "time_this_iter_s": 56.14427828788757, "time_total_s": 3729.3654091358185, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3729.3654091358185, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 76.34153846153848, "ram_util_percent": 64.8, "gpu_util_percent0": 0.08538461538461536, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.017818000000002e-05, "total_loss": -0.08362891986839134, "policy_loss": -0.023118312306998467, "vf_loss": 0.014868922204795208, "vf_explained_var": 0.8561465470357374, "kl": 0.016553602709347248, "entropy": 18.289519661990077, "entropy_coeff": 0.004035636000000001}, "model": {}, "num_grad_updates_lifetime": 36025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1997820, "num_env_steps_trained": 1997820, "num_agent_steps_sampled": 1997820, "num_agent_steps_trained": 1997820}, "sampler_results": {"episode_reward_max": 22.7168529611231, "episode_reward_min": 13.714556908996178, "episode_reward_mean": 18.956788229100756, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.42515454799451, 16.415945423786273, 16.77947187366657, 19.08476125172428, 20.432537006592415, 19.011859705327353, 22.7168529611231, 17.92399313293177, 19.814497148475397, 19.047352761328114, 20.75095362721824, 18.35684023049411, 18.818514208091237, 20.718148462789916, 20.32538433027812, 20.713732765457827, 18.43682353174899, 15.730531190606214, 21.452265370269238, 17.795441572590494, 18.116969150031462, 18.547927020673676, 18.590651412296644, 15.956816745701335, 19.31174901165023, 20.555630479160317, 18.46472207282492, 15.87897746396637, 17.637236621888853, 17.111994724538587, 19.12373876682147, 18.128063719794905, 18.872314294867294, 19.789138428760594, 20.889441764531274, 22.436372830546595, 21.96426479688199, 18.23230606917139, 19.091953525853828, 16.43902167852495, 22.212396672867982, 19.85084250067394, 20.015268847457012, 20.901168281859846, 20.023493696927385, 18.2592912599253, 20.840527870958912, 19.51470935112363, 21.179942045129557, 18.72494771518337, 19.095521454029214, 18.94579926093532, 18.988000733784904, 13.714556908996178, 20.772565069142164, 16.157055251561097, 18.47976490775199, 18.00787028776594, 20.692481527610447, 15.497010576640855, 20.072170866957283, 18.892833189039855, 18.740055022239606, 15.819645851371352, 20.07261562527922, 16.200297588149557, 18.866768155341493, 19.781388417174792, 20.91161154484317, 20.92062142649608, 18.26965524254187, 20.56443992170757, 20.227639056224966, 20.64097310309847, 18.8882487314081, 19.78480070161403, 18.86131028949858, 17.032803315037633, 15.53300334756394, 18.998075784397432, 21.13861964450679, 18.362940877021483, 17.210269728737252, 17.716187029110017, 15.315019144981106, 18.768950540965296, 18.03951067979407, 16.744007433764597, 20.313370751747374, 14.635461398362803, 21.73851729239483, 21.24882124859124, 19.70740875732947, 21.97743845712894, 19.161380709443947, 17.76357353452128, 20.067172249728227, 19.733540513238612, 19.81600546116962, 16.378104376247688], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.074302315105621, "mean_inference_ms": 8.129479265172407, "mean_action_processing_ms": 0.555970320793155, "mean_env_wait_ms": 23.855947893314834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025363683700561523, "StateBufferConnector_ms": 0.03272724151611328, "ViewRequirementAgentConnector_ms": 0.9422729015350342}}, "episode_reward_max": 22.7168529611231, "episode_reward_min": 13.714556908996178, "episode_reward_mean": 18.956788229100756, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.42515454799451, 16.415945423786273, 16.77947187366657, 19.08476125172428, 20.432537006592415, 19.011859705327353, 22.7168529611231, 17.92399313293177, 19.814497148475397, 19.047352761328114, 20.75095362721824, 18.35684023049411, 18.818514208091237, 20.718148462789916, 20.32538433027812, 20.713732765457827, 18.43682353174899, 15.730531190606214, 21.452265370269238, 17.795441572590494, 18.116969150031462, 18.547927020673676, 18.590651412296644, 15.956816745701335, 19.31174901165023, 20.555630479160317, 18.46472207282492, 15.87897746396637, 17.637236621888853, 17.111994724538587, 19.12373876682147, 18.128063719794905, 18.872314294867294, 19.789138428760594, 20.889441764531274, 22.436372830546595, 21.96426479688199, 18.23230606917139, 19.091953525853828, 16.43902167852495, 22.212396672867982, 19.85084250067394, 20.015268847457012, 20.901168281859846, 20.023493696927385, 18.2592912599253, 20.840527870958912, 19.51470935112363, 21.179942045129557, 18.72494771518337, 19.095521454029214, 18.94579926093532, 18.988000733784904, 13.714556908996178, 20.772565069142164, 16.157055251561097, 18.47976490775199, 18.00787028776594, 20.692481527610447, 15.497010576640855, 20.072170866957283, 18.892833189039855, 18.740055022239606, 15.819645851371352, 20.07261562527922, 16.200297588149557, 18.866768155341493, 19.781388417174792, 20.91161154484317, 20.92062142649608, 18.26965524254187, 20.56443992170757, 20.227639056224966, 20.64097310309847, 18.8882487314081, 19.78480070161403, 18.86131028949858, 17.032803315037633, 15.53300334756394, 18.998075784397432, 21.13861964450679, 18.362940877021483, 17.210269728737252, 17.716187029110017, 15.315019144981106, 18.768950540965296, 18.03951067979407, 16.744007433764597, 20.313370751747374, 14.635461398362803, 21.73851729239483, 21.24882124859124, 19.70740875732947, 21.97743845712894, 19.161380709443947, 17.76357353452128, 20.067172249728227, 19.733540513238612, 19.81600546116962, 16.378104376247688], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.074302315105621, "mean_inference_ms": 8.129479265172407, "mean_action_processing_ms": 0.555970320793155, "mean_env_wait_ms": 23.855947893314834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025363683700561523, "StateBufferConnector_ms": 0.03272724151611328, "ViewRequirementAgentConnector_ms": 0.9422729015350342}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1997820, "num_agent_steps_trained": 1997820, "num_env_steps_sampled": 1997820, "num_env_steps_trained": 1997820, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.9620939917474, "num_env_steps_trained_throughput_per_sec": 282.9620939917474, "timesteps_total": 1997820, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1997820, "timers": {"training_iteration_time_ms": 55510.221, "sample_time_ms": 41738.009, "load_time_ms": 1794.393, "load_throughput": 8714.924, "learn_time_ms": 11412.49, "learn_throughput": 1370.253, "synch_weights_time_ms": 456.359}, "counters": {"num_env_steps_sampled": 1997820, "num_env_steps_trained": 1997820, "num_agent_steps_sampled": 1997820, "num_agent_steps_trained": 1997820}, "done": false, "episodes_total": 924, "training_iteration": 132, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-32-28", "timestamp": 1749245548, "time_this_iter_s": 55.28236937522888, "time_total_s": 3784.6477785110474, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3784.6477785110474, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 77.06666666666668, "ram_util_percent": 65.06349206349205, "gpu_util_percent0": 0.07746031746031747, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 8.00218e-05, "total_loss": -0.07799032668498429, "policy_loss": -0.018626454129374574, "vf_loss": 0.01593291016888212, "vf_explained_var": 0.8372412604635412, "kl": 0.01713184891456463, "entropy": 18.302811333049426, "entropy_coeff": 0.004004359999999999}, "model": {}, "num_grad_updates_lifetime": 36575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2013458, "num_env_steps_trained": 2013458, "num_agent_steps_sampled": 2013458, "num_agent_steps_trained": 2013458}, "sampler_results": {"episode_reward_max": 22.436372830546595, "episode_reward_min": 13.714556908996178, "episode_reward_mean": 18.806611618232346, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.32538433027812, 20.713732765457827, 18.43682353174899, 15.730531190606214, 21.452265370269238, 17.795441572590494, 18.116969150031462, 18.547927020673676, 18.590651412296644, 15.956816745701335, 19.31174901165023, 20.555630479160317, 18.46472207282492, 15.87897746396637, 17.637236621888853, 17.111994724538587, 19.12373876682147, 18.128063719794905, 18.872314294867294, 19.789138428760594, 20.889441764531274, 22.436372830546595, 21.96426479688199, 18.23230606917139, 19.091953525853828, 16.43902167852495, 22.212396672867982, 19.85084250067394, 20.015268847457012, 20.901168281859846, 20.023493696927385, 18.2592912599253, 20.840527870958912, 19.51470935112363, 21.179942045129557, 18.72494771518337, 19.095521454029214, 18.94579926093532, 18.988000733784904, 13.714556908996178, 20.772565069142164, 16.157055251561097, 18.47976490775199, 18.00787028776594, 20.692481527610447, 15.497010576640855, 20.072170866957283, 18.892833189039855, 18.740055022239606, 15.819645851371352, 20.07261562527922, 16.200297588149557, 18.866768155341493, 19.781388417174792, 20.91161154484317, 20.92062142649608, 18.26965524254187, 20.56443992170757, 20.227639056224966, 20.64097310309847, 18.8882487314081, 19.78480070161403, 18.86131028949858, 17.032803315037633, 15.53300334756394, 18.998075784397432, 21.13861964450679, 18.362940877021483, 17.210269728737252, 17.716187029110017, 15.315019144981106, 18.768950540965296, 18.03951067979407, 16.744007433764597, 20.313370751747374, 14.635461398362803, 21.73851729239483, 21.24882124859124, 19.70740875732947, 21.97743845712894, 19.161380709443947, 17.76357353452128, 20.067172249728227, 19.733540513238612, 19.81600546116962, 16.378104376247688, 18.461703110530127, 19.37749574366307, 17.7583549602996, 16.05501145311193, 19.329281213778614, 18.697170341584467, 19.088254476812445, 15.9932819115624, 18.17007579740579, 20.2506491072158, 16.516878703635516, 17.901191934121734, 19.83177603543359, 16.84809646554733], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0739300153668436, "mean_inference_ms": 8.130775054247913, "mean_action_processing_ms": 0.556075276470406, "mean_env_wait_ms": 23.857511514946992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02503657341003418, "StateBufferConnector_ms": 0.03372025489807129, "ViewRequirementAgentConnector_ms": 0.952735424041748}}, "episode_reward_max": 22.436372830546595, "episode_reward_min": 13.714556908996178, "episode_reward_mean": 18.806611618232346, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.32538433027812, 20.713732765457827, 18.43682353174899, 15.730531190606214, 21.452265370269238, 17.795441572590494, 18.116969150031462, 18.547927020673676, 18.590651412296644, 15.956816745701335, 19.31174901165023, 20.555630479160317, 18.46472207282492, 15.87897746396637, 17.637236621888853, 17.111994724538587, 19.12373876682147, 18.128063719794905, 18.872314294867294, 19.789138428760594, 20.889441764531274, 22.436372830546595, 21.96426479688199, 18.23230606917139, 19.091953525853828, 16.43902167852495, 22.212396672867982, 19.85084250067394, 20.015268847457012, 20.901168281859846, 20.023493696927385, 18.2592912599253, 20.840527870958912, 19.51470935112363, 21.179942045129557, 18.72494771518337, 19.095521454029214, 18.94579926093532, 18.988000733784904, 13.714556908996178, 20.772565069142164, 16.157055251561097, 18.47976490775199, 18.00787028776594, 20.692481527610447, 15.497010576640855, 20.072170866957283, 18.892833189039855, 18.740055022239606, 15.819645851371352, 20.07261562527922, 16.200297588149557, 18.866768155341493, 19.781388417174792, 20.91161154484317, 20.92062142649608, 18.26965524254187, 20.56443992170757, 20.227639056224966, 20.64097310309847, 18.8882487314081, 19.78480070161403, 18.86131028949858, 17.032803315037633, 15.53300334756394, 18.998075784397432, 21.13861964450679, 18.362940877021483, 17.210269728737252, 17.716187029110017, 15.315019144981106, 18.768950540965296, 18.03951067979407, 16.744007433764597, 20.313370751747374, 14.635461398362803, 21.73851729239483, 21.24882124859124, 19.70740875732947, 21.97743845712894, 19.161380709443947, 17.76357353452128, 20.067172249728227, 19.733540513238612, 19.81600546116962, 16.378104376247688, 18.461703110530127, 19.37749574366307, 17.7583549602996, 16.05501145311193, 19.329281213778614, 18.697170341584467, 19.088254476812445, 15.9932819115624, 18.17007579740579, 20.2506491072158, 16.516878703635516, 17.901191934121734, 19.83177603543359, 16.84809646554733], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0739300153668436, "mean_inference_ms": 8.130775054247913, "mean_action_processing_ms": 0.556075276470406, "mean_env_wait_ms": 23.857511514946992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02503657341003418, "StateBufferConnector_ms": 0.03372025489807129, "ViewRequirementAgentConnector_ms": 0.952735424041748}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2013458, "num_agent_steps_trained": 2013458, "num_env_steps_sampled": 2013458, "num_env_steps_trained": 2013458, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.0834622470979, "num_env_steps_trained_throughput_per_sec": 278.0834622470979, "timesteps_total": 2013458, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2013458, "timers": {"training_iteration_time_ms": 55558.94, "sample_time_ms": 41769.575, "load_time_ms": 1772.397, "load_throughput": 8823.081, "learn_time_ms": 11452.884, "learn_throughput": 1365.42, "synch_weights_time_ms": 456.005}, "counters": {"num_env_steps_sampled": 2013458, "num_env_steps_trained": 2013458, "num_agent_steps_sampled": 2013458, "num_agent_steps_trained": 2013458}, "done": false, "episodes_total": 938, "training_iteration": 133, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-33-24", "timestamp": 1749245604, "time_this_iter_s": 56.261701583862305, "time_total_s": 3840.9094800949097, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3840.9094800949097, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 75.88615384615383, "ram_util_percent": 65.1646153846154, "gpu_util_percent0": 0.07923076923076923, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.986542000000001e-05, "total_loss": -0.073491357029839, "policy_loss": -0.014336881880061067, "vf_loss": 0.014488327225500888, "vf_explained_var": 0.8526652853055434, "kl": 0.017695617033539085, "entropy": 18.360873296911066, "entropy_coeff": 0.003973084000000001}, "model": {}, "num_grad_updates_lifetime": 37125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2029096, "num_env_steps_trained": 2029096, "num_agent_steps_sampled": 2029096, "num_agent_steps_trained": 2029096}, "sampler_results": {"episode_reward_max": 22.436372830546595, "episode_reward_min": 13.714556908996178, "episode_reward_mean": 18.909016312293993, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.637236621888853, 17.111994724538587, 19.12373876682147, 18.128063719794905, 18.872314294867294, 19.789138428760594, 20.889441764531274, 22.436372830546595, 21.96426479688199, 18.23230606917139, 19.091953525853828, 16.43902167852495, 22.212396672867982, 19.85084250067394, 20.015268847457012, 20.901168281859846, 20.023493696927385, 18.2592912599253, 20.840527870958912, 19.51470935112363, 21.179942045129557, 18.72494771518337, 19.095521454029214, 18.94579926093532, 18.988000733784904, 13.714556908996178, 20.772565069142164, 16.157055251561097, 18.47976490775199, 18.00787028776594, 20.692481527610447, 15.497010576640855, 20.072170866957283, 18.892833189039855, 18.740055022239606, 15.819645851371352, 20.07261562527922, 16.200297588149557, 18.866768155341493, 19.781388417174792, 20.91161154484317, 20.92062142649608, 18.26965524254187, 20.56443992170757, 20.227639056224966, 20.64097310309847, 18.8882487314081, 19.78480070161403, 18.86131028949858, 17.032803315037633, 15.53300334756394, 18.998075784397432, 21.13861964450679, 18.362940877021483, 17.210269728737252, 17.716187029110017, 15.315019144981106, 18.768950540965296, 18.03951067979407, 16.744007433764597, 20.313370751747374, 14.635461398362803, 21.73851729239483, 21.24882124859124, 19.70740875732947, 21.97743845712894, 19.161380709443947, 17.76357353452128, 20.067172249728227, 19.733540513238612, 19.81600546116962, 16.378104376247688, 18.461703110530127, 19.37749574366307, 17.7583549602996, 16.05501145311193, 19.329281213778614, 18.697170341584467, 19.088254476812445, 15.9932819115624, 18.17007579740579, 20.2506491072158, 16.516878703635516, 17.901191934121734, 19.83177603543359, 16.84809646554733, 20.153878935319806, 18.664827173171563, 19.276069583819417, 21.581649862157594, 19.9772140446, 18.059149856013892, 18.567408618938565, 18.70171647700642, 19.615903364965348, 16.53745860143936, 18.682303655178206, 19.26688042496604, 19.958417442849033, 21.075213482995117], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0734517938280557, "mean_inference_ms": 8.131768882163872, "mean_action_processing_ms": 0.5561468602283529, "mean_env_wait_ms": 23.85829363052766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031068801879882812, "StateBufferConnector_ms": 0.03497815132141113, "ViewRequirementAgentConnector_ms": 0.940270185470581}}, "episode_reward_max": 22.436372830546595, "episode_reward_min": 13.714556908996178, "episode_reward_mean": 18.909016312293993, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.637236621888853, 17.111994724538587, 19.12373876682147, 18.128063719794905, 18.872314294867294, 19.789138428760594, 20.889441764531274, 22.436372830546595, 21.96426479688199, 18.23230606917139, 19.091953525853828, 16.43902167852495, 22.212396672867982, 19.85084250067394, 20.015268847457012, 20.901168281859846, 20.023493696927385, 18.2592912599253, 20.840527870958912, 19.51470935112363, 21.179942045129557, 18.72494771518337, 19.095521454029214, 18.94579926093532, 18.988000733784904, 13.714556908996178, 20.772565069142164, 16.157055251561097, 18.47976490775199, 18.00787028776594, 20.692481527610447, 15.497010576640855, 20.072170866957283, 18.892833189039855, 18.740055022239606, 15.819645851371352, 20.07261562527922, 16.200297588149557, 18.866768155341493, 19.781388417174792, 20.91161154484317, 20.92062142649608, 18.26965524254187, 20.56443992170757, 20.227639056224966, 20.64097310309847, 18.8882487314081, 19.78480070161403, 18.86131028949858, 17.032803315037633, 15.53300334756394, 18.998075784397432, 21.13861964450679, 18.362940877021483, 17.210269728737252, 17.716187029110017, 15.315019144981106, 18.768950540965296, 18.03951067979407, 16.744007433764597, 20.313370751747374, 14.635461398362803, 21.73851729239483, 21.24882124859124, 19.70740875732947, 21.97743845712894, 19.161380709443947, 17.76357353452128, 20.067172249728227, 19.733540513238612, 19.81600546116962, 16.378104376247688, 18.461703110530127, 19.37749574366307, 17.7583549602996, 16.05501145311193, 19.329281213778614, 18.697170341584467, 19.088254476812445, 15.9932819115624, 18.17007579740579, 20.2506491072158, 16.516878703635516, 17.901191934121734, 19.83177603543359, 16.84809646554733, 20.153878935319806, 18.664827173171563, 19.276069583819417, 21.581649862157594, 19.9772140446, 18.059149856013892, 18.567408618938565, 18.70171647700642, 19.615903364965348, 16.53745860143936, 18.682303655178206, 19.26688042496604, 19.958417442849033, 21.075213482995117], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0734517938280557, "mean_inference_ms": 8.131768882163872, "mean_action_processing_ms": 0.5561468602283529, "mean_env_wait_ms": 23.85829363052766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031068801879882812, "StateBufferConnector_ms": 0.03497815132141113, "ViewRequirementAgentConnector_ms": 0.940270185470581}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2029096, "num_agent_steps_trained": 2029096, "num_env_steps_sampled": 2029096, "num_env_steps_trained": 2029096, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.20001657906425, "num_env_steps_trained_throughput_per_sec": 282.20001657906425, "timesteps_total": 2029096, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2029096, "timers": {"training_iteration_time_ms": 55562.156, "sample_time_ms": 41745.684, "load_time_ms": 1791.347, "load_throughput": 8729.744, "learn_time_ms": 11461.831, "learn_throughput": 1364.354, "synch_weights_time_ms": 456.997}, "counters": {"num_env_steps_sampled": 2029096, "num_env_steps_trained": 2029096, "num_agent_steps_sampled": 2029096, "num_agent_steps_trained": 2029096}, "done": false, "episodes_total": 952, "training_iteration": 134, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-34-20", "timestamp": 1749245660, "time_this_iter_s": 55.44640874862671, "time_total_s": 3896.3558888435364, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3896.3558888435364, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 77.03015873015872, "ram_util_percent": 64.85555555555557, "gpu_util_percent0": 0.08190476190476191, "vram_util_percent0": 0.8592122395833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.970904000000001e-05, "total_loss": -0.07453655154698274, "policy_loss": -0.01484359138306569, "vf_loss": 0.01434215889566324, "vf_explained_var": 0.8503220768408342, "kl": 0.01610423518032555, "entropy": 18.4164817237854, "entropy_coeff": 0.003941807999999999}, "model": {}, "num_grad_updates_lifetime": 37675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2044734, "num_env_steps_trained": 2044734, "num_agent_steps_sampled": 2044734, "num_agent_steps_trained": 2044734}, "sampler_results": {"episode_reward_max": 21.97743845712894, "episode_reward_min": 13.714556908996178, "episode_reward_mean": 18.806801680398966, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.015268847457012, 20.901168281859846, 20.023493696927385, 18.2592912599253, 20.840527870958912, 19.51470935112363, 21.179942045129557, 18.72494771518337, 19.095521454029214, 18.94579926093532, 18.988000733784904, 13.714556908996178, 20.772565069142164, 16.157055251561097, 18.47976490775199, 18.00787028776594, 20.692481527610447, 15.497010576640855, 20.072170866957283, 18.892833189039855, 18.740055022239606, 15.819645851371352, 20.07261562527922, 16.200297588149557, 18.866768155341493, 19.781388417174792, 20.91161154484317, 20.92062142649608, 18.26965524254187, 20.56443992170757, 20.227639056224966, 20.64097310309847, 18.8882487314081, 19.78480070161403, 18.86131028949858, 17.032803315037633, 15.53300334756394, 18.998075784397432, 21.13861964450679, 18.362940877021483, 17.210269728737252, 17.716187029110017, 15.315019144981106, 18.768950540965296, 18.03951067979407, 16.744007433764597, 20.313370751747374, 14.635461398362803, 21.73851729239483, 21.24882124859124, 19.70740875732947, 21.97743845712894, 19.161380709443947, 17.76357353452128, 20.067172249728227, 19.733540513238612, 19.81600546116962, 16.378104376247688, 18.461703110530127, 19.37749574366307, 17.7583549602996, 16.05501145311193, 19.329281213778614, 18.697170341584467, 19.088254476812445, 15.9932819115624, 18.17007579740579, 20.2506491072158, 16.516878703635516, 17.901191934121734, 19.83177603543359, 16.84809646554733, 20.153878935319806, 18.664827173171563, 19.276069583819417, 21.581649862157594, 19.9772140446, 18.059149856013892, 18.567408618938565, 18.70171647700642, 19.615903364965348, 16.53745860143936, 18.682303655178206, 19.26688042496604, 19.958417442849033, 21.075213482995117, 20.731384699077335, 18.178929189139854, 18.335905459200898, 20.091400103328944, 17.292263871220573, 17.31801362190302, 19.27071577432151, 19.30652818752684, 19.29903309371599, 17.632071124835488, 17.546235643916496, 19.91341630322613, 18.353667002952818, 18.28805913185517], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0729310692912835, "mean_inference_ms": 8.133047733786006, "mean_action_processing_ms": 0.5562212507915607, "mean_env_wait_ms": 23.85941701746066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03406786918640137, "StateBufferConnector_ms": 0.03001570701599121, "ViewRequirementAgentConnector_ms": 0.963031530380249}}, "episode_reward_max": 21.97743845712894, "episode_reward_min": 13.714556908996178, "episode_reward_mean": 18.806801680398966, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.015268847457012, 20.901168281859846, 20.023493696927385, 18.2592912599253, 20.840527870958912, 19.51470935112363, 21.179942045129557, 18.72494771518337, 19.095521454029214, 18.94579926093532, 18.988000733784904, 13.714556908996178, 20.772565069142164, 16.157055251561097, 18.47976490775199, 18.00787028776594, 20.692481527610447, 15.497010576640855, 20.072170866957283, 18.892833189039855, 18.740055022239606, 15.819645851371352, 20.07261562527922, 16.200297588149557, 18.866768155341493, 19.781388417174792, 20.91161154484317, 20.92062142649608, 18.26965524254187, 20.56443992170757, 20.227639056224966, 20.64097310309847, 18.8882487314081, 19.78480070161403, 18.86131028949858, 17.032803315037633, 15.53300334756394, 18.998075784397432, 21.13861964450679, 18.362940877021483, 17.210269728737252, 17.716187029110017, 15.315019144981106, 18.768950540965296, 18.03951067979407, 16.744007433764597, 20.313370751747374, 14.635461398362803, 21.73851729239483, 21.24882124859124, 19.70740875732947, 21.97743845712894, 19.161380709443947, 17.76357353452128, 20.067172249728227, 19.733540513238612, 19.81600546116962, 16.378104376247688, 18.461703110530127, 19.37749574366307, 17.7583549602996, 16.05501145311193, 19.329281213778614, 18.697170341584467, 19.088254476812445, 15.9932819115624, 18.17007579740579, 20.2506491072158, 16.516878703635516, 17.901191934121734, 19.83177603543359, 16.84809646554733, 20.153878935319806, 18.664827173171563, 19.276069583819417, 21.581649862157594, 19.9772140446, 18.059149856013892, 18.567408618938565, 18.70171647700642, 19.615903364965348, 16.53745860143936, 18.682303655178206, 19.26688042496604, 19.958417442849033, 21.075213482995117, 20.731384699077335, 18.178929189139854, 18.335905459200898, 20.091400103328944, 17.292263871220573, 17.31801362190302, 19.27071577432151, 19.30652818752684, 19.29903309371599, 17.632071124835488, 17.546235643916496, 19.91341630322613, 18.353667002952818, 18.28805913185517], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0729310692912835, "mean_inference_ms": 8.133047733786006, "mean_action_processing_ms": 0.5562212507915607, "mean_env_wait_ms": 23.85941701746066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03406786918640137, "StateBufferConnector_ms": 0.03001570701599121, "ViewRequirementAgentConnector_ms": 0.963031530380249}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2044734, "num_agent_steps_trained": 2044734, "num_env_steps_sampled": 2044734, "num_env_steps_trained": 2044734, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 279.77694151537077, "num_env_steps_trained_throughput_per_sec": 279.77694151537077, "timesteps_total": 2044734, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2044734, "timers": {"training_iteration_time_ms": 55629.598, "sample_time_ms": 41795.474, "load_time_ms": 1776.974, "load_throughput": 8800.354, "learn_time_ms": 11493.104, "learn_throughput": 1360.642, "synch_weights_time_ms": 456.053}, "counters": {"num_env_steps_sampled": 2044734, "num_env_steps_trained": 2044734, "num_agent_steps_sampled": 2044734, "num_agent_steps_trained": 2044734}, "done": false, "episodes_total": 966, "training_iteration": 135, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-35-16", "timestamp": 1749245716, "time_this_iter_s": 55.91152787208557, "time_total_s": 3952.267416715622, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3952.267416715622, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 76.03999999999999, "ram_util_percent": 64.42615384615384, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.955266000000002e-05, "total_loss": -0.09237882667940787, "policy_loss": -0.033569256729679184, "vf_loss": 0.014797151746567, "vf_explained_var": 0.8485475154356523, "kl": 0.016558997865970405, "entropy": 18.434870435541328, "entropy_coeff": 0.003910532000000001}, "model": {}, "num_grad_updates_lifetime": 38225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2060372, "num_env_steps_trained": 2060372, "num_agent_steps_sampled": 2060372, "num_agent_steps_trained": 2060372}, "sampler_results": {"episode_reward_max": 21.97743845712894, "episode_reward_min": 14.635461398362803, "episode_reward_mean": 18.748247080367317, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.47976490775199, 18.00787028776594, 20.692481527610447, 15.497010576640855, 20.072170866957283, 18.892833189039855, 18.740055022239606, 15.819645851371352, 20.07261562527922, 16.200297588149557, 18.866768155341493, 19.781388417174792, 20.91161154484317, 20.92062142649608, 18.26965524254187, 20.56443992170757, 20.227639056224966, 20.64097310309847, 18.8882487314081, 19.78480070161403, 18.86131028949858, 17.032803315037633, 15.53300334756394, 18.998075784397432, 21.13861964450679, 18.362940877021483, 17.210269728737252, 17.716187029110017, 15.315019144981106, 18.768950540965296, 18.03951067979407, 16.744007433764597, 20.313370751747374, 14.635461398362803, 21.73851729239483, 21.24882124859124, 19.70740875732947, 21.97743845712894, 19.161380709443947, 17.76357353452128, 20.067172249728227, 19.733540513238612, 19.81600546116962, 16.378104376247688, 18.461703110530127, 19.37749574366307, 17.7583549602996, 16.05501145311193, 19.329281213778614, 18.697170341584467, 19.088254476812445, 15.9932819115624, 18.17007579740579, 20.2506491072158, 16.516878703635516, 17.901191934121734, 19.83177603543359, 16.84809646554733, 20.153878935319806, 18.664827173171563, 19.276069583819417, 21.581649862157594, 19.9772140446, 18.059149856013892, 18.567408618938565, 18.70171647700642, 19.615903364965348, 16.53745860143936, 18.682303655178206, 19.26688042496604, 19.958417442849033, 21.075213482995117, 20.731384699077335, 18.178929189139854, 18.335905459200898, 20.091400103328944, 17.292263871220573, 17.31801362190302, 19.27071577432151, 19.30652818752684, 19.29903309371599, 17.632071124835488, 17.546235643916496, 19.91341630322613, 18.353667002952818, 18.28805913185517, 17.41942932731893, 17.311261490297472, 19.433767074508093, 21.56900369847628, 19.759444302348115, 16.8543357823128, 18.796277407919202, 17.58848929860345, 18.925115852770652, 15.488211231969922, 20.257220872913987, 20.73707623174996, 17.356555359982828, 19.781199812677418], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0720022546175296, "mean_inference_ms": 8.134326608014568, "mean_action_processing_ms": 0.5563152860630494, "mean_env_wait_ms": 23.86056927238685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030000686645507812, "StateBufferConnector_ms": 0.0328364372253418, "ViewRequirementAgentConnector_ms": 0.9567632675170898}}, "episode_reward_max": 21.97743845712894, "episode_reward_min": 14.635461398362803, "episode_reward_mean": 18.748247080367317, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.47976490775199, 18.00787028776594, 20.692481527610447, 15.497010576640855, 20.072170866957283, 18.892833189039855, 18.740055022239606, 15.819645851371352, 20.07261562527922, 16.200297588149557, 18.866768155341493, 19.781388417174792, 20.91161154484317, 20.92062142649608, 18.26965524254187, 20.56443992170757, 20.227639056224966, 20.64097310309847, 18.8882487314081, 19.78480070161403, 18.86131028949858, 17.032803315037633, 15.53300334756394, 18.998075784397432, 21.13861964450679, 18.362940877021483, 17.210269728737252, 17.716187029110017, 15.315019144981106, 18.768950540965296, 18.03951067979407, 16.744007433764597, 20.313370751747374, 14.635461398362803, 21.73851729239483, 21.24882124859124, 19.70740875732947, 21.97743845712894, 19.161380709443947, 17.76357353452128, 20.067172249728227, 19.733540513238612, 19.81600546116962, 16.378104376247688, 18.461703110530127, 19.37749574366307, 17.7583549602996, 16.05501145311193, 19.329281213778614, 18.697170341584467, 19.088254476812445, 15.9932819115624, 18.17007579740579, 20.2506491072158, 16.516878703635516, 17.901191934121734, 19.83177603543359, 16.84809646554733, 20.153878935319806, 18.664827173171563, 19.276069583819417, 21.581649862157594, 19.9772140446, 18.059149856013892, 18.567408618938565, 18.70171647700642, 19.615903364965348, 16.53745860143936, 18.682303655178206, 19.26688042496604, 19.958417442849033, 21.075213482995117, 20.731384699077335, 18.178929189139854, 18.335905459200898, 20.091400103328944, 17.292263871220573, 17.31801362190302, 19.27071577432151, 19.30652818752684, 19.29903309371599, 17.632071124835488, 17.546235643916496, 19.91341630322613, 18.353667002952818, 18.28805913185517, 17.41942932731893, 17.311261490297472, 19.433767074508093, 21.56900369847628, 19.759444302348115, 16.8543357823128, 18.796277407919202, 17.58848929860345, 18.925115852770652, 15.488211231969922, 20.257220872913987, 20.73707623174996, 17.356555359982828, 19.781199812677418], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0720022546175296, "mean_inference_ms": 8.134326608014568, "mean_action_processing_ms": 0.5563152860630494, "mean_env_wait_ms": 23.86056927238685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030000686645507812, "StateBufferConnector_ms": 0.0328364372253418, "ViewRequirementAgentConnector_ms": 0.9567632675170898}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2060372, "num_agent_steps_trained": 2060372, "num_env_steps_sampled": 2060372, "num_env_steps_trained": 2060372, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 280.59791420353133, "num_env_steps_trained_throughput_per_sec": 280.59791420353133, "timesteps_total": 2060372, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2060372, "timers": {"training_iteration_time_ms": 55672.171, "sample_time_ms": 41783.994, "load_time_ms": 1795.567, "load_throughput": 8709.227, "learn_time_ms": 11525.524, "learn_throughput": 1356.815, "synch_weights_time_ms": 458.089}, "counters": {"num_env_steps_sampled": 2060372, "num_env_steps_trained": 2060372, "num_agent_steps_sampled": 2060372, "num_agent_steps_trained": 2060372}, "done": false, "episodes_total": 980, "training_iteration": 136, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-36-12", "timestamp": 1749245772, "time_this_iter_s": 55.746992349624634, "time_total_s": 4008.0144090652466, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4008.0144090652466, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 76.8203125, "ram_util_percent": 64.79375, "gpu_util_percent0": 0.08, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.939628000000002e-05, "total_loss": -0.08483045808632265, "policy_loss": -0.027170677862913262, "vf_loss": 0.015582284921441565, "vf_explained_var": 0.8721045044335451, "kl": 0.01696380631945556, "entropy": 18.40354030088945, "entropy_coeff": 0.0038792560000000006}, "model": {}, "num_grad_updates_lifetime": 38775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2076010, "num_env_steps_trained": 2076010, "num_agent_steps_sampled": 2076010, "num_agent_steps_trained": 2076010}, "sampler_results": {"episode_reward_max": 21.97743845712894, "episode_reward_min": 13.915476780898116, "episode_reward_mean": 18.73203218402668, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.26965524254187, 20.56443992170757, 20.227639056224966, 20.64097310309847, 18.8882487314081, 19.78480070161403, 18.86131028949858, 17.032803315037633, 15.53300334756394, 18.998075784397432, 21.13861964450679, 18.362940877021483, 17.210269728737252, 17.716187029110017, 15.315019144981106, 18.768950540965296, 18.03951067979407, 16.744007433764597, 20.313370751747374, 14.635461398362803, 21.73851729239483, 21.24882124859124, 19.70740875732947, 21.97743845712894, 19.161380709443947, 17.76357353452128, 20.067172249728227, 19.733540513238612, 19.81600546116962, 16.378104376247688, 18.461703110530127, 19.37749574366307, 17.7583549602996, 16.05501145311193, 19.329281213778614, 18.697170341584467, 19.088254476812445, 15.9932819115624, 18.17007579740579, 20.2506491072158, 16.516878703635516, 17.901191934121734, 19.83177603543359, 16.84809646554733, 20.153878935319806, 18.664827173171563, 19.276069583819417, 21.581649862157594, 19.9772140446, 18.059149856013892, 18.567408618938565, 18.70171647700642, 19.615903364965348, 16.53745860143936, 18.682303655178206, 19.26688042496604, 19.958417442849033, 21.075213482995117, 20.731384699077335, 18.178929189139854, 18.335905459200898, 20.091400103328944, 17.292263871220573, 17.31801362190302, 19.27071577432151, 19.30652818752684, 19.29903309371599, 17.632071124835488, 17.546235643916496, 19.91341630322613, 18.353667002952818, 18.28805913185517, 17.41942932731893, 17.311261490297472, 19.433767074508093, 21.56900369847628, 19.759444302348115, 16.8543357823128, 18.796277407919202, 17.58848929860345, 18.925115852770652, 15.488211231969922, 20.257220872913987, 20.73707623174996, 17.356555359982828, 19.781199812677418, 19.48056857257507, 15.663872157249076, 21.871413057379186, 21.536221622127993, 13.915476780898116, 20.94456921531368, 18.616279965449113, 21.69419732923665, 20.67569681596803, 19.15951611129069, 14.825644512582818, 19.635964207926712, 17.782370129413987, 15.531854875186923], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.070849653059617, "mean_inference_ms": 8.135684249119612, "mean_action_processing_ms": 0.556384739117225, "mean_env_wait_ms": 23.861335379105995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025909900665283203, "StateBufferConnector_ms": 0.03078627586364746, "ViewRequirementAgentConnector_ms": 0.930854082107544}}, "episode_reward_max": 21.97743845712894, "episode_reward_min": 13.915476780898116, "episode_reward_mean": 18.73203218402668, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.26965524254187, 20.56443992170757, 20.227639056224966, 20.64097310309847, 18.8882487314081, 19.78480070161403, 18.86131028949858, 17.032803315037633, 15.53300334756394, 18.998075784397432, 21.13861964450679, 18.362940877021483, 17.210269728737252, 17.716187029110017, 15.315019144981106, 18.768950540965296, 18.03951067979407, 16.744007433764597, 20.313370751747374, 14.635461398362803, 21.73851729239483, 21.24882124859124, 19.70740875732947, 21.97743845712894, 19.161380709443947, 17.76357353452128, 20.067172249728227, 19.733540513238612, 19.81600546116962, 16.378104376247688, 18.461703110530127, 19.37749574366307, 17.7583549602996, 16.05501145311193, 19.329281213778614, 18.697170341584467, 19.088254476812445, 15.9932819115624, 18.17007579740579, 20.2506491072158, 16.516878703635516, 17.901191934121734, 19.83177603543359, 16.84809646554733, 20.153878935319806, 18.664827173171563, 19.276069583819417, 21.581649862157594, 19.9772140446, 18.059149856013892, 18.567408618938565, 18.70171647700642, 19.615903364965348, 16.53745860143936, 18.682303655178206, 19.26688042496604, 19.958417442849033, 21.075213482995117, 20.731384699077335, 18.178929189139854, 18.335905459200898, 20.091400103328944, 17.292263871220573, 17.31801362190302, 19.27071577432151, 19.30652818752684, 19.29903309371599, 17.632071124835488, 17.546235643916496, 19.91341630322613, 18.353667002952818, 18.28805913185517, 17.41942932731893, 17.311261490297472, 19.433767074508093, 21.56900369847628, 19.759444302348115, 16.8543357823128, 18.796277407919202, 17.58848929860345, 18.925115852770652, 15.488211231969922, 20.257220872913987, 20.73707623174996, 17.356555359982828, 19.781199812677418, 19.48056857257507, 15.663872157249076, 21.871413057379186, 21.536221622127993, 13.915476780898116, 20.94456921531368, 18.616279965449113, 21.69419732923665, 20.67569681596803, 19.15951611129069, 14.825644512582818, 19.635964207926712, 17.782370129413987, 15.531854875186923], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.070849653059617, "mean_inference_ms": 8.135684249119612, "mean_action_processing_ms": 0.556384739117225, "mean_env_wait_ms": 23.861335379105995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025909900665283203, "StateBufferConnector_ms": 0.03078627586364746, "ViewRequirementAgentConnector_ms": 0.930854082107544}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2076010, "num_agent_steps_trained": 2076010, "num_env_steps_sampled": 2076010, "num_env_steps_trained": 2076010, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.4808506495096, "num_env_steps_trained_throughput_per_sec": 281.4808506495096, "timesteps_total": 2076010, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2076010, "timers": {"training_iteration_time_ms": 55669.608, "sample_time_ms": 41740.609, "load_time_ms": 1803.635, "load_throughput": 8670.266, "learn_time_ms": 11555.856, "learn_throughput": 1353.253, "synch_weights_time_ms": 462.674}, "counters": {"num_env_steps_sampled": 2076010, "num_env_steps_trained": 2076010, "num_agent_steps_sampled": 2076010, "num_agent_steps_trained": 2076010}, "done": false, "episodes_total": 994, "training_iteration": 137, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-37-07", "timestamp": 1749245827, "time_this_iter_s": 55.58830785751343, "time_total_s": 4063.60271692276, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4063.60271692276, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 75.80769230769229, "ram_util_percent": 64.78461538461538, "gpu_util_percent0": 0.08061538461538462, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.923990000000001e-05, "total_loss": -0.088269039477137, "policy_loss": -0.030436543660047888, "vf_loss": 0.015788668315772983, "vf_explained_var": 0.8684045815467835, "kl": 0.015654834685215002, "entropy": 18.43246862931685, "entropy_coeff": 0.0038479799999999995}, "model": {}, "num_grad_updates_lifetime": 39325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2091648, "num_env_steps_trained": 2091648, "num_agent_steps_sampled": 2091648, "num_agent_steps_trained": 2091648}, "sampler_results": {"episode_reward_max": 21.97743845712894, "episode_reward_min": 13.915476780898116, "episode_reward_mean": 18.746831961370837, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.315019144981106, 18.768950540965296, 18.03951067979407, 16.744007433764597, 20.313370751747374, 14.635461398362803, 21.73851729239483, 21.24882124859124, 19.70740875732947, 21.97743845712894, 19.161380709443947, 17.76357353452128, 20.067172249728227, 19.733540513238612, 19.81600546116962, 16.378104376247688, 18.461703110530127, 19.37749574366307, 17.7583549602996, 16.05501145311193, 19.329281213778614, 18.697170341584467, 19.088254476812445, 15.9932819115624, 18.17007579740579, 20.2506491072158, 16.516878703635516, 17.901191934121734, 19.83177603543359, 16.84809646554733, 20.153878935319806, 18.664827173171563, 19.276069583819417, 21.581649862157594, 19.9772140446, 18.059149856013892, 18.567408618938565, 18.70171647700642, 19.615903364965348, 16.53745860143936, 18.682303655178206, 19.26688042496604, 19.958417442849033, 21.075213482995117, 20.731384699077335, 18.178929189139854, 18.335905459200898, 20.091400103328944, 17.292263871220573, 17.31801362190302, 19.27071577432151, 19.30652818752684, 19.29903309371599, 17.632071124835488, 17.546235643916496, 19.91341630322613, 18.353667002952818, 18.28805913185517, 17.41942932731893, 17.311261490297472, 19.433767074508093, 21.56900369847628, 19.759444302348115, 16.8543357823128, 18.796277407919202, 17.58848929860345, 18.925115852770652, 15.488211231969922, 20.257220872913987, 20.73707623174996, 17.356555359982828, 19.781199812677418, 19.48056857257507, 15.663872157249076, 21.871413057379186, 21.536221622127993, 13.915476780898116, 20.94456921531368, 18.616279965449113, 21.69419732923665, 20.67569681596803, 19.15951611129069, 14.825644512582818, 19.635964207926712, 17.782370129413987, 15.531854875186923, 17.584499218504774, 17.30451244501255, 16.255900985316377, 17.306757237481666, 19.898209357109828, 20.22170367683738, 19.5585719568726, 20.17111173314629, 20.5030459666726, 18.059563794784683, 18.587642291142686, 20.460417471067853, 18.988361788083775, 19.80864658485082], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.069578565534862, "mean_inference_ms": 8.136734821981696, "mean_action_processing_ms": 0.5564592397239284, "mean_env_wait_ms": 23.861670686717627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021953821182250977, "StateBufferConnector_ms": 0.030880212783813477, "ViewRequirementAgentConnector_ms": 0.9242274761199951}}, "episode_reward_max": 21.97743845712894, "episode_reward_min": 13.915476780898116, "episode_reward_mean": 18.746831961370837, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.315019144981106, 18.768950540965296, 18.03951067979407, 16.744007433764597, 20.313370751747374, 14.635461398362803, 21.73851729239483, 21.24882124859124, 19.70740875732947, 21.97743845712894, 19.161380709443947, 17.76357353452128, 20.067172249728227, 19.733540513238612, 19.81600546116962, 16.378104376247688, 18.461703110530127, 19.37749574366307, 17.7583549602996, 16.05501145311193, 19.329281213778614, 18.697170341584467, 19.088254476812445, 15.9932819115624, 18.17007579740579, 20.2506491072158, 16.516878703635516, 17.901191934121734, 19.83177603543359, 16.84809646554733, 20.153878935319806, 18.664827173171563, 19.276069583819417, 21.581649862157594, 19.9772140446, 18.059149856013892, 18.567408618938565, 18.70171647700642, 19.615903364965348, 16.53745860143936, 18.682303655178206, 19.26688042496604, 19.958417442849033, 21.075213482995117, 20.731384699077335, 18.178929189139854, 18.335905459200898, 20.091400103328944, 17.292263871220573, 17.31801362190302, 19.27071577432151, 19.30652818752684, 19.29903309371599, 17.632071124835488, 17.546235643916496, 19.91341630322613, 18.353667002952818, 18.28805913185517, 17.41942932731893, 17.311261490297472, 19.433767074508093, 21.56900369847628, 19.759444302348115, 16.8543357823128, 18.796277407919202, 17.58848929860345, 18.925115852770652, 15.488211231969922, 20.257220872913987, 20.73707623174996, 17.356555359982828, 19.781199812677418, 19.48056857257507, 15.663872157249076, 21.871413057379186, 21.536221622127993, 13.915476780898116, 20.94456921531368, 18.616279965449113, 21.69419732923665, 20.67569681596803, 19.15951611129069, 14.825644512582818, 19.635964207926712, 17.782370129413987, 15.531854875186923, 17.584499218504774, 17.30451244501255, 16.255900985316377, 17.306757237481666, 19.898209357109828, 20.22170367683738, 19.5585719568726, 20.17111173314629, 20.5030459666726, 18.059563794784683, 18.587642291142686, 20.460417471067853, 18.988361788083775, 19.80864658485082], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.069578565534862, "mean_inference_ms": 8.136734821981696, "mean_action_processing_ms": 0.5564592397239284, "mean_env_wait_ms": 23.861670686717627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021953821182250977, "StateBufferConnector_ms": 0.030880212783813477, "ViewRequirementAgentConnector_ms": 0.9242274761199951}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2091648, "num_agent_steps_trained": 2091648, "num_env_steps_sampled": 2091648, "num_env_steps_trained": 2091648, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.1009774799894, "num_env_steps_trained_throughput_per_sec": 281.1009774799894, "timesteps_total": 2091648, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2091648, "timers": {"training_iteration_time_ms": 55696.045, "sample_time_ms": 41769.235, "load_time_ms": 1804.447, "load_throughput": 8666.368, "learn_time_ms": 11578.26, "learn_throughput": 1350.635, "synch_weights_time_ms": 435.875}, "counters": {"num_env_steps_sampled": 2091648, "num_env_steps_trained": 2091648, "num_agent_steps_sampled": 2091648, "num_agent_steps_trained": 2091648}, "done": false, "episodes_total": 1008, "training_iteration": 138, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-38-03", "timestamp": 1749245883, "time_this_iter_s": 55.65112376213074, "time_total_s": 4119.253840684891, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4119.253840684891, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 76.20625000000001, "ram_util_percent": 64.728125, "gpu_util_percent0": 0.08234375, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.908352000000002e-05, "total_loss": -0.0896762399350039, "policy_loss": -0.03268058186264666, "vf_loss": 0.015232158800248396, "vf_explained_var": 0.8447272235696967, "kl": 0.016682535736422414, "entropy": 18.464283383109354, "entropy_coeff": 0.0038167040000000006}, "model": {}, "num_grad_updates_lifetime": 39875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2107286, "num_env_steps_trained": 2107286, "num_agent_steps_sampled": 2107286, "num_agent_steps_trained": 2107286}, "sampler_results": {"episode_reward_max": 21.871413057379186, "episode_reward_min": 13.915476780898116, "episode_reward_mean": 18.65800509856381, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.81600546116962, 16.378104376247688, 18.461703110530127, 19.37749574366307, 17.7583549602996, 16.05501145311193, 19.329281213778614, 18.697170341584467, 19.088254476812445, 15.9932819115624, 18.17007579740579, 20.2506491072158, 16.516878703635516, 17.901191934121734, 19.83177603543359, 16.84809646554733, 20.153878935319806, 18.664827173171563, 19.276069583819417, 21.581649862157594, 19.9772140446, 18.059149856013892, 18.567408618938565, 18.70171647700642, 19.615903364965348, 16.53745860143936, 18.682303655178206, 19.26688042496604, 19.958417442849033, 21.075213482995117, 20.731384699077335, 18.178929189139854, 18.335905459200898, 20.091400103328944, 17.292263871220573, 17.31801362190302, 19.27071577432151, 19.30652818752684, 19.29903309371599, 17.632071124835488, 17.546235643916496, 19.91341630322613, 18.353667002952818, 18.28805913185517, 17.41942932731893, 17.311261490297472, 19.433767074508093, 21.56900369847628, 19.759444302348115, 16.8543357823128, 18.796277407919202, 17.58848929860345, 18.925115852770652, 15.488211231969922, 20.257220872913987, 20.73707623174996, 17.356555359982828, 19.781199812677418, 19.48056857257507, 15.663872157249076, 21.871413057379186, 21.536221622127993, 13.915476780898116, 20.94456921531368, 18.616279965449113, 21.69419732923665, 20.67569681596803, 19.15951611129069, 14.825644512582818, 19.635964207926712, 17.782370129413987, 15.531854875186923, 17.584499218504774, 17.30451244501255, 16.255900985316377, 17.306757237481666, 19.898209357109828, 20.22170367683738, 19.5585719568726, 20.17111173314629, 20.5030459666726, 18.059563794784683, 18.587642291142686, 20.460417471067853, 18.988361788083775, 19.80864658485082, 20.183729429029846, 18.580510165635516, 19.79104990740453, 15.888656325468581, 18.52294080540354, 18.19274690259358, 16.972937134974597, 18.43056907680342, 21.30902789139881, 18.074069765101452, 17.556904032372387, 17.907446314534003, 19.196327570168357, 15.72457111040034], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0683556720572676, "mean_inference_ms": 8.138023917330223, "mean_action_processing_ms": 0.5565123253855018, "mean_env_wait_ms": 23.862804298528605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022692203521728516, "StateBufferConnector_ms": 0.02693462371826172, "ViewRequirementAgentConnector_ms": 0.8771934509277344}}, "episode_reward_max": 21.871413057379186, "episode_reward_min": 13.915476780898116, "episode_reward_mean": 18.65800509856381, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.81600546116962, 16.378104376247688, 18.461703110530127, 19.37749574366307, 17.7583549602996, 16.05501145311193, 19.329281213778614, 18.697170341584467, 19.088254476812445, 15.9932819115624, 18.17007579740579, 20.2506491072158, 16.516878703635516, 17.901191934121734, 19.83177603543359, 16.84809646554733, 20.153878935319806, 18.664827173171563, 19.276069583819417, 21.581649862157594, 19.9772140446, 18.059149856013892, 18.567408618938565, 18.70171647700642, 19.615903364965348, 16.53745860143936, 18.682303655178206, 19.26688042496604, 19.958417442849033, 21.075213482995117, 20.731384699077335, 18.178929189139854, 18.335905459200898, 20.091400103328944, 17.292263871220573, 17.31801362190302, 19.27071577432151, 19.30652818752684, 19.29903309371599, 17.632071124835488, 17.546235643916496, 19.91341630322613, 18.353667002952818, 18.28805913185517, 17.41942932731893, 17.311261490297472, 19.433767074508093, 21.56900369847628, 19.759444302348115, 16.8543357823128, 18.796277407919202, 17.58848929860345, 18.925115852770652, 15.488211231969922, 20.257220872913987, 20.73707623174996, 17.356555359982828, 19.781199812677418, 19.48056857257507, 15.663872157249076, 21.871413057379186, 21.536221622127993, 13.915476780898116, 20.94456921531368, 18.616279965449113, 21.69419732923665, 20.67569681596803, 19.15951611129069, 14.825644512582818, 19.635964207926712, 17.782370129413987, 15.531854875186923, 17.584499218504774, 17.30451244501255, 16.255900985316377, 17.306757237481666, 19.898209357109828, 20.22170367683738, 19.5585719568726, 20.17111173314629, 20.5030459666726, 18.059563794784683, 18.587642291142686, 20.460417471067853, 18.988361788083775, 19.80864658485082, 20.183729429029846, 18.580510165635516, 19.79104990740453, 15.888656325468581, 18.52294080540354, 18.19274690259358, 16.972937134974597, 18.43056907680342, 21.30902789139881, 18.074069765101452, 17.556904032372387, 17.907446314534003, 19.196327570168357, 15.72457111040034], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0683556720572676, "mean_inference_ms": 8.138023917330223, "mean_action_processing_ms": 0.5565123253855018, "mean_env_wait_ms": 23.862804298528605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022692203521728516, "StateBufferConnector_ms": 0.02693462371826172, "ViewRequirementAgentConnector_ms": 0.8771934509277344}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2107286, "num_agent_steps_trained": 2107286, "num_env_steps_sampled": 2107286, "num_env_steps_trained": 2107286, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 277.9904288226303, "num_env_steps_trained_throughput_per_sec": 277.9904288226303, "timesteps_total": 2107286, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2107286, "timers": {"training_iteration_time_ms": 55781.993, "sample_time_ms": 41833.504, "load_time_ms": 1807.714, "load_throughput": 8650.704, "learn_time_ms": 11596.016, "learn_throughput": 1348.567, "synch_weights_time_ms": 433.455}, "counters": {"num_env_steps_sampled": 2107286, "num_env_steps_trained": 2107286, "num_agent_steps_sampled": 2107286, "num_agent_steps_trained": 2107286}, "done": false, "episodes_total": 1022, "training_iteration": 139, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-38-59", "timestamp": 1749245939, "time_this_iter_s": 56.269495725631714, "time_total_s": 4175.5233364105225, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4175.5233364105225, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 76.1969696969697, "ram_util_percent": 64.98939393939395, "gpu_util_percent0": 0.0771212121212121, "vram_util_percent0": 0.8592122395833334}}
{"evaluation": {"sampler_results": {"episode_reward_max": 2.4748711885314023, "episode_reward_min": -8.688711652952257, "episode_reward_mean": -2.44778381468707, "episode_len_mean": 169.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.32827084984700483, -8.688711652952257, 2.4748711885314023, -2.094740049588862, -4.258609409272639], "episode_lengths": [184, 109, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6127477921269406, "mean_inference_ms": 3.7316309368417313, "mean_action_processing_ms": 0.2952134776108873, "mean_env_wait_ms": 11.811108730535013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.33245086669921875}}, "episode_reward_max": 2.4748711885314023, "episode_reward_min": -8.688711652952257, "episode_reward_mean": -2.44778381468707, "episode_len_mean": 169.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.32827084984700483, -8.688711652952257, 2.4748711885314023, -2.094740049588862, -4.258609409272639], "episode_lengths": [184, 109, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6127477921269406, "mean_inference_ms": 3.7316309368417313, "mean_action_processing_ms": 0.2952134776108873, "mean_env_wait_ms": 11.811108730535013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.33245086669921875}, "num_agent_steps_sampled_this_iter": 845, "num_env_steps_sampled_this_iter": 845, "timesteps_this_iter": 845, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.892714000000001e-05, "total_loss": -0.07747918727977032, "policy_loss": -0.02128762838285018, "vf_loss": 0.01528667742217129, "vf_explained_var": 0.848013802875172, "kl": 0.016286305878843894, "entropy": 18.352852944460782, "entropy_coeff": 0.0037854279999999995}, "model": {}, "num_grad_updates_lifetime": 40425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2122924, "num_env_steps_trained": 2122924, "num_agent_steps_sampled": 2122924, "num_agent_steps_trained": 2122924}, "sampler_results": {"episode_reward_max": 21.871413057379186, "episode_reward_min": 13.915476780898116, "episode_reward_mean": 18.72452887294873, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.83177603543359, 16.84809646554733, 20.153878935319806, 18.664827173171563, 19.276069583819417, 21.581649862157594, 19.9772140446, 18.059149856013892, 18.567408618938565, 18.70171647700642, 19.615903364965348, 16.53745860143936, 18.682303655178206, 19.26688042496604, 19.958417442849033, 21.075213482995117, 20.731384699077335, 18.178929189139854, 18.335905459200898, 20.091400103328944, 17.292263871220573, 17.31801362190302, 19.27071577432151, 19.30652818752684, 19.29903309371599, 17.632071124835488, 17.546235643916496, 19.91341630322613, 18.353667002952818, 18.28805913185517, 17.41942932731893, 17.311261490297472, 19.433767074508093, 21.56900369847628, 19.759444302348115, 16.8543357823128, 18.796277407919202, 17.58848929860345, 18.925115852770652, 15.488211231969922, 20.257220872913987, 20.73707623174996, 17.356555359982828, 19.781199812677418, 19.48056857257507, 15.663872157249076, 21.871413057379186, 21.536221622127993, 13.915476780898116, 20.94456921531368, 18.616279965449113, 21.69419732923665, 20.67569681596803, 19.15951611129069, 14.825644512582818, 19.635964207926712, 17.782370129413987, 15.531854875186923, 17.584499218504774, 17.30451244501255, 16.255900985316377, 17.306757237481666, 19.898209357109828, 20.22170367683738, 19.5585719568726, 20.17111173314629, 20.5030459666726, 18.059563794784683, 18.587642291142686, 20.460417471067853, 18.988361788083775, 19.80864658485082, 20.183729429029846, 18.580510165635516, 19.79104990740453, 15.888656325468581, 18.52294080540354, 18.19274690259358, 16.972937134974597, 18.43056907680342, 21.30902789139881, 18.074069765101452, 17.556904032372387, 17.907446314534003, 19.196327570168357, 15.72457111040034, 18.008870307512392, 18.172254059502606, 18.49218289585599, 20.03343194999572, 18.367975091487196, 18.639279221689264, 18.033911421683616, 19.566611751769763, 18.200578923103464, 19.201399294140746, 19.32705537037468, 17.66953919395259, 18.443276523381694, 18.28947002518087], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.067507588690934, "mean_inference_ms": 8.139783637302713, "mean_action_processing_ms": 0.5565702426631026, "mean_env_wait_ms": 23.864079887911835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024127960205078125, "StateBufferConnector_ms": 0.02295207977294922, "ViewRequirementAgentConnector_ms": 0.864891529083252}}, "episode_reward_max": 21.871413057379186, "episode_reward_min": 13.915476780898116, "episode_reward_mean": 18.72452887294873, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.83177603543359, 16.84809646554733, 20.153878935319806, 18.664827173171563, 19.276069583819417, 21.581649862157594, 19.9772140446, 18.059149856013892, 18.567408618938565, 18.70171647700642, 19.615903364965348, 16.53745860143936, 18.682303655178206, 19.26688042496604, 19.958417442849033, 21.075213482995117, 20.731384699077335, 18.178929189139854, 18.335905459200898, 20.091400103328944, 17.292263871220573, 17.31801362190302, 19.27071577432151, 19.30652818752684, 19.29903309371599, 17.632071124835488, 17.546235643916496, 19.91341630322613, 18.353667002952818, 18.28805913185517, 17.41942932731893, 17.311261490297472, 19.433767074508093, 21.56900369847628, 19.759444302348115, 16.8543357823128, 18.796277407919202, 17.58848929860345, 18.925115852770652, 15.488211231969922, 20.257220872913987, 20.73707623174996, 17.356555359982828, 19.781199812677418, 19.48056857257507, 15.663872157249076, 21.871413057379186, 21.536221622127993, 13.915476780898116, 20.94456921531368, 18.616279965449113, 21.69419732923665, 20.67569681596803, 19.15951611129069, 14.825644512582818, 19.635964207926712, 17.782370129413987, 15.531854875186923, 17.584499218504774, 17.30451244501255, 16.255900985316377, 17.306757237481666, 19.898209357109828, 20.22170367683738, 19.5585719568726, 20.17111173314629, 20.5030459666726, 18.059563794784683, 18.587642291142686, 20.460417471067853, 18.988361788083775, 19.80864658485082, 20.183729429029846, 18.580510165635516, 19.79104990740453, 15.888656325468581, 18.52294080540354, 18.19274690259358, 16.972937134974597, 18.43056907680342, 21.30902789139881, 18.074069765101452, 17.556904032372387, 17.907446314534003, 19.196327570168357, 15.72457111040034, 18.008870307512392, 18.172254059502606, 18.49218289585599, 20.03343194999572, 18.367975091487196, 18.639279221689264, 18.033911421683616, 19.566611751769763, 18.200578923103464, 19.201399294140746, 19.32705537037468, 17.66953919395259, 18.443276523381694, 18.28947002518087], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.067507588690934, "mean_inference_ms": 8.139783637302713, "mean_action_processing_ms": 0.5565702426631026, "mean_env_wait_ms": 23.864079887911835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024127960205078125, "StateBufferConnector_ms": 0.02295207977294922, "ViewRequirementAgentConnector_ms": 0.864891529083252}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2122924, "num_agent_steps_trained": 2122924, "num_env_steps_sampled": 2122924, "num_env_steps_trained": 2122924, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.0869686002137, "num_env_steps_trained_throughput_per_sec": 278.0869686002137, "timesteps_total": 2122924, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2122924, "timers": {"training_iteration_time_ms": 55830.847, "sample_time_ms": 41901.03, "load_time_ms": 1801.073, "load_throughput": 8682.601, "learn_time_ms": 11584.949, "learn_throughput": 1349.855, "synch_weights_time_ms": 431.004}, "counters": {"num_env_steps_sampled": 2122924, "num_env_steps_trained": 2122924, "num_agent_steps_sampled": 2122924, "num_agent_steps_trained": 2122924}, "done": false, "episodes_total": 1036, "training_iteration": 140, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-40-11", "timestamp": 1749246011, "time_this_iter_s": 71.56689190864563, "time_total_s": 4247.090228319168, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4247.090228319168, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 64.14166666666668, "ram_util_percent": 64.60476190476192, "gpu_util_percent0": 0.06714285714285714, "vram_util_percent0": 0.859212239583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.877076000000002e-05, "total_loss": -0.07788254084531218, "policy_loss": -0.02223024241494634, "vf_loss": 0.015668292484161527, "vf_explained_var": 0.8266904035481539, "kl": 0.0162033457055563, "entropy": 18.380803262537174, "entropy_coeff": 0.003754152}, "model": {}, "num_grad_updates_lifetime": 40975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2138562, "num_env_steps_trained": 2138562, "num_agent_steps_sampled": 2138562, "num_agent_steps_trained": 2138562}, "sampler_results": {"episode_reward_max": 21.871413057379186, "episode_reward_min": 13.915476780898116, "episode_reward_mean": 18.55228978790546, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.958417442849033, 21.075213482995117, 20.731384699077335, 18.178929189139854, 18.335905459200898, 20.091400103328944, 17.292263871220573, 17.31801362190302, 19.27071577432151, 19.30652818752684, 19.29903309371599, 17.632071124835488, 17.546235643916496, 19.91341630322613, 18.353667002952818, 18.28805913185517, 17.41942932731893, 17.311261490297472, 19.433767074508093, 21.56900369847628, 19.759444302348115, 16.8543357823128, 18.796277407919202, 17.58848929860345, 18.925115852770652, 15.488211231969922, 20.257220872913987, 20.73707623174996, 17.356555359982828, 19.781199812677418, 19.48056857257507, 15.663872157249076, 21.871413057379186, 21.536221622127993, 13.915476780898116, 20.94456921531368, 18.616279965449113, 21.69419732923665, 20.67569681596803, 19.15951611129069, 14.825644512582818, 19.635964207926712, 17.782370129413987, 15.531854875186923, 17.584499218504774, 17.30451244501255, 16.255900985316377, 17.306757237481666, 19.898209357109828, 20.22170367683738, 19.5585719568726, 20.17111173314629, 20.5030459666726, 18.059563794784683, 18.587642291142686, 20.460417471067853, 18.988361788083775, 19.80864658485082, 20.183729429029846, 18.580510165635516, 19.79104990740453, 15.888656325468581, 18.52294080540354, 18.19274690259358, 16.972937134974597, 18.43056907680342, 21.30902789139881, 18.074069765101452, 17.556904032372387, 17.907446314534003, 19.196327570168357, 15.72457111040034, 18.008870307512392, 18.172254059502606, 18.49218289585599, 20.03343194999572, 18.367975091487196, 18.639279221689264, 18.033911421683616, 19.566611751769763, 18.200578923103464, 19.201399294140746, 19.32705537037468, 17.66953919395259, 18.443276523381694, 18.28947002518087, 17.04245340948447, 16.05574981969266, 17.279376789785776, 15.452821088144574, 19.24927655008475, 20.934965074924637, 18.816295117576725, 19.60186424133482, 17.07192986953112, 16.811453077494125, 17.846127844949205, 16.962851395059268, 19.977074477915874, 15.438185838251885], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0667468332699097, "mean_inference_ms": 8.141534778034805, "mean_action_processing_ms": 0.55665375466389, "mean_env_wait_ms": 23.865388593022598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020099163055419922, "StateBufferConnector_ms": 0.02062678337097168, "ViewRequirementAgentConnector_ms": 0.8779404163360596}}, "episode_reward_max": 21.871413057379186, "episode_reward_min": 13.915476780898116, "episode_reward_mean": 18.55228978790546, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.958417442849033, 21.075213482995117, 20.731384699077335, 18.178929189139854, 18.335905459200898, 20.091400103328944, 17.292263871220573, 17.31801362190302, 19.27071577432151, 19.30652818752684, 19.29903309371599, 17.632071124835488, 17.546235643916496, 19.91341630322613, 18.353667002952818, 18.28805913185517, 17.41942932731893, 17.311261490297472, 19.433767074508093, 21.56900369847628, 19.759444302348115, 16.8543357823128, 18.796277407919202, 17.58848929860345, 18.925115852770652, 15.488211231969922, 20.257220872913987, 20.73707623174996, 17.356555359982828, 19.781199812677418, 19.48056857257507, 15.663872157249076, 21.871413057379186, 21.536221622127993, 13.915476780898116, 20.94456921531368, 18.616279965449113, 21.69419732923665, 20.67569681596803, 19.15951611129069, 14.825644512582818, 19.635964207926712, 17.782370129413987, 15.531854875186923, 17.584499218504774, 17.30451244501255, 16.255900985316377, 17.306757237481666, 19.898209357109828, 20.22170367683738, 19.5585719568726, 20.17111173314629, 20.5030459666726, 18.059563794784683, 18.587642291142686, 20.460417471067853, 18.988361788083775, 19.80864658485082, 20.183729429029846, 18.580510165635516, 19.79104990740453, 15.888656325468581, 18.52294080540354, 18.19274690259358, 16.972937134974597, 18.43056907680342, 21.30902789139881, 18.074069765101452, 17.556904032372387, 17.907446314534003, 19.196327570168357, 15.72457111040034, 18.008870307512392, 18.172254059502606, 18.49218289585599, 20.03343194999572, 18.367975091487196, 18.639279221689264, 18.033911421683616, 19.566611751769763, 18.200578923103464, 19.201399294140746, 19.32705537037468, 17.66953919395259, 18.443276523381694, 18.28947002518087, 17.04245340948447, 16.05574981969266, 17.279376789785776, 15.452821088144574, 19.24927655008475, 20.934965074924637, 18.816295117576725, 19.60186424133482, 17.07192986953112, 16.811453077494125, 17.846127844949205, 16.962851395059268, 19.977074477915874, 15.438185838251885], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0667468332699097, "mean_inference_ms": 8.141534778034805, "mean_action_processing_ms": 0.55665375466389, "mean_env_wait_ms": 23.865388593022598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020099163055419922, "StateBufferConnector_ms": 0.02062678337097168, "ViewRequirementAgentConnector_ms": 0.8779404163360596}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2138562, "num_agent_steps_trained": 2138562, "num_env_steps_sampled": 2138562, "num_env_steps_trained": 2138562, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.88897966317126, "num_env_steps_trained_throughput_per_sec": 282.88897966317126, "timesteps_total": 2138562, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2138562, "timers": {"training_iteration_time_ms": 55749.539, "sample_time_ms": 41805.077, "load_time_ms": 1802.35, "load_throughput": 8676.452, "learn_time_ms": 11599.724, "learn_throughput": 1348.136, "synch_weights_time_ms": 428.95}, "counters": {"num_env_steps_sampled": 2138562, "num_env_steps_trained": 2138562, "num_agent_steps_sampled": 2138562, "num_agent_steps_trained": 2138562}, "done": false, "episodes_total": 1050, "training_iteration": 141, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-41-06", "timestamp": 1749246066, "time_this_iter_s": 55.31159067153931, "time_total_s": 4302.401818990707, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4302.401818990707, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 76.66250000000001, "ram_util_percent": 65.18437500000002, "gpu_util_percent0": 0.0771875, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.861437999999999e-05, "total_loss": -0.0889533898390999, "policy_loss": -0.03387503188113029, "vf_loss": 0.016386004280806943, "vf_explained_var": 0.8152496653253382, "kl": 0.0161457131883489, "entropy": 18.430624363639136, "entropy_coeff": 0.0037228759999999995}, "model": {}, "num_grad_updates_lifetime": 41525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2154200, "num_env_steps_trained": 2154200, "num_agent_steps_sampled": 2154200, "num_agent_steps_trained": 2154200}, "sampler_results": {"episode_reward_max": 21.871413057379186, "episode_reward_min": 13.915476780898116, "episode_reward_mean": 18.43666925683373, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.353667002952818, 18.28805913185517, 17.41942932731893, 17.311261490297472, 19.433767074508093, 21.56900369847628, 19.759444302348115, 16.8543357823128, 18.796277407919202, 17.58848929860345, 18.925115852770652, 15.488211231969922, 20.257220872913987, 20.73707623174996, 17.356555359982828, 19.781199812677418, 19.48056857257507, 15.663872157249076, 21.871413057379186, 21.536221622127993, 13.915476780898116, 20.94456921531368, 18.616279965449113, 21.69419732923665, 20.67569681596803, 19.15951611129069, 14.825644512582818, 19.635964207926712, 17.782370129413987, 15.531854875186923, 17.584499218504774, 17.30451244501255, 16.255900985316377, 17.306757237481666, 19.898209357109828, 20.22170367683738, 19.5585719568726, 20.17111173314629, 20.5030459666726, 18.059563794784683, 18.587642291142686, 20.460417471067853, 18.988361788083775, 19.80864658485082, 20.183729429029846, 18.580510165635516, 19.79104990740453, 15.888656325468581, 18.52294080540354, 18.19274690259358, 16.972937134974597, 18.43056907680342, 21.30902789139881, 18.074069765101452, 17.556904032372387, 17.907446314534003, 19.196327570168357, 15.72457111040034, 18.008870307512392, 18.172254059502606, 18.49218289585599, 20.03343194999572, 18.367975091487196, 18.639279221689264, 18.033911421683616, 19.566611751769763, 18.200578923103464, 19.201399294140746, 19.32705537037468, 17.66953919395259, 18.443276523381694, 18.28947002518087, 17.04245340948447, 16.05574981969266, 17.279376789785776, 15.452821088144574, 19.24927655008475, 20.934965074924637, 18.816295117576725, 19.60186424133482, 17.07192986953112, 16.811453077494125, 17.846127844949205, 16.962851395059268, 19.977074477915874, 15.438185838251885, 17.059068745796797, 16.679273366057075, 18.349182786769017, 17.358435312391048, 17.60628759378367, 18.81530903703594, 18.484479396049153, 17.648017177449738, 21.400279993920737, 19.96436857313594, 18.111558105115034, 20.29711940877173, 14.581702977001024, 18.03239241680793], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.066068832585691, "mean_inference_ms": 8.143222180574435, "mean_action_processing_ms": 0.5567641187326293, "mean_env_wait_ms": 23.866946584294684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018100738525390625, "StateBufferConnector_ms": 0.019682884216308594, "ViewRequirementAgentConnector_ms": 0.8617291450500488}}, "episode_reward_max": 21.871413057379186, "episode_reward_min": 13.915476780898116, "episode_reward_mean": 18.43666925683373, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.353667002952818, 18.28805913185517, 17.41942932731893, 17.311261490297472, 19.433767074508093, 21.56900369847628, 19.759444302348115, 16.8543357823128, 18.796277407919202, 17.58848929860345, 18.925115852770652, 15.488211231969922, 20.257220872913987, 20.73707623174996, 17.356555359982828, 19.781199812677418, 19.48056857257507, 15.663872157249076, 21.871413057379186, 21.536221622127993, 13.915476780898116, 20.94456921531368, 18.616279965449113, 21.69419732923665, 20.67569681596803, 19.15951611129069, 14.825644512582818, 19.635964207926712, 17.782370129413987, 15.531854875186923, 17.584499218504774, 17.30451244501255, 16.255900985316377, 17.306757237481666, 19.898209357109828, 20.22170367683738, 19.5585719568726, 20.17111173314629, 20.5030459666726, 18.059563794784683, 18.587642291142686, 20.460417471067853, 18.988361788083775, 19.80864658485082, 20.183729429029846, 18.580510165635516, 19.79104990740453, 15.888656325468581, 18.52294080540354, 18.19274690259358, 16.972937134974597, 18.43056907680342, 21.30902789139881, 18.074069765101452, 17.556904032372387, 17.907446314534003, 19.196327570168357, 15.72457111040034, 18.008870307512392, 18.172254059502606, 18.49218289585599, 20.03343194999572, 18.367975091487196, 18.639279221689264, 18.033911421683616, 19.566611751769763, 18.200578923103464, 19.201399294140746, 19.32705537037468, 17.66953919395259, 18.443276523381694, 18.28947002518087, 17.04245340948447, 16.05574981969266, 17.279376789785776, 15.452821088144574, 19.24927655008475, 20.934965074924637, 18.816295117576725, 19.60186424133482, 17.07192986953112, 16.811453077494125, 17.846127844949205, 16.962851395059268, 19.977074477915874, 15.438185838251885, 17.059068745796797, 16.679273366057075, 18.349182786769017, 17.358435312391048, 17.60628759378367, 18.81530903703594, 18.484479396049153, 17.648017177449738, 21.400279993920737, 19.96436857313594, 18.111558105115034, 20.29711940877173, 14.581702977001024, 18.03239241680793], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.066068832585691, "mean_inference_ms": 8.143222180574435, "mean_action_processing_ms": 0.5567641187326293, "mean_env_wait_ms": 23.866946584294684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018100738525390625, "StateBufferConnector_ms": 0.019682884216308594, "ViewRequirementAgentConnector_ms": 0.8617291450500488}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2154200, "num_agent_steps_trained": 2154200, "num_env_steps_sampled": 2154200, "num_env_steps_trained": 2154200, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 279.63821300958625, "num_env_steps_trained_throughput_per_sec": 279.63821300958625, "timesteps_total": 2154200, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2154200, "timers": {"training_iteration_time_ms": 55815.23, "sample_time_ms": 41846.505, "load_time_ms": 1789.232, "load_throughput": 8740.064, "learn_time_ms": 11605.871, "learn_throughput": 1347.422, "synch_weights_time_ms": 459.652}, "counters": {"num_env_steps_sampled": 2154200, "num_env_steps_trained": 2154200, "num_agent_steps_sampled": 2154200, "num_agent_steps_trained": 2154200}, "done": false, "episodes_total": 1064, "training_iteration": 142, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-42-02", "timestamp": 1749246122, "time_this_iter_s": 55.93812274932861, "time_total_s": 4358.339941740036, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4358.339941740036, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 76.02923076923078, "ram_util_percent": 65.23846153846152, "gpu_util_percent0": 0.07646153846153846, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.8458e-05, "total_loss": -0.07754307206550783, "policy_loss": -0.0230784690474287, "vf_loss": 0.015249239917082543, "vf_explained_var": 0.8123724536462263, "kl": 0.016317274916908688, "entropy": 18.352949705990877, "entropy_coeff": 0.0036916}, "model": {}, "num_grad_updates_lifetime": 42075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2169838, "num_env_steps_trained": 2169838, "num_agent_steps_sampled": 2169838, "num_agent_steps_trained": 2169838}, "sampler_results": {"episode_reward_max": 21.871413057379186, "episode_reward_min": 13.915476780898116, "episode_reward_mean": 18.434504132130467, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.356555359982828, 19.781199812677418, 19.48056857257507, 15.663872157249076, 21.871413057379186, 21.536221622127993, 13.915476780898116, 20.94456921531368, 18.616279965449113, 21.69419732923665, 20.67569681596803, 19.15951611129069, 14.825644512582818, 19.635964207926712, 17.782370129413987, 15.531854875186923, 17.584499218504774, 17.30451244501255, 16.255900985316377, 17.306757237481666, 19.898209357109828, 20.22170367683738, 19.5585719568726, 20.17111173314629, 20.5030459666726, 18.059563794784683, 18.587642291142686, 20.460417471067853, 18.988361788083775, 19.80864658485082, 20.183729429029846, 18.580510165635516, 19.79104990740453, 15.888656325468581, 18.52294080540354, 18.19274690259358, 16.972937134974597, 18.43056907680342, 21.30902789139881, 18.074069765101452, 17.556904032372387, 17.907446314534003, 19.196327570168357, 15.72457111040034, 18.008870307512392, 18.172254059502606, 18.49218289585599, 20.03343194999572, 18.367975091487196, 18.639279221689264, 18.033911421683616, 19.566611751769763, 18.200578923103464, 19.201399294140746, 19.32705537037468, 17.66953919395259, 18.443276523381694, 18.28947002518087, 17.04245340948447, 16.05574981969266, 17.279376789785776, 15.452821088144574, 19.24927655008475, 20.934965074924637, 18.816295117576725, 19.60186424133482, 17.07192986953112, 16.811453077494125, 17.846127844949205, 16.962851395059268, 19.977074477915874, 15.438185838251885, 17.059068745796797, 16.679273366057075, 18.349182786769017, 17.358435312391048, 17.60628759378367, 18.81530903703594, 18.484479396049153, 17.648017177449738, 21.400279993920737, 19.96436857313594, 18.111558105115034, 20.29711940877173, 14.581702977001024, 18.03239241680793, 18.400137915695, 18.51926038946469, 17.916150201124356, 18.126860403098316, 19.84669743975601, 18.471991027950356, 19.301320921265393, 18.382809411824326, 19.99895523212808, 15.666344360468644, 16.773970701566565, 21.1046265015265, 19.651018522949716, 18.404703206852325], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0655438718106303, "mean_inference_ms": 8.145368767315867, "mean_action_processing_ms": 0.5569018868400173, "mean_env_wait_ms": 23.869080566020717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026180028915405273, "StateBufferConnector_ms": 0.01887965202331543, "ViewRequirementAgentConnector_ms": 0.8814435005187988}}, "episode_reward_max": 21.871413057379186, "episode_reward_min": 13.915476780898116, "episode_reward_mean": 18.434504132130467, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.356555359982828, 19.781199812677418, 19.48056857257507, 15.663872157249076, 21.871413057379186, 21.536221622127993, 13.915476780898116, 20.94456921531368, 18.616279965449113, 21.69419732923665, 20.67569681596803, 19.15951611129069, 14.825644512582818, 19.635964207926712, 17.782370129413987, 15.531854875186923, 17.584499218504774, 17.30451244501255, 16.255900985316377, 17.306757237481666, 19.898209357109828, 20.22170367683738, 19.5585719568726, 20.17111173314629, 20.5030459666726, 18.059563794784683, 18.587642291142686, 20.460417471067853, 18.988361788083775, 19.80864658485082, 20.183729429029846, 18.580510165635516, 19.79104990740453, 15.888656325468581, 18.52294080540354, 18.19274690259358, 16.972937134974597, 18.43056907680342, 21.30902789139881, 18.074069765101452, 17.556904032372387, 17.907446314534003, 19.196327570168357, 15.72457111040034, 18.008870307512392, 18.172254059502606, 18.49218289585599, 20.03343194999572, 18.367975091487196, 18.639279221689264, 18.033911421683616, 19.566611751769763, 18.200578923103464, 19.201399294140746, 19.32705537037468, 17.66953919395259, 18.443276523381694, 18.28947002518087, 17.04245340948447, 16.05574981969266, 17.279376789785776, 15.452821088144574, 19.24927655008475, 20.934965074924637, 18.816295117576725, 19.60186424133482, 17.07192986953112, 16.811453077494125, 17.846127844949205, 16.962851395059268, 19.977074477915874, 15.438185838251885, 17.059068745796797, 16.679273366057075, 18.349182786769017, 17.358435312391048, 17.60628759378367, 18.81530903703594, 18.484479396049153, 17.648017177449738, 21.400279993920737, 19.96436857313594, 18.111558105115034, 20.29711940877173, 14.581702977001024, 18.03239241680793, 18.400137915695, 18.51926038946469, 17.916150201124356, 18.126860403098316, 19.84669743975601, 18.471991027950356, 19.301320921265393, 18.382809411824326, 19.99895523212808, 15.666344360468644, 16.773970701566565, 21.1046265015265, 19.651018522949716, 18.404703206852325], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0655438718106303, "mean_inference_ms": 8.145368767315867, "mean_action_processing_ms": 0.5569018868400173, "mean_env_wait_ms": 23.869080566020717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026180028915405273, "StateBufferConnector_ms": 0.01887965202331543, "ViewRequirementAgentConnector_ms": 0.8814435005187988}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2169838, "num_agent_steps_trained": 2169838, "num_env_steps_sampled": 2169838, "num_env_steps_trained": 2169838, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.6811254118358, "num_env_steps_trained_throughput_per_sec": 278.6811254118358, "timesteps_total": 2169838, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2169838, "timers": {"training_iteration_time_ms": 55803.17, "sample_time_ms": 41870.487, "load_time_ms": 1785.489, "load_throughput": 8758.383, "learn_time_ms": 11572.212, "learn_throughput": 1351.341, "synch_weights_time_ms": 460.151}, "counters": {"num_env_steps_sampled": 2169838, "num_env_steps_trained": 2169838, "num_agent_steps_sampled": 2169838, "num_agent_steps_trained": 2169838}, "done": false, "episodes_total": 1078, "training_iteration": 143, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-42-59", "timestamp": 1749246179, "time_this_iter_s": 56.132853984832764, "time_total_s": 4414.472795724869, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4414.472795724869, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 76.4484375, "ram_util_percent": 65.0546875, "gpu_util_percent0": 0.07578125, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.830162000000004e-05, "total_loss": -0.07329603533599187, "policy_loss": -0.019306105144258418, "vf_loss": 0.015901403681967748, "vf_explained_var": 0.8282211662422527, "kl": 0.015907710230732862, "entropy": 18.373794822692872, "entropy_coeff": 0.003660323999999999}, "model": {}, "num_grad_updates_lifetime": 42625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2185476, "num_env_steps_trained": 2185476, "num_agent_steps_sampled": 2185476, "num_agent_steps_trained": 2185476}, "sampler_results": {"episode_reward_max": 21.400279993920737, "episode_reward_min": 14.368329239541632, "episode_reward_mean": 18.466198971632828, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.782370129413987, 15.531854875186923, 17.584499218504774, 17.30451244501255, 16.255900985316377, 17.306757237481666, 19.898209357109828, 20.22170367683738, 19.5585719568726, 20.17111173314629, 20.5030459666726, 18.059563794784683, 18.587642291142686, 20.460417471067853, 18.988361788083775, 19.80864658485082, 20.183729429029846, 18.580510165635516, 19.79104990740453, 15.888656325468581, 18.52294080540354, 18.19274690259358, 16.972937134974597, 18.43056907680342, 21.30902789139881, 18.074069765101452, 17.556904032372387, 17.907446314534003, 19.196327570168357, 15.72457111040034, 18.008870307512392, 18.172254059502606, 18.49218289585599, 20.03343194999572, 18.367975091487196, 18.639279221689264, 18.033911421683616, 19.566611751769763, 18.200578923103464, 19.201399294140746, 19.32705537037468, 17.66953919395259, 18.443276523381694, 18.28947002518087, 17.04245340948447, 16.05574981969266, 17.279376789785776, 15.452821088144574, 19.24927655008475, 20.934965074924637, 18.816295117576725, 19.60186424133482, 17.07192986953112, 16.811453077494125, 17.846127844949205, 16.962851395059268, 19.977074477915874, 15.438185838251885, 17.059068745796797, 16.679273366057075, 18.349182786769017, 17.358435312391048, 17.60628759378367, 18.81530903703594, 18.484479396049153, 17.648017177449738, 21.400279993920737, 19.96436857313594, 18.111558105115034, 20.29711940877173, 14.581702977001024, 18.03239241680793, 18.400137915695, 18.51926038946469, 17.916150201124356, 18.126860403098316, 19.84669743975601, 18.471991027950356, 19.301320921265393, 18.382809411824326, 19.99895523212808, 15.666344360468644, 16.773970701566565, 21.1046265015265, 19.651018522949716, 18.404703206852325, 19.30476814597134, 19.348860979192843, 17.177695253239268, 20.548167140040622, 18.95401888175498, 17.25500818472199, 20.061880278267694, 20.028062698029117, 20.49314432549192, 20.51916488939212, 14.368329239541632, 21.16568952809364, 19.874130568832808, 19.227739358323614], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0650530704459253, "mean_inference_ms": 8.147454888473133, "mean_action_processing_ms": 0.5570496665413469, "mean_env_wait_ms": 23.87085197068348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02995586395263672, "StateBufferConnector_ms": 0.016103029251098633, "ViewRequirementAgentConnector_ms": 0.8661084175109863}}, "episode_reward_max": 21.400279993920737, "episode_reward_min": 14.368329239541632, "episode_reward_mean": 18.466198971632828, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.782370129413987, 15.531854875186923, 17.584499218504774, 17.30451244501255, 16.255900985316377, 17.306757237481666, 19.898209357109828, 20.22170367683738, 19.5585719568726, 20.17111173314629, 20.5030459666726, 18.059563794784683, 18.587642291142686, 20.460417471067853, 18.988361788083775, 19.80864658485082, 20.183729429029846, 18.580510165635516, 19.79104990740453, 15.888656325468581, 18.52294080540354, 18.19274690259358, 16.972937134974597, 18.43056907680342, 21.30902789139881, 18.074069765101452, 17.556904032372387, 17.907446314534003, 19.196327570168357, 15.72457111040034, 18.008870307512392, 18.172254059502606, 18.49218289585599, 20.03343194999572, 18.367975091487196, 18.639279221689264, 18.033911421683616, 19.566611751769763, 18.200578923103464, 19.201399294140746, 19.32705537037468, 17.66953919395259, 18.443276523381694, 18.28947002518087, 17.04245340948447, 16.05574981969266, 17.279376789785776, 15.452821088144574, 19.24927655008475, 20.934965074924637, 18.816295117576725, 19.60186424133482, 17.07192986953112, 16.811453077494125, 17.846127844949205, 16.962851395059268, 19.977074477915874, 15.438185838251885, 17.059068745796797, 16.679273366057075, 18.349182786769017, 17.358435312391048, 17.60628759378367, 18.81530903703594, 18.484479396049153, 17.648017177449738, 21.400279993920737, 19.96436857313594, 18.111558105115034, 20.29711940877173, 14.581702977001024, 18.03239241680793, 18.400137915695, 18.51926038946469, 17.916150201124356, 18.126860403098316, 19.84669743975601, 18.471991027950356, 19.301320921265393, 18.382809411824326, 19.99895523212808, 15.666344360468644, 16.773970701566565, 21.1046265015265, 19.651018522949716, 18.404703206852325, 19.30476814597134, 19.348860979192843, 17.177695253239268, 20.548167140040622, 18.95401888175498, 17.25500818472199, 20.061880278267694, 20.028062698029117, 20.49314432549192, 20.51916488939212, 14.368329239541632, 21.16568952809364, 19.874130568832808, 19.227739358323614], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0650530704459253, "mean_inference_ms": 8.147454888473133, "mean_action_processing_ms": 0.5570496665413469, "mean_env_wait_ms": 23.87085197068348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02995586395263672, "StateBufferConnector_ms": 0.016103029251098633, "ViewRequirementAgentConnector_ms": 0.8661084175109863}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2185476, "num_agent_steps_trained": 2185476, "num_env_steps_sampled": 2185476, "num_env_steps_trained": 2185476, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 283.2218923870626, "num_env_steps_trained_throughput_per_sec": 283.2218923870626, "timesteps_total": 2185476, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2185476, "timers": {"training_iteration_time_ms": 55783.176, "sample_time_ms": 41886.301, "load_time_ms": 1765.295, "load_throughput": 8858.575, "learn_time_ms": 11551.459, "learn_throughput": 1353.768, "synch_weights_time_ms": 464.694}, "counters": {"num_env_steps_sampled": 2185476, "num_env_steps_trained": 2185476, "num_agent_steps_sampled": 2185476, "num_agent_steps_trained": 2185476}, "done": false, "episodes_total": 1092, "training_iteration": 144, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-43-54", "timestamp": 1749246234, "time_this_iter_s": 55.23267340660095, "time_total_s": 4469.70546913147, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4469.70546913147, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 77.11875, "ram_util_percent": 65.0234375, "gpu_util_percent0": 0.07750000000000001, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.814523999999998e-05, "total_loss": -0.06917562446980313, "policy_loss": -0.01586970088032434, "vf_loss": 0.015802938650700857, "vf_explained_var": 0.8222953915596009, "kl": 0.016482387261084197, "entropy": 18.420076120549982, "entropy_coeff": 0.003629048}, "model": {}, "num_grad_updates_lifetime": 43175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2201114, "num_env_steps_trained": 2201114, "num_agent_steps_sampled": 2201114, "num_agent_steps_trained": 2201114}, "sampler_results": {"episode_reward_max": 21.400279993920737, "episode_reward_min": 13.812706950702758, "episode_reward_mean": 18.392251019373177, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.988361788083775, 19.80864658485082, 20.183729429029846, 18.580510165635516, 19.79104990740453, 15.888656325468581, 18.52294080540354, 18.19274690259358, 16.972937134974597, 18.43056907680342, 21.30902789139881, 18.074069765101452, 17.556904032372387, 17.907446314534003, 19.196327570168357, 15.72457111040034, 18.008870307512392, 18.172254059502606, 18.49218289585599, 20.03343194999572, 18.367975091487196, 18.639279221689264, 18.033911421683616, 19.566611751769763, 18.200578923103464, 19.201399294140746, 19.32705537037468, 17.66953919395259, 18.443276523381694, 18.28947002518087, 17.04245340948447, 16.05574981969266, 17.279376789785776, 15.452821088144574, 19.24927655008475, 20.934965074924637, 18.816295117576725, 19.60186424133482, 17.07192986953112, 16.811453077494125, 17.846127844949205, 16.962851395059268, 19.977074477915874, 15.438185838251885, 17.059068745796797, 16.679273366057075, 18.349182786769017, 17.358435312391048, 17.60628759378367, 18.81530903703594, 18.484479396049153, 17.648017177449738, 21.400279993920737, 19.96436857313594, 18.111558105115034, 20.29711940877173, 14.581702977001024, 18.03239241680793, 18.400137915695, 18.51926038946469, 17.916150201124356, 18.126860403098316, 19.84669743975601, 18.471991027950356, 19.301320921265393, 18.382809411824326, 19.99895523212808, 15.666344360468644, 16.773970701566565, 21.1046265015265, 19.651018522949716, 18.404703206852325, 19.30476814597134, 19.348860979192843, 17.177695253239268, 20.548167140040622, 18.95401888175498, 17.25500818472199, 20.061880278267694, 20.028062698029117, 20.49314432549192, 20.51916488939212, 14.368329239541632, 21.16568952809364, 19.874130568832808, 19.227739358323614, 18.086229098615867, 16.749632922623288, 16.482166234033993, 20.406054267887345, 13.812706950702758, 19.615941060672498, 19.953709041347995, 20.230426219508363, 21.113677476485613, 18.539904739682168, 15.617803080222831, 17.255789766834603, 15.58534522672896, 18.381979827238705], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0645819927722733, "mean_inference_ms": 8.149636898682393, "mean_action_processing_ms": 0.5571897074838456, "mean_env_wait_ms": 23.872989872274378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029950857162475586, "StateBufferConnector_ms": 0.01714038848876953, "ViewRequirementAgentConnector_ms": 0.8819973468780518}}, "episode_reward_max": 21.400279993920737, "episode_reward_min": 13.812706950702758, "episode_reward_mean": 18.392251019373177, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.988361788083775, 19.80864658485082, 20.183729429029846, 18.580510165635516, 19.79104990740453, 15.888656325468581, 18.52294080540354, 18.19274690259358, 16.972937134974597, 18.43056907680342, 21.30902789139881, 18.074069765101452, 17.556904032372387, 17.907446314534003, 19.196327570168357, 15.72457111040034, 18.008870307512392, 18.172254059502606, 18.49218289585599, 20.03343194999572, 18.367975091487196, 18.639279221689264, 18.033911421683616, 19.566611751769763, 18.200578923103464, 19.201399294140746, 19.32705537037468, 17.66953919395259, 18.443276523381694, 18.28947002518087, 17.04245340948447, 16.05574981969266, 17.279376789785776, 15.452821088144574, 19.24927655008475, 20.934965074924637, 18.816295117576725, 19.60186424133482, 17.07192986953112, 16.811453077494125, 17.846127844949205, 16.962851395059268, 19.977074477915874, 15.438185838251885, 17.059068745796797, 16.679273366057075, 18.349182786769017, 17.358435312391048, 17.60628759378367, 18.81530903703594, 18.484479396049153, 17.648017177449738, 21.400279993920737, 19.96436857313594, 18.111558105115034, 20.29711940877173, 14.581702977001024, 18.03239241680793, 18.400137915695, 18.51926038946469, 17.916150201124356, 18.126860403098316, 19.84669743975601, 18.471991027950356, 19.301320921265393, 18.382809411824326, 19.99895523212808, 15.666344360468644, 16.773970701566565, 21.1046265015265, 19.651018522949716, 18.404703206852325, 19.30476814597134, 19.348860979192843, 17.177695253239268, 20.548167140040622, 18.95401888175498, 17.25500818472199, 20.061880278267694, 20.028062698029117, 20.49314432549192, 20.51916488939212, 14.368329239541632, 21.16568952809364, 19.874130568832808, 19.227739358323614, 18.086229098615867, 16.749632922623288, 16.482166234033993, 20.406054267887345, 13.812706950702758, 19.615941060672498, 19.953709041347995, 20.230426219508363, 21.113677476485613, 18.539904739682168, 15.617803080222831, 17.255789766834603, 15.58534522672896, 18.381979827238705], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0645819927722733, "mean_inference_ms": 8.149636898682393, "mean_action_processing_ms": 0.5571897074838456, "mean_env_wait_ms": 23.872989872274378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029950857162475586, "StateBufferConnector_ms": 0.01714038848876953, "ViewRequirementAgentConnector_ms": 0.8819973468780518}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2201114, "num_agent_steps_trained": 2201114, "num_env_steps_sampled": 2201114, "num_env_steps_trained": 2201114, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.38348421881557, "num_env_steps_trained_throughput_per_sec": 278.38348421881557, "timesteps_total": 2201114, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2201114, "timers": {"training_iteration_time_ms": 55811.154, "sample_time_ms": 41920.649, "load_time_ms": 1778.628, "load_throughput": 8792.17, "learn_time_ms": 11533.35, "learn_throughput": 1355.894, "synch_weights_time_ms": 464.298}, "counters": {"num_env_steps_sampled": 2201114, "num_env_steps_trained": 2201114, "num_agent_steps_sampled": 2201114, "num_agent_steps_trained": 2201114}, "done": false, "episodes_total": 1106, "training_iteration": 145, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-44-50", "timestamp": 1749246290, "time_this_iter_s": 56.191866874694824, "time_total_s": 4525.897336006165, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4525.897336006165, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 76.9875, "ram_util_percent": 65.2796875, "gpu_util_percent0": 0.08296875000000001, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.798885999999999e-05, "total_loss": -0.06900276920123195, "policy_loss": -0.01578546501923649, "vf_loss": 0.016182363792322577, "vf_explained_var": 0.8221497252854434, "kl": 0.01551867063792494, "entropy": 18.444188249761407, "entropy_coeff": 0.003597772}, "model": {}, "num_grad_updates_lifetime": 43725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2216752, "num_env_steps_trained": 2216752, "num_agent_steps_sampled": 2216752, "num_agent_steps_trained": 2216752}, "sampler_results": {"episode_reward_max": 21.400279993920737, "episode_reward_min": 13.812706950702758, "episode_reward_mean": 18.288276587057823, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.196327570168357, 15.72457111040034, 18.008870307512392, 18.172254059502606, 18.49218289585599, 20.03343194999572, 18.367975091487196, 18.639279221689264, 18.033911421683616, 19.566611751769763, 18.200578923103464, 19.201399294140746, 19.32705537037468, 17.66953919395259, 18.443276523381694, 18.28947002518087, 17.04245340948447, 16.05574981969266, 17.279376789785776, 15.452821088144574, 19.24927655008475, 20.934965074924637, 18.816295117576725, 19.60186424133482, 17.07192986953112, 16.811453077494125, 17.846127844949205, 16.962851395059268, 19.977074477915874, 15.438185838251885, 17.059068745796797, 16.679273366057075, 18.349182786769017, 17.358435312391048, 17.60628759378367, 18.81530903703594, 18.484479396049153, 17.648017177449738, 21.400279993920737, 19.96436857313594, 18.111558105115034, 20.29711940877173, 14.581702977001024, 18.03239241680793, 18.400137915695, 18.51926038946469, 17.916150201124356, 18.126860403098316, 19.84669743975601, 18.471991027950356, 19.301320921265393, 18.382809411824326, 19.99895523212808, 15.666344360468644, 16.773970701566565, 21.1046265015265, 19.651018522949716, 18.404703206852325, 19.30476814597134, 19.348860979192843, 17.177695253239268, 20.548167140040622, 18.95401888175498, 17.25500818472199, 20.061880278267694, 20.028062698029117, 20.49314432549192, 20.51916488939212, 14.368329239541632, 21.16568952809364, 19.874130568832808, 19.227739358323614, 18.086229098615867, 16.749632922623288, 16.482166234033993, 20.406054267887345, 13.812706950702758, 19.615941060672498, 19.953709041347995, 20.230426219508363, 21.113677476485613, 18.539904739682168, 15.617803080222831, 17.255789766834603, 15.58534522672896, 18.381979827238705, 18.98236590107556, 17.01178043773586, 20.107120726315856, 19.37639417988764, 16.432610405715796, 17.034100702071218, 17.966507161550474, 17.42106460204002, 18.129115314907136, 16.77513148693819, 16.924924225852205, 18.522894550402135, 17.335600873695633, 17.790542323931586], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0640324997918005, "mean_inference_ms": 8.151734272080265, "mean_action_processing_ms": 0.5573001601094796, "mean_env_wait_ms": 23.874315374849342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026929140090942383, "StateBufferConnector_ms": 0.02307581901550293, "ViewRequirementAgentConnector_ms": 0.902991771697998}}, "episode_reward_max": 21.400279993920737, "episode_reward_min": 13.812706950702758, "episode_reward_mean": 18.288276587057823, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.196327570168357, 15.72457111040034, 18.008870307512392, 18.172254059502606, 18.49218289585599, 20.03343194999572, 18.367975091487196, 18.639279221689264, 18.033911421683616, 19.566611751769763, 18.200578923103464, 19.201399294140746, 19.32705537037468, 17.66953919395259, 18.443276523381694, 18.28947002518087, 17.04245340948447, 16.05574981969266, 17.279376789785776, 15.452821088144574, 19.24927655008475, 20.934965074924637, 18.816295117576725, 19.60186424133482, 17.07192986953112, 16.811453077494125, 17.846127844949205, 16.962851395059268, 19.977074477915874, 15.438185838251885, 17.059068745796797, 16.679273366057075, 18.349182786769017, 17.358435312391048, 17.60628759378367, 18.81530903703594, 18.484479396049153, 17.648017177449738, 21.400279993920737, 19.96436857313594, 18.111558105115034, 20.29711940877173, 14.581702977001024, 18.03239241680793, 18.400137915695, 18.51926038946469, 17.916150201124356, 18.126860403098316, 19.84669743975601, 18.471991027950356, 19.301320921265393, 18.382809411824326, 19.99895523212808, 15.666344360468644, 16.773970701566565, 21.1046265015265, 19.651018522949716, 18.404703206852325, 19.30476814597134, 19.348860979192843, 17.177695253239268, 20.548167140040622, 18.95401888175498, 17.25500818472199, 20.061880278267694, 20.028062698029117, 20.49314432549192, 20.51916488939212, 14.368329239541632, 21.16568952809364, 19.874130568832808, 19.227739358323614, 18.086229098615867, 16.749632922623288, 16.482166234033993, 20.406054267887345, 13.812706950702758, 19.615941060672498, 19.953709041347995, 20.230426219508363, 21.113677476485613, 18.539904739682168, 15.617803080222831, 17.255789766834603, 15.58534522672896, 18.381979827238705, 18.98236590107556, 17.01178043773586, 20.107120726315856, 19.37639417988764, 16.432610405715796, 17.034100702071218, 17.966507161550474, 17.42106460204002, 18.129115314907136, 16.77513148693819, 16.924924225852205, 18.522894550402135, 17.335600873695633, 17.790542323931586], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0640324997918005, "mean_inference_ms": 8.151734272080265, "mean_action_processing_ms": 0.5573001601094796, "mean_env_wait_ms": 23.874315374849342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026929140090942383, "StateBufferConnector_ms": 0.02307581901550293, "ViewRequirementAgentConnector_ms": 0.902991771697998}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2216752, "num_agent_steps_trained": 2216752, "num_env_steps_sampled": 2216752, "num_env_steps_trained": 2216752, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.4136431003244, "num_env_steps_trained_throughput_per_sec": 281.4136431003244, "timesteps_total": 2216752, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2216752, "timers": {"training_iteration_time_ms": 55794.999, "sample_time_ms": 41934.09, "load_time_ms": 1758.942, "load_throughput": 8890.569, "learn_time_ms": 11522.042, "learn_throughput": 1357.225, "synch_weights_time_ms": 465.555}, "counters": {"num_env_steps_sampled": 2216752, "num_env_steps_trained": 2216752, "num_agent_steps_sampled": 2216752, "num_agent_steps_trained": 2216752}, "done": false, "episodes_total": 1120, "training_iteration": 146, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-45-46", "timestamp": 1749246346, "time_this_iter_s": 55.58944058418274, "time_total_s": 4581.486776590347, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4581.486776590347, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 76.540625, "ram_util_percent": 65.015625, "gpu_util_percent0": 0.08078125, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.783248e-05, "total_loss": -0.07876813411754979, "policy_loss": -0.026302478722963398, "vf_loss": 0.015727947078729897, "vf_explained_var": 0.8302569040385159, "kl": 0.016046007241939976, "entropy": 18.435902474143287, "entropy_coeff": 0.003566495999999999}, "model": {}, "num_grad_updates_lifetime": 44275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2232390, "num_env_steps_trained": 2232390, "num_agent_steps_sampled": 2232390, "num_agent_steps_trained": 2232390}, "sampler_results": {"episode_reward_max": 21.48915383543898, "episode_reward_min": 13.812706950702758, "episode_reward_mean": 18.222940314044777, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.443276523381694, 18.28947002518087, 17.04245340948447, 16.05574981969266, 17.279376789785776, 15.452821088144574, 19.24927655008475, 20.934965074924637, 18.816295117576725, 19.60186424133482, 17.07192986953112, 16.811453077494125, 17.846127844949205, 16.962851395059268, 19.977074477915874, 15.438185838251885, 17.059068745796797, 16.679273366057075, 18.349182786769017, 17.358435312391048, 17.60628759378367, 18.81530903703594, 18.484479396049153, 17.648017177449738, 21.400279993920737, 19.96436857313594, 18.111558105115034, 20.29711940877173, 14.581702977001024, 18.03239241680793, 18.400137915695, 18.51926038946469, 17.916150201124356, 18.126860403098316, 19.84669743975601, 18.471991027950356, 19.301320921265393, 18.382809411824326, 19.99895523212808, 15.666344360468644, 16.773970701566565, 21.1046265015265, 19.651018522949716, 18.404703206852325, 19.30476814597134, 19.348860979192843, 17.177695253239268, 20.548167140040622, 18.95401888175498, 17.25500818472199, 20.061880278267694, 20.028062698029117, 20.49314432549192, 20.51916488939212, 14.368329239541632, 21.16568952809364, 19.874130568832808, 19.227739358323614, 18.086229098615867, 16.749632922623288, 16.482166234033993, 20.406054267887345, 13.812706950702758, 19.615941060672498, 19.953709041347995, 20.230426219508363, 21.113677476485613, 18.539904739682168, 15.617803080222831, 17.255789766834603, 15.58534522672896, 18.381979827238705, 18.98236590107556, 17.01178043773586, 20.107120726315856, 19.37639417988764, 16.432610405715796, 17.034100702071218, 17.966507161550474, 17.42106460204002, 18.129115314907136, 16.77513148693819, 16.924924225852205, 18.522894550402135, 17.335600873695633, 17.790542323931586, 17.10113388597077, 17.695566990656516, 16.61037078934329, 16.426154998832843, 18.734441343728466, 18.518350020787825, 18.772829723305072, 17.350605397452473, 15.686622267490318, 19.714619032044038, 19.006736672894142, 18.284806513528817, 21.48915383543898, 16.708969388858808], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.063139547018926, "mean_inference_ms": 8.153391610767894, "mean_action_processing_ms": 0.5574087982408271, "mean_env_wait_ms": 23.874868061020017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020906686782836914, "StateBufferConnector_ms": 0.02510976791381836, "ViewRequirementAgentConnector_ms": 0.9130394458770752}}, "episode_reward_max": 21.48915383543898, "episode_reward_min": 13.812706950702758, "episode_reward_mean": 18.222940314044777, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.443276523381694, 18.28947002518087, 17.04245340948447, 16.05574981969266, 17.279376789785776, 15.452821088144574, 19.24927655008475, 20.934965074924637, 18.816295117576725, 19.60186424133482, 17.07192986953112, 16.811453077494125, 17.846127844949205, 16.962851395059268, 19.977074477915874, 15.438185838251885, 17.059068745796797, 16.679273366057075, 18.349182786769017, 17.358435312391048, 17.60628759378367, 18.81530903703594, 18.484479396049153, 17.648017177449738, 21.400279993920737, 19.96436857313594, 18.111558105115034, 20.29711940877173, 14.581702977001024, 18.03239241680793, 18.400137915695, 18.51926038946469, 17.916150201124356, 18.126860403098316, 19.84669743975601, 18.471991027950356, 19.301320921265393, 18.382809411824326, 19.99895523212808, 15.666344360468644, 16.773970701566565, 21.1046265015265, 19.651018522949716, 18.404703206852325, 19.30476814597134, 19.348860979192843, 17.177695253239268, 20.548167140040622, 18.95401888175498, 17.25500818472199, 20.061880278267694, 20.028062698029117, 20.49314432549192, 20.51916488939212, 14.368329239541632, 21.16568952809364, 19.874130568832808, 19.227739358323614, 18.086229098615867, 16.749632922623288, 16.482166234033993, 20.406054267887345, 13.812706950702758, 19.615941060672498, 19.953709041347995, 20.230426219508363, 21.113677476485613, 18.539904739682168, 15.617803080222831, 17.255789766834603, 15.58534522672896, 18.381979827238705, 18.98236590107556, 17.01178043773586, 20.107120726315856, 19.37639417988764, 16.432610405715796, 17.034100702071218, 17.966507161550474, 17.42106460204002, 18.129115314907136, 16.77513148693819, 16.924924225852205, 18.522894550402135, 17.335600873695633, 17.790542323931586, 17.10113388597077, 17.695566990656516, 16.61037078934329, 16.426154998832843, 18.734441343728466, 18.518350020787825, 18.772829723305072, 17.350605397452473, 15.686622267490318, 19.714619032044038, 19.006736672894142, 18.284806513528817, 21.48915383543898, 16.708969388858808], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.063139547018926, "mean_inference_ms": 8.153391610767894, "mean_action_processing_ms": 0.5574087982408271, "mean_env_wait_ms": 23.874868061020017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020906686782836914, "StateBufferConnector_ms": 0.02510976791381836, "ViewRequirementAgentConnector_ms": 0.9130394458770752}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2232390, "num_agent_steps_trained": 2232390, "num_env_steps_sampled": 2232390, "num_env_steps_trained": 2232390, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 282.16581321477605, "num_env_steps_trained_throughput_per_sec": 282.16581321477605, "timesteps_total": 2232390, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2232390, "timers": {"training_iteration_time_ms": 55781.412, "sample_time_ms": 41949.636, "load_time_ms": 1743.46, "load_throughput": 8969.523, "learn_time_ms": 11508.565, "learn_throughput": 1358.814, "synch_weights_time_ms": 463.223}, "counters": {"num_env_steps_sampled": 2232390, "num_env_steps_trained": 2232390, "num_agent_steps_sampled": 2232390, "num_agent_steps_trained": 2232390}, "done": false, "episodes_total": 1134, "training_iteration": 147, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-46-41", "timestamp": 1749246401, "time_this_iter_s": 55.46924662590027, "time_total_s": 4636.956023216248, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4636.956023216248, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 76.08461538461539, "ram_util_percent": 65.02923076923076, "gpu_util_percent0": 0.07784615384615386, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.767609999999999e-05, "total_loss": -0.08616873332087628, "policy_loss": -0.034335463237135135, "vf_loss": 0.016628999794748696, "vf_explained_var": 0.8144169460643421, "kl": 0.015600883575124581, "entropy": 18.429358593333852, "entropy_coeff": 0.00353522}, "model": {}, "num_grad_updates_lifetime": 44825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2248028, "num_env_steps_trained": 2248028, "num_agent_steps_sampled": 2248028, "num_agent_steps_trained": 2248028}, "sampler_results": {"episode_reward_max": 22.71943661025911, "episode_reward_min": 13.812706950702758, "episode_reward_mean": 18.255090291861833, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.977074477915874, 15.438185838251885, 17.059068745796797, 16.679273366057075, 18.349182786769017, 17.358435312391048, 17.60628759378367, 18.81530903703594, 18.484479396049153, 17.648017177449738, 21.400279993920737, 19.96436857313594, 18.111558105115034, 20.29711940877173, 14.581702977001024, 18.03239241680793, 18.400137915695, 18.51926038946469, 17.916150201124356, 18.126860403098316, 19.84669743975601, 18.471991027950356, 19.301320921265393, 18.382809411824326, 19.99895523212808, 15.666344360468644, 16.773970701566565, 21.1046265015265, 19.651018522949716, 18.404703206852325, 19.30476814597134, 19.348860979192843, 17.177695253239268, 20.548167140040622, 18.95401888175498, 17.25500818472199, 20.061880278267694, 20.028062698029117, 20.49314432549192, 20.51916488939212, 14.368329239541632, 21.16568952809364, 19.874130568832808, 19.227739358323614, 18.086229098615867, 16.749632922623288, 16.482166234033993, 20.406054267887345, 13.812706950702758, 19.615941060672498, 19.953709041347995, 20.230426219508363, 21.113677476485613, 18.539904739682168, 15.617803080222831, 17.255789766834603, 15.58534522672896, 18.381979827238705, 18.98236590107556, 17.01178043773586, 20.107120726315856, 19.37639417988764, 16.432610405715796, 17.034100702071218, 17.966507161550474, 17.42106460204002, 18.129115314907136, 16.77513148693819, 16.924924225852205, 18.522894550402135, 17.335600873695633, 17.790542323931586, 17.10113388597077, 17.695566990656516, 16.61037078934329, 16.426154998832843, 18.734441343728466, 18.518350020787825, 18.772829723305072, 17.350605397452473, 15.686622267490318, 19.714619032044038, 19.006736672894142, 18.284806513528817, 21.48915383543898, 16.708969388858808, 17.770754030128774, 19.70495095779085, 14.912370275419686, 16.215454207394902, 18.52279826455622, 20.31991379033011, 16.64986342266326, 22.71943661025911, 19.510848395547185, 15.415821029536511, 16.93752681170651, 18.402865449254893, 21.321099348085482, 14.669206015656563], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.062288834330806, "mean_inference_ms": 8.154944345368918, "mean_action_processing_ms": 0.5574860025933863, "mean_env_wait_ms": 23.876047070766305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020644187927246094, "StateBufferConnector_ms": 0.023139476776123047, "ViewRequirementAgentConnector_ms": 0.9288241863250732}}, "episode_reward_max": 22.71943661025911, "episode_reward_min": 13.812706950702758, "episode_reward_mean": 18.255090291861833, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.977074477915874, 15.438185838251885, 17.059068745796797, 16.679273366057075, 18.349182786769017, 17.358435312391048, 17.60628759378367, 18.81530903703594, 18.484479396049153, 17.648017177449738, 21.400279993920737, 19.96436857313594, 18.111558105115034, 20.29711940877173, 14.581702977001024, 18.03239241680793, 18.400137915695, 18.51926038946469, 17.916150201124356, 18.126860403098316, 19.84669743975601, 18.471991027950356, 19.301320921265393, 18.382809411824326, 19.99895523212808, 15.666344360468644, 16.773970701566565, 21.1046265015265, 19.651018522949716, 18.404703206852325, 19.30476814597134, 19.348860979192843, 17.177695253239268, 20.548167140040622, 18.95401888175498, 17.25500818472199, 20.061880278267694, 20.028062698029117, 20.49314432549192, 20.51916488939212, 14.368329239541632, 21.16568952809364, 19.874130568832808, 19.227739358323614, 18.086229098615867, 16.749632922623288, 16.482166234033993, 20.406054267887345, 13.812706950702758, 19.615941060672498, 19.953709041347995, 20.230426219508363, 21.113677476485613, 18.539904739682168, 15.617803080222831, 17.255789766834603, 15.58534522672896, 18.381979827238705, 18.98236590107556, 17.01178043773586, 20.107120726315856, 19.37639417988764, 16.432610405715796, 17.034100702071218, 17.966507161550474, 17.42106460204002, 18.129115314907136, 16.77513148693819, 16.924924225852205, 18.522894550402135, 17.335600873695633, 17.790542323931586, 17.10113388597077, 17.695566990656516, 16.61037078934329, 16.426154998832843, 18.734441343728466, 18.518350020787825, 18.772829723305072, 17.350605397452473, 15.686622267490318, 19.714619032044038, 19.006736672894142, 18.284806513528817, 21.48915383543898, 16.708969388858808, 17.770754030128774, 19.70495095779085, 14.912370275419686, 16.215454207394902, 18.52279826455622, 20.31991379033011, 16.64986342266326, 22.71943661025911, 19.510848395547185, 15.415821029536511, 16.93752681170651, 18.402865449254893, 21.321099348085482, 14.669206015656563], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.062288834330806, "mean_inference_ms": 8.154944345368918, "mean_action_processing_ms": 0.5574860025933863, "mean_env_wait_ms": 23.876047070766305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020644187927246094, "StateBufferConnector_ms": 0.023139476776123047, "ViewRequirementAgentConnector_ms": 0.9288241863250732}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2248028, "num_agent_steps_trained": 2248028, "num_env_steps_sampled": 2248028, "num_env_steps_trained": 2248028, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 279.6523103841007, "num_env_steps_trained_throughput_per_sec": 279.6523103841007, "timesteps_total": 2248028, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2248028, "timers": {"training_iteration_time_ms": 55810.23, "sample_time_ms": 41955.086, "load_time_ms": 1749.252, "load_throughput": 8939.822, "learn_time_ms": 11523.911, "learn_throughput": 1357.005, "synch_weights_time_ms": 464.213}, "counters": {"num_env_steps_sampled": 2248028, "num_env_steps_trained": 2248028, "num_agent_steps_sampled": 2248028, "num_agent_steps_trained": 2248028}, "done": false, "episodes_total": 1148, "training_iteration": 148, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-47-37", "timestamp": 1749246457, "time_this_iter_s": 55.938435792922974, "time_total_s": 4692.8944590091705, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4692.8944590091705, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 75.96307692307693, "ram_util_percent": 65.23230769230769, "gpu_util_percent0": 0.07784615384615384, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.751972000000001e-05, "total_loss": -0.06481564728289166, "policy_loss": -0.013339834195688705, "vf_loss": 0.015395148115401918, "vf_explained_var": 0.8461092057011345, "kl": 0.01586537911186478, "entropy": 18.426506841832943, "entropy_coeff": 0.003503944000000001}, "model": {}, "num_grad_updates_lifetime": 45375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2263666, "num_env_steps_trained": 2263666, "num_agent_steps_sampled": 2263666, "num_agent_steps_trained": 2263666}, "sampler_results": {"episode_reward_max": 22.71943661025911, "episode_reward_min": 13.812706950702758, "episode_reward_mean": 18.186230987145226, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.581702977001024, 18.03239241680793, 18.400137915695, 18.51926038946469, 17.916150201124356, 18.126860403098316, 19.84669743975601, 18.471991027950356, 19.301320921265393, 18.382809411824326, 19.99895523212808, 15.666344360468644, 16.773970701566565, 21.1046265015265, 19.651018522949716, 18.404703206852325, 19.30476814597134, 19.348860979192843, 17.177695253239268, 20.548167140040622, 18.95401888175498, 17.25500818472199, 20.061880278267694, 20.028062698029117, 20.49314432549192, 20.51916488939212, 14.368329239541632, 21.16568952809364, 19.874130568832808, 19.227739358323614, 18.086229098615867, 16.749632922623288, 16.482166234033993, 20.406054267887345, 13.812706950702758, 19.615941060672498, 19.953709041347995, 20.230426219508363, 21.113677476485613, 18.539904739682168, 15.617803080222831, 17.255789766834603, 15.58534522672896, 18.381979827238705, 18.98236590107556, 17.01178043773586, 20.107120726315856, 19.37639417988764, 16.432610405715796, 17.034100702071218, 17.966507161550474, 17.42106460204002, 18.129115314907136, 16.77513148693819, 16.924924225852205, 18.522894550402135, 17.335600873695633, 17.790542323931586, 17.10113388597077, 17.695566990656516, 16.61037078934329, 16.426154998832843, 18.734441343728466, 18.518350020787825, 18.772829723305072, 17.350605397452473, 15.686622267490318, 19.714619032044038, 19.006736672894142, 18.284806513528817, 21.48915383543898, 16.708969388858808, 17.770754030128774, 19.70495095779085, 14.912370275419686, 16.215454207394902, 18.52279826455622, 20.31991379033011, 16.64986342266326, 22.71943661025911, 19.510848395547185, 15.415821029536511, 16.93752681170651, 18.402865449254893, 21.321099348085482, 14.669206015656563, 17.01067240953875, 16.24921437914261, 15.838003902499718, 20.400980054437067, 19.189213125690127, 18.05756671213356, 18.11320144052813, 17.144354543032794, 17.28742164221599, 17.555345861574708, 16.73697699528859, 18.580291006929645, 18.739621906674337, 19.399845361096986], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.061523608674822, "mean_inference_ms": 8.156620354289647, "mean_action_processing_ms": 0.557565358278713, "mean_env_wait_ms": 23.87690823954927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021635770797729492, "StateBufferConnector_ms": 0.025096416473388672, "ViewRequirementAgentConnector_ms": 0.9355249404907227}}, "episode_reward_max": 22.71943661025911, "episode_reward_min": 13.812706950702758, "episode_reward_mean": 18.186230987145226, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.581702977001024, 18.03239241680793, 18.400137915695, 18.51926038946469, 17.916150201124356, 18.126860403098316, 19.84669743975601, 18.471991027950356, 19.301320921265393, 18.382809411824326, 19.99895523212808, 15.666344360468644, 16.773970701566565, 21.1046265015265, 19.651018522949716, 18.404703206852325, 19.30476814597134, 19.348860979192843, 17.177695253239268, 20.548167140040622, 18.95401888175498, 17.25500818472199, 20.061880278267694, 20.028062698029117, 20.49314432549192, 20.51916488939212, 14.368329239541632, 21.16568952809364, 19.874130568832808, 19.227739358323614, 18.086229098615867, 16.749632922623288, 16.482166234033993, 20.406054267887345, 13.812706950702758, 19.615941060672498, 19.953709041347995, 20.230426219508363, 21.113677476485613, 18.539904739682168, 15.617803080222831, 17.255789766834603, 15.58534522672896, 18.381979827238705, 18.98236590107556, 17.01178043773586, 20.107120726315856, 19.37639417988764, 16.432610405715796, 17.034100702071218, 17.966507161550474, 17.42106460204002, 18.129115314907136, 16.77513148693819, 16.924924225852205, 18.522894550402135, 17.335600873695633, 17.790542323931586, 17.10113388597077, 17.695566990656516, 16.61037078934329, 16.426154998832843, 18.734441343728466, 18.518350020787825, 18.772829723305072, 17.350605397452473, 15.686622267490318, 19.714619032044038, 19.006736672894142, 18.284806513528817, 21.48915383543898, 16.708969388858808, 17.770754030128774, 19.70495095779085, 14.912370275419686, 16.215454207394902, 18.52279826455622, 20.31991379033011, 16.64986342266326, 22.71943661025911, 19.510848395547185, 15.415821029536511, 16.93752681170651, 18.402865449254893, 21.321099348085482, 14.669206015656563, 17.01067240953875, 16.24921437914261, 15.838003902499718, 20.400980054437067, 19.189213125690127, 18.05756671213356, 18.11320144052813, 17.144354543032794, 17.28742164221599, 17.555345861574708, 16.73697699528859, 18.580291006929645, 18.739621906674337, 19.399845361096986], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.061523608674822, "mean_inference_ms": 8.156620354289647, "mean_action_processing_ms": 0.557565358278713, "mean_env_wait_ms": 23.87690823954927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021635770797729492, "StateBufferConnector_ms": 0.025096416473388672, "ViewRequirementAgentConnector_ms": 0.9355249404907227}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2263666, "num_agent_steps_trained": 2263666, "num_env_steps_sampled": 2263666, "num_env_steps_trained": 2263666, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 281.2783785458578, "num_env_steps_trained_throughput_per_sec": 281.2783785458578, "timesteps_total": 2263666, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2263666, "timers": {"training_iteration_time_ms": 55744.474, "sample_time_ms": 41920.831, "load_time_ms": 1734.227, "load_throughput": 9017.273, "learn_time_ms": 11507.349, "learn_throughput": 1358.958, "synch_weights_time_ms": 468.819}, "counters": {"num_env_steps_sampled": 2263666, "num_env_steps_trained": 2263666, "num_agent_steps_sampled": 2263666, "num_agent_steps_trained": 2263666}, "done": false, "episodes_total": 1162, "training_iteration": 149, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-48-33", "timestamp": 1749246513, "time_this_iter_s": 55.62465262413025, "time_total_s": 4748.519111633301, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4748.519111633301, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 76.85000000000001, "ram_util_percent": 65.24843750000001, "gpu_util_percent0": 0.07609375, "vram_util_percent0": 0.8592122395833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": 1.2035476442374868, "episode_reward_min": -4.134423768868237, "episode_reward_mean": -1.5901477420002164, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0714319604457954, 1.2035476442374868, -0.7372001758199698, -4.134423768868237, -2.2112304491045673], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6180459621502892, "mean_inference_ms": 3.7740870217070652, "mean_action_processing_ms": 0.2990431417176528, "mean_env_wait_ms": 11.793067302466776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.33498287200927734, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.8254671096801758}}, "episode_reward_max": 1.2035476442374868, "episode_reward_min": -4.134423768868237, "episode_reward_mean": -1.5901477420002164, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0714319604457954, 1.2035476442374868, -0.7372001758199698, -4.134423768868237, -2.2112304491045673], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6180459621502892, "mean_inference_ms": 3.7740870217070652, "mean_action_processing_ms": 0.2990431417176528, "mean_env_wait_ms": 11.793067302466776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.33498287200927734, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.8254671096801758}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.736334000000001e-05, "total_loss": -0.07146630403289402, "policy_loss": -0.02068728275337807, "vf_loss": 0.016055038107813082, "vf_explained_var": 0.8351696947487918, "kl": 0.01552274270909447, "entropy": 18.396137598211116, "entropy_coeff": 0.003472667999999999}, "model": {}, "num_grad_updates_lifetime": 45925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2279304, "num_env_steps_trained": 2279304, "num_agent_steps_sampled": 2279304, "num_agent_steps_trained": 2279304}, "sampler_results": {"episode_reward_max": 22.71943661025911, "episode_reward_min": 13.812706950702758, "episode_reward_mean": 18.14420433596405, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.651018522949716, 18.404703206852325, 19.30476814597134, 19.348860979192843, 17.177695253239268, 20.548167140040622, 18.95401888175498, 17.25500818472199, 20.061880278267694, 20.028062698029117, 20.49314432549192, 20.51916488939212, 14.368329239541632, 21.16568952809364, 19.874130568832808, 19.227739358323614, 18.086229098615867, 16.749632922623288, 16.482166234033993, 20.406054267887345, 13.812706950702758, 19.615941060672498, 19.953709041347995, 20.230426219508363, 21.113677476485613, 18.539904739682168, 15.617803080222831, 17.255789766834603, 15.58534522672896, 18.381979827238705, 18.98236590107556, 17.01178043773586, 20.107120726315856, 19.37639417988764, 16.432610405715796, 17.034100702071218, 17.966507161550474, 17.42106460204002, 18.129115314907136, 16.77513148693819, 16.924924225852205, 18.522894550402135, 17.335600873695633, 17.790542323931586, 17.10113388597077, 17.695566990656516, 16.61037078934329, 16.426154998832843, 18.734441343728466, 18.518350020787825, 18.772829723305072, 17.350605397452473, 15.686622267490318, 19.714619032044038, 19.006736672894142, 18.284806513528817, 21.48915383543898, 16.708969388858808, 17.770754030128774, 19.70495095779085, 14.912370275419686, 16.215454207394902, 18.52279826455622, 20.31991379033011, 16.64986342266326, 22.71943661025911, 19.510848395547185, 15.415821029536511, 16.93752681170651, 18.402865449254893, 21.321099348085482, 14.669206015656563, 17.01067240953875, 16.24921437914261, 15.838003902499718, 20.400980054437067, 19.189213125690127, 18.05756671213356, 18.11320144052813, 17.144354543032794, 17.28742164221599, 17.555345861574708, 16.73697699528859, 18.580291006929645, 18.739621906674337, 19.399845361096986, 17.23279652665949, 16.368566909901922, 15.936705624398215, 19.846507208784377, 19.2591859329641, 16.71557784663523, 15.097142939193562, 18.7662384271812, 18.298504835006472, 18.9920909802001, 18.77780302088453, 17.46444647947651, 19.9830628280561, 18.18192522221812], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.060904117657694, "mean_inference_ms": 8.15801632444079, "mean_action_processing_ms": 0.5576161761289677, "mean_env_wait_ms": 23.877456904444497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01583552360534668, "StateBufferConnector_ms": 0.029189109802246094, "ViewRequirementAgentConnector_ms": 0.9409456253051758}}, "episode_reward_max": 22.71943661025911, "episode_reward_min": 13.812706950702758, "episode_reward_mean": 18.14420433596405, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.651018522949716, 18.404703206852325, 19.30476814597134, 19.348860979192843, 17.177695253239268, 20.548167140040622, 18.95401888175498, 17.25500818472199, 20.061880278267694, 20.028062698029117, 20.49314432549192, 20.51916488939212, 14.368329239541632, 21.16568952809364, 19.874130568832808, 19.227739358323614, 18.086229098615867, 16.749632922623288, 16.482166234033993, 20.406054267887345, 13.812706950702758, 19.615941060672498, 19.953709041347995, 20.230426219508363, 21.113677476485613, 18.539904739682168, 15.617803080222831, 17.255789766834603, 15.58534522672896, 18.381979827238705, 18.98236590107556, 17.01178043773586, 20.107120726315856, 19.37639417988764, 16.432610405715796, 17.034100702071218, 17.966507161550474, 17.42106460204002, 18.129115314907136, 16.77513148693819, 16.924924225852205, 18.522894550402135, 17.335600873695633, 17.790542323931586, 17.10113388597077, 17.695566990656516, 16.61037078934329, 16.426154998832843, 18.734441343728466, 18.518350020787825, 18.772829723305072, 17.350605397452473, 15.686622267490318, 19.714619032044038, 19.006736672894142, 18.284806513528817, 21.48915383543898, 16.708969388858808, 17.770754030128774, 19.70495095779085, 14.912370275419686, 16.215454207394902, 18.52279826455622, 20.31991379033011, 16.64986342266326, 22.71943661025911, 19.510848395547185, 15.415821029536511, 16.93752681170651, 18.402865449254893, 21.321099348085482, 14.669206015656563, 17.01067240953875, 16.24921437914261, 15.838003902499718, 20.400980054437067, 19.189213125690127, 18.05756671213356, 18.11320144052813, 17.144354543032794, 17.28742164221599, 17.555345861574708, 16.73697699528859, 18.580291006929645, 18.739621906674337, 19.399845361096986, 17.23279652665949, 16.368566909901922, 15.936705624398215, 19.846507208784377, 19.2591859329641, 16.71557784663523, 15.097142939193562, 18.7662384271812, 18.298504835006472, 18.9920909802001, 18.77780302088453, 17.46444647947651, 19.9830628280561, 18.18192522221812], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.060904117657694, "mean_inference_ms": 8.15801632444079, "mean_action_processing_ms": 0.5576161761289677, "mean_env_wait_ms": 23.877456904444497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01583552360534668, "StateBufferConnector_ms": 0.029189109802246094, "ViewRequirementAgentConnector_ms": 0.9409456253051758}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2279304, "num_agent_steps_trained": 2279304, "num_env_steps_sampled": 2279304, "num_env_steps_trained": 2279304, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 279.90326286237354, "num_env_steps_trained_throughput_per_sec": 279.90326286237354, "timesteps_total": 2279304, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2279304, "timers": {"training_iteration_time_ms": 55707.983, "sample_time_ms": 41867.705, "load_time_ms": 1732.359, "load_throughput": 9026.998, "learn_time_ms": 11525.69, "learn_throughput": 1356.795, "synch_weights_time_ms": 467.299}, "counters": {"num_env_steps_sampled": 2279304, "num_env_steps_trained": 2279304, "num_agent_steps_sampled": 2279304, "num_agent_steps_trained": 2279304}, "done": false, "episodes_total": 1176, "training_iteration": 150, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-49-45", "timestamp": 1749246585, "time_this_iter_s": 72.35007333755493, "time_total_s": 4820.869184970856, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4820.869184970856, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 62.852941176470566, "ram_util_percent": 64.64117647058823, "gpu_util_percent0": 0.05988235294117647, "vram_util_percent0": 0.8592122395833329}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.720695999999999e-05, "total_loss": -0.07656302798793398, "policy_loss": -0.026288201386765155, "vf_loss": 0.015539354655298997, "vf_explained_var": 0.861849000453949, "kl": 0.015457978139539693, "entropy": 18.361812933141536, "entropy_coeff": 0.003441392}, "model": {}, "num_grad_updates_lifetime": 46475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2294942, "num_env_steps_trained": 2294942, "num_agent_steps_sampled": 2294942, "num_agent_steps_trained": 2294942}, "sampler_results": {"episode_reward_max": 22.71943661025911, "episode_reward_min": 13.812706950702758, "episode_reward_mean": 18.088018726417438, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.874130568832808, 19.227739358323614, 18.086229098615867, 16.749632922623288, 16.482166234033993, 20.406054267887345, 13.812706950702758, 19.615941060672498, 19.953709041347995, 20.230426219508363, 21.113677476485613, 18.539904739682168, 15.617803080222831, 17.255789766834603, 15.58534522672896, 18.381979827238705, 18.98236590107556, 17.01178043773586, 20.107120726315856, 19.37639417988764, 16.432610405715796, 17.034100702071218, 17.966507161550474, 17.42106460204002, 18.129115314907136, 16.77513148693819, 16.924924225852205, 18.522894550402135, 17.335600873695633, 17.790542323931586, 17.10113388597077, 17.695566990656516, 16.61037078934329, 16.426154998832843, 18.734441343728466, 18.518350020787825, 18.772829723305072, 17.350605397452473, 15.686622267490318, 19.714619032044038, 19.006736672894142, 18.284806513528817, 21.48915383543898, 16.708969388858808, 17.770754030128774, 19.70495095779085, 14.912370275419686, 16.215454207394902, 18.52279826455622, 20.31991379033011, 16.64986342266326, 22.71943661025911, 19.510848395547185, 15.415821029536511, 16.93752681170651, 18.402865449254893, 21.321099348085482, 14.669206015656563, 17.01067240953875, 16.24921437914261, 15.838003902499718, 20.400980054437067, 19.189213125690127, 18.05756671213356, 18.11320144052813, 17.144354543032794, 17.28742164221599, 17.555345861574708, 16.73697699528859, 18.580291006929645, 18.739621906674337, 19.399845361096986, 17.23279652665949, 16.368566909901922, 15.936705624398215, 19.846507208784377, 19.2591859329641, 16.71557784663523, 15.097142939193562, 18.7662384271812, 18.298504835006472, 18.9920909802001, 18.77780302088453, 17.46444647947651, 19.9830628280561, 18.18192522221812, 16.629038435367423, 22.13373861651616, 17.141344497846468, 21.078924131019672, 18.907410691504985, 17.920501123602904, 18.740570475026765, 19.31876642123679, 19.434421543648945, 17.255742190043495, 17.414549296152128, 20.327808478555664, 17.568390728571085, 17.790743689785284], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0609061602973138, "mean_inference_ms": 8.163290961863918, "mean_action_processing_ms": 0.5578883288769003, "mean_env_wait_ms": 23.885818317505905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015560626983642578, "StateBufferConnector_ms": 0.0301511287689209, "ViewRequirementAgentConnector_ms": 0.9707036018371582}}, "episode_reward_max": 22.71943661025911, "episode_reward_min": 13.812706950702758, "episode_reward_mean": 18.088018726417438, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.874130568832808, 19.227739358323614, 18.086229098615867, 16.749632922623288, 16.482166234033993, 20.406054267887345, 13.812706950702758, 19.615941060672498, 19.953709041347995, 20.230426219508363, 21.113677476485613, 18.539904739682168, 15.617803080222831, 17.255789766834603, 15.58534522672896, 18.381979827238705, 18.98236590107556, 17.01178043773586, 20.107120726315856, 19.37639417988764, 16.432610405715796, 17.034100702071218, 17.966507161550474, 17.42106460204002, 18.129115314907136, 16.77513148693819, 16.924924225852205, 18.522894550402135, 17.335600873695633, 17.790542323931586, 17.10113388597077, 17.695566990656516, 16.61037078934329, 16.426154998832843, 18.734441343728466, 18.518350020787825, 18.772829723305072, 17.350605397452473, 15.686622267490318, 19.714619032044038, 19.006736672894142, 18.284806513528817, 21.48915383543898, 16.708969388858808, 17.770754030128774, 19.70495095779085, 14.912370275419686, 16.215454207394902, 18.52279826455622, 20.31991379033011, 16.64986342266326, 22.71943661025911, 19.510848395547185, 15.415821029536511, 16.93752681170651, 18.402865449254893, 21.321099348085482, 14.669206015656563, 17.01067240953875, 16.24921437914261, 15.838003902499718, 20.400980054437067, 19.189213125690127, 18.05756671213356, 18.11320144052813, 17.144354543032794, 17.28742164221599, 17.555345861574708, 16.73697699528859, 18.580291006929645, 18.739621906674337, 19.399845361096986, 17.23279652665949, 16.368566909901922, 15.936705624398215, 19.846507208784377, 19.2591859329641, 16.71557784663523, 15.097142939193562, 18.7662384271812, 18.298504835006472, 18.9920909802001, 18.77780302088453, 17.46444647947651, 19.9830628280561, 18.18192522221812, 16.629038435367423, 22.13373861651616, 17.141344497846468, 21.078924131019672, 18.907410691504985, 17.920501123602904, 18.740570475026765, 19.31876642123679, 19.434421543648945, 17.255742190043495, 17.414549296152128, 20.327808478555664, 17.568390728571085, 17.790743689785284], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0609061602973138, "mean_inference_ms": 8.163290961863918, "mean_action_processing_ms": 0.5578883288769003, "mean_env_wait_ms": 23.885818317505905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015560626983642578, "StateBufferConnector_ms": 0.0301511287689209, "ViewRequirementAgentConnector_ms": 0.9707036018371582}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2294942, "num_agent_steps_trained": 2294942, "num_env_steps_sampled": 2294942, "num_env_steps_trained": 2294942, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.0035700913708, "num_env_steps_trained_throughput_per_sec": 227.0035700913708, "timesteps_total": 2294942, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2294942, "timers": {"training_iteration_time_ms": 57068.898, "sample_time_ms": 42769.083, "load_time_ms": 1776.452, "load_throughput": 8802.94, "learn_time_ms": 11932.71, "learn_throughput": 1310.515, "synch_weights_time_ms": 476.374}, "counters": {"num_env_steps_sampled": 2294942, "num_env_steps_trained": 2294942, "num_agent_steps_sampled": 2294942, "num_agent_steps_trained": 2294942}, "done": false, "episodes_total": 1190, "training_iteration": 151, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-50-55", "timestamp": 1749246655, "time_this_iter_s": 68.90835571289062, "time_total_s": 4889.777540683746, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4889.777540683746, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 83.60641025641026, "ram_util_percent": 65.93846153846155, "gpu_util_percent0": 0.07269230769230771, "vram_util_percent0": 0.8592122395833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.705057999999999e-05, "total_loss": -0.06972332736223259, "policy_loss": -0.020888445606899703, "vf_loss": 0.017444686827842486, "vf_explained_var": 0.8239386975765228, "kl": 0.016065593857681144, "entropy": 18.370717515078457, "entropy_coeff": 0.0034101160000000012}, "model": {}, "num_grad_updates_lifetime": 47025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2310580, "num_env_steps_trained": 2310580, "num_agent_steps_sampled": 2310580, "num_agent_steps_trained": 2310580}, "sampler_results": {"episode_reward_max": 22.71943661025911, "episode_reward_min": 14.51470185173254, "episode_reward_mean": 18.018475127894263, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.58534522672896, 18.381979827238705, 18.98236590107556, 17.01178043773586, 20.107120726315856, 19.37639417988764, 16.432610405715796, 17.034100702071218, 17.966507161550474, 17.42106460204002, 18.129115314907136, 16.77513148693819, 16.924924225852205, 18.522894550402135, 17.335600873695633, 17.790542323931586, 17.10113388597077, 17.695566990656516, 16.61037078934329, 16.426154998832843, 18.734441343728466, 18.518350020787825, 18.772829723305072, 17.350605397452473, 15.686622267490318, 19.714619032044038, 19.006736672894142, 18.284806513528817, 21.48915383543898, 16.708969388858808, 17.770754030128774, 19.70495095779085, 14.912370275419686, 16.215454207394902, 18.52279826455622, 20.31991379033011, 16.64986342266326, 22.71943661025911, 19.510848395547185, 15.415821029536511, 16.93752681170651, 18.402865449254893, 21.321099348085482, 14.669206015656563, 17.01067240953875, 16.24921437914261, 15.838003902499718, 20.400980054437067, 19.189213125690127, 18.05756671213356, 18.11320144052813, 17.144354543032794, 17.28742164221599, 17.555345861574708, 16.73697699528859, 18.580291006929645, 18.739621906674337, 19.399845361096986, 17.23279652665949, 16.368566909901922, 15.936705624398215, 19.846507208784377, 19.2591859329641, 16.71557784663523, 15.097142939193562, 18.7662384271812, 18.298504835006472, 18.9920909802001, 18.77780302088453, 17.46444647947651, 19.9830628280561, 18.18192522221812, 16.629038435367423, 22.13373861651616, 17.141344497846468, 21.078924131019672, 18.907410691504985, 17.920501123602904, 18.740570475026765, 19.31876642123679, 19.434421543648945, 17.255742190043495, 17.414549296152128, 20.327808478555664, 17.568390728571085, 17.790743689785284, 17.05665432709897, 16.397409198401473, 18.581247299854176, 18.428965996439196, 19.242774547833733, 15.416331488961113, 14.51470185173254, 19.256151145666543, 15.492536582486723, 17.77411705068043, 18.112405324631823, 18.485322342025555, 22.487350918031947, 18.765582859612145], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0609560622876075, "mean_inference_ms": 8.172990195943548, "mean_action_processing_ms": 0.5584314325125845, "mean_env_wait_ms": 23.907095432324812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02169203758239746, "StateBufferConnector_ms": 0.031175613403320312, "ViewRequirementAgentConnector_ms": 0.9926643371582031}}, "episode_reward_max": 22.71943661025911, "episode_reward_min": 14.51470185173254, "episode_reward_mean": 18.018475127894263, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.58534522672896, 18.381979827238705, 18.98236590107556, 17.01178043773586, 20.107120726315856, 19.37639417988764, 16.432610405715796, 17.034100702071218, 17.966507161550474, 17.42106460204002, 18.129115314907136, 16.77513148693819, 16.924924225852205, 18.522894550402135, 17.335600873695633, 17.790542323931586, 17.10113388597077, 17.695566990656516, 16.61037078934329, 16.426154998832843, 18.734441343728466, 18.518350020787825, 18.772829723305072, 17.350605397452473, 15.686622267490318, 19.714619032044038, 19.006736672894142, 18.284806513528817, 21.48915383543898, 16.708969388858808, 17.770754030128774, 19.70495095779085, 14.912370275419686, 16.215454207394902, 18.52279826455622, 20.31991379033011, 16.64986342266326, 22.71943661025911, 19.510848395547185, 15.415821029536511, 16.93752681170651, 18.402865449254893, 21.321099348085482, 14.669206015656563, 17.01067240953875, 16.24921437914261, 15.838003902499718, 20.400980054437067, 19.189213125690127, 18.05756671213356, 18.11320144052813, 17.144354543032794, 17.28742164221599, 17.555345861574708, 16.73697699528859, 18.580291006929645, 18.739621906674337, 19.399845361096986, 17.23279652665949, 16.368566909901922, 15.936705624398215, 19.846507208784377, 19.2591859329641, 16.71557784663523, 15.097142939193562, 18.7662384271812, 18.298504835006472, 18.9920909802001, 18.77780302088453, 17.46444647947651, 19.9830628280561, 18.18192522221812, 16.629038435367423, 22.13373861651616, 17.141344497846468, 21.078924131019672, 18.907410691504985, 17.920501123602904, 18.740570475026765, 19.31876642123679, 19.434421543648945, 17.255742190043495, 17.414549296152128, 20.327808478555664, 17.568390728571085, 17.790743689785284, 17.05665432709897, 16.397409198401473, 18.581247299854176, 18.428965996439196, 19.242774547833733, 15.416331488961113, 14.51470185173254, 19.256151145666543, 15.492536582486723, 17.77411705068043, 18.112405324631823, 18.485322342025555, 22.487350918031947, 18.765582859612145], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0609560622876075, "mean_inference_ms": 8.172990195943548, "mean_action_processing_ms": 0.5584314325125845, "mean_env_wait_ms": 23.907095432324812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02169203758239746, "StateBufferConnector_ms": 0.031175613403320312, "ViewRequirementAgentConnector_ms": 0.9926643371582031}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2310580, "num_agent_steps_trained": 2310580, "num_env_steps_sampled": 2310580, "num_env_steps_trained": 2310580, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 208.18779743434513, "num_env_steps_trained_throughput_per_sec": 208.18779743434513, "timesteps_total": 2310580, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2310580, "timers": {"training_iteration_time_ms": 58988.159, "sample_time_ms": 44147.416, "load_time_ms": 1849.03, "load_throughput": 8457.408, "learn_time_ms": 12268.37, "learn_throughput": 1274.66, "synch_weights_time_ms": 606.666}, "counters": {"num_env_steps_sampled": 2310580, "num_env_steps_trained": 2310580, "num_agent_steps_sampled": 2310580, "num_agent_steps_trained": 2310580}, "done": false, "episodes_total": 1204, "training_iteration": 152, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-52-10", "timestamp": 1749246730, "time_this_iter_s": 75.14848899841309, "time_total_s": 4964.926029682159, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4964.926029682159, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 85.81375, "ram_util_percent": 67.64, "gpu_util_percent0": 0.06999999999999999, "vram_util_percent0": 0.8592122395833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.68942e-05, "total_loss": -0.05943982018073174, "policy_loss": -0.010164910394179804, "vf_loss": 0.014260637439279394, "vf_explained_var": 0.8605140289393338, "kl": 0.015861420170882615, "entropy": 18.35602749564431, "entropy_coeff": 0.0033788400000000006}, "model": {}, "num_grad_updates_lifetime": 47575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2326218, "num_env_steps_trained": 2326218, "num_agent_steps_sampled": 2326218, "num_agent_steps_trained": 2326218}, "sampler_results": {"episode_reward_max": 22.71943661025911, "episode_reward_min": 14.51470185173254, "episode_reward_mean": 18.125071870922927, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.335600873695633, 17.790542323931586, 17.10113388597077, 17.695566990656516, 16.61037078934329, 16.426154998832843, 18.734441343728466, 18.518350020787825, 18.772829723305072, 17.350605397452473, 15.686622267490318, 19.714619032044038, 19.006736672894142, 18.284806513528817, 21.48915383543898, 16.708969388858808, 17.770754030128774, 19.70495095779085, 14.912370275419686, 16.215454207394902, 18.52279826455622, 20.31991379033011, 16.64986342266326, 22.71943661025911, 19.510848395547185, 15.415821029536511, 16.93752681170651, 18.402865449254893, 21.321099348085482, 14.669206015656563, 17.01067240953875, 16.24921437914261, 15.838003902499718, 20.400980054437067, 19.189213125690127, 18.05756671213356, 18.11320144052813, 17.144354543032794, 17.28742164221599, 17.555345861574708, 16.73697699528859, 18.580291006929645, 18.739621906674337, 19.399845361096986, 17.23279652665949, 16.368566909901922, 15.936705624398215, 19.846507208784377, 19.2591859329641, 16.71557784663523, 15.097142939193562, 18.7662384271812, 18.298504835006472, 18.9920909802001, 18.77780302088453, 17.46444647947651, 19.9830628280561, 18.18192522221812, 16.629038435367423, 22.13373861651616, 17.141344497846468, 21.078924131019672, 18.907410691504985, 17.920501123602904, 18.740570475026765, 19.31876642123679, 19.434421543648945, 17.255742190043495, 17.414549296152128, 20.327808478555664, 17.568390728571085, 17.790743689785284, 17.05665432709897, 16.397409198401473, 18.581247299854176, 18.428965996439196, 19.242774547833733, 15.416331488961113, 14.51470185173254, 19.256151145666543, 15.492536582486723, 17.77411705068043, 18.112405324631823, 18.485322342025555, 22.487350918031947, 18.765582859612145, 19.922839369758186, 18.047000700273994, 21.14851832084808, 19.822946258246564, 19.848939532539863, 18.532768609001028, 16.481452512870447, 17.26114394506026, 18.417563676254044, 16.015262570088357, 18.025326643454708, 17.996675822939693, 19.443752290837022, 18.34681879915382], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.060672777275073, "mean_inference_ms": 8.184100703796501, "mean_action_processing_ms": 0.5590820652003959, "mean_env_wait_ms": 23.933335441590867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023790836334228516, "StateBufferConnector_ms": 0.029328107833862305, "ViewRequirementAgentConnector_ms": 1.013709545135498}}, "episode_reward_max": 22.71943661025911, "episode_reward_min": 14.51470185173254, "episode_reward_mean": 18.125071870922927, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.335600873695633, 17.790542323931586, 17.10113388597077, 17.695566990656516, 16.61037078934329, 16.426154998832843, 18.734441343728466, 18.518350020787825, 18.772829723305072, 17.350605397452473, 15.686622267490318, 19.714619032044038, 19.006736672894142, 18.284806513528817, 21.48915383543898, 16.708969388858808, 17.770754030128774, 19.70495095779085, 14.912370275419686, 16.215454207394902, 18.52279826455622, 20.31991379033011, 16.64986342266326, 22.71943661025911, 19.510848395547185, 15.415821029536511, 16.93752681170651, 18.402865449254893, 21.321099348085482, 14.669206015656563, 17.01067240953875, 16.24921437914261, 15.838003902499718, 20.400980054437067, 19.189213125690127, 18.05756671213356, 18.11320144052813, 17.144354543032794, 17.28742164221599, 17.555345861574708, 16.73697699528859, 18.580291006929645, 18.739621906674337, 19.399845361096986, 17.23279652665949, 16.368566909901922, 15.936705624398215, 19.846507208784377, 19.2591859329641, 16.71557784663523, 15.097142939193562, 18.7662384271812, 18.298504835006472, 18.9920909802001, 18.77780302088453, 17.46444647947651, 19.9830628280561, 18.18192522221812, 16.629038435367423, 22.13373861651616, 17.141344497846468, 21.078924131019672, 18.907410691504985, 17.920501123602904, 18.740570475026765, 19.31876642123679, 19.434421543648945, 17.255742190043495, 17.414549296152128, 20.327808478555664, 17.568390728571085, 17.790743689785284, 17.05665432709897, 16.397409198401473, 18.581247299854176, 18.428965996439196, 19.242774547833733, 15.416331488961113, 14.51470185173254, 19.256151145666543, 15.492536582486723, 17.77411705068043, 18.112405324631823, 18.485322342025555, 22.487350918031947, 18.765582859612145, 19.922839369758186, 18.047000700273994, 21.14851832084808, 19.822946258246564, 19.848939532539863, 18.532768609001028, 16.481452512870447, 17.26114394506026, 18.417563676254044, 16.015262570088357, 18.025326643454708, 17.996675822939693, 19.443752290837022, 18.34681879915382], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.060672777275073, "mean_inference_ms": 8.184100703796501, "mean_action_processing_ms": 0.5590820652003959, "mean_env_wait_ms": 23.933335441590867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023790836334228516, "StateBufferConnector_ms": 0.029328107833862305, "ViewRequirementAgentConnector_ms": 1.013709545135498}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2326218, "num_agent_steps_trained": 2326218, "num_env_steps_sampled": 2326218, "num_env_steps_trained": 2326218, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 243.1977946248876, "num_env_steps_trained_throughput_per_sec": 243.1977946248876, "timesteps_total": 2326218, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2326218, "timers": {"training_iteration_time_ms": 59806.784, "sample_time_ms": 44604.678, "load_time_ms": 1918.633, "load_throughput": 8150.596, "learn_time_ms": 12540.271, "learn_throughput": 1247.022, "synch_weights_time_ms": 620.924}, "counters": {"num_env_steps_sampled": 2326218, "num_env_steps_trained": 2326218, "num_agent_steps_sampled": 2326218, "num_agent_steps_trained": 2326218}, "done": false, "episodes_total": 1218, "training_iteration": 153, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-53-14", "timestamp": 1749246794, "time_this_iter_s": 64.31762361526489, "time_total_s": 5029.243653297424, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5029.243653297424, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 83.34444444444443, "ram_util_percent": 72.7875, "gpu_util_percent0": 0.065, "vram_util_percent0": 0.8637740523726851}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.673781999999998e-05, "total_loss": -0.07066000955412165, "policy_loss": -0.02207760241083716, "vf_loss": 0.01580417864574966, "vf_explained_var": 0.8529160527749495, "kl": 0.015420456235459208, "entropy": 18.38865263678811, "entropy_coeff": 0.003347564000000001}, "model": {}, "num_grad_updates_lifetime": 48125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2341856, "num_env_steps_trained": 2341856, "num_agent_steps_sampled": 2341856, "num_agent_steps_trained": 2341856}, "sampler_results": {"episode_reward_max": 22.71943661025911, "episode_reward_min": 14.51470185173254, "episode_reward_mean": 18.31457168700892, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.48915383543898, 16.708969388858808, 17.770754030128774, 19.70495095779085, 14.912370275419686, 16.215454207394902, 18.52279826455622, 20.31991379033011, 16.64986342266326, 22.71943661025911, 19.510848395547185, 15.415821029536511, 16.93752681170651, 18.402865449254893, 21.321099348085482, 14.669206015656563, 17.01067240953875, 16.24921437914261, 15.838003902499718, 20.400980054437067, 19.189213125690127, 18.05756671213356, 18.11320144052813, 17.144354543032794, 17.28742164221599, 17.555345861574708, 16.73697699528859, 18.580291006929645, 18.739621906674337, 19.399845361096986, 17.23279652665949, 16.368566909901922, 15.936705624398215, 19.846507208784377, 19.2591859329641, 16.71557784663523, 15.097142939193562, 18.7662384271812, 18.298504835006472, 18.9920909802001, 18.77780302088453, 17.46444647947651, 19.9830628280561, 18.18192522221812, 16.629038435367423, 22.13373861651616, 17.141344497846468, 21.078924131019672, 18.907410691504985, 17.920501123602904, 18.740570475026765, 19.31876642123679, 19.434421543648945, 17.255742190043495, 17.414549296152128, 20.327808478555664, 17.568390728571085, 17.790743689785284, 17.05665432709897, 16.397409198401473, 18.581247299854176, 18.428965996439196, 19.242774547833733, 15.416331488961113, 14.51470185173254, 19.256151145666543, 15.492536582486723, 17.77411705068043, 18.112405324631823, 18.485322342025555, 22.487350918031947, 18.765582859612145, 19.922839369758186, 18.047000700273994, 21.14851832084808, 19.822946258246564, 19.848939532539863, 18.532768609001028, 16.481452512870447, 17.26114394506026, 18.417563676254044, 16.015262570088357, 18.025326643454708, 17.996675822939693, 19.443752290837022, 18.34681879915382, 21.68520006376769, 18.155169668404803, 17.988948406777943, 18.163127140082587, 18.11261130880997, 20.445169276299747, 21.322984442339852, 16.026466424217887, 16.735475356382928, 18.775050003006484, 20.36697118373334, 22.144939341407724, 20.29968266941386, 17.756567157616388], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.060768608365901, "mean_inference_ms": 8.196777603008229, "mean_action_processing_ms": 0.5598282792614377, "mean_env_wait_ms": 23.966637083799416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03326869010925293, "StateBufferConnector_ms": 0.03254532814025879, "ViewRequirementAgentConnector_ms": 1.0553553104400635}}, "episode_reward_max": 22.71943661025911, "episode_reward_min": 14.51470185173254, "episode_reward_mean": 18.31457168700892, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.48915383543898, 16.708969388858808, 17.770754030128774, 19.70495095779085, 14.912370275419686, 16.215454207394902, 18.52279826455622, 20.31991379033011, 16.64986342266326, 22.71943661025911, 19.510848395547185, 15.415821029536511, 16.93752681170651, 18.402865449254893, 21.321099348085482, 14.669206015656563, 17.01067240953875, 16.24921437914261, 15.838003902499718, 20.400980054437067, 19.189213125690127, 18.05756671213356, 18.11320144052813, 17.144354543032794, 17.28742164221599, 17.555345861574708, 16.73697699528859, 18.580291006929645, 18.739621906674337, 19.399845361096986, 17.23279652665949, 16.368566909901922, 15.936705624398215, 19.846507208784377, 19.2591859329641, 16.71557784663523, 15.097142939193562, 18.7662384271812, 18.298504835006472, 18.9920909802001, 18.77780302088453, 17.46444647947651, 19.9830628280561, 18.18192522221812, 16.629038435367423, 22.13373861651616, 17.141344497846468, 21.078924131019672, 18.907410691504985, 17.920501123602904, 18.740570475026765, 19.31876642123679, 19.434421543648945, 17.255742190043495, 17.414549296152128, 20.327808478555664, 17.568390728571085, 17.790743689785284, 17.05665432709897, 16.397409198401473, 18.581247299854176, 18.428965996439196, 19.242774547833733, 15.416331488961113, 14.51470185173254, 19.256151145666543, 15.492536582486723, 17.77411705068043, 18.112405324631823, 18.485322342025555, 22.487350918031947, 18.765582859612145, 19.922839369758186, 18.047000700273994, 21.14851832084808, 19.822946258246564, 19.848939532539863, 18.532768609001028, 16.481452512870447, 17.26114394506026, 18.417563676254044, 16.015262570088357, 18.025326643454708, 17.996675822939693, 19.443752290837022, 18.34681879915382, 21.68520006376769, 18.155169668404803, 17.988948406777943, 18.163127140082587, 18.11261130880997, 20.445169276299747, 21.322984442339852, 16.026466424217887, 16.735475356382928, 18.775050003006484, 20.36697118373334, 22.144939341407724, 20.29968266941386, 17.756567157616388], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.060768608365901, "mean_inference_ms": 8.196777603008229, "mean_action_processing_ms": 0.5598282792614377, "mean_env_wait_ms": 23.966637083799416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03326869010925293, "StateBufferConnector_ms": 0.03254532814025879, "ViewRequirementAgentConnector_ms": 1.0553553104400635}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2341856, "num_agent_steps_trained": 2341856, "num_env_steps_sampled": 2341856, "num_env_steps_trained": 2341856, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 232.2421658412747, "num_env_steps_trained_throughput_per_sec": 232.2421658412747, "timesteps_total": 2341856, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2341856, "timers": {"training_iteration_time_ms": 61018.807, "sample_time_ms": 45359.066, "load_time_ms": 2030.503, "load_throughput": 7701.54, "learn_time_ms": 12880.829, "learn_throughput": 1214.052, "synch_weights_time_ms": 620.279}, "counters": {"num_env_steps_sampled": 2341856, "num_env_steps_trained": 2341856, "num_agent_steps_sampled": 2341856, "num_agent_steps_trained": 2341856}, "done": false, "episodes_total": 1232, "training_iteration": 154, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-54-22", "timestamp": 1749246862, "time_this_iter_s": 67.35042142868042, "time_total_s": 5096.594074726105, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5096.594074726105, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 83.40666666666665, "ram_util_percent": 76.184, "gpu_util_percent0": 0.08306666666666666, "vram_util_percent0": 0.8919270833333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.658144000000001e-05, "total_loss": -0.07668508063663136, "policy_loss": -0.02873352054982785, "vf_loss": 0.014724296479147267, "vf_explained_var": 0.8485682052915746, "kl": 0.01594599863355556, "entropy": 18.358774129694158, "entropy_coeff": 0.003316288}, "model": {}, "num_grad_updates_lifetime": 48675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2357494, "num_env_steps_trained": 2357494, "num_agent_steps_sampled": 2357494, "num_agent_steps_trained": 2357494}, "sampler_results": {"episode_reward_max": 22.487350918031947, "episode_reward_min": 14.51470185173254, "episode_reward_mean": 18.439224685296654, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.321099348085482, 14.669206015656563, 17.01067240953875, 16.24921437914261, 15.838003902499718, 20.400980054437067, 19.189213125690127, 18.05756671213356, 18.11320144052813, 17.144354543032794, 17.28742164221599, 17.555345861574708, 16.73697699528859, 18.580291006929645, 18.739621906674337, 19.399845361096986, 17.23279652665949, 16.368566909901922, 15.936705624398215, 19.846507208784377, 19.2591859329641, 16.71557784663523, 15.097142939193562, 18.7662384271812, 18.298504835006472, 18.9920909802001, 18.77780302088453, 17.46444647947651, 19.9830628280561, 18.18192522221812, 16.629038435367423, 22.13373861651616, 17.141344497846468, 21.078924131019672, 18.907410691504985, 17.920501123602904, 18.740570475026765, 19.31876642123679, 19.434421543648945, 17.255742190043495, 17.414549296152128, 20.327808478555664, 17.568390728571085, 17.790743689785284, 17.05665432709897, 16.397409198401473, 18.581247299854176, 18.428965996439196, 19.242774547833733, 15.416331488961113, 14.51470185173254, 19.256151145666543, 15.492536582486723, 17.77411705068043, 18.112405324631823, 18.485322342025555, 22.487350918031947, 18.765582859612145, 19.922839369758186, 18.047000700273994, 21.14851832084808, 19.822946258246564, 19.848939532539863, 18.532768609001028, 16.481452512870447, 17.26114394506026, 18.417563676254044, 16.015262570088357, 18.025326643454708, 17.996675822939693, 19.443752290837022, 18.34681879915382, 21.68520006376769, 18.155169668404803, 17.988948406777943, 18.163127140082587, 18.11261130880997, 20.445169276299747, 21.322984442339852, 16.026466424217887, 16.735475356382928, 18.775050003006484, 20.36697118373334, 22.144939341407724, 20.29968266941386, 17.756567157616388, 19.37103666030328, 18.178402886800576, 18.52196309499719, 17.2877109065379, 19.222546139430943, 20.028000463721902, 17.493976000645475, 18.82038815687385, 19.95313249162914, 19.540466511776152, 19.292728527055992, 17.70198404216743, 22.013469065611734, 20.320221350107133], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0609260587168694, "mean_inference_ms": 8.20919649396019, "mean_action_processing_ms": 0.5605591943213222, "mean_env_wait_ms": 24.001002894930316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042394399642944336, "StateBufferConnector_ms": 0.041011810302734375, "ViewRequirementAgentConnector_ms": 1.0557870864868164}}, "episode_reward_max": 22.487350918031947, "episode_reward_min": 14.51470185173254, "episode_reward_mean": 18.439224685296654, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.321099348085482, 14.669206015656563, 17.01067240953875, 16.24921437914261, 15.838003902499718, 20.400980054437067, 19.189213125690127, 18.05756671213356, 18.11320144052813, 17.144354543032794, 17.28742164221599, 17.555345861574708, 16.73697699528859, 18.580291006929645, 18.739621906674337, 19.399845361096986, 17.23279652665949, 16.368566909901922, 15.936705624398215, 19.846507208784377, 19.2591859329641, 16.71557784663523, 15.097142939193562, 18.7662384271812, 18.298504835006472, 18.9920909802001, 18.77780302088453, 17.46444647947651, 19.9830628280561, 18.18192522221812, 16.629038435367423, 22.13373861651616, 17.141344497846468, 21.078924131019672, 18.907410691504985, 17.920501123602904, 18.740570475026765, 19.31876642123679, 19.434421543648945, 17.255742190043495, 17.414549296152128, 20.327808478555664, 17.568390728571085, 17.790743689785284, 17.05665432709897, 16.397409198401473, 18.581247299854176, 18.428965996439196, 19.242774547833733, 15.416331488961113, 14.51470185173254, 19.256151145666543, 15.492536582486723, 17.77411705068043, 18.112405324631823, 18.485322342025555, 22.487350918031947, 18.765582859612145, 19.922839369758186, 18.047000700273994, 21.14851832084808, 19.822946258246564, 19.848939532539863, 18.532768609001028, 16.481452512870447, 17.26114394506026, 18.417563676254044, 16.015262570088357, 18.025326643454708, 17.996675822939693, 19.443752290837022, 18.34681879915382, 21.68520006376769, 18.155169668404803, 17.988948406777943, 18.163127140082587, 18.11261130880997, 20.445169276299747, 21.322984442339852, 16.026466424217887, 16.735475356382928, 18.775050003006484, 20.36697118373334, 22.144939341407724, 20.29968266941386, 17.756567157616388, 19.37103666030328, 18.178402886800576, 18.52196309499719, 17.2877109065379, 19.222546139430943, 20.028000463721902, 17.493976000645475, 18.82038815687385, 19.95313249162914, 19.540466511776152, 19.292728527055992, 17.70198404216743, 22.013469065611734, 20.320221350107133], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0609260587168694, "mean_inference_ms": 8.20919649396019, "mean_action_processing_ms": 0.5605591943213222, "mean_env_wait_ms": 24.001002894930316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042394399642944336, "StateBufferConnector_ms": 0.041011810302734375, "ViewRequirementAgentConnector_ms": 1.0557870864868164}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2357494, "num_agent_steps_trained": 2357494, "num_env_steps_sampled": 2357494, "num_env_steps_trained": 2357494, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 275.60805745775576, "num_env_steps_trained_throughput_per_sec": 275.60805745775576, "timesteps_total": 2357494, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2357494, "timers": {"training_iteration_time_ms": 61075.375, "sample_time_ms": 45445.5, "load_time_ms": 2048.189, "load_throughput": 7635.037, "learn_time_ms": 12805.958, "learn_throughput": 1221.15, "synch_weights_time_ms": 646.782}, "counters": {"num_env_steps_sampled": 2357494, "num_env_steps_trained": 2357494, "num_agent_steps_sampled": 2357494, "num_agent_steps_trained": 2357494}, "done": false, "episodes_total": 1246, "training_iteration": 155, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-55-19", "timestamp": 1749246919, "time_this_iter_s": 56.75577116012573, "time_total_s": 5153.3498458862305, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5153.3498458862305, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 78.46507936507938, "ram_util_percent": 75.56984126984126, "gpu_util_percent0": 0.08396825396825397, "vram_util_percent0": 0.8919270833333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.642506e-05, "total_loss": -0.06711559342559088, "policy_loss": -0.020308898782558656, "vf_loss": 0.01596075026868758, "vf_explained_var": 0.8401096220449967, "kl": 0.016444152208965866, "entropy": 18.378939625133167, "entropy_coeff": 0.0032850120000000008}, "model": {}, "num_grad_updates_lifetime": 49225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2373132, "num_env_steps_trained": 2373132, "num_agent_steps_sampled": 2373132, "num_agent_steps_trained": 2373132}, "sampler_results": {"episode_reward_max": 22.487350918031947, "episode_reward_min": 14.400546165677051, "episode_reward_mean": 18.526773433626644, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.739621906674337, 19.399845361096986, 17.23279652665949, 16.368566909901922, 15.936705624398215, 19.846507208784377, 19.2591859329641, 16.71557784663523, 15.097142939193562, 18.7662384271812, 18.298504835006472, 18.9920909802001, 18.77780302088453, 17.46444647947651, 19.9830628280561, 18.18192522221812, 16.629038435367423, 22.13373861651616, 17.141344497846468, 21.078924131019672, 18.907410691504985, 17.920501123602904, 18.740570475026765, 19.31876642123679, 19.434421543648945, 17.255742190043495, 17.414549296152128, 20.327808478555664, 17.568390728571085, 17.790743689785284, 17.05665432709897, 16.397409198401473, 18.581247299854176, 18.428965996439196, 19.242774547833733, 15.416331488961113, 14.51470185173254, 19.256151145666543, 15.492536582486723, 17.77411705068043, 18.112405324631823, 18.485322342025555, 22.487350918031947, 18.765582859612145, 19.922839369758186, 18.047000700273994, 21.14851832084808, 19.822946258246564, 19.848939532539863, 18.532768609001028, 16.481452512870447, 17.26114394506026, 18.417563676254044, 16.015262570088357, 18.025326643454708, 17.996675822939693, 19.443752290837022, 18.34681879915382, 21.68520006376769, 18.155169668404803, 17.988948406777943, 18.163127140082587, 18.11261130880997, 20.445169276299747, 21.322984442339852, 16.026466424217887, 16.735475356382928, 18.775050003006484, 20.36697118373334, 22.144939341407724, 20.29968266941386, 17.756567157616388, 19.37103666030328, 18.178402886800576, 18.52196309499719, 17.2877109065379, 19.222546139430943, 20.028000463721902, 17.493976000645475, 18.82038815687385, 19.95313249162914, 19.540466511776152, 19.292728527055992, 17.70198404216743, 22.013469065611734, 20.320221350107133, 19.164741149810972, 16.750062638109465, 17.71896294979561, 20.852469220741586, 17.531056915880487, 19.316014458991607, 21.608826669701568, 16.62397835654687, 17.31876480087565, 19.457187685958974, 19.54998322650792, 14.400546165677051, 20.55282669324782, 16.063001337907423], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.060640151224612, "mean_inference_ms": 8.221079674159974, "mean_action_processing_ms": 0.5612559204245463, "mean_env_wait_ms": 24.03560259466336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045458316802978516, "StateBufferConnector_ms": 0.04104876518249512, "ViewRequirementAgentConnector_ms": 1.0625574588775635}}, "episode_reward_max": 22.487350918031947, "episode_reward_min": 14.400546165677051, "episode_reward_mean": 18.526773433626644, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.739621906674337, 19.399845361096986, 17.23279652665949, 16.368566909901922, 15.936705624398215, 19.846507208784377, 19.2591859329641, 16.71557784663523, 15.097142939193562, 18.7662384271812, 18.298504835006472, 18.9920909802001, 18.77780302088453, 17.46444647947651, 19.9830628280561, 18.18192522221812, 16.629038435367423, 22.13373861651616, 17.141344497846468, 21.078924131019672, 18.907410691504985, 17.920501123602904, 18.740570475026765, 19.31876642123679, 19.434421543648945, 17.255742190043495, 17.414549296152128, 20.327808478555664, 17.568390728571085, 17.790743689785284, 17.05665432709897, 16.397409198401473, 18.581247299854176, 18.428965996439196, 19.242774547833733, 15.416331488961113, 14.51470185173254, 19.256151145666543, 15.492536582486723, 17.77411705068043, 18.112405324631823, 18.485322342025555, 22.487350918031947, 18.765582859612145, 19.922839369758186, 18.047000700273994, 21.14851832084808, 19.822946258246564, 19.848939532539863, 18.532768609001028, 16.481452512870447, 17.26114394506026, 18.417563676254044, 16.015262570088357, 18.025326643454708, 17.996675822939693, 19.443752290837022, 18.34681879915382, 21.68520006376769, 18.155169668404803, 17.988948406777943, 18.163127140082587, 18.11261130880997, 20.445169276299747, 21.322984442339852, 16.026466424217887, 16.735475356382928, 18.775050003006484, 20.36697118373334, 22.144939341407724, 20.29968266941386, 17.756567157616388, 19.37103666030328, 18.178402886800576, 18.52196309499719, 17.2877109065379, 19.222546139430943, 20.028000463721902, 17.493976000645475, 18.82038815687385, 19.95313249162914, 19.540466511776152, 19.292728527055992, 17.70198404216743, 22.013469065611734, 20.320221350107133, 19.164741149810972, 16.750062638109465, 17.71896294979561, 20.852469220741586, 17.531056915880487, 19.316014458991607, 21.608826669701568, 16.62397835654687, 17.31876480087565, 19.457187685958974, 19.54998322650792, 14.400546165677051, 20.55282669324782, 16.063001337907423], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.060640151224612, "mean_inference_ms": 8.221079674159974, "mean_action_processing_ms": 0.5612559204245463, "mean_env_wait_ms": 24.03560259466336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045458316802978516, "StateBufferConnector_ms": 0.04104876518249512, "ViewRequirementAgentConnector_ms": 1.0625574588775635}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2373132, "num_agent_steps_trained": 2373132, "num_env_steps_sampled": 2373132, "num_env_steps_trained": 2373132, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 279.97899594694064, "num_env_steps_trained_throughput_per_sec": 279.97899594694064, "timesteps_total": 2373132, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2373132, "timers": {"training_iteration_time_ms": 61103.85, "sample_time_ms": 45478.183, "load_time_ms": 2092.277, "load_throughput": 7474.154, "learn_time_ms": 12755.951, "learn_throughput": 1225.938, "synch_weights_time_ms": 648.118}, "counters": {"num_env_steps_sampled": 2373132, "num_env_steps_trained": 2373132, "num_agent_steps_sampled": 2373132, "num_agent_steps_trained": 2373132}, "done": false, "episodes_total": 1260, "training_iteration": 156, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-56-15", "timestamp": 1749246975, "time_this_iter_s": 55.8699836730957, "time_total_s": 5209.219829559326, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5209.219829559326, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 78.365625, "ram_util_percent": 75.30781250000001, "gpu_util_percent0": 0.079375, "vram_util_percent0": 0.8919270833333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.626868000000002e-05, "total_loss": -0.07460341919679195, "policy_loss": -0.02745301138821312, "vf_loss": 0.014552787293002687, "vf_explained_var": 0.8422519885409963, "kl": 0.015645261037389002, "entropy": 18.40032633001154, "entropy_coeff": 0.003253736}, "model": {}, "num_grad_updates_lifetime": 49775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2388770, "num_env_steps_trained": 2388770, "num_agent_steps_sampled": 2388770, "num_agent_steps_trained": 2388770}, "sampler_results": {"episode_reward_max": 22.487350918031947, "episode_reward_min": 14.400546165677051, "episode_reward_mean": 18.579457426817328, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.9830628280561, 18.18192522221812, 16.629038435367423, 22.13373861651616, 17.141344497846468, 21.078924131019672, 18.907410691504985, 17.920501123602904, 18.740570475026765, 19.31876642123679, 19.434421543648945, 17.255742190043495, 17.414549296152128, 20.327808478555664, 17.568390728571085, 17.790743689785284, 17.05665432709897, 16.397409198401473, 18.581247299854176, 18.428965996439196, 19.242774547833733, 15.416331488961113, 14.51470185173254, 19.256151145666543, 15.492536582486723, 17.77411705068043, 18.112405324631823, 18.485322342025555, 22.487350918031947, 18.765582859612145, 19.922839369758186, 18.047000700273994, 21.14851832084808, 19.822946258246564, 19.848939532539863, 18.532768609001028, 16.481452512870447, 17.26114394506026, 18.417563676254044, 16.015262570088357, 18.025326643454708, 17.996675822939693, 19.443752290837022, 18.34681879915382, 21.68520006376769, 18.155169668404803, 17.988948406777943, 18.163127140082587, 18.11261130880997, 20.445169276299747, 21.322984442339852, 16.026466424217887, 16.735475356382928, 18.775050003006484, 20.36697118373334, 22.144939341407724, 20.29968266941386, 17.756567157616388, 19.37103666030328, 18.178402886800576, 18.52196309499719, 17.2877109065379, 19.222546139430943, 20.028000463721902, 17.493976000645475, 18.82038815687385, 19.95313249162914, 19.540466511776152, 19.292728527055992, 17.70198404216743, 22.013469065611734, 20.320221350107133, 19.164741149810972, 16.750062638109465, 17.71896294979561, 20.852469220741586, 17.531056915880487, 19.316014458991607, 21.608826669701568, 16.62397835654687, 17.31876480087565, 19.457187685958974, 19.54998322650792, 14.400546165677051, 20.55282669324782, 16.063001337907423, 20.831203583616865, 18.192762199458542, 18.99450481521017, 17.063791713182496, 17.267728005242574, 14.832066823417454, 18.202057404732077, 17.11959827014895, 19.61833282355995, 17.722469653285106, 19.836539980712512, 18.749622345744854, 21.488019992913603, 16.244735706900105], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0602847708319523, "mean_inference_ms": 8.232501747402814, "mean_action_processing_ms": 0.5619086602209352, "mean_env_wait_ms": 24.070469844324553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.051253557205200195, "StateBufferConnector_ms": 0.04503512382507324, "ViewRequirementAgentConnector_ms": 1.080873966217041}}, "episode_reward_max": 22.487350918031947, "episode_reward_min": 14.400546165677051, "episode_reward_mean": 18.579457426817328, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.9830628280561, 18.18192522221812, 16.629038435367423, 22.13373861651616, 17.141344497846468, 21.078924131019672, 18.907410691504985, 17.920501123602904, 18.740570475026765, 19.31876642123679, 19.434421543648945, 17.255742190043495, 17.414549296152128, 20.327808478555664, 17.568390728571085, 17.790743689785284, 17.05665432709897, 16.397409198401473, 18.581247299854176, 18.428965996439196, 19.242774547833733, 15.416331488961113, 14.51470185173254, 19.256151145666543, 15.492536582486723, 17.77411705068043, 18.112405324631823, 18.485322342025555, 22.487350918031947, 18.765582859612145, 19.922839369758186, 18.047000700273994, 21.14851832084808, 19.822946258246564, 19.848939532539863, 18.532768609001028, 16.481452512870447, 17.26114394506026, 18.417563676254044, 16.015262570088357, 18.025326643454708, 17.996675822939693, 19.443752290837022, 18.34681879915382, 21.68520006376769, 18.155169668404803, 17.988948406777943, 18.163127140082587, 18.11261130880997, 20.445169276299747, 21.322984442339852, 16.026466424217887, 16.735475356382928, 18.775050003006484, 20.36697118373334, 22.144939341407724, 20.29968266941386, 17.756567157616388, 19.37103666030328, 18.178402886800576, 18.52196309499719, 17.2877109065379, 19.222546139430943, 20.028000463721902, 17.493976000645475, 18.82038815687385, 19.95313249162914, 19.540466511776152, 19.292728527055992, 17.70198404216743, 22.013469065611734, 20.320221350107133, 19.164741149810972, 16.750062638109465, 17.71896294979561, 20.852469220741586, 17.531056915880487, 19.316014458991607, 21.608826669701568, 16.62397835654687, 17.31876480087565, 19.457187685958974, 19.54998322650792, 14.400546165677051, 20.55282669324782, 16.063001337907423, 20.831203583616865, 18.192762199458542, 18.99450481521017, 17.063791713182496, 17.267728005242574, 14.832066823417454, 18.202057404732077, 17.11959827014895, 19.61833282355995, 17.722469653285106, 19.836539980712512, 18.749622345744854, 21.488019992913603, 16.244735706900105], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0602847708319523, "mean_inference_ms": 8.232501747402814, "mean_action_processing_ms": 0.5619086602209352, "mean_env_wait_ms": 24.070469844324553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.051253557205200195, "StateBufferConnector_ms": 0.04503512382507324, "ViewRequirementAgentConnector_ms": 1.080873966217041}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2388770, "num_agent_steps_trained": 2388770, "num_env_steps_sampled": 2388770, "num_env_steps_trained": 2388770, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 275.1653332351321, "num_env_steps_trained_throughput_per_sec": 275.1653332351321, "timesteps_total": 2388770, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2388770, "timers": {"training_iteration_time_ms": 61244.848, "sample_time_ms": 45561.685, "load_time_ms": 2102.168, "load_throughput": 7438.985, "learn_time_ms": 12797.897, "learn_throughput": 1221.919, "synch_weights_time_ms": 654.896}, "counters": {"num_env_steps_sampled": 2388770, "num_env_steps_trained": 2388770, "num_agent_steps_sampled": 2388770, "num_agent_steps_trained": 2388770}, "done": false, "episodes_total": 1274, "training_iteration": 157, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-57-12", "timestamp": 1749247032, "time_this_iter_s": 56.84827375411987, "time_total_s": 5266.068103313446, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5266.068103313446, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 78.62968749999999, "ram_util_percent": 75.1140625, "gpu_util_percent0": 0.08359375, "vram_util_percent0": 0.8919270833333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.611230000000001e-05, "total_loss": -0.06650612950960005, "policy_loss": -0.019714821684610796, "vf_loss": 0.014587776722725142, "vf_explained_var": 0.830257845250043, "kl": 0.015148435712842249, "entropy": 18.388414464430376, "entropy_coeff": 0.00322246}, "model": {}, "num_grad_updates_lifetime": 50325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2404408, "num_env_steps_trained": 2404408, "num_agent_steps_sampled": 2404408, "num_agent_steps_trained": 2404408}, "sampler_results": {"episode_reward_max": 22.487350918031947, "episode_reward_min": 14.400546165677051, "episode_reward_mean": 18.45627742881835, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.568390728571085, 17.790743689785284, 17.05665432709897, 16.397409198401473, 18.581247299854176, 18.428965996439196, 19.242774547833733, 15.416331488961113, 14.51470185173254, 19.256151145666543, 15.492536582486723, 17.77411705068043, 18.112405324631823, 18.485322342025555, 22.487350918031947, 18.765582859612145, 19.922839369758186, 18.047000700273994, 21.14851832084808, 19.822946258246564, 19.848939532539863, 18.532768609001028, 16.481452512870447, 17.26114394506026, 18.417563676254044, 16.015262570088357, 18.025326643454708, 17.996675822939693, 19.443752290837022, 18.34681879915382, 21.68520006376769, 18.155169668404803, 17.988948406777943, 18.163127140082587, 18.11261130880997, 20.445169276299747, 21.322984442339852, 16.026466424217887, 16.735475356382928, 18.775050003006484, 20.36697118373334, 22.144939341407724, 20.29968266941386, 17.756567157616388, 19.37103666030328, 18.178402886800576, 18.52196309499719, 17.2877109065379, 19.222546139430943, 20.028000463721902, 17.493976000645475, 18.82038815687385, 19.95313249162914, 19.540466511776152, 19.292728527055992, 17.70198404216743, 22.013469065611734, 20.320221350107133, 19.164741149810972, 16.750062638109465, 17.71896294979561, 20.852469220741586, 17.531056915880487, 19.316014458991607, 21.608826669701568, 16.62397835654687, 17.31876480087565, 19.457187685958974, 19.54998322650792, 14.400546165677051, 20.55282669324782, 16.063001337907423, 20.831203583616865, 18.192762199458542, 18.99450481521017, 17.063791713182496, 17.267728005242574, 14.832066823417454, 18.202057404732077, 17.11959827014895, 19.61833282355995, 17.722469653285106, 19.836539980712512, 18.749622345744854, 21.488019992913603, 16.244735706900105, 20.797006264013852, 17.815923583415902, 16.61189909018442, 16.63849893523114, 18.42695854275211, 16.661192060963096, 18.677539534912636, 21.62753744138301, 17.485377222905488, 16.9076683454715, 18.798293533837914, 18.181863722060466, 15.958666214719177, 17.561379659047248], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.059628177631292, "mean_inference_ms": 8.2411561520568, "mean_action_processing_ms": 0.5624513655161791, "mean_env_wait_ms": 24.102351727597448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05688929557800293, "StateBufferConnector_ms": 0.04393172264099121, "ViewRequirementAgentConnector_ms": 1.1115868091583252}}, "episode_reward_max": 22.487350918031947, "episode_reward_min": 14.400546165677051, "episode_reward_mean": 18.45627742881835, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.568390728571085, 17.790743689785284, 17.05665432709897, 16.397409198401473, 18.581247299854176, 18.428965996439196, 19.242774547833733, 15.416331488961113, 14.51470185173254, 19.256151145666543, 15.492536582486723, 17.77411705068043, 18.112405324631823, 18.485322342025555, 22.487350918031947, 18.765582859612145, 19.922839369758186, 18.047000700273994, 21.14851832084808, 19.822946258246564, 19.848939532539863, 18.532768609001028, 16.481452512870447, 17.26114394506026, 18.417563676254044, 16.015262570088357, 18.025326643454708, 17.996675822939693, 19.443752290837022, 18.34681879915382, 21.68520006376769, 18.155169668404803, 17.988948406777943, 18.163127140082587, 18.11261130880997, 20.445169276299747, 21.322984442339852, 16.026466424217887, 16.735475356382928, 18.775050003006484, 20.36697118373334, 22.144939341407724, 20.29968266941386, 17.756567157616388, 19.37103666030328, 18.178402886800576, 18.52196309499719, 17.2877109065379, 19.222546139430943, 20.028000463721902, 17.493976000645475, 18.82038815687385, 19.95313249162914, 19.540466511776152, 19.292728527055992, 17.70198404216743, 22.013469065611734, 20.320221350107133, 19.164741149810972, 16.750062638109465, 17.71896294979561, 20.852469220741586, 17.531056915880487, 19.316014458991607, 21.608826669701568, 16.62397835654687, 17.31876480087565, 19.457187685958974, 19.54998322650792, 14.400546165677051, 20.55282669324782, 16.063001337907423, 20.831203583616865, 18.192762199458542, 18.99450481521017, 17.063791713182496, 17.267728005242574, 14.832066823417454, 18.202057404732077, 17.11959827014895, 19.61833282355995, 17.722469653285106, 19.836539980712512, 18.749622345744854, 21.488019992913603, 16.244735706900105, 20.797006264013852, 17.815923583415902, 16.61189909018442, 16.63849893523114, 18.42695854275211, 16.661192060963096, 18.677539534912636, 21.62753744138301, 17.485377222905488, 16.9076683454715, 18.798293533837914, 18.181863722060466, 15.958666214719177, 17.561379659047248], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.059628177631292, "mean_inference_ms": 8.2411561520568, "mean_action_processing_ms": 0.5624513655161791, "mean_env_wait_ms": 24.102351727597448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05688929557800293, "StateBufferConnector_ms": 0.04393172264099121, "ViewRequirementAgentConnector_ms": 1.1115868091583252}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2404408, "num_agent_steps_trained": 2404408, "num_env_steps_sampled": 2404408, "num_env_steps_trained": 2404408, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 254.14750347085445, "num_env_steps_trained_throughput_per_sec": 254.14750347085445, "timesteps_total": 2404408, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2404408, "timers": {"training_iteration_time_ms": 61806.023, "sample_time_ms": 45955.352, "load_time_ms": 2114.722, "load_throughput": 7394.825, "learn_time_ms": 12949.677, "learn_throughput": 1207.598, "synch_weights_time_ms": 657.522}, "counters": {"num_env_steps_sampled": 2404408, "num_env_steps_trained": 2404408, "num_agent_steps_sampled": 2404408, "num_agent_steps_trained": 2404408}, "done": false, "episodes_total": 1288, "training_iteration": 158, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-58-13", "timestamp": 1749247093, "time_this_iter_s": 61.55024743080139, "time_total_s": 5327.618350744247, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5327.618350744247, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 78.36376811594204, "ram_util_percent": 74.70144927536234, "gpu_util_percent0": 0.07884057971014494, "vram_util_percent0": 0.8919270833333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.595592e-05, "total_loss": -0.08660491367632693, "policy_loss": -0.03979791876045056, "vf_loss": 0.013076679103753784, "vf_explained_var": 0.8500628001039678, "kl": 0.015289995424446675, "entropy": 18.45517881740223, "entropy_coeff": 0.0031911840000000006}, "model": {}, "num_grad_updates_lifetime": 50875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2420046, "num_env_steps_trained": 2420046, "num_agent_steps_sampled": 2420046, "num_agent_steps_trained": 2420046}, "sampler_results": {"episode_reward_max": 22.487350918031947, "episode_reward_min": 14.400546165677051, "episode_reward_mean": 18.603949686878824, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.487350918031947, 18.765582859612145, 19.922839369758186, 18.047000700273994, 21.14851832084808, 19.822946258246564, 19.848939532539863, 18.532768609001028, 16.481452512870447, 17.26114394506026, 18.417563676254044, 16.015262570088357, 18.025326643454708, 17.996675822939693, 19.443752290837022, 18.34681879915382, 21.68520006376769, 18.155169668404803, 17.988948406777943, 18.163127140082587, 18.11261130880997, 20.445169276299747, 21.322984442339852, 16.026466424217887, 16.735475356382928, 18.775050003006484, 20.36697118373334, 22.144939341407724, 20.29968266941386, 17.756567157616388, 19.37103666030328, 18.178402886800576, 18.52196309499719, 17.2877109065379, 19.222546139430943, 20.028000463721902, 17.493976000645475, 18.82038815687385, 19.95313249162914, 19.540466511776152, 19.292728527055992, 17.70198404216743, 22.013469065611734, 20.320221350107133, 19.164741149810972, 16.750062638109465, 17.71896294979561, 20.852469220741586, 17.531056915880487, 19.316014458991607, 21.608826669701568, 16.62397835654687, 17.31876480087565, 19.457187685958974, 19.54998322650792, 14.400546165677051, 20.55282669324782, 16.063001337907423, 20.831203583616865, 18.192762199458542, 18.99450481521017, 17.063791713182496, 17.267728005242574, 14.832066823417454, 18.202057404732077, 17.11959827014895, 19.61833282355995, 17.722469653285106, 19.836539980712512, 18.749622345744854, 21.488019992913603, 16.244735706900105, 20.797006264013852, 17.815923583415902, 16.61189909018442, 16.63849893523114, 18.42695854275211, 16.661192060963096, 18.677539534912636, 21.62753744138301, 17.485377222905488, 16.9076683454715, 18.798293533837914, 18.181863722060466, 15.958666214719177, 17.561379659047248, 20.604483849047657, 20.80223314236272, 16.695782283862425, 17.808240196865086, 16.67400140606793, 19.373621681526522, 15.51268783367663, 21.447145248487754, 18.148042388341462, 20.18945619439424, 21.539723486827192, 17.49992244092632, 17.45554132588885, 15.13409590194117], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0592857629196426, "mean_inference_ms": 8.245302969719823, "mean_action_processing_ms": 0.5627596710953187, "mean_env_wait_ms": 24.12332554812899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05553603172302246, "StateBufferConnector_ms": 0.04389333724975586, "ViewRequirementAgentConnector_ms": 1.0943880081176758}}, "episode_reward_max": 22.487350918031947, "episode_reward_min": 14.400546165677051, "episode_reward_mean": 18.603949686878824, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.487350918031947, 18.765582859612145, 19.922839369758186, 18.047000700273994, 21.14851832084808, 19.822946258246564, 19.848939532539863, 18.532768609001028, 16.481452512870447, 17.26114394506026, 18.417563676254044, 16.015262570088357, 18.025326643454708, 17.996675822939693, 19.443752290837022, 18.34681879915382, 21.68520006376769, 18.155169668404803, 17.988948406777943, 18.163127140082587, 18.11261130880997, 20.445169276299747, 21.322984442339852, 16.026466424217887, 16.735475356382928, 18.775050003006484, 20.36697118373334, 22.144939341407724, 20.29968266941386, 17.756567157616388, 19.37103666030328, 18.178402886800576, 18.52196309499719, 17.2877109065379, 19.222546139430943, 20.028000463721902, 17.493976000645475, 18.82038815687385, 19.95313249162914, 19.540466511776152, 19.292728527055992, 17.70198404216743, 22.013469065611734, 20.320221350107133, 19.164741149810972, 16.750062638109465, 17.71896294979561, 20.852469220741586, 17.531056915880487, 19.316014458991607, 21.608826669701568, 16.62397835654687, 17.31876480087565, 19.457187685958974, 19.54998322650792, 14.400546165677051, 20.55282669324782, 16.063001337907423, 20.831203583616865, 18.192762199458542, 18.99450481521017, 17.063791713182496, 17.267728005242574, 14.832066823417454, 18.202057404732077, 17.11959827014895, 19.61833282355995, 17.722469653285106, 19.836539980712512, 18.749622345744854, 21.488019992913603, 16.244735706900105, 20.797006264013852, 17.815923583415902, 16.61189909018442, 16.63849893523114, 18.42695854275211, 16.661192060963096, 18.677539534912636, 21.62753744138301, 17.485377222905488, 16.9076683454715, 18.798293533837914, 18.181863722060466, 15.958666214719177, 17.561379659047248, 20.604483849047657, 20.80223314236272, 16.695782283862425, 17.808240196865086, 16.67400140606793, 19.373621681526522, 15.51268783367663, 21.447145248487754, 18.148042388341462, 20.18945619439424, 21.539723486827192, 17.49992244092632, 17.45554132588885, 15.13409590194117], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0592857629196426, "mean_inference_ms": 8.245302969719823, "mean_action_processing_ms": 0.5627596710953187, "mean_env_wait_ms": 24.12332554812899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05553603172302246, "StateBufferConnector_ms": 0.04389333724975586, "ViewRequirementAgentConnector_ms": 1.0943880081176758}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2420046, "num_agent_steps_trained": 2420046, "num_env_steps_sampled": 2420046, "num_env_steps_trained": 2420046, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 254.6261182670954, "num_env_steps_trained_throughput_per_sec": 254.6261182670954, "timesteps_total": 2420046, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2420046, "timers": {"training_iteration_time_ms": 62387.96, "sample_time_ms": 46182.067, "load_time_ms": 2226.804, "load_throughput": 7022.62, "learn_time_ms": 13195.783, "learn_throughput": 1185.076, "synch_weights_time_ms": 654.603}, "counters": {"num_env_steps_sampled": 2420046, "num_env_steps_trained": 2420046, "num_agent_steps_sampled": 2420046, "num_agent_steps_trained": 2420046}, "done": false, "episodes_total": 1302, "training_iteration": 159, "trial_id": "c0a6f_00000", "date": "2025-06-06_23-59-15", "timestamp": 1749247155, "time_this_iter_s": 61.428546667099, "time_total_s": 5389.046897411346, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5389.046897411346, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 79.83333333333331, "ram_util_percent": 72.68840579710147, "gpu_util_percent0": 0.08550724637681162, "vram_util_percent0": 0.8810221354166667}}
{"evaluation": {"sampler_results": {"episode_reward_max": 3.5684712820448437, "episode_reward_min": -4.731096403932376, "episode_reward_mean": -1.9975857882399972, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.5439262898681125, 3.5684712820448437, -1.6252544952586598, -4.731096403932376, -2.65612303418568], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6768293476878042, "mean_inference_ms": 3.8188775066950074, "mean_action_processing_ms": 0.29611402035491025, "mean_env_wait_ms": 11.914859653015604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.40047645568847656}}, "episode_reward_max": 3.5684712820448437, "episode_reward_min": -4.731096403932376, "episode_reward_mean": -1.9975857882399972, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.5439262898681125, 3.5684712820448437, -1.6252544952586598, -4.731096403932376, -2.65612303418568], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6768293476878042, "mean_inference_ms": 3.8188775066950074, "mean_action_processing_ms": 0.29611402035491025, "mean_env_wait_ms": 11.914859653015604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.40047645568847656}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.579954e-05, "total_loss": -0.08632686653259125, "policy_loss": -0.04083215713712641, "vf_loss": 0.01381675926799124, "vf_explained_var": 0.8563755554502661, "kl": 0.015982207568968017, "entropy": 18.40977804704146, "entropy_coeff": 0.0031599079999999995}, "model": {}, "num_grad_updates_lifetime": 51425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2435684, "num_env_steps_trained": 2435684, "num_agent_steps_sampled": 2435684, "num_agent_steps_trained": 2435684}, "sampler_results": {"episode_reward_max": 22.144939341407724, "episode_reward_min": 14.400546165677051, "episode_reward_mean": 18.56406012115905, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.443752290837022, 18.34681879915382, 21.68520006376769, 18.155169668404803, 17.988948406777943, 18.163127140082587, 18.11261130880997, 20.445169276299747, 21.322984442339852, 16.026466424217887, 16.735475356382928, 18.775050003006484, 20.36697118373334, 22.144939341407724, 20.29968266941386, 17.756567157616388, 19.37103666030328, 18.178402886800576, 18.52196309499719, 17.2877109065379, 19.222546139430943, 20.028000463721902, 17.493976000645475, 18.82038815687385, 19.95313249162914, 19.540466511776152, 19.292728527055992, 17.70198404216743, 22.013469065611734, 20.320221350107133, 19.164741149810972, 16.750062638109465, 17.71896294979561, 20.852469220741586, 17.531056915880487, 19.316014458991607, 21.608826669701568, 16.62397835654687, 17.31876480087565, 19.457187685958974, 19.54998322650792, 14.400546165677051, 20.55282669324782, 16.063001337907423, 20.831203583616865, 18.192762199458542, 18.99450481521017, 17.063791713182496, 17.267728005242574, 14.832066823417454, 18.202057404732077, 17.11959827014895, 19.61833282355995, 17.722469653285106, 19.836539980712512, 18.749622345744854, 21.488019992913603, 16.244735706900105, 20.797006264013852, 17.815923583415902, 16.61189909018442, 16.63849893523114, 18.42695854275211, 16.661192060963096, 18.677539534912636, 21.62753744138301, 17.485377222905488, 16.9076683454715, 18.798293533837914, 18.181863722060466, 15.958666214719177, 17.561379659047248, 20.604483849047657, 20.80223314236272, 16.695782283862425, 17.808240196865086, 16.67400140606793, 19.373621681526522, 15.51268783367663, 21.447145248487754, 18.148042388341462, 20.18945619439424, 21.539723486827192, 17.49992244092632, 17.45554132588885, 15.13409590194117, 16.787748685447205, 16.712174554568037, 19.324076076421914, 19.01155800016766, 19.120861996247637, 18.02543914676606, 18.565818974881765, 16.418591562940154, 19.300446980944923, 17.464867107965652, 18.953860626473194, 21.401184828478474, 21.506795613434484, 16.190991012264835], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.059422939623415, "mean_inference_ms": 8.248909551191668, "mean_action_processing_ms": 0.5630213417917939, "mean_env_wait_ms": 24.14200086824412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059619903564453125, "StateBufferConnector_ms": 0.041843414306640625, "ViewRequirementAgentConnector_ms": 1.0644123554229736}}, "episode_reward_max": 22.144939341407724, "episode_reward_min": 14.400546165677051, "episode_reward_mean": 18.56406012115905, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.443752290837022, 18.34681879915382, 21.68520006376769, 18.155169668404803, 17.988948406777943, 18.163127140082587, 18.11261130880997, 20.445169276299747, 21.322984442339852, 16.026466424217887, 16.735475356382928, 18.775050003006484, 20.36697118373334, 22.144939341407724, 20.29968266941386, 17.756567157616388, 19.37103666030328, 18.178402886800576, 18.52196309499719, 17.2877109065379, 19.222546139430943, 20.028000463721902, 17.493976000645475, 18.82038815687385, 19.95313249162914, 19.540466511776152, 19.292728527055992, 17.70198404216743, 22.013469065611734, 20.320221350107133, 19.164741149810972, 16.750062638109465, 17.71896294979561, 20.852469220741586, 17.531056915880487, 19.316014458991607, 21.608826669701568, 16.62397835654687, 17.31876480087565, 19.457187685958974, 19.54998322650792, 14.400546165677051, 20.55282669324782, 16.063001337907423, 20.831203583616865, 18.192762199458542, 18.99450481521017, 17.063791713182496, 17.267728005242574, 14.832066823417454, 18.202057404732077, 17.11959827014895, 19.61833282355995, 17.722469653285106, 19.836539980712512, 18.749622345744854, 21.488019992913603, 16.244735706900105, 20.797006264013852, 17.815923583415902, 16.61189909018442, 16.63849893523114, 18.42695854275211, 16.661192060963096, 18.677539534912636, 21.62753744138301, 17.485377222905488, 16.9076683454715, 18.798293533837914, 18.181863722060466, 15.958666214719177, 17.561379659047248, 20.604483849047657, 20.80223314236272, 16.695782283862425, 17.808240196865086, 16.67400140606793, 19.373621681526522, 15.51268783367663, 21.447145248487754, 18.148042388341462, 20.18945619439424, 21.539723486827192, 17.49992244092632, 17.45554132588885, 15.13409590194117, 16.787748685447205, 16.712174554568037, 19.324076076421914, 19.01155800016766, 19.120861996247637, 18.02543914676606, 18.565818974881765, 16.418591562940154, 19.300446980944923, 17.464867107965652, 18.953860626473194, 21.401184828478474, 21.506795613434484, 16.190991012264835], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.059422939623415, "mean_inference_ms": 8.248909551191668, "mean_action_processing_ms": 0.5630213417917939, "mean_env_wait_ms": 24.14200086824412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059619903564453125, "StateBufferConnector_ms": 0.041843414306640625, "ViewRequirementAgentConnector_ms": 1.0644123554229736}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2435684, "num_agent_steps_trained": 2435684, "num_env_steps_sampled": 2435684, "num_env_steps_trained": 2435684, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 239.6446901618492, "num_env_steps_trained_throughput_per_sec": 239.6446901618492, "timesteps_total": 2435684, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2435684, "timers": {"training_iteration_time_ms": 63326.524, "sample_time_ms": 46714.245, "load_time_ms": 2248.45, "load_throughput": 6955.012, "learn_time_ms": 13569.146, "learn_throughput": 1152.468, "synch_weights_time_ms": 657.155}, "counters": {"num_env_steps_sampled": 2435684, "num_env_steps_trained": 2435684, "num_agent_steps_sampled": 2435684, "num_agent_steps_trained": 2435684}, "done": false, "episodes_total": 1316, "training_iteration": 160, "trial_id": "c0a6f_00000", "date": "2025-06-07_00-00-38", "timestamp": 1749247238, "time_this_iter_s": 83.618661403656, "time_total_s": 5472.665558815002, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5472.665558815002, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 73.38315789473684, "ram_util_percent": 69.17263157894739, "gpu_util_percent0": 0.05515789473684211, "vram_util_percent0": 0.8595925849780698}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.564316000000002e-05, "total_loss": -0.0672937852423638, "policy_loss": -0.022337546017317272, "vf_loss": 0.013941008776680312, "vf_explained_var": 0.8389227186549794, "kl": 0.01573256056789204, "entropy": 18.391014442443847, "entropy_coeff": 0.0031286319999999997}, "model": {}, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2451322, "num_env_steps_trained": 2451322, "num_agent_steps_sampled": 2451322, "num_agent_steps_trained": 2451322}, "sampler_results": {"episode_reward_max": 22.013469065611734, "episode_reward_min": 14.400546165677051, "episode_reward_mean": 18.463711091919148, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.29968266941386, 17.756567157616388, 19.37103666030328, 18.178402886800576, 18.52196309499719, 17.2877109065379, 19.222546139430943, 20.028000463721902, 17.493976000645475, 18.82038815687385, 19.95313249162914, 19.540466511776152, 19.292728527055992, 17.70198404216743, 22.013469065611734, 20.320221350107133, 19.164741149810972, 16.750062638109465, 17.71896294979561, 20.852469220741586, 17.531056915880487, 19.316014458991607, 21.608826669701568, 16.62397835654687, 17.31876480087565, 19.457187685958974, 19.54998322650792, 14.400546165677051, 20.55282669324782, 16.063001337907423, 20.831203583616865, 18.192762199458542, 18.99450481521017, 17.063791713182496, 17.267728005242574, 14.832066823417454, 18.202057404732077, 17.11959827014895, 19.61833282355995, 17.722469653285106, 19.836539980712512, 18.749622345744854, 21.488019992913603, 16.244735706900105, 20.797006264013852, 17.815923583415902, 16.61189909018442, 16.63849893523114, 18.42695854275211, 16.661192060963096, 18.677539534912636, 21.62753744138301, 17.485377222905488, 16.9076683454715, 18.798293533837914, 18.181863722060466, 15.958666214719177, 17.561379659047248, 20.604483849047657, 20.80223314236272, 16.695782283862425, 17.808240196865086, 16.67400140606793, 19.373621681526522, 15.51268783367663, 21.447145248487754, 18.148042388341462, 20.18945619439424, 21.539723486827192, 17.49992244092632, 17.45554132588885, 15.13409590194117, 16.787748685447205, 16.712174554568037, 19.324076076421914, 19.01155800016766, 19.120861996247637, 18.02543914676606, 18.565818974881765, 16.418591562940154, 19.300446980944923, 17.464867107965652, 18.953860626473194, 21.401184828478474, 21.506795613434484, 16.190991012264835, 17.999958169413468, 18.824546843122047, 17.7225248195677, 18.179000588095615, 18.708529495635812, 19.71199389847782, 17.49444986970813, 19.51240016996955, 18.518286982939184, 17.398795132985978, 17.81616439250534, 16.747342257633388, 17.862286403536412, 21.181501757641506], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0605686666562604, "mean_inference_ms": 8.255245430655677, "mean_action_processing_ms": 0.5634863425987464, "mean_env_wait_ms": 24.165829395587956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0740971565246582, "StateBufferConnector_ms": 0.034528493881225586, "ViewRequirementAgentConnector_ms": 1.0348834991455078}}, "episode_reward_max": 22.013469065611734, "episode_reward_min": 14.400546165677051, "episode_reward_mean": 18.463711091919148, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.29968266941386, 17.756567157616388, 19.37103666030328, 18.178402886800576, 18.52196309499719, 17.2877109065379, 19.222546139430943, 20.028000463721902, 17.493976000645475, 18.82038815687385, 19.95313249162914, 19.540466511776152, 19.292728527055992, 17.70198404216743, 22.013469065611734, 20.320221350107133, 19.164741149810972, 16.750062638109465, 17.71896294979561, 20.852469220741586, 17.531056915880487, 19.316014458991607, 21.608826669701568, 16.62397835654687, 17.31876480087565, 19.457187685958974, 19.54998322650792, 14.400546165677051, 20.55282669324782, 16.063001337907423, 20.831203583616865, 18.192762199458542, 18.99450481521017, 17.063791713182496, 17.267728005242574, 14.832066823417454, 18.202057404732077, 17.11959827014895, 19.61833282355995, 17.722469653285106, 19.836539980712512, 18.749622345744854, 21.488019992913603, 16.244735706900105, 20.797006264013852, 17.815923583415902, 16.61189909018442, 16.63849893523114, 18.42695854275211, 16.661192060963096, 18.677539534912636, 21.62753744138301, 17.485377222905488, 16.9076683454715, 18.798293533837914, 18.181863722060466, 15.958666214719177, 17.561379659047248, 20.604483849047657, 20.80223314236272, 16.695782283862425, 17.808240196865086, 16.67400140606793, 19.373621681526522, 15.51268783367663, 21.447145248487754, 18.148042388341462, 20.18945619439424, 21.539723486827192, 17.49992244092632, 17.45554132588885, 15.13409590194117, 16.787748685447205, 16.712174554568037, 19.324076076421914, 19.01155800016766, 19.120861996247637, 18.02543914676606, 18.565818974881765, 16.418591562940154, 19.300446980944923, 17.464867107965652, 18.953860626473194, 21.401184828478474, 21.506795613434484, 16.190991012264835, 17.999958169413468, 18.824546843122047, 17.7225248195677, 18.179000588095615, 18.708529495635812, 19.71199389847782, 17.49444986970813, 19.51240016996955, 18.518286982939184, 17.398795132985978, 17.81616439250534, 16.747342257633388, 17.862286403536412, 21.181501757641506], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0605686666562604, "mean_inference_ms": 8.255245430655677, "mean_action_processing_ms": 0.5634863425987464, "mean_env_wait_ms": 24.165829395587956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0740971565246582, "StateBufferConnector_ms": 0.034528493881225586, "ViewRequirementAgentConnector_ms": 1.0348834991455078}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2451322, "num_agent_steps_trained": 2451322, "num_env_steps_sampled": 2451322, "num_env_steps_trained": 2451322, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 199.87081346451865, "num_env_steps_trained_throughput_per_sec": 199.87081346451865, "timesteps_total": 2451322, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2451322, "timers": {"training_iteration_time_ms": 64261.7, "sample_time_ms": 47366.998, "load_time_ms": 2344.26, "load_throughput": 6670.761, "learn_time_ms": 13733.04, "learn_throughput": 1138.714, "synch_weights_time_ms": 673.011}, "counters": {"num_env_steps_sampled": 2451322, "num_env_steps_trained": 2451322, "num_agent_steps_sampled": 2451322, "num_agent_steps_trained": 2451322}, "done": false, "episodes_total": 1330, "training_iteration": 161, "trial_id": "c0a6f_00000", "date": "2025-06-07_00-01-57", "timestamp": 1749247317, "time_this_iter_s": 78.26147437095642, "time_total_s": 5550.927033185959, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5550.927033185959, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 84.89740259740257, "ram_util_percent": 75.59999999999998, "gpu_util_percent0": 0.08844155844155845, "vram_util_percent0": 0.8904939461580084}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.548678e-05, "total_loss": -0.06655375085728751, "policy_loss": -0.022635154592227827, "vf_loss": 0.015390832193873145, "vf_explained_var": 0.8415756265683607, "kl": 0.015560679760954625, "entropy": 18.35250568043102, "entropy_coeff": 0.0030973559999999995}, "model": {}, "num_grad_updates_lifetime": 52525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2466960, "num_env_steps_trained": 2466960, "num_agent_steps_sampled": 2466960, "num_agent_steps_trained": 2466960}, "sampler_results": {"episode_reward_max": 22.013469065611734, "episode_reward_min": 14.400546165677051, "episode_reward_mean": 18.351842891016123, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.013469065611734, 20.320221350107133, 19.164741149810972, 16.750062638109465, 17.71896294979561, 20.852469220741586, 17.531056915880487, 19.316014458991607, 21.608826669701568, 16.62397835654687, 17.31876480087565, 19.457187685958974, 19.54998322650792, 14.400546165677051, 20.55282669324782, 16.063001337907423, 20.831203583616865, 18.192762199458542, 18.99450481521017, 17.063791713182496, 17.267728005242574, 14.832066823417454, 18.202057404732077, 17.11959827014895, 19.61833282355995, 17.722469653285106, 19.836539980712512, 18.749622345744854, 21.488019992913603, 16.244735706900105, 20.797006264013852, 17.815923583415902, 16.61189909018442, 16.63849893523114, 18.42695854275211, 16.661192060963096, 18.677539534912636, 21.62753744138301, 17.485377222905488, 16.9076683454715, 18.798293533837914, 18.181863722060466, 15.958666214719177, 17.561379659047248, 20.604483849047657, 20.80223314236272, 16.695782283862425, 17.808240196865086, 16.67400140606793, 19.373621681526522, 15.51268783367663, 21.447145248487754, 18.148042388341462, 20.18945619439424, 21.539723486827192, 17.49992244092632, 17.45554132588885, 15.13409590194117, 16.787748685447205, 16.712174554568037, 19.324076076421914, 19.01155800016766, 19.120861996247637, 18.02543914676606, 18.565818974881765, 16.418591562940154, 19.300446980944923, 17.464867107965652, 18.953860626473194, 21.401184828478474, 21.506795613434484, 16.190991012264835, 17.999958169413468, 18.824546843122047, 17.7225248195677, 18.179000588095615, 18.708529495635812, 19.71199389847782, 17.49444986970813, 19.51240016996955, 18.518286982939184, 17.398795132985978, 17.81616439250534, 16.747342257633388, 17.862286403536412, 21.181501757641506, 15.876771046768594, 20.171536786762555, 19.281906483006715, 19.54175772118099, 17.62384511007877, 17.520288962901734, 17.449703247514478, 16.489638925726194, 19.524103002660127, 15.885436777445417, 17.964442634179594, 18.35773279124784, 18.16297761454621, 18.43162451464783], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.062336408481079, "mean_inference_ms": 8.265239117277877, "mean_action_processing_ms": 0.5641750452955054, "mean_env_wait_ms": 24.199073705018183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06719112396240234, "StateBufferConnector_ms": 0.025041818618774414, "ViewRequirementAgentConnector_ms": 1.094588279724121}}, "episode_reward_max": 22.013469065611734, "episode_reward_min": 14.400546165677051, "episode_reward_mean": 18.351842891016123, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.013469065611734, 20.320221350107133, 19.164741149810972, 16.750062638109465, 17.71896294979561, 20.852469220741586, 17.531056915880487, 19.316014458991607, 21.608826669701568, 16.62397835654687, 17.31876480087565, 19.457187685958974, 19.54998322650792, 14.400546165677051, 20.55282669324782, 16.063001337907423, 20.831203583616865, 18.192762199458542, 18.99450481521017, 17.063791713182496, 17.267728005242574, 14.832066823417454, 18.202057404732077, 17.11959827014895, 19.61833282355995, 17.722469653285106, 19.836539980712512, 18.749622345744854, 21.488019992913603, 16.244735706900105, 20.797006264013852, 17.815923583415902, 16.61189909018442, 16.63849893523114, 18.42695854275211, 16.661192060963096, 18.677539534912636, 21.62753744138301, 17.485377222905488, 16.9076683454715, 18.798293533837914, 18.181863722060466, 15.958666214719177, 17.561379659047248, 20.604483849047657, 20.80223314236272, 16.695782283862425, 17.808240196865086, 16.67400140606793, 19.373621681526522, 15.51268783367663, 21.447145248487754, 18.148042388341462, 20.18945619439424, 21.539723486827192, 17.49992244092632, 17.45554132588885, 15.13409590194117, 16.787748685447205, 16.712174554568037, 19.324076076421914, 19.01155800016766, 19.120861996247637, 18.02543914676606, 18.565818974881765, 16.418591562940154, 19.300446980944923, 17.464867107965652, 18.953860626473194, 21.401184828478474, 21.506795613434484, 16.190991012264835, 17.999958169413468, 18.824546843122047, 17.7225248195677, 18.179000588095615, 18.708529495635812, 19.71199389847782, 17.49444986970813, 19.51240016996955, 18.518286982939184, 17.398795132985978, 17.81616439250534, 16.747342257633388, 17.862286403536412, 21.181501757641506, 15.876771046768594, 20.171536786762555, 19.281906483006715, 19.54175772118099, 17.62384511007877, 17.520288962901734, 17.449703247514478, 16.489638925726194, 19.524103002660127, 15.885436777445417, 17.964442634179594, 18.35773279124784, 18.16297761454621, 18.43162451464783], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.062336408481079, "mean_inference_ms": 8.265239117277877, "mean_action_processing_ms": 0.5641750452955054, "mean_env_wait_ms": 24.199073705018183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06719112396240234, "StateBufferConnector_ms": 0.025041818618774414, "ViewRequirementAgentConnector_ms": 1.094588279724121}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2466960, "num_agent_steps_trained": 2466960, "num_env_steps_sampled": 2466960, "num_env_steps_trained": 2466960, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 222.85694038527814, "num_env_steps_trained_throughput_per_sec": 222.85694038527814, "timesteps_total": 2466960, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2466960, "timers": {"training_iteration_time_ms": 63767.17, "sample_time_ms": 47332.128, "load_time_ms": 2357.426, "load_throughput": 6633.507, "learn_time_ms": 13419.749, "learn_throughput": 1165.298, "synch_weights_time_ms": 515.559}, "counters": {"num_env_steps_sampled": 2466960, "num_env_steps_trained": 2466960, "num_agent_steps_sampled": 2466960, "num_agent_steps_trained": 2466960}, "done": false, "episodes_total": 1344, "training_iteration": 162, "trial_id": "c0a6f_00000", "date": "2025-06-07_00-03-07", "timestamp": 1749247387, "time_this_iter_s": 70.18709874153137, "time_total_s": 5621.11413192749, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5621.11413192749, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 82.47894736842107, "ram_util_percent": 74.6421052631579, "gpu_util_percent0": 0.0661842105263158, "vram_util_percent0": 0.891927083333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.53304e-05, "total_loss": -0.06889279585712674, "policy_loss": -0.025579032742667054, "vf_loss": 0.014191561463627626, "vf_explained_var": 0.8463461801138791, "kl": 0.016229105050339383, "entropy": 18.341507322138007, "entropy_coeff": 0.0030660799999999997}, "model": {}, "num_grad_updates_lifetime": 53075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2482598, "num_env_steps_trained": 2482598, "num_agent_steps_sampled": 2482598, "num_agent_steps_trained": 2482598}, "sampler_results": {"episode_reward_max": 21.62753744138301, "episode_reward_min": 14.832066823417454, "episode_reward_mean": 18.294056890304383, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.55282669324782, 16.063001337907423, 20.831203583616865, 18.192762199458542, 18.99450481521017, 17.063791713182496, 17.267728005242574, 14.832066823417454, 18.202057404732077, 17.11959827014895, 19.61833282355995, 17.722469653285106, 19.836539980712512, 18.749622345744854, 21.488019992913603, 16.244735706900105, 20.797006264013852, 17.815923583415902, 16.61189909018442, 16.63849893523114, 18.42695854275211, 16.661192060963096, 18.677539534912636, 21.62753744138301, 17.485377222905488, 16.9076683454715, 18.798293533837914, 18.181863722060466, 15.958666214719177, 17.561379659047248, 20.604483849047657, 20.80223314236272, 16.695782283862425, 17.808240196865086, 16.67400140606793, 19.373621681526522, 15.51268783367663, 21.447145248487754, 18.148042388341462, 20.18945619439424, 21.539723486827192, 17.49992244092632, 17.45554132588885, 15.13409590194117, 16.787748685447205, 16.712174554568037, 19.324076076421914, 19.01155800016766, 19.120861996247637, 18.02543914676606, 18.565818974881765, 16.418591562940154, 19.300446980944923, 17.464867107965652, 18.953860626473194, 21.401184828478474, 21.506795613434484, 16.190991012264835, 17.999958169413468, 18.824546843122047, 17.7225248195677, 18.179000588095615, 18.708529495635812, 19.71199389847782, 17.49444986970813, 19.51240016996955, 18.518286982939184, 17.398795132985978, 17.81616439250534, 16.747342257633388, 17.862286403536412, 21.181501757641506, 15.876771046768594, 20.171536786762555, 19.281906483006715, 19.54175772118099, 17.62384511007877, 17.520288962901734, 17.449703247514478, 16.489638925726194, 19.524103002660127, 15.885436777445417, 17.964442634179594, 18.35773279124784, 18.16297761454621, 18.43162451464783, 19.88153511419417, 17.742246875741213, 18.326296236180948, 16.292605944230047, 16.593483706214013, 18.6569465955353, 16.387473877808144, 18.81165582929661, 16.289978607289775, 18.912473591311905, 20.302583745110464, 17.34989072863253, 19.986706583464, 21.313807148133787], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0641485463527953, "mean_inference_ms": 8.27649757056421, "mean_action_processing_ms": 0.5649481977060907, "mean_env_wait_ms": 24.234565480547996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06467103958129883, "StateBufferConnector_ms": 0.02254033088684082, "ViewRequirementAgentConnector_ms": 1.1191606521606445}}, "episode_reward_max": 21.62753744138301, "episode_reward_min": 14.832066823417454, "episode_reward_mean": 18.294056890304383, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.55282669324782, 16.063001337907423, 20.831203583616865, 18.192762199458542, 18.99450481521017, 17.063791713182496, 17.267728005242574, 14.832066823417454, 18.202057404732077, 17.11959827014895, 19.61833282355995, 17.722469653285106, 19.836539980712512, 18.749622345744854, 21.488019992913603, 16.244735706900105, 20.797006264013852, 17.815923583415902, 16.61189909018442, 16.63849893523114, 18.42695854275211, 16.661192060963096, 18.677539534912636, 21.62753744138301, 17.485377222905488, 16.9076683454715, 18.798293533837914, 18.181863722060466, 15.958666214719177, 17.561379659047248, 20.604483849047657, 20.80223314236272, 16.695782283862425, 17.808240196865086, 16.67400140606793, 19.373621681526522, 15.51268783367663, 21.447145248487754, 18.148042388341462, 20.18945619439424, 21.539723486827192, 17.49992244092632, 17.45554132588885, 15.13409590194117, 16.787748685447205, 16.712174554568037, 19.324076076421914, 19.01155800016766, 19.120861996247637, 18.02543914676606, 18.565818974881765, 16.418591562940154, 19.300446980944923, 17.464867107965652, 18.953860626473194, 21.401184828478474, 21.506795613434484, 16.190991012264835, 17.999958169413468, 18.824546843122047, 17.7225248195677, 18.179000588095615, 18.708529495635812, 19.71199389847782, 17.49444986970813, 19.51240016996955, 18.518286982939184, 17.398795132985978, 17.81616439250534, 16.747342257633388, 17.862286403536412, 21.181501757641506, 15.876771046768594, 20.171536786762555, 19.281906483006715, 19.54175772118099, 17.62384511007877, 17.520288962901734, 17.449703247514478, 16.489638925726194, 19.524103002660127, 15.885436777445417, 17.964442634179594, 18.35773279124784, 18.16297761454621, 18.43162451464783, 19.88153511419417, 17.742246875741213, 18.326296236180948, 16.292605944230047, 16.593483706214013, 18.6569465955353, 16.387473877808144, 18.81165582929661, 16.289978607289775, 18.912473591311905, 20.302583745110464, 17.34989072863253, 19.986706583464, 21.313807148133787], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0641485463527953, "mean_inference_ms": 8.27649757056421, "mean_action_processing_ms": 0.5649481977060907, "mean_env_wait_ms": 24.234565480547996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06467103958129883, "StateBufferConnector_ms": 0.02254033088684082, "ViewRequirementAgentConnector_ms": 1.1191606521606445}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2482598, "num_agent_steps_trained": 2482598, "num_env_steps_sampled": 2482598, "num_env_steps_trained": 2482598, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 261.9741714070837, "num_env_steps_trained_throughput_per_sec": 261.9741714070837, "timesteps_total": 2482598, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2482598, "timers": {"training_iteration_time_ms": 63306.405, "sample_time_ms": 47206.17, "load_time_ms": 2299.384, "load_throughput": 6800.952, "learn_time_ms": 13164.019, "learn_throughput": 1187.935, "synch_weights_time_ms": 499.984}, "counters": {"num_env_steps_sampled": 2482598, "num_env_steps_trained": 2482598, "num_agent_steps_sampled": 2482598, "num_agent_steps_trained": 2482598}, "done": false, "episodes_total": 1358, "training_iteration": 163, "trial_id": "c0a6f_00000", "date": "2025-06-07_00-04-07", "timestamp": 1749247447, "time_this_iter_s": 59.72528624534607, "time_total_s": 5680.839418172836, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5680.839418172836, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 78.34411764705884, "ram_util_percent": 68.50441176470588, "gpu_util_percent0": 0.07102941176470588, "vram_util_percent0": 0.8650596469056374}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.517402000000002e-05, "total_loss": -0.06407903681339866, "policy_loss": -0.020878338959300892, "vf_loss": 0.013266901464878836, "vf_explained_var": 0.8802236292578958, "kl": 0.015861844621993523, "entropy": 18.337253821979868, "entropy_coeff": 0.0030348039999999995}, "model": {}, "num_grad_updates_lifetime": 53625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2498236, "num_env_steps_trained": 2498236, "num_agent_steps_sampled": 2498236, "num_agent_steps_trained": 2498236}, "sampler_results": {"episode_reward_max": 21.764178422544372, "episode_reward_min": 15.13409590194117, "episode_reward_mean": 18.446928757363118, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.488019992913603, 16.244735706900105, 20.797006264013852, 17.815923583415902, 16.61189909018442, 16.63849893523114, 18.42695854275211, 16.661192060963096, 18.677539534912636, 21.62753744138301, 17.485377222905488, 16.9076683454715, 18.798293533837914, 18.181863722060466, 15.958666214719177, 17.561379659047248, 20.604483849047657, 20.80223314236272, 16.695782283862425, 17.808240196865086, 16.67400140606793, 19.373621681526522, 15.51268783367663, 21.447145248487754, 18.148042388341462, 20.18945619439424, 21.539723486827192, 17.49992244092632, 17.45554132588885, 15.13409590194117, 16.787748685447205, 16.712174554568037, 19.324076076421914, 19.01155800016766, 19.120861996247637, 18.02543914676606, 18.565818974881765, 16.418591562940154, 19.300446980944923, 17.464867107965652, 18.953860626473194, 21.401184828478474, 21.506795613434484, 16.190991012264835, 17.999958169413468, 18.824546843122047, 17.7225248195677, 18.179000588095615, 18.708529495635812, 19.71199389847782, 17.49444986970813, 19.51240016996955, 18.518286982939184, 17.398795132985978, 17.81616439250534, 16.747342257633388, 17.862286403536412, 21.181501757641506, 15.876771046768594, 20.171536786762555, 19.281906483006715, 19.54175772118099, 17.62384511007877, 17.520288962901734, 17.449703247514478, 16.489638925726194, 19.524103002660127, 15.885436777445417, 17.964442634179594, 18.35773279124784, 18.16297761454621, 18.43162451464783, 19.88153511419417, 17.742246875741213, 18.326296236180948, 16.292605944230047, 16.593483706214013, 18.6569465955353, 16.387473877808144, 18.81165582929661, 16.289978607289775, 18.912473591311905, 20.302583745110464, 17.34989072863253, 19.986706583464, 21.313807148133787, 20.39309310033896, 19.629597414385078, 18.475649946747023, 18.7724855584974, 19.900049323204374, 18.83925734234364, 19.52663120057711, 18.908949371544992, 18.825565914045367, 18.81724185351606, 21.764178422544372, 20.490505245866306, 17.941136523011266, 18.04935113871818], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0658681954747458, "mean_inference_ms": 8.289460018527441, "mean_action_processing_ms": 0.5658501364917743, "mean_env_wait_ms": 24.272268409893556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0616297721862793, "StateBufferConnector_ms": 0.01549220085144043, "ViewRequirementAgentConnector_ms": 1.0803544521331787}}, "episode_reward_max": 21.764178422544372, "episode_reward_min": 15.13409590194117, "episode_reward_mean": 18.446928757363118, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.488019992913603, 16.244735706900105, 20.797006264013852, 17.815923583415902, 16.61189909018442, 16.63849893523114, 18.42695854275211, 16.661192060963096, 18.677539534912636, 21.62753744138301, 17.485377222905488, 16.9076683454715, 18.798293533837914, 18.181863722060466, 15.958666214719177, 17.561379659047248, 20.604483849047657, 20.80223314236272, 16.695782283862425, 17.808240196865086, 16.67400140606793, 19.373621681526522, 15.51268783367663, 21.447145248487754, 18.148042388341462, 20.18945619439424, 21.539723486827192, 17.49992244092632, 17.45554132588885, 15.13409590194117, 16.787748685447205, 16.712174554568037, 19.324076076421914, 19.01155800016766, 19.120861996247637, 18.02543914676606, 18.565818974881765, 16.418591562940154, 19.300446980944923, 17.464867107965652, 18.953860626473194, 21.401184828478474, 21.506795613434484, 16.190991012264835, 17.999958169413468, 18.824546843122047, 17.7225248195677, 18.179000588095615, 18.708529495635812, 19.71199389847782, 17.49444986970813, 19.51240016996955, 18.518286982939184, 17.398795132985978, 17.81616439250534, 16.747342257633388, 17.862286403536412, 21.181501757641506, 15.876771046768594, 20.171536786762555, 19.281906483006715, 19.54175772118099, 17.62384511007877, 17.520288962901734, 17.449703247514478, 16.489638925726194, 19.524103002660127, 15.885436777445417, 17.964442634179594, 18.35773279124784, 18.16297761454621, 18.43162451464783, 19.88153511419417, 17.742246875741213, 18.326296236180948, 16.292605944230047, 16.593483706214013, 18.6569465955353, 16.387473877808144, 18.81165582929661, 16.289978607289775, 18.912473591311905, 20.302583745110464, 17.34989072863253, 19.986706583464, 21.313807148133787, 20.39309310033896, 19.629597414385078, 18.475649946747023, 18.7724855584974, 19.900049323204374, 18.83925734234364, 19.52663120057711, 18.908949371544992, 18.825565914045367, 18.81724185351606, 21.764178422544372, 20.490505245866306, 17.941136523011266, 18.04935113871818], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.0658681954747458, "mean_inference_ms": 8.289460018527441, "mean_action_processing_ms": 0.5658501364917743, "mean_env_wait_ms": 24.272268409893556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0616297721862793, "StateBufferConnector_ms": 0.01549220085144043, "ViewRequirementAgentConnector_ms": 1.0803544521331787}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2498236, "num_agent_steps_trained": 2498236, "num_env_steps_sampled": 2498236, "num_env_steps_trained": 2498236, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 256.36555754672315, "num_env_steps_trained_throughput_per_sec": 256.36555754672315, "timesteps_total": 2498236, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2498236, "timers": {"training_iteration_time_ms": 62672.8, "sample_time_ms": 46919.973, "load_time_ms": 2216.087, "load_throughput": 7056.581, "learn_time_ms": 12911.161, "learn_throughput": 1211.2, "synch_weights_time_ms": 496.068}, "counters": {"num_env_steps_sampled": 2498236, "num_env_steps_trained": 2498236, "num_agent_steps_sampled": 2498236, "num_agent_steps_trained": 2498236}, "done": false, "episodes_total": 1372, "training_iteration": 164, "trial_id": "c0a6f_00000", "date": "2025-06-07_00-05-08", "timestamp": 1749247508, "time_this_iter_s": 60.998833656311035, "time_total_s": 5741.838251829147, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5741.838251829147, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 79.86811594202898, "ram_util_percent": 67.20434782608697, "gpu_util_percent0": 0.07898550724637682, "vram_util_percent0": 0.8592122395833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.501764000000001e-05, "total_loss": -0.062660925576294, "policy_loss": -0.021293503410627388, "vf_loss": 0.017450988862917505, "vf_explained_var": 0.8514154518734325, "kl": 0.015971812482023534, "entropy": 18.355293150815097, "entropy_coeff": 0.003003528}, "model": {}, "num_grad_updates_lifetime": 54175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2513874, "num_env_steps_trained": 2513874, "num_agent_steps_sampled": 2513874, "num_agent_steps_trained": 2513874}, "sampler_results": {"episode_reward_max": 21.764178422544372, "episode_reward_min": 15.13409590194117, "episode_reward_mean": 18.492293097273617, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.958666214719177, 17.561379659047248, 20.604483849047657, 20.80223314236272, 16.695782283862425, 17.808240196865086, 16.67400140606793, 19.373621681526522, 15.51268783367663, 21.447145248487754, 18.148042388341462, 20.18945619439424, 21.539723486827192, 17.49992244092632, 17.45554132588885, 15.13409590194117, 16.787748685447205, 16.712174554568037, 19.324076076421914, 19.01155800016766, 19.120861996247637, 18.02543914676606, 18.565818974881765, 16.418591562940154, 19.300446980944923, 17.464867107965652, 18.953860626473194, 21.401184828478474, 21.506795613434484, 16.190991012264835, 17.999958169413468, 18.824546843122047, 17.7225248195677, 18.179000588095615, 18.708529495635812, 19.71199389847782, 17.49444986970813, 19.51240016996955, 18.518286982939184, 17.398795132985978, 17.81616439250534, 16.747342257633388, 17.862286403536412, 21.181501757641506, 15.876771046768594, 20.171536786762555, 19.281906483006715, 19.54175772118099, 17.62384511007877, 17.520288962901734, 17.449703247514478, 16.489638925726194, 19.524103002660127, 15.885436777445417, 17.964442634179594, 18.35773279124784, 18.16297761454621, 18.43162451464783, 19.88153511419417, 17.742246875741213, 18.326296236180948, 16.292605944230047, 16.593483706214013, 18.6569465955353, 16.387473877808144, 18.81165582929661, 16.289978607289775, 18.912473591311905, 20.302583745110464, 17.34989072863253, 19.986706583464, 21.313807148133787, 20.39309310033896, 19.629597414385078, 18.475649946747023, 18.7724855584974, 19.900049323204374, 18.83925734234364, 19.52663120057711, 18.908949371544992, 18.825565914045367, 18.81724185351606, 21.764178422544372, 20.490505245866306, 17.941136523011266, 18.04935113871818, 18.099714063558892, 17.45971547515695, 17.68527623302549, 20.92360428797665, 18.935901172494017, 19.184541178770704, 18.834817754568295, 19.848908168439102, 20.883980743921285, 19.41707054908446, 18.842429541466167, 18.499765509633946, 16.020367709289648, 16.262855580609582], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.066979348267349, "mean_inference_ms": 8.303080730738591, "mean_action_processing_ms": 0.5667677300059623, "mean_env_wait_ms": 24.312666625837604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06055498123168945, "StateBufferConnector_ms": 0.017539262771606445, "ViewRequirementAgentConnector_ms": 1.0649964809417725}}, "episode_reward_max": 21.764178422544372, "episode_reward_min": 15.13409590194117, "episode_reward_mean": 18.492293097273617, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.958666214719177, 17.561379659047248, 20.604483849047657, 20.80223314236272, 16.695782283862425, 17.808240196865086, 16.67400140606793, 19.373621681526522, 15.51268783367663, 21.447145248487754, 18.148042388341462, 20.18945619439424, 21.539723486827192, 17.49992244092632, 17.45554132588885, 15.13409590194117, 16.787748685447205, 16.712174554568037, 19.324076076421914, 19.01155800016766, 19.120861996247637, 18.02543914676606, 18.565818974881765, 16.418591562940154, 19.300446980944923, 17.464867107965652, 18.953860626473194, 21.401184828478474, 21.506795613434484, 16.190991012264835, 17.999958169413468, 18.824546843122047, 17.7225248195677, 18.179000588095615, 18.708529495635812, 19.71199389847782, 17.49444986970813, 19.51240016996955, 18.518286982939184, 17.398795132985978, 17.81616439250534, 16.747342257633388, 17.862286403536412, 21.181501757641506, 15.876771046768594, 20.171536786762555, 19.281906483006715, 19.54175772118099, 17.62384511007877, 17.520288962901734, 17.449703247514478, 16.489638925726194, 19.524103002660127, 15.885436777445417, 17.964442634179594, 18.35773279124784, 18.16297761454621, 18.43162451464783, 19.88153511419417, 17.742246875741213, 18.326296236180948, 16.292605944230047, 16.593483706214013, 18.6569465955353, 16.387473877808144, 18.81165582929661, 16.289978607289775, 18.912473591311905, 20.302583745110464, 17.34989072863253, 19.986706583464, 21.313807148133787, 20.39309310033896, 19.629597414385078, 18.475649946747023, 18.7724855584974, 19.900049323204374, 18.83925734234364, 19.52663120057711, 18.908949371544992, 18.825565914045367, 18.81724185351606, 21.764178422544372, 20.490505245866306, 17.941136523011266, 18.04935113871818, 18.099714063558892, 17.45971547515695, 17.68527623302549, 20.92360428797665, 18.935901172494017, 19.184541178770704, 18.834817754568295, 19.848908168439102, 20.883980743921285, 19.41707054908446, 18.842429541466167, 18.499765509633946, 16.020367709289648, 16.262855580609582], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.066979348267349, "mean_inference_ms": 8.303080730738591, "mean_action_processing_ms": 0.5667677300059623, "mean_env_wait_ms": 24.312666625837604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06055498123168945, "StateBufferConnector_ms": 0.017539262771606445, "ViewRequirementAgentConnector_ms": 1.0649964809417725}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2513874, "num_agent_steps_trained": 2513874, "num_env_steps_sampled": 2513874, "num_env_steps_trained": 2513874, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 244.82197080964653, "num_env_steps_trained_throughput_per_sec": 244.82197080964653, "timesteps_total": 2513874, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2513874, "timers": {"training_iteration_time_ms": 63386.299, "sample_time_ms": 47463.816, "load_time_ms": 2177.068, "load_throughput": 7183.055, "learn_time_ms": 13129.872, "learn_throughput": 1191.025, "synch_weights_time_ms": 477.917}, "counters": {"num_env_steps_sampled": 2513874, "num_env_steps_trained": 2513874, "num_agent_steps_sampled": 2513874, "num_agent_steps_trained": 2513874}, "done": false, "episodes_total": 1386, "training_iteration": 165, "trial_id": "c0a6f_00000", "date": "2025-06-07_00-06-12", "timestamp": 1749247572, "time_this_iter_s": 63.89448857307434, "time_total_s": 5805.732740402222, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5805.732740402222, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 80.70422535211267, "ram_util_percent": 71.0, "gpu_util_percent0": 0.07422535211267606, "vram_util_percent0": 0.8619768742664321}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.533935546875, "cur_lr": 7.486126e-05, "total_loss": -0.06867041766389527, "policy_loss": -0.026695952020077542, "vf_loss": 0.014876574070870199, "vf_explained_var": 0.8549020250277086, "kl": 0.015467917917998121, "entropy": 18.40231233250011, "entropy_coeff": 0.0029722520000000007}, "model": {}, "num_grad_updates_lifetime": 54725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2529512, "num_env_steps_trained": 2529512, "num_agent_steps_sampled": 2529512, "num_agent_steps_trained": 2529512}, "sampler_results": {"episode_reward_max": 21.764178422544372, "episode_reward_min": 15.121454672283866, "episode_reward_mean": 18.33903591952381, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.45554132588885, 15.13409590194117, 16.787748685447205, 16.712174554568037, 19.324076076421914, 19.01155800016766, 19.120861996247637, 18.02543914676606, 18.565818974881765, 16.418591562940154, 19.300446980944923, 17.464867107965652, 18.953860626473194, 21.401184828478474, 21.506795613434484, 16.190991012264835, 17.999958169413468, 18.824546843122047, 17.7225248195677, 18.179000588095615, 18.708529495635812, 19.71199389847782, 17.49444986970813, 19.51240016996955, 18.518286982939184, 17.398795132985978, 17.81616439250534, 16.747342257633388, 17.862286403536412, 21.181501757641506, 15.876771046768594, 20.171536786762555, 19.281906483006715, 19.54175772118099, 17.62384511007877, 17.520288962901734, 17.449703247514478, 16.489638925726194, 19.524103002660127, 15.885436777445417, 17.964442634179594, 18.35773279124784, 18.16297761454621, 18.43162451464783, 19.88153511419417, 17.742246875741213, 18.326296236180948, 16.292605944230047, 16.593483706214013, 18.6569465955353, 16.387473877808144, 18.81165582929661, 16.289978607289775, 18.912473591311905, 20.302583745110464, 17.34989072863253, 19.986706583464, 21.313807148133787, 20.39309310033896, 19.629597414385078, 18.475649946747023, 18.7724855584974, 19.900049323204374, 18.83925734234364, 19.52663120057711, 18.908949371544992, 18.825565914045367, 18.81724185351606, 21.764178422544372, 20.490505245866306, 17.941136523011266, 18.04935113871818, 18.099714063558892, 17.45971547515695, 17.68527623302549, 20.92360428797665, 18.935901172494017, 19.184541178770704, 18.834817754568295, 19.848908168439102, 20.883980743921285, 19.41707054908446, 18.842429541466167, 18.499765509633946, 16.020367709289648, 16.262855580609582, 16.7596881892241, 20.359068825481113, 19.565736613678787, 16.604768235204297, 16.400582675809925, 17.097082752539645, 16.41481482493261, 17.547550674669687, 16.887199501825542, 17.961952458544562, 17.63912509149069, 15.121454672283866, 19.56428867736353, 16.566355058123296], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.068027460536992, "mean_inference_ms": 8.317944224115202, "mean_action_processing_ms": 0.5677248513383053, "mean_env_wait_ms": 24.356651093219547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056969642639160156, "StateBufferConnector_ms": 0.027617216110229492, "ViewRequirementAgentConnector_ms": 1.038475751876831}}, "episode_reward_max": 21.764178422544372, "episode_reward_min": 15.121454672283866, "episode_reward_mean": 18.33903591952381, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.45554132588885, 15.13409590194117, 16.787748685447205, 16.712174554568037, 19.324076076421914, 19.01155800016766, 19.120861996247637, 18.02543914676606, 18.565818974881765, 16.418591562940154, 19.300446980944923, 17.464867107965652, 18.953860626473194, 21.401184828478474, 21.506795613434484, 16.190991012264835, 17.999958169413468, 18.824546843122047, 17.7225248195677, 18.179000588095615, 18.708529495635812, 19.71199389847782, 17.49444986970813, 19.51240016996955, 18.518286982939184, 17.398795132985978, 17.81616439250534, 16.747342257633388, 17.862286403536412, 21.181501757641506, 15.876771046768594, 20.171536786762555, 19.281906483006715, 19.54175772118099, 17.62384511007877, 17.520288962901734, 17.449703247514478, 16.489638925726194, 19.524103002660127, 15.885436777445417, 17.964442634179594, 18.35773279124784, 18.16297761454621, 18.43162451464783, 19.88153511419417, 17.742246875741213, 18.326296236180948, 16.292605944230047, 16.593483706214013, 18.6569465955353, 16.387473877808144, 18.81165582929661, 16.289978607289775, 18.912473591311905, 20.302583745110464, 17.34989072863253, 19.986706583464, 21.313807148133787, 20.39309310033896, 19.629597414385078, 18.475649946747023, 18.7724855584974, 19.900049323204374, 18.83925734234364, 19.52663120057711, 18.908949371544992, 18.825565914045367, 18.81724185351606, 21.764178422544372, 20.490505245866306, 17.941136523011266, 18.04935113871818, 18.099714063558892, 17.45971547515695, 17.68527623302549, 20.92360428797665, 18.935901172494017, 19.184541178770704, 18.834817754568295, 19.848908168439102, 20.883980743921285, 19.41707054908446, 18.842429541466167, 18.499765509633946, 16.020367709289648, 16.262855580609582, 16.7596881892241, 20.359068825481113, 19.565736613678787, 16.604768235204297, 16.400582675809925, 17.097082752539645, 16.41481482493261, 17.547550674669687, 16.887199501825542, 17.961952458544562, 17.63912509149069, 15.121454672283866, 19.56428867736353, 16.566355058123296], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.068027460536992, "mean_inference_ms": 8.317944224115202, "mean_action_processing_ms": 0.5677248513383053, "mean_env_wait_ms": 24.356651093219547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056969642639160156, "StateBufferConnector_ms": 0.027617216110229492, "ViewRequirementAgentConnector_ms": 1.038475751876831}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2529512, "num_agent_steps_trained": 2529512, "num_env_steps_sampled": 2529512, "num_env_steps_trained": 2529512, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 237.29724960257823, "num_env_steps_trained_throughput_per_sec": 237.29724960257823, "timesteps_total": 2529512, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2529512, "timers": {"training_iteration_time_ms": 64390.927, "sample_time_ms": 48158.908, "load_time_ms": 2170.28, "load_throughput": 7205.524, "learn_time_ms": 13441.429, "learn_throughput": 1163.418, "synch_weights_time_ms": 482.106}, "counters": {"num_env_steps_sampled": 2529512, "num_env_steps_trained": 2529512, "num_agent_steps_sampled": 2529512, "num_agent_steps_trained": 2529512}, "done": false, "episodes_total": 1400, "training_iteration": 166, "trial_id": "c0a6f_00000", "date": "2025-06-07_00-07-18", "timestamp": 1749247638, "time_this_iter_s": 65.91748714447021, "time_total_s": 5871.650227546692, "pid": 27124, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": {"r_count": 66743.0001, "r_mean": -0.012154109842036603, "r_var": 400.7551783813234, "tanh_k": 2.0, "feature_welford": {"unrealized_pnl": [66744, 8487.456861744608, 1021833662413107.6], "realized_pnl": [66744, 14298.386568256883, 3022601524361624.0], "compounded_returns": [66744, 4658.858081333823, 2019923694359.4092], "balance": [66744, 11965820.42632082, 9.686541784992762e+18], "position_value": [66744, 147955.74986166522, 1.063216009746603e+16], "current_position_size": [66744, 739448.8220947657, 2.6578374187098134e+17], "last_log_ret": [66744, 0.007398957083721163, 277.61112549304653], "sortino_ratio": [66744, 2.496783084055361, 1934099165.6233947], "rolling_pnl_sigma": [66744, 0.035359450680258586, 178.8286760953185], "portfolio_cash_ratio": [66744, 0.7533272145239721, 7722.776272538818], "free_collateral": [66744, 12111170.77440995, 9.642361291564913e+18], "mm_reqs": [66744, 11202.580415611144, 176372674281992.62], "unrealized_pnl_0": [66744, 16.1253521882899, 161799220284.15677], "unrealized_pnl_1": [66744, 29.272716315031445, 927477441683.1495], "unrealized_pnl_2": [66744, 2859.358849331966, 108839886352439.56], "unrealized_pnl_3": [66744, 11956.65118351945, 2666144601834942.0], "unrealized_pnl_4": [66744, 67.41194695314003, 1490567030336.2737], "unrealized_pnl_5": [66744, 1937.3799917599297, 139906883879286.22], "unrealized_pnl_6": [66744, 80.7261270152246, 1635836132162.1462], "unrealized_pnl_7": [66744, 18.792583200116784, 253083970561.1843], "unrealized_pnl_8": [66744, 44.63857980188743, 209132741894.14517], "unrealized_pnl_9": [66744, 812.7806087332596, 29193202679478.12], "margin_usage_ratio": [66744, 0.008980138915945268, 11.439969156304716]}, "pcr_min_ew": 0.9950485716177686, "pcr_max_ew": 0.999999997315571}, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001D5CE7E7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1500000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5871.650227546692, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 82.57123287671234, "ram_util_percent": 74.86438356164383, "gpu_util_percent0": 0.08712328767123288, "vram_util_percent0": 0.8919270833333333}}
