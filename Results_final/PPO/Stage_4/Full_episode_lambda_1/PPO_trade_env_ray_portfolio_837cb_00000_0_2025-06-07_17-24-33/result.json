{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5, "cur_lr": 0.00010000000000000003, "total_loss": -0.08978453557580136, "policy_loss": 0.007733503116581303, "vf_loss": 0.12093489848507138, "vf_explained_var": 0.22510155508151422, "kl": 0.013883306512322837, "entropy": 14.07401698919443, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 130.5, "diff_num_grad_updates_vs_sampler_policy": 129.5}}, "num_env_steps_sampled": 7418, "num_env_steps_trained": 7418, "num_agent_steps_sampled": 7418, "num_agent_steps_trained": 7418}, "sampler_results": {"episode_reward_max": -2.71386333811635, "episode_reward_min": -32.10373929778766, "episode_reward_mean": -16.350354981259677, "episode_len_mean": 529.8571428571429, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.000073657377666, -32.10373929778766, -9.62164522865629, -27.3404067473337, -12.564895480922065, -9.972443901397737, -31.13716251254926, -3.669702861306945, -2.71386333811635, -6.1635292777142245, -20.26587765245486, -11.68989929714503, -18.531483229333865, -26.13024725553984], "episode_lengths": [406, 642, 268, 410, 1100, 260, 795, 269, 149, 258, 758, 299, 1117, 687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.353809304260428, "mean_inference_ms": 7.031800339505133, "mean_action_processing_ms": 0.5172997946036895, "mean_env_wait_ms": 23.081337080930407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01419271741594587, "StateBufferConnector_ms": 0.007072516850062779, "ViewRequirementAgentConnector_ms": 0.8195042610168457}}, "episode_reward_max": -2.71386333811635, "episode_reward_min": -32.10373929778766, "episode_reward_mean": -16.350354981259677, "episode_len_mean": 529.8571428571429, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.000073657377666, -32.10373929778766, -9.62164522865629, -27.3404067473337, -12.564895480922065, -9.972443901397737, -31.13716251254926, -3.669702861306945, -2.71386333811635, -6.1635292777142245, -20.26587765245486, -11.68989929714503, -18.531483229333865, -26.13024725553984], "episode_lengths": [406, 642, 268, 410, 1100, 260, 795, 269, 149, 258, 758, 299, 1117, 687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.353809304260428, "mean_inference_ms": 7.031800339505133, "mean_action_processing_ms": 0.5172997946036895, "mean_env_wait_ms": 23.081337080930407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01419271741594587, "StateBufferConnector_ms": 0.007072516850062779, "ViewRequirementAgentConnector_ms": 0.8195042610168457}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7418, "num_agent_steps_trained": 7418, "num_env_steps_sampled": 7418, "num_env_steps_trained": 7418, "num_env_steps_sampled_this_iter": 7418, "num_env_steps_trained_this_iter": 7418, "num_env_steps_sampled_throughput_per_sec": 194.49532833533902, "num_env_steps_trained_throughput_per_sec": 194.49532833533902, "timesteps_total": 7418, "num_steps_trained_this_iter": 7418, "agent_timesteps_total": 7418, "timers": {"training_iteration_time_ms": 38139.734, "sample_time_ms": 30252.992, "load_time_ms": 1410.868, "load_throughput": 5257.756, "learn_time_ms": 5973.729, "learn_throughput": 1241.77, "synch_weights_time_ms": 445.73}, "counters": {"num_env_steps_sampled": 7418, "num_env_steps_trained": 7418, "num_agent_steps_sampled": 7418, "num_agent_steps_trained": 7418}, "done": false, "episodes_total": 14, "training_iteration": 1, "trial_id": "837cb_00000", "date": "2025-06-07_17-26-17", "timestamp": 1749309977, "time_this_iter_s": 38.16380214691162, "time_total_s": 38.16380214691162, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 38.16380214691162, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 53.03829787234041, "ram_util_percent": 58.40212765957448, "gpu_util_percent0": 0.04659574468085107, "vram_util_percent0": 0.06328609818262412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5, "cur_lr": 9.992582000000002e-05, "total_loss": -0.1260288916528225, "policy_loss": -0.0191122546622258, "vf_loss": 0.10132533504317204, "vf_explained_var": 0.5501728288829326, "kl": 0.006706840227283174, "entropy": 14.119134283065796, "entropy_coeff": 0.00996291}, "model": {}, "num_grad_updates_lifetime": 380.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 14182, "num_env_steps_trained": 14182, "num_agent_steps_sampled": 14182, "num_agent_steps_trained": 14182}, "sampler_results": {"episode_reward_max": 13.434860715759086, "episode_reward_min": -33.03632969461331, "episode_reward_mean": -9.492540061405748, "episode_len_mean": 506.5, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.000073657377666, -32.10373929778766, -9.62164522865629, -27.3404067473337, -12.564895480922065, -9.972443901397737, -31.13716251254926, -3.669702861306945, -2.71386333811635, -6.1635292777142245, -20.26587765245486, -11.68989929714503, -18.531483229333865, -26.13024725553984, -3.968774185919396, 11.91654219649101, -25.339155594494592, 2.7283847738785654, -33.03632969461331, -6.987386798748345, 7.640071740338858, -1.414027321519181, -4.0474577810762895, -14.546419497723354, 13.434860715759086, 3.970381181165502, 1.919815122959231, 10.84334316177672], "episode_lengths": [406, 642, 268, 410, 1100, 260, 795, 269, 149, 258, 758, 299, 1117, 687, 888, 259, 606, 812, 531, 382, 260, 296, 295, 799, 273, 295, 305, 763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2533325013563656, "mean_inference_ms": 6.98683788499588, "mean_action_processing_ms": 0.5109929251872095, "mean_env_wait_ms": 22.405635033425764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014299154281616211, "StateBufferConnector_ms": 0.013261181967599052, "ViewRequirementAgentConnector_ms": 0.7639884948730469}}, "episode_reward_max": 13.434860715759086, "episode_reward_min": -33.03632969461331, "episode_reward_mean": -9.492540061405748, "episode_len_mean": 506.5, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.000073657377666, -32.10373929778766, -9.62164522865629, -27.3404067473337, -12.564895480922065, -9.972443901397737, -31.13716251254926, -3.669702861306945, -2.71386333811635, -6.1635292777142245, -20.26587765245486, -11.68989929714503, -18.531483229333865, -26.13024725553984, -3.968774185919396, 11.91654219649101, -25.339155594494592, 2.7283847738785654, -33.03632969461331, -6.987386798748345, 7.640071740338858, -1.414027321519181, -4.0474577810762895, -14.546419497723354, 13.434860715759086, 3.970381181165502, 1.919815122959231, 10.84334316177672], "episode_lengths": [406, 642, 268, 410, 1100, 260, 795, 269, 149, 258, 758, 299, 1117, 687, 888, 259, 606, 812, 531, 382, 260, 296, 295, 799, 273, 295, 305, 763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2533325013563656, "mean_inference_ms": 6.98683788499588, "mean_action_processing_ms": 0.5109929251872095, "mean_env_wait_ms": 22.405635033425764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014299154281616211, "StateBufferConnector_ms": 0.013261181967599052, "ViewRequirementAgentConnector_ms": 0.7639884948730469}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14182, "num_agent_steps_trained": 14182, "num_env_steps_sampled": 14182, "num_env_steps_trained": 14182, "num_env_steps_sampled_this_iter": 6764, "num_env_steps_trained_this_iter": 6764, "num_env_steps_sampled_throughput_per_sec": 221.83956355466958, "num_env_steps_trained_throughput_per_sec": 221.83956355466958, "timesteps_total": 14182, "num_steps_trained_this_iter": 6764, "agent_timesteps_total": 14182, "timers": {"training_iteration_time_ms": 34315.119, "sample_time_ms": 27283.505, "load_time_ms": 1121.466, "load_throughput": 6322.975, "learn_time_ms": 5427.513, "learn_throughput": 1306.492, "synch_weights_time_ms": 428.147}, "counters": {"num_env_steps_sampled": 14182, "num_env_steps_trained": 14182, "num_agent_steps_sampled": 14182, "num_agent_steps_trained": 14182}, "done": false, "episodes_total": 28, "training_iteration": 2, "trial_id": "837cb_00000", "date": "2025-06-07_17-26-47", "timestamp": 1749310007, "time_this_iter_s": 30.50850248336792, "time_total_s": 68.67230463027954, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 68.67230463027954, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 58.64444444444444, "ram_util_percent": 59.902777777777764, "gpu_util_percent0": 0.049166666666666664, "vram_util_percent0": 0.2714120370370371}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.25, "cur_lr": 9.985818e-05, "total_loss": -0.12173186846077443, "policy_loss": -0.00025868836635102826, "vf_loss": 0.057872539820770424, "vf_explained_var": 0.6856101022164027, "kl": 0.007572569248483584, "entropy": 14.173311875661215, "entropy_coeff": 0.00992909}, "model": {}, "num_grad_updates_lifetime": 650.5, "diff_num_grad_updates_vs_sampler_policy": 149.5}}, "num_env_steps_sampled": 22645, "num_env_steps_trained": 22645, "num_agent_steps_sampled": 22645, "num_agent_steps_trained": 22645}, "sampler_results": {"episode_reward_max": 13.434860715759086, "episode_reward_min": -33.03632969461331, "episode_reward_mean": -5.214036568157864, "episode_len_mean": 539.1666666666666, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.000073657377666, -32.10373929778766, -9.62164522865629, -27.3404067473337, -12.564895480922065, -9.972443901397737, -31.13716251254926, -3.669702861306945, -2.71386333811635, -6.1635292777142245, -20.26587765245486, -11.68989929714503, -18.531483229333865, -26.13024725553984, -3.968774185919396, 11.91654219649101, -25.339155594494592, 2.7283847738785654, -33.03632969461331, -6.987386798748345, 7.640071740338858, -1.414027321519181, -4.0474577810762895, -14.546419497723354, 13.434860715759086, 3.970381181165502, 1.919815122959231, 10.84334316177672, 5.9740002900264555, -2.3743401344767134, 8.791176800043557, 7.348676515405291, 11.682469663535112, 8.698734558625842, 0.3678725610479243, -1.0251219584411655, -1.6697867943505518, 8.04510477174919, -6.483243005830579, 2.0977750355364195, -4.821540838957108, 10.169808392816961], "episode_lengths": [406, 642, 268, 410, 1100, 260, 795, 269, 149, 258, 758, 299, 1117, 687, 888, 259, 606, 812, 531, 382, 260, 296, 295, 799, 273, 295, 305, 763, 273, 733, 707, 299, 302, 1117, 764, 128, 1117, 233, 748, 1117, 653, 272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1835070618822825, "mean_inference_ms": 6.908662758744051, "mean_action_processing_ms": 0.5034310286385797, "mean_env_wait_ms": 21.905890499005643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014298302786690848, "StateBufferConnector_ms": 0.008840787978399368, "ViewRequirementAgentConnector_ms": 0.7002387728009906}}, "episode_reward_max": 13.434860715759086, "episode_reward_min": -33.03632969461331, "episode_reward_mean": -5.214036568157864, "episode_len_mean": 539.1666666666666, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.000073657377666, -32.10373929778766, -9.62164522865629, -27.3404067473337, -12.564895480922065, -9.972443901397737, -31.13716251254926, -3.669702861306945, -2.71386333811635, -6.1635292777142245, -20.26587765245486, -11.68989929714503, -18.531483229333865, -26.13024725553984, -3.968774185919396, 11.91654219649101, -25.339155594494592, 2.7283847738785654, -33.03632969461331, -6.987386798748345, 7.640071740338858, -1.414027321519181, -4.0474577810762895, -14.546419497723354, 13.434860715759086, 3.970381181165502, 1.919815122959231, 10.84334316177672, 5.9740002900264555, -2.3743401344767134, 8.791176800043557, 7.348676515405291, 11.682469663535112, 8.698734558625842, 0.3678725610479243, -1.0251219584411655, -1.6697867943505518, 8.04510477174919, -6.483243005830579, 2.0977750355364195, -4.821540838957108, 10.169808392816961], "episode_lengths": [406, 642, 268, 410, 1100, 260, 795, 269, 149, 258, 758, 299, 1117, 687, 888, 259, 606, 812, 531, 382, 260, 296, 295, 799, 273, 295, 305, 763, 273, 733, 707, 299, 302, 1117, 764, 128, 1117, 233, 748, 1117, 653, 272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1835070618822825, "mean_inference_ms": 6.908662758744051, "mean_action_processing_ms": 0.5034310286385797, "mean_env_wait_ms": 21.905890499005643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014298302786690848, "StateBufferConnector_ms": 0.008840787978399368, "ViewRequirementAgentConnector_ms": 0.7002387728009906}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22645, "num_agent_steps_trained": 22645, "num_env_steps_sampled": 22645, "num_env_steps_trained": 22645, "num_env_steps_sampled_this_iter": 8463, "num_env_steps_trained_this_iter": 8463, "num_env_steps_sampled_throughput_per_sec": 222.1776408406934, "num_env_steps_trained_throughput_per_sec": 222.1776408406934, "timesteps_total": 22645, "num_steps_trained_this_iter": 8463, "agent_timesteps_total": 22645, "timers": {"training_iteration_time_ms": 35573.462, "sample_time_ms": 28325.105, "load_time_ms": 1080.381, "load_throughput": 6986.731, "learn_time_ms": 5679.93, "learn_throughput": 1328.948, "synch_weights_time_ms": 430.532}, "counters": {"num_env_steps_sampled": 22645, "num_env_steps_trained": 22645, "num_agent_steps_sampled": 22645, "num_agent_steps_trained": 22645}, "done": false, "episodes_total": 42, "training_iteration": 3, "trial_id": "837cb_00000", "date": "2025-06-07_17-27-26", "timestamp": 1749310046, "time_this_iter_s": 38.12236261367798, "time_total_s": 106.79466724395752, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 106.79466724395752, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 57.38260869565218, "ram_util_percent": 59.6717391304348, "gpu_util_percent0": 0.05369565217391305, "vram_util_percent0": 0.45674111186594185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.25, "cur_lr": 9.977354999999999e-05, "total_loss": -0.1397447010840882, "policy_loss": -0.022243088040858946, "vf_loss": 0.07302479793345838, "vf_explained_var": 0.7479911173834946, "kl": 0.007151357769511325, "entropy": 14.28139009475708, "entropy_coeff": 0.009886775}, "model": {}, "num_grad_updates_lifetime": 965.5, "diff_num_grad_updates_vs_sampler_policy": 164.5}}, "num_env_steps_sampled": 32114, "num_env_steps_trained": 32114, "num_agent_steps_sampled": 32114, "num_agent_steps_trained": 32114}, "sampler_results": {"episode_reward_max": 20.620984196232417, "episode_reward_min": -33.03632969461331, "episode_reward_mean": -4.4596179006851555, "episode_len_mean": 573.4642857142857, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.000073657377666, -32.10373929778766, -9.62164522865629, -27.3404067473337, -12.564895480922065, -9.972443901397737, -31.13716251254926, -3.669702861306945, -2.71386333811635, -6.1635292777142245, -20.26587765245486, -11.68989929714503, -18.531483229333865, -26.13024725553984, -3.968774185919396, 11.91654219649101, -25.339155594494592, 2.7283847738785654, -33.03632969461331, -6.987386798748345, 7.640071740338858, -1.414027321519181, -4.0474577810762895, -14.546419497723354, 13.434860715759086, 3.970381181165502, 1.919815122959231, 10.84334316177672, 5.9740002900264555, -2.3743401344767134, 8.791176800043557, 7.348676515405291, 11.682469663535112, 8.698734558625842, 0.3678725610479243, -1.0251219584411655, -1.6697867943505518, 8.04510477174919, -6.483243005830579, 2.0977750355364195, -4.821540838957108, 10.169808392816961, -1.9847790937806553, 11.665025284375895, 20.620984196232417, 1.6027795918454721, -2.11299194112202, -8.592944005346263, -13.957915758378546, -9.809152568738629, -14.755414094307662, -3.7534447443378967, -4.495715477985993, -6.224197210046664, -5.303672654412329, 6.352371900264488], "episode_lengths": [406, 642, 268, 410, 1100, 260, 795, 269, 149, 258, 758, 299, 1117, 687, 888, 259, 606, 812, 531, 382, 260, 296, 295, 799, 273, 295, 305, 763, 273, 733, 707, 299, 302, 1117, 764, 128, 1117, 233, 748, 1117, 653, 272, 870, 269, 1103, 262, 374, 449, 587, 763, 683, 457, 829, 982, 890, 951]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.136213158672171, "mean_inference_ms": 6.878034129599955, "mean_action_processing_ms": 0.49940271542462117, "mean_env_wait_ms": 21.64476082930671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012502925736563546, "StateBufferConnector_ms": 0.008405532155718123, "ViewRequirementAgentConnector_ms": 0.7299350840704781}}, "episode_reward_max": 20.620984196232417, "episode_reward_min": -33.03632969461331, "episode_reward_mean": -4.4596179006851555, "episode_len_mean": 573.4642857142857, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.000073657377666, -32.10373929778766, -9.62164522865629, -27.3404067473337, -12.564895480922065, -9.972443901397737, -31.13716251254926, -3.669702861306945, -2.71386333811635, -6.1635292777142245, -20.26587765245486, -11.68989929714503, -18.531483229333865, -26.13024725553984, -3.968774185919396, 11.91654219649101, -25.339155594494592, 2.7283847738785654, -33.03632969461331, -6.987386798748345, 7.640071740338858, -1.414027321519181, -4.0474577810762895, -14.546419497723354, 13.434860715759086, 3.970381181165502, 1.919815122959231, 10.84334316177672, 5.9740002900264555, -2.3743401344767134, 8.791176800043557, 7.348676515405291, 11.682469663535112, 8.698734558625842, 0.3678725610479243, -1.0251219584411655, -1.6697867943505518, 8.04510477174919, -6.483243005830579, 2.0977750355364195, -4.821540838957108, 10.169808392816961, -1.9847790937806553, 11.665025284375895, 20.620984196232417, 1.6027795918454721, -2.11299194112202, -8.592944005346263, -13.957915758378546, -9.809152568738629, -14.755414094307662, -3.7534447443378967, -4.495715477985993, -6.224197210046664, -5.303672654412329, 6.352371900264488], "episode_lengths": [406, 642, 268, 410, 1100, 260, 795, 269, 149, 258, 758, 299, 1117, 687, 888, 259, 606, 812, 531, 382, 260, 296, 295, 799, 273, 295, 305, 763, 273, 733, 707, 299, 302, 1117, 764, 128, 1117, 233, 748, 1117, 653, 272, 870, 269, 1103, 262, 374, 449, 587, 763, 683, 457, 829, 982, 890, 951]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.136213158672171, "mean_inference_ms": 6.878034129599955, "mean_action_processing_ms": 0.49940271542462117, "mean_env_wait_ms": 21.64476082930671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012502925736563546, "StateBufferConnector_ms": 0.008405532155718123, "ViewRequirementAgentConnector_ms": 0.7299350840704781}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32114, "num_agent_steps_trained": 32114, "num_env_steps_sampled": 32114, "num_env_steps_trained": 32114, "num_env_steps_sampled_this_iter": 9469, "num_env_steps_trained_this_iter": 9469, "num_env_steps_sampled_throughput_per_sec": 240.78261781226712, "num_env_steps_trained_throughput_per_sec": 240.78261781226712, "timesteps_total": 32114, "num_steps_trained_this_iter": 9469, "agent_timesteps_total": 32114, "timers": {"training_iteration_time_ms": 36511.579, "sample_time_ms": 28972.924, "load_time_ms": 1100.081, "load_throughput": 7298.1, "learn_time_ms": 5945.582, "learn_throughput": 1350.33, "synch_weights_time_ms": 433.826}, "counters": {"num_env_steps_sampled": 32114, "num_env_steps_trained": 32114, "num_agent_steps_sampled": 32114, "num_agent_steps_trained": 32114}, "done": false, "episodes_total": 56, "training_iteration": 4, "trial_id": "837cb_00000", "date": "2025-06-07_17-28-05", "timestamp": 1749310085, "time_this_iter_s": 39.35332441329956, "time_total_s": 146.14799165725708, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 146.14799165725708, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 61.90624999999999, "ram_util_percent": 61.270833333333336, "gpu_util_percent0": 0.05916666666666667, "vram_util_percent0": 0.6921657986111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.967886000000002e-05, "total_loss": -0.14947501281387218, "policy_loss": -0.029767196321682562, "vf_loss": 0.06362836217241628, "vf_explained_var": 0.8488639331999279, "kl": 0.007705108147500086, "entropy": 14.204020382109142, "entropy_coeff": 0.009839429999999998}, "model": {}, "num_grad_updates_lifetime": 1235.5, "diff_num_grad_updates_vs_sampler_policy": 104.5}}, "num_env_steps_sampled": 38187, "num_env_steps_trained": 38187, "num_agent_steps_sampled": 38187, "num_agent_steps_trained": 38187}, "sampler_results": {"episode_reward_max": 20.620984196232417, "episode_reward_min": -33.03632969461331, "episode_reward_mean": -3.0058339904449607, "episode_len_mean": 545.5285714285715, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.000073657377666, -32.10373929778766, -9.62164522865629, -27.3404067473337, -12.564895480922065, -9.972443901397737, -31.13716251254926, -3.669702861306945, -2.71386333811635, -6.1635292777142245, -20.26587765245486, -11.68989929714503, -18.531483229333865, -26.13024725553984, -3.968774185919396, 11.91654219649101, -25.339155594494592, 2.7283847738785654, -33.03632969461331, -6.987386798748345, 7.640071740338858, -1.414027321519181, -4.0474577810762895, -14.546419497723354, 13.434860715759086, 3.970381181165502, 1.919815122959231, 10.84334316177672, 5.9740002900264555, -2.3743401344767134, 8.791176800043557, 7.348676515405291, 11.682469663535112, 8.698734558625842, 0.3678725610479243, -1.0251219584411655, -1.6697867943505518, 8.04510477174919, -6.483243005830579, 2.0977750355364195, -4.821540838957108, 10.169808392816961, -1.9847790937806553, 11.665025284375895, 20.620984196232417, 1.6027795918454721, -2.11299194112202, -8.592944005346263, -13.957915758378546, -9.809152568738629, -14.755414094307662, -3.7534447443378967, -4.495715477985993, -6.224197210046664, -5.303672654412329, 6.352371900264488, 7.246257296784583, 12.241514098626649, 10.63223628526121, 5.01750477214695, 7.504467004472774, 1.9549330028270715, 3.9331951154137688, 0.33206839745803385, 0.39766783938862105, -4.733043947170461, -1.202269628676948, 0.007244163366058487, -7.648046061936714, 3.646494769259921], "episode_lengths": [406, 642, 268, 410, 1100, 260, 795, 269, 149, 258, 758, 299, 1117, 687, 888, 259, 606, 812, 531, 382, 260, 296, 295, 799, 273, 295, 305, 763, 273, 733, 707, 299, 302, 1117, 764, 128, 1117, 233, 748, 1117, 653, 272, 870, 269, 1103, 262, 374, 449, 587, 763, 683, 457, 829, 982, 890, 951, 269, 1117, 269, 350, 164, 302, 194, 916, 503, 439, 371, 365, 408, 406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.106641617823434, "mean_inference_ms": 6.866285434891758, "mean_action_processing_ms": 0.4967204208100989, "mean_env_wait_ms": 21.47689204705856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01142331532069615, "StateBufferConnector_ms": 0.006724425724574498, "ViewRequirementAgentConnector_ms": 0.7485430581229073}}, "episode_reward_max": 20.620984196232417, "episode_reward_min": -33.03632969461331, "episode_reward_mean": -3.0058339904449607, "episode_len_mean": 545.5285714285715, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.000073657377666, -32.10373929778766, -9.62164522865629, -27.3404067473337, -12.564895480922065, -9.972443901397737, -31.13716251254926, -3.669702861306945, -2.71386333811635, -6.1635292777142245, -20.26587765245486, -11.68989929714503, -18.531483229333865, -26.13024725553984, -3.968774185919396, 11.91654219649101, -25.339155594494592, 2.7283847738785654, -33.03632969461331, -6.987386798748345, 7.640071740338858, -1.414027321519181, -4.0474577810762895, -14.546419497723354, 13.434860715759086, 3.970381181165502, 1.919815122959231, 10.84334316177672, 5.9740002900264555, -2.3743401344767134, 8.791176800043557, 7.348676515405291, 11.682469663535112, 8.698734558625842, 0.3678725610479243, -1.0251219584411655, -1.6697867943505518, 8.04510477174919, -6.483243005830579, 2.0977750355364195, -4.821540838957108, 10.169808392816961, -1.9847790937806553, 11.665025284375895, 20.620984196232417, 1.6027795918454721, -2.11299194112202, -8.592944005346263, -13.957915758378546, -9.809152568738629, -14.755414094307662, -3.7534447443378967, -4.495715477985993, -6.224197210046664, -5.303672654412329, 6.352371900264488, 7.246257296784583, 12.241514098626649, 10.63223628526121, 5.01750477214695, 7.504467004472774, 1.9549330028270715, 3.9331951154137688, 0.33206839745803385, 0.39766783938862105, -4.733043947170461, -1.202269628676948, 0.007244163366058487, -7.648046061936714, 3.646494769259921], "episode_lengths": [406, 642, 268, 410, 1100, 260, 795, 269, 149, 258, 758, 299, 1117, 687, 888, 259, 606, 812, 531, 382, 260, 296, 295, 799, 273, 295, 305, 763, 273, 733, 707, 299, 302, 1117, 764, 128, 1117, 233, 748, 1117, 653, 272, 870, 269, 1103, 262, 374, 449, 587, 763, 683, 457, 829, 982, 890, 951, 269, 1117, 269, 350, 164, 302, 194, 916, 503, 439, 371, 365, 408, 406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.106641617823434, "mean_inference_ms": 6.866285434891758, "mean_action_processing_ms": 0.4967204208100989, "mean_env_wait_ms": 21.47689204705856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01142331532069615, "StateBufferConnector_ms": 0.006724425724574498, "ViewRequirementAgentConnector_ms": 0.7485430581229073}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38187, "num_agent_steps_trained": 38187, "num_env_steps_sampled": 38187, "num_env_steps_trained": 38187, "num_env_steps_sampled_this_iter": 6073, "num_env_steps_trained_this_iter": 6073, "num_env_steps_sampled_throughput_per_sec": 181.6309631805163, "num_env_steps_trained_throughput_per_sec": 181.6309631805163, "timesteps_total": 38187, "num_steps_trained_this_iter": 6073, "agent_timesteps_total": 38187, "timers": {"training_iteration_time_ms": 35896.449, "sample_time_ms": 28720.857, "load_time_ms": 1022.928, "load_throughput": 7466.215, "learn_time_ms": 5659.777, "learn_throughput": 1349.417, "synch_weights_time_ms": 430.438}, "counters": {"num_env_steps_sampled": 38187, "num_env_steps_trained": 38187, "num_agent_steps_sampled": 38187, "num_agent_steps_trained": 38187}, "done": false, "episodes_total": 70, "training_iteration": 5, "trial_id": "837cb_00000", "date": "2025-06-07_17-28-39", "timestamp": 1749310119, "time_this_iter_s": 33.44991850852966, "time_total_s": 179.59791016578674, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 179.59791016578674, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 49.65121951219512, "ram_util_percent": 60.336585365853665, "gpu_util_percent0": 0.0475609756097561, "vram_util_percent0": 0.8849283854166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.961812999999999e-05, "total_loss": -0.1484926308061134, "policy_loss": -0.028454044999347793, "vf_loss": 0.06268115120215548, "vf_explained_var": 0.8529906098489408, "kl": 0.007708181245834921, "entropy": 14.252781836191813, "entropy_coeff": 0.009809065}, "model": {}, "num_grad_updates_lifetime": 1475.5, "diff_num_grad_updates_vs_sampler_policy": 134.5}}, "num_env_steps_sampled": 45959, "num_env_steps_trained": 45959, "num_agent_steps_sampled": 45959, "num_agent_steps_trained": 45959}, "sampler_results": {"episode_reward_max": 20.620984196232417, "episode_reward_min": -33.03632969461331, "episode_reward_mean": -2.103312898592453, "episode_len_mean": 547.1309523809524, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.000073657377666, -32.10373929778766, -9.62164522865629, -27.3404067473337, -12.564895480922065, -9.972443901397737, -31.13716251254926, -3.669702861306945, -2.71386333811635, -6.1635292777142245, -20.26587765245486, -11.68989929714503, -18.531483229333865, -26.13024725553984, -3.968774185919396, 11.91654219649101, -25.339155594494592, 2.7283847738785654, -33.03632969461331, -6.987386798748345, 7.640071740338858, -1.414027321519181, -4.0474577810762895, -14.546419497723354, 13.434860715759086, 3.970381181165502, 1.919815122959231, 10.84334316177672, 5.9740002900264555, -2.3743401344767134, 8.791176800043557, 7.348676515405291, 11.682469663535112, 8.698734558625842, 0.3678725610479243, -1.0251219584411655, -1.6697867943505518, 8.04510477174919, -6.483243005830579, 2.0977750355364195, -4.821540838957108, 10.169808392816961, -1.9847790937806553, 11.665025284375895, 20.620984196232417, 1.6027795918454721, -2.11299194112202, -8.592944005346263, -13.957915758378546, -9.809152568738629, -14.755414094307662, -3.7534447443378967, -4.495715477985993, -6.224197210046664, -5.303672654412329, 6.352371900264488, 7.246257296784583, 12.241514098626649, 10.63223628526121, 5.01750477214695, 7.504467004472774, 1.9549330028270715, 3.9331951154137688, 0.33206839745803385, 0.39766783938862105, -4.733043947170461, -1.202269628676948, 0.007244163366058487, -7.648046061936714, 3.646494769259921, 2.802304539736302, -3.536914066398562, 7.326433477915359, 18.66388586450809, 10.231765337122038, 4.723452575949148, 4.062273440772551, 6.234583499364759, 3.3602684208972056, 8.906787088252695, -4.973005339735516, -11.133657219785112, -11.607756111633218, -1.3303256575845737], "episode_lengths": [406, 642, 268, 410, 1100, 260, 795, 269, 149, 258, 758, 299, 1117, 687, 888, 259, 606, 812, 531, 382, 260, 296, 295, 799, 273, 295, 305, 763, 273, 733, 707, 299, 302, 1117, 764, 128, 1117, 233, 748, 1117, 653, 272, 870, 269, 1103, 262, 374, 449, 587, 763, 683, 457, 829, 982, 890, 951, 269, 1117, 269, 350, 164, 302, 194, 916, 503, 439, 371, 365, 408, 406, 795, 425, 295, 1117, 797, 227, 653, 295, 415, 274, 440, 895, 383, 761]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0865859871438897, "mean_inference_ms": 6.855983828907138, "mean_action_processing_ms": 0.49476687826383287, "mean_env_wait_ms": 21.369486263067472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010730822881062826, "StateBufferConnector_ms": 0.007989576884678431, "ViewRequirementAgentConnector_ms": 0.7291050184340704}}, "episode_reward_max": 20.620984196232417, "episode_reward_min": -33.03632969461331, "episode_reward_mean": -2.103312898592453, "episode_len_mean": 547.1309523809524, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.000073657377666, -32.10373929778766, -9.62164522865629, -27.3404067473337, -12.564895480922065, -9.972443901397737, -31.13716251254926, -3.669702861306945, -2.71386333811635, -6.1635292777142245, -20.26587765245486, -11.68989929714503, -18.531483229333865, -26.13024725553984, -3.968774185919396, 11.91654219649101, -25.339155594494592, 2.7283847738785654, -33.03632969461331, -6.987386798748345, 7.640071740338858, -1.414027321519181, -4.0474577810762895, -14.546419497723354, 13.434860715759086, 3.970381181165502, 1.919815122959231, 10.84334316177672, 5.9740002900264555, -2.3743401344767134, 8.791176800043557, 7.348676515405291, 11.682469663535112, 8.698734558625842, 0.3678725610479243, -1.0251219584411655, -1.6697867943505518, 8.04510477174919, -6.483243005830579, 2.0977750355364195, -4.821540838957108, 10.169808392816961, -1.9847790937806553, 11.665025284375895, 20.620984196232417, 1.6027795918454721, -2.11299194112202, -8.592944005346263, -13.957915758378546, -9.809152568738629, -14.755414094307662, -3.7534447443378967, -4.495715477985993, -6.224197210046664, -5.303672654412329, 6.352371900264488, 7.246257296784583, 12.241514098626649, 10.63223628526121, 5.01750477214695, 7.504467004472774, 1.9549330028270715, 3.9331951154137688, 0.33206839745803385, 0.39766783938862105, -4.733043947170461, -1.202269628676948, 0.007244163366058487, -7.648046061936714, 3.646494769259921, 2.802304539736302, -3.536914066398562, 7.326433477915359, 18.66388586450809, 10.231765337122038, 4.723452575949148, 4.062273440772551, 6.234583499364759, 3.3602684208972056, 8.906787088252695, -4.973005339735516, -11.133657219785112, -11.607756111633218, -1.3303256575845737], "episode_lengths": [406, 642, 268, 410, 1100, 260, 795, 269, 149, 258, 758, 299, 1117, 687, 888, 259, 606, 812, 531, 382, 260, 296, 295, 799, 273, 295, 305, 763, 273, 733, 707, 299, 302, 1117, 764, 128, 1117, 233, 748, 1117, 653, 272, 870, 269, 1103, 262, 374, 449, 587, 763, 683, 457, 829, 982, 890, 951, 269, 1117, 269, 350, 164, 302, 194, 916, 503, 439, 371, 365, 408, 406, 795, 425, 295, 1117, 797, 227, 653, 295, 415, 274, 440, 895, 383, 761]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0865859871438897, "mean_inference_ms": 6.855983828907138, "mean_action_processing_ms": 0.49476687826383287, "mean_env_wait_ms": 21.369486263067472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010730822881062826, "StateBufferConnector_ms": 0.007989576884678431, "ViewRequirementAgentConnector_ms": 0.7291050184340704}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45959, "num_agent_steps_trained": 45959, "num_env_steps_sampled": 45959, "num_env_steps_trained": 45959, "num_env_steps_sampled_this_iter": 7772, "num_env_steps_trained_this_iter": 7772, "num_env_steps_sampled_throughput_per_sec": 215.28368480080033, "num_env_steps_trained_throughput_per_sec": 215.28368480080033, "timesteps_total": 45959, "num_steps_trained_this_iter": 7772, "agent_timesteps_total": 45959, "timers": {"training_iteration_time_ms": 35930.574, "sample_time_ms": 28809.707, "load_time_ms": 990.62, "load_throughput": 7732.366, "learn_time_ms": 5640.282, "learn_throughput": 1358.059, "synch_weights_time_ms": 428.097}, "counters": {"num_env_steps_sampled": 45959, "num_env_steps_trained": 45959, "num_agent_steps_sampled": 45959, "num_agent_steps_trained": 45959}, "done": false, "episodes_total": 84, "training_iteration": 6, "trial_id": "837cb_00000", "date": "2025-06-07_17-29-15", "timestamp": 1749310155, "time_this_iter_s": 36.11721706390381, "time_total_s": 215.71512722969055, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 215.71512722969055, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 56.78372093023254, "ram_util_percent": 60.560465116279055, "gpu_util_percent0": 0.04534883720930233, "vram_util_percent0": 0.8849283854166664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.954041000000003e-05, "total_loss": -0.1504729229761588, "policy_loss": -0.03229523052371317, "vf_loss": 0.06859585084621944, "vf_explained_var": 0.8405508268264033, "kl": 0.007349774072879941, "entropy": 14.296032834822132, "entropy_coeff": 0.009770205000000002}, "model": {}, "num_grad_updates_lifetime": 1765.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 54738, "num_env_steps_trained": 54738, "num_agent_steps_sampled": 54738, "num_agent_steps_trained": 54738}, "sampler_results": {"episode_reward_max": 20.620984196232417, "episode_reward_min": -33.03632969461331, "episode_reward_mean": -1.6397703832117296, "episode_len_mean": 558.5510204081633, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.000073657377666, -32.10373929778766, -9.62164522865629, -27.3404067473337, -12.564895480922065, -9.972443901397737, -31.13716251254926, -3.669702861306945, -2.71386333811635, -6.1635292777142245, -20.26587765245486, -11.68989929714503, -18.531483229333865, -26.13024725553984, -3.968774185919396, 11.91654219649101, -25.339155594494592, 2.7283847738785654, -33.03632969461331, -6.987386798748345, 7.640071740338858, -1.414027321519181, -4.0474577810762895, -14.546419497723354, 13.434860715759086, 3.970381181165502, 1.919815122959231, 10.84334316177672, 5.9740002900264555, -2.3743401344767134, 8.791176800043557, 7.348676515405291, 11.682469663535112, 8.698734558625842, 0.3678725610479243, -1.0251219584411655, -1.6697867943505518, 8.04510477174919, -6.483243005830579, 2.0977750355364195, -4.821540838957108, 10.169808392816961, -1.9847790937806553, 11.665025284375895, 20.620984196232417, 1.6027795918454721, -2.11299194112202, -8.592944005346263, -13.957915758378546, -9.809152568738629, -14.755414094307662, -3.7534447443378967, -4.495715477985993, -6.224197210046664, -5.303672654412329, 6.352371900264488, 7.246257296784583, 12.241514098626649, 10.63223628526121, 5.01750477214695, 7.504467004472774, 1.9549330028270715, 3.9331951154137688, 0.33206839745803385, 0.39766783938862105, -4.733043947170461, -1.202269628676948, 0.007244163366058487, -7.648046061936714, 3.646494769259921, 2.802304539736302, -3.536914066398562, 7.326433477915359, 18.66388586450809, 10.231765337122038, 4.723452575949148, 4.062273440772551, 6.234583499364759, 3.3602684208972056, 8.906787088252695, -4.973005339735516, -11.133657219785112, -11.607756111633218, -1.3303256575845737, 5.994911559783554, 10.90851269131062, 9.551727877738077, 9.39335161646714, -0.2589423316161288, -2.0548523286891394, 11.24159857895895, 17.731006589073015, -8.71373860728265, -6.5488831301374075, -3.5376960060288645, -12.817196283562065, -9.537204068749926, -5.371810230248621], "episode_lengths": [406, 642, 268, 410, 1100, 260, 795, 269, 149, 258, 758, 299, 1117, 687, 888, 259, 606, 812, 531, 382, 260, 296, 295, 799, 273, 295, 305, 763, 273, 733, 707, 299, 302, 1117, 764, 128, 1117, 233, 748, 1117, 653, 272, 870, 269, 1103, 262, 374, 449, 587, 763, 683, 457, 829, 982, 890, 951, 269, 1117, 269, 350, 164, 302, 194, 916, 503, 439, 371, 365, 408, 406, 795, 425, 295, 1117, 797, 227, 653, 295, 415, 274, 440, 895, 383, 761, 297, 259, 1117, 269, 425, 608, 896, 1117, 447, 440, 517, 893, 696, 798]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0709353833219333, "mean_inference_ms": 6.8514967556958295, "mean_action_processing_ms": 0.49354636100777194, "mean_env_wait_ms": 21.29600070867783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009197848183768136, "StateBufferConnector_ms": 0.009931106956637636, "ViewRequirementAgentConnector_ms": 0.7443082575895348}}, "episode_reward_max": 20.620984196232417, "episode_reward_min": -33.03632969461331, "episode_reward_mean": -1.6397703832117296, "episode_len_mean": 558.5510204081633, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.000073657377666, -32.10373929778766, -9.62164522865629, -27.3404067473337, -12.564895480922065, -9.972443901397737, -31.13716251254926, -3.669702861306945, -2.71386333811635, -6.1635292777142245, -20.26587765245486, -11.68989929714503, -18.531483229333865, -26.13024725553984, -3.968774185919396, 11.91654219649101, -25.339155594494592, 2.7283847738785654, -33.03632969461331, -6.987386798748345, 7.640071740338858, -1.414027321519181, -4.0474577810762895, -14.546419497723354, 13.434860715759086, 3.970381181165502, 1.919815122959231, 10.84334316177672, 5.9740002900264555, -2.3743401344767134, 8.791176800043557, 7.348676515405291, 11.682469663535112, 8.698734558625842, 0.3678725610479243, -1.0251219584411655, -1.6697867943505518, 8.04510477174919, -6.483243005830579, 2.0977750355364195, -4.821540838957108, 10.169808392816961, -1.9847790937806553, 11.665025284375895, 20.620984196232417, 1.6027795918454721, -2.11299194112202, -8.592944005346263, -13.957915758378546, -9.809152568738629, -14.755414094307662, -3.7534447443378967, -4.495715477985993, -6.224197210046664, -5.303672654412329, 6.352371900264488, 7.246257296784583, 12.241514098626649, 10.63223628526121, 5.01750477214695, 7.504467004472774, 1.9549330028270715, 3.9331951154137688, 0.33206839745803385, 0.39766783938862105, -4.733043947170461, -1.202269628676948, 0.007244163366058487, -7.648046061936714, 3.646494769259921, 2.802304539736302, -3.536914066398562, 7.326433477915359, 18.66388586450809, 10.231765337122038, 4.723452575949148, 4.062273440772551, 6.234583499364759, 3.3602684208972056, 8.906787088252695, -4.973005339735516, -11.133657219785112, -11.607756111633218, -1.3303256575845737, 5.994911559783554, 10.90851269131062, 9.551727877738077, 9.39335161646714, -0.2589423316161288, -2.0548523286891394, 11.24159857895895, 17.731006589073015, -8.71373860728265, -6.5488831301374075, -3.5376960060288645, -12.817196283562065, -9.537204068749926, -5.371810230248621], "episode_lengths": [406, 642, 268, 410, 1100, 260, 795, 269, 149, 258, 758, 299, 1117, 687, 888, 259, 606, 812, 531, 382, 260, 296, 295, 799, 273, 295, 305, 763, 273, 733, 707, 299, 302, 1117, 764, 128, 1117, 233, 748, 1117, 653, 272, 870, 269, 1103, 262, 374, 449, 587, 763, 683, 457, 829, 982, 890, 951, 269, 1117, 269, 350, 164, 302, 194, 916, 503, 439, 371, 365, 408, 406, 795, 425, 295, 1117, 797, 227, 653, 295, 415, 274, 440, 895, 383, 761, 297, 259, 1117, 269, 425, 608, 896, 1117, 447, 440, 517, 893, 696, 798]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0709353833219333, "mean_inference_ms": 6.8514967556958295, "mean_action_processing_ms": 0.49354636100777194, "mean_env_wait_ms": 21.29600070867783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009197848183768136, "StateBufferConnector_ms": 0.009931106956637636, "ViewRequirementAgentConnector_ms": 0.7443082575895348}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54738, "num_agent_steps_trained": 54738, "num_env_steps_sampled": 54738, "num_env_steps_trained": 54738, "num_env_steps_sampled_this_iter": 8779, "num_env_steps_trained_this_iter": 8779, "num_env_steps_sampled_throughput_per_sec": 224.95133261192356, "num_env_steps_trained_throughput_per_sec": 224.95133261192356, "timesteps_total": 54738, "num_steps_trained_this_iter": 8779, "agent_timesteps_total": 54738, "timers": {"training_iteration_time_ms": 36372.809, "sample_time_ms": 29124.977, "load_time_ms": 987.77, "load_throughput": 7916.535, "learn_time_ms": 5766.304, "learn_throughput": 1356.105, "synch_weights_time_ms": 432.656}, "counters": {"num_env_steps_sampled": 54738, "num_env_steps_trained": 54738, "num_agent_steps_sampled": 54738, "num_agent_steps_trained": 54738}, "done": false, "episodes_total": 98, "training_iteration": 7, "trial_id": "837cb_00000", "date": "2025-06-07_17-29-54", "timestamp": 1749310194, "time_this_iter_s": 39.042206048965454, "time_total_s": 254.757333278656, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 254.757333278656, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 58.482978723404244, "ram_util_percent": 61.56170212765956, "gpu_util_percent0": 0.05276595744680851, "vram_util_percent0": 0.8849283854166663}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.945261999999998e-05, "total_loss": -0.12642929365936045, "policy_loss": -0.008385737207718194, "vf_loss": 0.06871334109532957, "vf_explained_var": 0.8604366948207219, "kl": 0.008891693690190246, "entropy": 14.31306341489156, "entropy_coeff": 0.00972631}, "model": {}, "num_grad_updates_lifetime": 2070.5, "diff_num_grad_updates_vs_sampler_policy": 149.5}}, "num_env_steps_sampled": 63389, "num_env_steps_trained": 63389, "num_agent_steps_sampled": 63389, "num_agent_steps_trained": 63389}, "sampler_results": {"episode_reward_max": 28.303739653293274, "episode_reward_min": -33.03632969461331, "episode_reward_mean": 0.8300231065634958, "episode_len_mean": 566.58, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.13024725553984, -3.968774185919396, 11.91654219649101, -25.339155594494592, 2.7283847738785654, -33.03632969461331, -6.987386798748345, 7.640071740338858, -1.414027321519181, -4.0474577810762895, -14.546419497723354, 13.434860715759086, 3.970381181165502, 1.919815122959231, 10.84334316177672, 5.9740002900264555, -2.3743401344767134, 8.791176800043557, 7.348676515405291, 11.682469663535112, 8.698734558625842, 0.3678725610479243, -1.0251219584411655, -1.6697867943505518, 8.04510477174919, -6.483243005830579, 2.0977750355364195, -4.821540838957108, 10.169808392816961, -1.9847790937806553, 11.665025284375895, 20.620984196232417, 1.6027795918454721, -2.11299194112202, -8.592944005346263, -13.957915758378546, -9.809152568738629, -14.755414094307662, -3.7534447443378967, -4.495715477985993, -6.224197210046664, -5.303672654412329, 6.352371900264488, 7.246257296784583, 12.241514098626649, 10.63223628526121, 5.01750477214695, 7.504467004472774, 1.9549330028270715, 3.9331951154137688, 0.33206839745803385, 0.39766783938862105, -4.733043947170461, -1.202269628676948, 0.007244163366058487, -7.648046061936714, 3.646494769259921, 2.802304539736302, -3.536914066398562, 7.326433477915359, 18.66388586450809, 10.231765337122038, 4.723452575949148, 4.062273440772551, 6.234583499364759, 3.3602684208972056, 8.906787088252695, -4.973005339735516, -11.133657219785112, -11.607756111633218, -1.3303256575845737, 5.994911559783554, 10.90851269131062, 9.551727877738077, 9.39335161646714, -0.2589423316161288, -2.0548523286891394, 11.24159857895895, 17.731006589073015, -8.71373860728265, -6.5488831301374075, -3.5376960060288645, -12.817196283562065, -9.537204068749926, -5.371810230248621, -14.361582069263692, 0.8337145426845323, 1.6916505057240205, -5.576349217370622, 6.672168817759855, 2.8224049076664253, -2.8560538079361852, 21.421929857749046, 2.9909272928916284, 0.07043260036326182, 6.4860977032792455, -7.960279792845509, -5.600958397233553, 5.987243132241714, 28.303739653293274], "episode_lengths": [687, 888, 259, 606, 812, 531, 382, 260, 296, 295, 799, 273, 295, 305, 763, 273, 733, 707, 299, 302, 1117, 764, 128, 1117, 233, 748, 1117, 653, 272, 870, 269, 1103, 262, 374, 449, 587, 763, 683, 457, 829, 982, 890, 951, 269, 1117, 269, 350, 164, 302, 194, 916, 503, 439, 371, 365, 408, 406, 795, 425, 295, 1117, 797, 227, 653, 295, 415, 274, 440, 895, 383, 761, 297, 259, 1117, 269, 425, 608, 896, 1117, 447, 440, 517, 893, 696, 798, 764, 406, 1117, 564, 288, 91, 391, 1117, 408, 339, 317, 618, 764, 350, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0182573937363233, "mean_inference_ms": 6.829019816119113, "mean_action_processing_ms": 0.49009760998070734, "mean_env_wait_ms": 20.992585273395626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011063814163208008, "StateBufferConnector_ms": 0.010760784149169922, "ViewRequirementAgentConnector_ms": 0.7191696166992188}}, "episode_reward_max": 28.303739653293274, "episode_reward_min": -33.03632969461331, "episode_reward_mean": 0.8300231065634958, "episode_len_mean": 566.58, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-26.13024725553984, -3.968774185919396, 11.91654219649101, -25.339155594494592, 2.7283847738785654, -33.03632969461331, -6.987386798748345, 7.640071740338858, -1.414027321519181, -4.0474577810762895, -14.546419497723354, 13.434860715759086, 3.970381181165502, 1.919815122959231, 10.84334316177672, 5.9740002900264555, -2.3743401344767134, 8.791176800043557, 7.348676515405291, 11.682469663535112, 8.698734558625842, 0.3678725610479243, -1.0251219584411655, -1.6697867943505518, 8.04510477174919, -6.483243005830579, 2.0977750355364195, -4.821540838957108, 10.169808392816961, -1.9847790937806553, 11.665025284375895, 20.620984196232417, 1.6027795918454721, -2.11299194112202, -8.592944005346263, -13.957915758378546, -9.809152568738629, -14.755414094307662, -3.7534447443378967, -4.495715477985993, -6.224197210046664, -5.303672654412329, 6.352371900264488, 7.246257296784583, 12.241514098626649, 10.63223628526121, 5.01750477214695, 7.504467004472774, 1.9549330028270715, 3.9331951154137688, 0.33206839745803385, 0.39766783938862105, -4.733043947170461, -1.202269628676948, 0.007244163366058487, -7.648046061936714, 3.646494769259921, 2.802304539736302, -3.536914066398562, 7.326433477915359, 18.66388586450809, 10.231765337122038, 4.723452575949148, 4.062273440772551, 6.234583499364759, 3.3602684208972056, 8.906787088252695, -4.973005339735516, -11.133657219785112, -11.607756111633218, -1.3303256575845737, 5.994911559783554, 10.90851269131062, 9.551727877738077, 9.39335161646714, -0.2589423316161288, -2.0548523286891394, 11.24159857895895, 17.731006589073015, -8.71373860728265, -6.5488831301374075, -3.5376960060288645, -12.817196283562065, -9.537204068749926, -5.371810230248621, -14.361582069263692, 0.8337145426845323, 1.6916505057240205, -5.576349217370622, 6.672168817759855, 2.8224049076664253, -2.8560538079361852, 21.421929857749046, 2.9909272928916284, 0.07043260036326182, 6.4860977032792455, -7.960279792845509, -5.600958397233553, 5.987243132241714, 28.303739653293274], "episode_lengths": [687, 888, 259, 606, 812, 531, 382, 260, 296, 295, 799, 273, 295, 305, 763, 273, 733, 707, 299, 302, 1117, 764, 128, 1117, 233, 748, 1117, 653, 272, 870, 269, 1103, 262, 374, 449, 587, 763, 683, 457, 829, 982, 890, 951, 269, 1117, 269, 350, 164, 302, 194, 916, 503, 439, 371, 365, 408, 406, 795, 425, 295, 1117, 797, 227, 653, 295, 415, 274, 440, 895, 383, 761, 297, 259, 1117, 269, 425, 608, 896, 1117, 447, 440, 517, 893, 696, 798, 764, 406, 1117, 564, 288, 91, 391, 1117, 408, 339, 317, 618, 764, 350, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0182573937363233, "mean_inference_ms": 6.829019816119113, "mean_action_processing_ms": 0.49009760998070734, "mean_env_wait_ms": 20.992585273395626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011063814163208008, "StateBufferConnector_ms": 0.010760784149169922, "ViewRequirementAgentConnector_ms": 0.7191696166992188}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63389, "num_agent_steps_trained": 63389, "num_env_steps_sampled": 63389, "num_env_steps_trained": 63389, "num_env_steps_sampled_this_iter": 8651, "num_env_steps_trained_this_iter": 8651, "num_env_steps_sampled_throughput_per_sec": 210.8853663568014, "num_env_steps_trained_throughput_per_sec": 210.8853663568014, "timesteps_total": 63389, "num_steps_trained_this_iter": 8651, "agent_timesteps_total": 63389, "timers": {"training_iteration_time_ms": 36953.994, "sample_time_ms": 29388.02, "load_time_ms": 1019.17, "load_throughput": 7774.585, "learn_time_ms": 6048.378, "learn_throughput": 1310.041, "synch_weights_time_ms": 432.396}, "counters": {"num_env_steps_sampled": 63389, "num_env_steps_trained": 63389, "num_agent_steps_sampled": 63389, "num_agent_steps_trained": 63389}, "done": false, "episodes_total": 113, "training_iteration": 8, "trial_id": "837cb_00000", "date": "2025-06-07_17-30-35", "timestamp": 1749310235, "time_this_iter_s": 41.04083037376404, "time_total_s": 295.79816365242004, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 295.79816365242004, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 56.372, "ram_util_percent": 62.324000000000005, "gpu_util_percent0": 0.086, "vram_util_percent0": 0.9030533854166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.936611000000002e-05, "total_loss": -0.15129483598105323, "policy_loss": -0.03470307826601828, "vf_loss": 0.07255564103117929, "vf_explained_var": 0.8798395372354068, "kl": 0.008071970168049357, "entropy": 14.340820756325355, "entropy_coeff": 0.009683054999999998}, "model": {}, "num_grad_updates_lifetime": 2350.5, "diff_num_grad_updates_vs_sampler_policy": 129.5}}, "num_env_steps_sampled": 70916, "num_env_steps_trained": 70916, "num_agent_steps_sampled": 70916, "num_agent_steps_trained": 70916}, "sampler_results": {"episode_reward_max": 28.303739653293274, "episode_reward_min": -24.60142322145039, "episode_reward_mean": 1.5477701335627356, "episode_len_mean": 574.97, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.84334316177672, 5.9740002900264555, -2.3743401344767134, 8.791176800043557, 7.348676515405291, 11.682469663535112, 8.698734558625842, 0.3678725610479243, -1.0251219584411655, -1.6697867943505518, 8.04510477174919, -6.483243005830579, 2.0977750355364195, -4.821540838957108, 10.169808392816961, -1.9847790937806553, 11.665025284375895, 20.620984196232417, 1.6027795918454721, -2.11299194112202, -8.592944005346263, -13.957915758378546, -9.809152568738629, -14.755414094307662, -3.7534447443378967, -4.495715477985993, -6.224197210046664, -5.303672654412329, 6.352371900264488, 7.246257296784583, 12.241514098626649, 10.63223628526121, 5.01750477214695, 7.504467004472774, 1.9549330028270715, 3.9331951154137688, 0.33206839745803385, 0.39766783938862105, -4.733043947170461, -1.202269628676948, 0.007244163366058487, -7.648046061936714, 3.646494769259921, 2.802304539736302, -3.536914066398562, 7.326433477915359, 18.66388586450809, 10.231765337122038, 4.723452575949148, 4.062273440772551, 6.234583499364759, 3.3602684208972056, 8.906787088252695, -4.973005339735516, -11.133657219785112, -11.607756111633218, -1.3303256575845737, 5.994911559783554, 10.90851269131062, 9.551727877738077, 9.39335161646714, -0.2589423316161288, -2.0548523286891394, 11.24159857895895, 17.731006589073015, -8.71373860728265, -6.5488831301374075, -3.5376960060288645, -12.817196283562065, -9.537204068749926, -5.371810230248621, -14.361582069263692, 0.8337145426845323, 1.6916505057240205, -5.576349217370622, 6.672168817759855, 2.8224049076664253, -2.8560538079361852, 21.421929857749046, 2.9909272928916284, 0.07043260036326182, 6.4860977032792455, -7.960279792845509, -5.600958397233553, 5.987243132241714, 28.303739653293274, 1.3566900727999816, -0.6457085627265837, 4.0063553255949325, -10.928093499865136, -18.471784756224405, 6.860103146748484, 20.71602103822418, -6.576442781315374, 7.7244559374755575, 7.845088142272932, 4.325604546608531, 4.887746926758524, -24.60142322145039, 1.4163479859807104], "episode_lengths": [763, 273, 733, 707, 299, 302, 1117, 764, 128, 1117, 233, 748, 1117, 653, 272, 870, 269, 1103, 262, 374, 449, 587, 763, 683, 457, 829, 982, 890, 951, 269, 1117, 269, 350, 164, 302, 194, 916, 503, 439, 371, 365, 408, 406, 795, 425, 295, 1117, 797, 227, 653, 295, 415, 274, 440, 895, 383, 761, 297, 259, 1117, 269, 425, 608, 896, 1117, 447, 440, 517, 893, 696, 798, 764, 406, 1117, 564, 288, 91, 391, 1117, 408, 339, 317, 618, 764, 350, 1117, 261, 375, 1117, 520, 763, 269, 1117, 714, 269, 653, 237, 269, 690, 273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9936158027998148, "mean_inference_ms": 6.819196239405063, "mean_action_processing_ms": 0.4877951576215949, "mean_env_wait_ms": 20.869617690723217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012059211730957031, "StateBufferConnector_ms": 0.008744001388549805, "ViewRequirementAgentConnector_ms": 0.7307214736938477}}, "episode_reward_max": 28.303739653293274, "episode_reward_min": -24.60142322145039, "episode_reward_mean": 1.5477701335627356, "episode_len_mean": 574.97, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.84334316177672, 5.9740002900264555, -2.3743401344767134, 8.791176800043557, 7.348676515405291, 11.682469663535112, 8.698734558625842, 0.3678725610479243, -1.0251219584411655, -1.6697867943505518, 8.04510477174919, -6.483243005830579, 2.0977750355364195, -4.821540838957108, 10.169808392816961, -1.9847790937806553, 11.665025284375895, 20.620984196232417, 1.6027795918454721, -2.11299194112202, -8.592944005346263, -13.957915758378546, -9.809152568738629, -14.755414094307662, -3.7534447443378967, -4.495715477985993, -6.224197210046664, -5.303672654412329, 6.352371900264488, 7.246257296784583, 12.241514098626649, 10.63223628526121, 5.01750477214695, 7.504467004472774, 1.9549330028270715, 3.9331951154137688, 0.33206839745803385, 0.39766783938862105, -4.733043947170461, -1.202269628676948, 0.007244163366058487, -7.648046061936714, 3.646494769259921, 2.802304539736302, -3.536914066398562, 7.326433477915359, 18.66388586450809, 10.231765337122038, 4.723452575949148, 4.062273440772551, 6.234583499364759, 3.3602684208972056, 8.906787088252695, -4.973005339735516, -11.133657219785112, -11.607756111633218, -1.3303256575845737, 5.994911559783554, 10.90851269131062, 9.551727877738077, 9.39335161646714, -0.2589423316161288, -2.0548523286891394, 11.24159857895895, 17.731006589073015, -8.71373860728265, -6.5488831301374075, -3.5376960060288645, -12.817196283562065, -9.537204068749926, -5.371810230248621, -14.361582069263692, 0.8337145426845323, 1.6916505057240205, -5.576349217370622, 6.672168817759855, 2.8224049076664253, -2.8560538079361852, 21.421929857749046, 2.9909272928916284, 0.07043260036326182, 6.4860977032792455, -7.960279792845509, -5.600958397233553, 5.987243132241714, 28.303739653293274, 1.3566900727999816, -0.6457085627265837, 4.0063553255949325, -10.928093499865136, -18.471784756224405, 6.860103146748484, 20.71602103822418, -6.576442781315374, 7.7244559374755575, 7.845088142272932, 4.325604546608531, 4.887746926758524, -24.60142322145039, 1.4163479859807104], "episode_lengths": [763, 273, 733, 707, 299, 302, 1117, 764, 128, 1117, 233, 748, 1117, 653, 272, 870, 269, 1103, 262, 374, 449, 587, 763, 683, 457, 829, 982, 890, 951, 269, 1117, 269, 350, 164, 302, 194, 916, 503, 439, 371, 365, 408, 406, 795, 425, 295, 1117, 797, 227, 653, 295, 415, 274, 440, 895, 383, 761, 297, 259, 1117, 269, 425, 608, 896, 1117, 447, 440, 517, 893, 696, 798, 764, 406, 1117, 564, 288, 91, 391, 1117, 408, 339, 317, 618, 764, 350, 1117, 261, 375, 1117, 520, 763, 269, 1117, 714, 269, 653, 237, 269, 690, 273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9936158027998148, "mean_inference_ms": 6.819196239405063, "mean_action_processing_ms": 0.4877951576215949, "mean_env_wait_ms": 20.869617690723217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012059211730957031, "StateBufferConnector_ms": 0.008744001388549805, "ViewRequirementAgentConnector_ms": 0.7307214736938477}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70916, "num_agent_steps_trained": 70916, "num_env_steps_sampled": 70916, "num_env_steps_trained": 70916, "num_env_steps_sampled_this_iter": 7527, "num_env_steps_trained_this_iter": 7527, "num_env_steps_sampled_throughput_per_sec": 205.66171471000374, "num_env_steps_trained_throughput_per_sec": 205.66171471000374, "timesteps_total": 70916, "num_steps_trained_this_iter": 7527, "agent_timesteps_total": 70916, "timers": {"training_iteration_time_ms": 36914.543, "sample_time_ms": 29401.123, "load_time_ms": 1006.86, "load_throughput": 7825.867, "learn_time_ms": 6005.673, "learn_throughput": 1312.019, "synch_weights_time_ms": 435.135}, "counters": {"num_env_steps_sampled": 70916, "num_env_steps_trained": 70916, "num_agent_steps_sampled": 70916, "num_agent_steps_trained": 70916}, "done": false, "episodes_total": 127, "training_iteration": 9, "trial_id": "837cb_00000", "date": "2025-06-07_17-31-12", "timestamp": 1749310272, "time_this_iter_s": 36.61494016647339, "time_total_s": 332.41310381889343, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 332.41310381889343, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 55.71136363636363, "ram_util_percent": 63.63409090909091, "gpu_util_percent0": 0.04818181818181819, "vram_util_percent0": 0.96044921875}}
{"evaluation": {"sampler_results": {"episode_reward_max": -0.3798791848836334, "episode_reward_min": -2.3047887863824865, "episode_reward_mean": -0.9319040888514414, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3047887863824865, -0.9117691327697038, -0.6453087943035689, -0.4177745459178134, -0.3798791848836334], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6667511512350441, "mean_inference_ms": 3.6048319647806606, "mean_action_processing_ms": 0.2950296598718169, "mean_env_wait_ms": 12.857789713707344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0400543212890625, "ViewRequirementAgentConnector_ms": 0.28597354888916016}}, "episode_reward_max": -0.3798791848836334, "episode_reward_min": -2.3047887863824865, "episode_reward_mean": -0.9319040888514414, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.3047887863824865, -0.9117691327697038, -0.6453087943035689, -0.4177745459178134, -0.3798791848836334], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6667511512350441, "mean_inference_ms": 3.6048319647806606, "mean_action_processing_ms": 0.2950296598718169, "mean_env_wait_ms": 12.857789713707344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0400543212890625, "ViewRequirementAgentConnector_ms": 0.28597354888916016}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.929084000000002e-05, "total_loss": -0.14242706975822025, "policy_loss": -0.021068252664990725, "vf_loss": 0.05920278354547918, "vf_explained_var": 0.8754091930389404, "kl": 0.008691574797655146, "entropy": 14.479709288279215, "entropy_coeff": 0.00964542}, "model": {}, "num_grad_updates_lifetime": 2630.5, "diff_num_grad_updates_vs_sampler_policy": 149.5}}, "num_env_steps_sampled": 79509, "num_env_steps_trained": 79509, "num_agent_steps_sampled": 79509, "num_agent_steps_trained": 79509}, "sampler_results": {"episode_reward_max": 28.303739653293274, "episode_reward_min": -24.60142322145039, "episode_reward_mean": 1.7817031086571107, "episode_len_mean": 571.36, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.169808392816961, -1.9847790937806553, 11.665025284375895, 20.620984196232417, 1.6027795918454721, -2.11299194112202, -8.592944005346263, -13.957915758378546, -9.809152568738629, -14.755414094307662, -3.7534447443378967, -4.495715477985993, -6.224197210046664, -5.303672654412329, 6.352371900264488, 7.246257296784583, 12.241514098626649, 10.63223628526121, 5.01750477214695, 7.504467004472774, 1.9549330028270715, 3.9331951154137688, 0.33206839745803385, 0.39766783938862105, -4.733043947170461, -1.202269628676948, 0.007244163366058487, -7.648046061936714, 3.646494769259921, 2.802304539736302, -3.536914066398562, 7.326433477915359, 18.66388586450809, 10.231765337122038, 4.723452575949148, 4.062273440772551, 6.234583499364759, 3.3602684208972056, 8.906787088252695, -4.973005339735516, -11.133657219785112, -11.607756111633218, -1.3303256575845737, 5.994911559783554, 10.90851269131062, 9.551727877738077, 9.39335161646714, -0.2589423316161288, -2.0548523286891394, 11.24159857895895, 17.731006589073015, -8.71373860728265, -6.5488831301374075, -3.5376960060288645, -12.817196283562065, -9.537204068749926, -5.371810230248621, -14.361582069263692, 0.8337145426845323, 1.6916505057240205, -5.576349217370622, 6.672168817759855, 2.8224049076664253, -2.8560538079361852, 21.421929857749046, 2.9909272928916284, 0.07043260036326182, 6.4860977032792455, -7.960279792845509, -5.600958397233553, 5.987243132241714, 28.303739653293274, 1.3566900727999816, -0.6457085627265837, 4.0063553255949325, -10.928093499865136, -18.471784756224405, 6.860103146748484, 20.71602103822418, -6.576442781315374, 7.7244559374755575, 7.845088142272932, 4.325604546608531, 4.887746926758524, -24.60142322145039, 1.4163479859807104, 9.626699711151641, 16.606784698685512, -2.7080238385351643, 10.07746141228232, 24.547276154786232, -2.1751707797967885, 5.0099093792122975, -6.58223486153268, 10.928652762793488, 2.7667971050411166, -1.4619738706273473, -2.5862282420719565, 13.511729982064587, -6.6932614783253905], "episode_lengths": [272, 870, 269, 1103, 262, 374, 449, 587, 763, 683, 457, 829, 982, 890, 951, 269, 1117, 269, 350, 164, 302, 194, 916, 503, 439, 371, 365, 408, 406, 795, 425, 295, 1117, 797, 227, 653, 295, 415, 274, 440, 895, 383, 761, 297, 259, 1117, 269, 425, 608, 896, 1117, 447, 440, 517, 893, 696, 798, 764, 406, 1117, 564, 288, 91, 391, 1117, 408, 339, 317, 618, 764, 350, 1117, 261, 375, 1117, 520, 763, 269, 1117, 714, 269, 653, 237, 269, 690, 273, 373, 1117, 415, 295, 1117, 1037, 150, 487, 794, 309, 605, 804, 295, 795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9833325860891768, "mean_inference_ms": 6.832679793384417, "mean_action_processing_ms": 0.48772592465805586, "mean_env_wait_ms": 20.858408717096136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01357412338256836, "StateBufferConnector_ms": 0.012766122817993164, "ViewRequirementAgentConnector_ms": 0.7415175437927246}}, "episode_reward_max": 28.303739653293274, "episode_reward_min": -24.60142322145039, "episode_reward_mean": 1.7817031086571107, "episode_len_mean": 571.36, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.169808392816961, -1.9847790937806553, 11.665025284375895, 20.620984196232417, 1.6027795918454721, -2.11299194112202, -8.592944005346263, -13.957915758378546, -9.809152568738629, -14.755414094307662, -3.7534447443378967, -4.495715477985993, -6.224197210046664, -5.303672654412329, 6.352371900264488, 7.246257296784583, 12.241514098626649, 10.63223628526121, 5.01750477214695, 7.504467004472774, 1.9549330028270715, 3.9331951154137688, 0.33206839745803385, 0.39766783938862105, -4.733043947170461, -1.202269628676948, 0.007244163366058487, -7.648046061936714, 3.646494769259921, 2.802304539736302, -3.536914066398562, 7.326433477915359, 18.66388586450809, 10.231765337122038, 4.723452575949148, 4.062273440772551, 6.234583499364759, 3.3602684208972056, 8.906787088252695, -4.973005339735516, -11.133657219785112, -11.607756111633218, -1.3303256575845737, 5.994911559783554, 10.90851269131062, 9.551727877738077, 9.39335161646714, -0.2589423316161288, -2.0548523286891394, 11.24159857895895, 17.731006589073015, -8.71373860728265, -6.5488831301374075, -3.5376960060288645, -12.817196283562065, -9.537204068749926, -5.371810230248621, -14.361582069263692, 0.8337145426845323, 1.6916505057240205, -5.576349217370622, 6.672168817759855, 2.8224049076664253, -2.8560538079361852, 21.421929857749046, 2.9909272928916284, 0.07043260036326182, 6.4860977032792455, -7.960279792845509, -5.600958397233553, 5.987243132241714, 28.303739653293274, 1.3566900727999816, -0.6457085627265837, 4.0063553255949325, -10.928093499865136, -18.471784756224405, 6.860103146748484, 20.71602103822418, -6.576442781315374, 7.7244559374755575, 7.845088142272932, 4.325604546608531, 4.887746926758524, -24.60142322145039, 1.4163479859807104, 9.626699711151641, 16.606784698685512, -2.7080238385351643, 10.07746141228232, 24.547276154786232, -2.1751707797967885, 5.0099093792122975, -6.58223486153268, 10.928652762793488, 2.7667971050411166, -1.4619738706273473, -2.5862282420719565, 13.511729982064587, -6.6932614783253905], "episode_lengths": [272, 870, 269, 1103, 262, 374, 449, 587, 763, 683, 457, 829, 982, 890, 951, 269, 1117, 269, 350, 164, 302, 194, 916, 503, 439, 371, 365, 408, 406, 795, 425, 295, 1117, 797, 227, 653, 295, 415, 274, 440, 895, 383, 761, 297, 259, 1117, 269, 425, 608, 896, 1117, 447, 440, 517, 893, 696, 798, 764, 406, 1117, 564, 288, 91, 391, 1117, 408, 339, 317, 618, 764, 350, 1117, 261, 375, 1117, 520, 763, 269, 1117, 714, 269, 653, 237, 269, 690, 273, 373, 1117, 415, 295, 1117, 1037, 150, 487, 794, 309, 605, 804, 295, 795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9833325860891768, "mean_inference_ms": 6.832679793384417, "mean_action_processing_ms": 0.48772592465805586, "mean_env_wait_ms": 20.858408717096136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01357412338256836, "StateBufferConnector_ms": 0.012766122817993164, "ViewRequirementAgentConnector_ms": 0.7415175437927246}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79509, "num_agent_steps_trained": 79509, "num_env_steps_sampled": 79509, "num_env_steps_trained": 79509, "num_env_steps_sampled_this_iter": 8593, "num_env_steps_trained_this_iter": 8593, "num_env_steps_sampled_throughput_per_sec": 211.79236103660833, "num_env_steps_trained_throughput_per_sec": 211.79236103660833, "timesteps_total": 79509, "num_steps_trained_this_iter": 8593, "agent_timesteps_total": 79509, "timers": {"training_iteration_time_ms": 37280.365, "sample_time_ms": 29454.43, "load_time_ms": 1028.302, "load_throughput": 7732.07, "learn_time_ms": 6300.027, "learn_throughput": 1262.042, "synch_weights_time_ms": 432.154}, "counters": {"num_env_steps_sampled": 79509, "num_env_steps_trained": 79509, "num_agent_steps_sampled": 79509, "num_agent_steps_trained": 79509}, "done": false, "episodes_total": 141, "training_iteration": 10, "trial_id": "837cb_00000", "date": "2025-06-07_17-32-10", "timestamp": 1749310330, "time_this_iter_s": 57.73555374145508, "time_total_s": 390.1486575603485, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 390.1486575603485, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 44.68309859154929, "ram_util_percent": 63.31267605633804, "gpu_util_percent0": 0.06873239436619719, "vram_util_percent0": 0.96044921875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.920490999999999e-05, "total_loss": -0.14103911746827114, "policy_loss": -0.02217523153408476, "vf_loss": 0.06686193841259654, "vf_explained_var": 0.8483915121090121, "kl": 0.008319999051078723, "entropy": 14.52154355630642, "entropy_coeff": 0.009602454999999998}, "model": {}, "num_grad_updates_lifetime": 2985.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 91119, "num_env_steps_trained": 91119, "num_agent_steps_sampled": 91119, "num_agent_steps_trained": 91119}, "sampler_results": {"episode_reward_max": 28.303739653293274, "episode_reward_min": -24.729344023488334, "episode_reward_mean": 2.1832543122748835, "episode_len_mean": 599.56, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.352371900264488, 7.246257296784583, 12.241514098626649, 10.63223628526121, 5.01750477214695, 7.504467004472774, 1.9549330028270715, 3.9331951154137688, 0.33206839745803385, 0.39766783938862105, -4.733043947170461, -1.202269628676948, 0.007244163366058487, -7.648046061936714, 3.646494769259921, 2.802304539736302, -3.536914066398562, 7.326433477915359, 18.66388586450809, 10.231765337122038, 4.723452575949148, 4.062273440772551, 6.234583499364759, 3.3602684208972056, 8.906787088252695, -4.973005339735516, -11.133657219785112, -11.607756111633218, -1.3303256575845737, 5.994911559783554, 10.90851269131062, 9.551727877738077, 9.39335161646714, -0.2589423316161288, -2.0548523286891394, 11.24159857895895, 17.731006589073015, -8.71373860728265, -6.5488831301374075, -3.5376960060288645, -12.817196283562065, -9.537204068749926, -5.371810230248621, -14.361582069263692, 0.8337145426845323, 1.6916505057240205, -5.576349217370622, 6.672168817759855, 2.8224049076664253, -2.8560538079361852, 21.421929857749046, 2.9909272928916284, 0.07043260036326182, 6.4860977032792455, -7.960279792845509, -5.600958397233553, 5.987243132241714, 28.303739653293274, 1.3566900727999816, -0.6457085627265837, 4.0063553255949325, -10.928093499865136, -18.471784756224405, 6.860103146748484, 20.71602103822418, -6.576442781315374, 7.7244559374755575, 7.845088142272932, 4.325604546608531, 4.887746926758524, -24.60142322145039, 1.4163479859807104, 9.626699711151641, 16.606784698685512, -2.7080238385351643, 10.07746141228232, 24.547276154786232, -2.1751707797967885, 5.0099093792122975, -6.58223486153268, 10.928652762793488, 2.7667971050411166, -1.4619738706273473, -2.5862282420719565, 13.511729982064587, -6.6932614783253905, 6.921726946844533, 18.37919070440557, -3.745252126209733, -6.325669449630329, 16.133211714100714, -4.274988334382667, -0.404396623296561, 5.929763112185331, 8.366214106957992, -0.3336007832033149, 20.10076941321351, -24.729344023488334, -4.45430530279389, -18.339829076111474], "episode_lengths": [951, 269, 1117, 269, 350, 164, 302, 194, 916, 503, 439, 371, 365, 408, 406, 795, 425, 295, 1117, 797, 227, 653, 295, 415, 274, 440, 895, 383, 761, 297, 259, 1117, 269, 425, 608, 896, 1117, 447, 440, 517, 893, 696, 798, 764, 406, 1117, 564, 288, 91, 391, 1117, 408, 339, 317, 618, 764, 350, 1117, 261, 375, 1117, 520, 763, 269, 1117, 714, 269, 653, 237, 269, 690, 273, 373, 1117, 415, 295, 1117, 1037, 150, 487, 794, 309, 605, 804, 295, 795, 1090, 1117, 645, 746, 1059, 730, 654, 945, 945, 409, 1117, 678, 674, 801]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9772059850843104, "mean_inference_ms": 6.844155769596323, "mean_action_processing_ms": 0.4879126751857099, "mean_env_wait_ms": 20.868953831178732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013574838638305664, "StateBufferConnector_ms": 0.01177215576171875, "ViewRequirementAgentConnector_ms": 0.7067420482635498}}, "episode_reward_max": 28.303739653293274, "episode_reward_min": -24.729344023488334, "episode_reward_mean": 2.1832543122748835, "episode_len_mean": 599.56, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.352371900264488, 7.246257296784583, 12.241514098626649, 10.63223628526121, 5.01750477214695, 7.504467004472774, 1.9549330028270715, 3.9331951154137688, 0.33206839745803385, 0.39766783938862105, -4.733043947170461, -1.202269628676948, 0.007244163366058487, -7.648046061936714, 3.646494769259921, 2.802304539736302, -3.536914066398562, 7.326433477915359, 18.66388586450809, 10.231765337122038, 4.723452575949148, 4.062273440772551, 6.234583499364759, 3.3602684208972056, 8.906787088252695, -4.973005339735516, -11.133657219785112, -11.607756111633218, -1.3303256575845737, 5.994911559783554, 10.90851269131062, 9.551727877738077, 9.39335161646714, -0.2589423316161288, -2.0548523286891394, 11.24159857895895, 17.731006589073015, -8.71373860728265, -6.5488831301374075, -3.5376960060288645, -12.817196283562065, -9.537204068749926, -5.371810230248621, -14.361582069263692, 0.8337145426845323, 1.6916505057240205, -5.576349217370622, 6.672168817759855, 2.8224049076664253, -2.8560538079361852, 21.421929857749046, 2.9909272928916284, 0.07043260036326182, 6.4860977032792455, -7.960279792845509, -5.600958397233553, 5.987243132241714, 28.303739653293274, 1.3566900727999816, -0.6457085627265837, 4.0063553255949325, -10.928093499865136, -18.471784756224405, 6.860103146748484, 20.71602103822418, -6.576442781315374, 7.7244559374755575, 7.845088142272932, 4.325604546608531, 4.887746926758524, -24.60142322145039, 1.4163479859807104, 9.626699711151641, 16.606784698685512, -2.7080238385351643, 10.07746141228232, 24.547276154786232, -2.1751707797967885, 5.0099093792122975, -6.58223486153268, 10.928652762793488, 2.7667971050411166, -1.4619738706273473, -2.5862282420719565, 13.511729982064587, -6.6932614783253905, 6.921726946844533, 18.37919070440557, -3.745252126209733, -6.325669449630329, 16.133211714100714, -4.274988334382667, -0.404396623296561, 5.929763112185331, 8.366214106957992, -0.3336007832033149, 20.10076941321351, -24.729344023488334, -4.45430530279389, -18.339829076111474], "episode_lengths": [951, 269, 1117, 269, 350, 164, 302, 194, 916, 503, 439, 371, 365, 408, 406, 795, 425, 295, 1117, 797, 227, 653, 295, 415, 274, 440, 895, 383, 761, 297, 259, 1117, 269, 425, 608, 896, 1117, 447, 440, 517, 893, 696, 798, 764, 406, 1117, 564, 288, 91, 391, 1117, 408, 339, 317, 618, 764, 350, 1117, 261, 375, 1117, 520, 763, 269, 1117, 714, 269, 653, 237, 269, 690, 273, 373, 1117, 415, 295, 1117, 1037, 150, 487, 794, 309, 605, 804, 295, 795, 1090, 1117, 645, 746, 1059, 730, 654, 945, 945, 409, 1117, 678, 674, 801]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9772059850843104, "mean_inference_ms": 6.844155769596323, "mean_action_processing_ms": 0.4879126751857099, "mean_env_wait_ms": 20.868953831178732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013574838638305664, "StateBufferConnector_ms": 0.01177215576171875, "ViewRequirementAgentConnector_ms": 0.7067420482635498}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91119, "num_agent_steps_trained": 91119, "num_env_steps_sampled": 91119, "num_env_steps_trained": 91119, "num_env_steps_sampled_this_iter": 11610, "num_env_steps_trained_this_iter": 11610, "num_env_steps_sampled_throughput_per_sec": 219.62529981452715, "num_env_steps_trained_throughput_per_sec": 219.62529981452715, "timesteps_total": 91119, "num_steps_trained_this_iter": 11610, "agent_timesteps_total": 91119, "timers": {"training_iteration_time_ms": 38752.667, "sample_time_ms": 29829.087, "load_time_ms": 1144.46, "load_throughput": 7313.583, "learn_time_ms": 7277.779, "learn_throughput": 1150.09, "synch_weights_time_ms": 431.506}, "counters": {"num_env_steps_sampled": 91119, "num_env_steps_trained": 91119, "num_agent_steps_sampled": 91119, "num_agent_steps_trained": 91119}, "done": false, "episodes_total": 155, "training_iteration": 11, "trial_id": "837cb_00000", "date": "2025-06-07_17-33-03", "timestamp": 1749310383, "time_this_iter_s": 52.88575553894043, "time_total_s": 443.03441309928894, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 443.03441309928894, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 58.98095238095238, "ram_util_percent": 67.16190476190475, "gpu_util_percent0": 0.17841269841269844, "vram_util_percent0": 0.9622680018187834}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.908881e-05, "total_loss": -0.12647168122112773, "policy_loss": -0.008551232900381798, "vf_loss": 0.06548549064568111, "vf_explained_var": 0.877202808147385, "kl": 0.009636531958087636, "entropy": 14.476374528521584, "entropy_coeff": 0.009544405000000004}, "model": {}, "num_grad_updates_lifetime": 3400.5, "diff_num_grad_updates_vs_sampler_policy": 209.5}}, "num_env_steps_sampled": 102936, "num_env_steps_trained": 102936, "num_agent_steps_sampled": 102936, "num_agent_steps_trained": 102936}, "sampler_results": {"episode_reward_max": 28.303739653293274, "episode_reward_min": -24.729344023488334, "episode_reward_mean": 2.850026940704007, "episode_len_mean": 651.55, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.646494769259921, 2.802304539736302, -3.536914066398562, 7.326433477915359, 18.66388586450809, 10.231765337122038, 4.723452575949148, 4.062273440772551, 6.234583499364759, 3.3602684208972056, 8.906787088252695, -4.973005339735516, -11.133657219785112, -11.607756111633218, -1.3303256575845737, 5.994911559783554, 10.90851269131062, 9.551727877738077, 9.39335161646714, -0.2589423316161288, -2.0548523286891394, 11.24159857895895, 17.731006589073015, -8.71373860728265, -6.5488831301374075, -3.5376960060288645, -12.817196283562065, -9.537204068749926, -5.371810230248621, -14.361582069263692, 0.8337145426845323, 1.6916505057240205, -5.576349217370622, 6.672168817759855, 2.8224049076664253, -2.8560538079361852, 21.421929857749046, 2.9909272928916284, 0.07043260036326182, 6.4860977032792455, -7.960279792845509, -5.600958397233553, 5.987243132241714, 28.303739653293274, 1.3566900727999816, -0.6457085627265837, 4.0063553255949325, -10.928093499865136, -18.471784756224405, 6.860103146748484, 20.71602103822418, -6.576442781315374, 7.7244559374755575, 7.845088142272932, 4.325604546608531, 4.887746926758524, -24.60142322145039, 1.4163479859807104, 9.626699711151641, 16.606784698685512, -2.7080238385351643, 10.07746141228232, 24.547276154786232, -2.1751707797967885, 5.0099093792122975, -6.58223486153268, 10.928652762793488, 2.7667971050411166, -1.4619738706273473, -2.5862282420719565, 13.511729982064587, -6.6932614783253905, 6.921726946844533, 18.37919070440557, -3.745252126209733, -6.325669449630329, 16.133211714100714, -4.274988334382667, -0.404396623296561, 5.929763112185331, 8.366214106957992, -0.3336007832033149, 20.10076941321351, -24.729344023488334, -4.45430530279389, -18.339829076111474, -13.851418209739455, 6.4601881065848294, 5.966191444281838, -11.133619691408382, 19.445136491596156, 12.172141958615052, 6.937822260130912, 16.821356728864455, 7.7513021142723, 19.636808866704175, -3.5934268837334886, 0.1902392288913124, 25.308054252543567, 16.602586413535217], "episode_lengths": [406, 795, 425, 295, 1117, 797, 227, 653, 295, 415, 274, 440, 895, 383, 761, 297, 259, 1117, 269, 425, 608, 896, 1117, 447, 440, 517, 893, 696, 798, 764, 406, 1117, 564, 288, 91, 391, 1117, 408, 339, 317, 618, 764, 350, 1117, 261, 375, 1117, 520, 763, 269, 1117, 714, 269, 653, 237, 269, 690, 273, 373, 1117, 415, 295, 1117, 1037, 150, 487, 794, 309, 605, 804, 295, 795, 1090, 1117, 645, 746, 1059, 730, 654, 945, 945, 409, 1117, 678, 674, 801, 635, 295, 1117, 567, 1117, 1086, 295, 1117, 1117, 1117, 763, 357, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9742138870746608, "mean_inference_ms": 6.848425009102956, "mean_action_processing_ms": 0.4881019173716368, "mean_env_wait_ms": 20.884979360622737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014292240142822266, "StateBufferConnector_ms": 0.012768030166625977, "ViewRequirementAgentConnector_ms": 0.6797819137573242}}, "episode_reward_max": 28.303739653293274, "episode_reward_min": -24.729344023488334, "episode_reward_mean": 2.850026940704007, "episode_len_mean": 651.55, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.646494769259921, 2.802304539736302, -3.536914066398562, 7.326433477915359, 18.66388586450809, 10.231765337122038, 4.723452575949148, 4.062273440772551, 6.234583499364759, 3.3602684208972056, 8.906787088252695, -4.973005339735516, -11.133657219785112, -11.607756111633218, -1.3303256575845737, 5.994911559783554, 10.90851269131062, 9.551727877738077, 9.39335161646714, -0.2589423316161288, -2.0548523286891394, 11.24159857895895, 17.731006589073015, -8.71373860728265, -6.5488831301374075, -3.5376960060288645, -12.817196283562065, -9.537204068749926, -5.371810230248621, -14.361582069263692, 0.8337145426845323, 1.6916505057240205, -5.576349217370622, 6.672168817759855, 2.8224049076664253, -2.8560538079361852, 21.421929857749046, 2.9909272928916284, 0.07043260036326182, 6.4860977032792455, -7.960279792845509, -5.600958397233553, 5.987243132241714, 28.303739653293274, 1.3566900727999816, -0.6457085627265837, 4.0063553255949325, -10.928093499865136, -18.471784756224405, 6.860103146748484, 20.71602103822418, -6.576442781315374, 7.7244559374755575, 7.845088142272932, 4.325604546608531, 4.887746926758524, -24.60142322145039, 1.4163479859807104, 9.626699711151641, 16.606784698685512, -2.7080238385351643, 10.07746141228232, 24.547276154786232, -2.1751707797967885, 5.0099093792122975, -6.58223486153268, 10.928652762793488, 2.7667971050411166, -1.4619738706273473, -2.5862282420719565, 13.511729982064587, -6.6932614783253905, 6.921726946844533, 18.37919070440557, -3.745252126209733, -6.325669449630329, 16.133211714100714, -4.274988334382667, -0.404396623296561, 5.929763112185331, 8.366214106957992, -0.3336007832033149, 20.10076941321351, -24.729344023488334, -4.45430530279389, -18.339829076111474, -13.851418209739455, 6.4601881065848294, 5.966191444281838, -11.133619691408382, 19.445136491596156, 12.172141958615052, 6.937822260130912, 16.821356728864455, 7.7513021142723, 19.636808866704175, -3.5934268837334886, 0.1902392288913124, 25.308054252543567, 16.602586413535217], "episode_lengths": [406, 795, 425, 295, 1117, 797, 227, 653, 295, 415, 274, 440, 895, 383, 761, 297, 259, 1117, 269, 425, 608, 896, 1117, 447, 440, 517, 893, 696, 798, 764, 406, 1117, 564, 288, 91, 391, 1117, 408, 339, 317, 618, 764, 350, 1117, 261, 375, 1117, 520, 763, 269, 1117, 714, 269, 653, 237, 269, 690, 273, 373, 1117, 415, 295, 1117, 1037, 150, 487, 794, 309, 605, 804, 295, 795, 1090, 1117, 645, 746, 1059, 730, 654, 945, 945, 409, 1117, 678, 674, 801, 635, 295, 1117, 567, 1117, 1086, 295, 1117, 1117, 1117, 763, 357, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9742138870746608, "mean_inference_ms": 6.848425009102956, "mean_action_processing_ms": 0.4881019173716368, "mean_env_wait_ms": 20.884979360622737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014292240142822266, "StateBufferConnector_ms": 0.012768030166625977, "ViewRequirementAgentConnector_ms": 0.6797819137573242}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102936, "num_agent_steps_trained": 102936, "num_env_steps_sampled": 102936, "num_env_steps_trained": 102936, "num_env_steps_sampled_this_iter": 11817, "num_env_steps_trained_this_iter": 11817, "num_env_steps_sampled_throughput_per_sec": 221.65379370169327, "num_env_steps_trained_throughput_per_sec": 221.65379370169327, "timesteps_total": 102936, "num_steps_trained_this_iter": 11817, "agent_timesteps_total": 102936, "timers": {"training_iteration_time_ms": 41034.904, "sample_time_ms": 30768.845, "load_time_ms": 1348.308, "load_throughput": 6582.621, "learn_time_ms": 8406.999, "learn_throughput": 1055.716, "synch_weights_time_ms": 437.817}, "counters": {"num_env_steps_sampled": 102936, "num_env_steps_trained": 102936, "num_agent_steps_sampled": 102936, "num_agent_steps_trained": 102936}, "done": false, "episodes_total": 169, "training_iteration": 12, "trial_id": "837cb_00000", "date": "2025-06-07_17-33-56", "timestamp": 1749310436, "time_this_iter_s": 53.329899311065674, "time_total_s": 496.3643124103546, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 496.3643124103546, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 59.23125, "ram_util_percent": 72.790625, "gpu_util_percent0": 0.17796875, "vram_util_percent0": 0.9656575520833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.897064e-05, "total_loss": -0.11812511588359484, "policy_loss": -0.0026684561622460023, "vf_loss": 0.07123410271015018, "vf_explained_var": 0.8716658698394895, "kl": 0.008940004676105673, "entropy": 14.484028187394141, "entropy_coeff": 0.009485320000000002}, "model": {}, "num_grad_updates_lifetime": 3770.5, "diff_num_grad_updates_vs_sampler_policy": 159.5}}, "num_env_steps_sampled": 112069, "num_env_steps_trained": 112069, "num_agent_steps_sampled": 112069, "num_agent_steps_trained": 112069}, "sampler_results": {"episode_reward_max": 28.303739653293274, "episode_reward_min": -24.729344023488334, "episode_reward_mean": 2.4730941563261983, "episode_len_mean": 668.71, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.3303256575845737, 5.994911559783554, 10.90851269131062, 9.551727877738077, 9.39335161646714, -0.2589423316161288, -2.0548523286891394, 11.24159857895895, 17.731006589073015, -8.71373860728265, -6.5488831301374075, -3.5376960060288645, -12.817196283562065, -9.537204068749926, -5.371810230248621, -14.361582069263692, 0.8337145426845323, 1.6916505057240205, -5.576349217370622, 6.672168817759855, 2.8224049076664253, -2.8560538079361852, 21.421929857749046, 2.9909272928916284, 0.07043260036326182, 6.4860977032792455, -7.960279792845509, -5.600958397233553, 5.987243132241714, 28.303739653293274, 1.3566900727999816, -0.6457085627265837, 4.0063553255949325, -10.928093499865136, -18.471784756224405, 6.860103146748484, 20.71602103822418, -6.576442781315374, 7.7244559374755575, 7.845088142272932, 4.325604546608531, 4.887746926758524, -24.60142322145039, 1.4163479859807104, 9.626699711151641, 16.606784698685512, -2.7080238385351643, 10.07746141228232, 24.547276154786232, -2.1751707797967885, 5.0099093792122975, -6.58223486153268, 10.928652762793488, 2.7667971050411166, -1.4619738706273473, -2.5862282420719565, 13.511729982064587, -6.6932614783253905, 6.921726946844533, 18.37919070440557, -3.745252126209733, -6.325669449630329, 16.133211714100714, -4.274988334382667, -0.404396623296561, 5.929763112185331, 8.366214106957992, -0.3336007832033149, 20.10076941321351, -24.729344023488334, -4.45430530279389, -18.339829076111474, -13.851418209739455, 6.4601881065848294, 5.966191444281838, -11.133619691408382, 19.445136491596156, 12.172141958615052, 6.937822260130912, 16.821356728864455, 7.7513021142723, 19.636808866704175, -3.5934268837334886, 0.1902392288913124, 25.308054252543567, 16.602586413535217, 0.8325232650397192, -9.209189971140997, 14.670331527947994, 7.798604845090303, -3.049806092607924, 4.463028693074987, -14.094087796543644, -2.7542538510410823, -12.633319103229223, 3.7072055793841985, 13.650386045681342, -10.641790260778661, 9.442369498608253, -1.1683645410404548], "episode_lengths": [761, 297, 259, 1117, 269, 425, 608, 896, 1117, 447, 440, 517, 893, 696, 798, 764, 406, 1117, 564, 288, 91, 391, 1117, 408, 339, 317, 618, 764, 350, 1117, 261, 375, 1117, 520, 763, 269, 1117, 714, 269, 653, 237, 269, 690, 273, 373, 1117, 415, 295, 1117, 1037, 150, 487, 794, 309, 605, 804, 295, 795, 1090, 1117, 645, 746, 1059, 730, 654, 945, 945, 409, 1117, 678, 674, 801, 635, 295, 1117, 567, 1117, 1086, 295, 1117, 1117, 1117, 763, 357, 1117, 1117, 467, 463, 1117, 1117, 706, 373, 653, 273, 260, 1117, 269, 440, 1117, 761]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.970490272460425, "mean_inference_ms": 6.853201976255633, "mean_action_processing_ms": 0.4881523913377614, "mean_env_wait_ms": 20.895370235857946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01408839225769043, "StateBufferConnector_ms": 0.011778116226196289, "ViewRequirementAgentConnector_ms": 0.6565980911254883}}, "episode_reward_max": 28.303739653293274, "episode_reward_min": -24.729344023488334, "episode_reward_mean": 2.4730941563261983, "episode_len_mean": 668.71, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.3303256575845737, 5.994911559783554, 10.90851269131062, 9.551727877738077, 9.39335161646714, -0.2589423316161288, -2.0548523286891394, 11.24159857895895, 17.731006589073015, -8.71373860728265, -6.5488831301374075, -3.5376960060288645, -12.817196283562065, -9.537204068749926, -5.371810230248621, -14.361582069263692, 0.8337145426845323, 1.6916505057240205, -5.576349217370622, 6.672168817759855, 2.8224049076664253, -2.8560538079361852, 21.421929857749046, 2.9909272928916284, 0.07043260036326182, 6.4860977032792455, -7.960279792845509, -5.600958397233553, 5.987243132241714, 28.303739653293274, 1.3566900727999816, -0.6457085627265837, 4.0063553255949325, -10.928093499865136, -18.471784756224405, 6.860103146748484, 20.71602103822418, -6.576442781315374, 7.7244559374755575, 7.845088142272932, 4.325604546608531, 4.887746926758524, -24.60142322145039, 1.4163479859807104, 9.626699711151641, 16.606784698685512, -2.7080238385351643, 10.07746141228232, 24.547276154786232, -2.1751707797967885, 5.0099093792122975, -6.58223486153268, 10.928652762793488, 2.7667971050411166, -1.4619738706273473, -2.5862282420719565, 13.511729982064587, -6.6932614783253905, 6.921726946844533, 18.37919070440557, -3.745252126209733, -6.325669449630329, 16.133211714100714, -4.274988334382667, -0.404396623296561, 5.929763112185331, 8.366214106957992, -0.3336007832033149, 20.10076941321351, -24.729344023488334, -4.45430530279389, -18.339829076111474, -13.851418209739455, 6.4601881065848294, 5.966191444281838, -11.133619691408382, 19.445136491596156, 12.172141958615052, 6.937822260130912, 16.821356728864455, 7.7513021142723, 19.636808866704175, -3.5934268837334886, 0.1902392288913124, 25.308054252543567, 16.602586413535217, 0.8325232650397192, -9.209189971140997, 14.670331527947994, 7.798604845090303, -3.049806092607924, 4.463028693074987, -14.094087796543644, -2.7542538510410823, -12.633319103229223, 3.7072055793841985, 13.650386045681342, -10.641790260778661, 9.442369498608253, -1.1683645410404548], "episode_lengths": [761, 297, 259, 1117, 269, 425, 608, 896, 1117, 447, 440, 517, 893, 696, 798, 764, 406, 1117, 564, 288, 91, 391, 1117, 408, 339, 317, 618, 764, 350, 1117, 261, 375, 1117, 520, 763, 269, 1117, 714, 269, 653, 237, 269, 690, 273, 373, 1117, 415, 295, 1117, 1037, 150, 487, 794, 309, 605, 804, 295, 795, 1090, 1117, 645, 746, 1059, 730, 654, 945, 945, 409, 1117, 678, 674, 801, 635, 295, 1117, 567, 1117, 1086, 295, 1117, 1117, 1117, 763, 357, 1117, 1117, 467, 463, 1117, 1117, 706, 373, 653, 273, 260, 1117, 269, 440, 1117, 761]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.970490272460425, "mean_inference_ms": 6.853201976255633, "mean_action_processing_ms": 0.4881523913377614, "mean_env_wait_ms": 20.895370235857946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01408839225769043, "StateBufferConnector_ms": 0.011778116226196289, "ViewRequirementAgentConnector_ms": 0.6565980911254883}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112069, "num_agent_steps_trained": 112069, "num_env_steps_sampled": 112069, "num_env_steps_trained": 112069, "num_env_steps_sampled_this_iter": 9133, "num_env_steps_trained_this_iter": 9133, "num_env_steps_sampled_throughput_per_sec": 223.51031253226085, "num_env_steps_trained_throughput_per_sec": 223.51031253226085, "timesteps_total": 112069, "num_steps_trained_this_iter": 9133, "agent_timesteps_total": 112069, "timers": {"training_iteration_time_ms": 41312.054, "sample_time_ms": 30931.365, "load_time_ms": 1369.309, "load_throughput": 6530.594, "learn_time_ms": 8494.215, "learn_throughput": 1052.764, "synch_weights_time_ms": 442.628}, "counters": {"num_env_steps_sampled": 112069, "num_env_steps_trained": 112069, "num_agent_steps_sampled": 112069, "num_agent_steps_trained": 112069}, "done": false, "episodes_total": 183, "training_iteration": 13, "trial_id": "837cb_00000", "date": "2025-06-07_17-34-37", "timestamp": 1749310477, "time_this_iter_s": 40.8816556930542, "time_total_s": 537.2459681034088, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 537.2459681034088, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 59.74285714285715, "ram_util_percent": 74.75510204081633, "gpu_util_percent0": 0.0663265306122449, "vram_util_percent0": 0.9656575520833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.887930999999998e-05, "total_loss": -0.13269889395252416, "policy_loss": -0.01529972749739522, "vf_loss": 0.06333528430337404, "vf_explained_var": 0.8554194226497557, "kl": 0.008641849053408184, "entropy": 14.506873237795945, "entropy_coeff": 0.009439655000000002}, "model": {}, "num_grad_updates_lifetime": 4135.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 123756, "num_env_steps_trained": 123756, "num_agent_steps_sampled": 123756, "num_agent_steps_trained": 123756}, "sampler_results": {"episode_reward_max": 28.303739653293274, "episode_reward_min": -24.729344023488334, "episode_reward_mean": 3.379448231015407, "episode_len_mean": 698.16, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.371810230248621, -14.361582069263692, 0.8337145426845323, 1.6916505057240205, -5.576349217370622, 6.672168817759855, 2.8224049076664253, -2.8560538079361852, 21.421929857749046, 2.9909272928916284, 0.07043260036326182, 6.4860977032792455, -7.960279792845509, -5.600958397233553, 5.987243132241714, 28.303739653293274, 1.3566900727999816, -0.6457085627265837, 4.0063553255949325, -10.928093499865136, -18.471784756224405, 6.860103146748484, 20.71602103822418, -6.576442781315374, 7.7244559374755575, 7.845088142272932, 4.325604546608531, 4.887746926758524, -24.60142322145039, 1.4163479859807104, 9.626699711151641, 16.606784698685512, -2.7080238385351643, 10.07746141228232, 24.547276154786232, -2.1751707797967885, 5.0099093792122975, -6.58223486153268, 10.928652762793488, 2.7667971050411166, -1.4619738706273473, -2.5862282420719565, 13.511729982064587, -6.6932614783253905, 6.921726946844533, 18.37919070440557, -3.745252126209733, -6.325669449630329, 16.133211714100714, -4.274988334382667, -0.404396623296561, 5.929763112185331, 8.366214106957992, -0.3336007832033149, 20.10076941321351, -24.729344023488334, -4.45430530279389, -18.339829076111474, -13.851418209739455, 6.4601881065848294, 5.966191444281838, -11.133619691408382, 19.445136491596156, 12.172141958615052, 6.937822260130912, 16.821356728864455, 7.7513021142723, 19.636808866704175, -3.5934268837334886, 0.1902392288913124, 25.308054252543567, 16.602586413535217, 0.8325232650397192, -9.209189971140997, 14.670331527947994, 7.798604845090303, -3.049806092607924, 4.463028693074987, -14.094087796543644, -2.7542538510410823, -12.633319103229223, 3.7072055793841985, 13.650386045681342, -10.641790260778661, 9.442369498608253, -1.1683645410404548, 22.029852108254094, -1.679830582257715, 7.80926597010348, 7.525856550227299, 10.51958581124336, 12.689524866457628, -0.17091347443453941, -3.6670949504699366, 24.095762743552907, -1.817698604165097, 19.714726142636035, 7.947152865722509, 10.63840692376896, -4.976918402037533], "episode_lengths": [798, 764, 406, 1117, 564, 288, 91, 391, 1117, 408, 339, 317, 618, 764, 350, 1117, 261, 375, 1117, 520, 763, 269, 1117, 714, 269, 653, 237, 269, 690, 273, 373, 1117, 415, 295, 1117, 1037, 150, 487, 794, 309, 605, 804, 295, 795, 1090, 1117, 645, 746, 1059, 730, 654, 945, 945, 409, 1117, 678, 674, 801, 635, 295, 1117, 567, 1117, 1086, 295, 1117, 1117, 1117, 763, 357, 1117, 1117, 467, 463, 1117, 1117, 706, 373, 653, 273, 260, 1117, 269, 440, 1117, 761, 1117, 799, 938, 373, 744, 295, 865, 872, 1117, 864, 1117, 948, 1117, 521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9682604613264127, "mean_inference_ms": 6.862990636147415, "mean_action_processing_ms": 0.48878246529698083, "mean_env_wait_ms": 20.921396562454014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01408839225769043, "StateBufferConnector_ms": 0.01275944709777832, "ViewRequirementAgentConnector_ms": 0.6434516906738281}}, "episode_reward_max": 28.303739653293274, "episode_reward_min": -24.729344023488334, "episode_reward_mean": 3.379448231015407, "episode_len_mean": 698.16, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.371810230248621, -14.361582069263692, 0.8337145426845323, 1.6916505057240205, -5.576349217370622, 6.672168817759855, 2.8224049076664253, -2.8560538079361852, 21.421929857749046, 2.9909272928916284, 0.07043260036326182, 6.4860977032792455, -7.960279792845509, -5.600958397233553, 5.987243132241714, 28.303739653293274, 1.3566900727999816, -0.6457085627265837, 4.0063553255949325, -10.928093499865136, -18.471784756224405, 6.860103146748484, 20.71602103822418, -6.576442781315374, 7.7244559374755575, 7.845088142272932, 4.325604546608531, 4.887746926758524, -24.60142322145039, 1.4163479859807104, 9.626699711151641, 16.606784698685512, -2.7080238385351643, 10.07746141228232, 24.547276154786232, -2.1751707797967885, 5.0099093792122975, -6.58223486153268, 10.928652762793488, 2.7667971050411166, -1.4619738706273473, -2.5862282420719565, 13.511729982064587, -6.6932614783253905, 6.921726946844533, 18.37919070440557, -3.745252126209733, -6.325669449630329, 16.133211714100714, -4.274988334382667, -0.404396623296561, 5.929763112185331, 8.366214106957992, -0.3336007832033149, 20.10076941321351, -24.729344023488334, -4.45430530279389, -18.339829076111474, -13.851418209739455, 6.4601881065848294, 5.966191444281838, -11.133619691408382, 19.445136491596156, 12.172141958615052, 6.937822260130912, 16.821356728864455, 7.7513021142723, 19.636808866704175, -3.5934268837334886, 0.1902392288913124, 25.308054252543567, 16.602586413535217, 0.8325232650397192, -9.209189971140997, 14.670331527947994, 7.798604845090303, -3.049806092607924, 4.463028693074987, -14.094087796543644, -2.7542538510410823, -12.633319103229223, 3.7072055793841985, 13.650386045681342, -10.641790260778661, 9.442369498608253, -1.1683645410404548, 22.029852108254094, -1.679830582257715, 7.80926597010348, 7.525856550227299, 10.51958581124336, 12.689524866457628, -0.17091347443453941, -3.6670949504699366, 24.095762743552907, -1.817698604165097, 19.714726142636035, 7.947152865722509, 10.63840692376896, -4.976918402037533], "episode_lengths": [798, 764, 406, 1117, 564, 288, 91, 391, 1117, 408, 339, 317, 618, 764, 350, 1117, 261, 375, 1117, 520, 763, 269, 1117, 714, 269, 653, 237, 269, 690, 273, 373, 1117, 415, 295, 1117, 1037, 150, 487, 794, 309, 605, 804, 295, 795, 1090, 1117, 645, 746, 1059, 730, 654, 945, 945, 409, 1117, 678, 674, 801, 635, 295, 1117, 567, 1117, 1086, 295, 1117, 1117, 1117, 763, 357, 1117, 1117, 467, 463, 1117, 1117, 706, 373, 653, 273, 260, 1117, 269, 440, 1117, 761, 1117, 799, 938, 373, 744, 295, 865, 872, 1117, 864, 1117, 948, 1117, 521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9682604613264127, "mean_inference_ms": 6.862990636147415, "mean_action_processing_ms": 0.48878246529698083, "mean_env_wait_ms": 20.921396562454014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01408839225769043, "StateBufferConnector_ms": 0.01275944709777832, "ViewRequirementAgentConnector_ms": 0.6434516906738281}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123756, "num_agent_steps_trained": 123756, "num_env_steps_sampled": 123756, "num_env_steps_trained": 123756, "num_env_steps_sampled_this_iter": 11687, "num_env_steps_trained_this_iter": 11687, "num_env_steps_sampled_throughput_per_sec": 217.10865630156715, "num_env_steps_trained_throughput_per_sec": 217.10865630156715, "timesteps_total": 123756, "num_steps_trained_this_iter": 11687, "agent_timesteps_total": 123756, "timers": {"training_iteration_time_ms": 42762.48, "sample_time_ms": 31387.672, "load_time_ms": 1433.624, "load_throughput": 6392.332, "learn_time_ms": 9414.309, "learn_throughput": 973.433, "synch_weights_time_ms": 450.597}, "counters": {"num_env_steps_sampled": 123756, "num_env_steps_trained": 123756, "num_agent_steps_sampled": 123756, "num_agent_steps_trained": 123756}, "done": false, "episodes_total": 197, "training_iteration": 14, "trial_id": "837cb_00000", "date": "2025-06-07_17-35-31", "timestamp": 1749310531, "time_this_iter_s": 53.84674692153931, "time_total_s": 591.0927150249481, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 591.0927150249481, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 60.928125, "ram_util_percent": 75.84375, "gpu_util_percent0": 0.17093750000000002, "vram_util_percent0": 0.9656575520833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.876244000000002e-05, "total_loss": -0.13242023871745914, "policy_loss": -0.012500902348197996, "vf_loss": 0.052695674173533914, "vf_explained_var": 0.8758284294605255, "kl": 0.010260629443859215, "entropy": 14.53641773223877, "entropy_coeff": 0.00938122}, "model": {}, "num_grad_updates_lifetime": 4590.5, "diff_num_grad_updates_vs_sampler_policy": 249.5}}, "num_env_steps_sampled": 137828, "num_env_steps_trained": 137828, "num_agent_steps_sampled": 137828, "num_agent_steps_trained": 137828}, "sampler_results": {"episode_reward_max": 28.303739653293274, "episode_reward_min": -24.729344023488334, "episode_reward_mean": 5.5631010747319465, "episode_len_mean": 759.06, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.987243132241714, 28.303739653293274, 1.3566900727999816, -0.6457085627265837, 4.0063553255949325, -10.928093499865136, -18.471784756224405, 6.860103146748484, 20.71602103822418, -6.576442781315374, 7.7244559374755575, 7.845088142272932, 4.325604546608531, 4.887746926758524, -24.60142322145039, 1.4163479859807104, 9.626699711151641, 16.606784698685512, -2.7080238385351643, 10.07746141228232, 24.547276154786232, -2.1751707797967885, 5.0099093792122975, -6.58223486153268, 10.928652762793488, 2.7667971050411166, -1.4619738706273473, -2.5862282420719565, 13.511729982064587, -6.6932614783253905, 6.921726946844533, 18.37919070440557, -3.745252126209733, -6.325669449630329, 16.133211714100714, -4.274988334382667, -0.404396623296561, 5.929763112185331, 8.366214106957992, -0.3336007832033149, 20.10076941321351, -24.729344023488334, -4.45430530279389, -18.339829076111474, -13.851418209739455, 6.4601881065848294, 5.966191444281838, -11.133619691408382, 19.445136491596156, 12.172141958615052, 6.937822260130912, 16.821356728864455, 7.7513021142723, 19.636808866704175, -3.5934268837334886, 0.1902392288913124, 25.308054252543567, 16.602586413535217, 0.8325232650397192, -9.209189971140997, 14.670331527947994, 7.798604845090303, -3.049806092607924, 4.463028693074987, -14.094087796543644, -2.7542538510410823, -12.633319103229223, 3.7072055793841985, 13.650386045681342, -10.641790260778661, 9.442369498608253, -1.1683645410404548, 22.029852108254094, -1.679830582257715, 7.80926597010348, 7.525856550227299, 10.51958581124336, 12.689524866457628, -0.17091347443453941, -3.6670949504699366, 24.095762743552907, -1.817698604165097, 19.714726142636035, 7.947152865722509, 10.63840692376896, -4.976918402037533, 14.777823729180865, 20.164931911751115, 11.41293842514205, 12.9780821244309, 25.16044583010282, 6.503300424970803, 4.433980759301201, 6.914063410323009, 27.21037816695369, 13.778741547003575, 22.617398526580626, 13.872131135750676, 16.913089680378864, 22.890271413003617], "episode_lengths": [350, 1117, 261, 375, 1117, 520, 763, 269, 1117, 714, 269, 653, 237, 269, 690, 273, 373, 1117, 415, 295, 1117, 1037, 150, 487, 794, 309, 605, 804, 295, 795, 1090, 1117, 645, 746, 1059, 730, 654, 945, 945, 409, 1117, 678, 674, 801, 635, 295, 1117, 567, 1117, 1086, 295, 1117, 1117, 1117, 763, 357, 1117, 1117, 467, 463, 1117, 1117, 706, 373, 653, 273, 260, 1117, 269, 440, 1117, 761, 1117, 799, 938, 373, 744, 295, 865, 872, 1117, 864, 1117, 948, 1117, 521, 1117, 1117, 1117, 295, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9762065707089382, "mean_inference_ms": 6.87124463677834, "mean_action_processing_ms": 0.48956663164121617, "mean_env_wait_ms": 20.977190773282878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013057470321655273, "StateBufferConnector_ms": 0.010740995407104492, "ViewRequirementAgentConnector_ms": 0.6714513301849365}}, "episode_reward_max": 28.303739653293274, "episode_reward_min": -24.729344023488334, "episode_reward_mean": 5.5631010747319465, "episode_len_mean": 759.06, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.987243132241714, 28.303739653293274, 1.3566900727999816, -0.6457085627265837, 4.0063553255949325, -10.928093499865136, -18.471784756224405, 6.860103146748484, 20.71602103822418, -6.576442781315374, 7.7244559374755575, 7.845088142272932, 4.325604546608531, 4.887746926758524, -24.60142322145039, 1.4163479859807104, 9.626699711151641, 16.606784698685512, -2.7080238385351643, 10.07746141228232, 24.547276154786232, -2.1751707797967885, 5.0099093792122975, -6.58223486153268, 10.928652762793488, 2.7667971050411166, -1.4619738706273473, -2.5862282420719565, 13.511729982064587, -6.6932614783253905, 6.921726946844533, 18.37919070440557, -3.745252126209733, -6.325669449630329, 16.133211714100714, -4.274988334382667, -0.404396623296561, 5.929763112185331, 8.366214106957992, -0.3336007832033149, 20.10076941321351, -24.729344023488334, -4.45430530279389, -18.339829076111474, -13.851418209739455, 6.4601881065848294, 5.966191444281838, -11.133619691408382, 19.445136491596156, 12.172141958615052, 6.937822260130912, 16.821356728864455, 7.7513021142723, 19.636808866704175, -3.5934268837334886, 0.1902392288913124, 25.308054252543567, 16.602586413535217, 0.8325232650397192, -9.209189971140997, 14.670331527947994, 7.798604845090303, -3.049806092607924, 4.463028693074987, -14.094087796543644, -2.7542538510410823, -12.633319103229223, 3.7072055793841985, 13.650386045681342, -10.641790260778661, 9.442369498608253, -1.1683645410404548, 22.029852108254094, -1.679830582257715, 7.80926597010348, 7.525856550227299, 10.51958581124336, 12.689524866457628, -0.17091347443453941, -3.6670949504699366, 24.095762743552907, -1.817698604165097, 19.714726142636035, 7.947152865722509, 10.63840692376896, -4.976918402037533, 14.777823729180865, 20.164931911751115, 11.41293842514205, 12.9780821244309, 25.16044583010282, 6.503300424970803, 4.433980759301201, 6.914063410323009, 27.21037816695369, 13.778741547003575, 22.617398526580626, 13.872131135750676, 16.913089680378864, 22.890271413003617], "episode_lengths": [350, 1117, 261, 375, 1117, 520, 763, 269, 1117, 714, 269, 653, 237, 269, 690, 273, 373, 1117, 415, 295, 1117, 1037, 150, 487, 794, 309, 605, 804, 295, 795, 1090, 1117, 645, 746, 1059, 730, 654, 945, 945, 409, 1117, 678, 674, 801, 635, 295, 1117, 567, 1117, 1086, 295, 1117, 1117, 1117, 763, 357, 1117, 1117, 467, 463, 1117, 1117, 706, 373, 653, 273, 260, 1117, 269, 440, 1117, 761, 1117, 799, 938, 373, 744, 295, 865, 872, 1117, 864, 1117, 948, 1117, 521, 1117, 1117, 1117, 295, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9762065707089382, "mean_inference_ms": 6.87124463677834, "mean_action_processing_ms": 0.48956663164121617, "mean_env_wait_ms": 20.977190773282878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013057470321655273, "StateBufferConnector_ms": 0.010740995407104492, "ViewRequirementAgentConnector_ms": 0.6714513301849365}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137828, "num_agent_steps_trained": 137828, "num_env_steps_sampled": 137828, "num_env_steps_trained": 137828, "num_env_steps_sampled_this_iter": 14072, "num_env_steps_trained_this_iter": 14072, "num_env_steps_sampled_throughput_per_sec": 216.21074970591127, "num_env_steps_trained_throughput_per_sec": 216.21074970591127, "timesteps_total": 137828, "num_steps_trained_this_iter": 14072, "agent_timesteps_total": 137828, "timers": {"training_iteration_time_ms": 45927.352, "sample_time_ms": 32747.635, "load_time_ms": 1745.993, "load_throughput": 5706.837, "learn_time_ms": 10899.582, "learn_throughput": 914.173, "synch_weights_time_ms": 454.734}, "counters": {"num_env_steps_sampled": 137828, "num_env_steps_trained": 137828, "num_agent_steps_sampled": 137828, "num_agent_steps_trained": 137828}, "done": false, "episodes_total": 211, "training_iteration": 15, "trial_id": "837cb_00000", "date": "2025-06-07_17-36-36", "timestamp": 1749310596, "time_this_iter_s": 65.10655736923218, "time_total_s": 656.1992723941803, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 656.1992723941803, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 67.18026315789474, "ram_util_percent": 80.2513157894737, "gpu_util_percent0": 0.18039473684210527, "vram_util_percent0": 0.965657552083333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.862172e-05, "total_loss": -0.14287346242493426, "policy_loss": -0.02749583508319825, "vf_loss": 0.06720427414972563, "vf_explained_var": 0.7998810415365258, "kl": 0.009267342690190144, "entropy": 14.619285155315788, "entropy_coeff": 0.009310860000000002}, "model": {}, "num_grad_updates_lifetime": 5085.5, "diff_num_grad_updates_vs_sampler_policy": 244.5}}, "num_env_steps_sampled": 151660, "num_env_steps_trained": 151660, "num_agent_steps_sampled": 151660, "num_agent_steps_trained": 151660}, "sampler_results": {"episode_reward_max": 49.31913868919128, "episode_reward_min": -24.729344023488334, "episode_reward_mean": 6.388823308260666, "episode_len_mean": 817.07, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.60142322145039, 1.4163479859807104, 9.626699711151641, 16.606784698685512, -2.7080238385351643, 10.07746141228232, 24.547276154786232, -2.1751707797967885, 5.0099093792122975, -6.58223486153268, 10.928652762793488, 2.7667971050411166, -1.4619738706273473, -2.5862282420719565, 13.511729982064587, -6.6932614783253905, 6.921726946844533, 18.37919070440557, -3.745252126209733, -6.325669449630329, 16.133211714100714, -4.274988334382667, -0.404396623296561, 5.929763112185331, 8.366214106957992, -0.3336007832033149, 20.10076941321351, -24.729344023488334, -4.45430530279389, -18.339829076111474, -13.851418209739455, 6.4601881065848294, 5.966191444281838, -11.133619691408382, 19.445136491596156, 12.172141958615052, 6.937822260130912, 16.821356728864455, 7.7513021142723, 19.636808866704175, -3.5934268837334886, 0.1902392288913124, 25.308054252543567, 16.602586413535217, 0.8325232650397192, -9.209189971140997, 14.670331527947994, 7.798604845090303, -3.049806092607924, 4.463028693074987, -14.094087796543644, -2.7542538510410823, -12.633319103229223, 3.7072055793841985, 13.650386045681342, -10.641790260778661, 9.442369498608253, -1.1683645410404548, 22.029852108254094, -1.679830582257715, 7.80926597010348, 7.525856550227299, 10.51958581124336, 12.689524866457628, -0.17091347443453941, -3.6670949504699366, 24.095762743552907, -1.817698604165097, 19.714726142636035, 7.947152865722509, 10.63840692376896, -4.976918402037533, 14.777823729180865, 20.164931911751115, 11.41293842514205, 12.9780821244309, 25.16044583010282, 6.503300424970803, 4.433980759301201, 6.914063410323009, 27.21037816695369, 13.778741547003575, 22.617398526580626, 13.872131135750676, 16.913089680378864, 22.890271413003617, -17.425545763449353, 20.78541494769643, 3.6774699889197255, 11.65627201839986, 49.31913868919128, 15.674475060737096, -3.6938755664109397, 11.371295959560456, 6.233718430939492, 21.095450044322895, 21.970696464696548, -23.940997422919637, 11.086774629553307, 10.152954193521417], "episode_lengths": [690, 273, 373, 1117, 415, 295, 1117, 1037, 150, 487, 794, 309, 605, 804, 295, 795, 1090, 1117, 645, 746, 1059, 730, 654, 945, 945, 409, 1117, 678, 674, 801, 635, 295, 1117, 567, 1117, 1086, 295, 1117, 1117, 1117, 763, 357, 1117, 1117, 467, 463, 1117, 1117, 706, 373, 653, 273, 260, 1117, 269, 440, 1117, 761, 1117, 799, 938, 373, 744, 295, 865, 872, 1117, 864, 1117, 948, 1117, 521, 1117, 1117, 1117, 295, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 863, 1117, 1064, 1117, 1117, 1117, 1117, 1117, 794, 1117, 1117, 959, 947, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9905959222064735, "mean_inference_ms": 6.886654309731158, "mean_action_processing_ms": 0.4906085369079554, "mean_env_wait_ms": 21.072596745453676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011046171188354492, "StateBufferConnector_ms": 0.012027263641357422, "ViewRequirementAgentConnector_ms": 0.6801590919494629}}, "episode_reward_max": 49.31913868919128, "episode_reward_min": -24.729344023488334, "episode_reward_mean": 6.388823308260666, "episode_len_mean": 817.07, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-24.60142322145039, 1.4163479859807104, 9.626699711151641, 16.606784698685512, -2.7080238385351643, 10.07746141228232, 24.547276154786232, -2.1751707797967885, 5.0099093792122975, -6.58223486153268, 10.928652762793488, 2.7667971050411166, -1.4619738706273473, -2.5862282420719565, 13.511729982064587, -6.6932614783253905, 6.921726946844533, 18.37919070440557, -3.745252126209733, -6.325669449630329, 16.133211714100714, -4.274988334382667, -0.404396623296561, 5.929763112185331, 8.366214106957992, -0.3336007832033149, 20.10076941321351, -24.729344023488334, -4.45430530279389, -18.339829076111474, -13.851418209739455, 6.4601881065848294, 5.966191444281838, -11.133619691408382, 19.445136491596156, 12.172141958615052, 6.937822260130912, 16.821356728864455, 7.7513021142723, 19.636808866704175, -3.5934268837334886, 0.1902392288913124, 25.308054252543567, 16.602586413535217, 0.8325232650397192, -9.209189971140997, 14.670331527947994, 7.798604845090303, -3.049806092607924, 4.463028693074987, -14.094087796543644, -2.7542538510410823, -12.633319103229223, 3.7072055793841985, 13.650386045681342, -10.641790260778661, 9.442369498608253, -1.1683645410404548, 22.029852108254094, -1.679830582257715, 7.80926597010348, 7.525856550227299, 10.51958581124336, 12.689524866457628, -0.17091347443453941, -3.6670949504699366, 24.095762743552907, -1.817698604165097, 19.714726142636035, 7.947152865722509, 10.63840692376896, -4.976918402037533, 14.777823729180865, 20.164931911751115, 11.41293842514205, 12.9780821244309, 25.16044583010282, 6.503300424970803, 4.433980759301201, 6.914063410323009, 27.21037816695369, 13.778741547003575, 22.617398526580626, 13.872131135750676, 16.913089680378864, 22.890271413003617, -17.425545763449353, 20.78541494769643, 3.6774699889197255, 11.65627201839986, 49.31913868919128, 15.674475060737096, -3.6938755664109397, 11.371295959560456, 6.233718430939492, 21.095450044322895, 21.970696464696548, -23.940997422919637, 11.086774629553307, 10.152954193521417], "episode_lengths": [690, 273, 373, 1117, 415, 295, 1117, 1037, 150, 487, 794, 309, 605, 804, 295, 795, 1090, 1117, 645, 746, 1059, 730, 654, 945, 945, 409, 1117, 678, 674, 801, 635, 295, 1117, 567, 1117, 1086, 295, 1117, 1117, 1117, 763, 357, 1117, 1117, 467, 463, 1117, 1117, 706, 373, 653, 273, 260, 1117, 269, 440, 1117, 761, 1117, 799, 938, 373, 744, 295, 865, 872, 1117, 864, 1117, 948, 1117, 521, 1117, 1117, 1117, 295, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 863, 1117, 1064, 1117, 1117, 1117, 1117, 1117, 794, 1117, 1117, 959, 947, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9905959222064735, "mean_inference_ms": 6.886654309731158, "mean_action_processing_ms": 0.4906085369079554, "mean_env_wait_ms": 21.072596745453676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011046171188354492, "StateBufferConnector_ms": 0.012027263641357422, "ViewRequirementAgentConnector_ms": 0.6801590919494629}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151660, "num_agent_steps_trained": 151660, "num_env_steps_sampled": 151660, "num_env_steps_trained": 151660, "num_env_steps_sampled_this_iter": 13832, "num_env_steps_trained_this_iter": 13832, "num_env_steps_sampled_throughput_per_sec": 224.25326414832776, "num_env_steps_trained_throughput_per_sec": 224.25326414832776, "timesteps_total": 151660, "num_steps_trained_this_iter": 13832, "agent_timesteps_total": 151660, "timers": {"training_iteration_time_ms": 48485.258, "sample_time_ms": 33678.951, "load_time_ms": 2030.074, "load_throughput": 5206.757, "learn_time_ms": 12230.22, "learn_throughput": 864.261, "synch_weights_time_ms": 459.059}, "counters": {"num_env_steps_sampled": 151660, "num_env_steps_trained": 151660, "num_agent_steps_sampled": 151660, "num_agent_steps_trained": 151660}, "done": false, "episodes_total": 225, "training_iteration": 16, "trial_id": "837cb_00000", "date": "2025-06-07_17-37-38", "timestamp": 1749310658, "time_this_iter_s": 61.69737768173218, "time_total_s": 717.8966500759125, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 717.8966500759125, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 64.33698630136986, "ram_util_percent": 82.32191780821917, "gpu_util_percent0": 0.1835616438356164, "vram_util_percent0": 0.9662684610445206}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.848340000000001e-05, "total_loss": -0.14813116139409188, "policy_loss": -0.031352212434463504, "vf_loss": 0.06069308848937555, "vf_explained_var": 0.8317218832823695, "kl": 0.009768275084385438, "entropy": 14.672343184023488, "entropy_coeff": 0.009241700000000002}, "model": {}, "num_grad_updates_lifetime": 5575.5, "diff_num_grad_updates_vs_sampler_policy": 244.5}}, "num_env_steps_sampled": 165510, "num_env_steps_trained": 165510, "num_agent_steps_sampled": 165510, "num_agent_steps_trained": 165510}, "sampler_results": {"episode_reward_max": 49.31913868919128, "episode_reward_min": -24.729344023488334, "episode_reward_mean": 7.410455854811102, "episode_len_mean": 870.91, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.511729982064587, -6.6932614783253905, 6.921726946844533, 18.37919070440557, -3.745252126209733, -6.325669449630329, 16.133211714100714, -4.274988334382667, -0.404396623296561, 5.929763112185331, 8.366214106957992, -0.3336007832033149, 20.10076941321351, -24.729344023488334, -4.45430530279389, -18.339829076111474, -13.851418209739455, 6.4601881065848294, 5.966191444281838, -11.133619691408382, 19.445136491596156, 12.172141958615052, 6.937822260130912, 16.821356728864455, 7.7513021142723, 19.636808866704175, -3.5934268837334886, 0.1902392288913124, 25.308054252543567, 16.602586413535217, 0.8325232650397192, -9.209189971140997, 14.670331527947994, 7.798604845090303, -3.049806092607924, 4.463028693074987, -14.094087796543644, -2.7542538510410823, -12.633319103229223, 3.7072055793841985, 13.650386045681342, -10.641790260778661, 9.442369498608253, -1.1683645410404548, 22.029852108254094, -1.679830582257715, 7.80926597010348, 7.525856550227299, 10.51958581124336, 12.689524866457628, -0.17091347443453941, -3.6670949504699366, 24.095762743552907, -1.817698604165097, 19.714726142636035, 7.947152865722509, 10.63840692376896, -4.976918402037533, 14.777823729180865, 20.164931911751115, 11.41293842514205, 12.9780821244309, 25.16044583010282, 6.503300424970803, 4.433980759301201, 6.914063410323009, 27.21037816695369, 13.778741547003575, 22.617398526580626, 13.872131135750676, 16.913089680378864, 22.890271413003617, -17.425545763449353, 20.78541494769643, 3.6774699889197255, 11.65627201839986, 49.31913868919128, 15.674475060737096, -3.6938755664109397, 11.371295959560456, 6.233718430939492, 21.095450044322895, 21.970696464696548, -23.940997422919637, 11.086774629553307, 10.152954193521417, 19.7852156187012, -8.418276245967704, 5.706901250813882, 7.847621005947079, -0.42304298323735323, -0.5650277369038771, 11.192011339749547, 13.067049008406109, 15.3061134197944, 3.6245863743054576, 13.414957772801705, 13.010016796363471, 36.84823334953351, 12.631770080654952], "episode_lengths": [295, 795, 1090, 1117, 645, 746, 1059, 730, 654, 945, 945, 409, 1117, 678, 674, 801, 635, 295, 1117, 567, 1117, 1086, 295, 1117, 1117, 1117, 763, 357, 1117, 1117, 467, 463, 1117, 1117, 706, 373, 653, 273, 260, 1117, 269, 440, 1117, 761, 1117, 799, 938, 373, 744, 295, 865, 872, 1117, 864, 1117, 948, 1117, 521, 1117, 1117, 1117, 295, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 863, 1117, 1064, 1117, 1117, 1117, 1117, 1117, 794, 1117, 1117, 959, 947, 269, 1117, 455, 1117, 1117, 1037, 893, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.010192684294367, "mean_inference_ms": 6.9078014506320695, "mean_action_processing_ms": 0.4921737179470768, "mean_env_wait_ms": 21.194153973256654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013301610946655273, "StateBufferConnector_ms": 0.012047767639160156, "ViewRequirementAgentConnector_ms": 0.6830596923828125}}, "episode_reward_max": 49.31913868919128, "episode_reward_min": -24.729344023488334, "episode_reward_mean": 7.410455854811102, "episode_len_mean": 870.91, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.511729982064587, -6.6932614783253905, 6.921726946844533, 18.37919070440557, -3.745252126209733, -6.325669449630329, 16.133211714100714, -4.274988334382667, -0.404396623296561, 5.929763112185331, 8.366214106957992, -0.3336007832033149, 20.10076941321351, -24.729344023488334, -4.45430530279389, -18.339829076111474, -13.851418209739455, 6.4601881065848294, 5.966191444281838, -11.133619691408382, 19.445136491596156, 12.172141958615052, 6.937822260130912, 16.821356728864455, 7.7513021142723, 19.636808866704175, -3.5934268837334886, 0.1902392288913124, 25.308054252543567, 16.602586413535217, 0.8325232650397192, -9.209189971140997, 14.670331527947994, 7.798604845090303, -3.049806092607924, 4.463028693074987, -14.094087796543644, -2.7542538510410823, -12.633319103229223, 3.7072055793841985, 13.650386045681342, -10.641790260778661, 9.442369498608253, -1.1683645410404548, 22.029852108254094, -1.679830582257715, 7.80926597010348, 7.525856550227299, 10.51958581124336, 12.689524866457628, -0.17091347443453941, -3.6670949504699366, 24.095762743552907, -1.817698604165097, 19.714726142636035, 7.947152865722509, 10.63840692376896, -4.976918402037533, 14.777823729180865, 20.164931911751115, 11.41293842514205, 12.9780821244309, 25.16044583010282, 6.503300424970803, 4.433980759301201, 6.914063410323009, 27.21037816695369, 13.778741547003575, 22.617398526580626, 13.872131135750676, 16.913089680378864, 22.890271413003617, -17.425545763449353, 20.78541494769643, 3.6774699889197255, 11.65627201839986, 49.31913868919128, 15.674475060737096, -3.6938755664109397, 11.371295959560456, 6.233718430939492, 21.095450044322895, 21.970696464696548, -23.940997422919637, 11.086774629553307, 10.152954193521417, 19.7852156187012, -8.418276245967704, 5.706901250813882, 7.847621005947079, -0.42304298323735323, -0.5650277369038771, 11.192011339749547, 13.067049008406109, 15.3061134197944, 3.6245863743054576, 13.414957772801705, 13.010016796363471, 36.84823334953351, 12.631770080654952], "episode_lengths": [295, 795, 1090, 1117, 645, 746, 1059, 730, 654, 945, 945, 409, 1117, 678, 674, 801, 635, 295, 1117, 567, 1117, 1086, 295, 1117, 1117, 1117, 763, 357, 1117, 1117, 467, 463, 1117, 1117, 706, 373, 653, 273, 260, 1117, 269, 440, 1117, 761, 1117, 799, 938, 373, 744, 295, 865, 872, 1117, 864, 1117, 948, 1117, 521, 1117, 1117, 1117, 295, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 863, 1117, 1064, 1117, 1117, 1117, 1117, 1117, 794, 1117, 1117, 959, 947, 269, 1117, 455, 1117, 1117, 1037, 893, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.010192684294367, "mean_inference_ms": 6.9078014506320695, "mean_action_processing_ms": 0.4921737179470768, "mean_env_wait_ms": 21.194153973256654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013301610946655273, "StateBufferConnector_ms": 0.012047767639160156, "ViewRequirementAgentConnector_ms": 0.6830596923828125}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165510, "num_agent_steps_trained": 165510, "num_env_steps_sampled": 165510, "num_env_steps_trained": 165510, "num_env_steps_sampled_this_iter": 13850, "num_env_steps_trained_this_iter": 13850, "num_env_steps_sampled_throughput_per_sec": 232.89665704066934, "num_env_steps_trained_throughput_per_sec": 232.89665704066934, "timesteps_total": 165510, "num_steps_trained_this_iter": 13850, "agent_timesteps_total": 165510, "timers": {"training_iteration_time_ms": 50529.379, "sample_time_ms": 34318.997, "load_time_ms": 2141.493, "load_throughput": 5172.654, "learn_time_ms": 13515.477, "learn_throughput": 819.594, "synch_weights_time_ms": 460.989}, "counters": {"num_env_steps_sampled": 165510, "num_env_steps_trained": 165510, "num_agent_steps_sampled": 165510, "num_agent_steps_trained": 165510}, "done": false, "episodes_total": 239, "training_iteration": 17, "trial_id": "837cb_00000", "date": "2025-06-07_17-38-38", "timestamp": 1749310718, "time_this_iter_s": 59.49273085594177, "time_total_s": 777.3893809318542, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 777.3893809318542, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 64.25428571428571, "ram_util_percent": 82.37428571428572, "gpu_util_percent0": 0.2072857142857143, "vram_util_percent0": 0.96728515625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.834490000000003e-05, "total_loss": -0.140300150905144, "policy_loss": -0.02516638383070434, "vf_loss": 0.0626912977459142, "vf_explained_var": 0.8553374703973532, "kl": 0.010455865035616322, "entropy": 14.6737950305144, "entropy_coeff": 0.00917245}, "model": {}, "num_grad_updates_lifetime": 6060.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 179157, "num_env_steps_trained": 179157, "num_agent_steps_sampled": 179157, "num_agent_steps_trained": 179157}, "sampler_results": {"episode_reward_max": 49.31913868919128, "episode_reward_min": -23.940997422919637, "episode_reward_mean": 9.273605622925672, "episode_len_mean": 895.13, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.45430530279389, -18.339829076111474, -13.851418209739455, 6.4601881065848294, 5.966191444281838, -11.133619691408382, 19.445136491596156, 12.172141958615052, 6.937822260130912, 16.821356728864455, 7.7513021142723, 19.636808866704175, -3.5934268837334886, 0.1902392288913124, 25.308054252543567, 16.602586413535217, 0.8325232650397192, -9.209189971140997, 14.670331527947994, 7.798604845090303, -3.049806092607924, 4.463028693074987, -14.094087796543644, -2.7542538510410823, -12.633319103229223, 3.7072055793841985, 13.650386045681342, -10.641790260778661, 9.442369498608253, -1.1683645410404548, 22.029852108254094, -1.679830582257715, 7.80926597010348, 7.525856550227299, 10.51958581124336, 12.689524866457628, -0.17091347443453941, -3.6670949504699366, 24.095762743552907, -1.817698604165097, 19.714726142636035, 7.947152865722509, 10.63840692376896, -4.976918402037533, 14.777823729180865, 20.164931911751115, 11.41293842514205, 12.9780821244309, 25.16044583010282, 6.503300424970803, 4.433980759301201, 6.914063410323009, 27.21037816695369, 13.778741547003575, 22.617398526580626, 13.872131135750676, 16.913089680378864, 22.890271413003617, -17.425545763449353, 20.78541494769643, 3.6774699889197255, 11.65627201839986, 49.31913868919128, 15.674475060737096, -3.6938755664109397, 11.371295959560456, 6.233718430939492, 21.095450044322895, 21.970696464696548, -23.940997422919637, 11.086774629553307, 10.152954193521417, 19.7852156187012, -8.418276245967704, 5.706901250813882, 7.847621005947079, -0.42304298323735323, -0.5650277369038771, 11.192011339749547, 13.067049008406109, 15.3061134197944, 3.6245863743054576, 13.414957772801705, 13.010016796363471, 36.84823334953351, 12.631770080654952, 46.38489872504674, 18.106448856160902, 7.4366632657886065, 23.173345110442067, -9.816556468748216, 24.754069113816715, 46.96243750244714, 23.621801845307346, 25.8944100222414, 16.643400859040565, 8.170068024191805, -15.587494053597277, 1.5720114182185836, 11.835565752336482], "episode_lengths": [674, 801, 635, 295, 1117, 567, 1117, 1086, 295, 1117, 1117, 1117, 763, 357, 1117, 1117, 467, 463, 1117, 1117, 706, 373, 653, 273, 260, 1117, 269, 440, 1117, 761, 1117, 799, 938, 373, 744, 295, 865, 872, 1117, 864, 1117, 948, 1117, 521, 1117, 1117, 1117, 295, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 863, 1117, 1064, 1117, 1117, 1117, 1117, 1117, 794, 1117, 1117, 959, 947, 269, 1117, 455, 1117, 1117, 1037, 893, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 769, 296, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.037018332525827, "mean_inference_ms": 6.925180146954196, "mean_action_processing_ms": 0.49374194542079286, "mean_env_wait_ms": 21.313203479376075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016351938247680664, "StateBufferConnector_ms": 0.021153688430786133, "ViewRequirementAgentConnector_ms": 0.7047460079193115}}, "episode_reward_max": 49.31913868919128, "episode_reward_min": -23.940997422919637, "episode_reward_mean": 9.273605622925672, "episode_len_mean": 895.13, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.45430530279389, -18.339829076111474, -13.851418209739455, 6.4601881065848294, 5.966191444281838, -11.133619691408382, 19.445136491596156, 12.172141958615052, 6.937822260130912, 16.821356728864455, 7.7513021142723, 19.636808866704175, -3.5934268837334886, 0.1902392288913124, 25.308054252543567, 16.602586413535217, 0.8325232650397192, -9.209189971140997, 14.670331527947994, 7.798604845090303, -3.049806092607924, 4.463028693074987, -14.094087796543644, -2.7542538510410823, -12.633319103229223, 3.7072055793841985, 13.650386045681342, -10.641790260778661, 9.442369498608253, -1.1683645410404548, 22.029852108254094, -1.679830582257715, 7.80926597010348, 7.525856550227299, 10.51958581124336, 12.689524866457628, -0.17091347443453941, -3.6670949504699366, 24.095762743552907, -1.817698604165097, 19.714726142636035, 7.947152865722509, 10.63840692376896, -4.976918402037533, 14.777823729180865, 20.164931911751115, 11.41293842514205, 12.9780821244309, 25.16044583010282, 6.503300424970803, 4.433980759301201, 6.914063410323009, 27.21037816695369, 13.778741547003575, 22.617398526580626, 13.872131135750676, 16.913089680378864, 22.890271413003617, -17.425545763449353, 20.78541494769643, 3.6774699889197255, 11.65627201839986, 49.31913868919128, 15.674475060737096, -3.6938755664109397, 11.371295959560456, 6.233718430939492, 21.095450044322895, 21.970696464696548, -23.940997422919637, 11.086774629553307, 10.152954193521417, 19.7852156187012, -8.418276245967704, 5.706901250813882, 7.847621005947079, -0.42304298323735323, -0.5650277369038771, 11.192011339749547, 13.067049008406109, 15.3061134197944, 3.6245863743054576, 13.414957772801705, 13.010016796363471, 36.84823334953351, 12.631770080654952, 46.38489872504674, 18.106448856160902, 7.4366632657886065, 23.173345110442067, -9.816556468748216, 24.754069113816715, 46.96243750244714, 23.621801845307346, 25.8944100222414, 16.643400859040565, 8.170068024191805, -15.587494053597277, 1.5720114182185836, 11.835565752336482], "episode_lengths": [674, 801, 635, 295, 1117, 567, 1117, 1086, 295, 1117, 1117, 1117, 763, 357, 1117, 1117, 467, 463, 1117, 1117, 706, 373, 653, 273, 260, 1117, 269, 440, 1117, 761, 1117, 799, 938, 373, 744, 295, 865, 872, 1117, 864, 1117, 948, 1117, 521, 1117, 1117, 1117, 295, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 863, 1117, 1064, 1117, 1117, 1117, 1117, 1117, 794, 1117, 1117, 959, 947, 269, 1117, 455, 1117, 1117, 1037, 893, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 769, 296, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.037018332525827, "mean_inference_ms": 6.925180146954196, "mean_action_processing_ms": 0.49374194542079286, "mean_env_wait_ms": 21.313203479376075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016351938247680664, "StateBufferConnector_ms": 0.021153688430786133, "ViewRequirementAgentConnector_ms": 0.7047460079193115}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179157, "num_agent_steps_trained": 179157, "num_env_steps_sampled": 179157, "num_env_steps_trained": 179157, "num_env_steps_sampled_this_iter": 13647, "num_env_steps_trained_this_iter": 13647, "num_env_steps_sampled_throughput_per_sec": 227.1698369531785, "num_env_steps_trained_throughput_per_sec": 227.1698369531785, "timesteps_total": 179157, "num_steps_trained_this_iter": 13647, "agent_timesteps_total": 179157, "timers": {"training_iteration_time_ms": 52434.55, "sample_time_ms": 35070.903, "load_time_ms": 2202.667, "load_throughput": 5255.81, "learn_time_ms": 14609.21, "learn_throughput": 792.432, "synch_weights_time_ms": 458.634}, "counters": {"num_env_steps_sampled": 179157, "num_env_steps_trained": 179157, "num_agent_steps_sampled": 179157, "num_agent_steps_trained": 179157}, "done": false, "episodes_total": 253, "training_iteration": 18, "trial_id": "837cb_00000", "date": "2025-06-07_17-39-38", "timestamp": 1749310778, "time_this_iter_s": 60.09499382972717, "time_total_s": 837.4843747615814, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 837.4843747615814, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 64.66857142857143, "ram_util_percent": 81.68857142857146, "gpu_util_percent0": 0.20342857142857143, "vram_util_percent0": 0.96728515625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.820843000000002e-05, "total_loss": -0.13196842266615325, "policy_loss": -0.017147782205785108, "vf_loss": 0.0628176311444905, "vf_explained_var": 0.8247214534547593, "kl": 0.00928928160115134, "entropy": 14.74553465101454, "entropy_coeff": 0.009104215000000002}, "model": {}, "num_grad_updates_lifetime": 6525.5, "diff_num_grad_updates_vs_sampler_policy": 224.5}}, "num_env_steps_sampled": 191759, "num_env_steps_trained": 191759, "num_agent_steps_sampled": 191759, "num_agent_steps_trained": 191759}, "sampler_results": {"episode_reward_max": 49.31913868919128, "episode_reward_min": -23.940997422919637, "episode_reward_mean": 10.361321012266426, "episode_len_mean": 910.57, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.308054252543567, 16.602586413535217, 0.8325232650397192, -9.209189971140997, 14.670331527947994, 7.798604845090303, -3.049806092607924, 4.463028693074987, -14.094087796543644, -2.7542538510410823, -12.633319103229223, 3.7072055793841985, 13.650386045681342, -10.641790260778661, 9.442369498608253, -1.1683645410404548, 22.029852108254094, -1.679830582257715, 7.80926597010348, 7.525856550227299, 10.51958581124336, 12.689524866457628, -0.17091347443453941, -3.6670949504699366, 24.095762743552907, -1.817698604165097, 19.714726142636035, 7.947152865722509, 10.63840692376896, -4.976918402037533, 14.777823729180865, 20.164931911751115, 11.41293842514205, 12.9780821244309, 25.16044583010282, 6.503300424970803, 4.433980759301201, 6.914063410323009, 27.21037816695369, 13.778741547003575, 22.617398526580626, 13.872131135750676, 16.913089680378864, 22.890271413003617, -17.425545763449353, 20.78541494769643, 3.6774699889197255, 11.65627201839986, 49.31913868919128, 15.674475060737096, -3.6938755664109397, 11.371295959560456, 6.233718430939492, 21.095450044322895, 21.970696464696548, -23.940997422919637, 11.086774629553307, 10.152954193521417, 19.7852156187012, -8.418276245967704, 5.706901250813882, 7.847621005947079, -0.42304298323735323, -0.5650277369038771, 11.192011339749547, 13.067049008406109, 15.3061134197944, 3.6245863743054576, 13.414957772801705, 13.010016796363471, 36.84823334953351, 12.631770080654952, 46.38489872504674, 18.106448856160902, 7.4366632657886065, 23.173345110442067, -9.816556468748216, 24.754069113816715, 46.96243750244714, 23.621801845307346, 25.8944100222414, 16.643400859040565, 8.170068024191805, -15.587494053597277, 1.5720114182185836, 11.835565752336482, 4.7737138179110365, 20.233095834971017, 3.871164997262838, 23.981400154857006, 26.60574132607797, 0.34928586483727614, 16.658569056524705, -10.82565098883922, 21.934266025312763, 31.43826679888789, 3.879259985686914, 29.478537245504373, -21.330261029619937, 1.7327378808553608], "episode_lengths": [1117, 1117, 467, 463, 1117, 1117, 706, 373, 653, 273, 260, 1117, 269, 440, 1117, 761, 1117, 799, 938, 373, 744, 295, 865, 872, 1117, 864, 1117, 948, 1117, 521, 1117, 1117, 1117, 295, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 863, 1117, 1064, 1117, 1117, 1117, 1117, 1117, 794, 1117, 1117, 959, 947, 269, 1117, 455, 1117, 1117, 1037, 893, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 769, 296, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 443, 1117, 1117, 1117, 1117, 399, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0654315350035453, "mean_inference_ms": 6.94175080149341, "mean_action_processing_ms": 0.4952112287791206, "mean_env_wait_ms": 21.428844350826516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017673492431640625, "StateBufferConnector_ms": 0.020779848098754883, "ViewRequirementAgentConnector_ms": 0.7430949211120605}}, "episode_reward_max": 49.31913868919128, "episode_reward_min": -23.940997422919637, "episode_reward_mean": 10.361321012266426, "episode_len_mean": 910.57, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.308054252543567, 16.602586413535217, 0.8325232650397192, -9.209189971140997, 14.670331527947994, 7.798604845090303, -3.049806092607924, 4.463028693074987, -14.094087796543644, -2.7542538510410823, -12.633319103229223, 3.7072055793841985, 13.650386045681342, -10.641790260778661, 9.442369498608253, -1.1683645410404548, 22.029852108254094, -1.679830582257715, 7.80926597010348, 7.525856550227299, 10.51958581124336, 12.689524866457628, -0.17091347443453941, -3.6670949504699366, 24.095762743552907, -1.817698604165097, 19.714726142636035, 7.947152865722509, 10.63840692376896, -4.976918402037533, 14.777823729180865, 20.164931911751115, 11.41293842514205, 12.9780821244309, 25.16044583010282, 6.503300424970803, 4.433980759301201, 6.914063410323009, 27.21037816695369, 13.778741547003575, 22.617398526580626, 13.872131135750676, 16.913089680378864, 22.890271413003617, -17.425545763449353, 20.78541494769643, 3.6774699889197255, 11.65627201839986, 49.31913868919128, 15.674475060737096, -3.6938755664109397, 11.371295959560456, 6.233718430939492, 21.095450044322895, 21.970696464696548, -23.940997422919637, 11.086774629553307, 10.152954193521417, 19.7852156187012, -8.418276245967704, 5.706901250813882, 7.847621005947079, -0.42304298323735323, -0.5650277369038771, 11.192011339749547, 13.067049008406109, 15.3061134197944, 3.6245863743054576, 13.414957772801705, 13.010016796363471, 36.84823334953351, 12.631770080654952, 46.38489872504674, 18.106448856160902, 7.4366632657886065, 23.173345110442067, -9.816556468748216, 24.754069113816715, 46.96243750244714, 23.621801845307346, 25.8944100222414, 16.643400859040565, 8.170068024191805, -15.587494053597277, 1.5720114182185836, 11.835565752336482, 4.7737138179110365, 20.233095834971017, 3.871164997262838, 23.981400154857006, 26.60574132607797, 0.34928586483727614, 16.658569056524705, -10.82565098883922, 21.934266025312763, 31.43826679888789, 3.879259985686914, 29.478537245504373, -21.330261029619937, 1.7327378808553608], "episode_lengths": [1117, 1117, 467, 463, 1117, 1117, 706, 373, 653, 273, 260, 1117, 269, 440, 1117, 761, 1117, 799, 938, 373, 744, 295, 865, 872, 1117, 864, 1117, 948, 1117, 521, 1117, 1117, 1117, 295, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 863, 1117, 1064, 1117, 1117, 1117, 1117, 1117, 794, 1117, 1117, 959, 947, 269, 1117, 455, 1117, 1117, 1037, 893, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 769, 296, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 443, 1117, 1117, 1117, 1117, 399, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0654315350035453, "mean_inference_ms": 6.94175080149341, "mean_action_processing_ms": 0.4952112287791206, "mean_env_wait_ms": 21.428844350826516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017673492431640625, "StateBufferConnector_ms": 0.020779848098754883, "ViewRequirementAgentConnector_ms": 0.7430949211120605}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191759, "num_agent_steps_trained": 191759, "num_env_steps_sampled": 191759, "num_env_steps_trained": 191759, "num_env_steps_sampled_this_iter": 12602, "num_env_steps_trained_this_iter": 12602, "num_env_steps_sampled_throughput_per_sec": 226.8974495893782, "num_env_steps_trained_throughput_per_sec": 226.8974495893782, "timesteps_total": 191759, "num_steps_trained_this_iter": 12602, "agent_timesteps_total": 191759, "timers": {"training_iteration_time_ms": 54328.708, "sample_time_ms": 35703.489, "load_time_ms": 2279.267, "load_throughput": 5301.835, "learn_time_ms": 15794.599, "learn_throughput": 765.091, "synch_weights_time_ms": 453.517}, "counters": {"num_env_steps_sampled": 191759, "num_env_steps_trained": 191759, "num_agent_steps_sampled": 191759, "num_agent_steps_trained": 191759}, "done": false, "episodes_total": 267, "training_iteration": 19, "trial_id": "837cb_00000", "date": "2025-06-07_17-40-33", "timestamp": 1749310833, "time_this_iter_s": 55.5594916343689, "time_total_s": 893.0438663959503, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 893.0438663959503, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 61.94242424242423, "ram_util_percent": 81.66666666666667, "gpu_util_percent0": 0.193030303030303, "vram_util_percent0": 0.96728515625}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2.8654977639147274, "episode_reward_min": -4.07856950559815, "episode_reward_mean": -3.352651265925666, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.07856950559815, -3.6940599161960157, -3.222409295620621, -2.9027198482988177, -2.8654977639147274], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.707938234162421, "mean_inference_ms": 3.62274285440274, "mean_action_processing_ms": 0.2865642390129425, "mean_env_wait_ms": 12.826970451102188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020003318786621094, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.24891376495361328}}, "episode_reward_max": -2.8654977639147274, "episode_reward_min": -4.07856950559815, "episode_reward_mean": -3.352651265925666, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.07856950559815, -3.6940599161960157, -3.222409295620621, -2.9027198482988177, -2.8654977639147274], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.707938234162421, "mean_inference_ms": 3.62274285440274, "mean_action_processing_ms": 0.2865642390129425, "mean_env_wait_ms": 12.826970451102188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020003318786621094, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.24891376495361328}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.808241e-05, "total_loss": -0.12643177729289704, "policy_loss": -0.012594071098741283, "vf_loss": 0.06452348014270817, "vf_explained_var": 0.8603999998834398, "kl": 0.010819302788392859, "entropy": 14.806760745578343, "entropy_coeff": 0.009041204999999998}, "model": {}, "num_grad_updates_lifetime": 7020.5, "diff_num_grad_updates_vs_sampler_policy": 269.5}}, "num_env_steps_sampled": 206956, "num_env_steps_trained": 206956, "num_agent_steps_sampled": 206956, "num_agent_steps_trained": 206956}, "sampler_results": {"episode_reward_max": 49.31913868919128, "episode_reward_min": -23.940997422919637, "episode_reward_mean": 12.329779670640143, "episode_len_mean": 956.48, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.1683645410404548, 22.029852108254094, -1.679830582257715, 7.80926597010348, 7.525856550227299, 10.51958581124336, 12.689524866457628, -0.17091347443453941, -3.6670949504699366, 24.095762743552907, -1.817698604165097, 19.714726142636035, 7.947152865722509, 10.63840692376896, -4.976918402037533, 14.777823729180865, 20.164931911751115, 11.41293842514205, 12.9780821244309, 25.16044583010282, 6.503300424970803, 4.433980759301201, 6.914063410323009, 27.21037816695369, 13.778741547003575, 22.617398526580626, 13.872131135750676, 16.913089680378864, 22.890271413003617, -17.425545763449353, 20.78541494769643, 3.6774699889197255, 11.65627201839986, 49.31913868919128, 15.674475060737096, -3.6938755664109397, 11.371295959560456, 6.233718430939492, 21.095450044322895, 21.970696464696548, -23.940997422919637, 11.086774629553307, 10.152954193521417, 19.7852156187012, -8.418276245967704, 5.706901250813882, 7.847621005947079, -0.42304298323735323, -0.5650277369038771, 11.192011339749547, 13.067049008406109, 15.3061134197944, 3.6245863743054576, 13.414957772801705, 13.010016796363471, 36.84823334953351, 12.631770080654952, 46.38489872504674, 18.106448856160902, 7.4366632657886065, 23.173345110442067, -9.816556468748216, 24.754069113816715, 46.96243750244714, 23.621801845307346, 25.8944100222414, 16.643400859040565, 8.170068024191805, -15.587494053597277, 1.5720114182185836, 11.835565752336482, 4.7737138179110365, 20.233095834971017, 3.871164997262838, 23.981400154857006, 26.60574132607797, 0.34928586483727614, 16.658569056524705, -10.82565098883922, 21.934266025312763, 31.43826679888789, 3.879259985686914, 29.478537245504373, -21.330261029619937, 1.7327378808553608, 24.145970938977776, 15.880791897310568, 11.605484225144536, 18.405577536291055, 22.376016181404403, -11.51169468948848, 12.439785092489592, 17.0255356381309, 18.800254836374375, 28.56849867762346, 15.776305110682026, 45.78504711192493, 5.325956502411143, 1.6715388688323434, 14.643440954826852], "episode_lengths": [761, 1117, 799, 938, 373, 744, 295, 865, 872, 1117, 864, 1117, 948, 1117, 521, 1117, 1117, 1117, 295, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 863, 1117, 1064, 1117, 1117, 1117, 1117, 1117, 794, 1117, 1117, 959, 947, 269, 1117, 455, 1117, 1117, 1037, 893, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 769, 296, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 443, 1117, 1117, 1117, 1117, 399, 1117, 1117, 1117, 1117, 1117, 1117, 838, 1117, 1117, 1117, 1117, 1117, 1117, 91, 864, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.101323668014158, "mean_inference_ms": 6.967113160280534, "mean_action_processing_ms": 0.4974451100886055, "mean_env_wait_ms": 21.585954036379597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020888566970825195, "StateBufferConnector_ms": 0.023860692977905273, "ViewRequirementAgentConnector_ms": 0.8049578666687012}}, "episode_reward_max": 49.31913868919128, "episode_reward_min": -23.940997422919637, "episode_reward_mean": 12.329779670640143, "episode_len_mean": 956.48, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.1683645410404548, 22.029852108254094, -1.679830582257715, 7.80926597010348, 7.525856550227299, 10.51958581124336, 12.689524866457628, -0.17091347443453941, -3.6670949504699366, 24.095762743552907, -1.817698604165097, 19.714726142636035, 7.947152865722509, 10.63840692376896, -4.976918402037533, 14.777823729180865, 20.164931911751115, 11.41293842514205, 12.9780821244309, 25.16044583010282, 6.503300424970803, 4.433980759301201, 6.914063410323009, 27.21037816695369, 13.778741547003575, 22.617398526580626, 13.872131135750676, 16.913089680378864, 22.890271413003617, -17.425545763449353, 20.78541494769643, 3.6774699889197255, 11.65627201839986, 49.31913868919128, 15.674475060737096, -3.6938755664109397, 11.371295959560456, 6.233718430939492, 21.095450044322895, 21.970696464696548, -23.940997422919637, 11.086774629553307, 10.152954193521417, 19.7852156187012, -8.418276245967704, 5.706901250813882, 7.847621005947079, -0.42304298323735323, -0.5650277369038771, 11.192011339749547, 13.067049008406109, 15.3061134197944, 3.6245863743054576, 13.414957772801705, 13.010016796363471, 36.84823334953351, 12.631770080654952, 46.38489872504674, 18.106448856160902, 7.4366632657886065, 23.173345110442067, -9.816556468748216, 24.754069113816715, 46.96243750244714, 23.621801845307346, 25.8944100222414, 16.643400859040565, 8.170068024191805, -15.587494053597277, 1.5720114182185836, 11.835565752336482, 4.7737138179110365, 20.233095834971017, 3.871164997262838, 23.981400154857006, 26.60574132607797, 0.34928586483727614, 16.658569056524705, -10.82565098883922, 21.934266025312763, 31.43826679888789, 3.879259985686914, 29.478537245504373, -21.330261029619937, 1.7327378808553608, 24.145970938977776, 15.880791897310568, 11.605484225144536, 18.405577536291055, 22.376016181404403, -11.51169468948848, 12.439785092489592, 17.0255356381309, 18.800254836374375, 28.56849867762346, 15.776305110682026, 45.78504711192493, 5.325956502411143, 1.6715388688323434, 14.643440954826852], "episode_lengths": [761, 1117, 799, 938, 373, 744, 295, 865, 872, 1117, 864, 1117, 948, 1117, 521, 1117, 1117, 1117, 295, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 863, 1117, 1064, 1117, 1117, 1117, 1117, 1117, 794, 1117, 1117, 959, 947, 269, 1117, 455, 1117, 1117, 1037, 893, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 769, 296, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 443, 1117, 1117, 1117, 1117, 399, 1117, 1117, 1117, 1117, 1117, 1117, 838, 1117, 1117, 1117, 1117, 1117, 1117, 91, 864, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.101323668014158, "mean_inference_ms": 6.967113160280534, "mean_action_processing_ms": 0.4974451100886055, "mean_env_wait_ms": 21.585954036379597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020888566970825195, "StateBufferConnector_ms": 0.023860692977905273, "ViewRequirementAgentConnector_ms": 0.8049578666687012}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206956, "num_agent_steps_trained": 206956, "num_env_steps_sampled": 206956, "num_env_steps_trained": 206956, "num_env_steps_sampled_this_iter": 15197, "num_env_steps_trained_this_iter": 15197, "num_env_steps_sampled_throughput_per_sec": 219.1192135584099, "num_env_steps_trained_throughput_per_sec": 219.1192135584099, "timesteps_total": 206956, "num_steps_trained_this_iter": 15197, "agent_timesteps_total": 206956, "timers": {"training_iteration_time_ms": 57206.926, "sample_time_ms": 36885.872, "load_time_ms": 2600.448, "load_throughput": 4900.964, "learn_time_ms": 17154.949, "learn_throughput": 742.917, "synch_weights_time_ms": 461.434}, "counters": {"num_env_steps_sampled": 206956, "num_env_steps_trained": 206956, "num_agent_steps_sampled": 206956, "num_agent_steps_trained": 206956}, "done": false, "episodes_total": 282, "training_iteration": 20, "trial_id": "837cb_00000", "date": "2025-06-07_17-42-00", "timestamp": 1749310920, "time_this_iter_s": 86.50474953651428, "time_total_s": 979.5486159324646, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 979.5486159324646, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 57.382352941176464, "ram_util_percent": 83.94705882352943, "gpu_util_percent0": 0.1631372549019608, "vram_util_percent0": 0.9669532526552286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.793043999999998e-05, "total_loss": -0.09273104909384115, "policy_loss": 0.017925636140121656, "vf_loss": 0.07413298722187227, "vf_explained_var": 0.8484065051512285, "kl": 0.010834115709718484, "entropy": 14.899100404219194, "entropy_coeff": 0.008965219999999996}, "model": {}, "num_grad_updates_lifetime": 7565.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 222594, "num_env_steps_trained": 222594, "num_agent_steps_sampled": 222594, "num_agent_steps_trained": 222594}, "sampler_results": {"episode_reward_max": 49.31913868919128, "episode_reward_min": -23.940997422919637, "episode_reward_mean": 12.492891130245436, "episode_len_mean": 993.59, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.976918402037533, 14.777823729180865, 20.164931911751115, 11.41293842514205, 12.9780821244309, 25.16044583010282, 6.503300424970803, 4.433980759301201, 6.914063410323009, 27.21037816695369, 13.778741547003575, 22.617398526580626, 13.872131135750676, 16.913089680378864, 22.890271413003617, -17.425545763449353, 20.78541494769643, 3.6774699889197255, 11.65627201839986, 49.31913868919128, 15.674475060737096, -3.6938755664109397, 11.371295959560456, 6.233718430939492, 21.095450044322895, 21.970696464696548, -23.940997422919637, 11.086774629553307, 10.152954193521417, 19.7852156187012, -8.418276245967704, 5.706901250813882, 7.847621005947079, -0.42304298323735323, -0.5650277369038771, 11.192011339749547, 13.067049008406109, 15.3061134197944, 3.6245863743054576, 13.414957772801705, 13.010016796363471, 36.84823334953351, 12.631770080654952, 46.38489872504674, 18.106448856160902, 7.4366632657886065, 23.173345110442067, -9.816556468748216, 24.754069113816715, 46.96243750244714, 23.621801845307346, 25.8944100222414, 16.643400859040565, 8.170068024191805, -15.587494053597277, 1.5720114182185836, 11.835565752336482, 4.7737138179110365, 20.233095834971017, 3.871164997262838, 23.981400154857006, 26.60574132607797, 0.34928586483727614, 16.658569056524705, -10.82565098883922, 21.934266025312763, 31.43826679888789, 3.879259985686914, 29.478537245504373, -21.330261029619937, 1.7327378808553608, 24.145970938977776, 15.880791897310568, 11.605484225144536, 18.405577536291055, 22.376016181404403, -11.51169468948848, 12.439785092489592, 17.0255356381309, 18.800254836374375, 28.56849867762346, 15.776305110682026, 45.78504711192493, 5.325956502411143, 1.6715388688323434, 14.643440954826852, -9.011577220186776, 35.22688752463175, -2.1019062776234643, -0.38374780927192664, 12.94200529255129, 1.8802376799454483, -18.17853937407925, 27.042762435029353, 16.17516225658545, 21.972320933960706, -6.440564141975782, 27.027053730524404, 22.6809915321953, 1.9462912278415594], "episode_lengths": [521, 1117, 1117, 1117, 295, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 863, 1117, 1064, 1117, 1117, 1117, 1117, 1117, 794, 1117, 1117, 959, 947, 269, 1117, 455, 1117, 1117, 1037, 893, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 769, 296, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 443, 1117, 1117, 1117, 1117, 399, 1117, 1117, 1117, 1117, 1117, 1117, 838, 1117, 1117, 1117, 1117, 1117, 1117, 91, 864, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1455256525330033, "mean_inference_ms": 6.990763816730087, "mean_action_processing_ms": 0.49964558867584147, "mean_env_wait_ms": 21.747085779403598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025869131088256836, "StateBufferConnector_ms": 0.02438831329345703, "ViewRequirementAgentConnector_ms": 0.8383114337921143}}, "episode_reward_max": 49.31913868919128, "episode_reward_min": -23.940997422919637, "episode_reward_mean": 12.492891130245436, "episode_len_mean": 993.59, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-4.976918402037533, 14.777823729180865, 20.164931911751115, 11.41293842514205, 12.9780821244309, 25.16044583010282, 6.503300424970803, 4.433980759301201, 6.914063410323009, 27.21037816695369, 13.778741547003575, 22.617398526580626, 13.872131135750676, 16.913089680378864, 22.890271413003617, -17.425545763449353, 20.78541494769643, 3.6774699889197255, 11.65627201839986, 49.31913868919128, 15.674475060737096, -3.6938755664109397, 11.371295959560456, 6.233718430939492, 21.095450044322895, 21.970696464696548, -23.940997422919637, 11.086774629553307, 10.152954193521417, 19.7852156187012, -8.418276245967704, 5.706901250813882, 7.847621005947079, -0.42304298323735323, -0.5650277369038771, 11.192011339749547, 13.067049008406109, 15.3061134197944, 3.6245863743054576, 13.414957772801705, 13.010016796363471, 36.84823334953351, 12.631770080654952, 46.38489872504674, 18.106448856160902, 7.4366632657886065, 23.173345110442067, -9.816556468748216, 24.754069113816715, 46.96243750244714, 23.621801845307346, 25.8944100222414, 16.643400859040565, 8.170068024191805, -15.587494053597277, 1.5720114182185836, 11.835565752336482, 4.7737138179110365, 20.233095834971017, 3.871164997262838, 23.981400154857006, 26.60574132607797, 0.34928586483727614, 16.658569056524705, -10.82565098883922, 21.934266025312763, 31.43826679888789, 3.879259985686914, 29.478537245504373, -21.330261029619937, 1.7327378808553608, 24.145970938977776, 15.880791897310568, 11.605484225144536, 18.405577536291055, 22.376016181404403, -11.51169468948848, 12.439785092489592, 17.0255356381309, 18.800254836374375, 28.56849867762346, 15.776305110682026, 45.78504711192493, 5.325956502411143, 1.6715388688323434, 14.643440954826852, -9.011577220186776, 35.22688752463175, -2.1019062776234643, -0.38374780927192664, 12.94200529255129, 1.8802376799454483, -18.17853937407925, 27.042762435029353, 16.17516225658545, 21.972320933960706, -6.440564141975782, 27.027053730524404, 22.6809915321953, 1.9462912278415594], "episode_lengths": [521, 1117, 1117, 1117, 295, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 863, 1117, 1064, 1117, 1117, 1117, 1117, 1117, 794, 1117, 1117, 959, 947, 269, 1117, 455, 1117, 1117, 1037, 893, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 769, 296, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 443, 1117, 1117, 1117, 1117, 399, 1117, 1117, 1117, 1117, 1117, 1117, 838, 1117, 1117, 1117, 1117, 1117, 1117, 91, 864, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1455256525330033, "mean_inference_ms": 6.990763816730087, "mean_action_processing_ms": 0.49964558867584147, "mean_env_wait_ms": 21.747085779403598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025869131088256836, "StateBufferConnector_ms": 0.02438831329345703, "ViewRequirementAgentConnector_ms": 0.8383114337921143}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222594, "num_agent_steps_trained": 222594, "num_env_steps_sampled": 222594, "num_env_steps_trained": 222594, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 223.88385925587656, "num_env_steps_trained_throughput_per_sec": 223.88385925587656, "timesteps_total": 222594, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 222594, "timers": {"training_iteration_time_ms": 58905.521, "sample_time_ms": 37758.115, "load_time_ms": 2764.625, "load_throughput": 4755.618, "learn_time_ms": 17806.885, "learn_throughput": 738.338, "synch_weights_time_ms": 468.744}, "counters": {"num_env_steps_sampled": 222594, "num_env_steps_trained": 222594, "num_agent_steps_sampled": 222594, "num_agent_steps_trained": 222594}, "done": false, "episodes_total": 296, "training_iteration": 21, "trial_id": "837cb_00000", "date": "2025-06-07_17-43-10", "timestamp": 1749310990, "time_this_iter_s": 69.86971020698547, "time_total_s": 1049.41832613945, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1049.41832613945, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 64.82073170731708, "ram_util_percent": 87.490243902439, "gpu_util_percent0": 0.2069512195121951, "vram_util_percent0": 0.9662649263211381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.777406000000005e-05, "total_loss": -0.12614223092599647, "policy_loss": -0.01547403266080297, "vf_loss": 0.06878998681114844, "vf_explained_var": 0.8771415698986788, "kl": 0.010471556208890084, "entropy": 14.848568074519818, "entropy_coeff": 0.008887030000000002}, "model": {}, "num_grad_updates_lifetime": 8100.5, "diff_num_grad_updates_vs_sampler_policy": 259.5}}, "num_env_steps_sampled": 237234, "num_env_steps_trained": 237234, "num_agent_steps_sampled": 237234, "num_agent_steps_trained": 237234}, "sampler_results": {"episode_reward_max": 49.31913868919128, "episode_reward_min": -23.940997422919637, "episode_reward_mean": 12.998985145393055, "episode_len_mean": 1005.23, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.890271413003617, -17.425545763449353, 20.78541494769643, 3.6774699889197255, 11.65627201839986, 49.31913868919128, 15.674475060737096, -3.6938755664109397, 11.371295959560456, 6.233718430939492, 21.095450044322895, 21.970696464696548, -23.940997422919637, 11.086774629553307, 10.152954193521417, 19.7852156187012, -8.418276245967704, 5.706901250813882, 7.847621005947079, -0.42304298323735323, -0.5650277369038771, 11.192011339749547, 13.067049008406109, 15.3061134197944, 3.6245863743054576, 13.414957772801705, 13.010016796363471, 36.84823334953351, 12.631770080654952, 46.38489872504674, 18.106448856160902, 7.4366632657886065, 23.173345110442067, -9.816556468748216, 24.754069113816715, 46.96243750244714, 23.621801845307346, 25.8944100222414, 16.643400859040565, 8.170068024191805, -15.587494053597277, 1.5720114182185836, 11.835565752336482, 4.7737138179110365, 20.233095834971017, 3.871164997262838, 23.981400154857006, 26.60574132607797, 0.34928586483727614, 16.658569056524705, -10.82565098883922, 21.934266025312763, 31.43826679888789, 3.879259985686914, 29.478537245504373, -21.330261029619937, 1.7327378808553608, 24.145970938977776, 15.880791897310568, 11.605484225144536, 18.405577536291055, 22.376016181404403, -11.51169468948848, 12.439785092489592, 17.0255356381309, 18.800254836374375, 28.56849867762346, 15.776305110682026, 45.78504711192493, 5.325956502411143, 1.6715388688323434, 14.643440954826852, -9.011577220186776, 35.22688752463175, -2.1019062776234643, -0.38374780927192664, 12.94200529255129, 1.8802376799454483, -18.17853937407925, 27.042762435029353, 16.17516225658545, 21.972320933960706, -6.440564141975782, 27.027053730524404, 22.6809915321953, 1.9462912278415594, 22.541257770069237, -9.046140773072288, 19.486791764985306, 42.76031613623883, 43.57651338288178, 38.532246591913015, 19.364770939533084, -4.930595661983169, -11.718107144014114, 4.428286439498311, 4.393449589271773, 33.45012381021799, 20.698202607402106, 18.832673331652593], "episode_lengths": [1117, 863, 1117, 1064, 1117, 1117, 1117, 1117, 1117, 794, 1117, 1117, 959, 947, 269, 1117, 455, 1117, 1117, 1037, 893, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 769, 296, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 443, 1117, 1117, 1117, 1117, 399, 1117, 1117, 1117, 1117, 1117, 1117, 838, 1117, 1117, 1117, 1117, 1117, 1117, 91, 864, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 728, 1117, 1117, 1117, 1117, 1117, 760, 865, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1783579307827967, "mean_inference_ms": 7.006369649330143, "mean_action_processing_ms": 0.5011807934841882, "mean_env_wait_ms": 21.87247858241699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026678085327148438, "StateBufferConnector_ms": 0.027408838272094727, "ViewRequirementAgentConnector_ms": 0.829087495803833}}, "episode_reward_max": 49.31913868919128, "episode_reward_min": -23.940997422919637, "episode_reward_mean": 12.998985145393055, "episode_len_mean": 1005.23, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.890271413003617, -17.425545763449353, 20.78541494769643, 3.6774699889197255, 11.65627201839986, 49.31913868919128, 15.674475060737096, -3.6938755664109397, 11.371295959560456, 6.233718430939492, 21.095450044322895, 21.970696464696548, -23.940997422919637, 11.086774629553307, 10.152954193521417, 19.7852156187012, -8.418276245967704, 5.706901250813882, 7.847621005947079, -0.42304298323735323, -0.5650277369038771, 11.192011339749547, 13.067049008406109, 15.3061134197944, 3.6245863743054576, 13.414957772801705, 13.010016796363471, 36.84823334953351, 12.631770080654952, 46.38489872504674, 18.106448856160902, 7.4366632657886065, 23.173345110442067, -9.816556468748216, 24.754069113816715, 46.96243750244714, 23.621801845307346, 25.8944100222414, 16.643400859040565, 8.170068024191805, -15.587494053597277, 1.5720114182185836, 11.835565752336482, 4.7737138179110365, 20.233095834971017, 3.871164997262838, 23.981400154857006, 26.60574132607797, 0.34928586483727614, 16.658569056524705, -10.82565098883922, 21.934266025312763, 31.43826679888789, 3.879259985686914, 29.478537245504373, -21.330261029619937, 1.7327378808553608, 24.145970938977776, 15.880791897310568, 11.605484225144536, 18.405577536291055, 22.376016181404403, -11.51169468948848, 12.439785092489592, 17.0255356381309, 18.800254836374375, 28.56849867762346, 15.776305110682026, 45.78504711192493, 5.325956502411143, 1.6715388688323434, 14.643440954826852, -9.011577220186776, 35.22688752463175, -2.1019062776234643, -0.38374780927192664, 12.94200529255129, 1.8802376799454483, -18.17853937407925, 27.042762435029353, 16.17516225658545, 21.972320933960706, -6.440564141975782, 27.027053730524404, 22.6809915321953, 1.9462912278415594, 22.541257770069237, -9.046140773072288, 19.486791764985306, 42.76031613623883, 43.57651338288178, 38.532246591913015, 19.364770939533084, -4.930595661983169, -11.718107144014114, 4.428286439498311, 4.393449589271773, 33.45012381021799, 20.698202607402106, 18.832673331652593], "episode_lengths": [1117, 863, 1117, 1064, 1117, 1117, 1117, 1117, 1117, 794, 1117, 1117, 959, 947, 269, 1117, 455, 1117, 1117, 1037, 893, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 769, 296, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 443, 1117, 1117, 1117, 1117, 399, 1117, 1117, 1117, 1117, 1117, 1117, 838, 1117, 1117, 1117, 1117, 1117, 1117, 91, 864, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 728, 1117, 1117, 1117, 1117, 1117, 760, 865, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1783579307827967, "mean_inference_ms": 7.006369649330143, "mean_action_processing_ms": 0.5011807934841882, "mean_env_wait_ms": 21.87247858241699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026678085327148438, "StateBufferConnector_ms": 0.027408838272094727, "ViewRequirementAgentConnector_ms": 0.829087495803833}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237234, "num_agent_steps_trained": 237234, "num_env_steps_sampled": 237234, "num_env_steps_trained": 237234, "num_env_steps_sampled_this_iter": 14640, "num_env_steps_trained_this_iter": 14640, "num_env_steps_sampled_throughput_per_sec": 238.38015100535958, "num_env_steps_trained_throughput_per_sec": 238.38015100535958, "timesteps_total": 237234, "num_steps_trained_this_iter": 14640, "agent_timesteps_total": 237234, "timers": {"training_iteration_time_ms": 59715.685, "sample_time_ms": 38282.286, "load_time_ms": 2690.826, "load_throughput": 4990.959, "learn_time_ms": 18165.608, "learn_throughput": 739.298, "synch_weights_time_ms": 467.466}, "counters": {"num_env_steps_sampled": 237234, "num_env_steps_trained": 237234, "num_agent_steps_sampled": 237234, "num_agent_steps_trained": 237234}, "done": false, "episodes_total": 310, "training_iteration": 22, "trial_id": "837cb_00000", "date": "2025-06-07_17-44-12", "timestamp": 1749311052, "time_this_iter_s": 61.43552350997925, "time_total_s": 1110.8538496494293, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1110.8538496494293, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 64.66250000000001, "ram_util_percent": 90.70138888888889, "gpu_util_percent0": 0.20708333333333334, "vram_util_percent0": 0.9656575520833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.762766000000002e-05, "total_loss": -0.12960546657693786, "policy_loss": -0.016783301811217545, "vf_loss": 0.05876701897046027, "vf_explained_var": 0.8459708124399186, "kl": 0.011056936955174594, "entropy": 14.87926713686723, "entropy_coeff": 0.008813829999999998}, "model": {}, "num_grad_updates_lifetime": 8620.5, "diff_num_grad_updates_vs_sampler_policy": 259.5}}, "num_env_steps_sampled": 252024, "num_env_steps_trained": 252024, "num_agent_steps_sampled": 252024, "num_agent_steps_trained": 252024}, "sampler_results": {"episode_reward_max": 62.15984464619224, "episode_reward_min": -21.330261029619937, "episode_reward_mean": 14.067468901943716, "episode_len_mean": 1006.33, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.152954193521417, 19.7852156187012, -8.418276245967704, 5.706901250813882, 7.847621005947079, -0.42304298323735323, -0.5650277369038771, 11.192011339749547, 13.067049008406109, 15.3061134197944, 3.6245863743054576, 13.414957772801705, 13.010016796363471, 36.84823334953351, 12.631770080654952, 46.38489872504674, 18.106448856160902, 7.4366632657886065, 23.173345110442067, -9.816556468748216, 24.754069113816715, 46.96243750244714, 23.621801845307346, 25.8944100222414, 16.643400859040565, 8.170068024191805, -15.587494053597277, 1.5720114182185836, 11.835565752336482, 4.7737138179110365, 20.233095834971017, 3.871164997262838, 23.981400154857006, 26.60574132607797, 0.34928586483727614, 16.658569056524705, -10.82565098883922, 21.934266025312763, 31.43826679888789, 3.879259985686914, 29.478537245504373, -21.330261029619937, 1.7327378808553608, 24.145970938977776, 15.880791897310568, 11.605484225144536, 18.405577536291055, 22.376016181404403, -11.51169468948848, 12.439785092489592, 17.0255356381309, 18.800254836374375, 28.56849867762346, 15.776305110682026, 45.78504711192493, 5.325956502411143, 1.6715388688323434, 14.643440954826852, -9.011577220186776, 35.22688752463175, -2.1019062776234643, -0.38374780927192664, 12.94200529255129, 1.8802376799454483, -18.17853937407925, 27.042762435029353, 16.17516225658545, 21.972320933960706, -6.440564141975782, 27.027053730524404, 22.6809915321953, 1.9462912278415594, 22.541257770069237, -9.046140773072288, 19.486791764985306, 42.76031613623883, 43.57651338288178, 38.532246591913015, 19.364770939533084, -4.930595661983169, -11.718107144014114, 4.428286439498311, 4.393449589271773, 33.45012381021799, 20.698202607402106, 18.832673331652593, 2.9914544975922666, 4.774007242359001, 10.968246435137928, 4.001049884622845, 21.775163195994732, 30.426312605333678, 14.02344646846065, 20.08067616186425, -3.0602588291061026, 62.15984464619224, 12.237637841065052, 30.789086184310456, 26.166129961153892, 20.216138254326083], "episode_lengths": [269, 1117, 455, 1117, 1117, 1037, 893, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 769, 296, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 443, 1117, 1117, 1117, 1117, 399, 1117, 1117, 1117, 1117, 1117, 1117, 838, 1117, 1117, 1117, 1117, 1117, 1117, 91, 864, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 728, 1117, 1117, 1117, 1117, 1117, 760, 865, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 269, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2119714714942758, "mean_inference_ms": 7.017503559399862, "mean_action_processing_ms": 0.502245423517445, "mean_env_wait_ms": 21.9677592940347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02768111228942871, "StateBufferConnector_ms": 0.02838611602783203, "ViewRequirementAgentConnector_ms": 0.8473575115203857}}, "episode_reward_max": 62.15984464619224, "episode_reward_min": -21.330261029619937, "episode_reward_mean": 14.067468901943716, "episode_len_mean": 1006.33, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.152954193521417, 19.7852156187012, -8.418276245967704, 5.706901250813882, 7.847621005947079, -0.42304298323735323, -0.5650277369038771, 11.192011339749547, 13.067049008406109, 15.3061134197944, 3.6245863743054576, 13.414957772801705, 13.010016796363471, 36.84823334953351, 12.631770080654952, 46.38489872504674, 18.106448856160902, 7.4366632657886065, 23.173345110442067, -9.816556468748216, 24.754069113816715, 46.96243750244714, 23.621801845307346, 25.8944100222414, 16.643400859040565, 8.170068024191805, -15.587494053597277, 1.5720114182185836, 11.835565752336482, 4.7737138179110365, 20.233095834971017, 3.871164997262838, 23.981400154857006, 26.60574132607797, 0.34928586483727614, 16.658569056524705, -10.82565098883922, 21.934266025312763, 31.43826679888789, 3.879259985686914, 29.478537245504373, -21.330261029619937, 1.7327378808553608, 24.145970938977776, 15.880791897310568, 11.605484225144536, 18.405577536291055, 22.376016181404403, -11.51169468948848, 12.439785092489592, 17.0255356381309, 18.800254836374375, 28.56849867762346, 15.776305110682026, 45.78504711192493, 5.325956502411143, 1.6715388688323434, 14.643440954826852, -9.011577220186776, 35.22688752463175, -2.1019062776234643, -0.38374780927192664, 12.94200529255129, 1.8802376799454483, -18.17853937407925, 27.042762435029353, 16.17516225658545, 21.972320933960706, -6.440564141975782, 27.027053730524404, 22.6809915321953, 1.9462912278415594, 22.541257770069237, -9.046140773072288, 19.486791764985306, 42.76031613623883, 43.57651338288178, 38.532246591913015, 19.364770939533084, -4.930595661983169, -11.718107144014114, 4.428286439498311, 4.393449589271773, 33.45012381021799, 20.698202607402106, 18.832673331652593, 2.9914544975922666, 4.774007242359001, 10.968246435137928, 4.001049884622845, 21.775163195994732, 30.426312605333678, 14.02344646846065, 20.08067616186425, -3.0602588291061026, 62.15984464619224, 12.237637841065052, 30.789086184310456, 26.166129961153892, 20.216138254326083], "episode_lengths": [269, 1117, 455, 1117, 1117, 1037, 893, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 769, 296, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 443, 1117, 1117, 1117, 1117, 399, 1117, 1117, 1117, 1117, 1117, 1117, 838, 1117, 1117, 1117, 1117, 1117, 1117, 91, 864, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 728, 1117, 1117, 1117, 1117, 1117, 760, 865, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 269, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2119714714942758, "mean_inference_ms": 7.017503559399862, "mean_action_processing_ms": 0.502245423517445, "mean_env_wait_ms": 21.9677592940347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02768111228942871, "StateBufferConnector_ms": 0.02838611602783203, "ViewRequirementAgentConnector_ms": 0.8473575115203857}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252024, "num_agent_steps_trained": 252024, "num_env_steps_sampled": 252024, "num_env_steps_trained": 252024, "num_env_steps_sampled_this_iter": 14790, "num_env_steps_trained_this_iter": 14790, "num_env_steps_sampled_throughput_per_sec": 235.6721165605119, "num_env_steps_trained_throughput_per_sec": 235.6721165605119, "timesteps_total": 252024, "num_steps_trained_this_iter": 14790, "agent_timesteps_total": 252024, "timers": {"training_iteration_time_ms": 61905.189, "sample_time_ms": 38926.118, "load_time_ms": 2811.522, "load_throughput": 4977.909, "learn_time_ms": 19594.054, "learn_throughput": 714.273, "synch_weights_time_ms": 461.446}, "counters": {"num_env_steps_sampled": 252024, "num_env_steps_trained": 252024, "num_agent_steps_sampled": 252024, "num_agent_steps_trained": 252024}, "done": false, "episodes_total": 324, "training_iteration": 23, "trial_id": "837cb_00000", "date": "2025-06-07_17-45-14", "timestamp": 1749311114, "time_this_iter_s": 62.77269196510315, "time_total_s": 1173.6265416145325, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1173.6265416145325, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 63.86027397260274, "ram_util_percent": 90.31643835616437, "gpu_util_percent0": 0.2180821917808219, "vram_util_percent0": 0.9656575520833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.747976000000002e-05, "total_loss": -0.11136329393918541, "policy_loss": 0.0005388967362655835, "vf_loss": 0.0589686667682095, "vf_explained_var": 0.8710597225752744, "kl": 0.01140479677409749, "entropy": 14.90931070501154, "entropy_coeff": 0.00873988}, "model": {}, "num_grad_updates_lifetime": 9155.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 267662, "num_env_steps_trained": 267662, "num_agent_steps_sampled": 267662, "num_agent_steps_trained": 267662}, "sampler_results": {"episode_reward_max": 62.15984464619224, "episode_reward_min": -21.330261029619937, "episode_reward_mean": 16.393666853902108, "episode_len_mean": 1032.69, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.631770080654952, 46.38489872504674, 18.106448856160902, 7.4366632657886065, 23.173345110442067, -9.816556468748216, 24.754069113816715, 46.96243750244714, 23.621801845307346, 25.8944100222414, 16.643400859040565, 8.170068024191805, -15.587494053597277, 1.5720114182185836, 11.835565752336482, 4.7737138179110365, 20.233095834971017, 3.871164997262838, 23.981400154857006, 26.60574132607797, 0.34928586483727614, 16.658569056524705, -10.82565098883922, 21.934266025312763, 31.43826679888789, 3.879259985686914, 29.478537245504373, -21.330261029619937, 1.7327378808553608, 24.145970938977776, 15.880791897310568, 11.605484225144536, 18.405577536291055, 22.376016181404403, -11.51169468948848, 12.439785092489592, 17.0255356381309, 18.800254836374375, 28.56849867762346, 15.776305110682026, 45.78504711192493, 5.325956502411143, 1.6715388688323434, 14.643440954826852, -9.011577220186776, 35.22688752463175, -2.1019062776234643, -0.38374780927192664, 12.94200529255129, 1.8802376799454483, -18.17853937407925, 27.042762435029353, 16.17516225658545, 21.972320933960706, -6.440564141975782, 27.027053730524404, 22.6809915321953, 1.9462912278415594, 22.541257770069237, -9.046140773072288, 19.486791764985306, 42.76031613623883, 43.57651338288178, 38.532246591913015, 19.364770939533084, -4.930595661983169, -11.718107144014114, 4.428286439498311, 4.393449589271773, 33.45012381021799, 20.698202607402106, 18.832673331652593, 2.9914544975922666, 4.774007242359001, 10.968246435137928, 4.001049884622845, 21.775163195994732, 30.426312605333678, 14.02344646846065, 20.08067616186425, -3.0602588291061026, 62.15984464619224, 12.237637841065052, 30.789086184310456, 26.166129961153892, 20.216138254326083, 4.221084351567717, 32.90249834707747, 0.17129310502092698, 44.629677899196466, 50.791089605940854, 38.86417727291095, -19.923342783882052, 22.859394757141644, 58.29578624387922, -10.138450022142584, 26.523329916265133, 43.20883278998946, 29.49455589171574, 51.269180984987315], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 769, 296, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 443, 1117, 1117, 1117, 1117, 399, 1117, 1117, 1117, 1117, 1117, 1117, 838, 1117, 1117, 1117, 1117, 1117, 1117, 91, 864, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 728, 1117, 1117, 1117, 1117, 1117, 760, 865, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 269, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2468810039768146, "mean_inference_ms": 7.030097739898533, "mean_action_processing_ms": 0.5034213095068235, "mean_env_wait_ms": 22.063989121456792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029960155487060547, "StateBufferConnector_ms": 0.03293490409851074, "ViewRequirementAgentConnector_ms": 0.8838310241699219}}, "episode_reward_max": 62.15984464619224, "episode_reward_min": -21.330261029619937, "episode_reward_mean": 16.393666853902108, "episode_len_mean": 1032.69, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.631770080654952, 46.38489872504674, 18.106448856160902, 7.4366632657886065, 23.173345110442067, -9.816556468748216, 24.754069113816715, 46.96243750244714, 23.621801845307346, 25.8944100222414, 16.643400859040565, 8.170068024191805, -15.587494053597277, 1.5720114182185836, 11.835565752336482, 4.7737138179110365, 20.233095834971017, 3.871164997262838, 23.981400154857006, 26.60574132607797, 0.34928586483727614, 16.658569056524705, -10.82565098883922, 21.934266025312763, 31.43826679888789, 3.879259985686914, 29.478537245504373, -21.330261029619937, 1.7327378808553608, 24.145970938977776, 15.880791897310568, 11.605484225144536, 18.405577536291055, 22.376016181404403, -11.51169468948848, 12.439785092489592, 17.0255356381309, 18.800254836374375, 28.56849867762346, 15.776305110682026, 45.78504711192493, 5.325956502411143, 1.6715388688323434, 14.643440954826852, -9.011577220186776, 35.22688752463175, -2.1019062776234643, -0.38374780927192664, 12.94200529255129, 1.8802376799454483, -18.17853937407925, 27.042762435029353, 16.17516225658545, 21.972320933960706, -6.440564141975782, 27.027053730524404, 22.6809915321953, 1.9462912278415594, 22.541257770069237, -9.046140773072288, 19.486791764985306, 42.76031613623883, 43.57651338288178, 38.532246591913015, 19.364770939533084, -4.930595661983169, -11.718107144014114, 4.428286439498311, 4.393449589271773, 33.45012381021799, 20.698202607402106, 18.832673331652593, 2.9914544975922666, 4.774007242359001, 10.968246435137928, 4.001049884622845, 21.775163195994732, 30.426312605333678, 14.02344646846065, 20.08067616186425, -3.0602588291061026, 62.15984464619224, 12.237637841065052, 30.789086184310456, 26.166129961153892, 20.216138254326083, 4.221084351567717, 32.90249834707747, 0.17129310502092698, 44.629677899196466, 50.791089605940854, 38.86417727291095, -19.923342783882052, 22.859394757141644, 58.29578624387922, -10.138450022142584, 26.523329916265133, 43.20883278998946, 29.49455589171574, 51.269180984987315], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 769, 296, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 443, 1117, 1117, 1117, 1117, 399, 1117, 1117, 1117, 1117, 1117, 1117, 838, 1117, 1117, 1117, 1117, 1117, 1117, 91, 864, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 728, 1117, 1117, 1117, 1117, 1117, 760, 865, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 269, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2468810039768146, "mean_inference_ms": 7.030097739898533, "mean_action_processing_ms": 0.5034213095068235, "mean_env_wait_ms": 22.063989121456792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029960155487060547, "StateBufferConnector_ms": 0.03293490409851074, "ViewRequirementAgentConnector_ms": 0.8838310241699219}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 267662, "num_agent_steps_trained": 267662, "num_env_steps_sampled": 267662, "num_env_steps_trained": 267662, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 223.1586127523955, "num_env_steps_trained_throughput_per_sec": 223.1586127523955, "timesteps_total": 267662, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 267662, "timers": {"training_iteration_time_ms": 63529.741, "sample_time_ms": 39452.327, "load_time_ms": 3142.067, "load_throughput": 4579.978, "learn_time_ms": 20368.885, "learn_throughput": 706.499, "synch_weights_time_ms": 451.096}, "counters": {"num_env_steps_sampled": 267662, "num_env_steps_trained": 267662, "num_agent_steps_sampled": 267662, "num_agent_steps_trained": 267662}, "done": false, "episodes_total": 338, "training_iteration": 24, "trial_id": "837cb_00000", "date": "2025-06-07_17-46-25", "timestamp": 1749311185, "time_this_iter_s": 70.09175419807434, "time_total_s": 1243.7182958126068, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1243.7182958126068, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 65.9641975308642, "ram_util_percent": 91.11234567901234, "gpu_util_percent0": 0.20555555555555555, "vram_util_percent0": 0.9653963316615226}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.732337999999999e-05, "total_loss": -0.09309170543491332, "policy_loss": 0.01807636138284579, "vf_loss": 0.05946316488087177, "vf_explained_var": 0.8807646831599149, "kl": 0.012086143884517488, "entropy": 14.981187324523926, "entropy_coeff": 0.00866169}, "model": {}, "num_grad_updates_lifetime": 9705.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 283300, "num_env_steps_trained": 283300, "num_agent_steps_sampled": 283300, "num_agent_steps_trained": 283300}, "sampler_results": {"episode_reward_max": 70.62013390149508, "episode_reward_min": -21.330261029619937, "episode_reward_mean": 18.411954324355655, "episode_len_mean": 1052.6, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.835565752336482, 4.7737138179110365, 20.233095834971017, 3.871164997262838, 23.981400154857006, 26.60574132607797, 0.34928586483727614, 16.658569056524705, -10.82565098883922, 21.934266025312763, 31.43826679888789, 3.879259985686914, 29.478537245504373, -21.330261029619937, 1.7327378808553608, 24.145970938977776, 15.880791897310568, 11.605484225144536, 18.405577536291055, 22.376016181404403, -11.51169468948848, 12.439785092489592, 17.0255356381309, 18.800254836374375, 28.56849867762346, 15.776305110682026, 45.78504711192493, 5.325956502411143, 1.6715388688323434, 14.643440954826852, -9.011577220186776, 35.22688752463175, -2.1019062776234643, -0.38374780927192664, 12.94200529255129, 1.8802376799454483, -18.17853937407925, 27.042762435029353, 16.17516225658545, 21.972320933960706, -6.440564141975782, 27.027053730524404, 22.6809915321953, 1.9462912278415594, 22.541257770069237, -9.046140773072288, 19.486791764985306, 42.76031613623883, 43.57651338288178, 38.532246591913015, 19.364770939533084, -4.930595661983169, -11.718107144014114, 4.428286439498311, 4.393449589271773, 33.45012381021799, 20.698202607402106, 18.832673331652593, 2.9914544975922666, 4.774007242359001, 10.968246435137928, 4.001049884622845, 21.775163195994732, 30.426312605333678, 14.02344646846065, 20.08067616186425, -3.0602588291061026, 62.15984464619224, 12.237637841065052, 30.789086184310456, 26.166129961153892, 20.216138254326083, 4.221084351567717, 32.90249834707747, 0.17129310502092698, 44.629677899196466, 50.791089605940854, 38.86417727291095, -19.923342783882052, 22.859394757141644, 58.29578624387922, -10.138450022142584, 26.523329916265133, 43.20883278998946, 29.49455589171574, 51.269180984987315, 14.871506647644402, 60.23530324410488, 5.713240178394206, 23.54371441607694, 17.243890225781026, 2.4704775581145855, 62.269772309621146, 64.98743016976599, 13.422477670712507, 17.569295944793268, 37.763844615531795, 24.606965389828154, 16.457969074501605, 70.62013390149508], "episode_lengths": [1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 443, 1117, 1117, 1117, 1117, 399, 1117, 1117, 1117, 1117, 1117, 1117, 838, 1117, 1117, 1117, 1117, 1117, 1117, 91, 864, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 728, 1117, 1117, 1117, 1117, 1117, 760, 865, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 269, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.280211011491572, "mean_inference_ms": 7.044579540996337, "mean_action_processing_ms": 0.5046781827674885, "mean_env_wait_ms": 22.15974823544035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032854318618774414, "StateBufferConnector_ms": 0.031766414642333984, "ViewRequirementAgentConnector_ms": 0.9015371799468994}}, "episode_reward_max": 70.62013390149508, "episode_reward_min": -21.330261029619937, "episode_reward_mean": 18.411954324355655, "episode_len_mean": 1052.6, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [11.835565752336482, 4.7737138179110365, 20.233095834971017, 3.871164997262838, 23.981400154857006, 26.60574132607797, 0.34928586483727614, 16.658569056524705, -10.82565098883922, 21.934266025312763, 31.43826679888789, 3.879259985686914, 29.478537245504373, -21.330261029619937, 1.7327378808553608, 24.145970938977776, 15.880791897310568, 11.605484225144536, 18.405577536291055, 22.376016181404403, -11.51169468948848, 12.439785092489592, 17.0255356381309, 18.800254836374375, 28.56849867762346, 15.776305110682026, 45.78504711192493, 5.325956502411143, 1.6715388688323434, 14.643440954826852, -9.011577220186776, 35.22688752463175, -2.1019062776234643, -0.38374780927192664, 12.94200529255129, 1.8802376799454483, -18.17853937407925, 27.042762435029353, 16.17516225658545, 21.972320933960706, -6.440564141975782, 27.027053730524404, 22.6809915321953, 1.9462912278415594, 22.541257770069237, -9.046140773072288, 19.486791764985306, 42.76031613623883, 43.57651338288178, 38.532246591913015, 19.364770939533084, -4.930595661983169, -11.718107144014114, 4.428286439498311, 4.393449589271773, 33.45012381021799, 20.698202607402106, 18.832673331652593, 2.9914544975922666, 4.774007242359001, 10.968246435137928, 4.001049884622845, 21.775163195994732, 30.426312605333678, 14.02344646846065, 20.08067616186425, -3.0602588291061026, 62.15984464619224, 12.237637841065052, 30.789086184310456, 26.166129961153892, 20.216138254326083, 4.221084351567717, 32.90249834707747, 0.17129310502092698, 44.629677899196466, 50.791089605940854, 38.86417727291095, -19.923342783882052, 22.859394757141644, 58.29578624387922, -10.138450022142584, 26.523329916265133, 43.20883278998946, 29.49455589171574, 51.269180984987315, 14.871506647644402, 60.23530324410488, 5.713240178394206, 23.54371441607694, 17.243890225781026, 2.4704775581145855, 62.269772309621146, 64.98743016976599, 13.422477670712507, 17.569295944793268, 37.763844615531795, 24.606965389828154, 16.457969074501605, 70.62013390149508], "episode_lengths": [1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 443, 1117, 1117, 1117, 1117, 399, 1117, 1117, 1117, 1117, 1117, 1117, 838, 1117, 1117, 1117, 1117, 1117, 1117, 91, 864, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 728, 1117, 1117, 1117, 1117, 1117, 760, 865, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 269, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.280211011491572, "mean_inference_ms": 7.044579540996337, "mean_action_processing_ms": 0.5046781827674885, "mean_env_wait_ms": 22.15974823544035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032854318618774414, "StateBufferConnector_ms": 0.031766414642333984, "ViewRequirementAgentConnector_ms": 0.9015371799468994}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283300, "num_agent_steps_trained": 283300, "num_env_steps_sampled": 283300, "num_env_steps_trained": 283300, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 230.70589176582664, "num_env_steps_trained_throughput_per_sec": 230.70589176582664, "timesteps_total": 283300, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 283300, "timers": {"training_iteration_time_ms": 63799.604, "sample_time_ms": 39446.115, "load_time_ms": 3104.85, "load_throughput": 4685.314, "learn_time_ms": 20677.118, "learn_throughput": 703.541, "synch_weights_time_ms": 452.588}, "counters": {"num_env_steps_sampled": 283300, "num_env_steps_trained": 283300, "num_agent_steps_sampled": 283300, "num_agent_steps_trained": 283300}, "done": false, "episodes_total": 352, "training_iteration": 25, "trial_id": "837cb_00000", "date": "2025-06-07_17-47-32", "timestamp": 1749311252, "time_this_iter_s": 67.7990186214447, "time_total_s": 1311.5173144340515, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1311.5173144340515, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 65.50126582278482, "ram_util_percent": 90.6291139240506, "gpu_util_percent0": 0.22012658227848103, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.7167e-05, "total_loss": -0.11721838557023809, "policy_loss": -0.00800279378867179, "vf_loss": 0.0619546090692959, "vf_explained_var": 0.8705476229841059, "kl": 0.012273376212556397, "entropy": 14.978629309914329, "entropy_coeff": 0.008583499999999999}, "model": {}, "num_grad_updates_lifetime": 10255.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 298938, "num_env_steps_trained": 298938, "num_agent_steps_sampled": 298938, "num_agent_steps_trained": 298938}, "sampler_results": {"episode_reward_max": 70.62013390149508, "episode_reward_min": -19.923342783882052, "episode_reward_mean": 21.64181762095366, "episode_len_mean": 1082.96, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.7327378808553608, 24.145970938977776, 15.880791897310568, 11.605484225144536, 18.405577536291055, 22.376016181404403, -11.51169468948848, 12.439785092489592, 17.0255356381309, 18.800254836374375, 28.56849867762346, 15.776305110682026, 45.78504711192493, 5.325956502411143, 1.6715388688323434, 14.643440954826852, -9.011577220186776, 35.22688752463175, -2.1019062776234643, -0.38374780927192664, 12.94200529255129, 1.8802376799454483, -18.17853937407925, 27.042762435029353, 16.17516225658545, 21.972320933960706, -6.440564141975782, 27.027053730524404, 22.6809915321953, 1.9462912278415594, 22.541257770069237, -9.046140773072288, 19.486791764985306, 42.76031613623883, 43.57651338288178, 38.532246591913015, 19.364770939533084, -4.930595661983169, -11.718107144014114, 4.428286439498311, 4.393449589271773, 33.45012381021799, 20.698202607402106, 18.832673331652593, 2.9914544975922666, 4.774007242359001, 10.968246435137928, 4.001049884622845, 21.775163195994732, 30.426312605333678, 14.02344646846065, 20.08067616186425, -3.0602588291061026, 62.15984464619224, 12.237637841065052, 30.789086184310456, 26.166129961153892, 20.216138254326083, 4.221084351567717, 32.90249834707747, 0.17129310502092698, 44.629677899196466, 50.791089605940854, 38.86417727291095, -19.923342783882052, 22.859394757141644, 58.29578624387922, -10.138450022142584, 26.523329916265133, 43.20883278998946, 29.49455589171574, 51.269180984987315, 14.871506647644402, 60.23530324410488, 5.713240178394206, 23.54371441607694, 17.243890225781026, 2.4704775581145855, 62.269772309621146, 64.98743016976599, 13.422477670712507, 17.569295944793268, 37.763844615531795, 24.606965389828154, 16.457969074501605, 70.62013390149508, 38.92736031016171, 23.80223320507344, 21.417502815468463, 55.99761294361105, 29.710071962493693, 25.45642481015468, 36.82746456563074, 34.676202520686104, 25.926000825651986, 55.143756687583426, 67.00365259539801, 26.481153586062835, 40.267452933513596, 4.232394740022486], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 838, 1117, 1117, 1117, 1117, 1117, 1117, 91, 864, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 728, 1117, 1117, 1117, 1117, 1117, 760, 865, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 269, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3155160183252748, "mean_inference_ms": 7.066555092786099, "mean_action_processing_ms": 0.5067357065254614, "mean_env_wait_ms": 22.27573586360194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033333778381347656, "StateBufferConnector_ms": 0.03575396537780762, "ViewRequirementAgentConnector_ms": 0.9564328193664551}}, "episode_reward_max": 70.62013390149508, "episode_reward_min": -19.923342783882052, "episode_reward_mean": 21.64181762095366, "episode_len_mean": 1082.96, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.7327378808553608, 24.145970938977776, 15.880791897310568, 11.605484225144536, 18.405577536291055, 22.376016181404403, -11.51169468948848, 12.439785092489592, 17.0255356381309, 18.800254836374375, 28.56849867762346, 15.776305110682026, 45.78504711192493, 5.325956502411143, 1.6715388688323434, 14.643440954826852, -9.011577220186776, 35.22688752463175, -2.1019062776234643, -0.38374780927192664, 12.94200529255129, 1.8802376799454483, -18.17853937407925, 27.042762435029353, 16.17516225658545, 21.972320933960706, -6.440564141975782, 27.027053730524404, 22.6809915321953, 1.9462912278415594, 22.541257770069237, -9.046140773072288, 19.486791764985306, 42.76031613623883, 43.57651338288178, 38.532246591913015, 19.364770939533084, -4.930595661983169, -11.718107144014114, 4.428286439498311, 4.393449589271773, 33.45012381021799, 20.698202607402106, 18.832673331652593, 2.9914544975922666, 4.774007242359001, 10.968246435137928, 4.001049884622845, 21.775163195994732, 30.426312605333678, 14.02344646846065, 20.08067616186425, -3.0602588291061026, 62.15984464619224, 12.237637841065052, 30.789086184310456, 26.166129961153892, 20.216138254326083, 4.221084351567717, 32.90249834707747, 0.17129310502092698, 44.629677899196466, 50.791089605940854, 38.86417727291095, -19.923342783882052, 22.859394757141644, 58.29578624387922, -10.138450022142584, 26.523329916265133, 43.20883278998946, 29.49455589171574, 51.269180984987315, 14.871506647644402, 60.23530324410488, 5.713240178394206, 23.54371441607694, 17.243890225781026, 2.4704775581145855, 62.269772309621146, 64.98743016976599, 13.422477670712507, 17.569295944793268, 37.763844615531795, 24.606965389828154, 16.457969074501605, 70.62013390149508, 38.92736031016171, 23.80223320507344, 21.417502815468463, 55.99761294361105, 29.710071962493693, 25.45642481015468, 36.82746456563074, 34.676202520686104, 25.926000825651986, 55.143756687583426, 67.00365259539801, 26.481153586062835, 40.267452933513596, 4.232394740022486], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 838, 1117, 1117, 1117, 1117, 1117, 1117, 91, 864, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 728, 1117, 1117, 1117, 1117, 1117, 760, 865, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 269, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3155160183252748, "mean_inference_ms": 7.066555092786099, "mean_action_processing_ms": 0.5067357065254614, "mean_env_wait_ms": 22.27573586360194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033333778381347656, "StateBufferConnector_ms": 0.03575396537780762, "ViewRequirementAgentConnector_ms": 0.9564328193664551}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 298938, "num_agent_steps_trained": 298938, "num_env_steps_sampled": 298938, "num_env_steps_trained": 298938, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 221.53400891803858, "num_env_steps_trained_throughput_per_sec": 221.53400891803858, "timesteps_total": 298938, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 298938, "timers": {"training_iteration_time_ms": 64690.539, "sample_time_ms": 39893.141, "load_time_ms": 2983.543, "load_throughput": 4936.347, "learn_time_ms": 21246.789, "learn_throughput": 693.178, "synch_weights_time_ms": 450.222}, "counters": {"num_env_steps_sampled": 298938, "num_env_steps_trained": 298938, "num_agent_steps_sampled": 298938, "num_agent_steps_trained": 298938}, "done": false, "episodes_total": 366, "training_iteration": 26, "trial_id": "837cb_00000", "date": "2025-06-07_17-48-43", "timestamp": 1749311323, "time_this_iter_s": 70.60461330413818, "time_total_s": 1382.1219277381897, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1382.1219277381897, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 66.77125000000001, "ram_util_percent": 88.415, "gpu_util_percent0": 0.21212499999999998, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.701062000000001e-05, "total_loss": -0.14867107538276203, "policy_loss": -0.037627201852790844, "vf_loss": 0.05225587200521576, "vf_explained_var": 0.8388326690955595, "kl": 0.01169564845308328, "entropy": 14.984946645389904, "entropy_coeff": 0.00850531}, "model": {}, "num_grad_updates_lifetime": 10750.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 311288, "num_env_steps_trained": 311288, "num_agent_steps_sampled": 311288, "num_agent_steps_trained": 311288}, "sampler_results": {"episode_reward_max": 70.62013390149508, "episode_reward_min": -19.923342783882052, "episode_reward_mean": 22.79396055322011, "episode_len_mean": 1063.13, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6715388688323434, 14.643440954826852, -9.011577220186776, 35.22688752463175, -2.1019062776234643, -0.38374780927192664, 12.94200529255129, 1.8802376799454483, -18.17853937407925, 27.042762435029353, 16.17516225658545, 21.972320933960706, -6.440564141975782, 27.027053730524404, 22.6809915321953, 1.9462912278415594, 22.541257770069237, -9.046140773072288, 19.486791764985306, 42.76031613623883, 43.57651338288178, 38.532246591913015, 19.364770939533084, -4.930595661983169, -11.718107144014114, 4.428286439498311, 4.393449589271773, 33.45012381021799, 20.698202607402106, 18.832673331652593, 2.9914544975922666, 4.774007242359001, 10.968246435137928, 4.001049884622845, 21.775163195994732, 30.426312605333678, 14.02344646846065, 20.08067616186425, -3.0602588291061026, 62.15984464619224, 12.237637841065052, 30.789086184310456, 26.166129961153892, 20.216138254326083, 4.221084351567717, 32.90249834707747, 0.17129310502092698, 44.629677899196466, 50.791089605940854, 38.86417727291095, -19.923342783882052, 22.859394757141644, 58.29578624387922, -10.138450022142584, 26.523329916265133, 43.20883278998946, 29.49455589171574, 51.269180984987315, 14.871506647644402, 60.23530324410488, 5.713240178394206, 23.54371441607694, 17.243890225781026, 2.4704775581145855, 62.269772309621146, 64.98743016976599, 13.422477670712507, 17.569295944793268, 37.763844615531795, 24.606965389828154, 16.457969074501605, 70.62013390149508, 38.92736031016171, 23.80223320507344, 21.417502815468463, 55.99761294361105, 29.710071962493693, 25.45642481015468, 36.82746456563074, 34.676202520686104, 25.926000825651986, 55.143756687583426, 67.00365259539801, 26.481153586062835, 40.267452933513596, 4.232394740022486, 8.8291269082843, 13.550072429189864, 6.831241041389358, 52.40016109645307, 50.60311273525488, 20.982850014781533, 10.560794544832417, 14.000971496836806, 13.287514086239616, 6.818973713145283, 16.71777866657673, 32.08684549491114, 44.151077874930166, 50.75004006395042], "episode_lengths": [864, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 728, 1117, 1117, 1117, 1117, 1117, 760, 865, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 269, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.344275091014609, "mean_inference_ms": 7.079397406427784, "mean_action_processing_ms": 0.5080869292501067, "mean_env_wait_ms": 22.353646127835535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03231215476989746, "StateBufferConnector_ms": 0.04015302658081055, "ViewRequirementAgentConnector_ms": 0.8959364891052246}}, "episode_reward_max": 70.62013390149508, "episode_reward_min": -19.923342783882052, "episode_reward_mean": 22.79396055322011, "episode_len_mean": 1063.13, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.6715388688323434, 14.643440954826852, -9.011577220186776, 35.22688752463175, -2.1019062776234643, -0.38374780927192664, 12.94200529255129, 1.8802376799454483, -18.17853937407925, 27.042762435029353, 16.17516225658545, 21.972320933960706, -6.440564141975782, 27.027053730524404, 22.6809915321953, 1.9462912278415594, 22.541257770069237, -9.046140773072288, 19.486791764985306, 42.76031613623883, 43.57651338288178, 38.532246591913015, 19.364770939533084, -4.930595661983169, -11.718107144014114, 4.428286439498311, 4.393449589271773, 33.45012381021799, 20.698202607402106, 18.832673331652593, 2.9914544975922666, 4.774007242359001, 10.968246435137928, 4.001049884622845, 21.775163195994732, 30.426312605333678, 14.02344646846065, 20.08067616186425, -3.0602588291061026, 62.15984464619224, 12.237637841065052, 30.789086184310456, 26.166129961153892, 20.216138254326083, 4.221084351567717, 32.90249834707747, 0.17129310502092698, 44.629677899196466, 50.791089605940854, 38.86417727291095, -19.923342783882052, 22.859394757141644, 58.29578624387922, -10.138450022142584, 26.523329916265133, 43.20883278998946, 29.49455589171574, 51.269180984987315, 14.871506647644402, 60.23530324410488, 5.713240178394206, 23.54371441607694, 17.243890225781026, 2.4704775581145855, 62.269772309621146, 64.98743016976599, 13.422477670712507, 17.569295944793268, 37.763844615531795, 24.606965389828154, 16.457969074501605, 70.62013390149508, 38.92736031016171, 23.80223320507344, 21.417502815468463, 55.99761294361105, 29.710071962493693, 25.45642481015468, 36.82746456563074, 34.676202520686104, 25.926000825651986, 55.143756687583426, 67.00365259539801, 26.481153586062835, 40.267452933513596, 4.232394740022486, 8.8291269082843, 13.550072429189864, 6.831241041389358, 52.40016109645307, 50.60311273525488, 20.982850014781533, 10.560794544832417, 14.000971496836806, 13.287514086239616, 6.818973713145283, 16.71777866657673, 32.08684549491114, 44.151077874930166, 50.75004006395042], "episode_lengths": [864, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 728, 1117, 1117, 1117, 1117, 1117, 760, 865, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 269, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.344275091014609, "mean_inference_ms": 7.079397406427784, "mean_action_processing_ms": 0.5080869292501067, "mean_env_wait_ms": 22.353646127835535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03231215476989746, "StateBufferConnector_ms": 0.04015302658081055, "ViewRequirementAgentConnector_ms": 0.8959364891052246}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 311288, "num_agent_steps_trained": 311288, "num_env_steps_sampled": 311288, "num_env_steps_trained": 311288, "num_env_steps_sampled_this_iter": 12350, "num_env_steps_trained_this_iter": 12350, "num_env_steps_sampled_throughput_per_sec": 227.75822002158046, "num_env_steps_trained_throughput_per_sec": 227.75822002158046, "timesteps_total": 311288, "num_steps_trained_this_iter": 12350, "agent_timesteps_total": 311288, "timers": {"training_iteration_time_ms": 64166.212, "sample_time_ms": 39633.589, "load_time_ms": 2936.43, "load_throughput": 4964.464, "learn_time_ms": 21038.239, "learn_throughput": 692.919, "synch_weights_time_ms": 443.269}, "counters": {"num_env_steps_sampled": 311288, "num_env_steps_trained": 311288, "num_agent_steps_sampled": 311288, "num_agent_steps_trained": 311288}, "done": false, "episodes_total": 380, "training_iteration": 27, "trial_id": "837cb_00000", "date": "2025-06-07_17-49-37", "timestamp": 1749311377, "time_this_iter_s": 54.24319672584534, "time_total_s": 1436.365124464035, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1436.365124464035, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 59.845312500000006, "ram_util_percent": 87.51875000000001, "gpu_util_percent0": 0.20171875, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.688712e-05, "total_loss": -0.1085372172427279, "policy_loss": -0.0007666820535880768, "vf_loss": 0.06291856887834993, "vf_explained_var": 0.8851042109185999, "kl": 0.013384727583669842, "entropy": 15.098210877505215, "entropy_coeff": 0.008443560000000001}, "model": {}, "num_grad_updates_lifetime": 11245.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 326926, "num_env_steps_trained": 326926, "num_agent_steps_sampled": 326926, "num_agent_steps_trained": 326926}, "sampler_results": {"episode_reward_max": 71.09889149659095, "episode_reward_min": -24.571288759749095, "episode_reward_mean": 26.437552917147112, "episode_len_mean": 1065.66, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.6809915321953, 1.9462912278415594, 22.541257770069237, -9.046140773072288, 19.486791764985306, 42.76031613623883, 43.57651338288178, 38.532246591913015, 19.364770939533084, -4.930595661983169, -11.718107144014114, 4.428286439498311, 4.393449589271773, 33.45012381021799, 20.698202607402106, 18.832673331652593, 2.9914544975922666, 4.774007242359001, 10.968246435137928, 4.001049884622845, 21.775163195994732, 30.426312605333678, 14.02344646846065, 20.08067616186425, -3.0602588291061026, 62.15984464619224, 12.237637841065052, 30.789086184310456, 26.166129961153892, 20.216138254326083, 4.221084351567717, 32.90249834707747, 0.17129310502092698, 44.629677899196466, 50.791089605940854, 38.86417727291095, -19.923342783882052, 22.859394757141644, 58.29578624387922, -10.138450022142584, 26.523329916265133, 43.20883278998946, 29.49455589171574, 51.269180984987315, 14.871506647644402, 60.23530324410488, 5.713240178394206, 23.54371441607694, 17.243890225781026, 2.4704775581145855, 62.269772309621146, 64.98743016976599, 13.422477670712507, 17.569295944793268, 37.763844615531795, 24.606965389828154, 16.457969074501605, 70.62013390149508, 38.92736031016171, 23.80223320507344, 21.417502815468463, 55.99761294361105, 29.710071962493693, 25.45642481015468, 36.82746456563074, 34.676202520686104, 25.926000825651986, 55.143756687583426, 67.00365259539801, 26.481153586062835, 40.267452933513596, 4.232394740022486, 8.8291269082843, 13.550072429189864, 6.831241041389358, 52.40016109645307, 50.60311273525488, 20.982850014781533, 10.560794544832417, 14.000971496836806, 13.287514086239616, 6.818973713145283, 16.71777866657673, 32.08684549491114, 44.151077874930166, 50.75004006395042, 18.80073144252757, 18.10664641945574, 42.247989144123416, 66.53426990518669, 34.39010076120998, -24.571288759749095, 64.59879676552718, 19.29683159328632, 36.472970439952654, 55.07670231645529, 4.698720562129515, 71.09889149659095, 19.89667903565069, 60.17627012410464], "episode_lengths": [1117, 1117, 1117, 728, 1117, 1117, 1117, 1117, 1117, 760, 865, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 269, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3678032911937494, "mean_inference_ms": 7.088484500543057, "mean_action_processing_ms": 0.5090591758999982, "mean_env_wait_ms": 22.4108487914778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0353546142578125, "StateBufferConnector_ms": 0.038492441177368164, "ViewRequirementAgentConnector_ms": 0.8997476100921631}}, "episode_reward_max": 71.09889149659095, "episode_reward_min": -24.571288759749095, "episode_reward_mean": 26.437552917147112, "episode_len_mean": 1065.66, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.6809915321953, 1.9462912278415594, 22.541257770069237, -9.046140773072288, 19.486791764985306, 42.76031613623883, 43.57651338288178, 38.532246591913015, 19.364770939533084, -4.930595661983169, -11.718107144014114, 4.428286439498311, 4.393449589271773, 33.45012381021799, 20.698202607402106, 18.832673331652593, 2.9914544975922666, 4.774007242359001, 10.968246435137928, 4.001049884622845, 21.775163195994732, 30.426312605333678, 14.02344646846065, 20.08067616186425, -3.0602588291061026, 62.15984464619224, 12.237637841065052, 30.789086184310456, 26.166129961153892, 20.216138254326083, 4.221084351567717, 32.90249834707747, 0.17129310502092698, 44.629677899196466, 50.791089605940854, 38.86417727291095, -19.923342783882052, 22.859394757141644, 58.29578624387922, -10.138450022142584, 26.523329916265133, 43.20883278998946, 29.49455589171574, 51.269180984987315, 14.871506647644402, 60.23530324410488, 5.713240178394206, 23.54371441607694, 17.243890225781026, 2.4704775581145855, 62.269772309621146, 64.98743016976599, 13.422477670712507, 17.569295944793268, 37.763844615531795, 24.606965389828154, 16.457969074501605, 70.62013390149508, 38.92736031016171, 23.80223320507344, 21.417502815468463, 55.99761294361105, 29.710071962493693, 25.45642481015468, 36.82746456563074, 34.676202520686104, 25.926000825651986, 55.143756687583426, 67.00365259539801, 26.481153586062835, 40.267452933513596, 4.232394740022486, 8.8291269082843, 13.550072429189864, 6.831241041389358, 52.40016109645307, 50.60311273525488, 20.982850014781533, 10.560794544832417, 14.000971496836806, 13.287514086239616, 6.818973713145283, 16.71777866657673, 32.08684549491114, 44.151077874930166, 50.75004006395042, 18.80073144252757, 18.10664641945574, 42.247989144123416, 66.53426990518669, 34.39010076120998, -24.571288759749095, 64.59879676552718, 19.29683159328632, 36.472970439952654, 55.07670231645529, 4.698720562129515, 71.09889149659095, 19.89667903565069, 60.17627012410464], "episode_lengths": [1117, 1117, 1117, 728, 1117, 1117, 1117, 1117, 1117, 760, 865, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 269, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3678032911937494, "mean_inference_ms": 7.088484500543057, "mean_action_processing_ms": 0.5090591758999982, "mean_env_wait_ms": 22.4108487914778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0353546142578125, "StateBufferConnector_ms": 0.038492441177368164, "ViewRequirementAgentConnector_ms": 0.8997476100921631}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 326926, "num_agent_steps_trained": 326926, "num_env_steps_sampled": 326926, "num_env_steps_trained": 326926, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 234.32416238286305, "num_env_steps_trained_throughput_per_sec": 234.32416238286305, "timesteps_total": 326926, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 326926, "timers": {"training_iteration_time_ms": 64832.474, "sample_time_ms": 39803.17, "load_time_ms": 2987.076, "load_throughput": 4946.946, "learn_time_ms": 21466.739, "learn_throughput": 688.363, "synch_weights_time_ms": 457.939}, "counters": {"num_env_steps_sampled": 326926, "num_env_steps_trained": 326926, "num_agent_steps_sampled": 326926, "num_agent_steps_trained": 326926}, "done": false, "episodes_total": 394, "training_iteration": 28, "trial_id": "837cb_00000", "date": "2025-06-07_17-50-44", "timestamp": 1749311444, "time_this_iter_s": 66.77172183990479, "time_total_s": 1503.1368463039398, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1503.1368463039398, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 66.17564102564103, "ram_util_percent": 88.84487179487179, "gpu_util_percent0": 0.22435897435897437, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.673074000000002e-05, "total_loss": -0.11987582288613562, "policy_loss": -0.010929833526000837, "vf_loss": 0.05043799549540771, "vf_explained_var": 0.8853929861467712, "kl": 0.01162013974345446, "entropy": 14.919082423618862, "entropy_coeff": 0.008365369999999999}, "model": {}, "num_grad_updates_lifetime": 11765.5, "diff_num_grad_updates_vs_sampler_policy": 244.5}}, "num_env_steps_sampled": 340920, "num_env_steps_trained": 340920, "num_agent_steps_sampled": 340920, "num_agent_steps_trained": 340920}, "sampler_results": {"episode_reward_max": 76.88668189063858, "episode_reward_min": -24.571288759749095, "episode_reward_mean": 30.022716199831635, "episode_len_mean": 1059.2, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.698202607402106, 18.832673331652593, 2.9914544975922666, 4.774007242359001, 10.968246435137928, 4.001049884622845, 21.775163195994732, 30.426312605333678, 14.02344646846065, 20.08067616186425, -3.0602588291061026, 62.15984464619224, 12.237637841065052, 30.789086184310456, 26.166129961153892, 20.216138254326083, 4.221084351567717, 32.90249834707747, 0.17129310502092698, 44.629677899196466, 50.791089605940854, 38.86417727291095, -19.923342783882052, 22.859394757141644, 58.29578624387922, -10.138450022142584, 26.523329916265133, 43.20883278998946, 29.49455589171574, 51.269180984987315, 14.871506647644402, 60.23530324410488, 5.713240178394206, 23.54371441607694, 17.243890225781026, 2.4704775581145855, 62.269772309621146, 64.98743016976599, 13.422477670712507, 17.569295944793268, 37.763844615531795, 24.606965389828154, 16.457969074501605, 70.62013390149508, 38.92736031016171, 23.80223320507344, 21.417502815468463, 55.99761294361105, 29.710071962493693, 25.45642481015468, 36.82746456563074, 34.676202520686104, 25.926000825651986, 55.143756687583426, 67.00365259539801, 26.481153586062835, 40.267452933513596, 4.232394740022486, 8.8291269082843, 13.550072429189864, 6.831241041389358, 52.40016109645307, 50.60311273525488, 20.982850014781533, 10.560794544832417, 14.000971496836806, 13.287514086239616, 6.818973713145283, 16.71777866657673, 32.08684549491114, 44.151077874930166, 50.75004006395042, 18.80073144252757, 18.10664641945574, 42.247989144123416, 66.53426990518669, 34.39010076120998, -24.571288759749095, 64.59879676552718, 19.29683159328632, 36.472970439952654, 55.07670231645529, 4.698720562129515, 71.09889149659095, 19.89667903565069, 60.17627012410464, 8.474567084946372, 18.273716529661158, 36.157596114809664, 10.016976731425467, 27.470127839378996, 61.13437333564291, 30.083907977802237, 74.48449654651834, 73.99672189937274, 33.17114859924176, 38.482583192373056, 76.88668189063858, 37.34559776439353, 60.004028367823935], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 269, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.38963474660307, "mean_inference_ms": 7.095910183184189, "mean_action_processing_ms": 0.5099211678735204, "mean_env_wait_ms": 22.4604704029368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03633236885070801, "StateBufferConnector_ms": 0.04050922393798828, "ViewRequirementAgentConnector_ms": 0.8971974849700928}}, "episode_reward_max": 76.88668189063858, "episode_reward_min": -24.571288759749095, "episode_reward_mean": 30.022716199831635, "episode_len_mean": 1059.2, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.698202607402106, 18.832673331652593, 2.9914544975922666, 4.774007242359001, 10.968246435137928, 4.001049884622845, 21.775163195994732, 30.426312605333678, 14.02344646846065, 20.08067616186425, -3.0602588291061026, 62.15984464619224, 12.237637841065052, 30.789086184310456, 26.166129961153892, 20.216138254326083, 4.221084351567717, 32.90249834707747, 0.17129310502092698, 44.629677899196466, 50.791089605940854, 38.86417727291095, -19.923342783882052, 22.859394757141644, 58.29578624387922, -10.138450022142584, 26.523329916265133, 43.20883278998946, 29.49455589171574, 51.269180984987315, 14.871506647644402, 60.23530324410488, 5.713240178394206, 23.54371441607694, 17.243890225781026, 2.4704775581145855, 62.269772309621146, 64.98743016976599, 13.422477670712507, 17.569295944793268, 37.763844615531795, 24.606965389828154, 16.457969074501605, 70.62013390149508, 38.92736031016171, 23.80223320507344, 21.417502815468463, 55.99761294361105, 29.710071962493693, 25.45642481015468, 36.82746456563074, 34.676202520686104, 25.926000825651986, 55.143756687583426, 67.00365259539801, 26.481153586062835, 40.267452933513596, 4.232394740022486, 8.8291269082843, 13.550072429189864, 6.831241041389358, 52.40016109645307, 50.60311273525488, 20.982850014781533, 10.560794544832417, 14.000971496836806, 13.287514086239616, 6.818973713145283, 16.71777866657673, 32.08684549491114, 44.151077874930166, 50.75004006395042, 18.80073144252757, 18.10664641945574, 42.247989144123416, 66.53426990518669, 34.39010076120998, -24.571288759749095, 64.59879676552718, 19.29683159328632, 36.472970439952654, 55.07670231645529, 4.698720562129515, 71.09889149659095, 19.89667903565069, 60.17627012410464, 8.474567084946372, 18.273716529661158, 36.157596114809664, 10.016976731425467, 27.470127839378996, 61.13437333564291, 30.083907977802237, 74.48449654651834, 73.99672189937274, 33.17114859924176, 38.482583192373056, 76.88668189063858, 37.34559776439353, 60.004028367823935], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 269, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.38963474660307, "mean_inference_ms": 7.095910183184189, "mean_action_processing_ms": 0.5099211678735204, "mean_env_wait_ms": 22.4604704029368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03633236885070801, "StateBufferConnector_ms": 0.04050922393798828, "ViewRequirementAgentConnector_ms": 0.8971974849700928}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340920, "num_agent_steps_trained": 340920, "num_env_steps_sampled": 340920, "num_env_steps_trained": 340920, "num_env_steps_sampled_this_iter": 13994, "num_env_steps_trained_this_iter": 13994, "num_env_steps_sampled_throughput_per_sec": 234.28791094398684, "num_env_steps_trained_throughput_per_sec": 234.28791094398684, "timesteps_total": 340920, "num_steps_trained_this_iter": 13994, "agent_timesteps_total": 340920, "timers": {"training_iteration_time_ms": 65251.415, "sample_time_ms": 40131.513, "load_time_ms": 3032.067, "load_throughput": 4919.449, "learn_time_ms": 21511.491, "learn_throughput": 693.402, "synch_weights_time_ms": 458.992}, "counters": {"num_env_steps_sampled": 340920, "num_env_steps_trained": 340920, "num_agent_steps_sampled": 340920, "num_agent_steps_trained": 340920}, "done": false, "episodes_total": 408, "training_iteration": 29, "trial_id": "837cb_00000", "date": "2025-06-07_17-51-44", "timestamp": 1749311504, "time_this_iter_s": 59.74747610092163, "time_total_s": 1562.8843224048615, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1562.8843224048615, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 67.25507246376812, "ram_util_percent": 89.4376811594203, "gpu_util_percent0": 0.18260869565217394, "vram_util_percent0": 0.9650065104166669}}
{"evaluation": {"sampler_results": {"episode_reward_max": -7.1921492083481295, "episode_reward_min": -10.490864832535847, "episode_reward_mean": -8.786117045471503, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.490864832535847, -9.663161132766247, -8.807234743969497, -7.777175309737801, -7.1921492083481295], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7337706675351594, "mean_inference_ms": 3.8584509175655333, "mean_action_processing_ms": 0.27606721288783964, "mean_env_wait_ms": 12.6036791126178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5390024185180664}}, "episode_reward_max": -7.1921492083481295, "episode_reward_min": -10.490864832535847, "episode_reward_mean": -8.786117045471503, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.490864832535847, -9.663161132766247, -8.807234743969497, -7.777175309737801, -7.1921492083481295], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7337706675351594, "mean_inference_ms": 3.8584509175655333, "mean_action_processing_ms": 0.27606721288783964, "mean_env_wait_ms": 12.6036791126178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5390024185180664}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.65908e-05, "total_loss": -0.11270521773976531, "policy_loss": -0.003296841405136412, "vf_loss": 0.041996099511557757, "vf_explained_var": 0.9281915882800488, "kl": 0.012012328333569078, "entropy": 14.798319278879369, "entropy_coeff": 0.008295399999999996}, "model": {}, "num_grad_updates_lifetime": 12245.5, "diff_num_grad_updates_vs_sampler_policy": 234.5}}, "num_env_steps_sampled": 354092, "num_env_steps_trained": 354092, "num_agent_steps_sampled": 354092, "num_agent_steps_trained": 354092}, "sampler_results": {"episode_reward_max": 77.8455824012334, "episode_reward_min": -24.571288759749095, "episode_reward_mean": 34.14471484786149, "episode_len_mean": 1043.02, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.166129961153892, 20.216138254326083, 4.221084351567717, 32.90249834707747, 0.17129310502092698, 44.629677899196466, 50.791089605940854, 38.86417727291095, -19.923342783882052, 22.859394757141644, 58.29578624387922, -10.138450022142584, 26.523329916265133, 43.20883278998946, 29.49455589171574, 51.269180984987315, 14.871506647644402, 60.23530324410488, 5.713240178394206, 23.54371441607694, 17.243890225781026, 2.4704775581145855, 62.269772309621146, 64.98743016976599, 13.422477670712507, 17.569295944793268, 37.763844615531795, 24.606965389828154, 16.457969074501605, 70.62013390149508, 38.92736031016171, 23.80223320507344, 21.417502815468463, 55.99761294361105, 29.710071962493693, 25.45642481015468, 36.82746456563074, 34.676202520686104, 25.926000825651986, 55.143756687583426, 67.00365259539801, 26.481153586062835, 40.267452933513596, 4.232394740022486, 8.8291269082843, 13.550072429189864, 6.831241041389358, 52.40016109645307, 50.60311273525488, 20.982850014781533, 10.560794544832417, 14.000971496836806, 13.287514086239616, 6.818973713145283, 16.71777866657673, 32.08684549491114, 44.151077874930166, 50.75004006395042, 18.80073144252757, 18.10664641945574, 42.247989144123416, 66.53426990518669, 34.39010076120998, -24.571288759749095, 64.59879676552718, 19.29683159328632, 36.472970439952654, 55.07670231645529, 4.698720562129515, 71.09889149659095, 19.89667903565069, 60.17627012410464, 8.474567084946372, 18.273716529661158, 36.157596114809664, 10.016976731425467, 27.470127839378996, 61.13437333564291, 30.083907977802237, 74.48449654651834, 73.99672189937274, 33.17114859924176, 38.482583192373056, 76.88668189063858, 37.34559776439353, 60.004028367823935, 12.827351992035616, 71.28427970492557, 30.82185319704709, 56.6344397351523, 51.250358740943206, 14.928634441408407, 77.8455824012334, 47.324719353556894, 67.85425866808207, 43.34280694485879, 73.26589729528465, 13.31056804037409, 40.144954002408596, 62.061702558556455], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4076340973070285, "mean_inference_ms": 7.10314494585197, "mean_action_processing_ms": 0.5108014506360415, "mean_env_wait_ms": 22.505271117290945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03749561309814453, "StateBufferConnector_ms": 0.03953433036804199, "ViewRequirementAgentConnector_ms": 0.8874838352203369}}, "episode_reward_max": 77.8455824012334, "episode_reward_min": -24.571288759749095, "episode_reward_mean": 34.14471484786149, "episode_len_mean": 1043.02, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.166129961153892, 20.216138254326083, 4.221084351567717, 32.90249834707747, 0.17129310502092698, 44.629677899196466, 50.791089605940854, 38.86417727291095, -19.923342783882052, 22.859394757141644, 58.29578624387922, -10.138450022142584, 26.523329916265133, 43.20883278998946, 29.49455589171574, 51.269180984987315, 14.871506647644402, 60.23530324410488, 5.713240178394206, 23.54371441607694, 17.243890225781026, 2.4704775581145855, 62.269772309621146, 64.98743016976599, 13.422477670712507, 17.569295944793268, 37.763844615531795, 24.606965389828154, 16.457969074501605, 70.62013390149508, 38.92736031016171, 23.80223320507344, 21.417502815468463, 55.99761294361105, 29.710071962493693, 25.45642481015468, 36.82746456563074, 34.676202520686104, 25.926000825651986, 55.143756687583426, 67.00365259539801, 26.481153586062835, 40.267452933513596, 4.232394740022486, 8.8291269082843, 13.550072429189864, 6.831241041389358, 52.40016109645307, 50.60311273525488, 20.982850014781533, 10.560794544832417, 14.000971496836806, 13.287514086239616, 6.818973713145283, 16.71777866657673, 32.08684549491114, 44.151077874930166, 50.75004006395042, 18.80073144252757, 18.10664641945574, 42.247989144123416, 66.53426990518669, 34.39010076120998, -24.571288759749095, 64.59879676552718, 19.29683159328632, 36.472970439952654, 55.07670231645529, 4.698720562129515, 71.09889149659095, 19.89667903565069, 60.17627012410464, 8.474567084946372, 18.273716529661158, 36.157596114809664, 10.016976731425467, 27.470127839378996, 61.13437333564291, 30.083907977802237, 74.48449654651834, 73.99672189937274, 33.17114859924176, 38.482583192373056, 76.88668189063858, 37.34559776439353, 60.004028367823935, 12.827351992035616, 71.28427970492557, 30.82185319704709, 56.6344397351523, 51.250358740943206, 14.928634441408407, 77.8455824012334, 47.324719353556894, 67.85425866808207, 43.34280694485879, 73.26589729528465, 13.31056804037409, 40.144954002408596, 62.061702558556455], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4076340973070285, "mean_inference_ms": 7.10314494585197, "mean_action_processing_ms": 0.5108014506360415, "mean_env_wait_ms": 22.505271117290945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03749561309814453, "StateBufferConnector_ms": 0.03953433036804199, "ViewRequirementAgentConnector_ms": 0.8874838352203369}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 354092, "num_agent_steps_trained": 354092, "num_env_steps_sampled": 354092, "num_env_steps_trained": 354092, "num_env_steps_sampled_this_iter": 13172, "num_env_steps_trained_this_iter": 13172, "num_env_steps_sampled_throughput_per_sec": 233.3869734405327, "num_env_steps_trained_throughput_per_sec": 233.3869734405327, "timesteps_total": 354092, "num_steps_trained_this_iter": 13172, "agent_timesteps_total": 354092, "timers": {"training_iteration_time_ms": 63959.667, "sample_time_ms": 39718.02, "load_time_ms": 2778.687, "load_throughput": 5295.162, "learn_time_ms": 20888.785, "learn_throughput": 704.378, "synch_weights_time_ms": 459.733}, "counters": {"num_env_steps_sampled": 354092, "num_env_steps_trained": 354092, "num_agent_steps_sampled": 354092, "num_agent_steps_trained": 354092}, "done": false, "episodes_total": 422, "training_iteration": 30, "trial_id": "837cb_00000", "date": "2025-06-07_17-52-58", "timestamp": 1749311578, "time_this_iter_s": 73.64660263061523, "time_total_s": 1636.5309250354767, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1636.5309250354767, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 55.10227272727273, "ram_util_percent": 88.7375, "gpu_util_percent0": 0.1365909090909091, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.645908000000003e-05, "total_loss": -0.10505161155955507, "policy_loss": 0.0026570752180235173, "vf_loss": 0.04903577039054093, "vf_explained_var": 0.8874150178753413, "kl": 0.012695893048211214, "entropy": 14.972029711649968, "entropy_coeff": 0.008229540000000004}, "model": {}, "num_grad_updates_lifetime": 12740.5, "diff_num_grad_updates_vs_sampler_policy": 259.5}}, "num_env_steps_sampled": 368908, "num_env_steps_trained": 368908, "num_agent_steps_sampled": 368908, "num_agent_steps_trained": 368908}, "sampler_results": {"episode_reward_max": 77.8455824012334, "episode_reward_min": -24.571288759749095, "episode_reward_mean": 36.127878133021056, "episode_len_mean": 1034.8, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.49455589171574, 51.269180984987315, 14.871506647644402, 60.23530324410488, 5.713240178394206, 23.54371441607694, 17.243890225781026, 2.4704775581145855, 62.269772309621146, 64.98743016976599, 13.422477670712507, 17.569295944793268, 37.763844615531795, 24.606965389828154, 16.457969074501605, 70.62013390149508, 38.92736031016171, 23.80223320507344, 21.417502815468463, 55.99761294361105, 29.710071962493693, 25.45642481015468, 36.82746456563074, 34.676202520686104, 25.926000825651986, 55.143756687583426, 67.00365259539801, 26.481153586062835, 40.267452933513596, 4.232394740022486, 8.8291269082843, 13.550072429189864, 6.831241041389358, 52.40016109645307, 50.60311273525488, 20.982850014781533, 10.560794544832417, 14.000971496836806, 13.287514086239616, 6.818973713145283, 16.71777866657673, 32.08684549491114, 44.151077874930166, 50.75004006395042, 18.80073144252757, 18.10664641945574, 42.247989144123416, 66.53426990518669, 34.39010076120998, -24.571288759749095, 64.59879676552718, 19.29683159328632, 36.472970439952654, 55.07670231645529, 4.698720562129515, 71.09889149659095, 19.89667903565069, 60.17627012410464, 8.474567084946372, 18.273716529661158, 36.157596114809664, 10.016976731425467, 27.470127839378996, 61.13437333564291, 30.083907977802237, 74.48449654651834, 73.99672189937274, 33.17114859924176, 38.482583192373056, 76.88668189063858, 37.34559776439353, 60.004028367823935, 12.827351992035616, 71.28427970492557, 30.82185319704709, 56.6344397351523, 51.250358740943206, 14.928634441408407, 77.8455824012334, 47.324719353556894, 67.85425866808207, 43.34280694485879, 73.26589729528465, 13.31056804037409, 40.144954002408596, 62.061702558556455, 68.33301050068282, 34.26930675984251, -0.38380128152377735, 13.62444607005797, 34.13702832196986, 59.467809535958864, 61.210009525856, 45.282178972810236, 44.13221547141673, 31.98380004483181, 28.550956345074965, 65.82376004704531, 2.2341406122506915, 48.43910728812813], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4229343495397777, "mean_inference_ms": 7.110815447778443, "mean_action_processing_ms": 0.5116417312281478, "mean_env_wait_ms": 22.54709652562879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030480384826660156, "StateBufferConnector_ms": 0.04030179977416992, "ViewRequirementAgentConnector_ms": 0.8353815078735352}}, "episode_reward_max": 77.8455824012334, "episode_reward_min": -24.571288759749095, "episode_reward_mean": 36.127878133021056, "episode_len_mean": 1034.8, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.49455589171574, 51.269180984987315, 14.871506647644402, 60.23530324410488, 5.713240178394206, 23.54371441607694, 17.243890225781026, 2.4704775581145855, 62.269772309621146, 64.98743016976599, 13.422477670712507, 17.569295944793268, 37.763844615531795, 24.606965389828154, 16.457969074501605, 70.62013390149508, 38.92736031016171, 23.80223320507344, 21.417502815468463, 55.99761294361105, 29.710071962493693, 25.45642481015468, 36.82746456563074, 34.676202520686104, 25.926000825651986, 55.143756687583426, 67.00365259539801, 26.481153586062835, 40.267452933513596, 4.232394740022486, 8.8291269082843, 13.550072429189864, 6.831241041389358, 52.40016109645307, 50.60311273525488, 20.982850014781533, 10.560794544832417, 14.000971496836806, 13.287514086239616, 6.818973713145283, 16.71777866657673, 32.08684549491114, 44.151077874930166, 50.75004006395042, 18.80073144252757, 18.10664641945574, 42.247989144123416, 66.53426990518669, 34.39010076120998, -24.571288759749095, 64.59879676552718, 19.29683159328632, 36.472970439952654, 55.07670231645529, 4.698720562129515, 71.09889149659095, 19.89667903565069, 60.17627012410464, 8.474567084946372, 18.273716529661158, 36.157596114809664, 10.016976731425467, 27.470127839378996, 61.13437333564291, 30.083907977802237, 74.48449654651834, 73.99672189937274, 33.17114859924176, 38.482583192373056, 76.88668189063858, 37.34559776439353, 60.004028367823935, 12.827351992035616, 71.28427970492557, 30.82185319704709, 56.6344397351523, 51.250358740943206, 14.928634441408407, 77.8455824012334, 47.324719353556894, 67.85425866808207, 43.34280694485879, 73.26589729528465, 13.31056804037409, 40.144954002408596, 62.061702558556455, 68.33301050068282, 34.26930675984251, -0.38380128152377735, 13.62444607005797, 34.13702832196986, 59.467809535958864, 61.210009525856, 45.282178972810236, 44.13221547141673, 31.98380004483181, 28.550956345074965, 65.82376004704531, 2.2341406122506915, 48.43910728812813], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4229343495397777, "mean_inference_ms": 7.110815447778443, "mean_action_processing_ms": 0.5116417312281478, "mean_env_wait_ms": 22.54709652562879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030480384826660156, "StateBufferConnector_ms": 0.04030179977416992, "ViewRequirementAgentConnector_ms": 0.8353815078735352}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368908, "num_agent_steps_trained": 368908, "num_env_steps_sampled": 368908, "num_env_steps_trained": 368908, "num_env_steps_sampled_this_iter": 14816, "num_env_steps_trained_this_iter": 14816, "num_env_steps_sampled_throughput_per_sec": 228.25397942775274, "num_env_steps_trained_throughput_per_sec": 228.25397942775274, "timesteps_total": 368908, "num_steps_trained_this_iter": 14816, "agent_timesteps_total": 368908, "timers": {"training_iteration_time_ms": 63465.81, "sample_time_ms": 39499.372, "load_time_ms": 2597.736, "load_throughput": 5632.367, "learn_time_ms": 20737.13, "learn_throughput": 705.565, "synch_weights_time_ms": 518.959}, "counters": {"num_env_steps_sampled": 368908, "num_env_steps_trained": 368908, "num_agent_steps_sampled": 368908, "num_agent_steps_trained": 368908}, "done": false, "episodes_total": 436, "training_iteration": 31, "trial_id": "837cb_00000", "date": "2025-06-07_17-54-03", "timestamp": 1749311643, "time_this_iter_s": 64.9249918460846, "time_total_s": 1701.4559168815613, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1701.4559168815613, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 66.11973684210525, "ram_util_percent": 90.0592105263158, "gpu_util_percent0": 0.20578947368421055, "vram_util_percent0": 0.965006510416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.631092e-05, "total_loss": -0.14003354975032958, "policy_loss": -0.034032436399006244, "vf_loss": 0.04866882136239755, "vf_explained_var": 0.8846301670778881, "kl": 0.012238058304205098, "entropy": 14.881643399325284, "entropy_coeff": 0.008155460000000002}, "model": {}, "num_grad_updates_lifetime": 13220.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 381258, "num_env_steps_trained": 381258, "num_agent_steps_sampled": 381258, "num_agent_steps_trained": 381258}, "sampler_results": {"episode_reward_max": 78.0577016911605, "episode_reward_min": -24.571288759749095, "episode_reward_mean": 36.97966460050178, "episode_len_mean": 1001.92, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.457969074501605, 70.62013390149508, 38.92736031016171, 23.80223320507344, 21.417502815468463, 55.99761294361105, 29.710071962493693, 25.45642481015468, 36.82746456563074, 34.676202520686104, 25.926000825651986, 55.143756687583426, 67.00365259539801, 26.481153586062835, 40.267452933513596, 4.232394740022486, 8.8291269082843, 13.550072429189864, 6.831241041389358, 52.40016109645307, 50.60311273525488, 20.982850014781533, 10.560794544832417, 14.000971496836806, 13.287514086239616, 6.818973713145283, 16.71777866657673, 32.08684549491114, 44.151077874930166, 50.75004006395042, 18.80073144252757, 18.10664641945574, 42.247989144123416, 66.53426990518669, 34.39010076120998, -24.571288759749095, 64.59879676552718, 19.29683159328632, 36.472970439952654, 55.07670231645529, 4.698720562129515, 71.09889149659095, 19.89667903565069, 60.17627012410464, 8.474567084946372, 18.273716529661158, 36.157596114809664, 10.016976731425467, 27.470127839378996, 61.13437333564291, 30.083907977802237, 74.48449654651834, 73.99672189937274, 33.17114859924176, 38.482583192373056, 76.88668189063858, 37.34559776439353, 60.004028367823935, 12.827351992035616, 71.28427970492557, 30.82185319704709, 56.6344397351523, 51.250358740943206, 14.928634441408407, 77.8455824012334, 47.324719353556894, 67.85425866808207, 43.34280694485879, 73.26589729528465, 13.31056804037409, 40.144954002408596, 62.061702558556455, 68.33301050068282, 34.26930675984251, -0.38380128152377735, 13.62444607005797, 34.13702832196986, 59.467809535958864, 61.210009525856, 45.282178972810236, 44.13221547141673, 31.98380004483181, 28.550956345074965, 65.82376004704531, 2.2341406122506915, 48.43910728812813, 60.846679823301365, 24.145760202108825, 45.55507832712969, 12.213434275593261, 63.087718857691726, 8.030345701397428, 46.27759007992771, 9.164982326134968, 53.89603271245526, 33.65616034420937, 12.52170012945473, 10.832621494446627, 78.0577016911605, 52.354496030132346], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4343270086591637, "mean_inference_ms": 7.1140303816473995, "mean_action_processing_ms": 0.5120885557702992, "mean_env_wait_ms": 22.571007745102833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028490781784057617, "StateBufferConnector_ms": 0.03630685806274414, "ViewRequirementAgentConnector_ms": 0.8126997947692871}}, "episode_reward_max": 78.0577016911605, "episode_reward_min": -24.571288759749095, "episode_reward_mean": 36.97966460050178, "episode_len_mean": 1001.92, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.457969074501605, 70.62013390149508, 38.92736031016171, 23.80223320507344, 21.417502815468463, 55.99761294361105, 29.710071962493693, 25.45642481015468, 36.82746456563074, 34.676202520686104, 25.926000825651986, 55.143756687583426, 67.00365259539801, 26.481153586062835, 40.267452933513596, 4.232394740022486, 8.8291269082843, 13.550072429189864, 6.831241041389358, 52.40016109645307, 50.60311273525488, 20.982850014781533, 10.560794544832417, 14.000971496836806, 13.287514086239616, 6.818973713145283, 16.71777866657673, 32.08684549491114, 44.151077874930166, 50.75004006395042, 18.80073144252757, 18.10664641945574, 42.247989144123416, 66.53426990518669, 34.39010076120998, -24.571288759749095, 64.59879676552718, 19.29683159328632, 36.472970439952654, 55.07670231645529, 4.698720562129515, 71.09889149659095, 19.89667903565069, 60.17627012410464, 8.474567084946372, 18.273716529661158, 36.157596114809664, 10.016976731425467, 27.470127839378996, 61.13437333564291, 30.083907977802237, 74.48449654651834, 73.99672189937274, 33.17114859924176, 38.482583192373056, 76.88668189063858, 37.34559776439353, 60.004028367823935, 12.827351992035616, 71.28427970492557, 30.82185319704709, 56.6344397351523, 51.250358740943206, 14.928634441408407, 77.8455824012334, 47.324719353556894, 67.85425866808207, 43.34280694485879, 73.26589729528465, 13.31056804037409, 40.144954002408596, 62.061702558556455, 68.33301050068282, 34.26930675984251, -0.38380128152377735, 13.62444607005797, 34.13702832196986, 59.467809535958864, 61.210009525856, 45.282178972810236, 44.13221547141673, 31.98380004483181, 28.550956345074965, 65.82376004704531, 2.2341406122506915, 48.43910728812813, 60.846679823301365, 24.145760202108825, 45.55507832712969, 12.213434275593261, 63.087718857691726, 8.030345701397428, 46.27759007992771, 9.164982326134968, 53.89603271245526, 33.65616034420937, 12.52170012945473, 10.832621494446627, 78.0577016911605, 52.354496030132346], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4343270086591637, "mean_inference_ms": 7.1140303816473995, "mean_action_processing_ms": 0.5120885557702992, "mean_env_wait_ms": 22.571007745102833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028490781784057617, "StateBufferConnector_ms": 0.03630685806274414, "ViewRequirementAgentConnector_ms": 0.8126997947692871}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 381258, "num_agent_steps_trained": 381258, "num_env_steps_sampled": 381258, "num_env_steps_trained": 381258, "num_env_steps_sampled_this_iter": 12350, "num_env_steps_trained_this_iter": 12350, "num_env_steps_sampled_throughput_per_sec": 225.72457177649588, "num_env_steps_trained_throughput_per_sec": 225.72457177649588, "timesteps_total": 381258, "num_steps_trained_this_iter": 12350, "agent_timesteps_total": 381258, "timers": {"training_iteration_time_ms": 62795.629, "sample_time_ms": 39169.251, "load_time_ms": 2548.594, "load_throughput": 5651.115, "learn_time_ms": 20439.625, "learn_throughput": 704.631, "synch_weights_time_ms": 524.395}, "counters": {"num_env_steps_sampled": 381258, "num_env_steps_trained": 381258, "num_agent_steps_sampled": 381258, "num_agent_steps_trained": 381258}, "done": false, "episodes_total": 450, "training_iteration": 32, "trial_id": "837cb_00000", "date": "2025-06-07_17-54-58", "timestamp": 1749311698, "time_this_iter_s": 54.734702587127686, "time_total_s": 1756.190619468689, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1756.190619468689, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 62.017187500000006, "ram_util_percent": 88.73906249999999, "gpu_util_percent0": 0.19171875, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.618742000000001e-05, "total_loss": -0.10178187738257376, "policy_loss": 0.005055521806141107, "vf_loss": 0.0439601378206333, "vf_explained_var": 0.9308853302218697, "kl": 0.01312429741109725, "entropy": 14.930817801735618, "entropy_coeff": 0.008093710000000004}, "model": {}, "num_grad_updates_lifetime": 13715.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 396896, "num_env_steps_trained": 396896, "num_agent_steps_sampled": 396896, "num_agent_steps_trained": 396896}, "sampler_results": {"episode_reward_max": 78.0577016911605, "episode_reward_min": -24.571288759749095, "episode_reward_mean": 39.24345678834039, "episode_len_mean": 1001.92, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.267452933513596, 4.232394740022486, 8.8291269082843, 13.550072429189864, 6.831241041389358, 52.40016109645307, 50.60311273525488, 20.982850014781533, 10.560794544832417, 14.000971496836806, 13.287514086239616, 6.818973713145283, 16.71777866657673, 32.08684549491114, 44.151077874930166, 50.75004006395042, 18.80073144252757, 18.10664641945574, 42.247989144123416, 66.53426990518669, 34.39010076120998, -24.571288759749095, 64.59879676552718, 19.29683159328632, 36.472970439952654, 55.07670231645529, 4.698720562129515, 71.09889149659095, 19.89667903565069, 60.17627012410464, 8.474567084946372, 18.273716529661158, 36.157596114809664, 10.016976731425467, 27.470127839378996, 61.13437333564291, 30.083907977802237, 74.48449654651834, 73.99672189937274, 33.17114859924176, 38.482583192373056, 76.88668189063858, 37.34559776439353, 60.004028367823935, 12.827351992035616, 71.28427970492557, 30.82185319704709, 56.6344397351523, 51.250358740943206, 14.928634441408407, 77.8455824012334, 47.324719353556894, 67.85425866808207, 43.34280694485879, 73.26589729528465, 13.31056804037409, 40.144954002408596, 62.061702558556455, 68.33301050068282, 34.26930675984251, -0.38380128152377735, 13.62444607005797, 34.13702832196986, 59.467809535958864, 61.210009525856, 45.282178972810236, 44.13221547141673, 31.98380004483181, 28.550956345074965, 65.82376004704531, 2.2341406122506915, 48.43910728812813, 60.846679823301365, 24.145760202108825, 45.55507832712969, 12.213434275593261, 63.087718857691726, 8.030345701397428, 46.27759007992771, 9.164982326134968, 53.89603271245526, 33.65616034420937, 12.52170012945473, 10.832621494446627, 78.0577016911605, 52.354496030132346, 65.02724580211901, 50.91770517194136, 25.71387206674831, 70.13160372263349, 60.305633699737484, 63.02952822616673, 61.14248940582775, 31.941067268424565, 57.62027690634801, 69.72151681078998, 59.9158665012978, 2.0981247383566557, 63.492642542364955, 73.76918572507752], "episode_lengths": [1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.442176846953181, "mean_inference_ms": 7.11474180153743, "mean_action_processing_ms": 0.5122465553559142, "mean_env_wait_ms": 22.5868237758596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02356553077697754, "StateBufferConnector_ms": 0.04380536079406738, "ViewRequirementAgentConnector_ms": 0.802567720413208}}, "episode_reward_max": 78.0577016911605, "episode_reward_min": -24.571288759749095, "episode_reward_mean": 39.24345678834039, "episode_len_mean": 1001.92, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.267452933513596, 4.232394740022486, 8.8291269082843, 13.550072429189864, 6.831241041389358, 52.40016109645307, 50.60311273525488, 20.982850014781533, 10.560794544832417, 14.000971496836806, 13.287514086239616, 6.818973713145283, 16.71777866657673, 32.08684549491114, 44.151077874930166, 50.75004006395042, 18.80073144252757, 18.10664641945574, 42.247989144123416, 66.53426990518669, 34.39010076120998, -24.571288759749095, 64.59879676552718, 19.29683159328632, 36.472970439952654, 55.07670231645529, 4.698720562129515, 71.09889149659095, 19.89667903565069, 60.17627012410464, 8.474567084946372, 18.273716529661158, 36.157596114809664, 10.016976731425467, 27.470127839378996, 61.13437333564291, 30.083907977802237, 74.48449654651834, 73.99672189937274, 33.17114859924176, 38.482583192373056, 76.88668189063858, 37.34559776439353, 60.004028367823935, 12.827351992035616, 71.28427970492557, 30.82185319704709, 56.6344397351523, 51.250358740943206, 14.928634441408407, 77.8455824012334, 47.324719353556894, 67.85425866808207, 43.34280694485879, 73.26589729528465, 13.31056804037409, 40.144954002408596, 62.061702558556455, 68.33301050068282, 34.26930675984251, -0.38380128152377735, 13.62444607005797, 34.13702832196986, 59.467809535958864, 61.210009525856, 45.282178972810236, 44.13221547141673, 31.98380004483181, 28.550956345074965, 65.82376004704531, 2.2341406122506915, 48.43910728812813, 60.846679823301365, 24.145760202108825, 45.55507832712969, 12.213434275593261, 63.087718857691726, 8.030345701397428, 46.27759007992771, 9.164982326134968, 53.89603271245526, 33.65616034420937, 12.52170012945473, 10.832621494446627, 78.0577016911605, 52.354496030132346, 65.02724580211901, 50.91770517194136, 25.71387206674831, 70.13160372263349, 60.305633699737484, 63.02952822616673, 61.14248940582775, 31.941067268424565, 57.62027690634801, 69.72151681078998, 59.9158665012978, 2.0981247383566557, 63.492642542364955, 73.76918572507752], "episode_lengths": [1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.442176846953181, "mean_inference_ms": 7.11474180153743, "mean_action_processing_ms": 0.5122465553559142, "mean_env_wait_ms": 22.5868237758596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02356553077697754, "StateBufferConnector_ms": 0.04380536079406738, "ViewRequirementAgentConnector_ms": 0.802567720413208}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396896, "num_agent_steps_trained": 396896, "num_env_steps_sampled": 396896, "num_env_steps_trained": 396896, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 233.84337156812336, "num_env_steps_trained_throughput_per_sec": 233.84337156812336, "timesteps_total": 396896, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 396896, "timers": {"training_iteration_time_ms": 63207.343, "sample_time_ms": 39451.425, "load_time_ms": 2554.201, "load_throughput": 5671.91, "learn_time_ms": 20526.793, "learn_throughput": 705.77, "synch_weights_time_ms": 558.975}, "counters": {"num_env_steps_sampled": 396896, "num_env_steps_trained": 396896, "num_agent_steps_sampled": 396896, "num_agent_steps_trained": 396896}, "done": false, "episodes_total": 464, "training_iteration": 33, "trial_id": "837cb_00000", "date": "2025-06-07_17-56-05", "timestamp": 1749311765, "time_this_iter_s": 66.89449048042297, "time_total_s": 1823.085109949112, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1823.085109949112, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 65.26666666666667, "ram_util_percent": 90.11794871794869, "gpu_util_percent0": 0.22448717948717947, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.603103999999999e-05, "total_loss": -0.10424610027481461, "policy_loss": 0.0017177768466353882, "vf_loss": 0.04440362496176162, "vf_explained_var": 0.9199276156150378, "kl": 0.012675683510427077, "entropy": 14.98058723302988, "entropy_coeff": 0.008015519999999998}, "model": {}, "num_grad_updates_lifetime": 14250.5, "diff_num_grad_updates_vs_sampler_policy": 259.5}}, "num_env_steps_sampled": 411712, "num_env_steps_trained": 411712, "num_agent_steps_sampled": 411712, "num_agent_steps_trained": 411712}, "sampler_results": {"episode_reward_max": 78.0577016911605, "episode_reward_min": -24.571288759749095, "episode_reward_mean": 42.85639491716395, "episode_len_mean": 1026.58, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.151077874930166, 50.75004006395042, 18.80073144252757, 18.10664641945574, 42.247989144123416, 66.53426990518669, 34.39010076120998, -24.571288759749095, 64.59879676552718, 19.29683159328632, 36.472970439952654, 55.07670231645529, 4.698720562129515, 71.09889149659095, 19.89667903565069, 60.17627012410464, 8.474567084946372, 18.273716529661158, 36.157596114809664, 10.016976731425467, 27.470127839378996, 61.13437333564291, 30.083907977802237, 74.48449654651834, 73.99672189937274, 33.17114859924176, 38.482583192373056, 76.88668189063858, 37.34559776439353, 60.004028367823935, 12.827351992035616, 71.28427970492557, 30.82185319704709, 56.6344397351523, 51.250358740943206, 14.928634441408407, 77.8455824012334, 47.324719353556894, 67.85425866808207, 43.34280694485879, 73.26589729528465, 13.31056804037409, 40.144954002408596, 62.061702558556455, 68.33301050068282, 34.26930675984251, -0.38380128152377735, 13.62444607005797, 34.13702832196986, 59.467809535958864, 61.210009525856, 45.282178972810236, 44.13221547141673, 31.98380004483181, 28.550956345074965, 65.82376004704531, 2.2341406122506915, 48.43910728812813, 60.846679823301365, 24.145760202108825, 45.55507832712969, 12.213434275593261, 63.087718857691726, 8.030345701397428, 46.27759007992771, 9.164982326134968, 53.89603271245526, 33.65616034420937, 12.52170012945473, 10.832621494446627, 78.0577016911605, 52.354496030132346, 65.02724580211901, 50.91770517194136, 25.71387206674831, 70.13160372263349, 60.305633699737484, 63.02952822616673, 61.14248940582775, 31.941067268424565, 57.62027690634801, 69.72151681078998, 59.9158665012978, 2.0981247383566557, 63.492642542364955, 73.76918572507752, 49.87375050161306, 53.30137852690547, 35.845406057808944, 61.37784232576941, 72.41189847659278, 11.092486430215367, 24.659550656813387, 52.26191836186776, 21.473209412745806, 34.68849199614599, 73.7992132898529, 38.5363830515239, 63.90806929431784, 59.23350440161405], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4508350239607206, "mean_inference_ms": 7.1177233247540395, "mean_action_processing_ms": 0.5126252375866599, "mean_env_wait_ms": 22.611567052602805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024062156677246094, "StateBufferConnector_ms": 0.04926633834838867, "ViewRequirementAgentConnector_ms": 0.8059670925140381}}, "episode_reward_max": 78.0577016911605, "episode_reward_min": -24.571288759749095, "episode_reward_mean": 42.85639491716395, "episode_len_mean": 1026.58, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.151077874930166, 50.75004006395042, 18.80073144252757, 18.10664641945574, 42.247989144123416, 66.53426990518669, 34.39010076120998, -24.571288759749095, 64.59879676552718, 19.29683159328632, 36.472970439952654, 55.07670231645529, 4.698720562129515, 71.09889149659095, 19.89667903565069, 60.17627012410464, 8.474567084946372, 18.273716529661158, 36.157596114809664, 10.016976731425467, 27.470127839378996, 61.13437333564291, 30.083907977802237, 74.48449654651834, 73.99672189937274, 33.17114859924176, 38.482583192373056, 76.88668189063858, 37.34559776439353, 60.004028367823935, 12.827351992035616, 71.28427970492557, 30.82185319704709, 56.6344397351523, 51.250358740943206, 14.928634441408407, 77.8455824012334, 47.324719353556894, 67.85425866808207, 43.34280694485879, 73.26589729528465, 13.31056804037409, 40.144954002408596, 62.061702558556455, 68.33301050068282, 34.26930675984251, -0.38380128152377735, 13.62444607005797, 34.13702832196986, 59.467809535958864, 61.210009525856, 45.282178972810236, 44.13221547141673, 31.98380004483181, 28.550956345074965, 65.82376004704531, 2.2341406122506915, 48.43910728812813, 60.846679823301365, 24.145760202108825, 45.55507832712969, 12.213434275593261, 63.087718857691726, 8.030345701397428, 46.27759007992771, 9.164982326134968, 53.89603271245526, 33.65616034420937, 12.52170012945473, 10.832621494446627, 78.0577016911605, 52.354496030132346, 65.02724580211901, 50.91770517194136, 25.71387206674831, 70.13160372263349, 60.305633699737484, 63.02952822616673, 61.14248940582775, 31.941067268424565, 57.62027690634801, 69.72151681078998, 59.9158665012978, 2.0981247383566557, 63.492642542364955, 73.76918572507752, 49.87375050161306, 53.30137852690547, 35.845406057808944, 61.37784232576941, 72.41189847659278, 11.092486430215367, 24.659550656813387, 52.26191836186776, 21.473209412745806, 34.68849199614599, 73.7992132898529, 38.5363830515239, 63.90806929431784, 59.23350440161405], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4508350239607206, "mean_inference_ms": 7.1177233247540395, "mean_action_processing_ms": 0.5126252375866599, "mean_env_wait_ms": 22.611567052602805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024062156677246094, "StateBufferConnector_ms": 0.04926633834838867, "ViewRequirementAgentConnector_ms": 0.8059670925140381}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 411712, "num_agent_steps_trained": 411712, "num_env_steps_sampled": 411712, "num_env_steps_trained": 411712, "num_env_steps_sampled_this_iter": 14816, "num_env_steps_trained_this_iter": 14816, "num_env_steps_sampled_throughput_per_sec": 231.4974378239819, "num_env_steps_trained_throughput_per_sec": 231.4974378239819, "timesteps_total": 411712, "num_steps_trained_this_iter": 14816, "agent_timesteps_total": 411712, "timers": {"training_iteration_time_ms": 62599.842, "sample_time_ms": 39378.791, "load_time_ms": 2249.413, "load_throughput": 6403.892, "learn_time_ms": 20286.097, "learn_throughput": 710.092, "synch_weights_time_ms": 563.574}, "counters": {"num_env_steps_sampled": 411712, "num_env_steps_trained": 411712, "num_agent_steps_sampled": 411712, "num_agent_steps_trained": 411712}, "done": false, "episodes_total": 478, "training_iteration": 34, "trial_id": "837cb_00000", "date": "2025-06-07_17-57-09", "timestamp": 1749311829, "time_this_iter_s": 64.01799035072327, "time_total_s": 1887.1031002998352, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1887.1031002998352, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 65.816, "ram_util_percent": 89.97466666666668, "gpu_util_percent0": 0.21159999999999998, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.588288e-05, "total_loss": -0.10550752889203767, "policy_loss": 0.0004613892072274421, "vf_loss": 0.042928436918793104, "vf_explained_var": 0.9286837075765316, "kl": 0.012351422297322869, "entropy": 15.062686199408311, "entropy_coeff": 0.00794144}, "model": {}, "num_grad_updates_lifetime": 14770.5, "diff_num_grad_updates_vs_sampler_policy": 259.5}}, "num_env_steps_sampled": 426528, "num_env_steps_trained": 426528, "num_agent_steps_sampled": 426528, "num_agent_steps_trained": 426528}, "sampler_results": {"episode_reward_max": 78.0577016911605, "episode_reward_min": -0.38380128152377735, "episode_reward_mean": 44.799681639812505, "episode_len_mean": 1018.36, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.89667903565069, 60.17627012410464, 8.474567084946372, 18.273716529661158, 36.157596114809664, 10.016976731425467, 27.470127839378996, 61.13437333564291, 30.083907977802237, 74.48449654651834, 73.99672189937274, 33.17114859924176, 38.482583192373056, 76.88668189063858, 37.34559776439353, 60.004028367823935, 12.827351992035616, 71.28427970492557, 30.82185319704709, 56.6344397351523, 51.250358740943206, 14.928634441408407, 77.8455824012334, 47.324719353556894, 67.85425866808207, 43.34280694485879, 73.26589729528465, 13.31056804037409, 40.144954002408596, 62.061702558556455, 68.33301050068282, 34.26930675984251, -0.38380128152377735, 13.62444607005797, 34.13702832196986, 59.467809535958864, 61.210009525856, 45.282178972810236, 44.13221547141673, 31.98380004483181, 28.550956345074965, 65.82376004704531, 2.2341406122506915, 48.43910728812813, 60.846679823301365, 24.145760202108825, 45.55507832712969, 12.213434275593261, 63.087718857691726, 8.030345701397428, 46.27759007992771, 9.164982326134968, 53.89603271245526, 33.65616034420937, 12.52170012945473, 10.832621494446627, 78.0577016911605, 52.354496030132346, 65.02724580211901, 50.91770517194136, 25.71387206674831, 70.13160372263349, 60.305633699737484, 63.02952822616673, 61.14248940582775, 31.941067268424565, 57.62027690634801, 69.72151681078998, 59.9158665012978, 2.0981247383566557, 63.492642542364955, 73.76918572507752, 49.87375050161306, 53.30137852690547, 35.845406057808944, 61.37784232576941, 72.41189847659278, 11.092486430215367, 24.659550656813387, 52.26191836186776, 21.473209412745806, 34.68849199614599, 73.7992132898529, 38.5363830515239, 63.90806929431784, 59.23350440161405, 8.889371468597036, 56.2477209789239, 49.27172128179167, 37.56067475625177, 58.60286098993462, 13.42534646362189, 75.44104552760292, 57.954498098113746, 56.642533871178514, 58.30395405684118, 67.87431273937594, 41.589538672737675, 57.44232807514173, 56.73524531032046], "episode_lengths": [1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4576552159026304, "mean_inference_ms": 7.120883781982092, "mean_action_processing_ms": 0.5130506023435256, "mean_env_wait_ms": 22.63798136970001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026125431060791016, "StateBufferConnector_ms": 0.04531574249267578, "ViewRequirementAgentConnector_ms": 0.7868926525115967}}, "episode_reward_max": 78.0577016911605, "episode_reward_min": -0.38380128152377735, "episode_reward_mean": 44.799681639812505, "episode_len_mean": 1018.36, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.89667903565069, 60.17627012410464, 8.474567084946372, 18.273716529661158, 36.157596114809664, 10.016976731425467, 27.470127839378996, 61.13437333564291, 30.083907977802237, 74.48449654651834, 73.99672189937274, 33.17114859924176, 38.482583192373056, 76.88668189063858, 37.34559776439353, 60.004028367823935, 12.827351992035616, 71.28427970492557, 30.82185319704709, 56.6344397351523, 51.250358740943206, 14.928634441408407, 77.8455824012334, 47.324719353556894, 67.85425866808207, 43.34280694485879, 73.26589729528465, 13.31056804037409, 40.144954002408596, 62.061702558556455, 68.33301050068282, 34.26930675984251, -0.38380128152377735, 13.62444607005797, 34.13702832196986, 59.467809535958864, 61.210009525856, 45.282178972810236, 44.13221547141673, 31.98380004483181, 28.550956345074965, 65.82376004704531, 2.2341406122506915, 48.43910728812813, 60.846679823301365, 24.145760202108825, 45.55507832712969, 12.213434275593261, 63.087718857691726, 8.030345701397428, 46.27759007992771, 9.164982326134968, 53.89603271245526, 33.65616034420937, 12.52170012945473, 10.832621494446627, 78.0577016911605, 52.354496030132346, 65.02724580211901, 50.91770517194136, 25.71387206674831, 70.13160372263349, 60.305633699737484, 63.02952822616673, 61.14248940582775, 31.941067268424565, 57.62027690634801, 69.72151681078998, 59.9158665012978, 2.0981247383566557, 63.492642542364955, 73.76918572507752, 49.87375050161306, 53.30137852690547, 35.845406057808944, 61.37784232576941, 72.41189847659278, 11.092486430215367, 24.659550656813387, 52.26191836186776, 21.473209412745806, 34.68849199614599, 73.7992132898529, 38.5363830515239, 63.90806929431784, 59.23350440161405, 8.889371468597036, 56.2477209789239, 49.27172128179167, 37.56067475625177, 58.60286098993462, 13.42534646362189, 75.44104552760292, 57.954498098113746, 56.642533871178514, 58.30395405684118, 67.87431273937594, 41.589538672737675, 57.44232807514173, 56.73524531032046], "episode_lengths": [1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4576552159026304, "mean_inference_ms": 7.120883781982092, "mean_action_processing_ms": 0.5130506023435256, "mean_env_wait_ms": 22.63798136970001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026125431060791016, "StateBufferConnector_ms": 0.04531574249267578, "ViewRequirementAgentConnector_ms": 0.7868926525115967}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 426528, "num_agent_steps_trained": 426528, "num_env_steps_sampled": 426528, "num_env_steps_trained": 426528, "num_env_steps_sampled_this_iter": 14816, "num_env_steps_trained_this_iter": 14816, "num_env_steps_sampled_throughput_per_sec": 233.35087039715413, "num_env_steps_trained_throughput_per_sec": 233.35087039715413, "timesteps_total": 426528, "num_steps_trained_this_iter": 14816, "agent_timesteps_total": 426528, "timers": {"training_iteration_time_ms": 62170.752, "sample_time_ms": 39329.043, "load_time_ms": 2112.985, "load_throughput": 6778.466, "learn_time_ms": 20047.101, "learn_throughput": 714.457, "synch_weights_time_ms": 563.055}, "counters": {"num_env_steps_sampled": 426528, "num_env_steps_trained": 426528, "num_agent_steps_sampled": 426528, "num_agent_steps_trained": 426528}, "done": false, "episodes_total": 492, "training_iteration": 35, "trial_id": "837cb_00000", "date": "2025-06-07_17-58-13", "timestamp": 1749311893, "time_this_iter_s": 63.515368700027466, "time_total_s": 1950.6184689998627, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1950.6184689998627, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 66.88767123287671, "ram_util_percent": 89.34794520547946, "gpu_util_percent0": 0.20027397260273974, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.573472000000003e-05, "total_loss": -0.13050287792416798, "policy_loss": -0.023293260097336975, "vf_loss": 0.03475220427594402, "vf_explained_var": 0.944522898088802, "kl": 0.012770090152255513, "entropy": 15.05376858104359, "entropy_coeff": 0.007867360000000002}, "model": {}, "num_grad_updates_lifetime": 15305.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 442166, "num_env_steps_trained": 442166, "num_agent_steps_sampled": 442166, "num_agent_steps_trained": 442166}, "sampler_results": {"episode_reward_max": 78.0577016911605, "episode_reward_min": -0.38380128152377735, "episode_reward_mean": 47.44866356945515, "episode_len_mean": 1034.8, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.34559776439353, 60.004028367823935, 12.827351992035616, 71.28427970492557, 30.82185319704709, 56.6344397351523, 51.250358740943206, 14.928634441408407, 77.8455824012334, 47.324719353556894, 67.85425866808207, 43.34280694485879, 73.26589729528465, 13.31056804037409, 40.144954002408596, 62.061702558556455, 68.33301050068282, 34.26930675984251, -0.38380128152377735, 13.62444607005797, 34.13702832196986, 59.467809535958864, 61.210009525856, 45.282178972810236, 44.13221547141673, 31.98380004483181, 28.550956345074965, 65.82376004704531, 2.2341406122506915, 48.43910728812813, 60.846679823301365, 24.145760202108825, 45.55507832712969, 12.213434275593261, 63.087718857691726, 8.030345701397428, 46.27759007992771, 9.164982326134968, 53.89603271245526, 33.65616034420937, 12.52170012945473, 10.832621494446627, 78.0577016911605, 52.354496030132346, 65.02724580211901, 50.91770517194136, 25.71387206674831, 70.13160372263349, 60.305633699737484, 63.02952822616673, 61.14248940582775, 31.941067268424565, 57.62027690634801, 69.72151681078998, 59.9158665012978, 2.0981247383566557, 63.492642542364955, 73.76918572507752, 49.87375050161306, 53.30137852690547, 35.845406057808944, 61.37784232576941, 72.41189847659278, 11.092486430215367, 24.659550656813387, 52.26191836186776, 21.473209412745806, 34.68849199614599, 73.7992132898529, 38.5363830515239, 63.90806929431784, 59.23350440161405, 8.889371468597036, 56.2477209789239, 49.27172128179167, 37.56067475625177, 58.60286098993462, 13.42534646362189, 75.44104552760292, 57.954498098113746, 56.642533871178514, 58.30395405684118, 67.87431273937594, 41.589538672737675, 57.44232807514173, 56.73524531032046, 66.75277237178997, 67.75683689020953, 49.804712769170585, 50.851124078853964, 53.998766090373486, 57.7490884260678, 62.20546503203145, 63.50419963381102, 59.64964511828196, 69.93485166108054, 60.97704005871815, 37.27388908655305, 63.154359301696914, 69.99128934719178], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.464884841827867, "mean_inference_ms": 7.125590576307058, "mean_action_processing_ms": 0.5136393485794826, "mean_env_wait_ms": 22.669497967533815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027117490768432617, "StateBufferConnector_ms": 0.04618644714355469, "ViewRequirementAgentConnector_ms": 0.8319673538208008}}, "episode_reward_max": 78.0577016911605, "episode_reward_min": -0.38380128152377735, "episode_reward_mean": 47.44866356945515, "episode_len_mean": 1034.8, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.34559776439353, 60.004028367823935, 12.827351992035616, 71.28427970492557, 30.82185319704709, 56.6344397351523, 51.250358740943206, 14.928634441408407, 77.8455824012334, 47.324719353556894, 67.85425866808207, 43.34280694485879, 73.26589729528465, 13.31056804037409, 40.144954002408596, 62.061702558556455, 68.33301050068282, 34.26930675984251, -0.38380128152377735, 13.62444607005797, 34.13702832196986, 59.467809535958864, 61.210009525856, 45.282178972810236, 44.13221547141673, 31.98380004483181, 28.550956345074965, 65.82376004704531, 2.2341406122506915, 48.43910728812813, 60.846679823301365, 24.145760202108825, 45.55507832712969, 12.213434275593261, 63.087718857691726, 8.030345701397428, 46.27759007992771, 9.164982326134968, 53.89603271245526, 33.65616034420937, 12.52170012945473, 10.832621494446627, 78.0577016911605, 52.354496030132346, 65.02724580211901, 50.91770517194136, 25.71387206674831, 70.13160372263349, 60.305633699737484, 63.02952822616673, 61.14248940582775, 31.941067268424565, 57.62027690634801, 69.72151681078998, 59.9158665012978, 2.0981247383566557, 63.492642542364955, 73.76918572507752, 49.87375050161306, 53.30137852690547, 35.845406057808944, 61.37784232576941, 72.41189847659278, 11.092486430215367, 24.659550656813387, 52.26191836186776, 21.473209412745806, 34.68849199614599, 73.7992132898529, 38.5363830515239, 63.90806929431784, 59.23350440161405, 8.889371468597036, 56.2477209789239, 49.27172128179167, 37.56067475625177, 58.60286098993462, 13.42534646362189, 75.44104552760292, 57.954498098113746, 56.642533871178514, 58.30395405684118, 67.87431273937594, 41.589538672737675, 57.44232807514173, 56.73524531032046, 66.75277237178997, 67.75683689020953, 49.804712769170585, 50.851124078853964, 53.998766090373486, 57.7490884260678, 62.20546503203145, 63.50419963381102, 59.64964511828196, 69.93485166108054, 60.97704005871815, 37.27388908655305, 63.154359301696914, 69.99128934719178], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.464884841827867, "mean_inference_ms": 7.125590576307058, "mean_action_processing_ms": 0.5136393485794826, "mean_env_wait_ms": 22.669497967533815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027117490768432617, "StateBufferConnector_ms": 0.04618644714355469, "ViewRequirementAgentConnector_ms": 0.8319673538208008}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 442166, "num_agent_steps_trained": 442166, "num_env_steps_sampled": 442166, "num_env_steps_trained": 442166, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 231.43981112997372, "num_env_steps_trained_throughput_per_sec": 231.43981112997372, "timesteps_total": 442166, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 442166, "timers": {"training_iteration_time_ms": 61868.623, "sample_time_ms": 39203.9, "load_time_ms": 2092.325, "load_throughput": 6845.398, "learn_time_ms": 19821.376, "learn_throughput": 722.594, "synch_weights_time_ms": 630.907}, "counters": {"num_env_steps_sampled": 442166, "num_env_steps_trained": 442166, "num_agent_steps_sampled": 442166, "num_agent_steps_trained": 442166}, "done": false, "episodes_total": 506, "training_iteration": 36, "trial_id": "837cb_00000", "date": "2025-06-07_17-59-20", "timestamp": 1749311960, "time_this_iter_s": 67.58735227584839, "time_total_s": 2018.205821275711, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2018.205821275711, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 65.05949367088608, "ram_util_percent": 89.94050632911389, "gpu_util_percent0": 0.22303797468354428, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.557833999999998e-05, "total_loss": -0.11142986320684521, "policy_loss": -0.006766315239992065, "vf_loss": 0.04158461343971654, "vf_explained_var": 0.934180166056523, "kl": 0.012725475938575481, "entropy": 15.140801998285147, "entropy_coeff": 0.007789169999999998}, "model": {}, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 259.5}}, "num_env_steps_sampled": 456982, "num_env_steps_trained": 456982, "num_agent_steps_sampled": 456982, "num_agent_steps_trained": 456982}, "sampler_results": {"episode_reward_max": 78.0577016911605, "episode_reward_min": -0.38380128152377735, "episode_reward_mean": 47.78448660803941, "episode_len_mean": 1051.24, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.144954002408596, 62.061702558556455, 68.33301050068282, 34.26930675984251, -0.38380128152377735, 13.62444607005797, 34.13702832196986, 59.467809535958864, 61.210009525856, 45.282178972810236, 44.13221547141673, 31.98380004483181, 28.550956345074965, 65.82376004704531, 2.2341406122506915, 48.43910728812813, 60.846679823301365, 24.145760202108825, 45.55507832712969, 12.213434275593261, 63.087718857691726, 8.030345701397428, 46.27759007992771, 9.164982326134968, 53.89603271245526, 33.65616034420937, 12.52170012945473, 10.832621494446627, 78.0577016911605, 52.354496030132346, 65.02724580211901, 50.91770517194136, 25.71387206674831, 70.13160372263349, 60.305633699737484, 63.02952822616673, 61.14248940582775, 31.941067268424565, 57.62027690634801, 69.72151681078998, 59.9158665012978, 2.0981247383566557, 63.492642542364955, 73.76918572507752, 49.87375050161306, 53.30137852690547, 35.845406057808944, 61.37784232576941, 72.41189847659278, 11.092486430215367, 24.659550656813387, 52.26191836186776, 21.473209412745806, 34.68849199614599, 73.7992132898529, 38.5363830515239, 63.90806929431784, 59.23350440161405, 8.889371468597036, 56.2477209789239, 49.27172128179167, 37.56067475625177, 58.60286098993462, 13.42534646362189, 75.44104552760292, 57.954498098113746, 56.642533871178514, 58.30395405684118, 67.87431273937594, 41.589538672737675, 57.44232807514173, 56.73524531032046, 66.75277237178997, 67.75683689020953, 49.804712769170585, 50.851124078853964, 53.998766090373486, 57.7490884260678, 62.20546503203145, 63.50419963381102, 59.64964511828196, 69.93485166108054, 60.97704005871815, 37.27388908655305, 63.154359301696914, 69.99128934719178, 65.87342525792184, 59.8991939219771, 37.76150584804143, 63.25267618411338, 59.24029321447736, 39.245872593028935, 47.55290720696209, 53.33784647961683, 25.71950618234858, 66.86709559627282, 43.50744812500538, 4.508602358406076, 52.58898622745309, 72.26732130992065], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.472981075445565, "mean_inference_ms": 7.130916165383159, "mean_action_processing_ms": 0.5142043735242247, "mean_env_wait_ms": 22.702804091855015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03017258644104004, "StateBufferConnector_ms": 0.04819464683532715, "ViewRequirementAgentConnector_ms": 0.8498208522796631}}, "episode_reward_max": 78.0577016911605, "episode_reward_min": -0.38380128152377735, "episode_reward_mean": 47.78448660803941, "episode_len_mean": 1051.24, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.144954002408596, 62.061702558556455, 68.33301050068282, 34.26930675984251, -0.38380128152377735, 13.62444607005797, 34.13702832196986, 59.467809535958864, 61.210009525856, 45.282178972810236, 44.13221547141673, 31.98380004483181, 28.550956345074965, 65.82376004704531, 2.2341406122506915, 48.43910728812813, 60.846679823301365, 24.145760202108825, 45.55507832712969, 12.213434275593261, 63.087718857691726, 8.030345701397428, 46.27759007992771, 9.164982326134968, 53.89603271245526, 33.65616034420937, 12.52170012945473, 10.832621494446627, 78.0577016911605, 52.354496030132346, 65.02724580211901, 50.91770517194136, 25.71387206674831, 70.13160372263349, 60.305633699737484, 63.02952822616673, 61.14248940582775, 31.941067268424565, 57.62027690634801, 69.72151681078998, 59.9158665012978, 2.0981247383566557, 63.492642542364955, 73.76918572507752, 49.87375050161306, 53.30137852690547, 35.845406057808944, 61.37784232576941, 72.41189847659278, 11.092486430215367, 24.659550656813387, 52.26191836186776, 21.473209412745806, 34.68849199614599, 73.7992132898529, 38.5363830515239, 63.90806929431784, 59.23350440161405, 8.889371468597036, 56.2477209789239, 49.27172128179167, 37.56067475625177, 58.60286098993462, 13.42534646362189, 75.44104552760292, 57.954498098113746, 56.642533871178514, 58.30395405684118, 67.87431273937594, 41.589538672737675, 57.44232807514173, 56.73524531032046, 66.75277237178997, 67.75683689020953, 49.804712769170585, 50.851124078853964, 53.998766090373486, 57.7490884260678, 62.20546503203145, 63.50419963381102, 59.64964511828196, 69.93485166108054, 60.97704005871815, 37.27388908655305, 63.154359301696914, 69.99128934719178, 65.87342525792184, 59.8991939219771, 37.76150584804143, 63.25267618411338, 59.24029321447736, 39.245872593028935, 47.55290720696209, 53.33784647961683, 25.71950618234858, 66.86709559627282, 43.50744812500538, 4.508602358406076, 52.58898622745309, 72.26732130992065], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.472981075445565, "mean_inference_ms": 7.130916165383159, "mean_action_processing_ms": 0.5142043735242247, "mean_env_wait_ms": 22.702804091855015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03017258644104004, "StateBufferConnector_ms": 0.04819464683532715, "ViewRequirementAgentConnector_ms": 0.8498208522796631}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456982, "num_agent_steps_trained": 456982, "num_env_steps_sampled": 456982, "num_env_steps_trained": 456982, "num_env_steps_sampled_this_iter": 14816, "num_env_steps_trained_this_iter": 14816, "num_env_steps_sampled_throughput_per_sec": 233.43154393639378, "num_env_steps_trained_throughput_per_sec": 233.43154393639378, "timesteps_total": 456982, "num_steps_trained_this_iter": 14816, "agent_timesteps_total": 456982, "timers": {"training_iteration_time_ms": 62793.249, "sample_time_ms": 39711.629, "load_time_ms": 2147.405, "load_throughput": 6784.654, "learn_time_ms": 20173.705, "learn_throughput": 722.198, "synch_weights_time_ms": 637.547}, "counters": {"num_env_steps_sampled": 456982, "num_env_steps_trained": 456982, "num_agent_steps_sampled": 456982, "num_agent_steps_trained": 456982}, "done": false, "episodes_total": 520, "training_iteration": 37, "trial_id": "837cb_00000", "date": "2025-06-07_18-00-24", "timestamp": 1749312024, "time_this_iter_s": 63.53542709350586, "time_total_s": 2081.741248369217, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2081.741248369217, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 65.25733333333332, "ram_util_percent": 89.35733333333334, "gpu_util_percent0": 0.21106666666666668, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.543017999999998e-05, "total_loss": -0.10960648476019164, "policy_loss": -0.0055207582877218634, "vf_loss": 0.041313111867162994, "vf_explained_var": 0.9372226805036719, "kl": 0.012864725013709286, "entropy": 15.201858244809237, "entropy_coeff": 0.00771509}, "model": {}, "num_grad_updates_lifetime": 16375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 472620, "num_env_steps_trained": 472620, "num_agent_steps_sampled": 472620, "num_agent_steps_trained": 472620}, "sampler_results": {"episode_reward_max": 78.0577016911605, "episode_reward_min": 2.0981247383566557, "episode_reward_mean": 49.52529497247311, "episode_len_mean": 1059.46, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.2341406122506915, 48.43910728812813, 60.846679823301365, 24.145760202108825, 45.55507832712969, 12.213434275593261, 63.087718857691726, 8.030345701397428, 46.27759007992771, 9.164982326134968, 53.89603271245526, 33.65616034420937, 12.52170012945473, 10.832621494446627, 78.0577016911605, 52.354496030132346, 65.02724580211901, 50.91770517194136, 25.71387206674831, 70.13160372263349, 60.305633699737484, 63.02952822616673, 61.14248940582775, 31.941067268424565, 57.62027690634801, 69.72151681078998, 59.9158665012978, 2.0981247383566557, 63.492642542364955, 73.76918572507752, 49.87375050161306, 53.30137852690547, 35.845406057808944, 61.37784232576941, 72.41189847659278, 11.092486430215367, 24.659550656813387, 52.26191836186776, 21.473209412745806, 34.68849199614599, 73.7992132898529, 38.5363830515239, 63.90806929431784, 59.23350440161405, 8.889371468597036, 56.2477209789239, 49.27172128179167, 37.56067475625177, 58.60286098993462, 13.42534646362189, 75.44104552760292, 57.954498098113746, 56.642533871178514, 58.30395405684118, 67.87431273937594, 41.589538672737675, 57.44232807514173, 56.73524531032046, 66.75277237178997, 67.75683689020953, 49.804712769170585, 50.851124078853964, 53.998766090373486, 57.7490884260678, 62.20546503203145, 63.50419963381102, 59.64964511828196, 69.93485166108054, 60.97704005871815, 37.27388908655305, 63.154359301696914, 69.99128934719178, 65.87342525792184, 59.8991939219771, 37.76150584804143, 63.25267618411338, 59.24029321447736, 39.245872593028935, 47.55290720696209, 53.33784647961683, 25.71950618234858, 66.86709559627282, 43.50744812500538, 4.508602358406076, 52.58898622745309, 72.26732130992065, 65.78478450652561, 68.77171490001055, 42.09569638123284, 55.757466985996984, 73.59065804690313, 58.434427375147195, 27.98301818464334, 69.14376699758857, 66.45031668935354, 62.3608728614588, 59.17938725903291, 48.90886974836036, 3.648019019763625, 60.60921436234102], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.479925251407681, "mean_inference_ms": 7.138133405040492, "mean_action_processing_ms": 0.5149461577527501, "mean_env_wait_ms": 22.7423791682997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03312206268310547, "StateBufferConnector_ms": 0.04482388496398926, "ViewRequirementAgentConnector_ms": 0.8975818157196045}}, "episode_reward_max": 78.0577016911605, "episode_reward_min": 2.0981247383566557, "episode_reward_mean": 49.52529497247311, "episode_len_mean": 1059.46, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.2341406122506915, 48.43910728812813, 60.846679823301365, 24.145760202108825, 45.55507832712969, 12.213434275593261, 63.087718857691726, 8.030345701397428, 46.27759007992771, 9.164982326134968, 53.89603271245526, 33.65616034420937, 12.52170012945473, 10.832621494446627, 78.0577016911605, 52.354496030132346, 65.02724580211901, 50.91770517194136, 25.71387206674831, 70.13160372263349, 60.305633699737484, 63.02952822616673, 61.14248940582775, 31.941067268424565, 57.62027690634801, 69.72151681078998, 59.9158665012978, 2.0981247383566557, 63.492642542364955, 73.76918572507752, 49.87375050161306, 53.30137852690547, 35.845406057808944, 61.37784232576941, 72.41189847659278, 11.092486430215367, 24.659550656813387, 52.26191836186776, 21.473209412745806, 34.68849199614599, 73.7992132898529, 38.5363830515239, 63.90806929431784, 59.23350440161405, 8.889371468597036, 56.2477209789239, 49.27172128179167, 37.56067475625177, 58.60286098993462, 13.42534646362189, 75.44104552760292, 57.954498098113746, 56.642533871178514, 58.30395405684118, 67.87431273937594, 41.589538672737675, 57.44232807514173, 56.73524531032046, 66.75277237178997, 67.75683689020953, 49.804712769170585, 50.851124078853964, 53.998766090373486, 57.7490884260678, 62.20546503203145, 63.50419963381102, 59.64964511828196, 69.93485166108054, 60.97704005871815, 37.27388908655305, 63.154359301696914, 69.99128934719178, 65.87342525792184, 59.8991939219771, 37.76150584804143, 63.25267618411338, 59.24029321447736, 39.245872593028935, 47.55290720696209, 53.33784647961683, 25.71950618234858, 66.86709559627282, 43.50744812500538, 4.508602358406076, 52.58898622745309, 72.26732130992065, 65.78478450652561, 68.77171490001055, 42.09569638123284, 55.757466985996984, 73.59065804690313, 58.434427375147195, 27.98301818464334, 69.14376699758857, 66.45031668935354, 62.3608728614588, 59.17938725903291, 48.90886974836036, 3.648019019763625, 60.60921436234102], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.479925251407681, "mean_inference_ms": 7.138133405040492, "mean_action_processing_ms": 0.5149461577527501, "mean_env_wait_ms": 22.7423791682997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03312206268310547, "StateBufferConnector_ms": 0.04482388496398926, "ViewRequirementAgentConnector_ms": 0.8975818157196045}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472620, "num_agent_steps_trained": 472620, "num_env_steps_sampled": 472620, "num_env_steps_trained": 472620, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.57453193083765, "num_env_steps_trained_throughput_per_sec": 228.57453193083765, "timesteps_total": 472620, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 472620, "timers": {"training_iteration_time_ms": 62961.12, "sample_time_ms": 39944.523, "load_time_ms": 2146.84, "load_throughput": 6786.439, "learn_time_ms": 20118.592, "learn_throughput": 724.176, "synch_weights_time_ms": 628.625}, "counters": {"num_env_steps_sampled": 472620, "num_env_steps_trained": 472620, "num_agent_steps_sampled": 472620, "num_agent_steps_trained": 472620}, "done": false, "episodes_total": 534, "training_iteration": 38, "trial_id": "837cb_00000", "date": "2025-06-07_18-01-32", "timestamp": 1749312092, "time_this_iter_s": 68.43583559989929, "time_total_s": 2150.177083969116, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2150.177083969116, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 66.4474358974359, "ram_util_percent": 89.66282051282053, "gpu_util_percent0": 0.21756410256410255, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.527380000000004e-05, "total_loss": -0.11462917877699841, "policy_loss": -0.009863033602966673, "vf_loss": 0.0335421956631101, "vf_explained_var": 0.9404502198912881, "kl": 0.01299754333608408, "entropy": 15.14242056759921, "entropy_coeff": 0.007636900000000001}, "model": {}, "num_grad_updates_lifetime": 16925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 488258, "num_env_steps_trained": 488258, "num_agent_steps_sampled": 488258, "num_agent_steps_trained": 488258}, "sampler_results": {"episode_reward_max": 78.0577016911605, "episode_reward_min": 2.0981247383566557, "episode_reward_mean": 53.8578616150994, "episode_len_mean": 1092.34, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.0577016911605, 52.354496030132346, 65.02724580211901, 50.91770517194136, 25.71387206674831, 70.13160372263349, 60.305633699737484, 63.02952822616673, 61.14248940582775, 31.941067268424565, 57.62027690634801, 69.72151681078998, 59.9158665012978, 2.0981247383566557, 63.492642542364955, 73.76918572507752, 49.87375050161306, 53.30137852690547, 35.845406057808944, 61.37784232576941, 72.41189847659278, 11.092486430215367, 24.659550656813387, 52.26191836186776, 21.473209412745806, 34.68849199614599, 73.7992132898529, 38.5363830515239, 63.90806929431784, 59.23350440161405, 8.889371468597036, 56.2477209789239, 49.27172128179167, 37.56067475625177, 58.60286098993462, 13.42534646362189, 75.44104552760292, 57.954498098113746, 56.642533871178514, 58.30395405684118, 67.87431273937594, 41.589538672737675, 57.44232807514173, 56.73524531032046, 66.75277237178997, 67.75683689020953, 49.804712769170585, 50.851124078853964, 53.998766090373486, 57.7490884260678, 62.20546503203145, 63.50419963381102, 59.64964511828196, 69.93485166108054, 60.97704005871815, 37.27388908655305, 63.154359301696914, 69.99128934719178, 65.87342525792184, 59.8991939219771, 37.76150584804143, 63.25267618411338, 59.24029321447736, 39.245872593028935, 47.55290720696209, 53.33784647961683, 25.71950618234858, 66.86709559627282, 43.50744812500538, 4.508602358406076, 52.58898622745309, 72.26732130992065, 65.78478450652561, 68.77171490001055, 42.09569638123284, 55.757466985996984, 73.59065804690313, 58.434427375147195, 27.98301818464334, 69.14376699758857, 66.45031668935354, 62.3608728614588, 59.17938725903291, 48.90886974836036, 3.648019019763625, 60.60921436234102, 56.14229498576681, 66.6705810639215, 53.37852048672869, 62.839328905863226, 62.370445447153436, 61.090012636401546, 63.78433880097777, 76.1315939531209, 74.18053980182633, 63.60486474550046, 47.81822853469275, 40.10931291577159, 63.81175021293091, 72.22620394620382], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.488330184763481, "mean_inference_ms": 7.147702734624487, "mean_action_processing_ms": 0.5159250402313083, "mean_env_wait_ms": 22.791311930692377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03214311599731445, "StateBufferConnector_ms": 0.043845415115356445, "ViewRequirementAgentConnector_ms": 0.9674727916717529}}, "episode_reward_max": 78.0577016911605, "episode_reward_min": 2.0981247383566557, "episode_reward_mean": 53.8578616150994, "episode_len_mean": 1092.34, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [78.0577016911605, 52.354496030132346, 65.02724580211901, 50.91770517194136, 25.71387206674831, 70.13160372263349, 60.305633699737484, 63.02952822616673, 61.14248940582775, 31.941067268424565, 57.62027690634801, 69.72151681078998, 59.9158665012978, 2.0981247383566557, 63.492642542364955, 73.76918572507752, 49.87375050161306, 53.30137852690547, 35.845406057808944, 61.37784232576941, 72.41189847659278, 11.092486430215367, 24.659550656813387, 52.26191836186776, 21.473209412745806, 34.68849199614599, 73.7992132898529, 38.5363830515239, 63.90806929431784, 59.23350440161405, 8.889371468597036, 56.2477209789239, 49.27172128179167, 37.56067475625177, 58.60286098993462, 13.42534646362189, 75.44104552760292, 57.954498098113746, 56.642533871178514, 58.30395405684118, 67.87431273937594, 41.589538672737675, 57.44232807514173, 56.73524531032046, 66.75277237178997, 67.75683689020953, 49.804712769170585, 50.851124078853964, 53.998766090373486, 57.7490884260678, 62.20546503203145, 63.50419963381102, 59.64964511828196, 69.93485166108054, 60.97704005871815, 37.27388908655305, 63.154359301696914, 69.99128934719178, 65.87342525792184, 59.8991939219771, 37.76150584804143, 63.25267618411338, 59.24029321447736, 39.245872593028935, 47.55290720696209, 53.33784647961683, 25.71950618234858, 66.86709559627282, 43.50744812500538, 4.508602358406076, 52.58898622745309, 72.26732130992065, 65.78478450652561, 68.77171490001055, 42.09569638123284, 55.757466985996984, 73.59065804690313, 58.434427375147195, 27.98301818464334, 69.14376699758857, 66.45031668935354, 62.3608728614588, 59.17938725903291, 48.90886974836036, 3.648019019763625, 60.60921436234102, 56.14229498576681, 66.6705810639215, 53.37852048672869, 62.839328905863226, 62.370445447153436, 61.090012636401546, 63.78433880097777, 76.1315939531209, 74.18053980182633, 63.60486474550046, 47.81822853469275, 40.10931291577159, 63.81175021293091, 72.22620394620382], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.488330184763481, "mean_inference_ms": 7.147702734624487, "mean_action_processing_ms": 0.5159250402313083, "mean_env_wait_ms": 22.791311930692377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03214311599731445, "StateBufferConnector_ms": 0.043845415115356445, "ViewRequirementAgentConnector_ms": 0.9674727916717529}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488258, "num_agent_steps_trained": 488258, "num_env_steps_sampled": 488258, "num_env_steps_trained": 488258, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 222.21279923738018, "num_env_steps_trained_throughput_per_sec": 222.21279923738018, "timesteps_total": 488258, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 488258, "timers": {"training_iteration_time_ms": 64025.526, "sample_time_ms": 40201.659, "load_time_ms": 2309.957, "load_throughput": 6378.387, "learn_time_ms": 20760.303, "learn_throughput": 709.71, "synch_weights_time_ms": 629.909}, "counters": {"num_env_steps_sampled": 488258, "num_env_steps_trained": 488258, "num_agent_steps_sampled": 488258, "num_agent_steps_trained": 488258}, "done": false, "episodes_total": 548, "training_iteration": 39, "trial_id": "837cb_00000", "date": "2025-06-07_18-02-43", "timestamp": 1749312163, "time_this_iter_s": 70.39598774909973, "time_total_s": 2220.573071718216, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2220.573071718216, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 69.80493827160494, "ram_util_percent": 90.04320987654322, "gpu_util_percent0": 0.20802469135802468, "vram_util_percent0": 0.9650065104166666}}
{"evaluation": {"sampler_results": {"episode_reward_max": -9.91697389381149, "episode_reward_min": -14.38913091692159, "episode_reward_mean": -11.769914437630556, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.38913091692159, -12.454827953185477, -11.402984262787948, -10.685655161446276, -9.91697389381149], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7741550346069836, "mean_inference_ms": 3.9536210707561117, "mean_action_processing_ms": 0.27991060134153983, "mean_env_wait_ms": 12.639256088476536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2203083038330078}}, "episode_reward_max": -9.91697389381149, "episode_reward_min": -14.38913091692159, "episode_reward_mean": -11.769914437630556, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.38913091692159, -12.454827953185477, -11.402984262787948, -10.685655161446276, -9.91697389381149], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7741550346069836, "mean_inference_ms": 3.9536210707561117, "mean_action_processing_ms": 0.27991060134153983, "mean_env_wait_ms": 12.639256088476536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2203083038330078}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.511742e-05, "total_loss": -0.11054116788810851, "policy_loss": -0.007731680435185529, "vf_loss": 0.03697697704833723, "vf_explained_var": 0.9274433302636049, "kl": 0.012712800256049081, "entropy": 15.174167430644133, "entropy_coeff": 0.007558709999999998}, "model": {}, "num_grad_updates_lifetime": 17445.5, "diff_num_grad_updates_vs_sampler_policy": 244.5}}, "num_env_steps_sampled": 502252, "num_env_steps_trained": 502252, "num_agent_steps_sampled": 502252, "num_agent_steps_trained": 502252}, "sampler_results": {"episode_reward_max": 76.1315939531209, "episode_reward_min": 3.648019019763625, "episode_reward_mean": 53.331536037259724, "episode_len_mean": 1075.9, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.492642542364955, 73.76918572507752, 49.87375050161306, 53.30137852690547, 35.845406057808944, 61.37784232576941, 72.41189847659278, 11.092486430215367, 24.659550656813387, 52.26191836186776, 21.473209412745806, 34.68849199614599, 73.7992132898529, 38.5363830515239, 63.90806929431784, 59.23350440161405, 8.889371468597036, 56.2477209789239, 49.27172128179167, 37.56067475625177, 58.60286098993462, 13.42534646362189, 75.44104552760292, 57.954498098113746, 56.642533871178514, 58.30395405684118, 67.87431273937594, 41.589538672737675, 57.44232807514173, 56.73524531032046, 66.75277237178997, 67.75683689020953, 49.804712769170585, 50.851124078853964, 53.998766090373486, 57.7490884260678, 62.20546503203145, 63.50419963381102, 59.64964511828196, 69.93485166108054, 60.97704005871815, 37.27388908655305, 63.154359301696914, 69.99128934719178, 65.87342525792184, 59.8991939219771, 37.76150584804143, 63.25267618411338, 59.24029321447736, 39.245872593028935, 47.55290720696209, 53.33784647961683, 25.71950618234858, 66.86709559627282, 43.50744812500538, 4.508602358406076, 52.58898622745309, 72.26732130992065, 65.78478450652561, 68.77171490001055, 42.09569638123284, 55.757466985996984, 73.59065804690313, 58.434427375147195, 27.98301818464334, 69.14376699758857, 66.45031668935354, 62.3608728614588, 59.17938725903291, 48.90886974836036, 3.648019019763625, 60.60921436234102, 56.14229498576681, 66.6705810639215, 53.37852048672869, 62.839328905863226, 62.370445447153436, 61.090012636401546, 63.78433880097777, 76.1315939531209, 74.18053980182633, 63.60486474550046, 47.81822853469275, 40.10931291577159, 63.81175021293091, 72.22620394620382, 62.5919248019702, 9.494953822736507, 45.306040410673184, 24.76128785532641, 9.088033826648898, 65.04453176848516, 44.784506383417586, 67.51413204069908, 64.9570640958527, 50.64786223418613, 65.69181448535623, 42.27814522033782, 67.5215330811536, 75.6627402308726], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4970781736111407, "mean_inference_ms": 7.160919254336777, "mean_action_processing_ms": 0.5170854620257912, "mean_env_wait_ms": 22.84255767747654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03615450859069824, "StateBufferConnector_ms": 0.03336191177368164, "ViewRequirementAgentConnector_ms": 0.9461736679077148}}, "episode_reward_max": 76.1315939531209, "episode_reward_min": 3.648019019763625, "episode_reward_mean": 53.331536037259724, "episode_len_mean": 1075.9, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [63.492642542364955, 73.76918572507752, 49.87375050161306, 53.30137852690547, 35.845406057808944, 61.37784232576941, 72.41189847659278, 11.092486430215367, 24.659550656813387, 52.26191836186776, 21.473209412745806, 34.68849199614599, 73.7992132898529, 38.5363830515239, 63.90806929431784, 59.23350440161405, 8.889371468597036, 56.2477209789239, 49.27172128179167, 37.56067475625177, 58.60286098993462, 13.42534646362189, 75.44104552760292, 57.954498098113746, 56.642533871178514, 58.30395405684118, 67.87431273937594, 41.589538672737675, 57.44232807514173, 56.73524531032046, 66.75277237178997, 67.75683689020953, 49.804712769170585, 50.851124078853964, 53.998766090373486, 57.7490884260678, 62.20546503203145, 63.50419963381102, 59.64964511828196, 69.93485166108054, 60.97704005871815, 37.27388908655305, 63.154359301696914, 69.99128934719178, 65.87342525792184, 59.8991939219771, 37.76150584804143, 63.25267618411338, 59.24029321447736, 39.245872593028935, 47.55290720696209, 53.33784647961683, 25.71950618234858, 66.86709559627282, 43.50744812500538, 4.508602358406076, 52.58898622745309, 72.26732130992065, 65.78478450652561, 68.77171490001055, 42.09569638123284, 55.757466985996984, 73.59065804690313, 58.434427375147195, 27.98301818464334, 69.14376699758857, 66.45031668935354, 62.3608728614588, 59.17938725903291, 48.90886974836036, 3.648019019763625, 60.60921436234102, 56.14229498576681, 66.6705810639215, 53.37852048672869, 62.839328905863226, 62.370445447153436, 61.090012636401546, 63.78433880097777, 76.1315939531209, 74.18053980182633, 63.60486474550046, 47.81822853469275, 40.10931291577159, 63.81175021293091, 72.22620394620382, 62.5919248019702, 9.494953822736507, 45.306040410673184, 24.76128785532641, 9.088033826648898, 65.04453176848516, 44.784506383417586, 67.51413204069908, 64.9570640958527, 50.64786223418613, 65.69181448535623, 42.27814522033782, 67.5215330811536, 75.6627402308726], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4970781736111407, "mean_inference_ms": 7.160919254336777, "mean_action_processing_ms": 0.5170854620257912, "mean_env_wait_ms": 22.84255767747654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03615450859069824, "StateBufferConnector_ms": 0.03336191177368164, "ViewRequirementAgentConnector_ms": 0.9461736679077148}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 502252, "num_agent_steps_trained": 502252, "num_env_steps_sampled": 502252, "num_env_steps_trained": 502252, "num_env_steps_sampled_this_iter": 13994, "num_env_steps_trained_this_iter": 13994, "num_env_steps_sampled_throughput_per_sec": 212.62880107405147, "num_env_steps_trained_throughput_per_sec": 212.62880107405147, "timesteps_total": 502252, "num_steps_trained_this_iter": 13994, "agent_timesteps_total": 502252, "timers": {"training_iteration_time_ms": 64963.203, "sample_time_ms": 40808.371, "load_time_ms": 2363.393, "load_throughput": 6268.952, "learn_time_ms": 21035.897, "learn_throughput": 704.32, "synch_weights_time_ms": 628.7}, "counters": {"num_env_steps_sampled": 502252, "num_env_steps_trained": 502252, "num_agent_steps_sampled": 502252, "num_agent_steps_trained": 502252}, "done": false, "episodes_total": 562, "training_iteration": 40, "trial_id": "837cb_00000", "date": "2025-06-07_18-04-07", "timestamp": 1749312247, "time_this_iter_s": 83.75657248497009, "time_total_s": 2304.329644203186, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2304.329644203186, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 60.49595959595959, "ram_util_percent": 89.54949494949493, "gpu_util_percent0": 0.13333333333333333, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.497748000000002e-05, "total_loss": -0.10890610974112695, "policy_loss": -0.0061931700056249445, "vf_loss": 0.03237762826325541, "vf_explained_var": 0.951474328474565, "kl": 0.013110817375869162, "entropy": 15.12212370265614, "entropy_coeff": 0.007488740000000001}, "model": {}, "num_grad_updates_lifetime": 17965.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 517890, "num_env_steps_trained": 517890, "num_agent_steps_sampled": 517890, "num_agent_steps_trained": 517890}, "sampler_results": {"episode_reward_max": 76.1315939531209, "episode_reward_min": 3.648019019763625, "episode_reward_mean": 55.145647034254054, "episode_len_mean": 1084.12, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.90806929431784, 59.23350440161405, 8.889371468597036, 56.2477209789239, 49.27172128179167, 37.56067475625177, 58.60286098993462, 13.42534646362189, 75.44104552760292, 57.954498098113746, 56.642533871178514, 58.30395405684118, 67.87431273937594, 41.589538672737675, 57.44232807514173, 56.73524531032046, 66.75277237178997, 67.75683689020953, 49.804712769170585, 50.851124078853964, 53.998766090373486, 57.7490884260678, 62.20546503203145, 63.50419963381102, 59.64964511828196, 69.93485166108054, 60.97704005871815, 37.27388908655305, 63.154359301696914, 69.99128934719178, 65.87342525792184, 59.8991939219771, 37.76150584804143, 63.25267618411338, 59.24029321447736, 39.245872593028935, 47.55290720696209, 53.33784647961683, 25.71950618234858, 66.86709559627282, 43.50744812500538, 4.508602358406076, 52.58898622745309, 72.26732130992065, 65.78478450652561, 68.77171490001055, 42.09569638123284, 55.757466985996984, 73.59065804690313, 58.434427375147195, 27.98301818464334, 69.14376699758857, 66.45031668935354, 62.3608728614588, 59.17938725903291, 48.90886974836036, 3.648019019763625, 60.60921436234102, 56.14229498576681, 66.6705810639215, 53.37852048672869, 62.839328905863226, 62.370445447153436, 61.090012636401546, 63.78433880097777, 76.1315939531209, 74.18053980182633, 63.60486474550046, 47.81822853469275, 40.10931291577159, 63.81175021293091, 72.22620394620382, 62.5919248019702, 9.494953822736507, 45.306040410673184, 24.76128785532641, 9.088033826648898, 65.04453176848516, 44.784506383417586, 67.51413204069908, 64.9570640958527, 50.64786223418613, 65.69181448535623, 42.27814522033782, 67.5215330811536, 75.6627402308726, 66.03389199510484, 63.67281360098401, 46.752946649194264, 59.73518331805769, 66.96508272754234, 53.31233979239936, 60.4602312321754, 64.80114535827443, 63.548618639743246, 56.53445262601986, 74.35205825771887, 49.108134538249665, 50.2773297995261, 72.44022851974039], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.506769950028501, "mean_inference_ms": 7.1778184005618915, "mean_action_processing_ms": 0.5184185125130356, "mean_env_wait_ms": 22.895197213728416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04310965538024902, "StateBufferConnector_ms": 0.028872013092041016, "ViewRequirementAgentConnector_ms": 0.9963171482086182}}, "episode_reward_max": 76.1315939531209, "episode_reward_min": 3.648019019763625, "episode_reward_mean": 55.145647034254054, "episode_len_mean": 1084.12, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [63.90806929431784, 59.23350440161405, 8.889371468597036, 56.2477209789239, 49.27172128179167, 37.56067475625177, 58.60286098993462, 13.42534646362189, 75.44104552760292, 57.954498098113746, 56.642533871178514, 58.30395405684118, 67.87431273937594, 41.589538672737675, 57.44232807514173, 56.73524531032046, 66.75277237178997, 67.75683689020953, 49.804712769170585, 50.851124078853964, 53.998766090373486, 57.7490884260678, 62.20546503203145, 63.50419963381102, 59.64964511828196, 69.93485166108054, 60.97704005871815, 37.27388908655305, 63.154359301696914, 69.99128934719178, 65.87342525792184, 59.8991939219771, 37.76150584804143, 63.25267618411338, 59.24029321447736, 39.245872593028935, 47.55290720696209, 53.33784647961683, 25.71950618234858, 66.86709559627282, 43.50744812500538, 4.508602358406076, 52.58898622745309, 72.26732130992065, 65.78478450652561, 68.77171490001055, 42.09569638123284, 55.757466985996984, 73.59065804690313, 58.434427375147195, 27.98301818464334, 69.14376699758857, 66.45031668935354, 62.3608728614588, 59.17938725903291, 48.90886974836036, 3.648019019763625, 60.60921436234102, 56.14229498576681, 66.6705810639215, 53.37852048672869, 62.839328905863226, 62.370445447153436, 61.090012636401546, 63.78433880097777, 76.1315939531209, 74.18053980182633, 63.60486474550046, 47.81822853469275, 40.10931291577159, 63.81175021293091, 72.22620394620382, 62.5919248019702, 9.494953822736507, 45.306040410673184, 24.76128785532641, 9.088033826648898, 65.04453176848516, 44.784506383417586, 67.51413204069908, 64.9570640958527, 50.64786223418613, 65.69181448535623, 42.27814522033782, 67.5215330811536, 75.6627402308726, 66.03389199510484, 63.67281360098401, 46.752946649194264, 59.73518331805769, 66.96508272754234, 53.31233979239936, 60.4602312321754, 64.80114535827443, 63.548618639743246, 56.53445262601986, 74.35205825771887, 49.108134538249665, 50.2773297995261, 72.44022851974039], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.506769950028501, "mean_inference_ms": 7.1778184005618915, "mean_action_processing_ms": 0.5184185125130356, "mean_env_wait_ms": 22.895197213728416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04310965538024902, "StateBufferConnector_ms": 0.028872013092041016, "ViewRequirementAgentConnector_ms": 0.9963171482086182}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 517890, "num_agent_steps_trained": 517890, "num_env_steps_sampled": 517890, "num_env_steps_trained": 517890, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 218.15033755026738, "num_env_steps_trained_throughput_per_sec": 218.15033755026738, "timesteps_total": 517890, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 517890, "timers": {"training_iteration_time_ms": 65640.639, "sample_time_ms": 41074.938, "load_time_ms": 2602.59, "load_throughput": 5724.375, "learn_time_ms": 21262.059, "learn_throughput": 700.694, "synch_weights_time_ms": 573.444}, "counters": {"num_env_steps_sampled": 517890, "num_env_steps_trained": 517890, "num_agent_steps_sampled": 517890, "num_agent_steps_trained": 517890}, "done": false, "episodes_total": 576, "training_iteration": 41, "trial_id": "837cb_00000", "date": "2025-06-07_18-05-19", "timestamp": 1749312319, "time_this_iter_s": 71.70041513442993, "time_total_s": 2376.030059337616, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2376.030059337616, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 66.8144578313253, "ram_util_percent": 90.44939759036144, "gpu_util_percent0": 0.20698795180722887, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.482109999999999e-05, "total_loss": -0.11476746870384721, "policy_loss": -0.013796333557164127, "vf_loss": 0.03327445958741009, "vf_explained_var": 0.9412157278711145, "kl": 0.012938292534857862, "entropy": 15.081487301913175, "entropy_coeff": 0.00741055}, "model": {}, "num_grad_updates_lifetime": 18515.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 533528, "num_env_steps_trained": 533528, "num_agent_steps_sampled": 533528, "num_agent_steps_trained": 533528}, "sampler_results": {"episode_reward_max": 76.1315939531209, "episode_reward_min": 3.648019019763625, "episode_reward_mean": 56.237336988326085, "episode_len_mean": 1092.34, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.44232807514173, 56.73524531032046, 66.75277237178997, 67.75683689020953, 49.804712769170585, 50.851124078853964, 53.998766090373486, 57.7490884260678, 62.20546503203145, 63.50419963381102, 59.64964511828196, 69.93485166108054, 60.97704005871815, 37.27388908655305, 63.154359301696914, 69.99128934719178, 65.87342525792184, 59.8991939219771, 37.76150584804143, 63.25267618411338, 59.24029321447736, 39.245872593028935, 47.55290720696209, 53.33784647961683, 25.71950618234858, 66.86709559627282, 43.50744812500538, 4.508602358406076, 52.58898622745309, 72.26732130992065, 65.78478450652561, 68.77171490001055, 42.09569638123284, 55.757466985996984, 73.59065804690313, 58.434427375147195, 27.98301818464334, 69.14376699758857, 66.45031668935354, 62.3608728614588, 59.17938725903291, 48.90886974836036, 3.648019019763625, 60.60921436234102, 56.14229498576681, 66.6705810639215, 53.37852048672869, 62.839328905863226, 62.370445447153436, 61.090012636401546, 63.78433880097777, 76.1315939531209, 74.18053980182633, 63.60486474550046, 47.81822853469275, 40.10931291577159, 63.81175021293091, 72.22620394620382, 62.5919248019702, 9.494953822736507, 45.306040410673184, 24.76128785532641, 9.088033826648898, 65.04453176848516, 44.784506383417586, 67.51413204069908, 64.9570640958527, 50.64786223418613, 65.69181448535623, 42.27814522033782, 67.5215330811536, 75.6627402308726, 66.03389199510484, 63.67281360098401, 46.752946649194264, 59.73518331805769, 66.96508272754234, 53.31233979239936, 60.4602312321754, 64.80114535827443, 63.548618639743246, 56.53445262601986, 74.35205825771887, 49.108134538249665, 50.2773297995261, 72.44022851974039, 52.1185741342006, 49.59695634647238, 39.7384276601654, 57.9330184031905, 63.06079376372152, 58.21027514207206, 60.68761178186459, 73.12471389356561, 70.79455896714148, 60.286926445235295, 61.76598513455586, 57.424018083646345, 57.610579656713284, 51.76170859556196], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5167452042493315, "mean_inference_ms": 7.197113119346816, "mean_action_processing_ms": 0.5197470019912113, "mean_env_wait_ms": 22.946270961469576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03903532028198242, "StateBufferConnector_ms": 0.032895565032958984, "ViewRequirementAgentConnector_ms": 1.014721155166626}}, "episode_reward_max": 76.1315939531209, "episode_reward_min": 3.648019019763625, "episode_reward_mean": 56.237336988326085, "episode_len_mean": 1092.34, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [57.44232807514173, 56.73524531032046, 66.75277237178997, 67.75683689020953, 49.804712769170585, 50.851124078853964, 53.998766090373486, 57.7490884260678, 62.20546503203145, 63.50419963381102, 59.64964511828196, 69.93485166108054, 60.97704005871815, 37.27388908655305, 63.154359301696914, 69.99128934719178, 65.87342525792184, 59.8991939219771, 37.76150584804143, 63.25267618411338, 59.24029321447736, 39.245872593028935, 47.55290720696209, 53.33784647961683, 25.71950618234858, 66.86709559627282, 43.50744812500538, 4.508602358406076, 52.58898622745309, 72.26732130992065, 65.78478450652561, 68.77171490001055, 42.09569638123284, 55.757466985996984, 73.59065804690313, 58.434427375147195, 27.98301818464334, 69.14376699758857, 66.45031668935354, 62.3608728614588, 59.17938725903291, 48.90886974836036, 3.648019019763625, 60.60921436234102, 56.14229498576681, 66.6705810639215, 53.37852048672869, 62.839328905863226, 62.370445447153436, 61.090012636401546, 63.78433880097777, 76.1315939531209, 74.18053980182633, 63.60486474550046, 47.81822853469275, 40.10931291577159, 63.81175021293091, 72.22620394620382, 62.5919248019702, 9.494953822736507, 45.306040410673184, 24.76128785532641, 9.088033826648898, 65.04453176848516, 44.784506383417586, 67.51413204069908, 64.9570640958527, 50.64786223418613, 65.69181448535623, 42.27814522033782, 67.5215330811536, 75.6627402308726, 66.03389199510484, 63.67281360098401, 46.752946649194264, 59.73518331805769, 66.96508272754234, 53.31233979239936, 60.4602312321754, 64.80114535827443, 63.548618639743246, 56.53445262601986, 74.35205825771887, 49.108134538249665, 50.2773297995261, 72.44022851974039, 52.1185741342006, 49.59695634647238, 39.7384276601654, 57.9330184031905, 63.06079376372152, 58.21027514207206, 60.68761178186459, 73.12471389356561, 70.79455896714148, 60.286926445235295, 61.76598513455586, 57.424018083646345, 57.610579656713284, 51.76170859556196], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5167452042493315, "mean_inference_ms": 7.197113119346816, "mean_action_processing_ms": 0.5197470019912113, "mean_env_wait_ms": 22.946270961469576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03903532028198242, "StateBufferConnector_ms": 0.032895565032958984, "ViewRequirementAgentConnector_ms": 1.014721155166626}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 533528, "num_agent_steps_trained": 533528, "num_env_steps_sampled": 533528, "num_env_steps_trained": 533528, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 230.8136136880898, "num_env_steps_trained_throughput_per_sec": 230.8136136880898, "timesteps_total": 533528, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 533528, "timers": {"training_iteration_time_ms": 66942.965, "sample_time_ms": 41742.66, "load_time_ms": 2679.62, "load_throughput": 5682.522, "learn_time_ms": 21824.724, "learn_throughput": 697.695, "synch_weights_time_ms": 568.159}, "counters": {"num_env_steps_sampled": 533528, "num_env_steps_trained": 533528, "num_agent_steps_sampled": 533528, "num_agent_steps_trained": 533528}, "done": false, "episodes_total": 590, "training_iteration": 42, "trial_id": "837cb_00000", "date": "2025-06-07_18-06-26", "timestamp": 1749312386, "time_this_iter_s": 67.77163505554199, "time_total_s": 2443.801694393158, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2443.801694393158, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 66.17974683544304, "ram_util_percent": 88.82658227848103, "gpu_util_percent0": 0.20987341772151896, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.466472000000001e-05, "total_loss": -0.08308987728320062, "policy_loss": 0.015461939090693539, "vf_loss": 0.04008613866203549, "vf_explained_var": 0.9431579468467018, "kl": 0.013228731087055504, "entropy": 15.193533489920876, "entropy_coeff": 0.007332359999999998}, "model": {}, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 549166, "num_env_steps_trained": 549166, "num_agent_steps_sampled": 549166, "num_agent_steps_trained": 549166}, "sampler_results": {"episode_reward_max": 76.1315939531209, "episode_reward_min": 3.648019019763625, "episode_reward_mean": 55.2754306535737, "episode_len_mean": 1092.34, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.154359301696914, 69.99128934719178, 65.87342525792184, 59.8991939219771, 37.76150584804143, 63.25267618411338, 59.24029321447736, 39.245872593028935, 47.55290720696209, 53.33784647961683, 25.71950618234858, 66.86709559627282, 43.50744812500538, 4.508602358406076, 52.58898622745309, 72.26732130992065, 65.78478450652561, 68.77171490001055, 42.09569638123284, 55.757466985996984, 73.59065804690313, 58.434427375147195, 27.98301818464334, 69.14376699758857, 66.45031668935354, 62.3608728614588, 59.17938725903291, 48.90886974836036, 3.648019019763625, 60.60921436234102, 56.14229498576681, 66.6705810639215, 53.37852048672869, 62.839328905863226, 62.370445447153436, 61.090012636401546, 63.78433880097777, 76.1315939531209, 74.18053980182633, 63.60486474550046, 47.81822853469275, 40.10931291577159, 63.81175021293091, 72.22620394620382, 62.5919248019702, 9.494953822736507, 45.306040410673184, 24.76128785532641, 9.088033826648898, 65.04453176848516, 44.784506383417586, 67.51413204069908, 64.9570640958527, 50.64786223418613, 65.69181448535623, 42.27814522033782, 67.5215330811536, 75.6627402308726, 66.03389199510484, 63.67281360098401, 46.752946649194264, 59.73518331805769, 66.96508272754234, 53.31233979239936, 60.4602312321754, 64.80114535827443, 63.548618639743246, 56.53445262601986, 74.35205825771887, 49.108134538249665, 50.2773297995261, 72.44022851974039, 52.1185741342006, 49.59695634647238, 39.7384276601654, 57.9330184031905, 63.06079376372152, 58.21027514207206, 60.68761178186459, 73.12471389356561, 70.79455896714148, 60.286926445235295, 61.76598513455586, 57.424018083646345, 57.610579656713284, 51.76170859556196, 41.05408831776827, 55.072738924450746, 42.43117477680197, 44.52828995146811, 50.87591588625066, 47.962758926148865, 60.847462319872115, 61.01724222397014, 59.724966155450026, 50.627569322179056, 56.724266926451484, 44.40748948700915, 61.58062348041074, 41.590744428933355], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.525491009104099, "mean_inference_ms": 7.219748375862206, "mean_action_processing_ms": 0.5211724566444144, "mean_env_wait_ms": 22.996633011511687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043532609939575195, "StateBufferConnector_ms": 0.02795243263244629, "ViewRequirementAgentConnector_ms": 0.9940590858459473}}, "episode_reward_max": 76.1315939531209, "episode_reward_min": 3.648019019763625, "episode_reward_mean": 55.2754306535737, "episode_len_mean": 1092.34, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [63.154359301696914, 69.99128934719178, 65.87342525792184, 59.8991939219771, 37.76150584804143, 63.25267618411338, 59.24029321447736, 39.245872593028935, 47.55290720696209, 53.33784647961683, 25.71950618234858, 66.86709559627282, 43.50744812500538, 4.508602358406076, 52.58898622745309, 72.26732130992065, 65.78478450652561, 68.77171490001055, 42.09569638123284, 55.757466985996984, 73.59065804690313, 58.434427375147195, 27.98301818464334, 69.14376699758857, 66.45031668935354, 62.3608728614588, 59.17938725903291, 48.90886974836036, 3.648019019763625, 60.60921436234102, 56.14229498576681, 66.6705810639215, 53.37852048672869, 62.839328905863226, 62.370445447153436, 61.090012636401546, 63.78433880097777, 76.1315939531209, 74.18053980182633, 63.60486474550046, 47.81822853469275, 40.10931291577159, 63.81175021293091, 72.22620394620382, 62.5919248019702, 9.494953822736507, 45.306040410673184, 24.76128785532641, 9.088033826648898, 65.04453176848516, 44.784506383417586, 67.51413204069908, 64.9570640958527, 50.64786223418613, 65.69181448535623, 42.27814522033782, 67.5215330811536, 75.6627402308726, 66.03389199510484, 63.67281360098401, 46.752946649194264, 59.73518331805769, 66.96508272754234, 53.31233979239936, 60.4602312321754, 64.80114535827443, 63.548618639743246, 56.53445262601986, 74.35205825771887, 49.108134538249665, 50.2773297995261, 72.44022851974039, 52.1185741342006, 49.59695634647238, 39.7384276601654, 57.9330184031905, 63.06079376372152, 58.21027514207206, 60.68761178186459, 73.12471389356561, 70.79455896714148, 60.286926445235295, 61.76598513455586, 57.424018083646345, 57.610579656713284, 51.76170859556196, 41.05408831776827, 55.072738924450746, 42.43117477680197, 44.52828995146811, 50.87591588625066, 47.962758926148865, 60.847462319872115, 61.01724222397014, 59.724966155450026, 50.627569322179056, 56.724266926451484, 44.40748948700915, 61.58062348041074, 41.590744428933355], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.525491009104099, "mean_inference_ms": 7.219748375862206, "mean_action_processing_ms": 0.5211724566444144, "mean_env_wait_ms": 22.996633011511687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043532609939575195, "StateBufferConnector_ms": 0.02795243263244629, "ViewRequirementAgentConnector_ms": 0.9940590858459473}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 549166, "num_agent_steps_trained": 549166, "num_env_steps_sampled": 549166, "num_env_steps_trained": 549166, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 223.64963867983994, "num_env_steps_trained_throughput_per_sec": 223.64963867983994, "timesteps_total": 549166, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 549166, "timers": {"training_iteration_time_ms": 67247.77, "sample_time_ms": 42009.355, "load_time_ms": 2685.602, "load_throughput": 5669.865, "learn_time_ms": 21858.665, "learn_throughput": 696.612, "synch_weights_time_ms": 567.877}, "counters": {"num_env_steps_sampled": 549166, "num_env_steps_trained": 549166, "num_agent_steps_sampled": 549166, "num_agent_steps_trained": 549166}, "done": false, "episodes_total": 604, "training_iteration": 43, "trial_id": "837cb_00000", "date": "2025-06-07_18-07-37", "timestamp": 1749312457, "time_this_iter_s": 69.94085097312927, "time_total_s": 2513.7425453662872, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2513.7425453662872, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 66.47195121951219, "ram_util_percent": 89.37926829268294, "gpu_util_percent0": 0.2115853658536585, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.450834000000001e-05, "total_loss": -0.11626594927225431, "policy_loss": -0.01677928910261306, "vf_loss": 0.03270666779294102, "vf_explained_var": 0.9480149933424863, "kl": 0.013897309569160412, "entropy": 15.186747079329058, "entropy_coeff": 0.007254169999999999}, "model": {}, "num_grad_updates_lifetime": 19615.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 564804, "num_env_steps_trained": 564804, "num_agent_steps_sampled": 564804, "num_agent_steps_trained": 564804}, "sampler_results": {"episode_reward_max": 78.1019481726654, "episode_reward_min": 3.648019019763625, "episode_reward_mean": 56.79627671993148, "episode_len_mean": 1100.56, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.58898622745309, 72.26732130992065, 65.78478450652561, 68.77171490001055, 42.09569638123284, 55.757466985996984, 73.59065804690313, 58.434427375147195, 27.98301818464334, 69.14376699758857, 66.45031668935354, 62.3608728614588, 59.17938725903291, 48.90886974836036, 3.648019019763625, 60.60921436234102, 56.14229498576681, 66.6705810639215, 53.37852048672869, 62.839328905863226, 62.370445447153436, 61.090012636401546, 63.78433880097777, 76.1315939531209, 74.18053980182633, 63.60486474550046, 47.81822853469275, 40.10931291577159, 63.81175021293091, 72.22620394620382, 62.5919248019702, 9.494953822736507, 45.306040410673184, 24.76128785532641, 9.088033826648898, 65.04453176848516, 44.784506383417586, 67.51413204069908, 64.9570640958527, 50.64786223418613, 65.69181448535623, 42.27814522033782, 67.5215330811536, 75.6627402308726, 66.03389199510484, 63.67281360098401, 46.752946649194264, 59.73518331805769, 66.96508272754234, 53.31233979239936, 60.4602312321754, 64.80114535827443, 63.548618639743246, 56.53445262601986, 74.35205825771887, 49.108134538249665, 50.2773297995261, 72.44022851974039, 52.1185741342006, 49.59695634647238, 39.7384276601654, 57.9330184031905, 63.06079376372152, 58.21027514207206, 60.68761178186459, 73.12471389356561, 70.79455896714148, 60.286926445235295, 61.76598513455586, 57.424018083646345, 57.610579656713284, 51.76170859556196, 41.05408831776827, 55.072738924450746, 42.43117477680197, 44.52828995146811, 50.87591588625066, 47.962758926148865, 60.847462319872115, 61.01724222397014, 59.724966155450026, 50.627569322179056, 56.724266926451484, 44.40748948700915, 61.58062348041074, 41.590744428933355, 56.77292727144463, 65.32324663244952, 42.26239947581006, 57.65975586208406, 69.29888679111065, 62.85471916674222, 68.75341596269895, 61.384419783024725, 78.1019481726654, 63.792497914414035, 47.12208425419284, 48.03891779402976, 67.41052710112724, 63.2208820710428], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.534855556661022, "mean_inference_ms": 7.246949063978234, "mean_action_processing_ms": 0.5228896307509611, "mean_env_wait_ms": 23.053051140388785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03851962089538574, "StateBufferConnector_ms": 0.030746936798095703, "ViewRequirementAgentConnector_ms": 0.9799532890319824}}, "episode_reward_max": 78.1019481726654, "episode_reward_min": 3.648019019763625, "episode_reward_mean": 56.79627671993148, "episode_len_mean": 1100.56, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.58898622745309, 72.26732130992065, 65.78478450652561, 68.77171490001055, 42.09569638123284, 55.757466985996984, 73.59065804690313, 58.434427375147195, 27.98301818464334, 69.14376699758857, 66.45031668935354, 62.3608728614588, 59.17938725903291, 48.90886974836036, 3.648019019763625, 60.60921436234102, 56.14229498576681, 66.6705810639215, 53.37852048672869, 62.839328905863226, 62.370445447153436, 61.090012636401546, 63.78433880097777, 76.1315939531209, 74.18053980182633, 63.60486474550046, 47.81822853469275, 40.10931291577159, 63.81175021293091, 72.22620394620382, 62.5919248019702, 9.494953822736507, 45.306040410673184, 24.76128785532641, 9.088033826648898, 65.04453176848516, 44.784506383417586, 67.51413204069908, 64.9570640958527, 50.64786223418613, 65.69181448535623, 42.27814522033782, 67.5215330811536, 75.6627402308726, 66.03389199510484, 63.67281360098401, 46.752946649194264, 59.73518331805769, 66.96508272754234, 53.31233979239936, 60.4602312321754, 64.80114535827443, 63.548618639743246, 56.53445262601986, 74.35205825771887, 49.108134538249665, 50.2773297995261, 72.44022851974039, 52.1185741342006, 49.59695634647238, 39.7384276601654, 57.9330184031905, 63.06079376372152, 58.21027514207206, 60.68761178186459, 73.12471389356561, 70.79455896714148, 60.286926445235295, 61.76598513455586, 57.424018083646345, 57.610579656713284, 51.76170859556196, 41.05408831776827, 55.072738924450746, 42.43117477680197, 44.52828995146811, 50.87591588625066, 47.962758926148865, 60.847462319872115, 61.01724222397014, 59.724966155450026, 50.627569322179056, 56.724266926451484, 44.40748948700915, 61.58062348041074, 41.590744428933355, 56.77292727144463, 65.32324663244952, 42.26239947581006, 57.65975586208406, 69.29888679111065, 62.85471916674222, 68.75341596269895, 61.384419783024725, 78.1019481726654, 63.792497914414035, 47.12208425419284, 48.03891779402976, 67.41052710112724, 63.2208820710428], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.534855556661022, "mean_inference_ms": 7.246949063978234, "mean_action_processing_ms": 0.5228896307509611, "mean_env_wait_ms": 23.053051140388785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03851962089538574, "StateBufferConnector_ms": 0.030746936798095703, "ViewRequirementAgentConnector_ms": 0.9799532890319824}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564804, "num_agent_steps_trained": 564804, "num_env_steps_sampled": 564804, "num_env_steps_trained": 564804, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 224.43135849829574, "num_env_steps_trained_throughput_per_sec": 224.43135849829574, "timesteps_total": 564804, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 564804, "timers": {"training_iteration_time_ms": 67815.531, "sample_time_ms": 42469.047, "load_time_ms": 2701.48, "load_throughput": 5666.968, "learn_time_ms": 21959.195, "learn_throughput": 697.166, "synch_weights_time_ms": 565.869}, "counters": {"num_env_steps_sampled": 564804, "num_env_steps_trained": 564804, "num_agent_steps_sampled": 564804, "num_agent_steps_trained": 564804}, "done": false, "episodes_total": 618, "training_iteration": 44, "trial_id": "837cb_00000", "date": "2025-06-07_18-08-46", "timestamp": 1749312526, "time_this_iter_s": 69.69632053375244, "time_total_s": 2583.4388659000397, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2583.4388659000397, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 67.29012345679014, "ram_util_percent": 89.03827160493829, "gpu_util_percent0": 0.21123456790123457, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.435195999999999e-05, "total_loss": -0.12548324887704274, "policy_loss": -0.0262241936001969, "vf_loss": 0.0291816394160163, "vf_explained_var": 0.9430876402421431, "kl": 0.013212118374411313, "entropy": 15.167169241471724, "entropy_coeff": 0.00717598}, "model": {}, "num_grad_updates_lifetime": 20165.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 580442, "num_env_steps_trained": 580442, "num_agent_steps_sampled": 580442, "num_agent_steps_trained": 580442}, "sampler_results": {"episode_reward_max": 78.1019481726654, "episode_reward_min": 3.648019019763625, "episode_reward_mean": 57.411117827586295, "episode_len_mean": 1100.56, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.648019019763625, 60.60921436234102, 56.14229498576681, 66.6705810639215, 53.37852048672869, 62.839328905863226, 62.370445447153436, 61.090012636401546, 63.78433880097777, 76.1315939531209, 74.18053980182633, 63.60486474550046, 47.81822853469275, 40.10931291577159, 63.81175021293091, 72.22620394620382, 62.5919248019702, 9.494953822736507, 45.306040410673184, 24.76128785532641, 9.088033826648898, 65.04453176848516, 44.784506383417586, 67.51413204069908, 64.9570640958527, 50.64786223418613, 65.69181448535623, 42.27814522033782, 67.5215330811536, 75.6627402308726, 66.03389199510484, 63.67281360098401, 46.752946649194264, 59.73518331805769, 66.96508272754234, 53.31233979239936, 60.4602312321754, 64.80114535827443, 63.548618639743246, 56.53445262601986, 74.35205825771887, 49.108134538249665, 50.2773297995261, 72.44022851974039, 52.1185741342006, 49.59695634647238, 39.7384276601654, 57.9330184031905, 63.06079376372152, 58.21027514207206, 60.68761178186459, 73.12471389356561, 70.79455896714148, 60.286926445235295, 61.76598513455586, 57.424018083646345, 57.610579656713284, 51.76170859556196, 41.05408831776827, 55.072738924450746, 42.43117477680197, 44.52828995146811, 50.87591588625066, 47.962758926148865, 60.847462319872115, 61.01724222397014, 59.724966155450026, 50.627569322179056, 56.724266926451484, 44.40748948700915, 61.58062348041074, 41.590744428933355, 56.77292727144463, 65.32324663244952, 42.26239947581006, 57.65975586208406, 69.29888679111065, 62.85471916674222, 68.75341596269895, 61.384419783024725, 78.1019481726654, 63.792497914414035, 47.12208425419284, 48.03891779402976, 67.41052710112724, 63.2208820710428, 58.30349922082849, 62.68769336330068, 51.00724168749367, 56.83644397305623, 73.74466528689898, 53.41092477109565, 71.05813797596497, 66.54505882746776, 70.16871798554138, 67.07902766652228, 60.11397607558513, 56.995271398881734, 66.31220068255121, 70.53853932392232], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5452379640395444, "mean_inference_ms": 7.275565477043615, "mean_action_processing_ms": 0.524638820076909, "mean_env_wait_ms": 23.10550131315711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037589073181152344, "StateBufferConnector_ms": 0.03278231620788574, "ViewRequirementAgentConnector_ms": 0.9952197074890137}}, "episode_reward_max": 78.1019481726654, "episode_reward_min": 3.648019019763625, "episode_reward_mean": 57.411117827586295, "episode_len_mean": 1100.56, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.648019019763625, 60.60921436234102, 56.14229498576681, 66.6705810639215, 53.37852048672869, 62.839328905863226, 62.370445447153436, 61.090012636401546, 63.78433880097777, 76.1315939531209, 74.18053980182633, 63.60486474550046, 47.81822853469275, 40.10931291577159, 63.81175021293091, 72.22620394620382, 62.5919248019702, 9.494953822736507, 45.306040410673184, 24.76128785532641, 9.088033826648898, 65.04453176848516, 44.784506383417586, 67.51413204069908, 64.9570640958527, 50.64786223418613, 65.69181448535623, 42.27814522033782, 67.5215330811536, 75.6627402308726, 66.03389199510484, 63.67281360098401, 46.752946649194264, 59.73518331805769, 66.96508272754234, 53.31233979239936, 60.4602312321754, 64.80114535827443, 63.548618639743246, 56.53445262601986, 74.35205825771887, 49.108134538249665, 50.2773297995261, 72.44022851974039, 52.1185741342006, 49.59695634647238, 39.7384276601654, 57.9330184031905, 63.06079376372152, 58.21027514207206, 60.68761178186459, 73.12471389356561, 70.79455896714148, 60.286926445235295, 61.76598513455586, 57.424018083646345, 57.610579656713284, 51.76170859556196, 41.05408831776827, 55.072738924450746, 42.43117477680197, 44.52828995146811, 50.87591588625066, 47.962758926148865, 60.847462319872115, 61.01724222397014, 59.724966155450026, 50.627569322179056, 56.724266926451484, 44.40748948700915, 61.58062348041074, 41.590744428933355, 56.77292727144463, 65.32324663244952, 42.26239947581006, 57.65975586208406, 69.29888679111065, 62.85471916674222, 68.75341596269895, 61.384419783024725, 78.1019481726654, 63.792497914414035, 47.12208425419284, 48.03891779402976, 67.41052710112724, 63.2208820710428, 58.30349922082849, 62.68769336330068, 51.00724168749367, 56.83644397305623, 73.74466528689898, 53.41092477109565, 71.05813797596497, 66.54505882746776, 70.16871798554138, 67.07902766652228, 60.11397607558513, 56.995271398881734, 66.31220068255121, 70.53853932392232], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5452379640395444, "mean_inference_ms": 7.275565477043615, "mean_action_processing_ms": 0.524638820076909, "mean_env_wait_ms": 23.10550131315711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037589073181152344, "StateBufferConnector_ms": 0.03278231620788574, "ViewRequirementAgentConnector_ms": 0.9952197074890137}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580442, "num_agent_steps_trained": 580442, "num_env_steps_sampled": 580442, "num_env_steps_trained": 580442, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.26313420205568, "num_env_steps_trained_throughput_per_sec": 228.26313420205568, "timesteps_total": 580442, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 580442, "timers": {"training_iteration_time_ms": 68317.159, "sample_time_ms": 42719.904, "load_time_ms": 2713.963, "load_throughput": 5671.191, "learn_time_ms": 22196.668, "learn_throughput": 693.41, "synch_weights_time_ms": 566.388}, "counters": {"num_env_steps_sampled": 580442, "num_env_steps_trained": 580442, "num_agent_steps_sampled": 580442, "num_agent_steps_trained": 580442}, "done": false, "episodes_total": 632, "training_iteration": 45, "trial_id": "837cb_00000", "date": "2025-06-07_18-09-55", "timestamp": 1749312595, "time_this_iter_s": 68.52865314483643, "time_total_s": 2651.967519044876, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2651.967519044876, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 66.905, "ram_util_percent": 89.81875, "gpu_util_percent0": 0.211625, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.419557999999997e-05, "total_loss": -0.09409634473805244, "policy_loss": 0.0030976286434312127, "vf_loss": 0.030274585706557937, "vf_explained_var": 0.932933204793013, "kl": 0.01362478044247959, "entropy": 15.093134606801547, "entropy_coeff": 0.007097789999999997}, "model": {}, "num_grad_updates_lifetime": 20700.5, "diff_num_grad_updates_vs_sampler_policy": 259.5}}, "num_env_steps_sampled": 595258, "num_env_steps_trained": 595258, "num_agent_steps_sampled": 595258, "num_agent_steps_trained": 595258}, "sampler_results": {"episode_reward_max": 78.11559769193204, "episode_reward_min": 9.088033826648898, "episode_reward_mean": 57.592023680559635, "episode_len_mean": 1092.34, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.81175021293091, 72.22620394620382, 62.5919248019702, 9.494953822736507, 45.306040410673184, 24.76128785532641, 9.088033826648898, 65.04453176848516, 44.784506383417586, 67.51413204069908, 64.9570640958527, 50.64786223418613, 65.69181448535623, 42.27814522033782, 67.5215330811536, 75.6627402308726, 66.03389199510484, 63.67281360098401, 46.752946649194264, 59.73518331805769, 66.96508272754234, 53.31233979239936, 60.4602312321754, 64.80114535827443, 63.548618639743246, 56.53445262601986, 74.35205825771887, 49.108134538249665, 50.2773297995261, 72.44022851974039, 52.1185741342006, 49.59695634647238, 39.7384276601654, 57.9330184031905, 63.06079376372152, 58.21027514207206, 60.68761178186459, 73.12471389356561, 70.79455896714148, 60.286926445235295, 61.76598513455586, 57.424018083646345, 57.610579656713284, 51.76170859556196, 41.05408831776827, 55.072738924450746, 42.43117477680197, 44.52828995146811, 50.87591588625066, 47.962758926148865, 60.847462319872115, 61.01724222397014, 59.724966155450026, 50.627569322179056, 56.724266926451484, 44.40748948700915, 61.58062348041074, 41.590744428933355, 56.77292727144463, 65.32324663244952, 42.26239947581006, 57.65975586208406, 69.29888679111065, 62.85471916674222, 68.75341596269895, 61.384419783024725, 78.1019481726654, 63.792497914414035, 47.12208425419284, 48.03891779402976, 67.41052710112724, 63.2208820710428, 58.30349922082849, 62.68769336330068, 51.00724168749367, 56.83644397305623, 73.74466528689898, 53.41092477109565, 71.05813797596497, 66.54505882746776, 70.16871798554138, 67.07902766652228, 60.11397607558513, 56.995271398881734, 66.31220068255121, 70.53853932392232, 59.70507787014104, 61.200266676862704, 47.10608885141629, 71.98304582919506, 78.11559769193204, 70.86399565668327, 52.219035924150624, 9.389633701891047, 74.87564596537257, 52.307371380707714, 52.56002622515623, 43.967622130389465, 64.9150662420787, 71.25940681118598], "episode_lengths": [1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5557943327067743, "mean_inference_ms": 7.305482099911524, "mean_action_processing_ms": 0.5263799682458615, "mean_env_wait_ms": 23.155084581065353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03955650329589844, "StateBufferConnector_ms": 0.03482985496520996, "ViewRequirementAgentConnector_ms": 0.9605293273925781}}, "episode_reward_max": 78.11559769193204, "episode_reward_min": 9.088033826648898, "episode_reward_mean": 57.592023680559635, "episode_len_mean": 1092.34, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [63.81175021293091, 72.22620394620382, 62.5919248019702, 9.494953822736507, 45.306040410673184, 24.76128785532641, 9.088033826648898, 65.04453176848516, 44.784506383417586, 67.51413204069908, 64.9570640958527, 50.64786223418613, 65.69181448535623, 42.27814522033782, 67.5215330811536, 75.6627402308726, 66.03389199510484, 63.67281360098401, 46.752946649194264, 59.73518331805769, 66.96508272754234, 53.31233979239936, 60.4602312321754, 64.80114535827443, 63.548618639743246, 56.53445262601986, 74.35205825771887, 49.108134538249665, 50.2773297995261, 72.44022851974039, 52.1185741342006, 49.59695634647238, 39.7384276601654, 57.9330184031905, 63.06079376372152, 58.21027514207206, 60.68761178186459, 73.12471389356561, 70.79455896714148, 60.286926445235295, 61.76598513455586, 57.424018083646345, 57.610579656713284, 51.76170859556196, 41.05408831776827, 55.072738924450746, 42.43117477680197, 44.52828995146811, 50.87591588625066, 47.962758926148865, 60.847462319872115, 61.01724222397014, 59.724966155450026, 50.627569322179056, 56.724266926451484, 44.40748948700915, 61.58062348041074, 41.590744428933355, 56.77292727144463, 65.32324663244952, 42.26239947581006, 57.65975586208406, 69.29888679111065, 62.85471916674222, 68.75341596269895, 61.384419783024725, 78.1019481726654, 63.792497914414035, 47.12208425419284, 48.03891779402976, 67.41052710112724, 63.2208820710428, 58.30349922082849, 62.68769336330068, 51.00724168749367, 56.83644397305623, 73.74466528689898, 53.41092477109565, 71.05813797596497, 66.54505882746776, 70.16871798554138, 67.07902766652228, 60.11397607558513, 56.995271398881734, 66.31220068255121, 70.53853932392232, 59.70507787014104, 61.200266676862704, 47.10608885141629, 71.98304582919506, 78.11559769193204, 70.86399565668327, 52.219035924150624, 9.389633701891047, 74.87564596537257, 52.307371380707714, 52.56002622515623, 43.967622130389465, 64.9150662420787, 71.25940681118598], "episode_lengths": [1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5557943327067743, "mean_inference_ms": 7.305482099911524, "mean_action_processing_ms": 0.5263799682458615, "mean_env_wait_ms": 23.155084581065353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03955650329589844, "StateBufferConnector_ms": 0.03482985496520996, "ViewRequirementAgentConnector_ms": 0.9605293273925781}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 595258, "num_agent_steps_trained": 595258, "num_env_steps_sampled": 595258, "num_env_steps_trained": 595258, "num_env_steps_sampled_this_iter": 14816, "num_env_steps_trained_this_iter": 14816, "num_env_steps_sampled_throughput_per_sec": 223.64869402388496, "num_env_steps_trained_throughput_per_sec": 223.64869402388496, "timesteps_total": 595258, "num_steps_trained_this_iter": 14816, "agent_timesteps_total": 595258, "timers": {"training_iteration_time_ms": 68185.002, "sample_time_ms": 42764.664, "load_time_ms": 2707.957, "load_throughput": 5653.414, "learn_time_ms": 22089.805, "learn_throughput": 693.044, "synch_weights_time_ms": 500.036}, "counters": {"num_env_steps_sampled": 595258, "num_env_steps_trained": 595258, "num_agent_steps_sampled": 595258, "num_agent_steps_trained": 595258}, "done": false, "episodes_total": 646, "training_iteration": 46, "trial_id": "837cb_00000", "date": "2025-06-07_18-11-01", "timestamp": 1749312661, "time_this_iter_s": 66.26973938941956, "time_total_s": 2718.2372584342957, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2718.2372584342957, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 67.53461538461536, "ram_util_percent": 90.06282051282051, "gpu_util_percent0": 0.20256410256410257, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.404742000000002e-05, "total_loss": -0.10321498817838305, "policy_loss": -0.005476759937168522, "vf_loss": 0.025097886627032, "vf_explained_var": 0.9384928180954674, "kl": 0.014267690971319098, "entropy": 15.114423363425514, "entropy_coeff": 0.0070237100000000025}, "model": {}, "num_grad_updates_lifetime": 21235.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 610896, "num_env_steps_trained": 610896, "num_agent_steps_sampled": 610896, "num_agent_steps_trained": 610896}, "sampler_results": {"episode_reward_max": 78.11559769193204, "episode_reward_min": 9.389633701891047, "episode_reward_mean": 59.90623949770555, "episode_len_mean": 1108.78, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.5215330811536, 75.6627402308726, 66.03389199510484, 63.67281360098401, 46.752946649194264, 59.73518331805769, 66.96508272754234, 53.31233979239936, 60.4602312321754, 64.80114535827443, 63.548618639743246, 56.53445262601986, 74.35205825771887, 49.108134538249665, 50.2773297995261, 72.44022851974039, 52.1185741342006, 49.59695634647238, 39.7384276601654, 57.9330184031905, 63.06079376372152, 58.21027514207206, 60.68761178186459, 73.12471389356561, 70.79455896714148, 60.286926445235295, 61.76598513455586, 57.424018083646345, 57.610579656713284, 51.76170859556196, 41.05408831776827, 55.072738924450746, 42.43117477680197, 44.52828995146811, 50.87591588625066, 47.962758926148865, 60.847462319872115, 61.01724222397014, 59.724966155450026, 50.627569322179056, 56.724266926451484, 44.40748948700915, 61.58062348041074, 41.590744428933355, 56.77292727144463, 65.32324663244952, 42.26239947581006, 57.65975586208406, 69.29888679111065, 62.85471916674222, 68.75341596269895, 61.384419783024725, 78.1019481726654, 63.792497914414035, 47.12208425419284, 48.03891779402976, 67.41052710112724, 63.2208820710428, 58.30349922082849, 62.68769336330068, 51.00724168749367, 56.83644397305623, 73.74466528689898, 53.41092477109565, 71.05813797596497, 66.54505882746776, 70.16871798554138, 67.07902766652228, 60.11397607558513, 56.995271398881734, 66.31220068255121, 70.53853932392232, 59.70507787014104, 61.200266676862704, 47.10608885141629, 71.98304582919506, 78.11559769193204, 70.86399565668327, 52.219035924150624, 9.389633701891047, 74.87564596537257, 52.307371380707714, 52.56002622515623, 43.967622130389465, 64.9150662420787, 71.25940681118598, 65.48227720517367, 77.0154057528247, 51.51040989228623, 67.4717743131252, 73.17178320407707, 62.54578807774216, 66.742784658276, 58.55460786996074, 73.35181923477933, 66.69386656174353, 66.15769079671519, 48.16955188776036, 66.27338576891174, 76.47868759604005], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.566354841509119, "mean_inference_ms": 7.334435187634646, "mean_action_processing_ms": 0.5280321726967747, "mean_env_wait_ms": 23.20349297700302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03753972053527832, "StateBufferConnector_ms": 0.03988170623779297, "ViewRequirementAgentConnector_ms": 0.9647789001464844}}, "episode_reward_max": 78.11559769193204, "episode_reward_min": 9.389633701891047, "episode_reward_mean": 59.90623949770555, "episode_len_mean": 1108.78, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [67.5215330811536, 75.6627402308726, 66.03389199510484, 63.67281360098401, 46.752946649194264, 59.73518331805769, 66.96508272754234, 53.31233979239936, 60.4602312321754, 64.80114535827443, 63.548618639743246, 56.53445262601986, 74.35205825771887, 49.108134538249665, 50.2773297995261, 72.44022851974039, 52.1185741342006, 49.59695634647238, 39.7384276601654, 57.9330184031905, 63.06079376372152, 58.21027514207206, 60.68761178186459, 73.12471389356561, 70.79455896714148, 60.286926445235295, 61.76598513455586, 57.424018083646345, 57.610579656713284, 51.76170859556196, 41.05408831776827, 55.072738924450746, 42.43117477680197, 44.52828995146811, 50.87591588625066, 47.962758926148865, 60.847462319872115, 61.01724222397014, 59.724966155450026, 50.627569322179056, 56.724266926451484, 44.40748948700915, 61.58062348041074, 41.590744428933355, 56.77292727144463, 65.32324663244952, 42.26239947581006, 57.65975586208406, 69.29888679111065, 62.85471916674222, 68.75341596269895, 61.384419783024725, 78.1019481726654, 63.792497914414035, 47.12208425419284, 48.03891779402976, 67.41052710112724, 63.2208820710428, 58.30349922082849, 62.68769336330068, 51.00724168749367, 56.83644397305623, 73.74466528689898, 53.41092477109565, 71.05813797596497, 66.54505882746776, 70.16871798554138, 67.07902766652228, 60.11397607558513, 56.995271398881734, 66.31220068255121, 70.53853932392232, 59.70507787014104, 61.200266676862704, 47.10608885141629, 71.98304582919506, 78.11559769193204, 70.86399565668327, 52.219035924150624, 9.389633701891047, 74.87564596537257, 52.307371380707714, 52.56002622515623, 43.967622130389465, 64.9150662420787, 71.25940681118598, 65.48227720517367, 77.0154057528247, 51.51040989228623, 67.4717743131252, 73.17178320407707, 62.54578807774216, 66.742784658276, 58.55460786996074, 73.35181923477933, 66.69386656174353, 66.15769079671519, 48.16955188776036, 66.27338576891174, 76.47868759604005], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.566354841509119, "mean_inference_ms": 7.334435187634646, "mean_action_processing_ms": 0.5280321726967747, "mean_env_wait_ms": 23.20349297700302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03753972053527832, "StateBufferConnector_ms": 0.03988170623779297, "ViewRequirementAgentConnector_ms": 0.9647789001464844}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 610896, "num_agent_steps_trained": 610896, "num_env_steps_sampled": 610896, "num_env_steps_trained": 610896, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 224.28557658515655, "num_env_steps_trained_throughput_per_sec": 224.28557658515655, "timesteps_total": 610896, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 610896, "timers": {"training_iteration_time_ms": 68810.32, "sample_time_ms": 43196.357, "load_time_ms": 2727.724, "load_throughput": 5642.58, "learn_time_ms": 22265.81, "learn_throughput": 691.257, "synch_weights_time_ms": 498.146}, "counters": {"num_env_steps_sampled": 610896, "num_env_steps_trained": 610896, "num_agent_steps_sampled": 610896, "num_agent_steps_trained": 610896}, "done": false, "episodes_total": 660, "training_iteration": 47, "trial_id": "837cb_00000", "date": "2025-06-07_18-12-11", "timestamp": 1749312731, "time_this_iter_s": 69.74294710159302, "time_total_s": 2787.9802055358887, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2787.9802055358887, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 67.75555555555556, "ram_util_percent": 89.53086419753086, "gpu_util_percent0": 0.2167901234567901, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.389103999999999e-05, "total_loss": -0.11374886387281798, "policy_loss": -0.0182891100640832, "vf_loss": 0.02809727146904069, "vf_explained_var": 0.9346941587057981, "kl": 0.013124699249987094, "entropy": 15.075793977217241, "entropy_coeff": 0.006945519999999998}, "model": {}, "num_grad_updates_lifetime": 21785.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 626534, "num_env_steps_trained": 626534, "num_agent_steps_sampled": 626534, "num_agent_steps_trained": 626534}, "sampler_results": {"episode_reward_max": 84.90157754974099, "episode_reward_min": 9.389633701891047, "episode_reward_mean": 60.3288318044976, "episode_len_mean": 1108.78, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.2773297995261, 72.44022851974039, 52.1185741342006, 49.59695634647238, 39.7384276601654, 57.9330184031905, 63.06079376372152, 58.21027514207206, 60.68761178186459, 73.12471389356561, 70.79455896714148, 60.286926445235295, 61.76598513455586, 57.424018083646345, 57.610579656713284, 51.76170859556196, 41.05408831776827, 55.072738924450746, 42.43117477680197, 44.52828995146811, 50.87591588625066, 47.962758926148865, 60.847462319872115, 61.01724222397014, 59.724966155450026, 50.627569322179056, 56.724266926451484, 44.40748948700915, 61.58062348041074, 41.590744428933355, 56.77292727144463, 65.32324663244952, 42.26239947581006, 57.65975586208406, 69.29888679111065, 62.85471916674222, 68.75341596269895, 61.384419783024725, 78.1019481726654, 63.792497914414035, 47.12208425419284, 48.03891779402976, 67.41052710112724, 63.2208820710428, 58.30349922082849, 62.68769336330068, 51.00724168749367, 56.83644397305623, 73.74466528689898, 53.41092477109565, 71.05813797596497, 66.54505882746776, 70.16871798554138, 67.07902766652228, 60.11397607558513, 56.995271398881734, 66.31220068255121, 70.53853932392232, 59.70507787014104, 61.200266676862704, 47.10608885141629, 71.98304582919506, 78.11559769193204, 70.86399565668327, 52.219035924150624, 9.389633701891047, 74.87564596537257, 52.307371380707714, 52.56002622515623, 43.967622130389465, 64.9150662420787, 71.25940681118598, 65.48227720517367, 77.0154057528247, 51.51040989228623, 67.4717743131252, 73.17178320407707, 62.54578807774216, 66.742784658276, 58.55460786996074, 73.35181923477933, 66.69386656174353, 66.15769079671519, 48.16955188776036, 66.27338576891174, 76.47868759604005, 67.90449951171331, 64.98735536598404, 44.239144192877795, 54.94285855889567, 84.90157754974099, 53.89124374224486, 74.08203842928853, 68.20791823584261, 72.5477455543066, 61.75035618319655, 68.68762286902997, 52.39874413590747, 71.15474040720514, 71.02455799046142], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.576178709851472, "mean_inference_ms": 7.362274317157911, "mean_action_processing_ms": 0.5296614829856707, "mean_env_wait_ms": 23.25137503300899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03157496452331543, "StateBufferConnector_ms": 0.03589987754821777, "ViewRequirementAgentConnector_ms": 0.9577622413635254}}, "episode_reward_max": 84.90157754974099, "episode_reward_min": 9.389633701891047, "episode_reward_mean": 60.3288318044976, "episode_len_mean": 1108.78, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.2773297995261, 72.44022851974039, 52.1185741342006, 49.59695634647238, 39.7384276601654, 57.9330184031905, 63.06079376372152, 58.21027514207206, 60.68761178186459, 73.12471389356561, 70.79455896714148, 60.286926445235295, 61.76598513455586, 57.424018083646345, 57.610579656713284, 51.76170859556196, 41.05408831776827, 55.072738924450746, 42.43117477680197, 44.52828995146811, 50.87591588625066, 47.962758926148865, 60.847462319872115, 61.01724222397014, 59.724966155450026, 50.627569322179056, 56.724266926451484, 44.40748948700915, 61.58062348041074, 41.590744428933355, 56.77292727144463, 65.32324663244952, 42.26239947581006, 57.65975586208406, 69.29888679111065, 62.85471916674222, 68.75341596269895, 61.384419783024725, 78.1019481726654, 63.792497914414035, 47.12208425419284, 48.03891779402976, 67.41052710112724, 63.2208820710428, 58.30349922082849, 62.68769336330068, 51.00724168749367, 56.83644397305623, 73.74466528689898, 53.41092477109565, 71.05813797596497, 66.54505882746776, 70.16871798554138, 67.07902766652228, 60.11397607558513, 56.995271398881734, 66.31220068255121, 70.53853932392232, 59.70507787014104, 61.200266676862704, 47.10608885141629, 71.98304582919506, 78.11559769193204, 70.86399565668327, 52.219035924150624, 9.389633701891047, 74.87564596537257, 52.307371380707714, 52.56002622515623, 43.967622130389465, 64.9150662420787, 71.25940681118598, 65.48227720517367, 77.0154057528247, 51.51040989228623, 67.4717743131252, 73.17178320407707, 62.54578807774216, 66.742784658276, 58.55460786996074, 73.35181923477933, 66.69386656174353, 66.15769079671519, 48.16955188776036, 66.27338576891174, 76.47868759604005, 67.90449951171331, 64.98735536598404, 44.239144192877795, 54.94285855889567, 84.90157754974099, 53.89124374224486, 74.08203842928853, 68.20791823584261, 72.5477455543066, 61.75035618319655, 68.68762286902997, 52.39874413590747, 71.15474040720514, 71.02455799046142], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.576178709851472, "mean_inference_ms": 7.362274317157911, "mean_action_processing_ms": 0.5296614829856707, "mean_env_wait_ms": 23.25137503300899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03157496452331543, "StateBufferConnector_ms": 0.03589987754821777, "ViewRequirementAgentConnector_ms": 0.9577622413635254}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 626534, "num_agent_steps_trained": 626534, "num_env_steps_sampled": 626534, "num_env_steps_trained": 626534, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.56708759089264, "num_env_steps_trained_throughput_per_sec": 228.56708759089264, "timesteps_total": 626534, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 626534, "timers": {"training_iteration_time_ms": 68810.543, "sample_time_ms": 43268.312, "load_time_ms": 2710.208, "load_throughput": 5679.048, "learn_time_ms": 22210.89, "learn_throughput": 692.966, "synch_weights_time_ms": 498.754}, "counters": {"num_env_steps_sampled": 626534, "num_env_steps_trained": 626534, "num_agent_steps_sampled": 626534, "num_agent_steps_trained": 626534}, "done": false, "episodes_total": 674, "training_iteration": 48, "trial_id": "837cb_00000", "date": "2025-06-07_18-13-20", "timestamp": 1749312800, "time_this_iter_s": 68.43134355545044, "time_total_s": 2856.411549091339, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2856.411549091339, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 66.9425, "ram_util_percent": 88.43499999999999, "gpu_util_percent0": 0.2205, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.373466e-05, "total_loss": -0.120007169268475, "policy_loss": -0.02461308300749145, "vf_loss": 0.02425487811084498, "vf_explained_var": 0.9390864575992931, "kl": 0.013952604821672801, "entropy": 15.077561118386008, "entropy_coeff": 0.006867329999999998}, "model": {}, "num_grad_updates_lifetime": 22335.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 642172, "num_env_steps_trained": 642172, "num_agent_steps_sampled": 642172, "num_agent_steps_trained": 642172}, "sampler_results": {"episode_reward_max": 84.90157754974099, "episode_reward_min": 9.389633701891047, "episode_reward_mean": 61.21073466239315, "episode_len_mean": 1108.78, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.610579656713284, 51.76170859556196, 41.05408831776827, 55.072738924450746, 42.43117477680197, 44.52828995146811, 50.87591588625066, 47.962758926148865, 60.847462319872115, 61.01724222397014, 59.724966155450026, 50.627569322179056, 56.724266926451484, 44.40748948700915, 61.58062348041074, 41.590744428933355, 56.77292727144463, 65.32324663244952, 42.26239947581006, 57.65975586208406, 69.29888679111065, 62.85471916674222, 68.75341596269895, 61.384419783024725, 78.1019481726654, 63.792497914414035, 47.12208425419284, 48.03891779402976, 67.41052710112724, 63.2208820710428, 58.30349922082849, 62.68769336330068, 51.00724168749367, 56.83644397305623, 73.74466528689898, 53.41092477109565, 71.05813797596497, 66.54505882746776, 70.16871798554138, 67.07902766652228, 60.11397607558513, 56.995271398881734, 66.31220068255121, 70.53853932392232, 59.70507787014104, 61.200266676862704, 47.10608885141629, 71.98304582919506, 78.11559769193204, 70.86399565668327, 52.219035924150624, 9.389633701891047, 74.87564596537257, 52.307371380707714, 52.56002622515623, 43.967622130389465, 64.9150662420787, 71.25940681118598, 65.48227720517367, 77.0154057528247, 51.51040989228623, 67.4717743131252, 73.17178320407707, 62.54578807774216, 66.742784658276, 58.55460786996074, 73.35181923477933, 66.69386656174353, 66.15769079671519, 48.16955188776036, 66.27338576891174, 76.47868759604005, 67.90449951171331, 64.98735536598404, 44.239144192877795, 54.94285855889567, 84.90157754974099, 53.89124374224486, 74.08203842928853, 68.20791823584261, 72.5477455543066, 61.75035618319655, 68.68762286902997, 52.39874413590747, 71.15474040720514, 71.02455799046142, 63.291832494179076, 56.61042490839892, 49.64241619827053, 71.93701126228719, 72.30741761982344, 67.09118154885357, 74.24902478235724, 66.62785736880913, 67.77274748550978, 67.01334925365235, 64.44273842621017, 50.03134120730651, 72.55426566981082, 72.07809563918582], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5860782459173195, "mean_inference_ms": 7.389234533673588, "mean_action_processing_ms": 0.5312883686766369, "mean_env_wait_ms": 23.297858752506663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033608436584472656, "StateBufferConnector_ms": 0.03992438316345215, "ViewRequirementAgentConnector_ms": 0.9572725296020508}}, "episode_reward_max": 84.90157754974099, "episode_reward_min": 9.389633701891047, "episode_reward_mean": 61.21073466239315, "episode_len_mean": 1108.78, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [57.610579656713284, 51.76170859556196, 41.05408831776827, 55.072738924450746, 42.43117477680197, 44.52828995146811, 50.87591588625066, 47.962758926148865, 60.847462319872115, 61.01724222397014, 59.724966155450026, 50.627569322179056, 56.724266926451484, 44.40748948700915, 61.58062348041074, 41.590744428933355, 56.77292727144463, 65.32324663244952, 42.26239947581006, 57.65975586208406, 69.29888679111065, 62.85471916674222, 68.75341596269895, 61.384419783024725, 78.1019481726654, 63.792497914414035, 47.12208425419284, 48.03891779402976, 67.41052710112724, 63.2208820710428, 58.30349922082849, 62.68769336330068, 51.00724168749367, 56.83644397305623, 73.74466528689898, 53.41092477109565, 71.05813797596497, 66.54505882746776, 70.16871798554138, 67.07902766652228, 60.11397607558513, 56.995271398881734, 66.31220068255121, 70.53853932392232, 59.70507787014104, 61.200266676862704, 47.10608885141629, 71.98304582919506, 78.11559769193204, 70.86399565668327, 52.219035924150624, 9.389633701891047, 74.87564596537257, 52.307371380707714, 52.56002622515623, 43.967622130389465, 64.9150662420787, 71.25940681118598, 65.48227720517367, 77.0154057528247, 51.51040989228623, 67.4717743131252, 73.17178320407707, 62.54578807774216, 66.742784658276, 58.55460786996074, 73.35181923477933, 66.69386656174353, 66.15769079671519, 48.16955188776036, 66.27338576891174, 76.47868759604005, 67.90449951171331, 64.98735536598404, 44.239144192877795, 54.94285855889567, 84.90157754974099, 53.89124374224486, 74.08203842928853, 68.20791823584261, 72.5477455543066, 61.75035618319655, 68.68762286902997, 52.39874413590747, 71.15474040720514, 71.02455799046142, 63.291832494179076, 56.61042490839892, 49.64241619827053, 71.93701126228719, 72.30741761982344, 67.09118154885357, 74.24902478235724, 66.62785736880913, 67.77274748550978, 67.01334925365235, 64.44273842621017, 50.03134120730651, 72.55426566981082, 72.07809563918582], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5860782459173195, "mean_inference_ms": 7.389234533673588, "mean_action_processing_ms": 0.5312883686766369, "mean_env_wait_ms": 23.297858752506663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033608436584472656, "StateBufferConnector_ms": 0.03992438316345215, "ViewRequirementAgentConnector_ms": 0.9572725296020508}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 642172, "num_agent_steps_trained": 642172, "num_env_steps_sampled": 642172, "num_env_steps_trained": 642172, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.66722432945676, "num_env_steps_trained_throughput_per_sec": 227.66722432945676, "timesteps_total": 642172, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 642172, "timers": {"training_iteration_time_ms": 68641.942, "sample_time_ms": 43354.573, "load_time_ms": 2562.423, "load_throughput": 6006.58, "learn_time_ms": 22102.668, "learn_throughput": 696.359, "synch_weights_time_ms": 500.053}, "counters": {"num_env_steps_sampled": 642172, "num_env_steps_trained": 642172, "num_agent_steps_sampled": 642172, "num_agent_steps_trained": 642172}, "done": false, "episodes_total": 688, "training_iteration": 49, "trial_id": "837cb_00000", "date": "2025-06-07_18-14-29", "timestamp": 1749312869, "time_this_iter_s": 68.71297883987427, "time_total_s": 2925.1245279312134, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2925.1245279312134, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 66.53291139240507, "ram_util_percent": 88.85949367088605, "gpu_util_percent0": 0.21835443037974683, "vram_util_percent0": 0.9650065104166671}}
{"evaluation": {"sampler_results": {"episode_reward_max": -5.537746638875542, "episode_reward_min": -6.132431013490342, "episode_reward_mean": -5.8447242361304586, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.070965978451939, -6.132431013490342, -5.652264226828706, -5.830213323005764, -5.537746638875542], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8128931613052395, "mean_inference_ms": 3.9627487258894556, "mean_action_processing_ms": 0.29302415472609766, "mean_env_wait_ms": 12.685112475416139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28673648834228516}}, "episode_reward_max": -5.537746638875542, "episode_reward_min": -6.132431013490342, "episode_reward_mean": -5.8447242361304586, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.070965978451939, -6.132431013490342, -5.652264226828706, -5.830213323005764, -5.537746638875542], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8128931613052395, "mean_inference_ms": 3.9627487258894556, "mean_action_processing_ms": 0.29302415472609766, "mean_env_wait_ms": 12.685112475416139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.28673648834228516}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.357828000000002e-05, "total_loss": -0.09942545828277202, "policy_loss": -0.005858390305445276, "vf_loss": 0.026150038725781168, "vf_explained_var": 0.9401199957457456, "kl": 0.013987142687707108, "entropy": 15.066161036057906, "entropy_coeff": 0.006789140000000001}, "model": {}, "num_grad_updates_lifetime": 22885.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 657810, "num_env_steps_trained": 657810, "num_agent_steps_sampled": 657810, "num_agent_steps_trained": 657810}, "sampler_results": {"episode_reward_max": 84.90157754974099, "episode_reward_min": 9.389633701891047, "episode_reward_mean": 62.85087053085289, "episode_len_mean": 1108.78, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.58062348041074, 41.590744428933355, 56.77292727144463, 65.32324663244952, 42.26239947581006, 57.65975586208406, 69.29888679111065, 62.85471916674222, 68.75341596269895, 61.384419783024725, 78.1019481726654, 63.792497914414035, 47.12208425419284, 48.03891779402976, 67.41052710112724, 63.2208820710428, 58.30349922082849, 62.68769336330068, 51.00724168749367, 56.83644397305623, 73.74466528689898, 53.41092477109565, 71.05813797596497, 66.54505882746776, 70.16871798554138, 67.07902766652228, 60.11397607558513, 56.995271398881734, 66.31220068255121, 70.53853932392232, 59.70507787014104, 61.200266676862704, 47.10608885141629, 71.98304582919506, 78.11559769193204, 70.86399565668327, 52.219035924150624, 9.389633701891047, 74.87564596537257, 52.307371380707714, 52.56002622515623, 43.967622130389465, 64.9150662420787, 71.25940681118598, 65.48227720517367, 77.0154057528247, 51.51040989228623, 67.4717743131252, 73.17178320407707, 62.54578807774216, 66.742784658276, 58.55460786996074, 73.35181923477933, 66.69386656174353, 66.15769079671519, 48.16955188776036, 66.27338576891174, 76.47868759604005, 67.90449951171331, 64.98735536598404, 44.239144192877795, 54.94285855889567, 84.90157754974099, 53.89124374224486, 74.08203842928853, 68.20791823584261, 72.5477455543066, 61.75035618319655, 68.68762286902997, 52.39874413590747, 71.15474040720514, 71.02455799046142, 63.291832494179076, 56.61042490839892, 49.64241619827053, 71.93701126228719, 72.30741761982344, 67.09118154885357, 74.24902478235724, 66.62785736880913, 67.77274748550978, 67.01334925365235, 64.44273842621017, 50.03134120730651, 72.55426566981082, 72.07809563918582, 71.47330669484535, 73.13419244546719, 44.862575280857605, 65.9331659439246, 69.5561912353085, 68.31509293036686, 64.5864247556937, 66.45355272319864, 67.66203896338772, 58.346090621195195, 61.47807886285775, 35.1837432237476, 69.45587099775898, 72.21951363745924], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5966282912306258, "mean_inference_ms": 7.413701751225116, "mean_action_processing_ms": 0.5327494250750299, "mean_env_wait_ms": 23.340858683548376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029160737991333008, "StateBufferConnector_ms": 0.03725743293762207, "ViewRequirementAgentConnector_ms": 0.9265382289886475}}, "episode_reward_max": 84.90157754974099, "episode_reward_min": 9.389633701891047, "episode_reward_mean": 62.85087053085289, "episode_len_mean": 1108.78, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [61.58062348041074, 41.590744428933355, 56.77292727144463, 65.32324663244952, 42.26239947581006, 57.65975586208406, 69.29888679111065, 62.85471916674222, 68.75341596269895, 61.384419783024725, 78.1019481726654, 63.792497914414035, 47.12208425419284, 48.03891779402976, 67.41052710112724, 63.2208820710428, 58.30349922082849, 62.68769336330068, 51.00724168749367, 56.83644397305623, 73.74466528689898, 53.41092477109565, 71.05813797596497, 66.54505882746776, 70.16871798554138, 67.07902766652228, 60.11397607558513, 56.995271398881734, 66.31220068255121, 70.53853932392232, 59.70507787014104, 61.200266676862704, 47.10608885141629, 71.98304582919506, 78.11559769193204, 70.86399565668327, 52.219035924150624, 9.389633701891047, 74.87564596537257, 52.307371380707714, 52.56002622515623, 43.967622130389465, 64.9150662420787, 71.25940681118598, 65.48227720517367, 77.0154057528247, 51.51040989228623, 67.4717743131252, 73.17178320407707, 62.54578807774216, 66.742784658276, 58.55460786996074, 73.35181923477933, 66.69386656174353, 66.15769079671519, 48.16955188776036, 66.27338576891174, 76.47868759604005, 67.90449951171331, 64.98735536598404, 44.239144192877795, 54.94285855889567, 84.90157754974099, 53.89124374224486, 74.08203842928853, 68.20791823584261, 72.5477455543066, 61.75035618319655, 68.68762286902997, 52.39874413590747, 71.15474040720514, 71.02455799046142, 63.291832494179076, 56.61042490839892, 49.64241619827053, 71.93701126228719, 72.30741761982344, 67.09118154885357, 74.24902478235724, 66.62785736880913, 67.77274748550978, 67.01334925365235, 64.44273842621017, 50.03134120730651, 72.55426566981082, 72.07809563918582, 71.47330669484535, 73.13419244546719, 44.862575280857605, 65.9331659439246, 69.5561912353085, 68.31509293036686, 64.5864247556937, 66.45355272319864, 67.66203896338772, 58.346090621195195, 61.47807886285775, 35.1837432237476, 69.45587099775898, 72.21951363745924], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5966282912306258, "mean_inference_ms": 7.413701751225116, "mean_action_processing_ms": 0.5327494250750299, "mean_env_wait_ms": 23.340858683548376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029160737991333008, "StateBufferConnector_ms": 0.03725743293762207, "ViewRequirementAgentConnector_ms": 0.9265382289886475}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 657810, "num_agent_steps_trained": 657810, "num_env_steps_sampled": 657810, "num_env_steps_trained": 657810, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.94158398955847, "num_env_steps_trained_throughput_per_sec": 229.94158398955847, "timesteps_total": 657810, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 657810, "timers": {"training_iteration_time_ms": 68861.277, "sample_time_ms": 43294.725, "load_time_ms": 2543.965, "load_throughput": 6114.786, "learn_time_ms": 22401.146, "learn_throughput": 694.42, "synch_weights_time_ms": 501.304}, "counters": {"num_env_steps_sampled": 657810, "num_env_steps_trained": 657810, "num_agent_steps_sampled": 657810, "num_agent_steps_trained": 657810}, "done": false, "episodes_total": 702, "training_iteration": 50, "trial_id": "837cb_00000", "date": "2025-06-07_18-15-55", "timestamp": 1749312955, "time_this_iter_s": 85.92801141738892, "time_total_s": 3011.0525393486023, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3011.0525393486023, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 56.852941176470594, "ram_util_percent": 89.0313725490196, "gpu_util_percent0": 0.16931372549019608, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.342189999999998e-05, "total_loss": -0.11019391230349852, "policy_loss": -0.019472199840979143, "vf_loss": 0.03344851201802323, "vf_explained_var": 0.9356134476444938, "kl": 0.013087360296632624, "entropy": 15.135596164356578, "entropy_coeff": 0.006710949999999999}, "model": {}, "num_grad_updates_lifetime": 23435.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 673448, "num_env_steps_trained": 673448, "num_agent_steps_sampled": 673448, "num_agent_steps_trained": 673448}, "sampler_results": {"episode_reward_max": 84.90157754974099, "episode_reward_min": -28.21054168613826, "episode_reward_mean": 62.4638387439993, "episode_len_mean": 1108.78, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.41052710112724, 63.2208820710428, 58.30349922082849, 62.68769336330068, 51.00724168749367, 56.83644397305623, 73.74466528689898, 53.41092477109565, 71.05813797596497, 66.54505882746776, 70.16871798554138, 67.07902766652228, 60.11397607558513, 56.995271398881734, 66.31220068255121, 70.53853932392232, 59.70507787014104, 61.200266676862704, 47.10608885141629, 71.98304582919506, 78.11559769193204, 70.86399565668327, 52.219035924150624, 9.389633701891047, 74.87564596537257, 52.307371380707714, 52.56002622515623, 43.967622130389465, 64.9150662420787, 71.25940681118598, 65.48227720517367, 77.0154057528247, 51.51040989228623, 67.4717743131252, 73.17178320407707, 62.54578807774216, 66.742784658276, 58.55460786996074, 73.35181923477933, 66.69386656174353, 66.15769079671519, 48.16955188776036, 66.27338576891174, 76.47868759604005, 67.90449951171331, 64.98735536598404, 44.239144192877795, 54.94285855889567, 84.90157754974099, 53.89124374224486, 74.08203842928853, 68.20791823584261, 72.5477455543066, 61.75035618319655, 68.68762286902997, 52.39874413590747, 71.15474040720514, 71.02455799046142, 63.291832494179076, 56.61042490839892, 49.64241619827053, 71.93701126228719, 72.30741761982344, 67.09118154885357, 74.24902478235724, 66.62785736880913, 67.77274748550978, 67.01334925365235, 64.44273842621017, 50.03134120730651, 72.55426566981082, 72.07809563918582, 71.47330669484535, 73.13419244546719, 44.862575280857605, 65.9331659439246, 69.5561912353085, 68.31509293036686, 64.5864247556937, 66.45355272319864, 67.66203896338772, 58.346090621195195, 61.47807886285775, 35.1837432237476, 69.45587099775898, 72.21951363745924, 61.513629406459785, 54.55571990695522, 41.82016330477723, 70.81243672477653, 67.0066291765432, -28.21054168613826, 68.01575465553759, 64.59780925474332, 70.14414829827493, 64.92630196154778, 69.33965674611353, 42.39761521105318, 75.19459466840968, 63.71949067559726], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.606693996383338, "mean_inference_ms": 7.435409964006884, "mean_action_processing_ms": 0.5340689824003131, "mean_env_wait_ms": 23.377725026656936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026111841201782227, "StateBufferConnector_ms": 0.0364680290222168, "ViewRequirementAgentConnector_ms": 0.9236090183258057}}, "episode_reward_max": 84.90157754974099, "episode_reward_min": -28.21054168613826, "episode_reward_mean": 62.4638387439993, "episode_len_mean": 1108.78, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [67.41052710112724, 63.2208820710428, 58.30349922082849, 62.68769336330068, 51.00724168749367, 56.83644397305623, 73.74466528689898, 53.41092477109565, 71.05813797596497, 66.54505882746776, 70.16871798554138, 67.07902766652228, 60.11397607558513, 56.995271398881734, 66.31220068255121, 70.53853932392232, 59.70507787014104, 61.200266676862704, 47.10608885141629, 71.98304582919506, 78.11559769193204, 70.86399565668327, 52.219035924150624, 9.389633701891047, 74.87564596537257, 52.307371380707714, 52.56002622515623, 43.967622130389465, 64.9150662420787, 71.25940681118598, 65.48227720517367, 77.0154057528247, 51.51040989228623, 67.4717743131252, 73.17178320407707, 62.54578807774216, 66.742784658276, 58.55460786996074, 73.35181923477933, 66.69386656174353, 66.15769079671519, 48.16955188776036, 66.27338576891174, 76.47868759604005, 67.90449951171331, 64.98735536598404, 44.239144192877795, 54.94285855889567, 84.90157754974099, 53.89124374224486, 74.08203842928853, 68.20791823584261, 72.5477455543066, 61.75035618319655, 68.68762286902997, 52.39874413590747, 71.15474040720514, 71.02455799046142, 63.291832494179076, 56.61042490839892, 49.64241619827053, 71.93701126228719, 72.30741761982344, 67.09118154885357, 74.24902478235724, 66.62785736880913, 67.77274748550978, 67.01334925365235, 64.44273842621017, 50.03134120730651, 72.55426566981082, 72.07809563918582, 71.47330669484535, 73.13419244546719, 44.862575280857605, 65.9331659439246, 69.5561912353085, 68.31509293036686, 64.5864247556937, 66.45355272319864, 67.66203896338772, 58.346090621195195, 61.47807886285775, 35.1837432237476, 69.45587099775898, 72.21951363745924, 61.513629406459785, 54.55571990695522, 41.82016330477723, 70.81243672477653, 67.0066291765432, -28.21054168613826, 68.01575465553759, 64.59780925474332, 70.14414829827493, 64.92630196154778, 69.33965674611353, 42.39761521105318, 75.19459466840968, 63.71949067559726], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.606693996383338, "mean_inference_ms": 7.435409964006884, "mean_action_processing_ms": 0.5340689824003131, "mean_env_wait_ms": 23.377725026656936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026111841201782227, "StateBufferConnector_ms": 0.0364680290222168, "ViewRequirementAgentConnector_ms": 0.9236090183258057}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 673448, "num_agent_steps_trained": 673448, "num_env_steps_sampled": 673448, "num_env_steps_trained": 673448, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.94033452695447, "num_env_steps_trained_throughput_per_sec": 229.94033452695447, "timesteps_total": 673448, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 673448, "timers": {"training_iteration_time_ms": 68493.721, "sample_time_ms": 43196.554, "load_time_ms": 2294.757, "load_throughput": 6778.845, "learn_time_ms": 22346.36, "learn_throughput": 696.122, "synch_weights_time_ms": 527.593}, "counters": {"num_env_steps_sampled": 673448, "num_env_steps_trained": 673448, "num_agent_steps_sampled": 673448, "num_agent_steps_trained": 673448}, "done": false, "episodes_total": 716, "training_iteration": 51, "trial_id": "837cb_00000", "date": "2025-06-07_18-17-03", "timestamp": 1749313023, "time_this_iter_s": 68.02693462371826, "time_total_s": 3079.0794739723206, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3079.0794739723206, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 66.08, "ram_util_percent": 89.57500000000002, "gpu_util_percent0": 0.2145, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.326552e-05, "total_loss": -0.09693359944927082, "policy_loss": -0.004238036917945878, "vf_loss": 0.02248715696327219, "vf_explained_var": 0.944549935839393, "kl": 0.014553121996526324, "entropy": 15.129640664187345, "entropy_coeff": 0.0066327600000000006}, "model": {}, "num_grad_updates_lifetime": 23985.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 689086, "num_env_steps_trained": 689086, "num_agent_steps_sampled": 689086, "num_agent_steps_trained": 689086}, "sampler_results": {"episode_reward_max": 84.90157754974099, "episode_reward_min": -28.21054168613826, "episode_reward_mean": 62.71406958560026, "episode_len_mean": 1108.78, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.31220068255121, 70.53853932392232, 59.70507787014104, 61.200266676862704, 47.10608885141629, 71.98304582919506, 78.11559769193204, 70.86399565668327, 52.219035924150624, 9.389633701891047, 74.87564596537257, 52.307371380707714, 52.56002622515623, 43.967622130389465, 64.9150662420787, 71.25940681118598, 65.48227720517367, 77.0154057528247, 51.51040989228623, 67.4717743131252, 73.17178320407707, 62.54578807774216, 66.742784658276, 58.55460786996074, 73.35181923477933, 66.69386656174353, 66.15769079671519, 48.16955188776036, 66.27338576891174, 76.47868759604005, 67.90449951171331, 64.98735536598404, 44.239144192877795, 54.94285855889567, 84.90157754974099, 53.89124374224486, 74.08203842928853, 68.20791823584261, 72.5477455543066, 61.75035618319655, 68.68762286902997, 52.39874413590747, 71.15474040720514, 71.02455799046142, 63.291832494179076, 56.61042490839892, 49.64241619827053, 71.93701126228719, 72.30741761982344, 67.09118154885357, 74.24902478235724, 66.62785736880913, 67.77274748550978, 67.01334925365235, 64.44273842621017, 50.03134120730651, 72.55426566981082, 72.07809563918582, 71.47330669484535, 73.13419244546719, 44.862575280857605, 65.9331659439246, 69.5561912353085, 68.31509293036686, 64.5864247556937, 66.45355272319864, 67.66203896338772, 58.346090621195195, 61.47807886285775, 35.1837432237476, 69.45587099775898, 72.21951363745924, 61.513629406459785, 54.55571990695522, 41.82016330477723, 70.81243672477653, 67.0066291765432, -28.21054168613826, 68.01575465553759, 64.59780925474332, 70.14414829827493, 64.92630196154778, 69.33965674611353, 42.39761521105318, 75.19459466840968, 63.71949067559726, 67.25267594658968, 66.87732751200546, 48.11739383701231, 64.17884555445605, 72.45458836691539, 68.46466849874597, 76.13149353766089, 62.908656115808014, 64.89658866372818, 63.5288885957478, 67.97781485369266, 46.58305862967847, 66.1748268068194, 68.0583246460439], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6161961341979696, "mean_inference_ms": 7.456127518604181, "mean_action_processing_ms": 0.5353372790582143, "mean_env_wait_ms": 23.412450018790004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029179811477661133, "StateBufferConnector_ms": 0.03650999069213867, "ViewRequirementAgentConnector_ms": 0.9300038814544678}}, "episode_reward_max": 84.90157754974099, "episode_reward_min": -28.21054168613826, "episode_reward_mean": 62.71406958560026, "episode_len_mean": 1108.78, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [66.31220068255121, 70.53853932392232, 59.70507787014104, 61.200266676862704, 47.10608885141629, 71.98304582919506, 78.11559769193204, 70.86399565668327, 52.219035924150624, 9.389633701891047, 74.87564596537257, 52.307371380707714, 52.56002622515623, 43.967622130389465, 64.9150662420787, 71.25940681118598, 65.48227720517367, 77.0154057528247, 51.51040989228623, 67.4717743131252, 73.17178320407707, 62.54578807774216, 66.742784658276, 58.55460786996074, 73.35181923477933, 66.69386656174353, 66.15769079671519, 48.16955188776036, 66.27338576891174, 76.47868759604005, 67.90449951171331, 64.98735536598404, 44.239144192877795, 54.94285855889567, 84.90157754974099, 53.89124374224486, 74.08203842928853, 68.20791823584261, 72.5477455543066, 61.75035618319655, 68.68762286902997, 52.39874413590747, 71.15474040720514, 71.02455799046142, 63.291832494179076, 56.61042490839892, 49.64241619827053, 71.93701126228719, 72.30741761982344, 67.09118154885357, 74.24902478235724, 66.62785736880913, 67.77274748550978, 67.01334925365235, 64.44273842621017, 50.03134120730651, 72.55426566981082, 72.07809563918582, 71.47330669484535, 73.13419244546719, 44.862575280857605, 65.9331659439246, 69.5561912353085, 68.31509293036686, 64.5864247556937, 66.45355272319864, 67.66203896338772, 58.346090621195195, 61.47807886285775, 35.1837432237476, 69.45587099775898, 72.21951363745924, 61.513629406459785, 54.55571990695522, 41.82016330477723, 70.81243672477653, 67.0066291765432, -28.21054168613826, 68.01575465553759, 64.59780925474332, 70.14414829827493, 64.92630196154778, 69.33965674611353, 42.39761521105318, 75.19459466840968, 63.71949067559726, 67.25267594658968, 66.87732751200546, 48.11739383701231, 64.17884555445605, 72.45458836691539, 68.46466849874597, 76.13149353766089, 62.908656115808014, 64.89658866372818, 63.5288885957478, 67.97781485369266, 46.58305862967847, 66.1748268068194, 68.0583246460439], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6161961341979696, "mean_inference_ms": 7.456127518604181, "mean_action_processing_ms": 0.5353372790582143, "mean_env_wait_ms": 23.412450018790004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029179811477661133, "StateBufferConnector_ms": 0.03650999069213867, "ViewRequirementAgentConnector_ms": 0.9300038814544678}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 689086, "num_agent_steps_trained": 689086, "num_env_steps_sampled": 689086, "num_env_steps_trained": 689086, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.19547275502197, "num_env_steps_trained_throughput_per_sec": 228.19547275502197, "timesteps_total": 689086, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 689086, "timers": {"training_iteration_time_ms": 68573.022, "sample_time_ms": 43298.935, "load_time_ms": 2275.018, "load_throughput": 6837.661, "learn_time_ms": 22341.275, "learn_throughput": 696.281, "synch_weights_time_ms": 529.43}, "counters": {"num_env_steps_sampled": 689086, "num_env_steps_trained": 689086, "num_agent_steps_sampled": 689086, "num_agent_steps_trained": 689086}, "done": false, "episodes_total": 730, "training_iteration": 52, "trial_id": "837cb_00000", "date": "2025-06-07_18-18-11", "timestamp": 1749313091, "time_this_iter_s": 68.5509922504425, "time_total_s": 3147.630466222763, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3147.630466222763, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 67.97974683544304, "ram_util_percent": 88.7253164556962, "gpu_util_percent0": 0.21075949367088612, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.310913999999999e-05, "total_loss": -0.10288731264442487, "policy_loss": -0.01145421572253086, "vf_loss": 0.023170634563397265, "vf_explained_var": 0.8097176365132602, "kl": 0.014634385873578694, "entropy": 15.14957279349273, "entropy_coeff": 0.00655457}, "model": {}, "num_grad_updates_lifetime": 24525.5, "diff_num_grad_updates_vs_sampler_policy": 264.5}}, "num_env_steps_sampled": 703980, "num_env_steps_trained": 703980, "num_agent_steps_sampled": 703980, "num_agent_steps_trained": 703980}, "sampler_results": {"episode_reward_max": 84.90157754974099, "episode_reward_min": -28.21054168613826, "episode_reward_mean": 62.84087574081237, "episode_len_mean": 1109.56, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.9150662420787, 71.25940681118598, 65.48227720517367, 77.0154057528247, 51.51040989228623, 67.4717743131252, 73.17178320407707, 62.54578807774216, 66.742784658276, 58.55460786996074, 73.35181923477933, 66.69386656174353, 66.15769079671519, 48.16955188776036, 66.27338576891174, 76.47868759604005, 67.90449951171331, 64.98735536598404, 44.239144192877795, 54.94285855889567, 84.90157754974099, 53.89124374224486, 74.08203842928853, 68.20791823584261, 72.5477455543066, 61.75035618319655, 68.68762286902997, 52.39874413590747, 71.15474040720514, 71.02455799046142, 63.291832494179076, 56.61042490839892, 49.64241619827053, 71.93701126228719, 72.30741761982344, 67.09118154885357, 74.24902478235724, 66.62785736880913, 67.77274748550978, 67.01334925365235, 64.44273842621017, 50.03134120730651, 72.55426566981082, 72.07809563918582, 71.47330669484535, 73.13419244546719, 44.862575280857605, 65.9331659439246, 69.5561912353085, 68.31509293036686, 64.5864247556937, 66.45355272319864, 67.66203896338772, 58.346090621195195, 61.47807886285775, 35.1837432237476, 69.45587099775898, 72.21951363745924, 61.513629406459785, 54.55571990695522, 41.82016330477723, 70.81243672477653, 67.0066291765432, -28.21054168613826, 68.01575465553759, 64.59780925474332, 70.14414829827493, 64.92630196154778, 69.33965674611353, 42.39761521105318, 75.19459466840968, 63.71949067559726, 67.25267594658968, 66.87732751200546, 48.11739383701231, 64.17884555445605, 72.45458836691539, 68.46466849874597, 76.13149353766089, 62.908656115808014, 64.89658866372818, 63.5288885957478, 67.97781485369266, 46.58305862967847, 66.1748268068194, 68.0583246460439, 66.44836442630859, 64.37434803001825, 51.10178500754278, 58.660882778021524, 63.82658969704077, 57.245304963971755, 73.75608117251979, 10.529601075604074, 71.65784324094494, 59.506522354662735, 65.73345676561578, 50.88266657297904, 61.916987556005495, 68.1843297903473], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.62445463477568, "mean_inference_ms": 7.474199229287629, "mean_action_processing_ms": 0.536426752824461, "mean_env_wait_ms": 23.44225651470573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030239343643188477, "StateBufferConnector_ms": 0.035485029220581055, "ViewRequirementAgentConnector_ms": 0.9439518451690674}}, "episode_reward_max": 84.90157754974099, "episode_reward_min": -28.21054168613826, "episode_reward_mean": 62.84087574081237, "episode_len_mean": 1109.56, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.9150662420787, 71.25940681118598, 65.48227720517367, 77.0154057528247, 51.51040989228623, 67.4717743131252, 73.17178320407707, 62.54578807774216, 66.742784658276, 58.55460786996074, 73.35181923477933, 66.69386656174353, 66.15769079671519, 48.16955188776036, 66.27338576891174, 76.47868759604005, 67.90449951171331, 64.98735536598404, 44.239144192877795, 54.94285855889567, 84.90157754974099, 53.89124374224486, 74.08203842928853, 68.20791823584261, 72.5477455543066, 61.75035618319655, 68.68762286902997, 52.39874413590747, 71.15474040720514, 71.02455799046142, 63.291832494179076, 56.61042490839892, 49.64241619827053, 71.93701126228719, 72.30741761982344, 67.09118154885357, 74.24902478235724, 66.62785736880913, 67.77274748550978, 67.01334925365235, 64.44273842621017, 50.03134120730651, 72.55426566981082, 72.07809563918582, 71.47330669484535, 73.13419244546719, 44.862575280857605, 65.9331659439246, 69.5561912353085, 68.31509293036686, 64.5864247556937, 66.45355272319864, 67.66203896338772, 58.346090621195195, 61.47807886285775, 35.1837432237476, 69.45587099775898, 72.21951363745924, 61.513629406459785, 54.55571990695522, 41.82016330477723, 70.81243672477653, 67.0066291765432, -28.21054168613826, 68.01575465553759, 64.59780925474332, 70.14414829827493, 64.92630196154778, 69.33965674611353, 42.39761521105318, 75.19459466840968, 63.71949067559726, 67.25267594658968, 66.87732751200546, 48.11739383701231, 64.17884555445605, 72.45458836691539, 68.46466849874597, 76.13149353766089, 62.908656115808014, 64.89658866372818, 63.5288885957478, 67.97781485369266, 46.58305862967847, 66.1748268068194, 68.0583246460439, 66.44836442630859, 64.37434803001825, 51.10178500754278, 58.660882778021524, 63.82658969704077, 57.245304963971755, 73.75608117251979, 10.529601075604074, 71.65784324094494, 59.506522354662735, 65.73345676561578, 50.88266657297904, 61.916987556005495, 68.1843297903473], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.62445463477568, "mean_inference_ms": 7.474199229287629, "mean_action_processing_ms": 0.536426752824461, "mean_env_wait_ms": 23.44225651470573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030239343643188477, "StateBufferConnector_ms": 0.035485029220581055, "ViewRequirementAgentConnector_ms": 0.9439518451690674}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 703980, "num_agent_steps_trained": 703980, "num_env_steps_sampled": 703980, "num_env_steps_trained": 703980, "num_env_steps_sampled_this_iter": 14894, "num_env_steps_trained_this_iter": 14894, "num_env_steps_sampled_throughput_per_sec": 230.97780320880895, "num_env_steps_trained_throughput_per_sec": 230.97780320880895, "timesteps_total": 703980, "num_steps_trained_this_iter": 14894, "agent_timesteps_total": 703980, "timers": {"training_iteration_time_ms": 68029.074, "sample_time_ms": 42933.342, "load_time_ms": 2247.375, "load_throughput": 6888.658, "learn_time_ms": 22219.079, "learn_throughput": 696.762, "synch_weights_time_ms": 500.315}, "counters": {"num_env_steps_sampled": 703980, "num_env_steps_trained": 703980, "num_agent_steps_sampled": 703980, "num_agent_steps_trained": 703980}, "done": false, "episodes_total": 744, "training_iteration": 53, "trial_id": "837cb_00000", "date": "2025-06-07_18-19-16", "timestamp": 1749313156, "time_this_iter_s": 64.51038694381714, "time_total_s": 3212.14085316658, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3212.14085316658, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 65.1171052631579, "ram_util_percent": 88.84605263157896, "gpu_util_percent0": 0.21447368421052632, "vram_util_percent0": 0.965006510416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.296019999999998e-05, "total_loss": -0.09891267022371969, "policy_loss": -0.008399579716391268, "vf_loss": 0.02487103301417929, "vf_explained_var": 0.94321646083485, "kl": 0.013954283716687698, "entropy": 15.253860884579746, "entropy_coeff": 0.006480100000000001}, "model": {}, "num_grad_updates_lifetime": 25065.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 719618, "num_env_steps_trained": 719618, "num_agent_steps_sampled": 719618, "num_agent_steps_trained": 719618}, "sampler_results": {"episode_reward_max": 84.90157754974099, "episode_reward_min": -28.21054168613826, "episode_reward_mean": 62.29504988625288, "episode_len_mean": 1109.56, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.27338576891174, 76.47868759604005, 67.90449951171331, 64.98735536598404, 44.239144192877795, 54.94285855889567, 84.90157754974099, 53.89124374224486, 74.08203842928853, 68.20791823584261, 72.5477455543066, 61.75035618319655, 68.68762286902997, 52.39874413590747, 71.15474040720514, 71.02455799046142, 63.291832494179076, 56.61042490839892, 49.64241619827053, 71.93701126228719, 72.30741761982344, 67.09118154885357, 74.24902478235724, 66.62785736880913, 67.77274748550978, 67.01334925365235, 64.44273842621017, 50.03134120730651, 72.55426566981082, 72.07809563918582, 71.47330669484535, 73.13419244546719, 44.862575280857605, 65.9331659439246, 69.5561912353085, 68.31509293036686, 64.5864247556937, 66.45355272319864, 67.66203896338772, 58.346090621195195, 61.47807886285775, 35.1837432237476, 69.45587099775898, 72.21951363745924, 61.513629406459785, 54.55571990695522, 41.82016330477723, 70.81243672477653, 67.0066291765432, -28.21054168613826, 68.01575465553759, 64.59780925474332, 70.14414829827493, 64.92630196154778, 69.33965674611353, 42.39761521105318, 75.19459466840968, 63.71949067559726, 67.25267594658968, 66.87732751200546, 48.11739383701231, 64.17884555445605, 72.45458836691539, 68.46466849874597, 76.13149353766089, 62.908656115808014, 64.89658866372818, 63.5288885957478, 67.97781485369266, 46.58305862967847, 66.1748268068194, 68.0583246460439, 66.44836442630859, 64.37434803001825, 51.10178500754278, 58.660882778021524, 63.82658969704077, 57.245304963971755, 73.75608117251979, 10.529601075604074, 71.65784324094494, 59.506522354662735, 65.73345676561578, 50.88266657297904, 61.916987556005495, 68.1843297903473, 66.83731795825258, 65.22640334305616, 41.383302305350384, 63.37773312175207, 67.95272984115049, 60.950400904308225, 75.2650896538372, 62.364700446320555, 61.52519246473846, 57.52744185100851, 65.70912053486994, 47.15123831843607, 54.455235982179694, 68.7337403265193], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6317044305878277, "mean_inference_ms": 7.490869642204152, "mean_action_processing_ms": 0.5374263684059529, "mean_env_wait_ms": 23.468275815731545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030211687088012695, "StateBufferConnector_ms": 0.03245973587036133, "ViewRequirementAgentConnector_ms": 0.9206807613372803}}, "episode_reward_max": 84.90157754974099, "episode_reward_min": -28.21054168613826, "episode_reward_mean": 62.29504988625288, "episode_len_mean": 1109.56, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [66.27338576891174, 76.47868759604005, 67.90449951171331, 64.98735536598404, 44.239144192877795, 54.94285855889567, 84.90157754974099, 53.89124374224486, 74.08203842928853, 68.20791823584261, 72.5477455543066, 61.75035618319655, 68.68762286902997, 52.39874413590747, 71.15474040720514, 71.02455799046142, 63.291832494179076, 56.61042490839892, 49.64241619827053, 71.93701126228719, 72.30741761982344, 67.09118154885357, 74.24902478235724, 66.62785736880913, 67.77274748550978, 67.01334925365235, 64.44273842621017, 50.03134120730651, 72.55426566981082, 72.07809563918582, 71.47330669484535, 73.13419244546719, 44.862575280857605, 65.9331659439246, 69.5561912353085, 68.31509293036686, 64.5864247556937, 66.45355272319864, 67.66203896338772, 58.346090621195195, 61.47807886285775, 35.1837432237476, 69.45587099775898, 72.21951363745924, 61.513629406459785, 54.55571990695522, 41.82016330477723, 70.81243672477653, 67.0066291765432, -28.21054168613826, 68.01575465553759, 64.59780925474332, 70.14414829827493, 64.92630196154778, 69.33965674611353, 42.39761521105318, 75.19459466840968, 63.71949067559726, 67.25267594658968, 66.87732751200546, 48.11739383701231, 64.17884555445605, 72.45458836691539, 68.46466849874597, 76.13149353766089, 62.908656115808014, 64.89658866372818, 63.5288885957478, 67.97781485369266, 46.58305862967847, 66.1748268068194, 68.0583246460439, 66.44836442630859, 64.37434803001825, 51.10178500754278, 58.660882778021524, 63.82658969704077, 57.245304963971755, 73.75608117251979, 10.529601075604074, 71.65784324094494, 59.506522354662735, 65.73345676561578, 50.88266657297904, 61.916987556005495, 68.1843297903473, 66.83731795825258, 65.22640334305616, 41.383302305350384, 63.37773312175207, 67.95272984115049, 60.950400904308225, 75.2650896538372, 62.364700446320555, 61.52519246473846, 57.52744185100851, 65.70912053486994, 47.15123831843607, 54.455235982179694, 68.7337403265193], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6317044305878277, "mean_inference_ms": 7.490869642204152, "mean_action_processing_ms": 0.5374263684059529, "mean_env_wait_ms": 23.468275815731545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030211687088012695, "StateBufferConnector_ms": 0.03245973587036133, "ViewRequirementAgentConnector_ms": 0.9206807613372803}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 719618, "num_agent_steps_trained": 719618, "num_env_steps_sampled": 719618, "num_env_steps_trained": 719618, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 224.9714794668181, "num_env_steps_trained_throughput_per_sec": 224.9714794668181, "timesteps_total": 719618, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 719618, "timers": {"training_iteration_time_ms": 68012.345, "sample_time_ms": 42743.883, "load_time_ms": 2356.566, "load_throughput": 6569.475, "learn_time_ms": 22276.333, "learn_throughput": 694.971, "synch_weights_time_ms": 500.035}, "counters": {"num_env_steps_sampled": 719618, "num_env_steps_trained": 719618, "num_agent_steps_sampled": 719618, "num_agent_steps_trained": 719618}, "done": false, "episodes_total": 758, "training_iteration": 54, "trial_id": "837cb_00000", "date": "2025-06-07_18-20-26", "timestamp": 1749313226, "time_this_iter_s": 69.51303029060364, "time_total_s": 3281.653883457184, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3281.653883457184, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 66.29878048780488, "ram_util_percent": 89.35853658536584, "gpu_util_percent0": 0.2129268292682927, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.280382e-05, "total_loss": -0.09069285613061352, "policy_loss": -0.0007315415956757285, "vf_loss": 0.022926595405971802, "vf_explained_var": 0.9468756079673767, "kl": 0.013817360373188719, "entropy": 15.261520047621293, "entropy_coeff": 0.006401909999999999}, "model": {}, "num_grad_updates_lifetime": 25615.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 735256, "num_env_steps_trained": 735256, "num_agent_steps_sampled": 735256, "num_agent_steps_trained": 735256}, "sampler_results": {"episode_reward_max": 76.13149353766089, "episode_reward_min": -28.21054168613826, "episode_reward_mean": 62.18770777107365, "episode_len_mean": 1109.56, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.15474040720514, 71.02455799046142, 63.291832494179076, 56.61042490839892, 49.64241619827053, 71.93701126228719, 72.30741761982344, 67.09118154885357, 74.24902478235724, 66.62785736880913, 67.77274748550978, 67.01334925365235, 64.44273842621017, 50.03134120730651, 72.55426566981082, 72.07809563918582, 71.47330669484535, 73.13419244546719, 44.862575280857605, 65.9331659439246, 69.5561912353085, 68.31509293036686, 64.5864247556937, 66.45355272319864, 67.66203896338772, 58.346090621195195, 61.47807886285775, 35.1837432237476, 69.45587099775898, 72.21951363745924, 61.513629406459785, 54.55571990695522, 41.82016330477723, 70.81243672477653, 67.0066291765432, -28.21054168613826, 68.01575465553759, 64.59780925474332, 70.14414829827493, 64.92630196154778, 69.33965674611353, 42.39761521105318, 75.19459466840968, 63.71949067559726, 67.25267594658968, 66.87732751200546, 48.11739383701231, 64.17884555445605, 72.45458836691539, 68.46466849874597, 76.13149353766089, 62.908656115808014, 64.89658866372818, 63.5288885957478, 67.97781485369266, 46.58305862967847, 66.1748268068194, 68.0583246460439, 66.44836442630859, 64.37434803001825, 51.10178500754278, 58.660882778021524, 63.82658969704077, 57.245304963971755, 73.75608117251979, 10.529601075604074, 71.65784324094494, 59.506522354662735, 65.73345676561578, 50.88266657297904, 61.916987556005495, 68.1843297903473, 66.83731795825258, 65.22640334305616, 41.383302305350384, 63.37773312175207, 67.95272984115049, 60.950400904308225, 75.2650896538372, 62.364700446320555, 61.52519246473846, 57.52744185100851, 65.70912053486994, 47.15123831843607, 54.455235982179694, 68.7337403265193, 63.88163932826328, 64.00398297557564, 50.304787958758105, 61.60797691867406, 73.13889763756238, 63.947494199302334, 74.17292705835779, 69.39639733806227, 70.3411743570338, 54.65170819571621, 64.83465893272474, 53.69055121861843, 64.52483735455613, 72.06193270285155], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6384775444308666, "mean_inference_ms": 7.507303922178869, "mean_action_processing_ms": 0.538406743091206, "mean_env_wait_ms": 23.49293865883452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03067493438720703, "StateBufferConnector_ms": 0.03747701644897461, "ViewRequirementAgentConnector_ms": 0.9344429969787598}}, "episode_reward_max": 76.13149353766089, "episode_reward_min": -28.21054168613826, "episode_reward_mean": 62.18770777107365, "episode_len_mean": 1109.56, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [71.15474040720514, 71.02455799046142, 63.291832494179076, 56.61042490839892, 49.64241619827053, 71.93701126228719, 72.30741761982344, 67.09118154885357, 74.24902478235724, 66.62785736880913, 67.77274748550978, 67.01334925365235, 64.44273842621017, 50.03134120730651, 72.55426566981082, 72.07809563918582, 71.47330669484535, 73.13419244546719, 44.862575280857605, 65.9331659439246, 69.5561912353085, 68.31509293036686, 64.5864247556937, 66.45355272319864, 67.66203896338772, 58.346090621195195, 61.47807886285775, 35.1837432237476, 69.45587099775898, 72.21951363745924, 61.513629406459785, 54.55571990695522, 41.82016330477723, 70.81243672477653, 67.0066291765432, -28.21054168613826, 68.01575465553759, 64.59780925474332, 70.14414829827493, 64.92630196154778, 69.33965674611353, 42.39761521105318, 75.19459466840968, 63.71949067559726, 67.25267594658968, 66.87732751200546, 48.11739383701231, 64.17884555445605, 72.45458836691539, 68.46466849874597, 76.13149353766089, 62.908656115808014, 64.89658866372818, 63.5288885957478, 67.97781485369266, 46.58305862967847, 66.1748268068194, 68.0583246460439, 66.44836442630859, 64.37434803001825, 51.10178500754278, 58.660882778021524, 63.82658969704077, 57.245304963971755, 73.75608117251979, 10.529601075604074, 71.65784324094494, 59.506522354662735, 65.73345676561578, 50.88266657297904, 61.916987556005495, 68.1843297903473, 66.83731795825258, 65.22640334305616, 41.383302305350384, 63.37773312175207, 67.95272984115049, 60.950400904308225, 75.2650896538372, 62.364700446320555, 61.52519246473846, 57.52744185100851, 65.70912053486994, 47.15123831843607, 54.455235982179694, 68.7337403265193, 63.88163932826328, 64.00398297557564, 50.304787958758105, 61.60797691867406, 73.13889763756238, 63.947494199302334, 74.17292705835779, 69.39639733806227, 70.3411743570338, 54.65170819571621, 64.83465893272474, 53.69055121861843, 64.52483735455613, 72.06193270285155], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6384775444308666, "mean_inference_ms": 7.507303922178869, "mean_action_processing_ms": 0.538406743091206, "mean_env_wait_ms": 23.49293865883452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03067493438720703, "StateBufferConnector_ms": 0.03747701644897461, "ViewRequirementAgentConnector_ms": 0.9344429969787598}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 735256, "num_agent_steps_trained": 735256, "num_env_steps_sampled": 735256, "num_env_steps_trained": 735256, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.21934179797773, "num_env_steps_trained_throughput_per_sec": 226.21934179797773, "timesteps_total": 735256, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 735256, "timers": {"training_iteration_time_ms": 68074.24, "sample_time_ms": 42799.895, "load_time_ms": 2391.614, "load_throughput": 6473.202, "learn_time_ms": 22248.699, "learn_throughput": 695.834, "synch_weights_time_ms": 498.302}, "counters": {"num_env_steps_sampled": 735256, "num_env_steps_trained": 735256, "num_agent_steps_sampled": 735256, "num_agent_steps_trained": 735256}, "done": false, "episodes_total": 772, "training_iteration": 55, "trial_id": "837cb_00000", "date": "2025-06-07_18-21-35", "timestamp": 1749313295, "time_this_iter_s": 69.14861559867859, "time_total_s": 3350.8024990558624, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3350.8024990558624, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 67.26124999999999, "ram_util_percent": 88.85624999999999, "gpu_util_percent0": 0.20725, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.264744000000001e-05, "total_loss": -0.09082605734763836, "policy_loss": -0.002005728256296028, "vf_loss": 0.021877635793591088, "vf_explained_var": 0.9504306890747763, "kl": 0.01480348108405277, "entropy": 15.22977572181008, "entropy_coeff": 0.006323719999999998}, "model": {}, "num_grad_updates_lifetime": 26165.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 750894, "num_env_steps_trained": 750894, "num_agent_steps_sampled": 750894, "num_agent_steps_trained": 750894}, "sampler_results": {"episode_reward_max": 76.13149353766089, "episode_reward_min": -28.21054168613826, "episode_reward_mean": 62.13577318364829, "episode_len_mean": 1109.56, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.55426566981082, 72.07809563918582, 71.47330669484535, 73.13419244546719, 44.862575280857605, 65.9331659439246, 69.5561912353085, 68.31509293036686, 64.5864247556937, 66.45355272319864, 67.66203896338772, 58.346090621195195, 61.47807886285775, 35.1837432237476, 69.45587099775898, 72.21951363745924, 61.513629406459785, 54.55571990695522, 41.82016330477723, 70.81243672477653, 67.0066291765432, -28.21054168613826, 68.01575465553759, 64.59780925474332, 70.14414829827493, 64.92630196154778, 69.33965674611353, 42.39761521105318, 75.19459466840968, 63.71949067559726, 67.25267594658968, 66.87732751200546, 48.11739383701231, 64.17884555445605, 72.45458836691539, 68.46466849874597, 76.13149353766089, 62.908656115808014, 64.89658866372818, 63.5288885957478, 67.97781485369266, 46.58305862967847, 66.1748268068194, 68.0583246460439, 66.44836442630859, 64.37434803001825, 51.10178500754278, 58.660882778021524, 63.82658969704077, 57.245304963971755, 73.75608117251979, 10.529601075604074, 71.65784324094494, 59.506522354662735, 65.73345676561578, 50.88266657297904, 61.916987556005495, 68.1843297903473, 66.83731795825258, 65.22640334305616, 41.383302305350384, 63.37773312175207, 67.95272984115049, 60.950400904308225, 75.2650896538372, 62.364700446320555, 61.52519246473846, 57.52744185100851, 65.70912053486994, 47.15123831843607, 54.455235982179694, 68.7337403265193, 63.88163932826328, 64.00398297557564, 50.304787958758105, 61.60797691867406, 73.13889763756238, 63.947494199302334, 74.17292705835779, 69.39639733806227, 70.3411743570338, 54.65170819571621, 64.83465893272474, 53.69055121861843, 64.52483735455613, 72.06193270285155, 64.1222391297096, 64.88826261217834, 46.82882055132408, 64.05628640176113, 75.60230926972088, 59.13889530026692, 75.27449391941978, 68.07867003690917, 62.91967419159543, 70.94761511201048, 60.85960206206466, 53.18624021706012, 66.01373357250569, 76.08633983426385], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6447956984442986, "mean_inference_ms": 7.524370362949086, "mean_action_processing_ms": 0.5394528836354224, "mean_env_wait_ms": 23.518455315613725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03372788429260254, "StateBufferConnector_ms": 0.03452467918395996, "ViewRequirementAgentConnector_ms": 0.9072751998901367}}, "episode_reward_max": 76.13149353766089, "episode_reward_min": -28.21054168613826, "episode_reward_mean": 62.13577318364829, "episode_len_mean": 1109.56, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [72.55426566981082, 72.07809563918582, 71.47330669484535, 73.13419244546719, 44.862575280857605, 65.9331659439246, 69.5561912353085, 68.31509293036686, 64.5864247556937, 66.45355272319864, 67.66203896338772, 58.346090621195195, 61.47807886285775, 35.1837432237476, 69.45587099775898, 72.21951363745924, 61.513629406459785, 54.55571990695522, 41.82016330477723, 70.81243672477653, 67.0066291765432, -28.21054168613826, 68.01575465553759, 64.59780925474332, 70.14414829827493, 64.92630196154778, 69.33965674611353, 42.39761521105318, 75.19459466840968, 63.71949067559726, 67.25267594658968, 66.87732751200546, 48.11739383701231, 64.17884555445605, 72.45458836691539, 68.46466849874597, 76.13149353766089, 62.908656115808014, 64.89658866372818, 63.5288885957478, 67.97781485369266, 46.58305862967847, 66.1748268068194, 68.0583246460439, 66.44836442630859, 64.37434803001825, 51.10178500754278, 58.660882778021524, 63.82658969704077, 57.245304963971755, 73.75608117251979, 10.529601075604074, 71.65784324094494, 59.506522354662735, 65.73345676561578, 50.88266657297904, 61.916987556005495, 68.1843297903473, 66.83731795825258, 65.22640334305616, 41.383302305350384, 63.37773312175207, 67.95272984115049, 60.950400904308225, 75.2650896538372, 62.364700446320555, 61.52519246473846, 57.52744185100851, 65.70912053486994, 47.15123831843607, 54.455235982179694, 68.7337403265193, 63.88163932826328, 64.00398297557564, 50.304787958758105, 61.60797691867406, 73.13889763756238, 63.947494199302334, 74.17292705835779, 69.39639733806227, 70.3411743570338, 54.65170819571621, 64.83465893272474, 53.69055121861843, 64.52483735455613, 72.06193270285155, 64.1222391297096, 64.88826261217834, 46.82882055132408, 64.05628640176113, 75.60230926972088, 59.13889530026692, 75.27449391941978, 68.07867003690917, 62.91967419159543, 70.94761511201048, 60.85960206206466, 53.18624021706012, 66.01373357250569, 76.08633983426385], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6447956984442986, "mean_inference_ms": 7.524370362949086, "mean_action_processing_ms": 0.5394528836354224, "mean_env_wait_ms": 23.518455315613725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03372788429260254, "StateBufferConnector_ms": 0.03452467918395996, "ViewRequirementAgentConnector_ms": 0.9072751998901367}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 750894, "num_agent_steps_trained": 750894, "num_env_steps_sampled": 750894, "num_env_steps_trained": 750894, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.45537452366747, "num_env_steps_trained_throughput_per_sec": 227.45537452366747, "timesteps_total": 750894, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 750894, "timers": {"training_iteration_time_ms": 68324.759, "sample_time_ms": 42947.374, "load_time_ms": 2379.665, "load_throughput": 6540.247, "learn_time_ms": 22370.934, "learn_throughput": 695.706, "synch_weights_time_ms": 493.514}, "counters": {"num_env_steps_sampled": 750894, "num_env_steps_trained": 750894, "num_agent_steps_sampled": 750894, "num_agent_steps_trained": 750894}, "done": false, "episodes_total": 786, "training_iteration": 56, "trial_id": "837cb_00000", "date": "2025-06-07_18-22-44", "timestamp": 1749313364, "time_this_iter_s": 68.82299494743347, "time_total_s": 3419.625494003296, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3419.625494003296, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 66.39375, "ram_util_percent": 88.49375, "gpu_util_percent0": 0.215125, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.249106e-05, "total_loss": -0.11603754192252051, "policy_loss": -0.028000466043727516, "vf_loss": 0.022079004012259908, "vf_explained_var": 0.9492359004237435, "kl": 0.014333174632948212, "entropy": 15.299998633644798, "entropy_coeff": 0.006245529999999999}, "model": {}, "num_grad_updates_lifetime": 26715.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 766532, "num_env_steps_trained": 766532, "num_agent_steps_sampled": 766532, "num_agent_steps_trained": 766532}, "sampler_results": {"episode_reward_max": 76.13149353766089, "episode_reward_min": -28.21054168613826, "episode_reward_mean": 62.1613737565272, "episode_len_mean": 1109.56, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.45587099775898, 72.21951363745924, 61.513629406459785, 54.55571990695522, 41.82016330477723, 70.81243672477653, 67.0066291765432, -28.21054168613826, 68.01575465553759, 64.59780925474332, 70.14414829827493, 64.92630196154778, 69.33965674611353, 42.39761521105318, 75.19459466840968, 63.71949067559726, 67.25267594658968, 66.87732751200546, 48.11739383701231, 64.17884555445605, 72.45458836691539, 68.46466849874597, 76.13149353766089, 62.908656115808014, 64.89658866372818, 63.5288885957478, 67.97781485369266, 46.58305862967847, 66.1748268068194, 68.0583246460439, 66.44836442630859, 64.37434803001825, 51.10178500754278, 58.660882778021524, 63.82658969704077, 57.245304963971755, 73.75608117251979, 10.529601075604074, 71.65784324094494, 59.506522354662735, 65.73345676561578, 50.88266657297904, 61.916987556005495, 68.1843297903473, 66.83731795825258, 65.22640334305616, 41.383302305350384, 63.37773312175207, 67.95272984115049, 60.950400904308225, 75.2650896538372, 62.364700446320555, 61.52519246473846, 57.52744185100851, 65.70912053486994, 47.15123831843607, 54.455235982179694, 68.7337403265193, 63.88163932826328, 64.00398297557564, 50.304787958758105, 61.60797691867406, 73.13889763756238, 63.947494199302334, 74.17292705835779, 69.39639733806227, 70.3411743570338, 54.65170819571621, 64.83465893272474, 53.69055121861843, 64.52483735455613, 72.06193270285155, 64.1222391297096, 64.88826261217834, 46.82882055132408, 64.05628640176113, 75.60230926972088, 59.13889530026692, 75.27449391941978, 68.07867003690917, 62.91967419159543, 70.94761511201048, 60.85960206206466, 53.18624021706012, 66.01373357250569, 76.08633983426385, 65.59144432930474, 64.09548497727155, 49.763385016012336, 46.767515295023685, 72.39185564897751, 62.16358409184436, 72.39482685698624, 67.93507921144055, 72.58273391058307, 63.83722163490569, 69.23062131226307, 51.20452817190774, 68.76356504664825, 67.45502677456929], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6510405713881555, "mean_inference_ms": 7.5408366990785405, "mean_action_processing_ms": 0.5405065204419401, "mean_env_wait_ms": 23.543229232438865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030688047409057617, "StateBufferConnector_ms": 0.03860163688659668, "ViewRequirementAgentConnector_ms": 0.9214394092559814}}, "episode_reward_max": 76.13149353766089, "episode_reward_min": -28.21054168613826, "episode_reward_mean": 62.1613737565272, "episode_len_mean": 1109.56, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [69.45587099775898, 72.21951363745924, 61.513629406459785, 54.55571990695522, 41.82016330477723, 70.81243672477653, 67.0066291765432, -28.21054168613826, 68.01575465553759, 64.59780925474332, 70.14414829827493, 64.92630196154778, 69.33965674611353, 42.39761521105318, 75.19459466840968, 63.71949067559726, 67.25267594658968, 66.87732751200546, 48.11739383701231, 64.17884555445605, 72.45458836691539, 68.46466849874597, 76.13149353766089, 62.908656115808014, 64.89658866372818, 63.5288885957478, 67.97781485369266, 46.58305862967847, 66.1748268068194, 68.0583246460439, 66.44836442630859, 64.37434803001825, 51.10178500754278, 58.660882778021524, 63.82658969704077, 57.245304963971755, 73.75608117251979, 10.529601075604074, 71.65784324094494, 59.506522354662735, 65.73345676561578, 50.88266657297904, 61.916987556005495, 68.1843297903473, 66.83731795825258, 65.22640334305616, 41.383302305350384, 63.37773312175207, 67.95272984115049, 60.950400904308225, 75.2650896538372, 62.364700446320555, 61.52519246473846, 57.52744185100851, 65.70912053486994, 47.15123831843607, 54.455235982179694, 68.7337403265193, 63.88163932826328, 64.00398297557564, 50.304787958758105, 61.60797691867406, 73.13889763756238, 63.947494199302334, 74.17292705835779, 69.39639733806227, 70.3411743570338, 54.65170819571621, 64.83465893272474, 53.69055121861843, 64.52483735455613, 72.06193270285155, 64.1222391297096, 64.88826261217834, 46.82882055132408, 64.05628640176113, 75.60230926972088, 59.13889530026692, 75.27449391941978, 68.07867003690917, 62.91967419159543, 70.94761511201048, 60.85960206206466, 53.18624021706012, 66.01373357250569, 76.08633983426385, 65.59144432930474, 64.09548497727155, 49.763385016012336, 46.767515295023685, 72.39185564897751, 62.16358409184436, 72.39482685698624, 67.93507921144055, 72.58273391058307, 63.83722163490569, 69.23062131226307, 51.20452817190774, 68.76356504664825, 67.45502677456929], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6510405713881555, "mean_inference_ms": 7.5408366990785405, "mean_action_processing_ms": 0.5405065204419401, "mean_env_wait_ms": 23.543229232438865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030688047409057617, "StateBufferConnector_ms": 0.03860163688659668, "ViewRequirementAgentConnector_ms": 0.9214394092559814}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 766532, "num_agent_steps_trained": 766532, "num_env_steps_sampled": 766532, "num_env_steps_trained": 766532, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.46954620334887, "num_env_steps_trained_throughput_per_sec": 229.46954620334887, "timesteps_total": 766532, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 766532, "timers": {"training_iteration_time_ms": 68167.246, "sample_time_ms": 42848.483, "load_time_ms": 2369.011, "load_throughput": 6569.661, "learn_time_ms": 22325.339, "learn_throughput": 697.127, "synch_weights_time_ms": 491.959}, "counters": {"num_env_steps_sampled": 766532, "num_env_steps_trained": 766532, "num_agent_steps_sampled": 766532, "num_agent_steps_trained": 766532}, "done": false, "episodes_total": 800, "training_iteration": 57, "trial_id": "837cb_00000", "date": "2025-06-07_18-23-52", "timestamp": 1749313432, "time_this_iter_s": 68.165372133255, "time_total_s": 3487.790866136551, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3487.790866136551, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 66.77088607594938, "ram_util_percent": 88.56075949367086, "gpu_util_percent0": 0.2091139240506329, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.233468000000001e-05, "total_loss": -0.08484720676015554, "policy_loss": 0.0013292469408109106, "vf_loss": 0.02068362265592441, "vf_explained_var": 0.9497544853253798, "kl": 0.015383994976346021, "entropy": 15.135056327473034, "entropy_coeff": 0.00616734}, "model": {}, "num_grad_updates_lifetime": 27265.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 782170, "num_env_steps_trained": 782170, "num_agent_steps_sampled": 782170, "num_agent_steps_trained": 782170}, "sampler_results": {"episode_reward_max": 76.52382162653355, "episode_reward_min": 10.529601075604074, "episode_reward_mean": 63.28172733596875, "episode_len_mean": 1109.56, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.19459466840968, 63.71949067559726, 67.25267594658968, 66.87732751200546, 48.11739383701231, 64.17884555445605, 72.45458836691539, 68.46466849874597, 76.13149353766089, 62.908656115808014, 64.89658866372818, 63.5288885957478, 67.97781485369266, 46.58305862967847, 66.1748268068194, 68.0583246460439, 66.44836442630859, 64.37434803001825, 51.10178500754278, 58.660882778021524, 63.82658969704077, 57.245304963971755, 73.75608117251979, 10.529601075604074, 71.65784324094494, 59.506522354662735, 65.73345676561578, 50.88266657297904, 61.916987556005495, 68.1843297903473, 66.83731795825258, 65.22640334305616, 41.383302305350384, 63.37773312175207, 67.95272984115049, 60.950400904308225, 75.2650896538372, 62.364700446320555, 61.52519246473846, 57.52744185100851, 65.70912053486994, 47.15123831843607, 54.455235982179694, 68.7337403265193, 63.88163932826328, 64.00398297557564, 50.304787958758105, 61.60797691867406, 73.13889763756238, 63.947494199302334, 74.17292705835779, 69.39639733806227, 70.3411743570338, 54.65170819571621, 64.83465893272474, 53.69055121861843, 64.52483735455613, 72.06193270285155, 64.1222391297096, 64.88826261217834, 46.82882055132408, 64.05628640176113, 75.60230926972088, 59.13889530026692, 75.27449391941978, 68.07867003690917, 62.91967419159543, 70.94761511201048, 60.85960206206466, 53.18624021706012, 66.01373357250569, 76.08633983426385, 65.59144432930474, 64.09548497727155, 49.763385016012336, 46.767515295023685, 72.39185564897751, 62.16358409184436, 72.39482685698624, 67.93507921144055, 72.58273391058307, 63.83722163490569, 69.23062131226307, 51.20452817190774, 68.76356504664825, 67.45502677456929, 60.398251601992676, 64.16092454805815, 49.229667461444826, 71.53923571292108, 76.52382162653355, 65.05526397600167, 73.25448683771765, 64.14426423792061, 66.52591805883765, 62.89985366112934, 59.913660132116114, 46.61455628266419, 72.64988634528112, 67.72027505739895], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6574654533939306, "mean_inference_ms": 7.557320213373648, "mean_action_processing_ms": 0.541526169303239, "mean_env_wait_ms": 23.56832276348708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02971053123474121, "StateBufferConnector_ms": 0.03426027297973633, "ViewRequirementAgentConnector_ms": 0.9318127632141113}}, "episode_reward_max": 76.52382162653355, "episode_reward_min": 10.529601075604074, "episode_reward_mean": 63.28172733596875, "episode_len_mean": 1109.56, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [75.19459466840968, 63.71949067559726, 67.25267594658968, 66.87732751200546, 48.11739383701231, 64.17884555445605, 72.45458836691539, 68.46466849874597, 76.13149353766089, 62.908656115808014, 64.89658866372818, 63.5288885957478, 67.97781485369266, 46.58305862967847, 66.1748268068194, 68.0583246460439, 66.44836442630859, 64.37434803001825, 51.10178500754278, 58.660882778021524, 63.82658969704077, 57.245304963971755, 73.75608117251979, 10.529601075604074, 71.65784324094494, 59.506522354662735, 65.73345676561578, 50.88266657297904, 61.916987556005495, 68.1843297903473, 66.83731795825258, 65.22640334305616, 41.383302305350384, 63.37773312175207, 67.95272984115049, 60.950400904308225, 75.2650896538372, 62.364700446320555, 61.52519246473846, 57.52744185100851, 65.70912053486994, 47.15123831843607, 54.455235982179694, 68.7337403265193, 63.88163932826328, 64.00398297557564, 50.304787958758105, 61.60797691867406, 73.13889763756238, 63.947494199302334, 74.17292705835779, 69.39639733806227, 70.3411743570338, 54.65170819571621, 64.83465893272474, 53.69055121861843, 64.52483735455613, 72.06193270285155, 64.1222391297096, 64.88826261217834, 46.82882055132408, 64.05628640176113, 75.60230926972088, 59.13889530026692, 75.27449391941978, 68.07867003690917, 62.91967419159543, 70.94761511201048, 60.85960206206466, 53.18624021706012, 66.01373357250569, 76.08633983426385, 65.59144432930474, 64.09548497727155, 49.763385016012336, 46.767515295023685, 72.39185564897751, 62.16358409184436, 72.39482685698624, 67.93507921144055, 72.58273391058307, 63.83722163490569, 69.23062131226307, 51.20452817190774, 68.76356504664825, 67.45502677456929, 60.398251601992676, 64.16092454805815, 49.229667461444826, 71.53923571292108, 76.52382162653355, 65.05526397600167, 73.25448683771765, 64.14426423792061, 66.52591805883765, 62.89985366112934, 59.913660132116114, 46.61455628266419, 72.64988634528112, 67.72027505739895], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6574654533939306, "mean_inference_ms": 7.557320213373648, "mean_action_processing_ms": 0.541526169303239, "mean_env_wait_ms": 23.56832276348708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02971053123474121, "StateBufferConnector_ms": 0.03426027297973633, "ViewRequirementAgentConnector_ms": 0.9318127632141113}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 782170, "num_agent_steps_trained": 782170, "num_env_steps_sampled": 782170, "num_env_steps_trained": 782170, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.37779492062623, "num_env_steps_trained_throughput_per_sec": 226.37779492062623, "timesteps_total": 782170, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 782170, "timers": {"training_iteration_time_ms": 68233.412, "sample_time_ms": 42854.125, "load_time_ms": 2416.668, "load_throughput": 6440.107, "learn_time_ms": 22339.516, "learn_throughput": 696.685, "synch_weights_time_ms": 488.145}, "counters": {"num_env_steps_sampled": 782170, "num_env_steps_trained": 782170, "num_agent_steps_sampled": 782170, "num_agent_steps_trained": 782170}, "done": false, "episodes_total": 814, "training_iteration": 58, "trial_id": "837cb_00000", "date": "2025-06-07_18-25-01", "timestamp": 1749313501, "time_this_iter_s": 69.09576988220215, "time_total_s": 3556.886636018753, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3556.886636018753, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 66.46543209876545, "ram_util_percent": 88.96049382716049, "gpu_util_percent0": 0.21876543209876545, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.217830000000003e-05, "total_loss": -0.07879895594627173, "policy_loss": 0.006467237900519235, "vf_loss": 0.021459606336006385, "vf_explained_var": 0.9501137771389702, "kl": 0.015170913829036023, "entropy": 15.215959207361395, "entropy_coeff": 0.006089150000000001}, "model": {}, "num_grad_updates_lifetime": 27815.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 797808, "num_env_steps_trained": 797808, "num_agent_steps_sampled": 797808, "num_agent_steps_trained": 797808}, "sampler_results": {"episode_reward_max": 76.52382162653355, "episode_reward_min": 10.529601075604074, "episode_reward_mean": 63.06282535965381, "episode_len_mean": 1109.56, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.1748268068194, 68.0583246460439, 66.44836442630859, 64.37434803001825, 51.10178500754278, 58.660882778021524, 63.82658969704077, 57.245304963971755, 73.75608117251979, 10.529601075604074, 71.65784324094494, 59.506522354662735, 65.73345676561578, 50.88266657297904, 61.916987556005495, 68.1843297903473, 66.83731795825258, 65.22640334305616, 41.383302305350384, 63.37773312175207, 67.95272984115049, 60.950400904308225, 75.2650896538372, 62.364700446320555, 61.52519246473846, 57.52744185100851, 65.70912053486994, 47.15123831843607, 54.455235982179694, 68.7337403265193, 63.88163932826328, 64.00398297557564, 50.304787958758105, 61.60797691867406, 73.13889763756238, 63.947494199302334, 74.17292705835779, 69.39639733806227, 70.3411743570338, 54.65170819571621, 64.83465893272474, 53.69055121861843, 64.52483735455613, 72.06193270285155, 64.1222391297096, 64.88826261217834, 46.82882055132408, 64.05628640176113, 75.60230926972088, 59.13889530026692, 75.27449391941978, 68.07867003690917, 62.91967419159543, 70.94761511201048, 60.85960206206466, 53.18624021706012, 66.01373357250569, 76.08633983426385, 65.59144432930474, 64.09548497727155, 49.763385016012336, 46.767515295023685, 72.39185564897751, 62.16358409184436, 72.39482685698624, 67.93507921144055, 72.58273391058307, 63.83722163490569, 69.23062131226307, 51.20452817190774, 68.76356504664825, 67.45502677456929, 60.398251601992676, 64.16092454805815, 49.229667461444826, 71.53923571292108, 76.52382162653355, 65.05526397600167, 73.25448683771765, 64.14426423792061, 66.52591805883765, 62.89985366112934, 59.913660132116114, 46.61455628266419, 72.64988634528112, 67.72027505739895, 59.013413024514975, 62.42464125480143, 47.78292309734762, 62.827767325614374, 66.00242372093733, 66.51866214917675, 71.65811253396204, 70.97377540287431, 57.826252755014785, 70.31110924533365, 70.25621140739045, 46.94456634427573, 67.89083149514111, 65.96519806816745], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.663524502493088, "mean_inference_ms": 7.57214366005024, "mean_action_processing_ms": 0.5424628477317818, "mean_env_wait_ms": 23.591347043223486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03260612487792969, "StateBufferConnector_ms": 0.03525280952453613, "ViewRequirementAgentConnector_ms": 0.9212086200714111}}, "episode_reward_max": 76.52382162653355, "episode_reward_min": 10.529601075604074, "episode_reward_mean": 63.06282535965381, "episode_len_mean": 1109.56, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [66.1748268068194, 68.0583246460439, 66.44836442630859, 64.37434803001825, 51.10178500754278, 58.660882778021524, 63.82658969704077, 57.245304963971755, 73.75608117251979, 10.529601075604074, 71.65784324094494, 59.506522354662735, 65.73345676561578, 50.88266657297904, 61.916987556005495, 68.1843297903473, 66.83731795825258, 65.22640334305616, 41.383302305350384, 63.37773312175207, 67.95272984115049, 60.950400904308225, 75.2650896538372, 62.364700446320555, 61.52519246473846, 57.52744185100851, 65.70912053486994, 47.15123831843607, 54.455235982179694, 68.7337403265193, 63.88163932826328, 64.00398297557564, 50.304787958758105, 61.60797691867406, 73.13889763756238, 63.947494199302334, 74.17292705835779, 69.39639733806227, 70.3411743570338, 54.65170819571621, 64.83465893272474, 53.69055121861843, 64.52483735455613, 72.06193270285155, 64.1222391297096, 64.88826261217834, 46.82882055132408, 64.05628640176113, 75.60230926972088, 59.13889530026692, 75.27449391941978, 68.07867003690917, 62.91967419159543, 70.94761511201048, 60.85960206206466, 53.18624021706012, 66.01373357250569, 76.08633983426385, 65.59144432930474, 64.09548497727155, 49.763385016012336, 46.767515295023685, 72.39185564897751, 62.16358409184436, 72.39482685698624, 67.93507921144055, 72.58273391058307, 63.83722163490569, 69.23062131226307, 51.20452817190774, 68.76356504664825, 67.45502677456929, 60.398251601992676, 64.16092454805815, 49.229667461444826, 71.53923571292108, 76.52382162653355, 65.05526397600167, 73.25448683771765, 64.14426423792061, 66.52591805883765, 62.89985366112934, 59.913660132116114, 46.61455628266419, 72.64988634528112, 67.72027505739895, 59.013413024514975, 62.42464125480143, 47.78292309734762, 62.827767325614374, 66.00242372093733, 66.51866214917675, 71.65811253396204, 70.97377540287431, 57.826252755014785, 70.31110924533365, 70.25621140739045, 46.94456634427573, 67.89083149514111, 65.96519806816745], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.663524502493088, "mean_inference_ms": 7.57214366005024, "mean_action_processing_ms": 0.5424628477317818, "mean_env_wait_ms": 23.591347043223486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03260612487792969, "StateBufferConnector_ms": 0.03525280952453613, "ViewRequirementAgentConnector_ms": 0.9212086200714111}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 797808, "num_agent_steps_trained": 797808, "num_env_steps_sampled": 797808, "num_env_steps_trained": 797808, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 231.80923904486326, "num_env_steps_trained_throughput_per_sec": 231.80923904486326, "timesteps_total": 797808, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 797808, "timers": {"training_iteration_time_ms": 68110.577, "sample_time_ms": 42812.153, "load_time_ms": 2422.355, "load_throughput": 6424.986, "learn_time_ms": 22250.397, "learn_throughput": 699.475, "synch_weights_time_ms": 490.02}, "counters": {"num_env_steps_sampled": 797808, "num_env_steps_trained": 797808, "num_agent_steps_sampled": 797808, "num_agent_steps_trained": 797808}, "done": false, "episodes_total": 828, "training_iteration": 59, "trial_id": "837cb_00000", "date": "2025-06-07_18-26-09", "timestamp": 1749313569, "time_this_iter_s": 67.4786229133606, "time_total_s": 3624.3652589321136, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3624.3652589321136, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 65.91898734177214, "ram_util_percent": 89.32025316455696, "gpu_util_percent0": 0.21569620253164556, "vram_util_percent0": 0.9650065104166671}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2.883042400204032, "episode_reward_min": -3.4683681967068334, "episode_reward_mean": -3.2588800269226916, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4683681967068334, -3.3563487410575656, -3.393074990945689, -3.1935658056993357, -2.883042400204032], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8249774536259946, "mean_inference_ms": 4.011944181956668, "mean_action_processing_ms": 0.30220545972738766, "mean_env_wait_ms": 12.758644264993665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3454303741455078}}, "episode_reward_max": -2.883042400204032, "episode_reward_min": -3.4683681967068334, "episode_reward_mean": -3.2588800269226916, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4683681967068334, -3.3563487410575656, -3.393074990945689, -3.1935658056993357, -2.883042400204032], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8249774536259946, "mean_inference_ms": 4.011944181956668, "mean_action_processing_ms": 0.30220545972738766, "mean_env_wait_ms": 12.758644264993665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3454303741455078}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.202191999999997e-05, "total_loss": -0.09233197387392549, "policy_loss": -0.007998870148873556, "vf_loss": 0.02028493623312732, "vf_explained_var": 0.9535290577194907, "kl": 0.015450132872106543, "entropy": 15.202932304035533, "entropy_coeff": 0.006010960000000002}, "model": {}, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 813446, "num_env_steps_trained": 813446, "num_agent_steps_sampled": 813446, "num_agent_steps_trained": 813446}, "sampler_results": {"episode_reward_max": 76.52382162653355, "episode_reward_min": 41.383302305350384, "episode_reward_mean": 63.60081831778618, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.916987556005495, 68.1843297903473, 66.83731795825258, 65.22640334305616, 41.383302305350384, 63.37773312175207, 67.95272984115049, 60.950400904308225, 75.2650896538372, 62.364700446320555, 61.52519246473846, 57.52744185100851, 65.70912053486994, 47.15123831843607, 54.455235982179694, 68.7337403265193, 63.88163932826328, 64.00398297557564, 50.304787958758105, 61.60797691867406, 73.13889763756238, 63.947494199302334, 74.17292705835779, 69.39639733806227, 70.3411743570338, 54.65170819571621, 64.83465893272474, 53.69055121861843, 64.52483735455613, 72.06193270285155, 64.1222391297096, 64.88826261217834, 46.82882055132408, 64.05628640176113, 75.60230926972088, 59.13889530026692, 75.27449391941978, 68.07867003690917, 62.91967419159543, 70.94761511201048, 60.85960206206466, 53.18624021706012, 66.01373357250569, 76.08633983426385, 65.59144432930474, 64.09548497727155, 49.763385016012336, 46.767515295023685, 72.39185564897751, 62.16358409184436, 72.39482685698624, 67.93507921144055, 72.58273391058307, 63.83722163490569, 69.23062131226307, 51.20452817190774, 68.76356504664825, 67.45502677456929, 60.398251601992676, 64.16092454805815, 49.229667461444826, 71.53923571292108, 76.52382162653355, 65.05526397600167, 73.25448683771765, 64.14426423792061, 66.52591805883765, 62.89985366112934, 59.913660132116114, 46.61455628266419, 72.64988634528112, 67.72027505739895, 59.013413024514975, 62.42464125480143, 47.78292309734762, 62.827767325614374, 66.00242372093733, 66.51866214917675, 71.65811253396204, 70.97377540287431, 57.826252755014785, 70.31110924533365, 70.25621140739045, 46.94456634427573, 67.89083149514111, 65.96519806816745, 63.194639570140765, 66.01959051514783, 44.080561230213306, 63.51381468992284, 69.4023421907588, 64.58892195089362, 64.65079281134201, 68.11325723096755, 64.947980963391, 62.37969131819338, 64.31080281399556, 48.936418067749436, 67.16283017168871, 70.45424982692553], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6698100878638793, "mean_inference_ms": 7.589240029128015, "mean_action_processing_ms": 0.5435448682457904, "mean_env_wait_ms": 23.618695278854084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03154611587524414, "StateBufferConnector_ms": 0.035248517990112305, "ViewRequirementAgentConnector_ms": 0.9037196636199951}}, "episode_reward_max": 76.52382162653355, "episode_reward_min": 41.383302305350384, "episode_reward_mean": 63.60081831778618, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [61.916987556005495, 68.1843297903473, 66.83731795825258, 65.22640334305616, 41.383302305350384, 63.37773312175207, 67.95272984115049, 60.950400904308225, 75.2650896538372, 62.364700446320555, 61.52519246473846, 57.52744185100851, 65.70912053486994, 47.15123831843607, 54.455235982179694, 68.7337403265193, 63.88163932826328, 64.00398297557564, 50.304787958758105, 61.60797691867406, 73.13889763756238, 63.947494199302334, 74.17292705835779, 69.39639733806227, 70.3411743570338, 54.65170819571621, 64.83465893272474, 53.69055121861843, 64.52483735455613, 72.06193270285155, 64.1222391297096, 64.88826261217834, 46.82882055132408, 64.05628640176113, 75.60230926972088, 59.13889530026692, 75.27449391941978, 68.07867003690917, 62.91967419159543, 70.94761511201048, 60.85960206206466, 53.18624021706012, 66.01373357250569, 76.08633983426385, 65.59144432930474, 64.09548497727155, 49.763385016012336, 46.767515295023685, 72.39185564897751, 62.16358409184436, 72.39482685698624, 67.93507921144055, 72.58273391058307, 63.83722163490569, 69.23062131226307, 51.20452817190774, 68.76356504664825, 67.45502677456929, 60.398251601992676, 64.16092454805815, 49.229667461444826, 71.53923571292108, 76.52382162653355, 65.05526397600167, 73.25448683771765, 64.14426423792061, 66.52591805883765, 62.89985366112934, 59.913660132116114, 46.61455628266419, 72.64988634528112, 67.72027505739895, 59.013413024514975, 62.42464125480143, 47.78292309734762, 62.827767325614374, 66.00242372093733, 66.51866214917675, 71.65811253396204, 70.97377540287431, 57.826252755014785, 70.31110924533365, 70.25621140739045, 46.94456634427573, 67.89083149514111, 65.96519806816745, 63.194639570140765, 66.01959051514783, 44.080561230213306, 63.51381468992284, 69.4023421907588, 64.58892195089362, 64.65079281134201, 68.11325723096755, 64.947980963391, 62.37969131819338, 64.31080281399556, 48.936418067749436, 67.16283017168871, 70.45424982692553], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6698100878638793, "mean_inference_ms": 7.589240029128015, "mean_action_processing_ms": 0.5435448682457904, "mean_env_wait_ms": 23.618695278854084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03154611587524414, "StateBufferConnector_ms": 0.035248517990112305, "ViewRequirementAgentConnector_ms": 0.9037196636199951}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 813446, "num_agent_steps_trained": 813446, "num_env_steps_sampled": 813446, "num_env_steps_trained": 813446, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 225.1539338292209, "num_env_steps_trained_throughput_per_sec": 225.1539338292209, "timesteps_total": 813446, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 813446, "timers": {"training_iteration_time_ms": 68255.29, "sample_time_ms": 42921.719, "load_time_ms": 2426.987, "load_throughput": 6412.726, "learn_time_ms": 22277.859, "learn_throughput": 698.613, "synch_weights_time_ms": 491.523}, "counters": {"num_env_steps_sampled": 813446, "num_env_steps_trained": 813446, "num_agent_steps_sampled": 813446, "num_agent_steps_trained": 813446}, "done": false, "episodes_total": 842, "training_iteration": 60, "trial_id": "837cb_00000", "date": "2025-06-07_18-27-37", "timestamp": 1749313657, "time_this_iter_s": 87.80598187446594, "time_total_s": 3712.1712408065796, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3712.1712408065796, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 57.2864077669903, "ram_util_percent": 88.52621359223298, "gpu_util_percent0": 0.16757281553398057, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.186554e-05, "total_loss": -0.09312035614455288, "policy_loss": -0.009363786296506244, "vf_loss": 0.0189737795335664, "vf_explained_var": 0.9510426754301244, "kl": 0.01563167413866131, "entropy": 15.241730109128085, "entropy_coeff": 0.00593277}, "model": {}, "num_grad_updates_lifetime": 28915.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 829084, "num_env_steps_trained": 829084, "num_agent_steps_sampled": 829084, "num_agent_steps_trained": 829084}, "sampler_results": {"episode_reward_max": 76.52382162653355, "episode_reward_min": 44.080561230213306, "episode_reward_mean": 63.80806275664538, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.455235982179694, 68.7337403265193, 63.88163932826328, 64.00398297557564, 50.304787958758105, 61.60797691867406, 73.13889763756238, 63.947494199302334, 74.17292705835779, 69.39639733806227, 70.3411743570338, 54.65170819571621, 64.83465893272474, 53.69055121861843, 64.52483735455613, 72.06193270285155, 64.1222391297096, 64.88826261217834, 46.82882055132408, 64.05628640176113, 75.60230926972088, 59.13889530026692, 75.27449391941978, 68.07867003690917, 62.91967419159543, 70.94761511201048, 60.85960206206466, 53.18624021706012, 66.01373357250569, 76.08633983426385, 65.59144432930474, 64.09548497727155, 49.763385016012336, 46.767515295023685, 72.39185564897751, 62.16358409184436, 72.39482685698624, 67.93507921144055, 72.58273391058307, 63.83722163490569, 69.23062131226307, 51.20452817190774, 68.76356504664825, 67.45502677456929, 60.398251601992676, 64.16092454805815, 49.229667461444826, 71.53923571292108, 76.52382162653355, 65.05526397600167, 73.25448683771765, 64.14426423792061, 66.52591805883765, 62.89985366112934, 59.913660132116114, 46.61455628266419, 72.64988634528112, 67.72027505739895, 59.013413024514975, 62.42464125480143, 47.78292309734762, 62.827767325614374, 66.00242372093733, 66.51866214917675, 71.65811253396204, 70.97377540287431, 57.826252755014785, 70.31110924533365, 70.25621140739045, 46.94456634427573, 67.89083149514111, 65.96519806816745, 63.194639570140765, 66.01959051514783, 44.080561230213306, 63.51381468992284, 69.4023421907588, 64.58892195089362, 64.65079281134201, 68.11325723096755, 64.947980963391, 62.37969131819338, 64.31080281399556, 48.936418067749436, 67.16283017168871, 70.45424982692553, 61.052848738965814, 62.719982809780994, 49.81885725340774, 56.00577747140551, 61.95001848185684, 64.48854904031207, 74.44552082720098, 67.62514380320081, 67.72258117911767, 68.6325031501495, 69.50152273934269, 49.70834497947473, 66.23690843997984, 66.18787306115924], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.67618176064125, "mean_inference_ms": 7.6073206348047755, "mean_action_processing_ms": 0.5446795046821817, "mean_env_wait_ms": 23.646544433676823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03450512886047363, "StateBufferConnector_ms": 0.03624415397644043, "ViewRequirementAgentConnector_ms": 0.9201328754425049}}, "episode_reward_max": 76.52382162653355, "episode_reward_min": 44.080561230213306, "episode_reward_mean": 63.80806275664538, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.455235982179694, 68.7337403265193, 63.88163932826328, 64.00398297557564, 50.304787958758105, 61.60797691867406, 73.13889763756238, 63.947494199302334, 74.17292705835779, 69.39639733806227, 70.3411743570338, 54.65170819571621, 64.83465893272474, 53.69055121861843, 64.52483735455613, 72.06193270285155, 64.1222391297096, 64.88826261217834, 46.82882055132408, 64.05628640176113, 75.60230926972088, 59.13889530026692, 75.27449391941978, 68.07867003690917, 62.91967419159543, 70.94761511201048, 60.85960206206466, 53.18624021706012, 66.01373357250569, 76.08633983426385, 65.59144432930474, 64.09548497727155, 49.763385016012336, 46.767515295023685, 72.39185564897751, 62.16358409184436, 72.39482685698624, 67.93507921144055, 72.58273391058307, 63.83722163490569, 69.23062131226307, 51.20452817190774, 68.76356504664825, 67.45502677456929, 60.398251601992676, 64.16092454805815, 49.229667461444826, 71.53923571292108, 76.52382162653355, 65.05526397600167, 73.25448683771765, 64.14426423792061, 66.52591805883765, 62.89985366112934, 59.913660132116114, 46.61455628266419, 72.64988634528112, 67.72027505739895, 59.013413024514975, 62.42464125480143, 47.78292309734762, 62.827767325614374, 66.00242372093733, 66.51866214917675, 71.65811253396204, 70.97377540287431, 57.826252755014785, 70.31110924533365, 70.25621140739045, 46.94456634427573, 67.89083149514111, 65.96519806816745, 63.194639570140765, 66.01959051514783, 44.080561230213306, 63.51381468992284, 69.4023421907588, 64.58892195089362, 64.65079281134201, 68.11325723096755, 64.947980963391, 62.37969131819338, 64.31080281399556, 48.936418067749436, 67.16283017168871, 70.45424982692553, 61.052848738965814, 62.719982809780994, 49.81885725340774, 56.00577747140551, 61.95001848185684, 64.48854904031207, 74.44552082720098, 67.62514380320081, 67.72258117911767, 68.6325031501495, 69.50152273934269, 49.70834497947473, 66.23690843997984, 66.18787306115924], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.67618176064125, "mean_inference_ms": 7.6073206348047755, "mean_action_processing_ms": 0.5446795046821817, "mean_env_wait_ms": 23.646544433676823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03450512886047363, "StateBufferConnector_ms": 0.03624415397644043, "ViewRequirementAgentConnector_ms": 0.9201328754425049}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 829084, "num_agent_steps_trained": 829084, "num_env_steps_sampled": 829084, "num_env_steps_trained": 829084, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 222.85996468735897, "num_env_steps_trained_throughput_per_sec": 222.85996468735897, "timesteps_total": 829084, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 829084, "timers": {"training_iteration_time_ms": 68471.358, "sample_time_ms": 43105.541, "load_time_ms": 2426.461, "load_throughput": 6414.115, "learn_time_ms": 22348.408, "learn_throughput": 696.408, "synch_weights_time_ms": 461.545}, "counters": {"num_env_steps_sampled": 829084, "num_env_steps_trained": 829084, "num_agent_steps_sampled": 829084, "num_agent_steps_trained": 829084}, "done": false, "episodes_total": 856, "training_iteration": 61, "trial_id": "837cb_00000", "date": "2025-06-07_18-28-47", "timestamp": 1749313727, "time_this_iter_s": 70.19461798667908, "time_total_s": 3782.3658587932587, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3782.3658587932587, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 68.18170731707316, "ram_util_percent": 89.73658536585367, "gpu_util_percent0": 0.20865853658536584, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.170916000000001e-05, "total_loss": -0.08480536996259946, "policy_loss": -0.0024070522891336374, "vf_loss": 0.02011646124280312, "vf_explained_var": 0.9505462990023873, "kl": 0.015059971961787901, "entropy": 15.265741193944757, "entropy_coeff": 0.00585458}, "model": {}, "num_grad_updates_lifetime": 29465.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 844722, "num_env_steps_trained": 844722, "num_agent_steps_sampled": 844722, "num_agent_steps_trained": 844722}, "sampler_results": {"episode_reward_max": 76.52382162653355, "episode_reward_min": 44.080561230213306, "episode_reward_mean": 63.657718911321616, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.52483735455613, 72.06193270285155, 64.1222391297096, 64.88826261217834, 46.82882055132408, 64.05628640176113, 75.60230926972088, 59.13889530026692, 75.27449391941978, 68.07867003690917, 62.91967419159543, 70.94761511201048, 60.85960206206466, 53.18624021706012, 66.01373357250569, 76.08633983426385, 65.59144432930474, 64.09548497727155, 49.763385016012336, 46.767515295023685, 72.39185564897751, 62.16358409184436, 72.39482685698624, 67.93507921144055, 72.58273391058307, 63.83722163490569, 69.23062131226307, 51.20452817190774, 68.76356504664825, 67.45502677456929, 60.398251601992676, 64.16092454805815, 49.229667461444826, 71.53923571292108, 76.52382162653355, 65.05526397600167, 73.25448683771765, 64.14426423792061, 66.52591805883765, 62.89985366112934, 59.913660132116114, 46.61455628266419, 72.64988634528112, 67.72027505739895, 59.013413024514975, 62.42464125480143, 47.78292309734762, 62.827767325614374, 66.00242372093733, 66.51866214917675, 71.65811253396204, 70.97377540287431, 57.826252755014785, 70.31110924533365, 70.25621140739045, 46.94456634427573, 67.89083149514111, 65.96519806816745, 63.194639570140765, 66.01959051514783, 44.080561230213306, 63.51381468992284, 69.4023421907588, 64.58892195089362, 64.65079281134201, 68.11325723096755, 64.947980963391, 62.37969131819338, 64.31080281399556, 48.936418067749436, 67.16283017168871, 70.45424982692553, 61.052848738965814, 62.719982809780994, 49.81885725340774, 56.00577747140551, 61.95001848185684, 64.48854904031207, 74.44552082720098, 67.62514380320081, 67.72258117911767, 68.6325031501495, 69.50152273934269, 49.70834497947473, 66.23690843997984, 66.18787306115924, 60.92738668371864, 62.17340735909899, 49.267218455103595, 61.193223191952704, 64.66037363857026, 66.38900772910624, 62.65312732439955, 70.51703350930589, 61.82675205003601, 66.796652203518, 57.24848555618195, 47.34594080454332, 69.29503777233073, 71.83314161710592], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6826462844451724, "mean_inference_ms": 7.626000660785156, "mean_action_processing_ms": 0.5458481182268881, "mean_env_wait_ms": 23.67706929034588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03255105018615723, "StateBufferConnector_ms": 0.030179500579833984, "ViewRequirementAgentConnector_ms": 0.9364867210388184}}, "episode_reward_max": 76.52382162653355, "episode_reward_min": 44.080561230213306, "episode_reward_mean": 63.657718911321616, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.52483735455613, 72.06193270285155, 64.1222391297096, 64.88826261217834, 46.82882055132408, 64.05628640176113, 75.60230926972088, 59.13889530026692, 75.27449391941978, 68.07867003690917, 62.91967419159543, 70.94761511201048, 60.85960206206466, 53.18624021706012, 66.01373357250569, 76.08633983426385, 65.59144432930474, 64.09548497727155, 49.763385016012336, 46.767515295023685, 72.39185564897751, 62.16358409184436, 72.39482685698624, 67.93507921144055, 72.58273391058307, 63.83722163490569, 69.23062131226307, 51.20452817190774, 68.76356504664825, 67.45502677456929, 60.398251601992676, 64.16092454805815, 49.229667461444826, 71.53923571292108, 76.52382162653355, 65.05526397600167, 73.25448683771765, 64.14426423792061, 66.52591805883765, 62.89985366112934, 59.913660132116114, 46.61455628266419, 72.64988634528112, 67.72027505739895, 59.013413024514975, 62.42464125480143, 47.78292309734762, 62.827767325614374, 66.00242372093733, 66.51866214917675, 71.65811253396204, 70.97377540287431, 57.826252755014785, 70.31110924533365, 70.25621140739045, 46.94456634427573, 67.89083149514111, 65.96519806816745, 63.194639570140765, 66.01959051514783, 44.080561230213306, 63.51381468992284, 69.4023421907588, 64.58892195089362, 64.65079281134201, 68.11325723096755, 64.947980963391, 62.37969131819338, 64.31080281399556, 48.936418067749436, 67.16283017168871, 70.45424982692553, 61.052848738965814, 62.719982809780994, 49.81885725340774, 56.00577747140551, 61.95001848185684, 64.48854904031207, 74.44552082720098, 67.62514380320081, 67.72258117911767, 68.6325031501495, 69.50152273934269, 49.70834497947473, 66.23690843997984, 66.18787306115924, 60.92738668371864, 62.17340735909899, 49.267218455103595, 61.193223191952704, 64.66037363857026, 66.38900772910624, 62.65312732439955, 70.51703350930589, 61.82675205003601, 66.796652203518, 57.24848555618195, 47.34594080454332, 69.29503777233073, 71.83314161710592], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6826462844451724, "mean_inference_ms": 7.626000660785156, "mean_action_processing_ms": 0.5458481182268881, "mean_env_wait_ms": 23.67706929034588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03255105018615723, "StateBufferConnector_ms": 0.030179500579833984, "ViewRequirementAgentConnector_ms": 0.9364867210388184}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 844722, "num_agent_steps_trained": 844722, "num_env_steps_sampled": 844722, "num_env_steps_trained": 844722, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 214.70984275122893, "num_env_steps_trained_throughput_per_sec": 214.70984275122893, "timesteps_total": 844722, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 844722, "timers": {"training_iteration_time_ms": 68901.779, "sample_time_ms": 43362.004, "load_time_ms": 2568.368, "load_throughput": 6059.723, "learn_time_ms": 22377.655, "learn_throughput": 695.497, "synch_weights_time_ms": 458.792}, "counters": {"num_env_steps_sampled": 844722, "num_env_steps_trained": 844722, "num_agent_steps_sampled": 844722, "num_agent_steps_trained": 844722}, "done": false, "episodes_total": 870, "training_iteration": 62, "trial_id": "837cb_00000", "date": "2025-06-07_18-30-00", "timestamp": 1749313800, "time_this_iter_s": 72.85117363929749, "time_total_s": 3855.217032432556, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3855.217032432556, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 68.9797619047619, "ram_util_percent": 90.40595238095237, "gpu_util_percent0": 0.20476190476190478, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.155278000000001e-05, "total_loss": -0.08651950139806353, "policy_loss": -0.005250480090352622, "vf_loss": 0.021192137616136197, "vf_explained_var": 0.9472112953662872, "kl": 0.015040675531069128, "entropy": 15.332535705566407, "entropy_coeff": 0.00577639}, "model": {}, "num_grad_updates_lifetime": 30015.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 860360, "num_env_steps_trained": 860360, "num_agent_steps_sampled": 860360, "num_agent_steps_trained": 860360}, "sampler_results": {"episode_reward_max": 76.52382162653355, "episode_reward_min": 44.080561230213306, "episode_reward_mean": 63.33299424618665, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.01373357250569, 76.08633983426385, 65.59144432930474, 64.09548497727155, 49.763385016012336, 46.767515295023685, 72.39185564897751, 62.16358409184436, 72.39482685698624, 67.93507921144055, 72.58273391058307, 63.83722163490569, 69.23062131226307, 51.20452817190774, 68.76356504664825, 67.45502677456929, 60.398251601992676, 64.16092454805815, 49.229667461444826, 71.53923571292108, 76.52382162653355, 65.05526397600167, 73.25448683771765, 64.14426423792061, 66.52591805883765, 62.89985366112934, 59.913660132116114, 46.61455628266419, 72.64988634528112, 67.72027505739895, 59.013413024514975, 62.42464125480143, 47.78292309734762, 62.827767325614374, 66.00242372093733, 66.51866214917675, 71.65811253396204, 70.97377540287431, 57.826252755014785, 70.31110924533365, 70.25621140739045, 46.94456634427573, 67.89083149514111, 65.96519806816745, 63.194639570140765, 66.01959051514783, 44.080561230213306, 63.51381468992284, 69.4023421907588, 64.58892195089362, 64.65079281134201, 68.11325723096755, 64.947980963391, 62.37969131819338, 64.31080281399556, 48.936418067749436, 67.16283017168871, 70.45424982692553, 61.052848738965814, 62.719982809780994, 49.81885725340774, 56.00577747140551, 61.95001848185684, 64.48854904031207, 74.44552082720098, 67.62514380320081, 67.72258117911767, 68.6325031501495, 69.50152273934269, 49.70834497947473, 66.23690843997984, 66.18787306115924, 60.92738668371864, 62.17340735909899, 49.267218455103595, 61.193223191952704, 64.66037363857026, 66.38900772910624, 62.65312732439955, 70.51703350930589, 61.82675205003601, 66.796652203518, 57.24848555618195, 47.34594080454332, 69.29503777233073, 71.83314161710592, 65.46051716821998, 66.85329962257954, 48.57285548360999, 62.013018463320655, 72.38577400067255, 62.51790517539485, 71.6204591407884, 69.75907688739703, 56.45709578765554, 50.04216582449944, 68.5849359982843, 45.21850451954889, 63.43037643566884, 67.101427840291], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.689151959946604, "mean_inference_ms": 7.6447632593467265, "mean_action_processing_ms": 0.5470187991866511, "mean_env_wait_ms": 23.7072553118867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030689716339111328, "StateBufferConnector_ms": 0.03621172904968262, "ViewRequirementAgentConnector_ms": 0.9698331356048584}}, "episode_reward_max": 76.52382162653355, "episode_reward_min": 44.080561230213306, "episode_reward_mean": 63.33299424618665, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [66.01373357250569, 76.08633983426385, 65.59144432930474, 64.09548497727155, 49.763385016012336, 46.767515295023685, 72.39185564897751, 62.16358409184436, 72.39482685698624, 67.93507921144055, 72.58273391058307, 63.83722163490569, 69.23062131226307, 51.20452817190774, 68.76356504664825, 67.45502677456929, 60.398251601992676, 64.16092454805815, 49.229667461444826, 71.53923571292108, 76.52382162653355, 65.05526397600167, 73.25448683771765, 64.14426423792061, 66.52591805883765, 62.89985366112934, 59.913660132116114, 46.61455628266419, 72.64988634528112, 67.72027505739895, 59.013413024514975, 62.42464125480143, 47.78292309734762, 62.827767325614374, 66.00242372093733, 66.51866214917675, 71.65811253396204, 70.97377540287431, 57.826252755014785, 70.31110924533365, 70.25621140739045, 46.94456634427573, 67.89083149514111, 65.96519806816745, 63.194639570140765, 66.01959051514783, 44.080561230213306, 63.51381468992284, 69.4023421907588, 64.58892195089362, 64.65079281134201, 68.11325723096755, 64.947980963391, 62.37969131819338, 64.31080281399556, 48.936418067749436, 67.16283017168871, 70.45424982692553, 61.052848738965814, 62.719982809780994, 49.81885725340774, 56.00577747140551, 61.95001848185684, 64.48854904031207, 74.44552082720098, 67.62514380320081, 67.72258117911767, 68.6325031501495, 69.50152273934269, 49.70834497947473, 66.23690843997984, 66.18787306115924, 60.92738668371864, 62.17340735909899, 49.267218455103595, 61.193223191952704, 64.66037363857026, 66.38900772910624, 62.65312732439955, 70.51703350930589, 61.82675205003601, 66.796652203518, 57.24848555618195, 47.34594080454332, 69.29503777233073, 71.83314161710592, 65.46051716821998, 66.85329962257954, 48.57285548360999, 62.013018463320655, 72.38577400067255, 62.51790517539485, 71.6204591407884, 69.75907688739703, 56.45709578765554, 50.04216582449944, 68.5849359982843, 45.21850451954889, 63.43037643566884, 67.101427840291], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.689151959946604, "mean_inference_ms": 7.6447632593467265, "mean_action_processing_ms": 0.5470187991866511, "mean_env_wait_ms": 23.7072553118867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030689716339111328, "StateBufferConnector_ms": 0.03621172904968262, "ViewRequirementAgentConnector_ms": 0.9698331356048584}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 860360, "num_agent_steps_trained": 860360, "num_env_steps_sampled": 860360, "num_env_steps_trained": 860360, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 212.74688459920785, "num_env_steps_trained_throughput_per_sec": 212.74688459920785, "timesteps_total": 860360, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 860360, "timers": {"training_iteration_time_ms": 69804.059, "sample_time_ms": 43808.431, "load_time_ms": 2756.647, "load_throughput": 5672.833, "learn_time_ms": 22640.302, "learn_throughput": 690.715, "synch_weights_time_ms": 462.376}, "counters": {"num_env_steps_sampled": 860360, "num_env_steps_trained": 860360, "num_agent_steps_sampled": 860360, "num_agent_steps_trained": 860360}, "done": false, "episodes_total": 884, "training_iteration": 63, "trial_id": "837cb_00000", "date": "2025-06-07_18-31-14", "timestamp": 1749313874, "time_this_iter_s": 73.52772116661072, "time_total_s": 3928.744753599167, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3928.744753599167, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 70.24588235294117, "ram_util_percent": 89.86941176470587, "gpu_util_percent0": 0.20058823529411765, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.13964e-05, "total_loss": -0.10504109200217168, "policy_loss": -0.025176681580381808, "vf_loss": 0.02124266948762604, "vf_explained_var": 0.9525643424554304, "kl": 0.015423522013562351, "entropy": 15.303285841508345, "entropy_coeff": 0.0056982}, "model": {}, "num_grad_updates_lifetime": 30565.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 875998, "num_env_steps_trained": 875998, "num_agent_steps_sampled": 875998, "num_agent_steps_trained": 875998}, "sampler_results": {"episode_reward_max": 76.52382162653355, "episode_reward_min": 42.87732854553473, "episode_reward_mean": 62.828881325022465, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.76356504664825, 67.45502677456929, 60.398251601992676, 64.16092454805815, 49.229667461444826, 71.53923571292108, 76.52382162653355, 65.05526397600167, 73.25448683771765, 64.14426423792061, 66.52591805883765, 62.89985366112934, 59.913660132116114, 46.61455628266419, 72.64988634528112, 67.72027505739895, 59.013413024514975, 62.42464125480143, 47.78292309734762, 62.827767325614374, 66.00242372093733, 66.51866214917675, 71.65811253396204, 70.97377540287431, 57.826252755014785, 70.31110924533365, 70.25621140739045, 46.94456634427573, 67.89083149514111, 65.96519806816745, 63.194639570140765, 66.01959051514783, 44.080561230213306, 63.51381468992284, 69.4023421907588, 64.58892195089362, 64.65079281134201, 68.11325723096755, 64.947980963391, 62.37969131819338, 64.31080281399556, 48.936418067749436, 67.16283017168871, 70.45424982692553, 61.052848738965814, 62.719982809780994, 49.81885725340774, 56.00577747140551, 61.95001848185684, 64.48854904031207, 74.44552082720098, 67.62514380320081, 67.72258117911767, 68.6325031501495, 69.50152273934269, 49.70834497947473, 66.23690843997984, 66.18787306115924, 60.92738668371864, 62.17340735909899, 49.267218455103595, 61.193223191952704, 64.66037363857026, 66.38900772910624, 62.65312732439955, 70.51703350930589, 61.82675205003601, 66.796652203518, 57.24848555618195, 47.34594080454332, 69.29503777233073, 71.83314161710592, 65.46051716821998, 66.85329962257954, 48.57285548360999, 62.013018463320655, 72.38577400067255, 62.51790517539485, 71.6204591407884, 69.75907688739703, 56.45709578765554, 50.04216582449944, 68.5849359982843, 45.21850451954889, 63.43037643566884, 67.101427840291, 59.21375654564787, 59.14851393525029, 42.87732854553473, 66.46864015133139, 69.17592417285917, 49.96288545924215, 71.54465891010267, 62.23080284785179, 65.26699934408948, 63.30908844549555, 64.1138738280587, 47.56270097403225, 64.28073480880393, 64.49115377857326], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6950653222714553, "mean_inference_ms": 7.665658687094623, "mean_action_processing_ms": 0.5483283127461177, "mean_env_wait_ms": 23.74609859039843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03479743003845215, "StateBufferConnector_ms": 0.031105518341064453, "ViewRequirementAgentConnector_ms": 0.9780118465423584}}, "episode_reward_max": 76.52382162653355, "episode_reward_min": 42.87732854553473, "episode_reward_mean": 62.828881325022465, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [68.76356504664825, 67.45502677456929, 60.398251601992676, 64.16092454805815, 49.229667461444826, 71.53923571292108, 76.52382162653355, 65.05526397600167, 73.25448683771765, 64.14426423792061, 66.52591805883765, 62.89985366112934, 59.913660132116114, 46.61455628266419, 72.64988634528112, 67.72027505739895, 59.013413024514975, 62.42464125480143, 47.78292309734762, 62.827767325614374, 66.00242372093733, 66.51866214917675, 71.65811253396204, 70.97377540287431, 57.826252755014785, 70.31110924533365, 70.25621140739045, 46.94456634427573, 67.89083149514111, 65.96519806816745, 63.194639570140765, 66.01959051514783, 44.080561230213306, 63.51381468992284, 69.4023421907588, 64.58892195089362, 64.65079281134201, 68.11325723096755, 64.947980963391, 62.37969131819338, 64.31080281399556, 48.936418067749436, 67.16283017168871, 70.45424982692553, 61.052848738965814, 62.719982809780994, 49.81885725340774, 56.00577747140551, 61.95001848185684, 64.48854904031207, 74.44552082720098, 67.62514380320081, 67.72258117911767, 68.6325031501495, 69.50152273934269, 49.70834497947473, 66.23690843997984, 66.18787306115924, 60.92738668371864, 62.17340735909899, 49.267218455103595, 61.193223191952704, 64.66037363857026, 66.38900772910624, 62.65312732439955, 70.51703350930589, 61.82675205003601, 66.796652203518, 57.24848555618195, 47.34594080454332, 69.29503777233073, 71.83314161710592, 65.46051716821998, 66.85329962257954, 48.57285548360999, 62.013018463320655, 72.38577400067255, 62.51790517539485, 71.6204591407884, 69.75907688739703, 56.45709578765554, 50.04216582449944, 68.5849359982843, 45.21850451954889, 63.43037643566884, 67.101427840291, 59.21375654564787, 59.14851393525029, 42.87732854553473, 66.46864015133139, 69.17592417285917, 49.96288545924215, 71.54465891010267, 62.23080284785179, 65.26699934408948, 63.30908844549555, 64.1138738280587, 47.56270097403225, 64.28073480880393, 64.49115377857326], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6950653222714553, "mean_inference_ms": 7.665658687094623, "mean_action_processing_ms": 0.5483283127461177, "mean_env_wait_ms": 23.74609859039843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03479743003845215, "StateBufferConnector_ms": 0.031105518341064453, "ViewRequirementAgentConnector_ms": 0.9780118465423584}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 875998, "num_agent_steps_trained": 875998, "num_env_steps_sampled": 875998, "num_env_steps_trained": 875998, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 206.62482631596285, "num_env_steps_trained_throughput_per_sec": 206.62482631596285, "timesteps_total": 875998, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 875998, "timers": {"training_iteration_time_ms": 70421.262, "sample_time_ms": 44526.546, "load_time_ms": 2682.211, "load_throughput": 5830.264, "learn_time_ms": 22618.029, "learn_throughput": 691.395, "synch_weights_time_ms": 462.435}, "counters": {"num_env_steps_sampled": 875998, "num_env_steps_trained": 875998, "num_agent_steps_sampled": 875998, "num_agent_steps_trained": 875998}, "done": false, "episodes_total": 898, "training_iteration": 64, "trial_id": "837cb_00000", "date": "2025-06-07_18-32-30", "timestamp": 1749313950, "time_this_iter_s": 75.70205163955688, "time_total_s": 4004.4468052387238, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4004.4468052387238, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 72.0305882352941, "ram_util_percent": 89.56823529411766, "gpu_util_percent0": 0.19929411764705884, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.124002e-05, "total_loss": -0.09174134470532987, "policy_loss": -0.013480678117114373, "vf_loss": 0.022680550939826804, "vf_explained_var": 0.9580407430908897, "kl": 0.015562553127530996, "entropy": 15.309133732535622, "entropy_coeff": 0.005620010000000001}, "model": {}, "num_grad_updates_lifetime": 31115.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 891636, "num_env_steps_trained": 891636, "num_agent_steps_sampled": 891636, "num_agent_steps_trained": 891636}, "sampler_results": {"episode_reward_max": 76.22498564558533, "episode_reward_min": 42.87732854553473, "episode_reward_mean": 62.36366824146778, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.64988634528112, 67.72027505739895, 59.013413024514975, 62.42464125480143, 47.78292309734762, 62.827767325614374, 66.00242372093733, 66.51866214917675, 71.65811253396204, 70.97377540287431, 57.826252755014785, 70.31110924533365, 70.25621140739045, 46.94456634427573, 67.89083149514111, 65.96519806816745, 63.194639570140765, 66.01959051514783, 44.080561230213306, 63.51381468992284, 69.4023421907588, 64.58892195089362, 64.65079281134201, 68.11325723096755, 64.947980963391, 62.37969131819338, 64.31080281399556, 48.936418067749436, 67.16283017168871, 70.45424982692553, 61.052848738965814, 62.719982809780994, 49.81885725340774, 56.00577747140551, 61.95001848185684, 64.48854904031207, 74.44552082720098, 67.62514380320081, 67.72258117911767, 68.6325031501495, 69.50152273934269, 49.70834497947473, 66.23690843997984, 66.18787306115924, 60.92738668371864, 62.17340735909899, 49.267218455103595, 61.193223191952704, 64.66037363857026, 66.38900772910624, 62.65312732439955, 70.51703350930589, 61.82675205003601, 66.796652203518, 57.24848555618195, 47.34594080454332, 69.29503777233073, 71.83314161710592, 65.46051716821998, 66.85329962257954, 48.57285548360999, 62.013018463320655, 72.38577400067255, 62.51790517539485, 71.6204591407884, 69.75907688739703, 56.45709578765554, 50.04216582449944, 68.5849359982843, 45.21850451954889, 63.43037643566884, 67.101427840291, 59.21375654564787, 59.14851393525029, 42.87732854553473, 66.46864015133139, 69.17592417285917, 49.96288545924215, 71.54465891010267, 62.23080284785179, 65.26699934408948, 63.30908844549555, 64.1138738280587, 47.56270097403225, 64.28073480880393, 64.49115377857326, 63.5370545819157, 61.600767736430974, 49.08461572665242, 65.1559865041475, 65.9523277707477, 55.51285732395763, 61.847195294901276, 68.62135850539818, 64.54036989521663, 62.1588224375075, 62.16107497371306, 48.64933390435512, 44.91043730255487, 76.22498564558533], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.70064411363181, "mean_inference_ms": 7.688521493473044, "mean_action_processing_ms": 0.5498200168919293, "mean_env_wait_ms": 23.78850827796281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03479766845703125, "StateBufferConnector_ms": 0.0390782356262207, "ViewRequirementAgentConnector_ms": 1.033649206161499}}, "episode_reward_max": 76.22498564558533, "episode_reward_min": 42.87732854553473, "episode_reward_mean": 62.36366824146778, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [72.64988634528112, 67.72027505739895, 59.013413024514975, 62.42464125480143, 47.78292309734762, 62.827767325614374, 66.00242372093733, 66.51866214917675, 71.65811253396204, 70.97377540287431, 57.826252755014785, 70.31110924533365, 70.25621140739045, 46.94456634427573, 67.89083149514111, 65.96519806816745, 63.194639570140765, 66.01959051514783, 44.080561230213306, 63.51381468992284, 69.4023421907588, 64.58892195089362, 64.65079281134201, 68.11325723096755, 64.947980963391, 62.37969131819338, 64.31080281399556, 48.936418067749436, 67.16283017168871, 70.45424982692553, 61.052848738965814, 62.719982809780994, 49.81885725340774, 56.00577747140551, 61.95001848185684, 64.48854904031207, 74.44552082720098, 67.62514380320081, 67.72258117911767, 68.6325031501495, 69.50152273934269, 49.70834497947473, 66.23690843997984, 66.18787306115924, 60.92738668371864, 62.17340735909899, 49.267218455103595, 61.193223191952704, 64.66037363857026, 66.38900772910624, 62.65312732439955, 70.51703350930589, 61.82675205003601, 66.796652203518, 57.24848555618195, 47.34594080454332, 69.29503777233073, 71.83314161710592, 65.46051716821998, 66.85329962257954, 48.57285548360999, 62.013018463320655, 72.38577400067255, 62.51790517539485, 71.6204591407884, 69.75907688739703, 56.45709578765554, 50.04216582449944, 68.5849359982843, 45.21850451954889, 63.43037643566884, 67.101427840291, 59.21375654564787, 59.14851393525029, 42.87732854553473, 66.46864015133139, 69.17592417285917, 49.96288545924215, 71.54465891010267, 62.23080284785179, 65.26699934408948, 63.30908844549555, 64.1138738280587, 47.56270097403225, 64.28073480880393, 64.49115377857326, 63.5370545819157, 61.600767736430974, 49.08461572665242, 65.1559865041475, 65.9523277707477, 55.51285732395763, 61.847195294901276, 68.62135850539818, 64.54036989521663, 62.1588224375075, 62.16107497371306, 48.64933390435512, 44.91043730255487, 76.22498564558533], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.70064411363181, "mean_inference_ms": 7.688521493473044, "mean_action_processing_ms": 0.5498200168919293, "mean_env_wait_ms": 23.78850827796281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03479766845703125, "StateBufferConnector_ms": 0.0390782356262207, "ViewRequirementAgentConnector_ms": 1.033649206161499}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 891636, "num_agent_steps_trained": 891636, "num_env_steps_sampled": 891636, "num_env_steps_trained": 891636, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 204.22553075653866, "num_env_steps_trained_throughput_per_sec": 204.22553075653866, "timesteps_total": 891636, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 891636, "timers": {"training_iteration_time_ms": 71165.723, "sample_time_ms": 44863.079, "load_time_ms": 2797.933, "load_throughput": 5589.127, "learn_time_ms": 22890.674, "learn_throughput": 683.16, "synch_weights_time_ms": 477.445}, "counters": {"num_env_steps_sampled": 891636, "num_env_steps_trained": 891636, "num_agent_steps_sampled": 891636, "num_agent_steps_trained": 891636}, "done": false, "episodes_total": 912, "training_iteration": 65, "trial_id": "837cb_00000", "date": "2025-06-07_18-33-46", "timestamp": 1749314026, "time_this_iter_s": 76.60136103630066, "time_total_s": 4081.0481662750244, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4081.0481662750244, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 73.45795454545454, "ram_util_percent": 90.44545454545455, "gpu_util_percent0": 0.1884090909090909, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.108363999999999e-05, "total_loss": -0.11561588867662728, "policy_loss": -0.03713450794786199, "vf_loss": 0.018182876447681337, "vf_explained_var": 0.9544732429764488, "kl": 0.015127163206398845, "entropy": 15.316573307730934, "entropy_coeff": 0.005541820000000001}, "model": {}, "num_grad_updates_lifetime": 31665.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 907274, "num_env_steps_trained": 907274, "num_agent_steps_sampled": 907274, "num_agent_steps_trained": 907274}, "sampler_results": {"episode_reward_max": 76.22498564558533, "episode_reward_min": 42.87732854553473, "episode_reward_mean": 62.14598747406425, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.89083149514111, 65.96519806816745, 63.194639570140765, 66.01959051514783, 44.080561230213306, 63.51381468992284, 69.4023421907588, 64.58892195089362, 64.65079281134201, 68.11325723096755, 64.947980963391, 62.37969131819338, 64.31080281399556, 48.936418067749436, 67.16283017168871, 70.45424982692553, 61.052848738965814, 62.719982809780994, 49.81885725340774, 56.00577747140551, 61.95001848185684, 64.48854904031207, 74.44552082720098, 67.62514380320081, 67.72258117911767, 68.6325031501495, 69.50152273934269, 49.70834497947473, 66.23690843997984, 66.18787306115924, 60.92738668371864, 62.17340735909899, 49.267218455103595, 61.193223191952704, 64.66037363857026, 66.38900772910624, 62.65312732439955, 70.51703350930589, 61.82675205003601, 66.796652203518, 57.24848555618195, 47.34594080454332, 69.29503777233073, 71.83314161710592, 65.46051716821998, 66.85329962257954, 48.57285548360999, 62.013018463320655, 72.38577400067255, 62.51790517539485, 71.6204591407884, 69.75907688739703, 56.45709578765554, 50.04216582449944, 68.5849359982843, 45.21850451954889, 63.43037643566884, 67.101427840291, 59.21375654564787, 59.14851393525029, 42.87732854553473, 66.46864015133139, 69.17592417285917, 49.96288545924215, 71.54465891010267, 62.23080284785179, 65.26699934408948, 63.30908844549555, 64.1138738280587, 47.56270097403225, 64.28073480880393, 64.49115377857326, 63.5370545819157, 61.600767736430974, 49.08461572665242, 65.1559865041475, 65.9523277707477, 55.51285732395763, 61.847195294901276, 68.62135850539818, 64.54036989521663, 62.1588224375075, 62.16107497371306, 48.64933390435512, 44.91043730255487, 76.22498564558533, 60.42061608374012, 66.67647342566767, 52.12362208357631, 64.95640203472281, 73.20544199694857, 57.374224450171305, 70.15596671853125, 60.6680437889264, 65.08722466040871, 62.82894616015773, 60.458423611073236, 51.02044423230251, 59.96007379111853, 66.20603988622553], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7062966511126687, "mean_inference_ms": 7.717317069458979, "mean_action_processing_ms": 0.5516562122309039, "mean_env_wait_ms": 23.842024188214378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03338766098022461, "StateBufferConnector_ms": 0.050750017166137695, "ViewRequirementAgentConnector_ms": 1.0577986240386963}}, "episode_reward_max": 76.22498564558533, "episode_reward_min": 42.87732854553473, "episode_reward_mean": 62.14598747406425, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [67.89083149514111, 65.96519806816745, 63.194639570140765, 66.01959051514783, 44.080561230213306, 63.51381468992284, 69.4023421907588, 64.58892195089362, 64.65079281134201, 68.11325723096755, 64.947980963391, 62.37969131819338, 64.31080281399556, 48.936418067749436, 67.16283017168871, 70.45424982692553, 61.052848738965814, 62.719982809780994, 49.81885725340774, 56.00577747140551, 61.95001848185684, 64.48854904031207, 74.44552082720098, 67.62514380320081, 67.72258117911767, 68.6325031501495, 69.50152273934269, 49.70834497947473, 66.23690843997984, 66.18787306115924, 60.92738668371864, 62.17340735909899, 49.267218455103595, 61.193223191952704, 64.66037363857026, 66.38900772910624, 62.65312732439955, 70.51703350930589, 61.82675205003601, 66.796652203518, 57.24848555618195, 47.34594080454332, 69.29503777233073, 71.83314161710592, 65.46051716821998, 66.85329962257954, 48.57285548360999, 62.013018463320655, 72.38577400067255, 62.51790517539485, 71.6204591407884, 69.75907688739703, 56.45709578765554, 50.04216582449944, 68.5849359982843, 45.21850451954889, 63.43037643566884, 67.101427840291, 59.21375654564787, 59.14851393525029, 42.87732854553473, 66.46864015133139, 69.17592417285917, 49.96288545924215, 71.54465891010267, 62.23080284785179, 65.26699934408948, 63.30908844549555, 64.1138738280587, 47.56270097403225, 64.28073480880393, 64.49115377857326, 63.5370545819157, 61.600767736430974, 49.08461572665242, 65.1559865041475, 65.9523277707477, 55.51285732395763, 61.847195294901276, 68.62135850539818, 64.54036989521663, 62.1588224375075, 62.16107497371306, 48.64933390435512, 44.91043730255487, 76.22498564558533, 60.42061608374012, 66.67647342566767, 52.12362208357631, 64.95640203472281, 73.20544199694857, 57.374224450171305, 70.15596671853125, 60.6680437889264, 65.08722466040871, 62.82894616015773, 60.458423611073236, 51.02044423230251, 59.96007379111853, 66.20603988622553], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7062966511126687, "mean_inference_ms": 7.717317069458979, "mean_action_processing_ms": 0.5516562122309039, "mean_env_wait_ms": 23.842024188214378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03338766098022461, "StateBufferConnector_ms": 0.050750017166137695, "ViewRequirementAgentConnector_ms": 1.0577986240386963}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 907274, "num_agent_steps_trained": 907274, "num_env_steps_sampled": 907274, "num_env_steps_trained": 907274, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 198.56570037078723, "num_env_steps_trained_throughput_per_sec": 198.56570037078723, "timesteps_total": 907274, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 907274, "timers": {"training_iteration_time_ms": 72166.007, "sample_time_ms": 45668.622, "load_time_ms": 2890.244, "load_throughput": 5410.617, "learn_time_ms": 22982.741, "learn_throughput": 680.424, "synch_weights_time_ms": 485.545}, "counters": {"num_env_steps_sampled": 907274, "num_env_steps_trained": 907274, "num_agent_steps_sampled": 907274, "num_agent_steps_trained": 907274}, "done": false, "episodes_total": 926, "training_iteration": 66, "trial_id": "837cb_00000", "date": "2025-06-07_18-35-05", "timestamp": 1749314105, "time_this_iter_s": 78.76980018615723, "time_total_s": 4159.817966461182, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4159.817966461182, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 73.1511111111111, "ram_util_percent": 91.17222222222222, "gpu_util_percent0": 0.19222222222222224, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.092726000000001e-05, "total_loss": -0.1115747044805903, "policy_loss": -0.034448804856616666, "vf_loss": 0.018833434982225297, "vf_explained_var": 0.9569879131967371, "kl": 0.01599559239299955, "entropy": 15.333333325819536, "entropy_coeff": 0.005463629999999999}, "model": {}, "num_grad_updates_lifetime": 32215.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 922912, "num_env_steps_trained": 922912, "num_agent_steps_sampled": 922912, "num_agent_steps_trained": 922912}, "sampler_results": {"episode_reward_max": 76.22498564558533, "episode_reward_min": 42.87732854553473, "episode_reward_mean": 61.91308938835044, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.16283017168871, 70.45424982692553, 61.052848738965814, 62.719982809780994, 49.81885725340774, 56.00577747140551, 61.95001848185684, 64.48854904031207, 74.44552082720098, 67.62514380320081, 67.72258117911767, 68.6325031501495, 69.50152273934269, 49.70834497947473, 66.23690843997984, 66.18787306115924, 60.92738668371864, 62.17340735909899, 49.267218455103595, 61.193223191952704, 64.66037363857026, 66.38900772910624, 62.65312732439955, 70.51703350930589, 61.82675205003601, 66.796652203518, 57.24848555618195, 47.34594080454332, 69.29503777233073, 71.83314161710592, 65.46051716821998, 66.85329962257954, 48.57285548360999, 62.013018463320655, 72.38577400067255, 62.51790517539485, 71.6204591407884, 69.75907688739703, 56.45709578765554, 50.04216582449944, 68.5849359982843, 45.21850451954889, 63.43037643566884, 67.101427840291, 59.21375654564787, 59.14851393525029, 42.87732854553473, 66.46864015133139, 69.17592417285917, 49.96288545924215, 71.54465891010267, 62.23080284785179, 65.26699934408948, 63.30908844549555, 64.1138738280587, 47.56270097403225, 64.28073480880393, 64.49115377857326, 63.5370545819157, 61.600767736430974, 49.08461572665242, 65.1559865041475, 65.9523277707477, 55.51285732395763, 61.847195294901276, 68.62135850539818, 64.54036989521663, 62.1588224375075, 62.16107497371306, 48.64933390435512, 44.91043730255487, 76.22498564558533, 60.42061608374012, 66.67647342566767, 52.12362208357631, 64.95640203472281, 73.20544199694857, 57.374224450171305, 70.15596671853125, 60.6680437889264, 65.08722466040871, 62.82894616015773, 60.458423611073236, 51.02044423230251, 59.96007379111853, 66.20603988622553, 56.19063423283808, 64.96766122323588, 46.74983449932145, 66.96911902387642, 59.33861184737856, 61.170545433988785, 65.74859458090211, 67.22168132391192, 60.975593872329604, 61.5889928756418, 71.98616005465831, 53.09235996935204, 59.77390866402671, 58.93133674318318], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.711499622951599, "mean_inference_ms": 7.74713857349132, "mean_action_processing_ms": 0.5535520741746948, "mean_env_wait_ms": 23.89707055698281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03637385368347168, "StateBufferConnector_ms": 0.04777693748474121, "ViewRequirementAgentConnector_ms": 1.057732343673706}}, "episode_reward_max": 76.22498564558533, "episode_reward_min": 42.87732854553473, "episode_reward_mean": 61.91308938835044, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [67.16283017168871, 70.45424982692553, 61.052848738965814, 62.719982809780994, 49.81885725340774, 56.00577747140551, 61.95001848185684, 64.48854904031207, 74.44552082720098, 67.62514380320081, 67.72258117911767, 68.6325031501495, 69.50152273934269, 49.70834497947473, 66.23690843997984, 66.18787306115924, 60.92738668371864, 62.17340735909899, 49.267218455103595, 61.193223191952704, 64.66037363857026, 66.38900772910624, 62.65312732439955, 70.51703350930589, 61.82675205003601, 66.796652203518, 57.24848555618195, 47.34594080454332, 69.29503777233073, 71.83314161710592, 65.46051716821998, 66.85329962257954, 48.57285548360999, 62.013018463320655, 72.38577400067255, 62.51790517539485, 71.6204591407884, 69.75907688739703, 56.45709578765554, 50.04216582449944, 68.5849359982843, 45.21850451954889, 63.43037643566884, 67.101427840291, 59.21375654564787, 59.14851393525029, 42.87732854553473, 66.46864015133139, 69.17592417285917, 49.96288545924215, 71.54465891010267, 62.23080284785179, 65.26699934408948, 63.30908844549555, 64.1138738280587, 47.56270097403225, 64.28073480880393, 64.49115377857326, 63.5370545819157, 61.600767736430974, 49.08461572665242, 65.1559865041475, 65.9523277707477, 55.51285732395763, 61.847195294901276, 68.62135850539818, 64.54036989521663, 62.1588224375075, 62.16107497371306, 48.64933390435512, 44.91043730255487, 76.22498564558533, 60.42061608374012, 66.67647342566767, 52.12362208357631, 64.95640203472281, 73.20544199694857, 57.374224450171305, 70.15596671853125, 60.6680437889264, 65.08722466040871, 62.82894616015773, 60.458423611073236, 51.02044423230251, 59.96007379111853, 66.20603988622553, 56.19063423283808, 64.96766122323588, 46.74983449932145, 66.96911902387642, 59.33861184737856, 61.170545433988785, 65.74859458090211, 67.22168132391192, 60.975593872329604, 61.5889928756418, 71.98616005465831, 53.09235996935204, 59.77390866402671, 58.93133674318318], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.711499622951599, "mean_inference_ms": 7.74713857349132, "mean_action_processing_ms": 0.5535520741746948, "mean_env_wait_ms": 23.89707055698281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03637385368347168, "StateBufferConnector_ms": 0.04777693748474121, "ViewRequirementAgentConnector_ms": 1.057732343673706}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 922912, "num_agent_steps_trained": 922912, "num_env_steps_sampled": 922912, "num_env_steps_trained": 922912, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 204.88510441289458, "num_env_steps_trained_throughput_per_sec": 204.88510441289458, "timesteps_total": 922912, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 922912, "timers": {"training_iteration_time_ms": 72983.73, "sample_time_ms": 46022.716, "load_time_ms": 3163.214, "load_throughput": 4943.706, "learn_time_ms": 23157.456, "learn_throughput": 675.29, "synch_weights_time_ms": 488.777}, "counters": {"num_env_steps_sampled": 922912, "num_env_steps_trained": 922912, "num_agent_steps_sampled": 922912, "num_agent_steps_trained": 922912}, "done": false, "episodes_total": 940, "training_iteration": 67, "trial_id": "837cb_00000", "date": "2025-06-07_18-36-22", "timestamp": 1749314182, "time_this_iter_s": 76.34368658065796, "time_total_s": 4236.16165304184, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4236.16165304184, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 69.06590909090909, "ram_util_percent": 90.93068181818181, "gpu_util_percent0": 0.20011363636363635, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.077088000000001e-05, "total_loss": -0.11057745455764234, "policy_loss": -0.034188400855319656, "vf_loss": 0.01741587872743945, "vf_explained_var": 0.9504320184750991, "kl": 0.015956595820926973, "entropy": 15.339713916778564, "entropy_coeff": 0.005385439999999999}, "model": {}, "num_grad_updates_lifetime": 32765.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 938550, "num_env_steps_trained": 938550, "num_agent_steps_sampled": 938550, "num_agent_steps_trained": 938550}, "sampler_results": {"episode_reward_max": 76.22498564558533, "episode_reward_min": 42.87732854553473, "episode_reward_mean": 61.892601080372835, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.23690843997984, 66.18787306115924, 60.92738668371864, 62.17340735909899, 49.267218455103595, 61.193223191952704, 64.66037363857026, 66.38900772910624, 62.65312732439955, 70.51703350930589, 61.82675205003601, 66.796652203518, 57.24848555618195, 47.34594080454332, 69.29503777233073, 71.83314161710592, 65.46051716821998, 66.85329962257954, 48.57285548360999, 62.013018463320655, 72.38577400067255, 62.51790517539485, 71.6204591407884, 69.75907688739703, 56.45709578765554, 50.04216582449944, 68.5849359982843, 45.21850451954889, 63.43037643566884, 67.101427840291, 59.21375654564787, 59.14851393525029, 42.87732854553473, 66.46864015133139, 69.17592417285917, 49.96288545924215, 71.54465891010267, 62.23080284785179, 65.26699934408948, 63.30908844549555, 64.1138738280587, 47.56270097403225, 64.28073480880393, 64.49115377857326, 63.5370545819157, 61.600767736430974, 49.08461572665242, 65.1559865041475, 65.9523277707477, 55.51285732395763, 61.847195294901276, 68.62135850539818, 64.54036989521663, 62.1588224375075, 62.16107497371306, 48.64933390435512, 44.91043730255487, 76.22498564558533, 60.42061608374012, 66.67647342566767, 52.12362208357631, 64.95640203472281, 73.20544199694857, 57.374224450171305, 70.15596671853125, 60.6680437889264, 65.08722466040871, 62.82894616015773, 60.458423611073236, 51.02044423230251, 59.96007379111853, 66.20603988622553, 56.19063423283808, 64.96766122323588, 46.74983449932145, 66.96911902387642, 59.33861184737856, 61.170545433988785, 65.74859458090211, 67.22168132391192, 60.975593872329604, 61.5889928756418, 71.98616005465831, 53.09235996935204, 59.77390866402671, 58.93133674318318, 63.29707197013845, 59.59623065482168, 51.021189549888284, 63.37529760788276, 74.23212727057522, 64.38517408827292, 69.72507534807089, 64.7248574559354, 67.92324338155716, 64.05164888146948, 68.39334618085276, 47.45195018498302, 63.992572764546956, 67.07011433607346], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7156607603636793, "mean_inference_ms": 7.775940764245904, "mean_action_processing_ms": 0.5553825609401009, "mean_env_wait_ms": 23.95120123526887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04175138473510742, "StateBufferConnector_ms": 0.047918081283569336, "ViewRequirementAgentConnector_ms": 1.0529801845550537}}, "episode_reward_max": 76.22498564558533, "episode_reward_min": 42.87732854553473, "episode_reward_mean": 61.892601080372835, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [66.23690843997984, 66.18787306115924, 60.92738668371864, 62.17340735909899, 49.267218455103595, 61.193223191952704, 64.66037363857026, 66.38900772910624, 62.65312732439955, 70.51703350930589, 61.82675205003601, 66.796652203518, 57.24848555618195, 47.34594080454332, 69.29503777233073, 71.83314161710592, 65.46051716821998, 66.85329962257954, 48.57285548360999, 62.013018463320655, 72.38577400067255, 62.51790517539485, 71.6204591407884, 69.75907688739703, 56.45709578765554, 50.04216582449944, 68.5849359982843, 45.21850451954889, 63.43037643566884, 67.101427840291, 59.21375654564787, 59.14851393525029, 42.87732854553473, 66.46864015133139, 69.17592417285917, 49.96288545924215, 71.54465891010267, 62.23080284785179, 65.26699934408948, 63.30908844549555, 64.1138738280587, 47.56270097403225, 64.28073480880393, 64.49115377857326, 63.5370545819157, 61.600767736430974, 49.08461572665242, 65.1559865041475, 65.9523277707477, 55.51285732395763, 61.847195294901276, 68.62135850539818, 64.54036989521663, 62.1588224375075, 62.16107497371306, 48.64933390435512, 44.91043730255487, 76.22498564558533, 60.42061608374012, 66.67647342566767, 52.12362208357631, 64.95640203472281, 73.20544199694857, 57.374224450171305, 70.15596671853125, 60.6680437889264, 65.08722466040871, 62.82894616015773, 60.458423611073236, 51.02044423230251, 59.96007379111853, 66.20603988622553, 56.19063423283808, 64.96766122323588, 46.74983449932145, 66.96911902387642, 59.33861184737856, 61.170545433988785, 65.74859458090211, 67.22168132391192, 60.975593872329604, 61.5889928756418, 71.98616005465831, 53.09235996935204, 59.77390866402671, 58.93133674318318, 63.29707197013845, 59.59623065482168, 51.021189549888284, 63.37529760788276, 74.23212727057522, 64.38517408827292, 69.72507534807089, 64.7248574559354, 67.92324338155716, 64.05164888146948, 68.39334618085276, 47.45195018498302, 63.992572764546956, 67.07011433607346], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7156607603636793, "mean_inference_ms": 7.775940764245904, "mean_action_processing_ms": 0.5553825609401009, "mean_env_wait_ms": 23.95120123526887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04175138473510742, "StateBufferConnector_ms": 0.047918081283569336, "ViewRequirementAgentConnector_ms": 1.0529801845550537}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 938550, "num_agent_steps_trained": 938550, "num_env_steps_sampled": 938550, "num_env_steps_trained": 938550, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 223.23973798569884, "num_env_steps_trained_throughput_per_sec": 223.23973798569884, "timesteps_total": 938550, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 938550, "timers": {"training_iteration_time_ms": 73080.834, "sample_time_ms": 46137.507, "load_time_ms": 3138.114, "load_throughput": 4983.248, "learn_time_ms": 23161.461, "learn_throughput": 675.173, "synch_weights_time_ms": 495.437}, "counters": {"num_env_steps_sampled": 938550, "num_env_steps_trained": 938550, "num_agent_steps_sampled": 938550, "num_agent_steps_trained": 938550}, "done": false, "episodes_total": 954, "training_iteration": 68, "trial_id": "837cb_00000", "date": "2025-06-07_18-37-32", "timestamp": 1749314252, "time_this_iter_s": 70.0722508430481, "time_total_s": 4306.233903884888, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4306.233903884888, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 66.64146341463415, "ram_util_percent": 88.2560975609756, "gpu_util_percent0": 0.2069512195121951, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.061450000000002e-05, "total_loss": -0.09352571687766943, "policy_loss": -0.01869488471293483, "vf_loss": 0.01811301408504898, "vf_explained_var": 0.9522183173353022, "kl": 0.016573691676923255, "entropy": 15.318779140819203, "entropy_coeff": 0.00530725}, "model": {}, "num_grad_updates_lifetime": 33315.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 954188, "num_env_steps_trained": 954188, "num_agent_steps_sampled": 954188, "num_agent_steps_trained": 954188}, "sampler_results": {"episode_reward_max": 76.22498564558533, "episode_reward_min": 42.87732854553473, "episode_reward_mean": 62.0288928718074, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.29503777233073, 71.83314161710592, 65.46051716821998, 66.85329962257954, 48.57285548360999, 62.013018463320655, 72.38577400067255, 62.51790517539485, 71.6204591407884, 69.75907688739703, 56.45709578765554, 50.04216582449944, 68.5849359982843, 45.21850451954889, 63.43037643566884, 67.101427840291, 59.21375654564787, 59.14851393525029, 42.87732854553473, 66.46864015133139, 69.17592417285917, 49.96288545924215, 71.54465891010267, 62.23080284785179, 65.26699934408948, 63.30908844549555, 64.1138738280587, 47.56270097403225, 64.28073480880393, 64.49115377857326, 63.5370545819157, 61.600767736430974, 49.08461572665242, 65.1559865041475, 65.9523277707477, 55.51285732395763, 61.847195294901276, 68.62135850539818, 64.54036989521663, 62.1588224375075, 62.16107497371306, 48.64933390435512, 44.91043730255487, 76.22498564558533, 60.42061608374012, 66.67647342566767, 52.12362208357631, 64.95640203472281, 73.20544199694857, 57.374224450171305, 70.15596671853125, 60.6680437889264, 65.08722466040871, 62.82894616015773, 60.458423611073236, 51.02044423230251, 59.96007379111853, 66.20603988622553, 56.19063423283808, 64.96766122323588, 46.74983449932145, 66.96911902387642, 59.33861184737856, 61.170545433988785, 65.74859458090211, 67.22168132391192, 60.975593872329604, 61.5889928756418, 71.98616005465831, 53.09235996935204, 59.77390866402671, 58.93133674318318, 63.29707197013845, 59.59623065482168, 51.021189549888284, 63.37529760788276, 74.23212727057522, 64.38517408827292, 69.72507534807089, 64.7248574559354, 67.92324338155716, 64.05164888146948, 68.39334618085276, 47.45195018498302, 63.992572764546956, 67.07011433607346, 58.71785908435543, 63.72394830037045, 49.1816510787047, 62.37617590879177, 67.73354616847607, 64.75634075154885, 67.96318491289884, 67.50659785779904, 64.05537891978913, 63.46917342736661, 65.8138879568543, 47.99178571752131, 66.584945150064, 67.17809391559034], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7186037463868793, "mean_inference_ms": 7.802547581335383, "mean_action_processing_ms": 0.5570512295256773, "mean_env_wait_ms": 24.000844882665216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048970699310302734, "StateBufferConnector_ms": 0.04627633094787598, "ViewRequirementAgentConnector_ms": 1.0282230377197266}}, "episode_reward_max": 76.22498564558533, "episode_reward_min": 42.87732854553473, "episode_reward_mean": 62.0288928718074, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [69.29503777233073, 71.83314161710592, 65.46051716821998, 66.85329962257954, 48.57285548360999, 62.013018463320655, 72.38577400067255, 62.51790517539485, 71.6204591407884, 69.75907688739703, 56.45709578765554, 50.04216582449944, 68.5849359982843, 45.21850451954889, 63.43037643566884, 67.101427840291, 59.21375654564787, 59.14851393525029, 42.87732854553473, 66.46864015133139, 69.17592417285917, 49.96288545924215, 71.54465891010267, 62.23080284785179, 65.26699934408948, 63.30908844549555, 64.1138738280587, 47.56270097403225, 64.28073480880393, 64.49115377857326, 63.5370545819157, 61.600767736430974, 49.08461572665242, 65.1559865041475, 65.9523277707477, 55.51285732395763, 61.847195294901276, 68.62135850539818, 64.54036989521663, 62.1588224375075, 62.16107497371306, 48.64933390435512, 44.91043730255487, 76.22498564558533, 60.42061608374012, 66.67647342566767, 52.12362208357631, 64.95640203472281, 73.20544199694857, 57.374224450171305, 70.15596671853125, 60.6680437889264, 65.08722466040871, 62.82894616015773, 60.458423611073236, 51.02044423230251, 59.96007379111853, 66.20603988622553, 56.19063423283808, 64.96766122323588, 46.74983449932145, 66.96911902387642, 59.33861184737856, 61.170545433988785, 65.74859458090211, 67.22168132391192, 60.975593872329604, 61.5889928756418, 71.98616005465831, 53.09235996935204, 59.77390866402671, 58.93133674318318, 63.29707197013845, 59.59623065482168, 51.021189549888284, 63.37529760788276, 74.23212727057522, 64.38517408827292, 69.72507534807089, 64.7248574559354, 67.92324338155716, 64.05164888146948, 68.39334618085276, 47.45195018498302, 63.992572764546956, 67.07011433607346, 58.71785908435543, 63.72394830037045, 49.1816510787047, 62.37617590879177, 67.73354616847607, 64.75634075154885, 67.96318491289884, 67.50659785779904, 64.05537891978913, 63.46917342736661, 65.8138879568543, 47.99178571752131, 66.584945150064, 67.17809391559034], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7186037463868793, "mean_inference_ms": 7.802547581335383, "mean_action_processing_ms": 0.5570512295256773, "mean_env_wait_ms": 24.000844882665216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048970699310302734, "StateBufferConnector_ms": 0.04627633094787598, "ViewRequirementAgentConnector_ms": 1.0282230377197266}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 954188, "num_agent_steps_trained": 954188, "num_env_steps_sampled": 954188, "num_env_steps_trained": 954188, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 221.8227421613015, "num_env_steps_trained_throughput_per_sec": 221.8227421613015, "timesteps_total": 954188, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 954188, "timers": {"training_iteration_time_ms": 73384.545, "sample_time_ms": 46280.568, "load_time_ms": 3193.405, "load_throughput": 4896.968, "learn_time_ms": 23223.587, "learn_throughput": 673.367, "synch_weights_time_ms": 538.169}, "counters": {"num_env_steps_sampled": 954188, "num_env_steps_trained": 954188, "num_agent_steps_sampled": 954188, "num_agent_steps_trained": 954188}, "done": false, "episodes_total": 968, "training_iteration": 69, "trial_id": "837cb_00000", "date": "2025-06-07_18-38-42", "timestamp": 1749314322, "time_this_iter_s": 70.52071762084961, "time_total_s": 4376.754621505737, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4376.754621505737, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 68.58292682926829, "ram_util_percent": 90.04024390243903, "gpu_util_percent0": 0.208780487804878, "vram_util_percent0": 0.9650065104166667}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2.0420011255901485, "episode_reward_min": -2.910923845161016, "episode_reward_mean": -2.485639854248013, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.6916414769466783, -2.910923845161016, -2.3987527575724035, -2.384880065969818, -2.0420011255901485], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8553488040966122, "mean_inference_ms": 4.025351832768429, "mean_action_processing_ms": 0.30096212800773214, "mean_env_wait_ms": 12.973711220786134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01984119415283203, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.7776880264282227}}, "episode_reward_max": -2.0420011255901485, "episode_reward_min": -2.910923845161016, "episode_reward_mean": -2.485639854248013, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.6916414769466783, -2.910923845161016, -2.3987527575724035, -2.384880065969818, -2.0420011255901485], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8553488040966122, "mean_inference_ms": 4.025351832768429, "mean_action_processing_ms": 0.30096212800773214, "mean_env_wait_ms": 12.973711220786134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01984119415283203, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.7776880264282227}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.045812000000002e-05, "total_loss": -0.09837913223743354, "policy_loss": -0.02499224510170858, "vf_loss": 0.019803737257183953, "vf_explained_var": 0.949925710179589, "kl": 0.015520271558994842, "entropy": 15.35611064043912, "entropy_coeff": 0.00522906}, "model": {}, "num_grad_updates_lifetime": 33865.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 969826, "num_env_steps_trained": 969826, "num_agent_steps_sampled": 969826, "num_agent_steps_trained": 969826}, "sampler_results": {"episode_reward_max": 76.22498564558533, "episode_reward_min": 42.87732854553473, "episode_reward_mean": 61.912497976174954, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.43037643566884, 67.101427840291, 59.21375654564787, 59.14851393525029, 42.87732854553473, 66.46864015133139, 69.17592417285917, 49.96288545924215, 71.54465891010267, 62.23080284785179, 65.26699934408948, 63.30908844549555, 64.1138738280587, 47.56270097403225, 64.28073480880393, 64.49115377857326, 63.5370545819157, 61.600767736430974, 49.08461572665242, 65.1559865041475, 65.9523277707477, 55.51285732395763, 61.847195294901276, 68.62135850539818, 64.54036989521663, 62.1588224375075, 62.16107497371306, 48.64933390435512, 44.91043730255487, 76.22498564558533, 60.42061608374012, 66.67647342566767, 52.12362208357631, 64.95640203472281, 73.20544199694857, 57.374224450171305, 70.15596671853125, 60.6680437889264, 65.08722466040871, 62.82894616015773, 60.458423611073236, 51.02044423230251, 59.96007379111853, 66.20603988622553, 56.19063423283808, 64.96766122323588, 46.74983449932145, 66.96911902387642, 59.33861184737856, 61.170545433988785, 65.74859458090211, 67.22168132391192, 60.975593872329604, 61.5889928756418, 71.98616005465831, 53.09235996935204, 59.77390866402671, 58.93133674318318, 63.29707197013845, 59.59623065482168, 51.021189549888284, 63.37529760788276, 74.23212727057522, 64.38517408827292, 69.72507534807089, 64.7248574559354, 67.92324338155716, 64.05164888146948, 68.39334618085276, 47.45195018498302, 63.992572764546956, 67.07011433607346, 58.71785908435543, 63.72394830037045, 49.1816510787047, 62.37617590879177, 67.73354616847607, 64.75634075154885, 67.96318491289884, 67.50659785779904, 64.05537891978913, 63.46917342736661, 65.8138879568543, 47.99178571752131, 66.584945150064, 67.17809391559034, 63.98839808280624, 62.877180513894146, 50.382773008918825, 67.91018192608679, 66.38976529513155, 60.78683198714137, 69.35857140646736, 62.158521491775375, 73.46903058506737, 60.08119851916588, 50.62586968320538, 49.40057000867549, 65.1733685321358, 66.37203685769133], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.720953674035651, "mean_inference_ms": 7.830124018543509, "mean_action_processing_ms": 0.5587600541850276, "mean_env_wait_ms": 24.052298578871632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05316925048828125, "StateBufferConnector_ms": 0.04119563102722168, "ViewRequirementAgentConnector_ms": 1.043975830078125}}, "episode_reward_max": 76.22498564558533, "episode_reward_min": 42.87732854553473, "episode_reward_mean": 61.912497976174954, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [63.43037643566884, 67.101427840291, 59.21375654564787, 59.14851393525029, 42.87732854553473, 66.46864015133139, 69.17592417285917, 49.96288545924215, 71.54465891010267, 62.23080284785179, 65.26699934408948, 63.30908844549555, 64.1138738280587, 47.56270097403225, 64.28073480880393, 64.49115377857326, 63.5370545819157, 61.600767736430974, 49.08461572665242, 65.1559865041475, 65.9523277707477, 55.51285732395763, 61.847195294901276, 68.62135850539818, 64.54036989521663, 62.1588224375075, 62.16107497371306, 48.64933390435512, 44.91043730255487, 76.22498564558533, 60.42061608374012, 66.67647342566767, 52.12362208357631, 64.95640203472281, 73.20544199694857, 57.374224450171305, 70.15596671853125, 60.6680437889264, 65.08722466040871, 62.82894616015773, 60.458423611073236, 51.02044423230251, 59.96007379111853, 66.20603988622553, 56.19063423283808, 64.96766122323588, 46.74983449932145, 66.96911902387642, 59.33861184737856, 61.170545433988785, 65.74859458090211, 67.22168132391192, 60.975593872329604, 61.5889928756418, 71.98616005465831, 53.09235996935204, 59.77390866402671, 58.93133674318318, 63.29707197013845, 59.59623065482168, 51.021189549888284, 63.37529760788276, 74.23212727057522, 64.38517408827292, 69.72507534807089, 64.7248574559354, 67.92324338155716, 64.05164888146948, 68.39334618085276, 47.45195018498302, 63.992572764546956, 67.07011433607346, 58.71785908435543, 63.72394830037045, 49.1816510787047, 62.37617590879177, 67.73354616847607, 64.75634075154885, 67.96318491289884, 67.50659785779904, 64.05537891978913, 63.46917342736661, 65.8138879568543, 47.99178571752131, 66.584945150064, 67.17809391559034, 63.98839808280624, 62.877180513894146, 50.382773008918825, 67.91018192608679, 66.38976529513155, 60.78683198714137, 69.35857140646736, 62.158521491775375, 73.46903058506737, 60.08119851916588, 50.62586968320538, 49.40057000867549, 65.1733685321358, 66.37203685769133], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.720953674035651, "mean_inference_ms": 7.830124018543509, "mean_action_processing_ms": 0.5587600541850276, "mean_env_wait_ms": 24.052298578871632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05316925048828125, "StateBufferConnector_ms": 0.04119563102722168, "ViewRequirementAgentConnector_ms": 1.043975830078125}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 969826, "num_agent_steps_trained": 969826, "num_env_steps_sampled": 969826, "num_env_steps_trained": 969826, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 201.27884893504918, "num_env_steps_trained_throughput_per_sec": 201.27884893504918, "timesteps_total": 969826, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 969826, "timers": {"training_iteration_time_ms": 74208.295, "sample_time_ms": 46644.147, "load_time_ms": 3481.843, "load_throughput": 4491.299, "learn_time_ms": 23346.427, "learn_throughput": 669.824, "synch_weights_time_ms": 572.256}, "counters": {"num_env_steps_sampled": 969826, "num_env_steps_trained": 969826, "num_agent_steps_sampled": 969826, "num_agent_steps_trained": 969826}, "done": false, "episodes_total": 982, "training_iteration": 70, "trial_id": "837cb_00000", "date": "2025-06-07_18-40-20", "timestamp": 1749314420, "time_this_iter_s": 97.03565669059753, "time_total_s": 4473.790278196335, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4473.790278196335, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 58.854867256637164, "ram_util_percent": 90.05132743362832, "gpu_util_percent0": 0.1492920353982301, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.030173999999999e-05, "total_loss": -0.08975952309651554, "policy_loss": -0.01612384038908534, "vf_loss": 0.01762991063042798, "vf_explained_var": 0.9576320667700334, "kl": 0.015363995712781627, "entropy": 15.509012624567205, "entropy_coeff": 0.00515087}, "model": {}, "num_grad_updates_lifetime": 34415.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 985464, "num_env_steps_trained": 985464, "num_agent_steps_sampled": 985464, "num_agent_steps_trained": 985464}, "sampler_results": {"episode_reward_max": 76.22498564558533, "episode_reward_min": 44.36654291824772, "episode_reward_mean": 62.10131960774456, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.28073480880393, 64.49115377857326, 63.5370545819157, 61.600767736430974, 49.08461572665242, 65.1559865041475, 65.9523277707477, 55.51285732395763, 61.847195294901276, 68.62135850539818, 64.54036989521663, 62.1588224375075, 62.16107497371306, 48.64933390435512, 44.91043730255487, 76.22498564558533, 60.42061608374012, 66.67647342566767, 52.12362208357631, 64.95640203472281, 73.20544199694857, 57.374224450171305, 70.15596671853125, 60.6680437889264, 65.08722466040871, 62.82894616015773, 60.458423611073236, 51.02044423230251, 59.96007379111853, 66.20603988622553, 56.19063423283808, 64.96766122323588, 46.74983449932145, 66.96911902387642, 59.33861184737856, 61.170545433988785, 65.74859458090211, 67.22168132391192, 60.975593872329604, 61.5889928756418, 71.98616005465831, 53.09235996935204, 59.77390866402671, 58.93133674318318, 63.29707197013845, 59.59623065482168, 51.021189549888284, 63.37529760788276, 74.23212727057522, 64.38517408827292, 69.72507534807089, 64.7248574559354, 67.92324338155716, 64.05164888146948, 68.39334618085276, 47.45195018498302, 63.992572764546956, 67.07011433607346, 58.71785908435543, 63.72394830037045, 49.1816510787047, 62.37617590879177, 67.73354616847607, 64.75634075154885, 67.96318491289884, 67.50659785779904, 64.05537891978913, 63.46917342736661, 65.8138879568543, 47.99178571752131, 66.584945150064, 67.17809391559034, 63.98839808280624, 62.877180513894146, 50.382773008918825, 67.91018192608679, 66.38976529513155, 60.78683198714137, 69.35857140646736, 62.158521491775375, 73.46903058506737, 60.08119851916588, 50.62586968320538, 49.40057000867549, 65.1733685321358, 66.37203685769133, 63.80118589305727, 62.39036146552149, 45.454971872602314, 64.51002127589211, 69.56526063350397, 61.06349642509151, 64.11351509850725, 65.80253512266896, 65.25908894389464, 61.39727137355616, 64.51563849039974, 44.36654291824772, 65.79023929467559, 72.25901178479961], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7227734919719753, "mean_inference_ms": 7.855549544261256, "mean_action_processing_ms": 0.5602926894010648, "mean_env_wait_ms": 24.094616591083927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047049760818481445, "StateBufferConnector_ms": 0.04229998588562012, "ViewRequirementAgentConnector_ms": 1.0179152488708496}}, "episode_reward_max": 76.22498564558533, "episode_reward_min": 44.36654291824772, "episode_reward_mean": 62.10131960774456, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.28073480880393, 64.49115377857326, 63.5370545819157, 61.600767736430974, 49.08461572665242, 65.1559865041475, 65.9523277707477, 55.51285732395763, 61.847195294901276, 68.62135850539818, 64.54036989521663, 62.1588224375075, 62.16107497371306, 48.64933390435512, 44.91043730255487, 76.22498564558533, 60.42061608374012, 66.67647342566767, 52.12362208357631, 64.95640203472281, 73.20544199694857, 57.374224450171305, 70.15596671853125, 60.6680437889264, 65.08722466040871, 62.82894616015773, 60.458423611073236, 51.02044423230251, 59.96007379111853, 66.20603988622553, 56.19063423283808, 64.96766122323588, 46.74983449932145, 66.96911902387642, 59.33861184737856, 61.170545433988785, 65.74859458090211, 67.22168132391192, 60.975593872329604, 61.5889928756418, 71.98616005465831, 53.09235996935204, 59.77390866402671, 58.93133674318318, 63.29707197013845, 59.59623065482168, 51.021189549888284, 63.37529760788276, 74.23212727057522, 64.38517408827292, 69.72507534807089, 64.7248574559354, 67.92324338155716, 64.05164888146948, 68.39334618085276, 47.45195018498302, 63.992572764546956, 67.07011433607346, 58.71785908435543, 63.72394830037045, 49.1816510787047, 62.37617590879177, 67.73354616847607, 64.75634075154885, 67.96318491289884, 67.50659785779904, 64.05537891978913, 63.46917342736661, 65.8138879568543, 47.99178571752131, 66.584945150064, 67.17809391559034, 63.98839808280624, 62.877180513894146, 50.382773008918825, 67.91018192608679, 66.38976529513155, 60.78683198714137, 69.35857140646736, 62.158521491775375, 73.46903058506737, 60.08119851916588, 50.62586968320538, 49.40057000867549, 65.1733685321358, 66.37203685769133, 63.80118589305727, 62.39036146552149, 45.454971872602314, 64.51002127589211, 69.56526063350397, 61.06349642509151, 64.11351509850725, 65.80253512266896, 65.25908894389464, 61.39727137355616, 64.51563849039974, 44.36654291824772, 65.79023929467559, 72.25901178479961], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7227734919719753, "mean_inference_ms": 7.855549544261256, "mean_action_processing_ms": 0.5602926894010648, "mean_env_wait_ms": 24.094616591083927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047049760818481445, "StateBufferConnector_ms": 0.04229998588562012, "ViewRequirementAgentConnector_ms": 1.0179152488708496}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 985464, "num_agent_steps_trained": 985464, "num_env_steps_sampled": 985464, "num_env_steps_trained": 985464, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 215.3921898012744, "num_env_steps_trained_throughput_per_sec": 215.3921898012744, "timesteps_total": 985464, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 985464, "timers": {"training_iteration_time_ms": 74451.478, "sample_time_ms": 46749.379, "load_time_ms": 3608.259, "load_throughput": 4333.947, "learn_time_ms": 23347.617, "learn_throughput": 669.79, "synch_weights_time_ms": 582.758}, "counters": {"num_env_steps_sampled": 985464, "num_env_steps_trained": 985464, "num_agent_steps_sampled": 985464, "num_agent_steps_trained": 985464}, "done": false, "episodes_total": 996, "training_iteration": 71, "trial_id": "837cb_00000", "date": "2025-06-07_18-41-32", "timestamp": 1749314492, "time_this_iter_s": 72.62844562530518, "time_total_s": 4546.41872382164, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4546.41872382164, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 66.94642857142856, "ram_util_percent": 90.44761904761906, "gpu_util_percent0": 0.1964285714285714, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.014536e-05, "total_loss": -0.11372819600711492, "policy_loss": -0.041713737898548556, "vf_loss": 0.01804460875520652, "vf_explained_var": 0.9571670237454502, "kl": 0.016102255486451222, "entropy": 15.462089992869984, "entropy_coeff": 0.00507268}, "model": {}, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1001102, "num_env_steps_trained": 1001102, "num_agent_steps_sampled": 1001102, "num_agent_steps_trained": 1001102}, "sampler_results": {"episode_reward_max": 76.22498564558533, "episode_reward_min": 44.36654291824772, "episode_reward_mean": 62.35418097700474, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.91043730255487, 76.22498564558533, 60.42061608374012, 66.67647342566767, 52.12362208357631, 64.95640203472281, 73.20544199694857, 57.374224450171305, 70.15596671853125, 60.6680437889264, 65.08722466040871, 62.82894616015773, 60.458423611073236, 51.02044423230251, 59.96007379111853, 66.20603988622553, 56.19063423283808, 64.96766122323588, 46.74983449932145, 66.96911902387642, 59.33861184737856, 61.170545433988785, 65.74859458090211, 67.22168132391192, 60.975593872329604, 61.5889928756418, 71.98616005465831, 53.09235996935204, 59.77390866402671, 58.93133674318318, 63.29707197013845, 59.59623065482168, 51.021189549888284, 63.37529760788276, 74.23212727057522, 64.38517408827292, 69.72507534807089, 64.7248574559354, 67.92324338155716, 64.05164888146948, 68.39334618085276, 47.45195018498302, 63.992572764546956, 67.07011433607346, 58.71785908435543, 63.72394830037045, 49.1816510787047, 62.37617590879177, 67.73354616847607, 64.75634075154885, 67.96318491289884, 67.50659785779904, 64.05537891978913, 63.46917342736661, 65.8138879568543, 47.99178571752131, 66.584945150064, 67.17809391559034, 63.98839808280624, 62.877180513894146, 50.382773008918825, 67.91018192608679, 66.38976529513155, 60.78683198714137, 69.35857140646736, 62.158521491775375, 73.46903058506737, 60.08119851916588, 50.62586968320538, 49.40057000867549, 65.1733685321358, 66.37203685769133, 63.80118589305727, 62.39036146552149, 45.454971872602314, 64.51002127589211, 69.56526063350397, 61.06349642509151, 64.11351509850725, 65.80253512266896, 65.25908894389464, 61.39727137355616, 64.51563849039974, 44.36654291824772, 65.79023929467559, 72.25901178479961, 58.20653171926609, 58.76416562185335, 50.620477645879355, 62.89310492104023, 73.58167375060971, 64.4983209928733, 68.60474475196648, 59.34273785160723, 66.37431727319475, 67.81849223143968, 67.13332826670793, 50.120946362662146, 68.03514066394065, 66.88580811529702], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.724011955951724, "mean_inference_ms": 7.878868275316851, "mean_action_processing_ms": 0.561671314450839, "mean_env_wait_ms": 24.13259055389537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050101280212402344, "StateBufferConnector_ms": 0.03854775428771973, "ViewRequirementAgentConnector_ms": 0.9856917858123779}}, "episode_reward_max": 76.22498564558533, "episode_reward_min": 44.36654291824772, "episode_reward_mean": 62.35418097700474, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.91043730255487, 76.22498564558533, 60.42061608374012, 66.67647342566767, 52.12362208357631, 64.95640203472281, 73.20544199694857, 57.374224450171305, 70.15596671853125, 60.6680437889264, 65.08722466040871, 62.82894616015773, 60.458423611073236, 51.02044423230251, 59.96007379111853, 66.20603988622553, 56.19063423283808, 64.96766122323588, 46.74983449932145, 66.96911902387642, 59.33861184737856, 61.170545433988785, 65.74859458090211, 67.22168132391192, 60.975593872329604, 61.5889928756418, 71.98616005465831, 53.09235996935204, 59.77390866402671, 58.93133674318318, 63.29707197013845, 59.59623065482168, 51.021189549888284, 63.37529760788276, 74.23212727057522, 64.38517408827292, 69.72507534807089, 64.7248574559354, 67.92324338155716, 64.05164888146948, 68.39334618085276, 47.45195018498302, 63.992572764546956, 67.07011433607346, 58.71785908435543, 63.72394830037045, 49.1816510787047, 62.37617590879177, 67.73354616847607, 64.75634075154885, 67.96318491289884, 67.50659785779904, 64.05537891978913, 63.46917342736661, 65.8138879568543, 47.99178571752131, 66.584945150064, 67.17809391559034, 63.98839808280624, 62.877180513894146, 50.382773008918825, 67.91018192608679, 66.38976529513155, 60.78683198714137, 69.35857140646736, 62.158521491775375, 73.46903058506737, 60.08119851916588, 50.62586968320538, 49.40057000867549, 65.1733685321358, 66.37203685769133, 63.80118589305727, 62.39036146552149, 45.454971872602314, 64.51002127589211, 69.56526063350397, 61.06349642509151, 64.11351509850725, 65.80253512266896, 65.25908894389464, 61.39727137355616, 64.51563849039974, 44.36654291824772, 65.79023929467559, 72.25901178479961, 58.20653171926609, 58.76416562185335, 50.620477645879355, 62.89310492104023, 73.58167375060971, 64.4983209928733, 68.60474475196648, 59.34273785160723, 66.37431727319475, 67.81849223143968, 67.13332826670793, 50.120946362662146, 68.03514066394065, 66.88580811529702], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.724011955951724, "mean_inference_ms": 7.878868275316851, "mean_action_processing_ms": 0.561671314450839, "mean_env_wait_ms": 24.13259055389537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050101280212402344, "StateBufferConnector_ms": 0.03854775428771973, "ViewRequirementAgentConnector_ms": 0.9856917858123779}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1001102, "num_agent_steps_trained": 1001102, "num_env_steps_sampled": 1001102, "num_env_steps_trained": 1001102, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 221.9702036139803, "num_env_steps_trained_throughput_per_sec": 221.9702036139803, "timesteps_total": 1001102, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1001102, "timers": {"training_iteration_time_ms": 74213.25, "sample_time_ms": 46646.474, "load_time_ms": 3516.086, "load_throughput": 4447.559, "learn_time_ms": 23305.547, "learn_throughput": 670.999, "synch_weights_time_ms": 581.632}, "counters": {"num_env_steps_sampled": 1001102, "num_env_steps_trained": 1001102, "num_agent_steps_sampled": 1001102, "num_agent_steps_trained": 1001102}, "done": false, "episodes_total": 1010, "training_iteration": 72, "trial_id": "837cb_00000", "date": "2025-06-07_18-42-43", "timestamp": 1749314563, "time_this_iter_s": 70.47041010856628, "time_total_s": 4616.889133930206, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4616.889133930206, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 67.16506024096387, "ram_util_percent": 88.96746987951806, "gpu_util_percent0": 0.2116867469879518, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.998898000000002e-05, "total_loss": -0.10669509020877409, "policy_loss": -0.03497819564760324, "vf_loss": 0.01660907112739303, "vf_explained_var": 0.9568078071420842, "kl": 0.01616383458524947, "entropy": 15.547111731442538, "entropy_coeff": 0.004998347}, "model": {}, "num_grad_updates_lifetime": 35515.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1016740, "num_env_steps_trained": 1016740, "num_agent_steps_sampled": 1016740, "num_agent_steps_trained": 1016740}, "sampler_results": {"episode_reward_max": 74.23212727057522, "episode_reward_min": 44.36654291824772, "episode_reward_mean": 62.27177132293822, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.96007379111853, 66.20603988622553, 56.19063423283808, 64.96766122323588, 46.74983449932145, 66.96911902387642, 59.33861184737856, 61.170545433988785, 65.74859458090211, 67.22168132391192, 60.975593872329604, 61.5889928756418, 71.98616005465831, 53.09235996935204, 59.77390866402671, 58.93133674318318, 63.29707197013845, 59.59623065482168, 51.021189549888284, 63.37529760788276, 74.23212727057522, 64.38517408827292, 69.72507534807089, 64.7248574559354, 67.92324338155716, 64.05164888146948, 68.39334618085276, 47.45195018498302, 63.992572764546956, 67.07011433607346, 58.71785908435543, 63.72394830037045, 49.1816510787047, 62.37617590879177, 67.73354616847607, 64.75634075154885, 67.96318491289884, 67.50659785779904, 64.05537891978913, 63.46917342736661, 65.8138879568543, 47.99178571752131, 66.584945150064, 67.17809391559034, 63.98839808280624, 62.877180513894146, 50.382773008918825, 67.91018192608679, 66.38976529513155, 60.78683198714137, 69.35857140646736, 62.158521491775375, 73.46903058506737, 60.08119851916588, 50.62586968320538, 49.40057000867549, 65.1733685321358, 66.37203685769133, 63.80118589305727, 62.39036146552149, 45.454971872602314, 64.51002127589211, 69.56526063350397, 61.06349642509151, 64.11351509850725, 65.80253512266896, 65.25908894389464, 61.39727137355616, 64.51563849039974, 44.36654291824772, 65.79023929467559, 72.25901178479961, 58.20653171926609, 58.76416562185335, 50.620477645879355, 62.89310492104023, 73.58167375060971, 64.4983209928733, 68.60474475196648, 59.34273785160723, 66.37431727319475, 67.81849223143968, 67.13332826670793, 50.120946362662146, 68.03514066394065, 66.88580811529702, 58.352570983132345, 62.45725142524352, 48.60078961281169, 64.44043993322373, 67.30119806663633, 61.834238086071764, 68.52924677856177, 62.90292711895779, 60.15667192627206, 62.106388355217106, 58.70253970092659, 50.31877462177907, 64.53188808928972, 67.6353620895912], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7249824815834676, "mean_inference_ms": 7.895644938799668, "mean_action_processing_ms": 0.5626220362495391, "mean_env_wait_ms": 24.15836247107651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05056405067443848, "StateBufferConnector_ms": 0.030225753784179688, "ViewRequirementAgentConnector_ms": 0.9718320369720459}}, "episode_reward_max": 74.23212727057522, "episode_reward_min": 44.36654291824772, "episode_reward_mean": 62.27177132293822, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.96007379111853, 66.20603988622553, 56.19063423283808, 64.96766122323588, 46.74983449932145, 66.96911902387642, 59.33861184737856, 61.170545433988785, 65.74859458090211, 67.22168132391192, 60.975593872329604, 61.5889928756418, 71.98616005465831, 53.09235996935204, 59.77390866402671, 58.93133674318318, 63.29707197013845, 59.59623065482168, 51.021189549888284, 63.37529760788276, 74.23212727057522, 64.38517408827292, 69.72507534807089, 64.7248574559354, 67.92324338155716, 64.05164888146948, 68.39334618085276, 47.45195018498302, 63.992572764546956, 67.07011433607346, 58.71785908435543, 63.72394830037045, 49.1816510787047, 62.37617590879177, 67.73354616847607, 64.75634075154885, 67.96318491289884, 67.50659785779904, 64.05537891978913, 63.46917342736661, 65.8138879568543, 47.99178571752131, 66.584945150064, 67.17809391559034, 63.98839808280624, 62.877180513894146, 50.382773008918825, 67.91018192608679, 66.38976529513155, 60.78683198714137, 69.35857140646736, 62.158521491775375, 73.46903058506737, 60.08119851916588, 50.62586968320538, 49.40057000867549, 65.1733685321358, 66.37203685769133, 63.80118589305727, 62.39036146552149, 45.454971872602314, 64.51002127589211, 69.56526063350397, 61.06349642509151, 64.11351509850725, 65.80253512266896, 65.25908894389464, 61.39727137355616, 64.51563849039974, 44.36654291824772, 65.79023929467559, 72.25901178479961, 58.20653171926609, 58.76416562185335, 50.620477645879355, 62.89310492104023, 73.58167375060971, 64.4983209928733, 68.60474475196648, 59.34273785160723, 66.37431727319475, 67.81849223143968, 67.13332826670793, 50.120946362662146, 68.03514066394065, 66.88580811529702, 58.352570983132345, 62.45725142524352, 48.60078961281169, 64.44043993322373, 67.30119806663633, 61.834238086071764, 68.52924677856177, 62.90292711895779, 60.15667192627206, 62.106388355217106, 58.70253970092659, 50.31877462177907, 64.53188808928972, 67.6353620895912], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7249824815834676, "mean_inference_ms": 7.895644938799668, "mean_action_processing_ms": 0.5626220362495391, "mean_env_wait_ms": 24.15836247107651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05056405067443848, "StateBufferConnector_ms": 0.030225753784179688, "ViewRequirementAgentConnector_ms": 0.9718320369720459}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1016740, "num_agent_steps_trained": 1016740, "num_env_steps_sampled": 1016740, "num_env_steps_trained": 1016740, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 233.3632428394296, "num_env_steps_trained_throughput_per_sec": 233.3632428394296, "timesteps_total": 1016740, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1016740, "timers": {"training_iteration_time_ms": 73563.872, "sample_time_ms": 46357.496, "load_time_ms": 3340.034, "load_throughput": 4681.988, "learn_time_ms": 23123.926, "learn_throughput": 676.269, "synch_weights_time_ms": 581.831}, "counters": {"num_env_steps_sampled": 1016740, "num_env_steps_trained": 1016740, "num_agent_steps_sampled": 1016740, "num_agent_steps_trained": 1016740}, "done": false, "episodes_total": 1024, "training_iteration": 73, "trial_id": "837cb_00000", "date": "2025-06-07_18-43-50", "timestamp": 1749314630, "time_this_iter_s": 67.02732348442078, "time_total_s": 4683.916457414627, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4683.916457414627, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 66.36666666666665, "ram_util_percent": 89.89615384615388, "gpu_util_percent0": 0.21371794871794875, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.983259999999999e-05, "total_loss": -0.09664263304746286, "policy_loss": -0.026148030604024163, "vf_loss": 0.01940765684703365, "vf_explained_var": 0.9544304940917275, "kl": 0.016518751286046233, "entropy": 15.547945814999666, "entropy_coeff": 0.00497489}, "model": {}, "num_grad_updates_lifetime": 36065.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1032378, "num_env_steps_trained": 1032378, "num_agent_steps_sampled": 1032378, "num_agent_steps_trained": 1032378}, "sampler_results": {"episode_reward_max": 74.23212727057522, "episode_reward_min": 44.36654291824772, "episode_reward_mean": 62.05387842859062, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.77390866402671, 58.93133674318318, 63.29707197013845, 59.59623065482168, 51.021189549888284, 63.37529760788276, 74.23212727057522, 64.38517408827292, 69.72507534807089, 64.7248574559354, 67.92324338155716, 64.05164888146948, 68.39334618085276, 47.45195018498302, 63.992572764546956, 67.07011433607346, 58.71785908435543, 63.72394830037045, 49.1816510787047, 62.37617590879177, 67.73354616847607, 64.75634075154885, 67.96318491289884, 67.50659785779904, 64.05537891978913, 63.46917342736661, 65.8138879568543, 47.99178571752131, 66.584945150064, 67.17809391559034, 63.98839808280624, 62.877180513894146, 50.382773008918825, 67.91018192608679, 66.38976529513155, 60.78683198714137, 69.35857140646736, 62.158521491775375, 73.46903058506737, 60.08119851916588, 50.62586968320538, 49.40057000867549, 65.1733685321358, 66.37203685769133, 63.80118589305727, 62.39036146552149, 45.454971872602314, 64.51002127589211, 69.56526063350397, 61.06349642509151, 64.11351509850725, 65.80253512266896, 65.25908894389464, 61.39727137355616, 64.51563849039974, 44.36654291824772, 65.79023929467559, 72.25901178479961, 58.20653171926609, 58.76416562185335, 50.620477645879355, 62.89310492104023, 73.58167375060971, 64.4983209928733, 68.60474475196648, 59.34273785160723, 66.37431727319475, 67.81849223143968, 67.13332826670793, 50.120946362662146, 68.03514066394065, 66.88580811529702, 58.352570983132345, 62.45725142524352, 48.60078961281169, 64.44043993322373, 67.30119806663633, 61.834238086071764, 68.52924677856177, 62.90292711895779, 60.15667192627206, 62.106388355217106, 58.70253970092659, 50.31877462177907, 64.53188808928972, 67.6353620895912, 54.38916013627205, 59.083309640473054, 46.847865028621236, 67.05603121626697, 65.93777872174188, 63.15729720815801, 71.87132085219733, 53.09814192451298, 65.1856914035514, 61.52720749174164, 58.205584255161035, 47.80128352066928, 68.41072145418917, 57.80522032646454], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7258956848136298, "mean_inference_ms": 7.908594612003347, "mean_action_processing_ms": 0.5633560161372592, "mean_env_wait_ms": 24.176707874616888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04668021202087402, "StateBufferConnector_ms": 0.030189990997314453, "ViewRequirementAgentConnector_ms": 0.9541165828704834}}, "episode_reward_max": 74.23212727057522, "episode_reward_min": 44.36654291824772, "episode_reward_mean": 62.05387842859062, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.77390866402671, 58.93133674318318, 63.29707197013845, 59.59623065482168, 51.021189549888284, 63.37529760788276, 74.23212727057522, 64.38517408827292, 69.72507534807089, 64.7248574559354, 67.92324338155716, 64.05164888146948, 68.39334618085276, 47.45195018498302, 63.992572764546956, 67.07011433607346, 58.71785908435543, 63.72394830037045, 49.1816510787047, 62.37617590879177, 67.73354616847607, 64.75634075154885, 67.96318491289884, 67.50659785779904, 64.05537891978913, 63.46917342736661, 65.8138879568543, 47.99178571752131, 66.584945150064, 67.17809391559034, 63.98839808280624, 62.877180513894146, 50.382773008918825, 67.91018192608679, 66.38976529513155, 60.78683198714137, 69.35857140646736, 62.158521491775375, 73.46903058506737, 60.08119851916588, 50.62586968320538, 49.40057000867549, 65.1733685321358, 66.37203685769133, 63.80118589305727, 62.39036146552149, 45.454971872602314, 64.51002127589211, 69.56526063350397, 61.06349642509151, 64.11351509850725, 65.80253512266896, 65.25908894389464, 61.39727137355616, 64.51563849039974, 44.36654291824772, 65.79023929467559, 72.25901178479961, 58.20653171926609, 58.76416562185335, 50.620477645879355, 62.89310492104023, 73.58167375060971, 64.4983209928733, 68.60474475196648, 59.34273785160723, 66.37431727319475, 67.81849223143968, 67.13332826670793, 50.120946362662146, 68.03514066394065, 66.88580811529702, 58.352570983132345, 62.45725142524352, 48.60078961281169, 64.44043993322373, 67.30119806663633, 61.834238086071764, 68.52924677856177, 62.90292711895779, 60.15667192627206, 62.106388355217106, 58.70253970092659, 50.31877462177907, 64.53188808928972, 67.6353620895912, 54.38916013627205, 59.083309640473054, 46.847865028621236, 67.05603121626697, 65.93777872174188, 63.15729720815801, 71.87132085219733, 53.09814192451298, 65.1856914035514, 61.52720749174164, 58.205584255161035, 47.80128352066928, 68.41072145418917, 57.80522032646454], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7258956848136298, "mean_inference_ms": 7.908594612003347, "mean_action_processing_ms": 0.5633560161372592, "mean_env_wait_ms": 24.176707874616888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04668021202087402, "StateBufferConnector_ms": 0.030189990997314453, "ViewRequirementAgentConnector_ms": 0.9541165828704834}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032378, "num_agent_steps_trained": 1032378, "num_env_steps_sampled": 1032378, "num_env_steps_trained": 1032378, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 232.15344424657465, "num_env_steps_trained_throughput_per_sec": 232.15344424657465, "timesteps_total": 1032378, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1032378, "timers": {"training_iteration_time_ms": 72731.627, "sample_time_ms": 45583.342, "load_time_ms": 3322.93, "load_throughput": 4706.088, "learn_time_ms": 23076.285, "learn_throughput": 677.665, "synch_weights_time_ms": 584.878}, "counters": {"num_env_steps_sampled": 1032378, "num_env_steps_trained": 1032378, "num_agent_steps_sampled": 1032378, "num_agent_steps_trained": 1032378}, "done": false, "episodes_total": 1038, "training_iteration": 74, "trial_id": "837cb_00000", "date": "2025-06-07_18-44-58", "timestamp": 1749314698, "time_this_iter_s": 67.3762936592102, "time_total_s": 4751.292751073837, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4751.292751073837, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 65.54683544303796, "ram_util_percent": 89.47848101265822, "gpu_util_percent0": 0.21759493670886068, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.967622e-05, "total_loss": -0.12134009386455132, "policy_loss": -0.05051823458359153, "vf_loss": 0.017177488393658263, "vf_explained_var": 0.9558575580336831, "kl": 0.01654722168110311, "entropy": 15.55293395649303, "entropy_coeff": 0.004951432999999999}, "model": {}, "num_grad_updates_lifetime": 36615.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1048016, "num_env_steps_trained": 1048016, "num_agent_steps_sampled": 1048016, "num_agent_steps_trained": 1048016}, "sampler_results": {"episode_reward_max": 73.58167375060971, "episode_reward_min": 44.36654291824772, "episode_reward_mean": 61.92355202623065, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.992572764546956, 67.07011433607346, 58.71785908435543, 63.72394830037045, 49.1816510787047, 62.37617590879177, 67.73354616847607, 64.75634075154885, 67.96318491289884, 67.50659785779904, 64.05537891978913, 63.46917342736661, 65.8138879568543, 47.99178571752131, 66.584945150064, 67.17809391559034, 63.98839808280624, 62.877180513894146, 50.382773008918825, 67.91018192608679, 66.38976529513155, 60.78683198714137, 69.35857140646736, 62.158521491775375, 73.46903058506737, 60.08119851916588, 50.62586968320538, 49.40057000867549, 65.1733685321358, 66.37203685769133, 63.80118589305727, 62.39036146552149, 45.454971872602314, 64.51002127589211, 69.56526063350397, 61.06349642509151, 64.11351509850725, 65.80253512266896, 65.25908894389464, 61.39727137355616, 64.51563849039974, 44.36654291824772, 65.79023929467559, 72.25901178479961, 58.20653171926609, 58.76416562185335, 50.620477645879355, 62.89310492104023, 73.58167375060971, 64.4983209928733, 68.60474475196648, 59.34273785160723, 66.37431727319475, 67.81849223143968, 67.13332826670793, 50.120946362662146, 68.03514066394065, 66.88580811529702, 58.352570983132345, 62.45725142524352, 48.60078961281169, 64.44043993322373, 67.30119806663633, 61.834238086071764, 68.52924677856177, 62.90292711895779, 60.15667192627206, 62.106388355217106, 58.70253970092659, 50.31877462177907, 64.53188808928972, 67.6353620895912, 54.38916013627205, 59.083309640473054, 46.847865028621236, 67.05603121626697, 65.93777872174188, 63.15729720815801, 71.87132085219733, 53.09814192451298, 65.1856914035514, 61.52720749174164, 58.205584255161035, 47.80128352066928, 68.41072145418917, 57.80522032646454, 61.72315564648603, 62.621787469182884, 46.018887123291215, 65.67162837789887, 69.20149596742927, 63.9973888659535, 65.53408857106518, 67.49731696320552, 61.683978647603205, 60.087810345924574, 66.88015297994411, 50.39304181832634, 64.29319965883849, 58.2458853105109], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.727058154037403, "mean_inference_ms": 7.91964947222987, "mean_action_processing_ms": 0.5639850231484443, "mean_env_wait_ms": 24.191218887592797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03772926330566406, "StateBufferConnector_ms": 0.029256343841552734, "ViewRequirementAgentConnector_ms": 0.9487414360046387}}, "episode_reward_max": 73.58167375060971, "episode_reward_min": 44.36654291824772, "episode_reward_mean": 61.92355202623065, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [63.992572764546956, 67.07011433607346, 58.71785908435543, 63.72394830037045, 49.1816510787047, 62.37617590879177, 67.73354616847607, 64.75634075154885, 67.96318491289884, 67.50659785779904, 64.05537891978913, 63.46917342736661, 65.8138879568543, 47.99178571752131, 66.584945150064, 67.17809391559034, 63.98839808280624, 62.877180513894146, 50.382773008918825, 67.91018192608679, 66.38976529513155, 60.78683198714137, 69.35857140646736, 62.158521491775375, 73.46903058506737, 60.08119851916588, 50.62586968320538, 49.40057000867549, 65.1733685321358, 66.37203685769133, 63.80118589305727, 62.39036146552149, 45.454971872602314, 64.51002127589211, 69.56526063350397, 61.06349642509151, 64.11351509850725, 65.80253512266896, 65.25908894389464, 61.39727137355616, 64.51563849039974, 44.36654291824772, 65.79023929467559, 72.25901178479961, 58.20653171926609, 58.76416562185335, 50.620477645879355, 62.89310492104023, 73.58167375060971, 64.4983209928733, 68.60474475196648, 59.34273785160723, 66.37431727319475, 67.81849223143968, 67.13332826670793, 50.120946362662146, 68.03514066394065, 66.88580811529702, 58.352570983132345, 62.45725142524352, 48.60078961281169, 64.44043993322373, 67.30119806663633, 61.834238086071764, 68.52924677856177, 62.90292711895779, 60.15667192627206, 62.106388355217106, 58.70253970092659, 50.31877462177907, 64.53188808928972, 67.6353620895912, 54.38916013627205, 59.083309640473054, 46.847865028621236, 67.05603121626697, 65.93777872174188, 63.15729720815801, 71.87132085219733, 53.09814192451298, 65.1856914035514, 61.52720749174164, 58.205584255161035, 47.80128352066928, 68.41072145418917, 57.80522032646454, 61.72315564648603, 62.621787469182884, 46.018887123291215, 65.67162837789887, 69.20149596742927, 63.9973888659535, 65.53408857106518, 67.49731696320552, 61.683978647603205, 60.087810345924574, 66.88015297994411, 50.39304181832634, 64.29319965883849, 58.2458853105109], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.727058154037403, "mean_inference_ms": 7.91964947222987, "mean_action_processing_ms": 0.5639850231484443, "mean_env_wait_ms": 24.191218887592797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03772926330566406, "StateBufferConnector_ms": 0.029256343841552734, "ViewRequirementAgentConnector_ms": 0.9487414360046387}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1048016, "num_agent_steps_trained": 1048016, "num_env_steps_sampled": 1048016, "num_env_steps_trained": 1048016, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 235.03277647865588, "num_env_steps_trained_throughput_per_sec": 235.03277647865588, "timesteps_total": 1048016, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1048016, "timers": {"training_iteration_time_ms": 71727.947, "sample_time_ms": 45006.521, "load_time_ms": 3182.115, "load_throughput": 4914.341, "learn_time_ms": 22811.137, "learn_throughput": 685.542, "synch_weights_time_ms": 568.731}, "counters": {"num_env_steps_sampled": 1048016, "num_env_steps_trained": 1048016, "num_agent_steps_sampled": 1048016, "num_agent_steps_trained": 1048016}, "done": false, "episodes_total": 1052, "training_iteration": 75, "trial_id": "837cb_00000", "date": "2025-06-07_18-46-04", "timestamp": 1749314764, "time_this_iter_s": 66.55439972877502, "time_total_s": 4817.847150802612, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4817.847150802612, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 65.84102564102565, "ram_util_percent": 89.2102564102564, "gpu_util_percent0": 0.21833333333333335, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.951984000000001e-05, "total_loss": -0.11036333196653604, "policy_loss": -0.039656879664087846, "vf_loss": 0.016440741360949522, "vf_explained_var": 0.9553966800733046, "kl": 0.017081361315970395, "entropy": 15.56546954761852, "entropy_coeff": 0.004927976000000001}, "model": {}, "num_grad_updates_lifetime": 37165.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1063654, "num_env_steps_trained": 1063654, "num_agent_steps_sampled": 1063654, "num_agent_steps_trained": 1063654}, "sampler_results": {"episode_reward_max": 73.58167375060971, "episode_reward_min": 44.36654291824772, "episode_reward_mean": 61.93512430144758, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.584945150064, 67.17809391559034, 63.98839808280624, 62.877180513894146, 50.382773008918825, 67.91018192608679, 66.38976529513155, 60.78683198714137, 69.35857140646736, 62.158521491775375, 73.46903058506737, 60.08119851916588, 50.62586968320538, 49.40057000867549, 65.1733685321358, 66.37203685769133, 63.80118589305727, 62.39036146552149, 45.454971872602314, 64.51002127589211, 69.56526063350397, 61.06349642509151, 64.11351509850725, 65.80253512266896, 65.25908894389464, 61.39727137355616, 64.51563849039974, 44.36654291824772, 65.79023929467559, 72.25901178479961, 58.20653171926609, 58.76416562185335, 50.620477645879355, 62.89310492104023, 73.58167375060971, 64.4983209928733, 68.60474475196648, 59.34273785160723, 66.37431727319475, 67.81849223143968, 67.13332826670793, 50.120946362662146, 68.03514066394065, 66.88580811529702, 58.352570983132345, 62.45725142524352, 48.60078961281169, 64.44043993322373, 67.30119806663633, 61.834238086071764, 68.52924677856177, 62.90292711895779, 60.15667192627206, 62.106388355217106, 58.70253970092659, 50.31877462177907, 64.53188808928972, 67.6353620895912, 54.38916013627205, 59.083309640473054, 46.847865028621236, 67.05603121626697, 65.93777872174188, 63.15729720815801, 71.87132085219733, 53.09814192451298, 65.1856914035514, 61.52720749174164, 58.205584255161035, 47.80128352066928, 68.41072145418917, 57.80522032646454, 61.72315564648603, 62.621787469182884, 46.018887123291215, 65.67162837789887, 69.20149596742927, 63.9973888659535, 65.53408857106518, 67.49731696320552, 61.683978647603205, 60.087810345924574, 66.88015297994411, 50.39304181832634, 64.29319965883849, 58.2458853105109, 63.60699098875258, 64.0586783180159, 48.70955905210742, 64.83130282686302, 72.87196991073179, 60.5529748400084, 63.94689595493216, 62.12252778573753, 64.92974615205428, 65.86778302903672, 59.563963066468666, 49.09060871367046, 67.86461602825948, 67.49182804014966], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7286738102947736, "mean_inference_ms": 7.929786631985592, "mean_action_processing_ms": 0.5645442768132882, "mean_env_wait_ms": 24.20394166702264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03657412528991699, "StateBufferConnector_ms": 0.0330202579498291, "ViewRequirementAgentConnector_ms": 0.939765453338623}}, "episode_reward_max": 73.58167375060971, "episode_reward_min": 44.36654291824772, "episode_reward_mean": 61.93512430144758, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [66.584945150064, 67.17809391559034, 63.98839808280624, 62.877180513894146, 50.382773008918825, 67.91018192608679, 66.38976529513155, 60.78683198714137, 69.35857140646736, 62.158521491775375, 73.46903058506737, 60.08119851916588, 50.62586968320538, 49.40057000867549, 65.1733685321358, 66.37203685769133, 63.80118589305727, 62.39036146552149, 45.454971872602314, 64.51002127589211, 69.56526063350397, 61.06349642509151, 64.11351509850725, 65.80253512266896, 65.25908894389464, 61.39727137355616, 64.51563849039974, 44.36654291824772, 65.79023929467559, 72.25901178479961, 58.20653171926609, 58.76416562185335, 50.620477645879355, 62.89310492104023, 73.58167375060971, 64.4983209928733, 68.60474475196648, 59.34273785160723, 66.37431727319475, 67.81849223143968, 67.13332826670793, 50.120946362662146, 68.03514066394065, 66.88580811529702, 58.352570983132345, 62.45725142524352, 48.60078961281169, 64.44043993322373, 67.30119806663633, 61.834238086071764, 68.52924677856177, 62.90292711895779, 60.15667192627206, 62.106388355217106, 58.70253970092659, 50.31877462177907, 64.53188808928972, 67.6353620895912, 54.38916013627205, 59.083309640473054, 46.847865028621236, 67.05603121626697, 65.93777872174188, 63.15729720815801, 71.87132085219733, 53.09814192451298, 65.1856914035514, 61.52720749174164, 58.205584255161035, 47.80128352066928, 68.41072145418917, 57.80522032646454, 61.72315564648603, 62.621787469182884, 46.018887123291215, 65.67162837789887, 69.20149596742927, 63.9973888659535, 65.53408857106518, 67.49731696320552, 61.683978647603205, 60.087810345924574, 66.88015297994411, 50.39304181832634, 64.29319965883849, 58.2458853105109, 63.60699098875258, 64.0586783180159, 48.70955905210742, 64.83130282686302, 72.87196991073179, 60.5529748400084, 63.94689595493216, 62.12252778573753, 64.92974615205428, 65.86778302903672, 59.563963066468666, 49.09060871367046, 67.86461602825948, 67.49182804014966], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7286738102947736, "mean_inference_ms": 7.929786631985592, "mean_action_processing_ms": 0.5645442768132882, "mean_env_wait_ms": 24.20394166702264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03657412528991699, "StateBufferConnector_ms": 0.0330202579498291, "ViewRequirementAgentConnector_ms": 0.939765453338623}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1063654, "num_agent_steps_trained": 1063654, "num_env_steps_sampled": 1063654, "num_env_steps_trained": 1063654, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 231.40962113401292, "num_env_steps_trained_throughput_per_sec": 231.40962113401292, "timesteps_total": 1063654, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1063654, "timers": {"training_iteration_time_ms": 70610.181, "sample_time_ms": 44065.759, "load_time_ms": 3101.13, "load_throughput": 5042.677, "learn_time_ms": 22725.472, "learn_throughput": 688.127, "synch_weights_time_ms": 561.762}, "counters": {"num_env_steps_sampled": 1063654, "num_env_steps_trained": 1063654, "num_agent_steps_sampled": 1063654, "num_agent_steps_trained": 1063654}, "done": false, "episodes_total": 1066, "training_iteration": 76, "trial_id": "837cb_00000", "date": "2025-06-07_18-47-12", "timestamp": 1749314832, "time_this_iter_s": 67.59289908409119, "time_total_s": 4885.4400498867035, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4885.4400498867035, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 66.85384615384616, "ram_util_percent": 89.35769230769232, "gpu_util_percent0": 0.2153846153846154, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.936346e-05, "total_loss": -0.10185148261318153, "policy_loss": -0.031459768042815, "vf_loss": 0.016508920103819533, "vf_explained_var": 0.9536253936724229, "kl": 0.016708557628340934, "entropy": 15.575161802118474, "entropy_coeff": 0.004904519}, "model": {}, "num_grad_updates_lifetime": 37715.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1079292, "num_env_steps_trained": 1079292, "num_agent_steps_sampled": 1079292, "num_agent_steps_trained": 1079292}, "sampler_results": {"episode_reward_max": 73.58167375060971, "episode_reward_min": 43.853664555337176, "episode_reward_mean": 61.80337187191657, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.1733685321358, 66.37203685769133, 63.80118589305727, 62.39036146552149, 45.454971872602314, 64.51002127589211, 69.56526063350397, 61.06349642509151, 64.11351509850725, 65.80253512266896, 65.25908894389464, 61.39727137355616, 64.51563849039974, 44.36654291824772, 65.79023929467559, 72.25901178479961, 58.20653171926609, 58.76416562185335, 50.620477645879355, 62.89310492104023, 73.58167375060971, 64.4983209928733, 68.60474475196648, 59.34273785160723, 66.37431727319475, 67.81849223143968, 67.13332826670793, 50.120946362662146, 68.03514066394065, 66.88580811529702, 58.352570983132345, 62.45725142524352, 48.60078961281169, 64.44043993322373, 67.30119806663633, 61.834238086071764, 68.52924677856177, 62.90292711895779, 60.15667192627206, 62.106388355217106, 58.70253970092659, 50.31877462177907, 64.53188808928972, 67.6353620895912, 54.38916013627205, 59.083309640473054, 46.847865028621236, 67.05603121626697, 65.93777872174188, 63.15729720815801, 71.87132085219733, 53.09814192451298, 65.1856914035514, 61.52720749174164, 58.205584255161035, 47.80128352066928, 68.41072145418917, 57.80522032646454, 61.72315564648603, 62.621787469182884, 46.018887123291215, 65.67162837789887, 69.20149596742927, 63.9973888659535, 65.53408857106518, 67.49731696320552, 61.683978647603205, 60.087810345924574, 66.88015297994411, 50.39304181832634, 64.29319965883849, 58.2458853105109, 63.60699098875258, 64.0586783180159, 48.70955905210742, 64.83130282686302, 72.87196991073179, 60.5529748400084, 63.94689595493216, 62.12252778573753, 64.92974615205428, 65.86778302903672, 59.563963066468666, 49.09060871367046, 67.86461602825948, 67.49182804014966, 62.63675865396635, 63.588983428956446, 51.19629361011488, 60.85872963734203, 70.9569256014864, 59.747829166754144, 67.02397876437449, 57.367469656682324, 67.03608688247976, 62.57621737949416, 62.89031068916887, 43.853664555337176, 59.69189253603572, 68.5915480586984], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.730187296611244, "mean_inference_ms": 7.936660280285591, "mean_action_processing_ms": 0.5648942840787283, "mean_env_wait_ms": 24.21051712052254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024206161499023438, "StateBufferConnector_ms": 0.033659934997558594, "ViewRequirementAgentConnector_ms": 0.91798996925354}}, "episode_reward_max": 73.58167375060971, "episode_reward_min": 43.853664555337176, "episode_reward_mean": 61.80337187191657, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.1733685321358, 66.37203685769133, 63.80118589305727, 62.39036146552149, 45.454971872602314, 64.51002127589211, 69.56526063350397, 61.06349642509151, 64.11351509850725, 65.80253512266896, 65.25908894389464, 61.39727137355616, 64.51563849039974, 44.36654291824772, 65.79023929467559, 72.25901178479961, 58.20653171926609, 58.76416562185335, 50.620477645879355, 62.89310492104023, 73.58167375060971, 64.4983209928733, 68.60474475196648, 59.34273785160723, 66.37431727319475, 67.81849223143968, 67.13332826670793, 50.120946362662146, 68.03514066394065, 66.88580811529702, 58.352570983132345, 62.45725142524352, 48.60078961281169, 64.44043993322373, 67.30119806663633, 61.834238086071764, 68.52924677856177, 62.90292711895779, 60.15667192627206, 62.106388355217106, 58.70253970092659, 50.31877462177907, 64.53188808928972, 67.6353620895912, 54.38916013627205, 59.083309640473054, 46.847865028621236, 67.05603121626697, 65.93777872174188, 63.15729720815801, 71.87132085219733, 53.09814192451298, 65.1856914035514, 61.52720749174164, 58.205584255161035, 47.80128352066928, 68.41072145418917, 57.80522032646454, 61.72315564648603, 62.621787469182884, 46.018887123291215, 65.67162837789887, 69.20149596742927, 63.9973888659535, 65.53408857106518, 67.49731696320552, 61.683978647603205, 60.087810345924574, 66.88015297994411, 50.39304181832634, 64.29319965883849, 58.2458853105109, 63.60699098875258, 64.0586783180159, 48.70955905210742, 64.83130282686302, 72.87196991073179, 60.5529748400084, 63.94689595493216, 62.12252778573753, 64.92974615205428, 65.86778302903672, 59.563963066468666, 49.09060871367046, 67.86461602825948, 67.49182804014966, 62.63675865396635, 63.588983428956446, 51.19629361011488, 60.85872963734203, 70.9569256014864, 59.747829166754144, 67.02397876437449, 57.367469656682324, 67.03608688247976, 62.57621737949416, 62.89031068916887, 43.853664555337176, 59.69189253603572, 68.5915480586984], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.730187296611244, "mean_inference_ms": 7.936660280285591, "mean_action_processing_ms": 0.5648942840787283, "mean_env_wait_ms": 24.21051712052254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024206161499023438, "StateBufferConnector_ms": 0.033659934997558594, "ViewRequirementAgentConnector_ms": 0.91798996925354}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1079292, "num_agent_steps_trained": 1079292, "num_env_steps_sampled": 1079292, "num_env_steps_trained": 1079292, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 233.83240894693733, "num_env_steps_trained_throughput_per_sec": 233.83240894693733, "timesteps_total": 1079292, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1079292, "timers": {"training_iteration_time_ms": 69665.307, "sample_time_ms": 43595.346, "load_time_ms": 2818.003, "load_throughput": 5549.32, "learn_time_ms": 22546.949, "learn_throughput": 693.575, "synch_weights_time_ms": 558.118}, "counters": {"num_env_steps_sampled": 1079292, "num_env_steps_trained": 1079292, "num_agent_steps_sampled": 1079292, "num_agent_steps_trained": 1079292}, "done": false, "episodes_total": 1080, "training_iteration": 77, "trial_id": "837cb_00000", "date": "2025-06-07_18-48-19", "timestamp": 1749314899, "time_this_iter_s": 66.90841746330261, "time_total_s": 4952.348467350006, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4952.348467350006, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 65.56835443037976, "ram_util_percent": 89.16455696202533, "gpu_util_percent0": 0.21949367088607594, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.920708000000001e-05, "total_loss": -0.09217094658027318, "policy_loss": -0.02161108766857069, "vf_loss": 0.015694663698404013, "vf_explained_var": 0.9562077369473198, "kl": 0.01704556233683814, "entropy": 15.638728889118541, "entropy_coeff": 0.004881061999999999}, "model": {}, "num_grad_updates_lifetime": 38265.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1094930, "num_env_steps_trained": 1094930, "num_agent_steps_sampled": 1094930, "num_agent_steps_trained": 1094930}, "sampler_results": {"episode_reward_max": 73.58167375060971, "episode_reward_min": 43.853664555337176, "episode_reward_mean": 61.76459908262937, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.79023929467559, 72.25901178479961, 58.20653171926609, 58.76416562185335, 50.620477645879355, 62.89310492104023, 73.58167375060971, 64.4983209928733, 68.60474475196648, 59.34273785160723, 66.37431727319475, 67.81849223143968, 67.13332826670793, 50.120946362662146, 68.03514066394065, 66.88580811529702, 58.352570983132345, 62.45725142524352, 48.60078961281169, 64.44043993322373, 67.30119806663633, 61.834238086071764, 68.52924677856177, 62.90292711895779, 60.15667192627206, 62.106388355217106, 58.70253970092659, 50.31877462177907, 64.53188808928972, 67.6353620895912, 54.38916013627205, 59.083309640473054, 46.847865028621236, 67.05603121626697, 65.93777872174188, 63.15729720815801, 71.87132085219733, 53.09814192451298, 65.1856914035514, 61.52720749174164, 58.205584255161035, 47.80128352066928, 68.41072145418917, 57.80522032646454, 61.72315564648603, 62.621787469182884, 46.018887123291215, 65.67162837789887, 69.20149596742927, 63.9973888659535, 65.53408857106518, 67.49731696320552, 61.683978647603205, 60.087810345924574, 66.88015297994411, 50.39304181832634, 64.29319965883849, 58.2458853105109, 63.60699098875258, 64.0586783180159, 48.70955905210742, 64.83130282686302, 72.87196991073179, 60.5529748400084, 63.94689595493216, 62.12252778573753, 64.92974615205428, 65.86778302903672, 59.563963066468666, 49.09060871367046, 67.86461602825948, 67.49182804014966, 62.63675865396635, 63.588983428956446, 51.19629361011488, 60.85872963734203, 70.9569256014864, 59.747829166754144, 67.02397876437449, 57.367469656682324, 67.03608688247976, 62.57621737949416, 62.89031068916887, 43.853664555337176, 59.69189253603572, 68.5915480586984, 57.96260180693697, 62.068567782845626, 47.84583496358083, 64.45034725566678, 69.58455547407853, 62.93076360733612, 70.1475828836961, 60.82567276673153, 67.797617696972, 58.14492822383161, 67.08256718147655, 47.47484506322698, 65.76141718713346, 57.830714080535245], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7319091927000843, "mean_inference_ms": 7.941448797623781, "mean_action_processing_ms": 0.5651204590506942, "mean_env_wait_ms": 24.213390589160664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026187896728515625, "StateBufferConnector_ms": 0.03160214424133301, "ViewRequirementAgentConnector_ms": 0.9289023876190186}}, "episode_reward_max": 73.58167375060971, "episode_reward_min": 43.853664555337176, "episode_reward_mean": 61.76459908262937, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.79023929467559, 72.25901178479961, 58.20653171926609, 58.76416562185335, 50.620477645879355, 62.89310492104023, 73.58167375060971, 64.4983209928733, 68.60474475196648, 59.34273785160723, 66.37431727319475, 67.81849223143968, 67.13332826670793, 50.120946362662146, 68.03514066394065, 66.88580811529702, 58.352570983132345, 62.45725142524352, 48.60078961281169, 64.44043993322373, 67.30119806663633, 61.834238086071764, 68.52924677856177, 62.90292711895779, 60.15667192627206, 62.106388355217106, 58.70253970092659, 50.31877462177907, 64.53188808928972, 67.6353620895912, 54.38916013627205, 59.083309640473054, 46.847865028621236, 67.05603121626697, 65.93777872174188, 63.15729720815801, 71.87132085219733, 53.09814192451298, 65.1856914035514, 61.52720749174164, 58.205584255161035, 47.80128352066928, 68.41072145418917, 57.80522032646454, 61.72315564648603, 62.621787469182884, 46.018887123291215, 65.67162837789887, 69.20149596742927, 63.9973888659535, 65.53408857106518, 67.49731696320552, 61.683978647603205, 60.087810345924574, 66.88015297994411, 50.39304181832634, 64.29319965883849, 58.2458853105109, 63.60699098875258, 64.0586783180159, 48.70955905210742, 64.83130282686302, 72.87196991073179, 60.5529748400084, 63.94689595493216, 62.12252778573753, 64.92974615205428, 65.86778302903672, 59.563963066468666, 49.09060871367046, 67.86461602825948, 67.49182804014966, 62.63675865396635, 63.588983428956446, 51.19629361011488, 60.85872963734203, 70.9569256014864, 59.747829166754144, 67.02397876437449, 57.367469656682324, 67.03608688247976, 62.57621737949416, 62.89031068916887, 43.853664555337176, 59.69189253603572, 68.5915480586984, 57.96260180693697, 62.068567782845626, 47.84583496358083, 64.45034725566678, 69.58455547407853, 62.93076360733612, 70.1475828836961, 60.82567276673153, 67.797617696972, 58.14492822383161, 67.08256718147655, 47.47484506322698, 65.76141718713346, 57.830714080535245], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7319091927000843, "mean_inference_ms": 7.941448797623781, "mean_action_processing_ms": 0.5651204590506942, "mean_env_wait_ms": 24.213390589160664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026187896728515625, "StateBufferConnector_ms": 0.03160214424133301, "ViewRequirementAgentConnector_ms": 0.9289023876190186}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1094930, "num_agent_steps_trained": 1094930, "num_env_steps_sampled": 1094930, "num_env_steps_trained": 1094930, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 233.12487532193163, "num_env_steps_trained_throughput_per_sec": 233.12487532193163, "timesteps_total": 1094930, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1094930, "timers": {"training_iteration_time_ms": 69368.274, "sample_time_ms": 43318.0, "load_time_ms": 2817.981, "load_throughput": 5549.364, "learn_time_ms": 22533.184, "learn_throughput": 693.999, "synch_weights_time_ms": 552.792}, "counters": {"num_env_steps_sampled": 1094930, "num_env_steps_trained": 1094930, "num_agent_steps_sampled": 1094930, "num_agent_steps_trained": 1094930}, "done": false, "episodes_total": 1094, "training_iteration": 78, "trial_id": "837cb_00000", "date": "2025-06-07_18-49-26", "timestamp": 1749314966, "time_this_iter_s": 67.09558463096619, "time_total_s": 5019.444051980972, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5019.444051980972, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 66.94615384615383, "ram_util_percent": 88.99615384615385, "gpu_util_percent0": 0.215, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.905070000000002e-05, "total_loss": -0.07338259137743576, "policy_loss": -0.004034392509731167, "vf_loss": 0.018196017154153775, "vf_explained_var": 0.949316941391338, "kl": 0.016406245894404474, "entropy": 15.611066929210317, "entropy_coeff": 0.004857605}, "model": {}, "num_grad_updates_lifetime": 38815.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1110568, "num_env_steps_trained": 1110568, "num_agent_steps_sampled": 1110568, "num_agent_steps_trained": 1110568}, "sampler_results": {"episode_reward_max": 72.87196991073179, "episode_reward_min": 35.98722275722136, "episode_reward_mean": 61.24110176457003, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.03514066394065, 66.88580811529702, 58.352570983132345, 62.45725142524352, 48.60078961281169, 64.44043993322373, 67.30119806663633, 61.834238086071764, 68.52924677856177, 62.90292711895779, 60.15667192627206, 62.106388355217106, 58.70253970092659, 50.31877462177907, 64.53188808928972, 67.6353620895912, 54.38916013627205, 59.083309640473054, 46.847865028621236, 67.05603121626697, 65.93777872174188, 63.15729720815801, 71.87132085219733, 53.09814192451298, 65.1856914035514, 61.52720749174164, 58.205584255161035, 47.80128352066928, 68.41072145418917, 57.80522032646454, 61.72315564648603, 62.621787469182884, 46.018887123291215, 65.67162837789887, 69.20149596742927, 63.9973888659535, 65.53408857106518, 67.49731696320552, 61.683978647603205, 60.087810345924574, 66.88015297994411, 50.39304181832634, 64.29319965883849, 58.2458853105109, 63.60699098875258, 64.0586783180159, 48.70955905210742, 64.83130282686302, 72.87196991073179, 60.5529748400084, 63.94689595493216, 62.12252778573753, 64.92974615205428, 65.86778302903672, 59.563963066468666, 49.09060871367046, 67.86461602825948, 67.49182804014966, 62.63675865396635, 63.588983428956446, 51.19629361011488, 60.85872963734203, 70.9569256014864, 59.747829166754144, 67.02397876437449, 57.367469656682324, 67.03608688247976, 62.57621737949416, 62.89031068916887, 43.853664555337176, 59.69189253603572, 68.5915480586984, 57.96260180693697, 62.068567782845626, 47.84583496358083, 64.45034725566678, 69.58455547407853, 62.93076360733612, 70.1475828836961, 60.82567276673153, 67.797617696972, 58.14492822383161, 67.08256718147655, 47.47484506322698, 65.76141718713346, 57.830714080535245, 55.91497516955883, 62.58421973163385, 44.950860962739526, 56.56476019898713, 68.28586765726563, 57.94569172266076, 70.07427623374168, 60.44973252187839, 66.05643563324173, 61.44146297120678, 66.18505512317584, 35.98722275722136, 63.64504002492767, 63.57275995440396], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7341358996216956, "mean_inference_ms": 7.944173849757384, "mean_action_processing_ms": 0.5652294040322666, "mean_env_wait_ms": 24.212433293853742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0311276912689209, "StateBufferConnector_ms": 0.03562116622924805, "ViewRequirementAgentConnector_ms": 0.9061872959136963}}, "episode_reward_max": 72.87196991073179, "episode_reward_min": 35.98722275722136, "episode_reward_mean": 61.24110176457003, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [68.03514066394065, 66.88580811529702, 58.352570983132345, 62.45725142524352, 48.60078961281169, 64.44043993322373, 67.30119806663633, 61.834238086071764, 68.52924677856177, 62.90292711895779, 60.15667192627206, 62.106388355217106, 58.70253970092659, 50.31877462177907, 64.53188808928972, 67.6353620895912, 54.38916013627205, 59.083309640473054, 46.847865028621236, 67.05603121626697, 65.93777872174188, 63.15729720815801, 71.87132085219733, 53.09814192451298, 65.1856914035514, 61.52720749174164, 58.205584255161035, 47.80128352066928, 68.41072145418917, 57.80522032646454, 61.72315564648603, 62.621787469182884, 46.018887123291215, 65.67162837789887, 69.20149596742927, 63.9973888659535, 65.53408857106518, 67.49731696320552, 61.683978647603205, 60.087810345924574, 66.88015297994411, 50.39304181832634, 64.29319965883849, 58.2458853105109, 63.60699098875258, 64.0586783180159, 48.70955905210742, 64.83130282686302, 72.87196991073179, 60.5529748400084, 63.94689595493216, 62.12252778573753, 64.92974615205428, 65.86778302903672, 59.563963066468666, 49.09060871367046, 67.86461602825948, 67.49182804014966, 62.63675865396635, 63.588983428956446, 51.19629361011488, 60.85872963734203, 70.9569256014864, 59.747829166754144, 67.02397876437449, 57.367469656682324, 67.03608688247976, 62.57621737949416, 62.89031068916887, 43.853664555337176, 59.69189253603572, 68.5915480586984, 57.96260180693697, 62.068567782845626, 47.84583496358083, 64.45034725566678, 69.58455547407853, 62.93076360733612, 70.1475828836961, 60.82567276673153, 67.797617696972, 58.14492822383161, 67.08256718147655, 47.47484506322698, 65.76141718713346, 57.830714080535245, 55.91497516955883, 62.58421973163385, 44.950860962739526, 56.56476019898713, 68.28586765726563, 57.94569172266076, 70.07427623374168, 60.44973252187839, 66.05643563324173, 61.44146297120678, 66.18505512317584, 35.98722275722136, 63.64504002492767, 63.57275995440396], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7341358996216956, "mean_inference_ms": 7.944173849757384, "mean_action_processing_ms": 0.5652294040322666, "mean_env_wait_ms": 24.212433293853742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0311276912689209, "StateBufferConnector_ms": 0.03562116622924805, "ViewRequirementAgentConnector_ms": 0.9061872959136963}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1110568, "num_agent_steps_trained": 1110568, "num_env_steps_sampled": 1110568, "num_env_steps_trained": 1110568, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 234.48061172444494, "num_env_steps_trained_throughput_per_sec": 234.48061172444494, "timesteps_total": 1110568, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1110568, "timers": {"training_iteration_time_ms": 68987.809, "sample_time_ms": 43119.935, "load_time_ms": 2749.316, "load_throughput": 5687.959, "learn_time_ms": 22465.281, "learn_throughput": 696.096, "synch_weights_time_ms": 508.257}, "counters": {"num_env_steps_sampled": 1110568, "num_env_steps_trained": 1110568, "num_agent_steps_sampled": 1110568, "num_agent_steps_trained": 1110568}, "done": false, "episodes_total": 1108, "training_iteration": 79, "trial_id": "837cb_00000", "date": "2025-06-07_18-50-33", "timestamp": 1749315033, "time_this_iter_s": 66.71224927902222, "time_total_s": 5086.1563012599945, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5086.1563012599945, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 65.31538461538463, "ram_util_percent": 89.0448717948718, "gpu_util_percent0": 0.22307692307692306, "vram_util_percent0": 0.9650065104166671}}
{"evaluation": {"sampler_results": {"episode_reward_max": -4.887013862742262, "episode_reward_min": -5.754685384693179, "episode_reward_mean": -5.505597930653847, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.731853964462408, -5.5392652230437935, -5.754685384693179, -4.887013862742262, -5.615171218327597], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8785268031875493, "mean_inference_ms": 4.070802156634668, "mean_action_processing_ms": 0.30332537323151443, "mean_env_wait_ms": 13.013659021061184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3874969482421875}}, "episode_reward_max": -4.887013862742262, "episode_reward_min": -5.754685384693179, "episode_reward_mean": -5.505597930653847, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.731853964462408, -5.5392652230437935, -5.754685384693179, -4.887013862742262, -5.615171218327597], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8785268031875493, "mean_inference_ms": 4.070802156634668, "mean_action_processing_ms": 0.30332537323151443, "mean_env_wait_ms": 13.013659021061184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3874969482421875}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.889432e-05, "total_loss": -0.08369601755910977, "policy_loss": -0.014182749295432586, "vf_loss": 0.016253522046926348, "vf_explained_var": 0.9536363353512504, "kl": 0.01691876768150409, "entropy": 15.6070410676436, "entropy_coeff": 0.004834147999999999}, "model": {}, "num_grad_updates_lifetime": 39365.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1126206, "num_env_steps_trained": 1126206, "num_agent_steps_sampled": 1126206, "num_agent_steps_trained": 1126206}, "sampler_results": {"episode_reward_max": 72.87196991073179, "episode_reward_min": 35.98722275722136, "episode_reward_mean": 61.10460380833034, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.53188808928972, 67.6353620895912, 54.38916013627205, 59.083309640473054, 46.847865028621236, 67.05603121626697, 65.93777872174188, 63.15729720815801, 71.87132085219733, 53.09814192451298, 65.1856914035514, 61.52720749174164, 58.205584255161035, 47.80128352066928, 68.41072145418917, 57.80522032646454, 61.72315564648603, 62.621787469182884, 46.018887123291215, 65.67162837789887, 69.20149596742927, 63.9973888659535, 65.53408857106518, 67.49731696320552, 61.683978647603205, 60.087810345924574, 66.88015297994411, 50.39304181832634, 64.29319965883849, 58.2458853105109, 63.60699098875258, 64.0586783180159, 48.70955905210742, 64.83130282686302, 72.87196991073179, 60.5529748400084, 63.94689595493216, 62.12252778573753, 64.92974615205428, 65.86778302903672, 59.563963066468666, 49.09060871367046, 67.86461602825948, 67.49182804014966, 62.63675865396635, 63.588983428956446, 51.19629361011488, 60.85872963734203, 70.9569256014864, 59.747829166754144, 67.02397876437449, 57.367469656682324, 67.03608688247976, 62.57621737949416, 62.89031068916887, 43.853664555337176, 59.69189253603572, 68.5915480586984, 57.96260180693697, 62.068567782845626, 47.84583496358083, 64.45034725566678, 69.58455547407853, 62.93076360733612, 70.1475828836961, 60.82567276673153, 67.797617696972, 58.14492822383161, 67.08256718147655, 47.47484506322698, 65.76141718713346, 57.830714080535245, 55.91497516955883, 62.58421973163385, 44.950860962739526, 56.56476019898713, 68.28586765726563, 57.94569172266076, 70.07427623374168, 60.44973252187839, 66.05643563324173, 61.44146297120678, 66.18505512317584, 35.98722275722136, 63.64504002492767, 63.57275995440396, 57.544820073211675, 60.17558278287944, 43.91477043622207, 65.16406401768826, 70.82455705595537, 60.17113476464902, 63.46648655879417, 60.75530667273423, 67.25855649020744, 58.280878064204856, 67.32954615477115, 47.028985703602494, 60.79285831098108, 64.26664267819994], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.73616917384306, "mean_inference_ms": 7.9466891978892775, "mean_action_processing_ms": 0.565334781930657, "mean_env_wait_ms": 24.210453794994837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029134035110473633, "StateBufferConnector_ms": 0.03560686111450195, "ViewRequirementAgentConnector_ms": 0.8835971355438232}}, "episode_reward_max": 72.87196991073179, "episode_reward_min": 35.98722275722136, "episode_reward_mean": 61.10460380833034, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.53188808928972, 67.6353620895912, 54.38916013627205, 59.083309640473054, 46.847865028621236, 67.05603121626697, 65.93777872174188, 63.15729720815801, 71.87132085219733, 53.09814192451298, 65.1856914035514, 61.52720749174164, 58.205584255161035, 47.80128352066928, 68.41072145418917, 57.80522032646454, 61.72315564648603, 62.621787469182884, 46.018887123291215, 65.67162837789887, 69.20149596742927, 63.9973888659535, 65.53408857106518, 67.49731696320552, 61.683978647603205, 60.087810345924574, 66.88015297994411, 50.39304181832634, 64.29319965883849, 58.2458853105109, 63.60699098875258, 64.0586783180159, 48.70955905210742, 64.83130282686302, 72.87196991073179, 60.5529748400084, 63.94689595493216, 62.12252778573753, 64.92974615205428, 65.86778302903672, 59.563963066468666, 49.09060871367046, 67.86461602825948, 67.49182804014966, 62.63675865396635, 63.588983428956446, 51.19629361011488, 60.85872963734203, 70.9569256014864, 59.747829166754144, 67.02397876437449, 57.367469656682324, 67.03608688247976, 62.57621737949416, 62.89031068916887, 43.853664555337176, 59.69189253603572, 68.5915480586984, 57.96260180693697, 62.068567782845626, 47.84583496358083, 64.45034725566678, 69.58455547407853, 62.93076360733612, 70.1475828836961, 60.82567276673153, 67.797617696972, 58.14492822383161, 67.08256718147655, 47.47484506322698, 65.76141718713346, 57.830714080535245, 55.91497516955883, 62.58421973163385, 44.950860962739526, 56.56476019898713, 68.28586765726563, 57.94569172266076, 70.07427623374168, 60.44973252187839, 66.05643563324173, 61.44146297120678, 66.18505512317584, 35.98722275722136, 63.64504002492767, 63.57275995440396, 57.544820073211675, 60.17558278287944, 43.91477043622207, 65.16406401768826, 70.82455705595537, 60.17113476464902, 63.46648655879417, 60.75530667273423, 67.25855649020744, 58.280878064204856, 67.32954615477115, 47.028985703602494, 60.79285831098108, 64.26664267819994], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.73616917384306, "mean_inference_ms": 7.9466891978892775, "mean_action_processing_ms": 0.565334781930657, "mean_env_wait_ms": 24.210453794994837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029134035110473633, "StateBufferConnector_ms": 0.03560686111450195, "ViewRequirementAgentConnector_ms": 0.8835971355438232}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1126206, "num_agent_steps_trained": 1126206, "num_env_steps_sampled": 1126206, "num_env_steps_trained": 1126206, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 233.78755460770475, "num_env_steps_trained_throughput_per_sec": 233.78755460770475, "timesteps_total": 1126206, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1126206, "timers": {"training_iteration_time_ms": 67907.567, "sample_time_ms": 42519.451, "load_time_ms": 2450.755, "load_throughput": 6380.89, "learn_time_ms": 22337.517, "learn_throughput": 700.078, "synch_weights_time_ms": 469.833}, "counters": {"num_env_steps_sampled": 1126206, "num_env_steps_trained": 1126206, "num_agent_steps_sampled": 1126206, "num_agent_steps_trained": 1126206}, "done": false, "episodes_total": 1122, "training_iteration": 80, "trial_id": "837cb_00000", "date": "2025-06-07_18-51-59", "timestamp": 1749315119, "time_this_iter_s": 85.6101462841034, "time_total_s": 5171.766447544098, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5171.766447544098, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 55.619801980198005, "ram_util_percent": 88.79900990099013, "gpu_util_percent0": 0.16970297029702971, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.873794e-05, "total_loss": -0.0884828473458236, "policy_loss": -0.018828106601087545, "vf_loss": 0.016347870556214315, "vf_explained_var": 0.9556960979374972, "kl": 0.01734631673327302, "entropy": 15.723988498340953, "entropy_coeff": 0.004810691}, "model": {}, "num_grad_updates_lifetime": 39915.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1141844, "num_env_steps_trained": 1141844, "num_agent_steps_sampled": 1141844, "num_agent_steps_trained": 1141844}, "sampler_results": {"episode_reward_max": 72.87196991073179, "episode_reward_min": 35.98722275722136, "episode_reward_mean": 61.13216673025684, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.41072145418917, 57.80522032646454, 61.72315564648603, 62.621787469182884, 46.018887123291215, 65.67162837789887, 69.20149596742927, 63.9973888659535, 65.53408857106518, 67.49731696320552, 61.683978647603205, 60.087810345924574, 66.88015297994411, 50.39304181832634, 64.29319965883849, 58.2458853105109, 63.60699098875258, 64.0586783180159, 48.70955905210742, 64.83130282686302, 72.87196991073179, 60.5529748400084, 63.94689595493216, 62.12252778573753, 64.92974615205428, 65.86778302903672, 59.563963066468666, 49.09060871367046, 67.86461602825948, 67.49182804014966, 62.63675865396635, 63.588983428956446, 51.19629361011488, 60.85872963734203, 70.9569256014864, 59.747829166754144, 67.02397876437449, 57.367469656682324, 67.03608688247976, 62.57621737949416, 62.89031068916887, 43.853664555337176, 59.69189253603572, 68.5915480586984, 57.96260180693697, 62.068567782845626, 47.84583496358083, 64.45034725566678, 69.58455547407853, 62.93076360733612, 70.1475828836961, 60.82567276673153, 67.797617696972, 58.14492822383161, 67.08256718147655, 47.47484506322698, 65.76141718713346, 57.830714080535245, 55.91497516955883, 62.58421973163385, 44.950860962739526, 56.56476019898713, 68.28586765726563, 57.94569172266076, 70.07427623374168, 60.44973252187839, 66.05643563324173, 61.44146297120678, 66.18505512317584, 35.98722275722136, 63.64504002492767, 63.57275995440396, 57.544820073211675, 60.17558278287944, 43.91477043622207, 65.16406401768826, 70.82455705595537, 60.17113476464902, 63.46648655879417, 60.75530667273423, 67.25855649020744, 58.280878064204856, 67.32954615477115, 47.028985703602494, 60.79285831098108, 64.26664267819994, 62.81119098396523, 57.440557373606325, 47.27328594951334, 57.51745309259596, 58.50187333797787, 63.380907410921004, 70.2310276527021, 62.854354643490154, 65.82809621271711, 61.645308685361755, 62.53761738528389, 49.320415664993305, 64.0109235180462, 65.73120185972435], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7382014031055406, "mean_inference_ms": 7.9489615162996135, "mean_action_processing_ms": 0.5654161540140631, "mean_env_wait_ms": 24.207899049105514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027044057846069336, "StateBufferConnector_ms": 0.030035972595214844, "ViewRequirementAgentConnector_ms": 0.898423433303833}}, "episode_reward_max": 72.87196991073179, "episode_reward_min": 35.98722275722136, "episode_reward_mean": 61.13216673025684, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [68.41072145418917, 57.80522032646454, 61.72315564648603, 62.621787469182884, 46.018887123291215, 65.67162837789887, 69.20149596742927, 63.9973888659535, 65.53408857106518, 67.49731696320552, 61.683978647603205, 60.087810345924574, 66.88015297994411, 50.39304181832634, 64.29319965883849, 58.2458853105109, 63.60699098875258, 64.0586783180159, 48.70955905210742, 64.83130282686302, 72.87196991073179, 60.5529748400084, 63.94689595493216, 62.12252778573753, 64.92974615205428, 65.86778302903672, 59.563963066468666, 49.09060871367046, 67.86461602825948, 67.49182804014966, 62.63675865396635, 63.588983428956446, 51.19629361011488, 60.85872963734203, 70.9569256014864, 59.747829166754144, 67.02397876437449, 57.367469656682324, 67.03608688247976, 62.57621737949416, 62.89031068916887, 43.853664555337176, 59.69189253603572, 68.5915480586984, 57.96260180693697, 62.068567782845626, 47.84583496358083, 64.45034725566678, 69.58455547407853, 62.93076360733612, 70.1475828836961, 60.82567276673153, 67.797617696972, 58.14492822383161, 67.08256718147655, 47.47484506322698, 65.76141718713346, 57.830714080535245, 55.91497516955883, 62.58421973163385, 44.950860962739526, 56.56476019898713, 68.28586765726563, 57.94569172266076, 70.07427623374168, 60.44973252187839, 66.05643563324173, 61.44146297120678, 66.18505512317584, 35.98722275722136, 63.64504002492767, 63.57275995440396, 57.544820073211675, 60.17558278287944, 43.91477043622207, 65.16406401768826, 70.82455705595537, 60.17113476464902, 63.46648655879417, 60.75530667273423, 67.25855649020744, 58.280878064204856, 67.32954615477115, 47.028985703602494, 60.79285831098108, 64.26664267819994, 62.81119098396523, 57.440557373606325, 47.27328594951334, 57.51745309259596, 58.50187333797787, 63.380907410921004, 70.2310276527021, 62.854354643490154, 65.82809621271711, 61.645308685361755, 62.53761738528389, 49.320415664993305, 64.0109235180462, 65.73120185972435], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7382014031055406, "mean_inference_ms": 7.9489615162996135, "mean_action_processing_ms": 0.5654161540140631, "mean_env_wait_ms": 24.207899049105514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027044057846069336, "StateBufferConnector_ms": 0.030035972595214844, "ViewRequirementAgentConnector_ms": 0.898423433303833}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1141844, "num_agent_steps_trained": 1141844, "num_env_steps_sampled": 1141844, "num_env_steps_trained": 1141844, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 233.31122337539315, "num_env_steps_trained_throughput_per_sec": 233.31122337539315, "timesteps_total": 1141844, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1141844, "timers": {"training_iteration_time_ms": 67350.057, "sample_time_ms": 42163.063, "load_time_ms": 2329.637, "load_throughput": 6712.633, "learn_time_ms": 22240.929, "learn_throughput": 703.118, "synch_weights_time_ms": 482.785}, "counters": {"num_env_steps_sampled": 1141844, "num_env_steps_trained": 1141844, "num_agent_steps_sampled": 1141844, "num_agent_steps_trained": 1141844}, "done": false, "episodes_total": 1136, "training_iteration": 81, "trial_id": "837cb_00000", "date": "2025-06-07_18-53-06", "timestamp": 1749315186, "time_this_iter_s": 67.04225564002991, "time_total_s": 5238.808703184128, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5238.808703184128, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 64.94177215189875, "ram_util_percent": 89.84683544303797, "gpu_util_percent0": 0.21848101265822784, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.858156000000001e-05, "total_loss": -0.10012703926873986, "policy_loss": -0.03110226655109066, "vf_loss": 0.01797661570112475, "vf_explained_var": 0.9540771835500543, "kl": 0.01688059578173667, "entropy": 15.765428100932729, "entropy_coeff": 0.004787234}, "model": {}, "num_grad_updates_lifetime": 40465.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1157482, "num_env_steps_trained": 1157482, "num_agent_steps_sampled": 1157482, "num_agent_steps_trained": 1157482}, "sampler_results": {"episode_reward_max": 72.87196991073179, "episode_reward_min": 35.98722275722136, "episode_reward_mean": 61.029285016557985, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.29319965883849, 58.2458853105109, 63.60699098875258, 64.0586783180159, 48.70955905210742, 64.83130282686302, 72.87196991073179, 60.5529748400084, 63.94689595493216, 62.12252778573753, 64.92974615205428, 65.86778302903672, 59.563963066468666, 49.09060871367046, 67.86461602825948, 67.49182804014966, 62.63675865396635, 63.588983428956446, 51.19629361011488, 60.85872963734203, 70.9569256014864, 59.747829166754144, 67.02397876437449, 57.367469656682324, 67.03608688247976, 62.57621737949416, 62.89031068916887, 43.853664555337176, 59.69189253603572, 68.5915480586984, 57.96260180693697, 62.068567782845626, 47.84583496358083, 64.45034725566678, 69.58455547407853, 62.93076360733612, 70.1475828836961, 60.82567276673153, 67.797617696972, 58.14492822383161, 67.08256718147655, 47.47484506322698, 65.76141718713346, 57.830714080535245, 55.91497516955883, 62.58421973163385, 44.950860962739526, 56.56476019898713, 68.28586765726563, 57.94569172266076, 70.07427623374168, 60.44973252187839, 66.05643563324173, 61.44146297120678, 66.18505512317584, 35.98722275722136, 63.64504002492767, 63.57275995440396, 57.544820073211675, 60.17558278287944, 43.91477043622207, 65.16406401768826, 70.82455705595537, 60.17113476464902, 63.46648655879417, 60.75530667273423, 67.25855649020744, 58.280878064204856, 67.32954615477115, 47.028985703602494, 60.79285831098108, 64.26664267819994, 62.81119098396523, 57.440557373606325, 47.27328594951334, 57.51745309259596, 58.50187333797787, 63.380907410921004, 70.2310276527021, 62.854354643490154, 65.82809621271711, 61.645308685361755, 62.53761738528389, 49.320415664993305, 64.0109235180462, 65.73120185972435, 58.77384974421543, 65.27861627011289, 47.95697498011981, 60.81926778216972, 71.53730063385923, 56.74697520709216, 65.68767066166876, 63.04421205000336, 69.82407268301526, 65.83724952994255, 61.744665084000566, 46.52323289746569, 62.438920112240616, 61.025495551173314], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7407227755833956, "mean_inference_ms": 7.951162051029653, "mean_action_processing_ms": 0.5654453330865957, "mean_env_wait_ms": 24.205250598263497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032094717025756836, "StateBufferConnector_ms": 0.03285980224609375, "ViewRequirementAgentConnector_ms": 0.9203026294708252}}, "episode_reward_max": 72.87196991073179, "episode_reward_min": 35.98722275722136, "episode_reward_mean": 61.029285016557985, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.29319965883849, 58.2458853105109, 63.60699098875258, 64.0586783180159, 48.70955905210742, 64.83130282686302, 72.87196991073179, 60.5529748400084, 63.94689595493216, 62.12252778573753, 64.92974615205428, 65.86778302903672, 59.563963066468666, 49.09060871367046, 67.86461602825948, 67.49182804014966, 62.63675865396635, 63.588983428956446, 51.19629361011488, 60.85872963734203, 70.9569256014864, 59.747829166754144, 67.02397876437449, 57.367469656682324, 67.03608688247976, 62.57621737949416, 62.89031068916887, 43.853664555337176, 59.69189253603572, 68.5915480586984, 57.96260180693697, 62.068567782845626, 47.84583496358083, 64.45034725566678, 69.58455547407853, 62.93076360733612, 70.1475828836961, 60.82567276673153, 67.797617696972, 58.14492822383161, 67.08256718147655, 47.47484506322698, 65.76141718713346, 57.830714080535245, 55.91497516955883, 62.58421973163385, 44.950860962739526, 56.56476019898713, 68.28586765726563, 57.94569172266076, 70.07427623374168, 60.44973252187839, 66.05643563324173, 61.44146297120678, 66.18505512317584, 35.98722275722136, 63.64504002492767, 63.57275995440396, 57.544820073211675, 60.17558278287944, 43.91477043622207, 65.16406401768826, 70.82455705595537, 60.17113476464902, 63.46648655879417, 60.75530667273423, 67.25855649020744, 58.280878064204856, 67.32954615477115, 47.028985703602494, 60.79285831098108, 64.26664267819994, 62.81119098396523, 57.440557373606325, 47.27328594951334, 57.51745309259596, 58.50187333797787, 63.380907410921004, 70.2310276527021, 62.854354643490154, 65.82809621271711, 61.645308685361755, 62.53761738528389, 49.320415664993305, 64.0109235180462, 65.73120185972435, 58.77384974421543, 65.27861627011289, 47.95697498011981, 60.81926778216972, 71.53730063385923, 56.74697520709216, 65.68767066166876, 63.04421205000336, 69.82407268301526, 65.83724952994255, 61.744665084000566, 46.52323289746569, 62.438920112240616, 61.025495551173314], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7407227755833956, "mean_inference_ms": 7.951162051029653, "mean_action_processing_ms": 0.5654453330865957, "mean_env_wait_ms": 24.205250598263497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032094717025756836, "StateBufferConnector_ms": 0.03285980224609375, "ViewRequirementAgentConnector_ms": 0.9203026294708252}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1157482, "num_agent_steps_trained": 1157482, "num_env_steps_sampled": 1157482, "num_env_steps_trained": 1157482, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 234.3338031714016, "num_env_steps_trained_throughput_per_sec": 234.3338031714016, "timesteps_total": 1157482, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1157482, "timers": {"training_iteration_time_ms": 66978.354, "sample_time_ms": 41829.381, "load_time_ms": 2274.682, "load_throughput": 6874.806, "learn_time_ms": 22260.588, "learn_throughput": 702.497, "synch_weights_time_ms": 486.996}, "counters": {"num_env_steps_sampled": 1157482, "num_env_steps_trained": 1157482, "num_agent_steps_sampled": 1157482, "num_agent_steps_trained": 1157482}, "done": false, "episodes_total": 1150, "training_iteration": 82, "trial_id": "837cb_00000", "date": "2025-06-07_18-54-13", "timestamp": 1749315253, "time_this_iter_s": 66.75792121887207, "time_total_s": 5305.566624403, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5305.566624403, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 65.0269230769231, "ram_util_percent": 89.4923076923077, "gpu_util_percent0": 0.21871794871794875, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.842518e-05, "total_loss": -0.09913214510730044, "policy_loss": -0.030689703719267113, "vf_loss": 0.018731975684535097, "vf_explained_var": 0.9528248053247278, "kl": 0.017074306657017122, "entropy": 15.770927304354581, "entropy_coeff": 0.004763777}, "model": {}, "num_grad_updates_lifetime": 41015.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1173120, "num_env_steps_trained": 1173120, "num_agent_steps_sampled": 1173120, "num_agent_steps_trained": 1173120}, "sampler_results": {"episode_reward_max": 71.53730063385923, "episode_reward_min": 35.98722275722136, "episode_reward_mean": 60.775086750957335, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.86461602825948, 67.49182804014966, 62.63675865396635, 63.588983428956446, 51.19629361011488, 60.85872963734203, 70.9569256014864, 59.747829166754144, 67.02397876437449, 57.367469656682324, 67.03608688247976, 62.57621737949416, 62.89031068916887, 43.853664555337176, 59.69189253603572, 68.5915480586984, 57.96260180693697, 62.068567782845626, 47.84583496358083, 64.45034725566678, 69.58455547407853, 62.93076360733612, 70.1475828836961, 60.82567276673153, 67.797617696972, 58.14492822383161, 67.08256718147655, 47.47484506322698, 65.76141718713346, 57.830714080535245, 55.91497516955883, 62.58421973163385, 44.950860962739526, 56.56476019898713, 68.28586765726563, 57.94569172266076, 70.07427623374168, 60.44973252187839, 66.05643563324173, 61.44146297120678, 66.18505512317584, 35.98722275722136, 63.64504002492767, 63.57275995440396, 57.544820073211675, 60.17558278287944, 43.91477043622207, 65.16406401768826, 70.82455705595537, 60.17113476464902, 63.46648655879417, 60.75530667273423, 67.25855649020744, 58.280878064204856, 67.32954615477115, 47.028985703602494, 60.79285831098108, 64.26664267819994, 62.81119098396523, 57.440557373606325, 47.27328594951334, 57.51745309259596, 58.50187333797787, 63.380907410921004, 70.2310276527021, 62.854354643490154, 65.82809621271711, 61.645308685361755, 62.53761738528389, 49.320415664993305, 64.0109235180462, 65.73120185972435, 58.77384974421543, 65.27861627011289, 47.95697498011981, 60.81926778216972, 71.53730063385923, 56.74697520709216, 65.68767066166876, 63.04421205000336, 69.82407268301526, 65.83724952994255, 61.744665084000566, 46.52323289746569, 62.438920112240616, 61.025495551173314, 60.29589580079036, 65.93091650544619, 51.88799914086254, 62.155679998228976, 62.03075954307725, 51.326179944561666, 70.95227363069543, 58.853070661405916, 63.736955204231066, 63.18321772549067, 58.30536741140878, 43.985514982578124, 59.97427606129703, 64.65415243758862], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.743170901497032, "mean_inference_ms": 7.953446546636303, "mean_action_processing_ms": 0.5654705800822044, "mean_env_wait_ms": 24.202203528169147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035016775131225586, "StateBufferConnector_ms": 0.033945560455322266, "ViewRequirementAgentConnector_ms": 0.9204864501953125}}, "episode_reward_max": 71.53730063385923, "episode_reward_min": 35.98722275722136, "episode_reward_mean": 60.775086750957335, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [67.86461602825948, 67.49182804014966, 62.63675865396635, 63.588983428956446, 51.19629361011488, 60.85872963734203, 70.9569256014864, 59.747829166754144, 67.02397876437449, 57.367469656682324, 67.03608688247976, 62.57621737949416, 62.89031068916887, 43.853664555337176, 59.69189253603572, 68.5915480586984, 57.96260180693697, 62.068567782845626, 47.84583496358083, 64.45034725566678, 69.58455547407853, 62.93076360733612, 70.1475828836961, 60.82567276673153, 67.797617696972, 58.14492822383161, 67.08256718147655, 47.47484506322698, 65.76141718713346, 57.830714080535245, 55.91497516955883, 62.58421973163385, 44.950860962739526, 56.56476019898713, 68.28586765726563, 57.94569172266076, 70.07427623374168, 60.44973252187839, 66.05643563324173, 61.44146297120678, 66.18505512317584, 35.98722275722136, 63.64504002492767, 63.57275995440396, 57.544820073211675, 60.17558278287944, 43.91477043622207, 65.16406401768826, 70.82455705595537, 60.17113476464902, 63.46648655879417, 60.75530667273423, 67.25855649020744, 58.280878064204856, 67.32954615477115, 47.028985703602494, 60.79285831098108, 64.26664267819994, 62.81119098396523, 57.440557373606325, 47.27328594951334, 57.51745309259596, 58.50187333797787, 63.380907410921004, 70.2310276527021, 62.854354643490154, 65.82809621271711, 61.645308685361755, 62.53761738528389, 49.320415664993305, 64.0109235180462, 65.73120185972435, 58.77384974421543, 65.27861627011289, 47.95697498011981, 60.81926778216972, 71.53730063385923, 56.74697520709216, 65.68767066166876, 63.04421205000336, 69.82407268301526, 65.83724952994255, 61.744665084000566, 46.52323289746569, 62.438920112240616, 61.025495551173314, 60.29589580079036, 65.93091650544619, 51.88799914086254, 62.155679998228976, 62.03075954307725, 51.326179944561666, 70.95227363069543, 58.853070661405916, 63.736955204231066, 63.18321772549067, 58.30536741140878, 43.985514982578124, 59.97427606129703, 64.65415243758862], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.743170901497032, "mean_inference_ms": 7.953446546636303, "mean_action_processing_ms": 0.5654705800822044, "mean_env_wait_ms": 24.202203528169147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035016775131225586, "StateBufferConnector_ms": 0.033945560455322266, "ViewRequirementAgentConnector_ms": 0.9204864501953125}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1173120, "num_agent_steps_trained": 1173120, "num_env_steps_sampled": 1173120, "num_env_steps_trained": 1173120, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 232.44913078862535, "num_env_steps_trained_throughput_per_sec": 232.44913078862535, "timesteps_total": 1173120, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1173120, "timers": {"training_iteration_time_ms": 67004.706, "sample_time_ms": 41854.891, "load_time_ms": 2279.333, "load_throughput": 6860.778, "learn_time_ms": 22257.58, "learn_throughput": 702.592, "synch_weights_time_ms": 480.694}, "counters": {"num_env_steps_sampled": 1173120, "num_env_steps_trained": 1173120, "num_agent_steps_sampled": 1173120, "num_agent_steps_trained": 1173120}, "done": false, "episodes_total": 1164, "training_iteration": 83, "trial_id": "837cb_00000", "date": "2025-06-07_18-55-20", "timestamp": 1749315320, "time_this_iter_s": 67.29091048240662, "time_total_s": 5372.8575348854065, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5372.8575348854065, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 65.9974358974359, "ram_util_percent": 89.69102564102563, "gpu_util_percent0": 0.221025641025641, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.82688e-05, "total_loss": -0.11033207329286432, "policy_loss": -0.041137044886204836, "vf_loss": 0.015716727660884233, "vf_explained_var": 0.956981584592299, "kl": 0.017348494611655055, "entropy": 15.82051967274059, "entropy_coeff": 0.004740320000000001}, "model": {}, "num_grad_updates_lifetime": 41565.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1188758, "num_env_steps_trained": 1188758, "num_agent_steps_sampled": 1188758, "num_agent_steps_trained": 1188758}, "sampler_results": {"episode_reward_max": 71.58897166168643, "episode_reward_min": 35.98722275722136, "episode_reward_mean": 60.724869413447706, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.69189253603572, 68.5915480586984, 57.96260180693697, 62.068567782845626, 47.84583496358083, 64.45034725566678, 69.58455547407853, 62.93076360733612, 70.1475828836961, 60.82567276673153, 67.797617696972, 58.14492822383161, 67.08256718147655, 47.47484506322698, 65.76141718713346, 57.830714080535245, 55.91497516955883, 62.58421973163385, 44.950860962739526, 56.56476019898713, 68.28586765726563, 57.94569172266076, 70.07427623374168, 60.44973252187839, 66.05643563324173, 61.44146297120678, 66.18505512317584, 35.98722275722136, 63.64504002492767, 63.57275995440396, 57.544820073211675, 60.17558278287944, 43.91477043622207, 65.16406401768826, 70.82455705595537, 60.17113476464902, 63.46648655879417, 60.75530667273423, 67.25855649020744, 58.280878064204856, 67.32954615477115, 47.028985703602494, 60.79285831098108, 64.26664267819994, 62.81119098396523, 57.440557373606325, 47.27328594951334, 57.51745309259596, 58.50187333797787, 63.380907410921004, 70.2310276527021, 62.854354643490154, 65.82809621271711, 61.645308685361755, 62.53761738528389, 49.320415664993305, 64.0109235180462, 65.73120185972435, 58.77384974421543, 65.27861627011289, 47.95697498011981, 60.81926778216972, 71.53730063385923, 56.74697520709216, 65.68767066166876, 63.04421205000336, 69.82407268301526, 65.83724952994255, 61.744665084000566, 46.52323289746569, 62.438920112240616, 61.025495551173314, 60.29589580079036, 65.93091650544619, 51.88799914086254, 62.155679998228976, 62.03075954307725, 51.326179944561666, 70.95227363069543, 58.853070661405916, 63.736955204231066, 63.18321772549067, 58.30536741140878, 43.985514982578124, 59.97427606129703, 64.65415243758862, 49.35315749183375, 62.22043382515529, 46.633726673724624, 65.305542211803, 68.5762097346322, 60.96689102206869, 71.58897166168643, 63.68982688548055, 63.211992018752255, 62.654354487799324, 64.64647490823765, 48.61329509249159, 66.8873610141301, 65.71972131580814], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7454761699058214, "mean_inference_ms": 7.95530559887704, "mean_action_processing_ms": 0.5654674721410379, "mean_env_wait_ms": 24.19867007865727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03698372840881348, "StateBufferConnector_ms": 0.03393983840942383, "ViewRequirementAgentConnector_ms": 0.9301328659057617}}, "episode_reward_max": 71.58897166168643, "episode_reward_min": 35.98722275722136, "episode_reward_mean": 60.724869413447706, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.69189253603572, 68.5915480586984, 57.96260180693697, 62.068567782845626, 47.84583496358083, 64.45034725566678, 69.58455547407853, 62.93076360733612, 70.1475828836961, 60.82567276673153, 67.797617696972, 58.14492822383161, 67.08256718147655, 47.47484506322698, 65.76141718713346, 57.830714080535245, 55.91497516955883, 62.58421973163385, 44.950860962739526, 56.56476019898713, 68.28586765726563, 57.94569172266076, 70.07427623374168, 60.44973252187839, 66.05643563324173, 61.44146297120678, 66.18505512317584, 35.98722275722136, 63.64504002492767, 63.57275995440396, 57.544820073211675, 60.17558278287944, 43.91477043622207, 65.16406401768826, 70.82455705595537, 60.17113476464902, 63.46648655879417, 60.75530667273423, 67.25855649020744, 58.280878064204856, 67.32954615477115, 47.028985703602494, 60.79285831098108, 64.26664267819994, 62.81119098396523, 57.440557373606325, 47.27328594951334, 57.51745309259596, 58.50187333797787, 63.380907410921004, 70.2310276527021, 62.854354643490154, 65.82809621271711, 61.645308685361755, 62.53761738528389, 49.320415664993305, 64.0109235180462, 65.73120185972435, 58.77384974421543, 65.27861627011289, 47.95697498011981, 60.81926778216972, 71.53730063385923, 56.74697520709216, 65.68767066166876, 63.04421205000336, 69.82407268301526, 65.83724952994255, 61.744665084000566, 46.52323289746569, 62.438920112240616, 61.025495551173314, 60.29589580079036, 65.93091650544619, 51.88799914086254, 62.155679998228976, 62.03075954307725, 51.326179944561666, 70.95227363069543, 58.853070661405916, 63.736955204231066, 63.18321772549067, 58.30536741140878, 43.985514982578124, 59.97427606129703, 64.65415243758862, 49.35315749183375, 62.22043382515529, 46.633726673724624, 65.305542211803, 68.5762097346322, 60.96689102206869, 71.58897166168643, 63.68982688548055, 63.211992018752255, 62.654354487799324, 64.64647490823765, 48.61329509249159, 66.8873610141301, 65.71972131580814], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7454761699058214, "mean_inference_ms": 7.95530559887704, "mean_action_processing_ms": 0.5654674721410379, "mean_env_wait_ms": 24.19867007865727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03698372840881348, "StateBufferConnector_ms": 0.03393983840942383, "ViewRequirementAgentConnector_ms": 0.9301328659057617}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188758, "num_agent_steps_trained": 1188758, "num_env_steps_sampled": 1188758, "num_env_steps_trained": 1188758, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 234.33010113533186, "num_env_steps_trained_throughput_per_sec": 234.33010113533186, "timesteps_total": 1188758, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1188758, "timers": {"training_iteration_time_ms": 66942.136, "sample_time_ms": 41786.283, "load_time_ms": 2263.765, "load_throughput": 6907.961, "learn_time_ms": 22282.054, "learn_throughput": 701.82, "synch_weights_time_ms": 483.64}, "counters": {"num_env_steps_sampled": 1188758, "num_env_steps_trained": 1188758, "num_agent_steps_sampled": 1188758, "num_agent_steps_trained": 1188758}, "done": false, "episodes_total": 1178, "training_iteration": 84, "trial_id": "837cb_00000", "date": "2025-06-07_18-56-27", "timestamp": 1749315387, "time_this_iter_s": 66.75291538238525, "time_total_s": 5439.610450267792, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5439.610450267792, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 65.57307692307693, "ram_util_percent": 89.70256410256412, "gpu_util_percent0": 0.21564102564102564, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.811241999999999e-05, "total_loss": -0.11228692128963302, "policy_loss": -0.042896116059921705, "vf_loss": 0.013249336548403583, "vf_explained_var": 0.9582374535907399, "kl": 0.01752748171968485, "entropy": 15.78614297693426, "entropy_coeff": 0.004716863000000001}, "model": {}, "num_grad_updates_lifetime": 42115.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1204396, "num_env_steps_trained": 1204396, "num_agent_steps_sampled": 1204396, "num_agent_steps_trained": 1204396}, "sampler_results": {"episode_reward_max": 71.58897166168643, "episode_reward_min": 35.98722275722136, "episode_reward_mean": 60.69552359330103, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.76141718713346, 57.830714080535245, 55.91497516955883, 62.58421973163385, 44.950860962739526, 56.56476019898713, 68.28586765726563, 57.94569172266076, 70.07427623374168, 60.44973252187839, 66.05643563324173, 61.44146297120678, 66.18505512317584, 35.98722275722136, 63.64504002492767, 63.57275995440396, 57.544820073211675, 60.17558278287944, 43.91477043622207, 65.16406401768826, 70.82455705595537, 60.17113476464902, 63.46648655879417, 60.75530667273423, 67.25855649020744, 58.280878064204856, 67.32954615477115, 47.028985703602494, 60.79285831098108, 64.26664267819994, 62.81119098396523, 57.440557373606325, 47.27328594951334, 57.51745309259596, 58.50187333797787, 63.380907410921004, 70.2310276527021, 62.854354643490154, 65.82809621271711, 61.645308685361755, 62.53761738528389, 49.320415664993305, 64.0109235180462, 65.73120185972435, 58.77384974421543, 65.27861627011289, 47.95697498011981, 60.81926778216972, 71.53730063385923, 56.74697520709216, 65.68767066166876, 63.04421205000336, 69.82407268301526, 65.83724952994255, 61.744665084000566, 46.52323289746569, 62.438920112240616, 61.025495551173314, 60.29589580079036, 65.93091650544619, 51.88799914086254, 62.155679998228976, 62.03075954307725, 51.326179944561666, 70.95227363069543, 58.853070661405916, 63.736955204231066, 63.18321772549067, 58.30536741140878, 43.985514982578124, 59.97427606129703, 64.65415243758862, 49.35315749183375, 62.22043382515529, 46.633726673724624, 65.305542211803, 68.5762097346322, 60.96689102206869, 71.58897166168643, 63.68982688548055, 63.211992018752255, 62.654354487799324, 64.64647490823765, 48.61329509249159, 66.8873610141301, 65.71972131580814, 61.334356196532326, 61.39820413535627, 50.3080239655895, 64.08649967690297, 61.88464789253342, 63.756659014008065, 67.35233850634177, 62.094498081790604, 65.51080967730002, 61.13161542475193, 64.96394090698261, 48.90937147539461, 65.71964173354327, 63.21413659941888], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7480127152673037, "mean_inference_ms": 7.956991412258506, "mean_action_processing_ms": 0.5654809111813918, "mean_env_wait_ms": 24.194807527581574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03796195983886719, "StateBufferConnector_ms": 0.03396105766296387, "ViewRequirementAgentConnector_ms": 0.9171736240386963}}, "episode_reward_max": 71.58897166168643, "episode_reward_min": 35.98722275722136, "episode_reward_mean": 60.69552359330103, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.76141718713346, 57.830714080535245, 55.91497516955883, 62.58421973163385, 44.950860962739526, 56.56476019898713, 68.28586765726563, 57.94569172266076, 70.07427623374168, 60.44973252187839, 66.05643563324173, 61.44146297120678, 66.18505512317584, 35.98722275722136, 63.64504002492767, 63.57275995440396, 57.544820073211675, 60.17558278287944, 43.91477043622207, 65.16406401768826, 70.82455705595537, 60.17113476464902, 63.46648655879417, 60.75530667273423, 67.25855649020744, 58.280878064204856, 67.32954615477115, 47.028985703602494, 60.79285831098108, 64.26664267819994, 62.81119098396523, 57.440557373606325, 47.27328594951334, 57.51745309259596, 58.50187333797787, 63.380907410921004, 70.2310276527021, 62.854354643490154, 65.82809621271711, 61.645308685361755, 62.53761738528389, 49.320415664993305, 64.0109235180462, 65.73120185972435, 58.77384974421543, 65.27861627011289, 47.95697498011981, 60.81926778216972, 71.53730063385923, 56.74697520709216, 65.68767066166876, 63.04421205000336, 69.82407268301526, 65.83724952994255, 61.744665084000566, 46.52323289746569, 62.438920112240616, 61.025495551173314, 60.29589580079036, 65.93091650544619, 51.88799914086254, 62.155679998228976, 62.03075954307725, 51.326179944561666, 70.95227363069543, 58.853070661405916, 63.736955204231066, 63.18321772549067, 58.30536741140878, 43.985514982578124, 59.97427606129703, 64.65415243758862, 49.35315749183375, 62.22043382515529, 46.633726673724624, 65.305542211803, 68.5762097346322, 60.96689102206869, 71.58897166168643, 63.68982688548055, 63.211992018752255, 62.654354487799324, 64.64647490823765, 48.61329509249159, 66.8873610141301, 65.71972131580814, 61.334356196532326, 61.39820413535627, 50.3080239655895, 64.08649967690297, 61.88464789253342, 63.756659014008065, 67.35233850634177, 62.094498081790604, 65.51080967730002, 61.13161542475193, 64.96394090698261, 48.90937147539461, 65.71964173354327, 63.21413659941888], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7480127152673037, "mean_inference_ms": 7.956991412258506, "mean_action_processing_ms": 0.5654809111813918, "mean_env_wait_ms": 24.194807527581574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03796195983886719, "StateBufferConnector_ms": 0.03396105766296387, "ViewRequirementAgentConnector_ms": 0.9171736240386963}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1204396, "num_agent_steps_trained": 1204396, "num_env_steps_sampled": 1204396, "num_env_steps_trained": 1204396, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 235.55291285111298, "num_env_steps_trained_throughput_per_sec": 235.55291285111298, "timesteps_total": 1204396, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1204396, "timers": {"training_iteration_time_ms": 66927.444, "sample_time_ms": 41791.104, "load_time_ms": 2240.893, "load_throughput": 6978.469, "learn_time_ms": 22281.452, "learn_throughput": 701.839, "synch_weights_time_ms": 482.179}, "counters": {"num_env_steps_sampled": 1204396, "num_env_steps_trained": 1204396, "num_agent_steps_sampled": 1204396, "num_agent_steps_trained": 1204396}, "done": false, "episodes_total": 1192, "training_iteration": 85, "trial_id": "837cb_00000", "date": "2025-06-07_18-57-34", "timestamp": 1749315454, "time_this_iter_s": 66.40748405456543, "time_total_s": 5506.017934322357, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5506.017934322357, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 65.00769230769231, "ram_util_percent": 89.75384615384615, "gpu_util_percent0": 0.2226923076923076, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.795604e-05, "total_loss": -0.1092148971685674, "policy_loss": -0.040272879234769125, "vf_loss": 0.013927643733437765, "vf_explained_var": 0.9563601729002866, "kl": 0.017628788976373412, "entropy": 15.814124735051935, "entropy_coeff": 0.004693406}, "model": {}, "num_grad_updates_lifetime": 42665.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1220034, "num_env_steps_trained": 1220034, "num_agent_steps_sampled": 1220034, "num_agent_steps_trained": 1220034}, "sampler_results": {"episode_reward_max": 71.58897166168643, "episode_reward_min": 43.91477043622207, "episode_reward_mean": 60.98552990618077, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.64504002492767, 63.57275995440396, 57.544820073211675, 60.17558278287944, 43.91477043622207, 65.16406401768826, 70.82455705595537, 60.17113476464902, 63.46648655879417, 60.75530667273423, 67.25855649020744, 58.280878064204856, 67.32954615477115, 47.028985703602494, 60.79285831098108, 64.26664267819994, 62.81119098396523, 57.440557373606325, 47.27328594951334, 57.51745309259596, 58.50187333797787, 63.380907410921004, 70.2310276527021, 62.854354643490154, 65.82809621271711, 61.645308685361755, 62.53761738528389, 49.320415664993305, 64.0109235180462, 65.73120185972435, 58.77384974421543, 65.27861627011289, 47.95697498011981, 60.81926778216972, 71.53730063385923, 56.74697520709216, 65.68767066166876, 63.04421205000336, 69.82407268301526, 65.83724952994255, 61.744665084000566, 46.52323289746569, 62.438920112240616, 61.025495551173314, 60.29589580079036, 65.93091650544619, 51.88799914086254, 62.155679998228976, 62.03075954307725, 51.326179944561666, 70.95227363069543, 58.853070661405916, 63.736955204231066, 63.18321772549067, 58.30536741140878, 43.985514982578124, 59.97427606129703, 64.65415243758862, 49.35315749183375, 62.22043382515529, 46.633726673724624, 65.305542211803, 68.5762097346322, 60.96689102206869, 71.58897166168643, 63.68982688548055, 63.211992018752255, 62.654354487799324, 64.64647490823765, 48.61329509249159, 66.8873610141301, 65.71972131580814, 61.334356196532326, 61.39820413535627, 50.3080239655895, 64.08649967690297, 61.88464789253342, 63.756659014008065, 67.35233850634177, 62.094498081790604, 65.51080967730002, 61.13161542475193, 64.96394090698261, 48.90937147539461, 65.71964173354327, 63.21413659941888, 58.91609349317801, 62.208470713015146, 50.078925504273904, 59.174287079736416, 68.8184628062112, 61.07555007594842, 67.8847576569281, 60.25163003364826, 67.30202778326344, 61.83547371354622, 65.35763304319855, 47.202511303500046, 62.41095693955519, 66.51654309295097], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7504495969064924, "mean_inference_ms": 7.959030188027542, "mean_action_processing_ms": 0.5655121016138799, "mean_env_wait_ms": 24.19173975302839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030960559844970703, "StateBufferConnector_ms": 0.030007600784301758, "ViewRequirementAgentConnector_ms": 0.9120752811431885}}, "episode_reward_max": 71.58897166168643, "episode_reward_min": 43.91477043622207, "episode_reward_mean": 60.98552990618077, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [63.64504002492767, 63.57275995440396, 57.544820073211675, 60.17558278287944, 43.91477043622207, 65.16406401768826, 70.82455705595537, 60.17113476464902, 63.46648655879417, 60.75530667273423, 67.25855649020744, 58.280878064204856, 67.32954615477115, 47.028985703602494, 60.79285831098108, 64.26664267819994, 62.81119098396523, 57.440557373606325, 47.27328594951334, 57.51745309259596, 58.50187333797787, 63.380907410921004, 70.2310276527021, 62.854354643490154, 65.82809621271711, 61.645308685361755, 62.53761738528389, 49.320415664993305, 64.0109235180462, 65.73120185972435, 58.77384974421543, 65.27861627011289, 47.95697498011981, 60.81926778216972, 71.53730063385923, 56.74697520709216, 65.68767066166876, 63.04421205000336, 69.82407268301526, 65.83724952994255, 61.744665084000566, 46.52323289746569, 62.438920112240616, 61.025495551173314, 60.29589580079036, 65.93091650544619, 51.88799914086254, 62.155679998228976, 62.03075954307725, 51.326179944561666, 70.95227363069543, 58.853070661405916, 63.736955204231066, 63.18321772549067, 58.30536741140878, 43.985514982578124, 59.97427606129703, 64.65415243758862, 49.35315749183375, 62.22043382515529, 46.633726673724624, 65.305542211803, 68.5762097346322, 60.96689102206869, 71.58897166168643, 63.68982688548055, 63.211992018752255, 62.654354487799324, 64.64647490823765, 48.61329509249159, 66.8873610141301, 65.71972131580814, 61.334356196532326, 61.39820413535627, 50.3080239655895, 64.08649967690297, 61.88464789253342, 63.756659014008065, 67.35233850634177, 62.094498081790604, 65.51080967730002, 61.13161542475193, 64.96394090698261, 48.90937147539461, 65.71964173354327, 63.21413659941888, 58.91609349317801, 62.208470713015146, 50.078925504273904, 59.174287079736416, 68.8184628062112, 61.07555007594842, 67.8847576569281, 60.25163003364826, 67.30202778326344, 61.83547371354622, 65.35763304319855, 47.202511303500046, 62.41095693955519, 66.51654309295097], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7504495969064924, "mean_inference_ms": 7.959030188027542, "mean_action_processing_ms": 0.5655121016138799, "mean_env_wait_ms": 24.19173975302839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030960559844970703, "StateBufferConnector_ms": 0.030007600784301758, "ViewRequirementAgentConnector_ms": 0.9120752811431885}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1220034, "num_agent_steps_trained": 1220034, "num_env_steps_sampled": 1220034, "num_env_steps_trained": 1220034, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 230.6544312557985, "num_env_steps_trained_throughput_per_sec": 230.6544312557985, "timesteps_total": 1220034, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1220034, "timers": {"training_iteration_time_ms": 66949.57, "sample_time_ms": 41811.032, "load_time_ms": 2242.723, "load_throughput": 6972.775, "learn_time_ms": 22275.679, "learn_throughput": 702.021, "synch_weights_time_ms": 484.538}, "counters": {"num_env_steps_sampled": 1220034, "num_env_steps_trained": 1220034, "num_agent_steps_sampled": 1220034, "num_agent_steps_trained": 1220034}, "done": false, "episodes_total": 1206, "training_iteration": 86, "trial_id": "837cb_00000", "date": "2025-06-07_18-58-42", "timestamp": 1749315522, "time_this_iter_s": 67.8143663406372, "time_total_s": 5573.832300662994, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5573.832300662994, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 66.27088607594936, "ram_util_percent": 89.75443037974684, "gpu_util_percent0": 0.209746835443038, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.779966000000002e-05, "total_loss": -0.09940092641987246, "policy_loss": -0.03154192553759044, "vf_loss": 0.01685175099283118, "vf_explained_var": 0.9540417682040822, "kl": 0.01780519647023704, "entropy": 15.851854799444025, "entropy_coeff": 0.0046699490000000005}, "model": {}, "num_grad_updates_lifetime": 43215.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1235672, "num_env_steps_trained": 1235672, "num_agent_steps_sampled": 1235672, "num_agent_steps_trained": 1235672}, "sampler_results": {"episode_reward_max": 71.58897166168643, "episode_reward_min": 43.985514982578124, "episode_reward_mean": 60.84726386694635, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.79285831098108, 64.26664267819994, 62.81119098396523, 57.440557373606325, 47.27328594951334, 57.51745309259596, 58.50187333797787, 63.380907410921004, 70.2310276527021, 62.854354643490154, 65.82809621271711, 61.645308685361755, 62.53761738528389, 49.320415664993305, 64.0109235180462, 65.73120185972435, 58.77384974421543, 65.27861627011289, 47.95697498011981, 60.81926778216972, 71.53730063385923, 56.74697520709216, 65.68767066166876, 63.04421205000336, 69.82407268301526, 65.83724952994255, 61.744665084000566, 46.52323289746569, 62.438920112240616, 61.025495551173314, 60.29589580079036, 65.93091650544619, 51.88799914086254, 62.155679998228976, 62.03075954307725, 51.326179944561666, 70.95227363069543, 58.853070661405916, 63.736955204231066, 63.18321772549067, 58.30536741140878, 43.985514982578124, 59.97427606129703, 64.65415243758862, 49.35315749183375, 62.22043382515529, 46.633726673724624, 65.305542211803, 68.5762097346322, 60.96689102206869, 71.58897166168643, 63.68982688548055, 63.211992018752255, 62.654354487799324, 64.64647490823765, 48.61329509249159, 66.8873610141301, 65.71972131580814, 61.334356196532326, 61.39820413535627, 50.3080239655895, 64.08649967690297, 61.88464789253342, 63.756659014008065, 67.35233850634177, 62.094498081790604, 65.51080967730002, 61.13161542475193, 64.96394090698261, 48.90937147539461, 65.71964173354327, 63.21413659941888, 58.91609349317801, 62.208470713015146, 50.078925504273904, 59.174287079736416, 68.8184628062112, 61.07555007594842, 67.8847576569281, 60.25163003364826, 67.30202778326344, 61.83547371354622, 65.35763304319855, 47.202511303500046, 62.41095693955519, 66.51654309295097, 56.254461379382384, 60.0298171786177, 50.45850325300907, 63.30469929505975, 63.769506203238564, 57.03438939738828, 64.20479472225891, 64.37573823483488, 63.56053999249011, 63.41070083265935, 61.49073235536302, 46.02846228902188, 61.55346917969372, 59.83007051779165], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7528269843428266, "mean_inference_ms": 7.960901817384489, "mean_action_processing_ms": 0.5655232568615527, "mean_env_wait_ms": 24.188589749155234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03496193885803223, "StateBufferConnector_ms": 0.030007600784301758, "ViewRequirementAgentConnector_ms": 0.9475612640380859}}, "episode_reward_max": 71.58897166168643, "episode_reward_min": 43.985514982578124, "episode_reward_mean": 60.84726386694635, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.79285831098108, 64.26664267819994, 62.81119098396523, 57.440557373606325, 47.27328594951334, 57.51745309259596, 58.50187333797787, 63.380907410921004, 70.2310276527021, 62.854354643490154, 65.82809621271711, 61.645308685361755, 62.53761738528389, 49.320415664993305, 64.0109235180462, 65.73120185972435, 58.77384974421543, 65.27861627011289, 47.95697498011981, 60.81926778216972, 71.53730063385923, 56.74697520709216, 65.68767066166876, 63.04421205000336, 69.82407268301526, 65.83724952994255, 61.744665084000566, 46.52323289746569, 62.438920112240616, 61.025495551173314, 60.29589580079036, 65.93091650544619, 51.88799914086254, 62.155679998228976, 62.03075954307725, 51.326179944561666, 70.95227363069543, 58.853070661405916, 63.736955204231066, 63.18321772549067, 58.30536741140878, 43.985514982578124, 59.97427606129703, 64.65415243758862, 49.35315749183375, 62.22043382515529, 46.633726673724624, 65.305542211803, 68.5762097346322, 60.96689102206869, 71.58897166168643, 63.68982688548055, 63.211992018752255, 62.654354487799324, 64.64647490823765, 48.61329509249159, 66.8873610141301, 65.71972131580814, 61.334356196532326, 61.39820413535627, 50.3080239655895, 64.08649967690297, 61.88464789253342, 63.756659014008065, 67.35233850634177, 62.094498081790604, 65.51080967730002, 61.13161542475193, 64.96394090698261, 48.90937147539461, 65.71964173354327, 63.21413659941888, 58.91609349317801, 62.208470713015146, 50.078925504273904, 59.174287079736416, 68.8184628062112, 61.07555007594842, 67.8847576569281, 60.25163003364826, 67.30202778326344, 61.83547371354622, 65.35763304319855, 47.202511303500046, 62.41095693955519, 66.51654309295097, 56.254461379382384, 60.0298171786177, 50.45850325300907, 63.30469929505975, 63.769506203238564, 57.03438939738828, 64.20479472225891, 64.37573823483488, 63.56053999249011, 63.41070083265935, 61.49073235536302, 46.02846228902188, 61.55346917969372, 59.83007051779165], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7528269843428266, "mean_inference_ms": 7.960901817384489, "mean_action_processing_ms": 0.5655232568615527, "mean_env_wait_ms": 24.188589749155234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03496193885803223, "StateBufferConnector_ms": 0.030007600784301758, "ViewRequirementAgentConnector_ms": 0.9475612640380859}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1235672, "num_agent_steps_trained": 1235672, "num_env_steps_sampled": 1235672, "num_env_steps_trained": 1235672, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 233.93819485199074, "num_env_steps_trained_throughput_per_sec": 233.93819485199074, "timesteps_total": 1235672, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1235672, "timers": {"training_iteration_time_ms": 66946.545, "sample_time_ms": 41734.544, "load_time_ms": 2241.716, "load_throughput": 6975.908, "learn_time_ms": 22348.696, "learn_throughput": 699.728, "synch_weights_time_ms": 487.058}, "counters": {"num_env_steps_sampled": 1235672, "num_env_steps_trained": 1235672, "num_agent_steps_sampled": 1235672, "num_agent_steps_trained": 1235672}, "done": false, "episodes_total": 1220, "training_iteration": 87, "trial_id": "837cb_00000", "date": "2025-06-07_18-59-48", "timestamp": 1749315588, "time_this_iter_s": 66.8687195777893, "time_total_s": 5640.701020240784, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5640.701020240784, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 67.05974025974027, "ram_util_percent": 89.73766233766231, "gpu_util_percent0": 0.21363636363636357, "vram_util_percent0": 0.965006510416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.764328000000001e-05, "total_loss": -0.08357729236595332, "policy_loss": -0.01616383723237298, "vf_loss": 0.017257964592427014, "vf_explained_var": 0.9543599686839364, "kl": 0.018346085549567695, "entropy": 15.869492423317649, "entropy_coeff": 0.004646492000000001}, "model": {}, "num_grad_updates_lifetime": 43765.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1251310, "num_env_steps_trained": 1251310, "num_agent_steps_sampled": 1251310, "num_agent_steps_trained": 1251310}, "sampler_results": {"episode_reward_max": 71.58897166168643, "episode_reward_min": 43.985514982578124, "episode_reward_mean": 60.59305116532775, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.0109235180462, 65.73120185972435, 58.77384974421543, 65.27861627011289, 47.95697498011981, 60.81926778216972, 71.53730063385923, 56.74697520709216, 65.68767066166876, 63.04421205000336, 69.82407268301526, 65.83724952994255, 61.744665084000566, 46.52323289746569, 62.438920112240616, 61.025495551173314, 60.29589580079036, 65.93091650544619, 51.88799914086254, 62.155679998228976, 62.03075954307725, 51.326179944561666, 70.95227363069543, 58.853070661405916, 63.736955204231066, 63.18321772549067, 58.30536741140878, 43.985514982578124, 59.97427606129703, 64.65415243758862, 49.35315749183375, 62.22043382515529, 46.633726673724624, 65.305542211803, 68.5762097346322, 60.96689102206869, 71.58897166168643, 63.68982688548055, 63.211992018752255, 62.654354487799324, 64.64647490823765, 48.61329509249159, 66.8873610141301, 65.71972131580814, 61.334356196532326, 61.39820413535627, 50.3080239655895, 64.08649967690297, 61.88464789253342, 63.756659014008065, 67.35233850634177, 62.094498081790604, 65.51080967730002, 61.13161542475193, 64.96394090698261, 48.90937147539461, 65.71964173354327, 63.21413659941888, 58.91609349317801, 62.208470713015146, 50.078925504273904, 59.174287079736416, 68.8184628062112, 61.07555007594842, 67.8847576569281, 60.25163003364826, 67.30202778326344, 61.83547371354622, 65.35763304319855, 47.202511303500046, 62.41095693955519, 66.51654309295097, 56.254461379382384, 60.0298171786177, 50.45850325300907, 63.30469929505975, 63.769506203238564, 57.03438939738828, 64.20479472225891, 64.37573823483488, 63.56053999249011, 63.41070083265935, 61.49073235536302, 46.02846228902188, 61.55346917969372, 59.83007051779165, 58.75551416794115, 61.56344025824201, 44.473919579323805, 58.30206759768154, 68.71257146108191, 59.82622427137907, 68.48060478301635, 47.6362492669701, 62.884162694267836, 57.53416285987868, 57.89157877974309, 46.87304363360603, 62.803021382258734, 63.24375848505897], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7552299089310766, "mean_inference_ms": 7.962868129173467, "mean_action_processing_ms": 0.5655473503059577, "mean_env_wait_ms": 24.18607873089438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04189467430114746, "StateBufferConnector_ms": 0.03399252891540527, "ViewRequirementAgentConnector_ms": 0.9505906105041504}}, "episode_reward_max": 71.58897166168643, "episode_reward_min": 43.985514982578124, "episode_reward_mean": 60.59305116532775, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.0109235180462, 65.73120185972435, 58.77384974421543, 65.27861627011289, 47.95697498011981, 60.81926778216972, 71.53730063385923, 56.74697520709216, 65.68767066166876, 63.04421205000336, 69.82407268301526, 65.83724952994255, 61.744665084000566, 46.52323289746569, 62.438920112240616, 61.025495551173314, 60.29589580079036, 65.93091650544619, 51.88799914086254, 62.155679998228976, 62.03075954307725, 51.326179944561666, 70.95227363069543, 58.853070661405916, 63.736955204231066, 63.18321772549067, 58.30536741140878, 43.985514982578124, 59.97427606129703, 64.65415243758862, 49.35315749183375, 62.22043382515529, 46.633726673724624, 65.305542211803, 68.5762097346322, 60.96689102206869, 71.58897166168643, 63.68982688548055, 63.211992018752255, 62.654354487799324, 64.64647490823765, 48.61329509249159, 66.8873610141301, 65.71972131580814, 61.334356196532326, 61.39820413535627, 50.3080239655895, 64.08649967690297, 61.88464789253342, 63.756659014008065, 67.35233850634177, 62.094498081790604, 65.51080967730002, 61.13161542475193, 64.96394090698261, 48.90937147539461, 65.71964173354327, 63.21413659941888, 58.91609349317801, 62.208470713015146, 50.078925504273904, 59.174287079736416, 68.8184628062112, 61.07555007594842, 67.8847576569281, 60.25163003364826, 67.30202778326344, 61.83547371354622, 65.35763304319855, 47.202511303500046, 62.41095693955519, 66.51654309295097, 56.254461379382384, 60.0298171786177, 50.45850325300907, 63.30469929505975, 63.769506203238564, 57.03438939738828, 64.20479472225891, 64.37573823483488, 63.56053999249011, 63.41070083265935, 61.49073235536302, 46.02846228902188, 61.55346917969372, 59.83007051779165, 58.75551416794115, 61.56344025824201, 44.473919579323805, 58.30206759768154, 68.71257146108191, 59.82622427137907, 68.48060478301635, 47.6362492669701, 62.884162694267836, 57.53416285987868, 57.89157877974309, 46.87304363360603, 62.803021382258734, 63.24375848505897], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7552299089310766, "mean_inference_ms": 7.962868129173467, "mean_action_processing_ms": 0.5655473503059577, "mean_env_wait_ms": 24.18607873089438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04189467430114746, "StateBufferConnector_ms": 0.03399252891540527, "ViewRequirementAgentConnector_ms": 0.9505906105041504}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1251310, "num_agent_steps_trained": 1251310, "num_env_steps_sampled": 1251310, "num_env_steps_trained": 1251310, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 231.08159326983056, "num_env_steps_trained_throughput_per_sec": 231.08159326983056, "timesteps_total": 1251310, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1251310, "timers": {"training_iteration_time_ms": 67005.859, "sample_time_ms": 41749.656, "load_time_ms": 2234.809, "load_throughput": 6997.465, "learn_time_ms": 22400.093, "learn_throughput": 698.122, "synch_weights_time_ms": 485.324}, "counters": {"num_env_steps_sampled": 1251310, "num_env_steps_trained": 1251310, "num_agent_steps_sampled": 1251310, "num_agent_steps_trained": 1251310}, "done": false, "episodes_total": 1234, "training_iteration": 88, "trial_id": "837cb_00000", "date": "2025-06-07_19-00-56", "timestamp": 1749315656, "time_this_iter_s": 67.68883180618286, "time_total_s": 5708.389852046967, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5708.389852046967, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 65.4625, "ram_util_percent": 90.70250000000001, "gpu_util_percent0": 0.22075, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.74869e-05, "total_loss": -0.1059960243503817, "policy_loss": -0.03785585692491044, "vf_loss": 0.014410083120773461, "vf_explained_var": 0.9585628607056358, "kl": 0.01751881929389905, "entropy": 15.911218480196865, "entropy_coeff": 0.004623035}, "model": {}, "num_grad_updates_lifetime": 44315.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1266948, "num_env_steps_trained": 1266948, "num_agent_steps_sampled": 1266948, "num_agent_steps_trained": 1266948}, "sampler_results": {"episode_reward_max": 71.58897166168643, "episode_reward_min": 43.985514982578124, "episode_reward_mean": 60.36054234001794, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.438920112240616, 61.025495551173314, 60.29589580079036, 65.93091650544619, 51.88799914086254, 62.155679998228976, 62.03075954307725, 51.326179944561666, 70.95227363069543, 58.853070661405916, 63.736955204231066, 63.18321772549067, 58.30536741140878, 43.985514982578124, 59.97427606129703, 64.65415243758862, 49.35315749183375, 62.22043382515529, 46.633726673724624, 65.305542211803, 68.5762097346322, 60.96689102206869, 71.58897166168643, 63.68982688548055, 63.211992018752255, 62.654354487799324, 64.64647490823765, 48.61329509249159, 66.8873610141301, 65.71972131580814, 61.334356196532326, 61.39820413535627, 50.3080239655895, 64.08649967690297, 61.88464789253342, 63.756659014008065, 67.35233850634177, 62.094498081790604, 65.51080967730002, 61.13161542475193, 64.96394090698261, 48.90937147539461, 65.71964173354327, 63.21413659941888, 58.91609349317801, 62.208470713015146, 50.078925504273904, 59.174287079736416, 68.8184628062112, 61.07555007594842, 67.8847576569281, 60.25163003364826, 67.30202778326344, 61.83547371354622, 65.35763304319855, 47.202511303500046, 62.41095693955519, 66.51654309295097, 56.254461379382384, 60.0298171786177, 50.45850325300907, 63.30469929505975, 63.769506203238564, 57.03438939738828, 64.20479472225891, 64.37573823483488, 63.56053999249011, 63.41070083265935, 61.49073235536302, 46.02846228902188, 61.55346917969372, 59.83007051779165, 58.75551416794115, 61.56344025824201, 44.473919579323805, 58.30206759768154, 68.71257146108191, 59.82622427137907, 68.48060478301635, 47.6362492669701, 62.884162694267836, 57.53416285987868, 57.89157877974309, 46.87304363360603, 62.803021382258734, 63.24375848505897, 59.825534165205354, 61.86073147465468, 47.26594902110639, 60.02143059425523, 70.72243598434875, 54.87221747088027, 69.30652679094634, 58.29168426289045, 62.78717213903662, 60.256157780771204, 63.483640308267795, 49.476212157838646, 64.37432979011349, 57.72130843014009], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7575714541816967, "mean_inference_ms": 7.96516891507332, "mean_action_processing_ms": 0.5656049312237156, "mean_env_wait_ms": 24.184729034825427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0408778190612793, "StateBufferConnector_ms": 0.030933618545532227, "ViewRequirementAgentConnector_ms": 0.9134464263916016}}, "episode_reward_max": 71.58897166168643, "episode_reward_min": 43.985514982578124, "episode_reward_mean": 60.36054234001794, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [62.438920112240616, 61.025495551173314, 60.29589580079036, 65.93091650544619, 51.88799914086254, 62.155679998228976, 62.03075954307725, 51.326179944561666, 70.95227363069543, 58.853070661405916, 63.736955204231066, 63.18321772549067, 58.30536741140878, 43.985514982578124, 59.97427606129703, 64.65415243758862, 49.35315749183375, 62.22043382515529, 46.633726673724624, 65.305542211803, 68.5762097346322, 60.96689102206869, 71.58897166168643, 63.68982688548055, 63.211992018752255, 62.654354487799324, 64.64647490823765, 48.61329509249159, 66.8873610141301, 65.71972131580814, 61.334356196532326, 61.39820413535627, 50.3080239655895, 64.08649967690297, 61.88464789253342, 63.756659014008065, 67.35233850634177, 62.094498081790604, 65.51080967730002, 61.13161542475193, 64.96394090698261, 48.90937147539461, 65.71964173354327, 63.21413659941888, 58.91609349317801, 62.208470713015146, 50.078925504273904, 59.174287079736416, 68.8184628062112, 61.07555007594842, 67.8847576569281, 60.25163003364826, 67.30202778326344, 61.83547371354622, 65.35763304319855, 47.202511303500046, 62.41095693955519, 66.51654309295097, 56.254461379382384, 60.0298171786177, 50.45850325300907, 63.30469929505975, 63.769506203238564, 57.03438939738828, 64.20479472225891, 64.37573823483488, 63.56053999249011, 63.41070083265935, 61.49073235536302, 46.02846228902188, 61.55346917969372, 59.83007051779165, 58.75551416794115, 61.56344025824201, 44.473919579323805, 58.30206759768154, 68.71257146108191, 59.82622427137907, 68.48060478301635, 47.6362492669701, 62.884162694267836, 57.53416285987868, 57.89157877974309, 46.87304363360603, 62.803021382258734, 63.24375848505897, 59.825534165205354, 61.86073147465468, 47.26594902110639, 60.02143059425523, 70.72243598434875, 54.87221747088027, 69.30652679094634, 58.29168426289045, 62.78717213903662, 60.256157780771204, 63.483640308267795, 49.476212157838646, 64.37432979011349, 57.72130843014009], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7575714541816967, "mean_inference_ms": 7.96516891507332, "mean_action_processing_ms": 0.5656049312237156, "mean_env_wait_ms": 24.184729034825427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0408778190612793, "StateBufferConnector_ms": 0.030933618545532227, "ViewRequirementAgentConnector_ms": 0.9134464263916016}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1266948, "num_agent_steps_trained": 1266948, "num_env_steps_sampled": 1266948, "num_env_steps_trained": 1266948, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.598310847682, "num_env_steps_trained_throughput_per_sec": 226.598310847682, "timesteps_total": 1266948, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1266948, "timers": {"training_iteration_time_ms": 67237.85, "sample_time_ms": 41876.688, "load_time_ms": 2307.522, "load_throughput": 6776.968, "learn_time_ms": 22426.164, "learn_throughput": 697.311, "synch_weights_time_ms": 491.627}, "counters": {"num_env_steps_sampled": 1266948, "num_env_steps_trained": 1266948, "num_agent_steps_sampled": 1266948, "num_agent_steps_trained": 1266948}, "done": false, "episodes_total": 1248, "training_iteration": 89, "trial_id": "837cb_00000", "date": "2025-06-07_19-02-05", "timestamp": 1749315725, "time_this_iter_s": 69.0359890460968, "time_total_s": 5777.425841093063, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5777.425841093063, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 66.89124999999999, "ram_util_percent": 91.19250000000001, "gpu_util_percent0": 0.20812499999999998, "vram_util_percent0": 0.9650065104166666}}
{"evaluation": {"sampler_results": {"episode_reward_max": -7.191873005485631, "episode_reward_min": -8.317315623554848, "episode_reward_mean": -7.768116190578519, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.8057191703137665, -8.317315623554848, -7.743274994450262, -7.782398159088089, -7.191873005485631], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.903141024262127, "mean_inference_ms": 4.058839531714121, "mean_action_processing_ms": 0.2980897311728986, "mean_env_wait_ms": 13.012868196920214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020122528076171875, "ViewRequirementAgentConnector_ms": 0.5006885528564453}}, "episode_reward_max": -7.191873005485631, "episode_reward_min": -8.317315623554848, "episode_reward_mean": -7.768116190578519, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.8057191703137665, -8.317315623554848, -7.743274994450262, -7.782398159088089, -7.191873005485631], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.903141024262127, "mean_inference_ms": 4.058839531714121, "mean_action_processing_ms": 0.2980897311728986, "mean_env_wait_ms": 13.012868196920214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020122528076171875, "ViewRequirementAgentConnector_ms": 0.5006885528564453}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.733052000000002e-05, "total_loss": -0.11128352317620407, "policy_loss": -0.043457365827846595, "vf_loss": 0.014086438296362757, "vf_explained_var": 0.9577337089451876, "kl": 0.01926699295444639, "entropy": 15.926737767999823, "entropy_coeff": 0.004599577999999999}, "model": {}, "num_grad_updates_lifetime": 44865.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1282586, "num_env_steps_trained": 1282586, "num_agent_steps_sampled": 1282586, "num_agent_steps_trained": 1282586}, "sampler_results": {"episode_reward_max": 71.58897166168643, "episode_reward_min": 44.473919579323805, "episode_reward_mean": 60.54617878641082, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.97427606129703, 64.65415243758862, 49.35315749183375, 62.22043382515529, 46.633726673724624, 65.305542211803, 68.5762097346322, 60.96689102206869, 71.58897166168643, 63.68982688548055, 63.211992018752255, 62.654354487799324, 64.64647490823765, 48.61329509249159, 66.8873610141301, 65.71972131580814, 61.334356196532326, 61.39820413535627, 50.3080239655895, 64.08649967690297, 61.88464789253342, 63.756659014008065, 67.35233850634177, 62.094498081790604, 65.51080967730002, 61.13161542475193, 64.96394090698261, 48.90937147539461, 65.71964173354327, 63.21413659941888, 58.91609349317801, 62.208470713015146, 50.078925504273904, 59.174287079736416, 68.8184628062112, 61.07555007594842, 67.8847576569281, 60.25163003364826, 67.30202778326344, 61.83547371354622, 65.35763304319855, 47.202511303500046, 62.41095693955519, 66.51654309295097, 56.254461379382384, 60.0298171786177, 50.45850325300907, 63.30469929505975, 63.769506203238564, 57.03438939738828, 64.20479472225891, 64.37573823483488, 63.56053999249011, 63.41070083265935, 61.49073235536302, 46.02846228902188, 61.55346917969372, 59.83007051779165, 58.75551416794115, 61.56344025824201, 44.473919579323805, 58.30206759768154, 68.71257146108191, 59.82622427137907, 68.48060478301635, 47.6362492669701, 62.884162694267836, 57.53416285987868, 57.89157877974309, 46.87304363360603, 62.803021382258734, 63.24375848505897, 59.825534165205354, 61.86073147465468, 47.26594902110639, 60.02143059425523, 70.72243598434875, 54.87221747088027, 69.30652679094634, 58.29168426289045, 62.78717213903662, 60.256157780771204, 63.483640308267795, 49.476212157838646, 64.37432979011349, 57.72130843014009, 60.41294089076525, 60.39882620961143, 47.9291203384912, 63.20904535265974, 66.2849309509248, 60.62433246206645, 68.50473620346085, 61.7937662763034, 63.50197520450342, 60.64663500489569, 63.28407142339957, 47.20816909560296, 64.37738624609138, 66.49595519270248], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.759823417027685, "mean_inference_ms": 7.967725270201117, "mean_action_processing_ms": 0.5657019907449979, "mean_env_wait_ms": 24.18378366171201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039942264556884766, "StateBufferConnector_ms": 0.03165173530578613, "ViewRequirementAgentConnector_ms": 0.9394185543060303}}, "episode_reward_max": 71.58897166168643, "episode_reward_min": 44.473919579323805, "episode_reward_mean": 60.54617878641082, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.97427606129703, 64.65415243758862, 49.35315749183375, 62.22043382515529, 46.633726673724624, 65.305542211803, 68.5762097346322, 60.96689102206869, 71.58897166168643, 63.68982688548055, 63.211992018752255, 62.654354487799324, 64.64647490823765, 48.61329509249159, 66.8873610141301, 65.71972131580814, 61.334356196532326, 61.39820413535627, 50.3080239655895, 64.08649967690297, 61.88464789253342, 63.756659014008065, 67.35233850634177, 62.094498081790604, 65.51080967730002, 61.13161542475193, 64.96394090698261, 48.90937147539461, 65.71964173354327, 63.21413659941888, 58.91609349317801, 62.208470713015146, 50.078925504273904, 59.174287079736416, 68.8184628062112, 61.07555007594842, 67.8847576569281, 60.25163003364826, 67.30202778326344, 61.83547371354622, 65.35763304319855, 47.202511303500046, 62.41095693955519, 66.51654309295097, 56.254461379382384, 60.0298171786177, 50.45850325300907, 63.30469929505975, 63.769506203238564, 57.03438939738828, 64.20479472225891, 64.37573823483488, 63.56053999249011, 63.41070083265935, 61.49073235536302, 46.02846228902188, 61.55346917969372, 59.83007051779165, 58.75551416794115, 61.56344025824201, 44.473919579323805, 58.30206759768154, 68.71257146108191, 59.82622427137907, 68.48060478301635, 47.6362492669701, 62.884162694267836, 57.53416285987868, 57.89157877974309, 46.87304363360603, 62.803021382258734, 63.24375848505897, 59.825534165205354, 61.86073147465468, 47.26594902110639, 60.02143059425523, 70.72243598434875, 54.87221747088027, 69.30652679094634, 58.29168426289045, 62.78717213903662, 60.256157780771204, 63.483640308267795, 49.476212157838646, 64.37432979011349, 57.72130843014009, 60.41294089076525, 60.39882620961143, 47.9291203384912, 63.20904535265974, 66.2849309509248, 60.62433246206645, 68.50473620346085, 61.7937662763034, 63.50197520450342, 60.64663500489569, 63.28407142339957, 47.20816909560296, 64.37738624609138, 66.49595519270248], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.759823417027685, "mean_inference_ms": 7.967725270201117, "mean_action_processing_ms": 0.5657019907449979, "mean_env_wait_ms": 24.18378366171201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039942264556884766, "StateBufferConnector_ms": 0.03165173530578613, "ViewRequirementAgentConnector_ms": 0.9394185543060303}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1282586, "num_agent_steps_trained": 1282586, "num_env_steps_sampled": 1282586, "num_env_steps_trained": 1282586, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.34630551016662, "num_env_steps_trained_throughput_per_sec": 228.34630551016662, "timesteps_total": 1282586, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1282586, "timers": {"training_iteration_time_ms": 67397.241, "sample_time_ms": 41980.458, "load_time_ms": 2337.831, "load_throughput": 6689.106, "learn_time_ms": 22451.469, "learn_throughput": 696.525, "synch_weights_time_ms": 490.974}, "counters": {"num_env_steps_sampled": 1282586, "num_env_steps_trained": 1282586, "num_agent_steps_sampled": 1282586, "num_agent_steps_trained": 1282586}, "done": false, "episodes_total": 1262, "training_iteration": 90, "trial_id": "837cb_00000", "date": "2025-06-07_19-03-32", "timestamp": 1749315812, "time_this_iter_s": 86.5700626373291, "time_total_s": 5863.9959037303925, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5863.9959037303925, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 55.459803921568636, "ram_util_percent": 89.93431372549017, "gpu_util_percent0": 0.17215686274509806, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.717413999999999e-05, "total_loss": -0.09209268839183178, "policy_loss": -0.02472376055274667, "vf_loss": 0.014903411734425887, "vf_explained_var": 0.9563215765086087, "kl": 0.01791331552847871, "entropy": 15.943532187721946, "entropy_coeff": 0.004576121}, "model": {}, "num_grad_updates_lifetime": 45415.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1298224, "num_env_steps_trained": 1298224, "num_agent_steps_sampled": 1298224, "num_agent_steps_trained": 1298224}, "sampler_results": {"episode_reward_max": 70.72243598434875, "episode_reward_min": 42.486071701039926, "episode_reward_mean": 60.333630002263845, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.8873610141301, 65.71972131580814, 61.334356196532326, 61.39820413535627, 50.3080239655895, 64.08649967690297, 61.88464789253342, 63.756659014008065, 67.35233850634177, 62.094498081790604, 65.51080967730002, 61.13161542475193, 64.96394090698261, 48.90937147539461, 65.71964173354327, 63.21413659941888, 58.91609349317801, 62.208470713015146, 50.078925504273904, 59.174287079736416, 68.8184628062112, 61.07555007594842, 67.8847576569281, 60.25163003364826, 67.30202778326344, 61.83547371354622, 65.35763304319855, 47.202511303500046, 62.41095693955519, 66.51654309295097, 56.254461379382384, 60.0298171786177, 50.45850325300907, 63.30469929505975, 63.769506203238564, 57.03438939738828, 64.20479472225891, 64.37573823483488, 63.56053999249011, 63.41070083265935, 61.49073235536302, 46.02846228902188, 61.55346917969372, 59.83007051779165, 58.75551416794115, 61.56344025824201, 44.473919579323805, 58.30206759768154, 68.71257146108191, 59.82622427137907, 68.48060478301635, 47.6362492669701, 62.884162694267836, 57.53416285987868, 57.89157877974309, 46.87304363360603, 62.803021382258734, 63.24375848505897, 59.825534165205354, 61.86073147465468, 47.26594902110639, 60.02143059425523, 70.72243598434875, 54.87221747088027, 69.30652679094634, 58.29168426289045, 62.78717213903662, 60.256157780771204, 63.483640308267795, 49.476212157838646, 64.37432979011349, 57.72130843014009, 60.41294089076525, 60.39882620961143, 47.9291203384912, 63.20904535265974, 66.2849309509248, 60.62433246206645, 68.50473620346085, 61.7937662763034, 63.50197520450342, 60.64663500489569, 63.28407142339957, 47.20816909560296, 64.37738624609138, 66.49595519270248, 57.87043534843676, 60.64641452168808, 47.45947189852632, 59.86799588754847, 66.39617447387202, 61.83118972754046, 67.33961202701792, 58.19041104958304, 59.556972499118565, 56.82519816268, 65.74613407599013, 42.486071701039926, 62.27461407860325, 64.34373064620873], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7623144937026733, "mean_inference_ms": 7.970876597350329, "mean_action_processing_ms": 0.5658600044460045, "mean_env_wait_ms": 24.183885053385865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03811192512512207, "StateBufferConnector_ms": 0.03064584732055664, "ViewRequirementAgentConnector_ms": 0.9582865238189697}}, "episode_reward_max": 70.72243598434875, "episode_reward_min": 42.486071701039926, "episode_reward_mean": 60.333630002263845, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [66.8873610141301, 65.71972131580814, 61.334356196532326, 61.39820413535627, 50.3080239655895, 64.08649967690297, 61.88464789253342, 63.756659014008065, 67.35233850634177, 62.094498081790604, 65.51080967730002, 61.13161542475193, 64.96394090698261, 48.90937147539461, 65.71964173354327, 63.21413659941888, 58.91609349317801, 62.208470713015146, 50.078925504273904, 59.174287079736416, 68.8184628062112, 61.07555007594842, 67.8847576569281, 60.25163003364826, 67.30202778326344, 61.83547371354622, 65.35763304319855, 47.202511303500046, 62.41095693955519, 66.51654309295097, 56.254461379382384, 60.0298171786177, 50.45850325300907, 63.30469929505975, 63.769506203238564, 57.03438939738828, 64.20479472225891, 64.37573823483488, 63.56053999249011, 63.41070083265935, 61.49073235536302, 46.02846228902188, 61.55346917969372, 59.83007051779165, 58.75551416794115, 61.56344025824201, 44.473919579323805, 58.30206759768154, 68.71257146108191, 59.82622427137907, 68.48060478301635, 47.6362492669701, 62.884162694267836, 57.53416285987868, 57.89157877974309, 46.87304363360603, 62.803021382258734, 63.24375848505897, 59.825534165205354, 61.86073147465468, 47.26594902110639, 60.02143059425523, 70.72243598434875, 54.87221747088027, 69.30652679094634, 58.29168426289045, 62.78717213903662, 60.256157780771204, 63.483640308267795, 49.476212157838646, 64.37432979011349, 57.72130843014009, 60.41294089076525, 60.39882620961143, 47.9291203384912, 63.20904535265974, 66.2849309509248, 60.62433246206645, 68.50473620346085, 61.7937662763034, 63.50197520450342, 60.64663500489569, 63.28407142339957, 47.20816909560296, 64.37738624609138, 66.49595519270248, 57.87043534843676, 60.64641452168808, 47.45947189852632, 59.86799588754847, 66.39617447387202, 61.83118972754046, 67.33961202701792, 58.19041104958304, 59.556972499118565, 56.82519816268, 65.74613407599013, 42.486071701039926, 62.27461407860325, 64.34373064620873], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7623144937026733, "mean_inference_ms": 7.970876597350329, "mean_action_processing_ms": 0.5658600044460045, "mean_env_wait_ms": 24.183885053385865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03811192512512207, "StateBufferConnector_ms": 0.03064584732055664, "ViewRequirementAgentConnector_ms": 0.9582865238189697}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1298224, "num_agent_steps_trained": 1298224, "num_env_steps_sampled": 1298224, "num_env_steps_trained": 1298224, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.34642057411463, "num_env_steps_trained_throughput_per_sec": 229.34642057411463, "timesteps_total": 1298224, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1298224, "timers": {"training_iteration_time_ms": 67513.112, "sample_time_ms": 42092.161, "load_time_ms": 2346.284, "load_throughput": 6665.007, "learn_time_ms": 22483.686, "learn_throughput": 695.527, "synch_weights_time_ms": 455.87}, "counters": {"num_env_steps_sampled": 1298224, "num_env_steps_trained": 1298224, "num_agent_steps_sampled": 1298224, "num_agent_steps_trained": 1298224}, "done": false, "episodes_total": 1276, "training_iteration": 91, "trial_id": "837cb_00000", "date": "2025-06-07_19-04-41", "timestamp": 1749315881, "time_this_iter_s": 68.24803686141968, "time_total_s": 5932.243940591812, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5932.243940591812, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 66.89000000000001, "ram_util_percent": 88.91249999999998, "gpu_util_percent0": 0.21550000000000002, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.701776000000002e-05, "total_loss": -0.08817743595668369, "policy_loss": -0.021517784420972352, "vf_loss": 0.015035168672488494, "vf_explained_var": 0.9498895023085854, "kl": 0.018849038091310912, "entropy": 15.891414642333984, "entropy_coeff": 0.004552663999999999}, "model": {}, "num_grad_updates_lifetime": 45965.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1313862, "num_env_steps_trained": 1313862, "num_agent_steps_sampled": 1313862, "num_agent_steps_trained": 1313862}, "sampler_results": {"episode_reward_max": 70.72243598434875, "episode_reward_min": 42.486071701039926, "episode_reward_mean": 60.03626384675493, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.71964173354327, 63.21413659941888, 58.91609349317801, 62.208470713015146, 50.078925504273904, 59.174287079736416, 68.8184628062112, 61.07555007594842, 67.8847576569281, 60.25163003364826, 67.30202778326344, 61.83547371354622, 65.35763304319855, 47.202511303500046, 62.41095693955519, 66.51654309295097, 56.254461379382384, 60.0298171786177, 50.45850325300907, 63.30469929505975, 63.769506203238564, 57.03438939738828, 64.20479472225891, 64.37573823483488, 63.56053999249011, 63.41070083265935, 61.49073235536302, 46.02846228902188, 61.55346917969372, 59.83007051779165, 58.75551416794115, 61.56344025824201, 44.473919579323805, 58.30206759768154, 68.71257146108191, 59.82622427137907, 68.48060478301635, 47.6362492669701, 62.884162694267836, 57.53416285987868, 57.89157877974309, 46.87304363360603, 62.803021382258734, 63.24375848505897, 59.825534165205354, 61.86073147465468, 47.26594902110639, 60.02143059425523, 70.72243598434875, 54.87221747088027, 69.30652679094634, 58.29168426289045, 62.78717213903662, 60.256157780771204, 63.483640308267795, 49.476212157838646, 64.37432979011349, 57.72130843014009, 60.41294089076525, 60.39882620961143, 47.9291203384912, 63.20904535265974, 66.2849309509248, 60.62433246206645, 68.50473620346085, 61.7937662763034, 63.50197520450342, 60.64663500489569, 63.28407142339957, 47.20816909560296, 64.37738624609138, 66.49595519270248, 57.87043534843676, 60.64641452168808, 47.45947189852632, 59.86799588754847, 66.39617447387202, 61.83118972754046, 67.33961202701792, 58.19041104958304, 59.556972499118565, 56.82519816268, 65.74613407599013, 42.486071701039926, 62.27461407860325, 64.34373064620873, 61.7955182505358, 56.85993917102768, 50.753154870353924, 61.66500138713598, 65.77614691443809, 59.31178664238594, 60.936493377256134, 62.25063139127647, 61.38464600057772, 59.405501562814074, 62.03767734431335, 45.83913134844168, 63.66803038261016, 63.917773089363756], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7648324770842128, "mean_inference_ms": 7.974425185418619, "mean_action_processing_ms": 0.5660031711484824, "mean_env_wait_ms": 24.185220860769533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04016995429992676, "StateBufferConnector_ms": 0.033624887466430664, "ViewRequirementAgentConnector_ms": 0.9658052921295166}}, "episode_reward_max": 70.72243598434875, "episode_reward_min": 42.486071701039926, "episode_reward_mean": 60.03626384675493, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [65.71964173354327, 63.21413659941888, 58.91609349317801, 62.208470713015146, 50.078925504273904, 59.174287079736416, 68.8184628062112, 61.07555007594842, 67.8847576569281, 60.25163003364826, 67.30202778326344, 61.83547371354622, 65.35763304319855, 47.202511303500046, 62.41095693955519, 66.51654309295097, 56.254461379382384, 60.0298171786177, 50.45850325300907, 63.30469929505975, 63.769506203238564, 57.03438939738828, 64.20479472225891, 64.37573823483488, 63.56053999249011, 63.41070083265935, 61.49073235536302, 46.02846228902188, 61.55346917969372, 59.83007051779165, 58.75551416794115, 61.56344025824201, 44.473919579323805, 58.30206759768154, 68.71257146108191, 59.82622427137907, 68.48060478301635, 47.6362492669701, 62.884162694267836, 57.53416285987868, 57.89157877974309, 46.87304363360603, 62.803021382258734, 63.24375848505897, 59.825534165205354, 61.86073147465468, 47.26594902110639, 60.02143059425523, 70.72243598434875, 54.87221747088027, 69.30652679094634, 58.29168426289045, 62.78717213903662, 60.256157780771204, 63.483640308267795, 49.476212157838646, 64.37432979011349, 57.72130843014009, 60.41294089076525, 60.39882620961143, 47.9291203384912, 63.20904535265974, 66.2849309509248, 60.62433246206645, 68.50473620346085, 61.7937662763034, 63.50197520450342, 60.64663500489569, 63.28407142339957, 47.20816909560296, 64.37738624609138, 66.49595519270248, 57.87043534843676, 60.64641452168808, 47.45947189852632, 59.86799588754847, 66.39617447387202, 61.83118972754046, 67.33961202701792, 58.19041104958304, 59.556972499118565, 56.82519816268, 65.74613407599013, 42.486071701039926, 62.27461407860325, 64.34373064620873, 61.7955182505358, 56.85993917102768, 50.753154870353924, 61.66500138713598, 65.77614691443809, 59.31178664238594, 60.936493377256134, 62.25063139127647, 61.38464600057772, 59.405501562814074, 62.03767734431335, 45.83913134844168, 63.66803038261016, 63.917773089363756], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7648324770842128, "mean_inference_ms": 7.974425185418619, "mean_action_processing_ms": 0.5660031711484824, "mean_env_wait_ms": 24.185220860769533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04016995429992676, "StateBufferConnector_ms": 0.033624887466430664, "ViewRequirementAgentConnector_ms": 0.9658052921295166}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1313862, "num_agent_steps_trained": 1313862, "num_env_steps_sampled": 1313862, "num_env_steps_trained": 1313862, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 230.17831816589464, "num_env_steps_trained_throughput_per_sec": 230.17831816589464, "timesteps_total": 1313862, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1313862, "timers": {"training_iteration_time_ms": 67633.589, "sample_time_ms": 42205.489, "load_time_ms": 2358.347, "load_throughput": 6630.917, "learn_time_ms": 22485.204, "learn_throughput": 695.48, "synch_weights_time_ms": 449.335}, "counters": {"num_env_steps_sampled": 1313862, "num_env_steps_trained": 1313862, "num_agent_steps_sampled": 1313862, "num_agent_steps_trained": 1313862}, "done": false, "episodes_total": 1290, "training_iteration": 92, "trial_id": "837cb_00000", "date": "2025-06-07_19-05-49", "timestamp": 1749315949, "time_this_iter_s": 67.96542310714722, "time_total_s": 6000.209363698959, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6000.209363698959, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 66.99358974358975, "ram_util_percent": 87.49487179487176, "gpu_util_percent0": 0.21384615384615385, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.686138000000002e-05, "total_loss": -0.08959028272423893, "policy_loss": -0.02282448388396667, "vf_loss": 0.01335138005712493, "vf_explained_var": 0.9566944284872575, "kl": 0.01877305289857719, "entropy": 15.884575318423185, "entropy_coeff": 0.004529207}, "model": {}, "num_grad_updates_lifetime": 46515.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1329500, "num_env_steps_trained": 1329500, "num_agent_steps_sampled": 1329500, "num_agent_steps_trained": 1329500}, "sampler_results": {"episode_reward_max": 70.72243598434875, "episode_reward_min": 42.486071701039926, "episode_reward_mean": 59.851640463699596, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.41095693955519, 66.51654309295097, 56.254461379382384, 60.0298171786177, 50.45850325300907, 63.30469929505975, 63.769506203238564, 57.03438939738828, 64.20479472225891, 64.37573823483488, 63.56053999249011, 63.41070083265935, 61.49073235536302, 46.02846228902188, 61.55346917969372, 59.83007051779165, 58.75551416794115, 61.56344025824201, 44.473919579323805, 58.30206759768154, 68.71257146108191, 59.82622427137907, 68.48060478301635, 47.6362492669701, 62.884162694267836, 57.53416285987868, 57.89157877974309, 46.87304363360603, 62.803021382258734, 63.24375848505897, 59.825534165205354, 61.86073147465468, 47.26594902110639, 60.02143059425523, 70.72243598434875, 54.87221747088027, 69.30652679094634, 58.29168426289045, 62.78717213903662, 60.256157780771204, 63.483640308267795, 49.476212157838646, 64.37432979011349, 57.72130843014009, 60.41294089076525, 60.39882620961143, 47.9291203384912, 63.20904535265974, 66.2849309509248, 60.62433246206645, 68.50473620346085, 61.7937662763034, 63.50197520450342, 60.64663500489569, 63.28407142339957, 47.20816909560296, 64.37738624609138, 66.49595519270248, 57.87043534843676, 60.64641452168808, 47.45947189852632, 59.86799588754847, 66.39617447387202, 61.83118972754046, 67.33961202701792, 58.19041104958304, 59.556972499118565, 56.82519816268, 65.74613407599013, 42.486071701039926, 62.27461407860325, 64.34373064620873, 61.7955182505358, 56.85993917102768, 50.753154870353924, 61.66500138713598, 65.77614691443809, 59.31178664238594, 60.936493377256134, 62.25063139127647, 61.38464600057772, 59.405501562814074, 62.03767734431335, 45.83913134844168, 63.66803038261016, 63.917773089363756, 60.778086079822636, 60.62882326071256, 46.08051912077158, 64.03368513669656, 66.01862327419637, 56.88532037212545, 70.52922205622596, 61.78034071663416, 62.96955280907438, 58.70862732069462, 63.413719130921095, 46.16011542617878, 62.2652624300148, 60.325366099808235], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7670279408533407, "mean_inference_ms": 7.977895477106065, "mean_action_processing_ms": 0.5661446185613682, "mean_env_wait_ms": 24.18625703964517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04119372367858887, "StateBufferConnector_ms": 0.03762650489807129, "ViewRequirementAgentConnector_ms": 0.9844362735748291}}, "episode_reward_max": 70.72243598434875, "episode_reward_min": 42.486071701039926, "episode_reward_mean": 59.851640463699596, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [62.41095693955519, 66.51654309295097, 56.254461379382384, 60.0298171786177, 50.45850325300907, 63.30469929505975, 63.769506203238564, 57.03438939738828, 64.20479472225891, 64.37573823483488, 63.56053999249011, 63.41070083265935, 61.49073235536302, 46.02846228902188, 61.55346917969372, 59.83007051779165, 58.75551416794115, 61.56344025824201, 44.473919579323805, 58.30206759768154, 68.71257146108191, 59.82622427137907, 68.48060478301635, 47.6362492669701, 62.884162694267836, 57.53416285987868, 57.89157877974309, 46.87304363360603, 62.803021382258734, 63.24375848505897, 59.825534165205354, 61.86073147465468, 47.26594902110639, 60.02143059425523, 70.72243598434875, 54.87221747088027, 69.30652679094634, 58.29168426289045, 62.78717213903662, 60.256157780771204, 63.483640308267795, 49.476212157838646, 64.37432979011349, 57.72130843014009, 60.41294089076525, 60.39882620961143, 47.9291203384912, 63.20904535265974, 66.2849309509248, 60.62433246206645, 68.50473620346085, 61.7937662763034, 63.50197520450342, 60.64663500489569, 63.28407142339957, 47.20816909560296, 64.37738624609138, 66.49595519270248, 57.87043534843676, 60.64641452168808, 47.45947189852632, 59.86799588754847, 66.39617447387202, 61.83118972754046, 67.33961202701792, 58.19041104958304, 59.556972499118565, 56.82519816268, 65.74613407599013, 42.486071701039926, 62.27461407860325, 64.34373064620873, 61.7955182505358, 56.85993917102768, 50.753154870353924, 61.66500138713598, 65.77614691443809, 59.31178664238594, 60.936493377256134, 62.25063139127647, 61.38464600057772, 59.405501562814074, 62.03767734431335, 45.83913134844168, 63.66803038261016, 63.917773089363756, 60.778086079822636, 60.62882326071256, 46.08051912077158, 64.03368513669656, 66.01862327419637, 56.88532037212545, 70.52922205622596, 61.78034071663416, 62.96955280907438, 58.70862732069462, 63.413719130921095, 46.16011542617878, 62.2652624300148, 60.325366099808235], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7670279408533407, "mean_inference_ms": 7.977895477106065, "mean_action_processing_ms": 0.5661446185613682, "mean_env_wait_ms": 24.18625703964517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04119372367858887, "StateBufferConnector_ms": 0.03762650489807129, "ViewRequirementAgentConnector_ms": 0.9844362735748291}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1329500, "num_agent_steps_trained": 1329500, "num_env_steps_sampled": 1329500, "num_env_steps_trained": 1329500, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 230.55673004268493, "num_env_steps_trained_throughput_per_sec": 230.55673004268493, "timesteps_total": 1329500, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1329500, "timers": {"training_iteration_time_ms": 67688.808, "sample_time_ms": 42225.852, "load_time_ms": 2357.331, "load_throughput": 6633.774, "learn_time_ms": 22517.708, "learn_throughput": 694.476, "synch_weights_time_ms": 455.794}, "counters": {"num_env_steps_sampled": 1329500, "num_env_steps_trained": 1329500, "num_agent_steps_sampled": 1329500, "num_agent_steps_trained": 1329500}, "done": false, "episodes_total": 1304, "training_iteration": 93, "trial_id": "837cb_00000", "date": "2025-06-07_19-06-57", "timestamp": 1749316017, "time_this_iter_s": 67.84864330291748, "time_total_s": 6068.058007001877, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6068.058007001877, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 65.3848101265823, "ram_util_percent": 89.60126582278481, "gpu_util_percent0": 0.21822784810126586, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.670499999999999e-05, "total_loss": -0.08705247982468625, "policy_loss": -0.020649462136074857, "vf_loss": 0.014819470530968498, "vf_explained_var": 0.9589565484090284, "kl": 0.01945129500158619, "entropy": 15.993911772641269, "entropy_coeff": 0.004505749999999999}, "model": {}, "num_grad_updates_lifetime": 47065.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1345138, "num_env_steps_trained": 1345138, "num_agent_steps_sampled": 1345138, "num_agent_steps_trained": 1345138}, "sampler_results": {"episode_reward_max": 70.72243598434875, "episode_reward_min": 42.486071701039926, "episode_reward_mean": 59.62638521672048, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.55346917969372, 59.83007051779165, 58.75551416794115, 61.56344025824201, 44.473919579323805, 58.30206759768154, 68.71257146108191, 59.82622427137907, 68.48060478301635, 47.6362492669701, 62.884162694267836, 57.53416285987868, 57.89157877974309, 46.87304363360603, 62.803021382258734, 63.24375848505897, 59.825534165205354, 61.86073147465468, 47.26594902110639, 60.02143059425523, 70.72243598434875, 54.87221747088027, 69.30652679094634, 58.29168426289045, 62.78717213903662, 60.256157780771204, 63.483640308267795, 49.476212157838646, 64.37432979011349, 57.72130843014009, 60.41294089076525, 60.39882620961143, 47.9291203384912, 63.20904535265974, 66.2849309509248, 60.62433246206645, 68.50473620346085, 61.7937662763034, 63.50197520450342, 60.64663500489569, 63.28407142339957, 47.20816909560296, 64.37738624609138, 66.49595519270248, 57.87043534843676, 60.64641452168808, 47.45947189852632, 59.86799588754847, 66.39617447387202, 61.83118972754046, 67.33961202701792, 58.19041104958304, 59.556972499118565, 56.82519816268, 65.74613407599013, 42.486071701039926, 62.27461407860325, 64.34373064620873, 61.7955182505358, 56.85993917102768, 50.753154870353924, 61.66500138713598, 65.77614691443809, 59.31178664238594, 60.936493377256134, 62.25063139127647, 61.38464600057772, 59.405501562814074, 62.03767734431335, 45.83913134844168, 63.66803038261016, 63.917773089363756, 60.778086079822636, 60.62882326071256, 46.08051912077158, 64.03368513669656, 66.01862327419637, 56.88532037212545, 70.52922205622596, 61.78034071663416, 62.96955280907438, 58.70862732069462, 63.413719130921095, 46.16011542617878, 62.2652624300148, 60.325366099808235, 60.13570816031889, 60.5678606108766, 44.17109664510082, 59.71197797563352, 67.05747371699076, 51.82144498489584, 65.99807434150705, 60.01948340490908, 66.79859358979077, 54.76954313352528, 62.544036331060596, 43.60105329971609, 57.80223158713173, 65.32574268645979], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7693952421729717, "mean_inference_ms": 7.982079729145472, "mean_action_processing_ms": 0.5663257044380309, "mean_env_wait_ms": 24.187866887907056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03517627716064453, "StateBufferConnector_ms": 0.03765249252319336, "ViewRequirementAgentConnector_ms": 0.977142333984375}}, "episode_reward_max": 70.72243598434875, "episode_reward_min": 42.486071701039926, "episode_reward_mean": 59.62638521672048, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [61.55346917969372, 59.83007051779165, 58.75551416794115, 61.56344025824201, 44.473919579323805, 58.30206759768154, 68.71257146108191, 59.82622427137907, 68.48060478301635, 47.6362492669701, 62.884162694267836, 57.53416285987868, 57.89157877974309, 46.87304363360603, 62.803021382258734, 63.24375848505897, 59.825534165205354, 61.86073147465468, 47.26594902110639, 60.02143059425523, 70.72243598434875, 54.87221747088027, 69.30652679094634, 58.29168426289045, 62.78717213903662, 60.256157780771204, 63.483640308267795, 49.476212157838646, 64.37432979011349, 57.72130843014009, 60.41294089076525, 60.39882620961143, 47.9291203384912, 63.20904535265974, 66.2849309509248, 60.62433246206645, 68.50473620346085, 61.7937662763034, 63.50197520450342, 60.64663500489569, 63.28407142339957, 47.20816909560296, 64.37738624609138, 66.49595519270248, 57.87043534843676, 60.64641452168808, 47.45947189852632, 59.86799588754847, 66.39617447387202, 61.83118972754046, 67.33961202701792, 58.19041104958304, 59.556972499118565, 56.82519816268, 65.74613407599013, 42.486071701039926, 62.27461407860325, 64.34373064620873, 61.7955182505358, 56.85993917102768, 50.753154870353924, 61.66500138713598, 65.77614691443809, 59.31178664238594, 60.936493377256134, 62.25063139127647, 61.38464600057772, 59.405501562814074, 62.03767734431335, 45.83913134844168, 63.66803038261016, 63.917773089363756, 60.778086079822636, 60.62882326071256, 46.08051912077158, 64.03368513669656, 66.01862327419637, 56.88532037212545, 70.52922205622596, 61.78034071663416, 62.96955280907438, 58.70862732069462, 63.413719130921095, 46.16011542617878, 62.2652624300148, 60.325366099808235, 60.13570816031889, 60.5678606108766, 44.17109664510082, 59.71197797563352, 67.05747371699076, 51.82144498489584, 65.99807434150705, 60.01948340490908, 66.79859358979077, 54.76954313352528, 62.544036331060596, 43.60105329971609, 57.80223158713173, 65.32574268645979], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7693952421729717, "mean_inference_ms": 7.982079729145472, "mean_action_processing_ms": 0.5663257044380309, "mean_env_wait_ms": 24.187866887907056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03517627716064453, "StateBufferConnector_ms": 0.03765249252319336, "ViewRequirementAgentConnector_ms": 0.977142333984375}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1345138, "num_agent_steps_trained": 1345138, "num_env_steps_sampled": 1345138, "num_env_steps_trained": 1345138, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 222.08974580418985, "num_env_steps_trained_throughput_per_sec": 222.08974580418985, "timesteps_total": 1345138, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1345138, "timers": {"training_iteration_time_ms": 68056.614, "sample_time_ms": 42387.275, "load_time_ms": 2396.366, "load_throughput": 6525.714, "learn_time_ms": 22684.323, "learn_throughput": 689.375, "synch_weights_time_ms": 454.464}, "counters": {"num_env_steps_sampled": 1345138, "num_env_steps_trained": 1345138, "num_agent_steps_sampled": 1345138, "num_agent_steps_trained": 1345138}, "done": false, "episodes_total": 1318, "training_iteration": 94, "trial_id": "837cb_00000", "date": "2025-06-07_19-08-07", "timestamp": 1749316087, "time_this_iter_s": 70.4325110912323, "time_total_s": 6138.490518093109, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6138.490518093109, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 67.58395061728395, "ram_util_percent": 88.3, "gpu_util_percent0": 0.21197530864197528, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.654862e-05, "total_loss": -0.09519617135170848, "policy_loss": -0.028800028119585475, "vf_loss": 0.014946182889186524, "vf_explained_var": 0.9553449027104811, "kl": 0.01852685495438738, "entropy": 16.071667707616633, "entropy_coeff": 0.004482293}, "model": {}, "num_grad_updates_lifetime": 47615.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1360776, "num_env_steps_trained": 1360776, "num_agent_steps_sampled": 1360776, "num_agent_steps_trained": 1360776}, "sampler_results": {"episode_reward_max": 70.72243598434875, "episode_reward_min": 42.486071701039926, "episode_reward_mean": 59.593231295522756, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.803021382258734, 63.24375848505897, 59.825534165205354, 61.86073147465468, 47.26594902110639, 60.02143059425523, 70.72243598434875, 54.87221747088027, 69.30652679094634, 58.29168426289045, 62.78717213903662, 60.256157780771204, 63.483640308267795, 49.476212157838646, 64.37432979011349, 57.72130843014009, 60.41294089076525, 60.39882620961143, 47.9291203384912, 63.20904535265974, 66.2849309509248, 60.62433246206645, 68.50473620346085, 61.7937662763034, 63.50197520450342, 60.64663500489569, 63.28407142339957, 47.20816909560296, 64.37738624609138, 66.49595519270248, 57.87043534843676, 60.64641452168808, 47.45947189852632, 59.86799588754847, 66.39617447387202, 61.83118972754046, 67.33961202701792, 58.19041104958304, 59.556972499118565, 56.82519816268, 65.74613407599013, 42.486071701039926, 62.27461407860325, 64.34373064620873, 61.7955182505358, 56.85993917102768, 50.753154870353924, 61.66500138713598, 65.77614691443809, 59.31178664238594, 60.936493377256134, 62.25063139127647, 61.38464600057772, 59.405501562814074, 62.03767734431335, 45.83913134844168, 63.66803038261016, 63.917773089363756, 60.778086079822636, 60.62882326071256, 46.08051912077158, 64.03368513669656, 66.01862327419637, 56.88532037212545, 70.52922205622596, 61.78034071663416, 62.96955280907438, 58.70862732069462, 63.413719130921095, 46.16011542617878, 62.2652624300148, 60.325366099808235, 60.13570816031889, 60.5678606108766, 44.17109664510082, 59.71197797563352, 67.05747371699076, 51.82144498489584, 65.99807434150705, 60.01948340490908, 66.79859358979077, 54.76954313352528, 62.544036331060596, 43.60105329971609, 57.80223158713173, 65.32574268645979, 58.3455431300265, 60.71068690314692, 45.635338486349355, 60.71235941326762, 64.17235547123671, 49.637565631976436, 61.242616218245054, 60.45531373557457, 58.3842478868608, 62.24491695367508, 62.11713992052473, 45.389577562563, 60.464343094892136, 61.48968252250487], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.772249098284343, "mean_inference_ms": 7.986579160164163, "mean_action_processing_ms": 0.5665046192142352, "mean_env_wait_ms": 24.190060017059647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030159950256347656, "StateBufferConnector_ms": 0.03767228126525879, "ViewRequirementAgentConnector_ms": 0.980614423751831}}, "episode_reward_max": 70.72243598434875, "episode_reward_min": 42.486071701039926, "episode_reward_mean": 59.593231295522756, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [62.803021382258734, 63.24375848505897, 59.825534165205354, 61.86073147465468, 47.26594902110639, 60.02143059425523, 70.72243598434875, 54.87221747088027, 69.30652679094634, 58.29168426289045, 62.78717213903662, 60.256157780771204, 63.483640308267795, 49.476212157838646, 64.37432979011349, 57.72130843014009, 60.41294089076525, 60.39882620961143, 47.9291203384912, 63.20904535265974, 66.2849309509248, 60.62433246206645, 68.50473620346085, 61.7937662763034, 63.50197520450342, 60.64663500489569, 63.28407142339957, 47.20816909560296, 64.37738624609138, 66.49595519270248, 57.87043534843676, 60.64641452168808, 47.45947189852632, 59.86799588754847, 66.39617447387202, 61.83118972754046, 67.33961202701792, 58.19041104958304, 59.556972499118565, 56.82519816268, 65.74613407599013, 42.486071701039926, 62.27461407860325, 64.34373064620873, 61.7955182505358, 56.85993917102768, 50.753154870353924, 61.66500138713598, 65.77614691443809, 59.31178664238594, 60.936493377256134, 62.25063139127647, 61.38464600057772, 59.405501562814074, 62.03767734431335, 45.83913134844168, 63.66803038261016, 63.917773089363756, 60.778086079822636, 60.62882326071256, 46.08051912077158, 64.03368513669656, 66.01862327419637, 56.88532037212545, 70.52922205622596, 61.78034071663416, 62.96955280907438, 58.70862732069462, 63.413719130921095, 46.16011542617878, 62.2652624300148, 60.325366099808235, 60.13570816031889, 60.5678606108766, 44.17109664510082, 59.71197797563352, 67.05747371699076, 51.82144498489584, 65.99807434150705, 60.01948340490908, 66.79859358979077, 54.76954313352528, 62.544036331060596, 43.60105329971609, 57.80223158713173, 65.32574268645979, 58.3455431300265, 60.71068690314692, 45.635338486349355, 60.71235941326762, 64.17235547123671, 49.637565631976436, 61.242616218245054, 60.45531373557457, 58.3842478868608, 62.24491695367508, 62.11713992052473, 45.389577562563, 60.464343094892136, 61.48968252250487], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.772249098284343, "mean_inference_ms": 7.986579160164163, "mean_action_processing_ms": 0.5665046192142352, "mean_env_wait_ms": 24.190060017059647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030159950256347656, "StateBufferConnector_ms": 0.03767228126525879, "ViewRequirementAgentConnector_ms": 0.980614423751831}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360776, "num_agent_steps_trained": 1360776, "num_env_steps_sampled": 1360776, "num_env_steps_trained": 1360776, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.54410208989796, "num_env_steps_trained_throughput_per_sec": 228.54410208989796, "timesteps_total": 1360776, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1360776, "timers": {"training_iteration_time_ms": 68260.209, "sample_time_ms": 42559.556, "load_time_ms": 2417.558, "load_throughput": 6468.511, "learn_time_ms": 22700.883, "learn_throughput": 688.872, "synch_weights_time_ms": 452.757}, "counters": {"num_env_steps_sampled": 1360776, "num_env_steps_trained": 1360776, "num_agent_steps_sampled": 1360776, "num_agent_steps_trained": 1360776}, "done": false, "episodes_total": 1332, "training_iteration": 95, "trial_id": "837cb_00000", "date": "2025-06-07_19-09-16", "timestamp": 1749316156, "time_this_iter_s": 68.44799160957336, "time_total_s": 6206.9385097026825, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6206.9385097026825, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 66.69615384615383, "ram_util_percent": 86.25000000000003, "gpu_util_percent0": 0.2101282051282051, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.639224000000003e-05, "total_loss": -0.10032157128930769, "policy_loss": -0.034035534673920745, "vf_loss": 0.014261554974893278, "vf_explained_var": 0.957546373497356, "kl": 0.01885003345785957, "entropy": 16.08999187296087, "entropy_coeff": 0.004458836}, "model": {}, "num_grad_updates_lifetime": 48165.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1376414, "num_env_steps_trained": 1376414, "num_agent_steps_sampled": 1376414, "num_agent_steps_trained": 1376414}, "sampler_results": {"episode_reward_max": 70.52922205622596, "episode_reward_min": 42.486071701039926, "episode_reward_mean": 59.3666547724649, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.37432979011349, 57.72130843014009, 60.41294089076525, 60.39882620961143, 47.9291203384912, 63.20904535265974, 66.2849309509248, 60.62433246206645, 68.50473620346085, 61.7937662763034, 63.50197520450342, 60.64663500489569, 63.28407142339957, 47.20816909560296, 64.37738624609138, 66.49595519270248, 57.87043534843676, 60.64641452168808, 47.45947189852632, 59.86799588754847, 66.39617447387202, 61.83118972754046, 67.33961202701792, 58.19041104958304, 59.556972499118565, 56.82519816268, 65.74613407599013, 42.486071701039926, 62.27461407860325, 64.34373064620873, 61.7955182505358, 56.85993917102768, 50.753154870353924, 61.66500138713598, 65.77614691443809, 59.31178664238594, 60.936493377256134, 62.25063139127647, 61.38464600057772, 59.405501562814074, 62.03767734431335, 45.83913134844168, 63.66803038261016, 63.917773089363756, 60.778086079822636, 60.62882326071256, 46.08051912077158, 64.03368513669656, 66.01862327419637, 56.88532037212545, 70.52922205622596, 61.78034071663416, 62.96955280907438, 58.70862732069462, 63.413719130921095, 46.16011542617878, 62.2652624300148, 60.325366099808235, 60.13570816031889, 60.5678606108766, 44.17109664510082, 59.71197797563352, 67.05747371699076, 51.82144498489584, 65.99807434150705, 60.01948340490908, 66.79859358979077, 54.76954313352528, 62.544036331060596, 43.60105329971609, 57.80223158713173, 65.32574268645979, 58.3455431300265, 60.71068690314692, 45.635338486349355, 60.71235941326762, 64.17235547123671, 49.637565631976436, 61.242616218245054, 60.45531373557457, 58.3842478868608, 62.24491695367508, 62.11713992052473, 45.389577562563, 60.464343094892136, 61.48968252250487, 53.426907736240885, 60.795908931721726, 47.84515139008608, 58.138227298601926, 69.7985664036128, 59.034221198921834, 61.3227187231555, 60.68544644697587, 61.324411225824555, 61.128004450082784, 57.099461153503555, 44.66854983310562, 62.29878623104605, 63.992458688857795], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7748960568455288, "mean_inference_ms": 7.991352624787774, "mean_action_processing_ms": 0.5667044629268703, "mean_env_wait_ms": 24.19316064054109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028139829635620117, "StateBufferConnector_ms": 0.034879446029663086, "ViewRequirementAgentConnector_ms": 0.994683027267456}}, "episode_reward_max": 70.52922205622596, "episode_reward_min": 42.486071701039926, "episode_reward_mean": 59.3666547724649, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.37432979011349, 57.72130843014009, 60.41294089076525, 60.39882620961143, 47.9291203384912, 63.20904535265974, 66.2849309509248, 60.62433246206645, 68.50473620346085, 61.7937662763034, 63.50197520450342, 60.64663500489569, 63.28407142339957, 47.20816909560296, 64.37738624609138, 66.49595519270248, 57.87043534843676, 60.64641452168808, 47.45947189852632, 59.86799588754847, 66.39617447387202, 61.83118972754046, 67.33961202701792, 58.19041104958304, 59.556972499118565, 56.82519816268, 65.74613407599013, 42.486071701039926, 62.27461407860325, 64.34373064620873, 61.7955182505358, 56.85993917102768, 50.753154870353924, 61.66500138713598, 65.77614691443809, 59.31178664238594, 60.936493377256134, 62.25063139127647, 61.38464600057772, 59.405501562814074, 62.03767734431335, 45.83913134844168, 63.66803038261016, 63.917773089363756, 60.778086079822636, 60.62882326071256, 46.08051912077158, 64.03368513669656, 66.01862327419637, 56.88532037212545, 70.52922205622596, 61.78034071663416, 62.96955280907438, 58.70862732069462, 63.413719130921095, 46.16011542617878, 62.2652624300148, 60.325366099808235, 60.13570816031889, 60.5678606108766, 44.17109664510082, 59.71197797563352, 67.05747371699076, 51.82144498489584, 65.99807434150705, 60.01948340490908, 66.79859358979077, 54.76954313352528, 62.544036331060596, 43.60105329971609, 57.80223158713173, 65.32574268645979, 58.3455431300265, 60.71068690314692, 45.635338486349355, 60.71235941326762, 64.17235547123671, 49.637565631976436, 61.242616218245054, 60.45531373557457, 58.3842478868608, 62.24491695367508, 62.11713992052473, 45.389577562563, 60.464343094892136, 61.48968252250487, 53.426907736240885, 60.795908931721726, 47.84515139008608, 58.138227298601926, 69.7985664036128, 59.034221198921834, 61.3227187231555, 60.68544644697587, 61.324411225824555, 61.128004450082784, 57.099461153503555, 44.66854983310562, 62.29878623104605, 63.992458688857795], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7748960568455288, "mean_inference_ms": 7.991352624787774, "mean_action_processing_ms": 0.5667044629268703, "mean_env_wait_ms": 24.19316064054109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028139829635620117, "StateBufferConnector_ms": 0.034879446029663086, "ViewRequirementAgentConnector_ms": 0.994683027267456}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376414, "num_agent_steps_trained": 1376414, "num_env_steps_sampled": 1376414, "num_env_steps_trained": 1376414, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.02074315057968, "num_env_steps_trained_throughput_per_sec": 227.02074315057968, "timesteps_total": 1376414, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1376414, "timers": {"training_iteration_time_ms": 68368.727, "sample_time_ms": 42643.3, "load_time_ms": 2444.183, "load_throughput": 6398.048, "learn_time_ms": 22700.63, "learn_throughput": 688.88, "synch_weights_time_ms": 454.556}, "counters": {"num_env_steps_sampled": 1376414, "num_env_steps_trained": 1376414, "num_agent_steps_sampled": 1376414, "num_agent_steps_trained": 1376414}, "done": false, "episodes_total": 1346, "training_iteration": 96, "trial_id": "837cb_00000", "date": "2025-06-07_19-10-25", "timestamp": 1749316225, "time_this_iter_s": 68.90661215782166, "time_total_s": 6275.845121860504, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6275.845121860504, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 66.47874999999999, "ram_util_percent": 89.92875000000001, "gpu_util_percent0": 0.22549999999999998, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.623585999999998e-05, "total_loss": -0.08050022007368336, "policy_loss": -0.015302266719174276, "vf_loss": 0.016267742959951814, "vf_explained_var": 0.9537652027606964, "kl": 0.019137243636232534, "entropy": 16.069506702423094, "entropy_coeff": 0.004435379}, "model": {}, "num_grad_updates_lifetime": 48715.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1392052, "num_env_steps_trained": 1392052, "num_agent_steps_sampled": 1392052, "num_agent_steps_trained": 1392052}, "sampler_results": {"episode_reward_max": 70.52922205622596, "episode_reward_min": 37.74102077017214, "episode_reward_mean": 58.97598289376907, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.37738624609138, 66.49595519270248, 57.87043534843676, 60.64641452168808, 47.45947189852632, 59.86799588754847, 66.39617447387202, 61.83118972754046, 67.33961202701792, 58.19041104958304, 59.556972499118565, 56.82519816268, 65.74613407599013, 42.486071701039926, 62.27461407860325, 64.34373064620873, 61.7955182505358, 56.85993917102768, 50.753154870353924, 61.66500138713598, 65.77614691443809, 59.31178664238594, 60.936493377256134, 62.25063139127647, 61.38464600057772, 59.405501562814074, 62.03767734431335, 45.83913134844168, 63.66803038261016, 63.917773089363756, 60.778086079822636, 60.62882326071256, 46.08051912077158, 64.03368513669656, 66.01862327419637, 56.88532037212545, 70.52922205622596, 61.78034071663416, 62.96955280907438, 58.70862732069462, 63.413719130921095, 46.16011542617878, 62.2652624300148, 60.325366099808235, 60.13570816031889, 60.5678606108766, 44.17109664510082, 59.71197797563352, 67.05747371699076, 51.82144498489584, 65.99807434150705, 60.01948340490908, 66.79859358979077, 54.76954313352528, 62.544036331060596, 43.60105329971609, 57.80223158713173, 65.32574268645979, 58.3455431300265, 60.71068690314692, 45.635338486349355, 60.71235941326762, 64.17235547123671, 49.637565631976436, 61.242616218245054, 60.45531373557457, 58.3842478868608, 62.24491695367508, 62.11713992052473, 45.389577562563, 60.464343094892136, 61.48968252250487, 53.426907736240885, 60.795908931721726, 47.84515139008608, 58.138227298601926, 69.7985664036128, 59.034221198921834, 61.3227187231555, 60.68544644697587, 61.324411225824555, 61.128004450082784, 57.099461153503555, 44.66854983310562, 62.29878623104605, 63.992458688857795, 57.76846517950449, 58.16757931215182, 37.74102077017214, 59.64250208038432, 57.39392385301981, 59.09389410117665, 64.60544797907019, 57.37651361449567, 65.04850932518889, 57.288159536674364, 65.24612615602294, 43.45207098417775, 60.56466689567457, 63.438119975640106], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7773433474336273, "mean_inference_ms": 7.9959269421103, "mean_action_processing_ms": 0.566899622498106, "mean_env_wait_ms": 24.19618754930009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027106046676635742, "StateBufferConnector_ms": 0.03386259078979492, "ViewRequirementAgentConnector_ms": 0.9917898178100586}}, "episode_reward_max": 70.52922205622596, "episode_reward_min": 37.74102077017214, "episode_reward_mean": 58.97598289376907, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.37738624609138, 66.49595519270248, 57.87043534843676, 60.64641452168808, 47.45947189852632, 59.86799588754847, 66.39617447387202, 61.83118972754046, 67.33961202701792, 58.19041104958304, 59.556972499118565, 56.82519816268, 65.74613407599013, 42.486071701039926, 62.27461407860325, 64.34373064620873, 61.7955182505358, 56.85993917102768, 50.753154870353924, 61.66500138713598, 65.77614691443809, 59.31178664238594, 60.936493377256134, 62.25063139127647, 61.38464600057772, 59.405501562814074, 62.03767734431335, 45.83913134844168, 63.66803038261016, 63.917773089363756, 60.778086079822636, 60.62882326071256, 46.08051912077158, 64.03368513669656, 66.01862327419637, 56.88532037212545, 70.52922205622596, 61.78034071663416, 62.96955280907438, 58.70862732069462, 63.413719130921095, 46.16011542617878, 62.2652624300148, 60.325366099808235, 60.13570816031889, 60.5678606108766, 44.17109664510082, 59.71197797563352, 67.05747371699076, 51.82144498489584, 65.99807434150705, 60.01948340490908, 66.79859358979077, 54.76954313352528, 62.544036331060596, 43.60105329971609, 57.80223158713173, 65.32574268645979, 58.3455431300265, 60.71068690314692, 45.635338486349355, 60.71235941326762, 64.17235547123671, 49.637565631976436, 61.242616218245054, 60.45531373557457, 58.3842478868608, 62.24491695367508, 62.11713992052473, 45.389577562563, 60.464343094892136, 61.48968252250487, 53.426907736240885, 60.795908931721726, 47.84515139008608, 58.138227298601926, 69.7985664036128, 59.034221198921834, 61.3227187231555, 60.68544644697587, 61.324411225824555, 61.128004450082784, 57.099461153503555, 44.66854983310562, 62.29878623104605, 63.992458688857795, 57.76846517950449, 58.16757931215182, 37.74102077017214, 59.64250208038432, 57.39392385301981, 59.09389410117665, 64.60544797907019, 57.37651361449567, 65.04850932518889, 57.288159536674364, 65.24612615602294, 43.45207098417775, 60.56466689567457, 63.438119975640106], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7773433474336273, "mean_inference_ms": 7.9959269421103, "mean_action_processing_ms": 0.566899622498106, "mean_env_wait_ms": 24.19618754930009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027106046676635742, "StateBufferConnector_ms": 0.03386259078979492, "ViewRequirementAgentConnector_ms": 0.9917898178100586}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392052, "num_agent_steps_trained": 1392052, "num_env_steps_sampled": 1392052, "num_env_steps_trained": 1392052, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 230.80982142493937, "num_env_steps_trained_throughput_per_sec": 230.80982142493937, "timesteps_total": 1392052, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1392052, "timers": {"training_iteration_time_ms": 68459.33, "sample_time_ms": 42747.887, "load_time_ms": 2480.469, "load_throughput": 6304.454, "learn_time_ms": 22652.977, "learn_throughput": 690.329, "synch_weights_time_ms": 453.586}, "counters": {"num_env_steps_sampled": 1392052, "num_env_steps_trained": 1392052, "num_agent_steps_sampled": 1392052, "num_agent_steps_trained": 1392052}, "done": false, "episodes_total": 1360, "training_iteration": 97, "trial_id": "837cb_00000", "date": "2025-06-07_19-11-33", "timestamp": 1749316293, "time_this_iter_s": 67.77328658103943, "time_total_s": 6343.618408441544, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6343.618408441544, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 66.226582278481, "ram_util_percent": 90.01898734177216, "gpu_util_percent0": 0.2165822784810127, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.607948000000001e-05, "total_loss": -0.07550578453620388, "policy_loss": -0.010062328468775377, "vf_loss": 0.01453960723455318, "vf_explained_var": 0.9549079607833516, "kl": 0.019269136885603604, "entropy": 16.09495027542114, "entropy_coeff": 0.0044119219999999995}, "model": {}, "num_grad_updates_lifetime": 49265.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1407690, "num_env_steps_trained": 1407690, "num_agent_steps_sampled": 1407690, "num_agent_steps_trained": 1407690}, "sampler_results": {"episode_reward_max": 70.52922205622596, "episode_reward_min": 37.74102077017214, "episode_reward_mean": 58.722143083367904, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.27461407860325, 64.34373064620873, 61.7955182505358, 56.85993917102768, 50.753154870353924, 61.66500138713598, 65.77614691443809, 59.31178664238594, 60.936493377256134, 62.25063139127647, 61.38464600057772, 59.405501562814074, 62.03767734431335, 45.83913134844168, 63.66803038261016, 63.917773089363756, 60.778086079822636, 60.62882326071256, 46.08051912077158, 64.03368513669656, 66.01862327419637, 56.88532037212545, 70.52922205622596, 61.78034071663416, 62.96955280907438, 58.70862732069462, 63.413719130921095, 46.16011542617878, 62.2652624300148, 60.325366099808235, 60.13570816031889, 60.5678606108766, 44.17109664510082, 59.71197797563352, 67.05747371699076, 51.82144498489584, 65.99807434150705, 60.01948340490908, 66.79859358979077, 54.76954313352528, 62.544036331060596, 43.60105329971609, 57.80223158713173, 65.32574268645979, 58.3455431300265, 60.71068690314692, 45.635338486349355, 60.71235941326762, 64.17235547123671, 49.637565631976436, 61.242616218245054, 60.45531373557457, 58.3842478868608, 62.24491695367508, 62.11713992052473, 45.389577562563, 60.464343094892136, 61.48968252250487, 53.426907736240885, 60.795908931721726, 47.84515139008608, 58.138227298601926, 69.7985664036128, 59.034221198921834, 61.3227187231555, 60.68544644697587, 61.324411225824555, 61.128004450082784, 57.099461153503555, 44.66854983310562, 62.29878623104605, 63.992458688857795, 57.76846517950449, 58.16757931215182, 37.74102077017214, 59.64250208038432, 57.39392385301981, 59.09389410117665, 64.60544797907019, 57.37651361449567, 65.04850932518889, 57.288159536674364, 65.24612615602294, 43.45207098417775, 60.56466689567457, 63.438119975640106, 59.565471897059545, 59.56354965051271, 48.75647230649911, 61.485777550262874, 60.34381380922306, 53.886698447273154, 63.03605442835702, 60.79922933759683, 60.74820815031798, 56.4704292823348, 58.525783414641765, 44.18150925971247, 60.60810578962771, 61.734338448300484], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7798829917069092, "mean_inference_ms": 8.000199262627273, "mean_action_processing_ms": 0.5670640216384111, "mean_env_wait_ms": 24.19891619311916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03853750228881836, "StateBufferConnector_ms": 0.0311434268951416, "ViewRequirementAgentConnector_ms": 0.966010332107544}}, "episode_reward_max": 70.52922205622596, "episode_reward_min": 37.74102077017214, "episode_reward_mean": 58.722143083367904, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [62.27461407860325, 64.34373064620873, 61.7955182505358, 56.85993917102768, 50.753154870353924, 61.66500138713598, 65.77614691443809, 59.31178664238594, 60.936493377256134, 62.25063139127647, 61.38464600057772, 59.405501562814074, 62.03767734431335, 45.83913134844168, 63.66803038261016, 63.917773089363756, 60.778086079822636, 60.62882326071256, 46.08051912077158, 64.03368513669656, 66.01862327419637, 56.88532037212545, 70.52922205622596, 61.78034071663416, 62.96955280907438, 58.70862732069462, 63.413719130921095, 46.16011542617878, 62.2652624300148, 60.325366099808235, 60.13570816031889, 60.5678606108766, 44.17109664510082, 59.71197797563352, 67.05747371699076, 51.82144498489584, 65.99807434150705, 60.01948340490908, 66.79859358979077, 54.76954313352528, 62.544036331060596, 43.60105329971609, 57.80223158713173, 65.32574268645979, 58.3455431300265, 60.71068690314692, 45.635338486349355, 60.71235941326762, 64.17235547123671, 49.637565631976436, 61.242616218245054, 60.45531373557457, 58.3842478868608, 62.24491695367508, 62.11713992052473, 45.389577562563, 60.464343094892136, 61.48968252250487, 53.426907736240885, 60.795908931721726, 47.84515139008608, 58.138227298601926, 69.7985664036128, 59.034221198921834, 61.3227187231555, 60.68544644697587, 61.324411225824555, 61.128004450082784, 57.099461153503555, 44.66854983310562, 62.29878623104605, 63.992458688857795, 57.76846517950449, 58.16757931215182, 37.74102077017214, 59.64250208038432, 57.39392385301981, 59.09389410117665, 64.60544797907019, 57.37651361449567, 65.04850932518889, 57.288159536674364, 65.24612615602294, 43.45207098417775, 60.56466689567457, 63.438119975640106, 59.565471897059545, 59.56354965051271, 48.75647230649911, 61.485777550262874, 60.34381380922306, 53.886698447273154, 63.03605442835702, 60.79922933759683, 60.74820815031798, 56.4704292823348, 58.525783414641765, 44.18150925971247, 60.60810578962771, 61.734338448300484], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7798829917069092, "mean_inference_ms": 8.000199262627273, "mean_action_processing_ms": 0.5670640216384111, "mean_env_wait_ms": 24.19891619311916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03853750228881836, "StateBufferConnector_ms": 0.0311434268951416, "ViewRequirementAgentConnector_ms": 0.966010332107544}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1407690, "num_agent_steps_trained": 1407690, "num_env_steps_sampled": 1407690, "num_env_steps_trained": 1407690, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 230.83447864360565, "num_env_steps_trained_throughput_per_sec": 230.83447864360565, "timesteps_total": 1407690, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1407690, "timers": {"training_iteration_time_ms": 68466.575, "sample_time_ms": 42786.05, "load_time_ms": 2465.088, "load_throughput": 6343.789, "learn_time_ms": 22616.594, "learn_throughput": 691.439, "synch_weights_time_ms": 466.25}, "counters": {"num_env_steps_sampled": 1407690, "num_env_steps_trained": 1407690, "num_agent_steps_sampled": 1407690, "num_agent_steps_trained": 1407690}, "done": false, "episodes_total": 1374, "training_iteration": 98, "trial_id": "837cb_00000", "date": "2025-06-07_19-12-40", "timestamp": 1749316360, "time_this_iter_s": 67.7615134716034, "time_total_s": 6411.379921913147, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6411.379921913147, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 66.09873417721519, "ram_util_percent": 89.65696202531646, "gpu_util_percent0": 0.2211392405063291, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.592310000000002e-05, "total_loss": -0.07784268740437586, "policy_loss": -0.01241105280467309, "vf_loss": 0.014209276091900062, "vf_explained_var": 0.9566715960069136, "kl": 0.019268837404329223, "entropy": 16.1556989773837, "entropy_coeff": 0.004388465}, "model": {}, "num_grad_updates_lifetime": 49815.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1423328, "num_env_steps_trained": 1423328, "num_agent_steps_sampled": 1423328, "num_agent_steps_trained": 1423328}, "sampler_results": {"episode_reward_max": 70.52922205622596, "episode_reward_min": 37.74102077017214, "episode_reward_mean": 58.38773171111046, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [63.66803038261016, 63.917773089363756, 60.778086079822636, 60.62882326071256, 46.08051912077158, 64.03368513669656, 66.01862327419637, 56.88532037212545, 70.52922205622596, 61.78034071663416, 62.96955280907438, 58.70862732069462, 63.413719130921095, 46.16011542617878, 62.2652624300148, 60.325366099808235, 60.13570816031889, 60.5678606108766, 44.17109664510082, 59.71197797563352, 67.05747371699076, 51.82144498489584, 65.99807434150705, 60.01948340490908, 66.79859358979077, 54.76954313352528, 62.544036331060596, 43.60105329971609, 57.80223158713173, 65.32574268645979, 58.3455431300265, 60.71068690314692, 45.635338486349355, 60.71235941326762, 64.17235547123671, 49.637565631976436, 61.242616218245054, 60.45531373557457, 58.3842478868608, 62.24491695367508, 62.11713992052473, 45.389577562563, 60.464343094892136, 61.48968252250487, 53.426907736240885, 60.795908931721726, 47.84515139008608, 58.138227298601926, 69.7985664036128, 59.034221198921834, 61.3227187231555, 60.68544644697587, 61.324411225824555, 61.128004450082784, 57.099461153503555, 44.66854983310562, 62.29878623104605, 63.992458688857795, 57.76846517950449, 58.16757931215182, 37.74102077017214, 59.64250208038432, 57.39392385301981, 59.09389410117665, 64.60544797907019, 57.37651361449567, 65.04850932518889, 57.288159536674364, 65.24612615602294, 43.45207098417775, 60.56466689567457, 63.438119975640106, 59.565471897059545, 59.56354965051271, 48.75647230649911, 61.485777550262874, 60.34381380922306, 53.886698447273154, 63.03605442835702, 60.79922933759683, 60.74820815031798, 56.4704292823348, 58.525783414641765, 44.18150925971247, 60.60810578962771, 61.734338448300484, 54.905270670711296, 59.84599879991856, 43.813762353212944, 57.434646405684646, 62.14108118879181, 57.304395011253746, 61.589740020631325, 61.60131663713502, 62.573436752974715, 59.07924976936969, 61.477276642977536, 43.86172166226389, 56.08593333309034, 59.47900651160861], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7823434200589965, "mean_inference_ms": 8.004347273140905, "mean_action_processing_ms": 0.567238736633388, "mean_env_wait_ms": 24.201576863403957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03752636909484863, "StateBufferConnector_ms": 0.025141000747680664, "ViewRequirementAgentConnector_ms": 0.9574344158172607}}, "episode_reward_max": 70.52922205622596, "episode_reward_min": 37.74102077017214, "episode_reward_mean": 58.38773171111046, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [63.66803038261016, 63.917773089363756, 60.778086079822636, 60.62882326071256, 46.08051912077158, 64.03368513669656, 66.01862327419637, 56.88532037212545, 70.52922205622596, 61.78034071663416, 62.96955280907438, 58.70862732069462, 63.413719130921095, 46.16011542617878, 62.2652624300148, 60.325366099808235, 60.13570816031889, 60.5678606108766, 44.17109664510082, 59.71197797563352, 67.05747371699076, 51.82144498489584, 65.99807434150705, 60.01948340490908, 66.79859358979077, 54.76954313352528, 62.544036331060596, 43.60105329971609, 57.80223158713173, 65.32574268645979, 58.3455431300265, 60.71068690314692, 45.635338486349355, 60.71235941326762, 64.17235547123671, 49.637565631976436, 61.242616218245054, 60.45531373557457, 58.3842478868608, 62.24491695367508, 62.11713992052473, 45.389577562563, 60.464343094892136, 61.48968252250487, 53.426907736240885, 60.795908931721726, 47.84515139008608, 58.138227298601926, 69.7985664036128, 59.034221198921834, 61.3227187231555, 60.68544644697587, 61.324411225824555, 61.128004450082784, 57.099461153503555, 44.66854983310562, 62.29878623104605, 63.992458688857795, 57.76846517950449, 58.16757931215182, 37.74102077017214, 59.64250208038432, 57.39392385301981, 59.09389410117665, 64.60544797907019, 57.37651361449567, 65.04850932518889, 57.288159536674364, 65.24612615602294, 43.45207098417775, 60.56466689567457, 63.438119975640106, 59.565471897059545, 59.56354965051271, 48.75647230649911, 61.485777550262874, 60.34381380922306, 53.886698447273154, 63.03605442835702, 60.79922933759683, 60.74820815031798, 56.4704292823348, 58.525783414641765, 44.18150925971247, 60.60810578962771, 61.734338448300484, 54.905270670711296, 59.84599879991856, 43.813762353212944, 57.434646405684646, 62.14108118879181, 57.304395011253746, 61.589740020631325, 61.60131663713502, 62.573436752974715, 59.07924976936969, 61.477276642977536, 43.86172166226389, 56.08593333309034, 59.47900651160861], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7823434200589965, "mean_inference_ms": 8.004347273140905, "mean_action_processing_ms": 0.567238736633388, "mean_env_wait_ms": 24.201576863403957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03752636909484863, "StateBufferConnector_ms": 0.025141000747680664, "ViewRequirementAgentConnector_ms": 0.9574344158172607}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1423328, "num_agent_steps_trained": 1423328, "num_env_steps_sampled": 1423328, "num_env_steps_trained": 1423328, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 230.92619399248088, "num_env_steps_trained_throughput_per_sec": 230.92619399248088, "timesteps_total": 1423328, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1423328, "timers": {"training_iteration_time_ms": 68337.237, "sample_time_ms": 42772.439, "load_time_ms": 2384.643, "load_throughput": 6557.794, "learn_time_ms": 22591.037, "learn_throughput": 692.221, "synch_weights_time_ms": 456.855}, "counters": {"num_env_steps_sampled": 1423328, "num_env_steps_trained": 1423328, "num_agent_steps_sampled": 1423328, "num_agent_steps_trained": 1423328}, "done": false, "episodes_total": 1388, "training_iteration": 99, "trial_id": "837cb_00000", "date": "2025-06-07_19-13-48", "timestamp": 1749316428, "time_this_iter_s": 67.74381375312805, "time_total_s": 6479.123735666275, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6479.123735666275, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 66.93461538461537, "ram_util_percent": 89.27179487179485, "gpu_util_percent0": 0.21141025641025643, "vram_util_percent0": 0.9650065104166671}}
{"evaluation": {"sampler_results": {"episode_reward_max": -6.146822277708483, "episode_reward_min": -7.069199332234778, "episode_reward_mean": -6.658543493248828, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.870274737843067, -7.069199332234778, -6.3255981376131025, -6.880822980844709, -6.146822277708483], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9243470146246362, "mean_inference_ms": 4.0911772292329625, "mean_action_processing_ms": 0.2989759394402427, "mean_env_wait_ms": 13.011651562032668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.44420719146728516}}, "episode_reward_max": -6.146822277708483, "episode_reward_min": -7.069199332234778, "episode_reward_mean": -6.658543493248828, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.870274737843067, -7.069199332234778, -6.3255981376131025, -6.880822980844709, -6.146822277708483], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9243470146246362, "mean_inference_ms": 4.0911772292329625, "mean_action_processing_ms": 0.2989759394402427, "mean_env_wait_ms": 13.011651562032668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.44420719146728516}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.576672e-05, "total_loss": -0.07003260051397692, "policy_loss": -0.004831294835629788, "vf_loss": 0.015060308328829706, "vf_explained_var": 0.9519559545950456, "kl": 0.018346634576605125, "entropy": 16.23503700082952, "entropy_coeff": 0.004365008000000001}, "model": {}, "num_grad_updates_lifetime": 50365.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1438966, "num_env_steps_trained": 1438966, "num_agent_steps_sampled": 1438966, "num_agent_steps_trained": 1438966}, "sampler_results": {"episode_reward_max": 69.7985664036128, "episode_reward_min": 37.74102077017214, "episode_reward_mean": 57.749388462118425, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.2652624300148, 60.325366099808235, 60.13570816031889, 60.5678606108766, 44.17109664510082, 59.71197797563352, 67.05747371699076, 51.82144498489584, 65.99807434150705, 60.01948340490908, 66.79859358979077, 54.76954313352528, 62.544036331060596, 43.60105329971609, 57.80223158713173, 65.32574268645979, 58.3455431300265, 60.71068690314692, 45.635338486349355, 60.71235941326762, 64.17235547123671, 49.637565631976436, 61.242616218245054, 60.45531373557457, 58.3842478868608, 62.24491695367508, 62.11713992052473, 45.389577562563, 60.464343094892136, 61.48968252250487, 53.426907736240885, 60.795908931721726, 47.84515139008608, 58.138227298601926, 69.7985664036128, 59.034221198921834, 61.3227187231555, 60.68544644697587, 61.324411225824555, 61.128004450082784, 57.099461153503555, 44.66854983310562, 62.29878623104605, 63.992458688857795, 57.76846517950449, 58.16757931215182, 37.74102077017214, 59.64250208038432, 57.39392385301981, 59.09389410117665, 64.60544797907019, 57.37651361449567, 65.04850932518889, 57.288159536674364, 65.24612615602294, 43.45207098417775, 60.56466689567457, 63.438119975640106, 59.565471897059545, 59.56354965051271, 48.75647230649911, 61.485777550262874, 60.34381380922306, 53.886698447273154, 63.03605442835702, 60.79922933759683, 60.74820815031798, 56.4704292823348, 58.525783414641765, 44.18150925971247, 60.60810578962771, 61.734338448300484, 54.905270670711296, 59.84599879991856, 43.813762353212944, 57.434646405684646, 62.14108118879181, 57.304395011253746, 61.589740020631325, 61.60131663713502, 62.573436752974715, 59.07924976936969, 61.477276642977536, 43.86172166226389, 56.08593333309034, 59.47900651160861, 54.55163474596327, 58.32311252549228, 41.95581948188298, 61.24862995854372, 59.25745583347978, 55.01440618065561, 58.741630119658026, 56.673980394850695, 60.08139349842383, 55.40923305265518, 56.95229849494429, 43.30762354104158, 54.7269129385093, 65.49398251072343], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7849959500882955, "mean_inference_ms": 8.008699155543177, "mean_action_processing_ms": 0.5674309646227684, "mean_env_wait_ms": 24.204420373481796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03559112548828125, "StateBufferConnector_ms": 0.022901296615600586, "ViewRequirementAgentConnector_ms": 0.930919885635376}}, "episode_reward_max": 69.7985664036128, "episode_reward_min": 37.74102077017214, "episode_reward_mean": 57.749388462118425, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [62.2652624300148, 60.325366099808235, 60.13570816031889, 60.5678606108766, 44.17109664510082, 59.71197797563352, 67.05747371699076, 51.82144498489584, 65.99807434150705, 60.01948340490908, 66.79859358979077, 54.76954313352528, 62.544036331060596, 43.60105329971609, 57.80223158713173, 65.32574268645979, 58.3455431300265, 60.71068690314692, 45.635338486349355, 60.71235941326762, 64.17235547123671, 49.637565631976436, 61.242616218245054, 60.45531373557457, 58.3842478868608, 62.24491695367508, 62.11713992052473, 45.389577562563, 60.464343094892136, 61.48968252250487, 53.426907736240885, 60.795908931721726, 47.84515139008608, 58.138227298601926, 69.7985664036128, 59.034221198921834, 61.3227187231555, 60.68544644697587, 61.324411225824555, 61.128004450082784, 57.099461153503555, 44.66854983310562, 62.29878623104605, 63.992458688857795, 57.76846517950449, 58.16757931215182, 37.74102077017214, 59.64250208038432, 57.39392385301981, 59.09389410117665, 64.60544797907019, 57.37651361449567, 65.04850932518889, 57.288159536674364, 65.24612615602294, 43.45207098417775, 60.56466689567457, 63.438119975640106, 59.565471897059545, 59.56354965051271, 48.75647230649911, 61.485777550262874, 60.34381380922306, 53.886698447273154, 63.03605442835702, 60.79922933759683, 60.74820815031798, 56.4704292823348, 58.525783414641765, 44.18150925971247, 60.60810578962771, 61.734338448300484, 54.905270670711296, 59.84599879991856, 43.813762353212944, 57.434646405684646, 62.14108118879181, 57.304395011253746, 61.589740020631325, 61.60131663713502, 62.573436752974715, 59.07924976936969, 61.477276642977536, 43.86172166226389, 56.08593333309034, 59.47900651160861, 54.55163474596327, 58.32311252549228, 41.95581948188298, 61.24862995854372, 59.25745583347978, 55.01440618065561, 58.741630119658026, 56.673980394850695, 60.08139349842383, 55.40923305265518, 56.95229849494429, 43.30762354104158, 54.7269129385093, 65.49398251072343], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7849959500882955, "mean_inference_ms": 8.008699155543177, "mean_action_processing_ms": 0.5674309646227684, "mean_env_wait_ms": 24.204420373481796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03559112548828125, "StateBufferConnector_ms": 0.022901296615600586, "ViewRequirementAgentConnector_ms": 0.930919885635376}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1438966, "num_agent_steps_trained": 1438966, "num_env_steps_sampled": 1438966, "num_env_steps_trained": 1438966, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.26951930470574, "num_env_steps_trained_throughput_per_sec": 229.26951930470574, "timesteps_total": 1438966, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1438966, "timers": {"training_iteration_time_ms": 68309.66, "sample_time_ms": 42746.82, "load_time_ms": 2368.268, "load_throughput": 6603.137, "learn_time_ms": 22593.543, "learn_throughput": 692.145, "synch_weights_time_ms": 469.274}, "counters": {"num_env_steps_sampled": 1438966, "num_env_steps_trained": 1438966, "num_agent_steps_sampled": 1438966, "num_agent_steps_trained": 1438966}, "done": false, "episodes_total": 1402, "training_iteration": 100, "trial_id": "837cb_00000", "date": "2025-06-07_19-15-15", "timestamp": 1749316515, "time_this_iter_s": 86.7011947631836, "time_total_s": 6565.824930429459, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6565.824930429459, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 57.89117647058824, "ram_util_percent": 89.07647058823528, "gpu_util_percent0": 0.16980392156862745, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.561034e-05, "total_loss": -0.08474767531776292, "policy_loss": -0.01956319586395032, "vf_loss": 0.014329765103334053, "vf_explained_var": 0.9574481941353191, "kl": 0.01882639993818552, "entropy": 16.275302500291303, "entropy_coeff": 0.004341551}, "model": {}, "num_grad_updates_lifetime": 50915.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1454604, "num_env_steps_trained": 1454604, "num_agent_steps_sampled": 1454604, "num_agent_steps_trained": 1454604}, "sampler_results": {"episode_reward_max": 69.7985664036128, "episode_reward_min": 37.74102077017214, "episode_reward_mean": 57.527379596121534, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.80223158713173, 65.32574268645979, 58.3455431300265, 60.71068690314692, 45.635338486349355, 60.71235941326762, 64.17235547123671, 49.637565631976436, 61.242616218245054, 60.45531373557457, 58.3842478868608, 62.24491695367508, 62.11713992052473, 45.389577562563, 60.464343094892136, 61.48968252250487, 53.426907736240885, 60.795908931721726, 47.84515139008608, 58.138227298601926, 69.7985664036128, 59.034221198921834, 61.3227187231555, 60.68544644697587, 61.324411225824555, 61.128004450082784, 57.099461153503555, 44.66854983310562, 62.29878623104605, 63.992458688857795, 57.76846517950449, 58.16757931215182, 37.74102077017214, 59.64250208038432, 57.39392385301981, 59.09389410117665, 64.60544797907019, 57.37651361449567, 65.04850932518889, 57.288159536674364, 65.24612615602294, 43.45207098417775, 60.56466689567457, 63.438119975640106, 59.565471897059545, 59.56354965051271, 48.75647230649911, 61.485777550262874, 60.34381380922306, 53.886698447273154, 63.03605442835702, 60.79922933759683, 60.74820815031798, 56.4704292823348, 58.525783414641765, 44.18150925971247, 60.60810578962771, 61.734338448300484, 54.905270670711296, 59.84599879991856, 43.813762353212944, 57.434646405684646, 62.14108118879181, 57.304395011253746, 61.589740020631325, 61.60131663713502, 62.573436752974715, 59.07924976936969, 61.477276642977536, 43.86172166226389, 56.08593333309034, 59.47900651160861, 54.55163474596327, 58.32311252549228, 41.95581948188298, 61.24862995854372, 59.25745583347978, 55.01440618065561, 58.741630119658026, 56.673980394850695, 60.08139349842383, 55.40923305265518, 56.95229849494429, 43.30762354104158, 54.7269129385093, 65.49398251072343, 54.30303290536481, 58.91254278152809, 44.68633300441303, 59.43488356813462, 62.29022564638023, 58.57201971567841, 63.55158027118566, 60.270623521448094, 61.93010688457257, 51.37785298158417, 57.567868696942185, 45.54089138373825, 58.30238691906169, 60.84573984442831], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7873214995344466, "mean_inference_ms": 8.012849688616075, "mean_action_processing_ms": 0.5676304459991633, "mean_env_wait_ms": 24.209868635147988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040602684020996094, "StateBufferConnector_ms": 0.023818492889404297, "ViewRequirementAgentConnector_ms": 0.9288415908813477}}, "episode_reward_max": 69.7985664036128, "episode_reward_min": 37.74102077017214, "episode_reward_mean": 57.527379596121534, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [57.80223158713173, 65.32574268645979, 58.3455431300265, 60.71068690314692, 45.635338486349355, 60.71235941326762, 64.17235547123671, 49.637565631976436, 61.242616218245054, 60.45531373557457, 58.3842478868608, 62.24491695367508, 62.11713992052473, 45.389577562563, 60.464343094892136, 61.48968252250487, 53.426907736240885, 60.795908931721726, 47.84515139008608, 58.138227298601926, 69.7985664036128, 59.034221198921834, 61.3227187231555, 60.68544644697587, 61.324411225824555, 61.128004450082784, 57.099461153503555, 44.66854983310562, 62.29878623104605, 63.992458688857795, 57.76846517950449, 58.16757931215182, 37.74102077017214, 59.64250208038432, 57.39392385301981, 59.09389410117665, 64.60544797907019, 57.37651361449567, 65.04850932518889, 57.288159536674364, 65.24612615602294, 43.45207098417775, 60.56466689567457, 63.438119975640106, 59.565471897059545, 59.56354965051271, 48.75647230649911, 61.485777550262874, 60.34381380922306, 53.886698447273154, 63.03605442835702, 60.79922933759683, 60.74820815031798, 56.4704292823348, 58.525783414641765, 44.18150925971247, 60.60810578962771, 61.734338448300484, 54.905270670711296, 59.84599879991856, 43.813762353212944, 57.434646405684646, 62.14108118879181, 57.304395011253746, 61.589740020631325, 61.60131663713502, 62.573436752974715, 59.07924976936969, 61.477276642977536, 43.86172166226389, 56.08593333309034, 59.47900651160861, 54.55163474596327, 58.32311252549228, 41.95581948188298, 61.24862995854372, 59.25745583347978, 55.01440618065561, 58.741630119658026, 56.673980394850695, 60.08139349842383, 55.40923305265518, 56.95229849494429, 43.30762354104158, 54.7269129385093, 65.49398251072343, 54.30303290536481, 58.91254278152809, 44.68633300441303, 59.43488356813462, 62.29022564638023, 58.57201971567841, 63.55158027118566, 60.270623521448094, 61.93010688457257, 51.37785298158417, 57.567868696942185, 45.54089138373825, 58.30238691906169, 60.84573984442831], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7873214995344466, "mean_inference_ms": 8.012849688616075, "mean_action_processing_ms": 0.5676304459991633, "mean_env_wait_ms": 24.209868635147988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040602684020996094, "StateBufferConnector_ms": 0.023818492889404297, "ViewRequirementAgentConnector_ms": 0.9288415908813477}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1454604, "num_agent_steps_trained": 1454604, "num_env_steps_sampled": 1454604, "num_env_steps_trained": 1454604, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 220.64137039750761, "num_env_steps_trained_throughput_per_sec": 220.64137039750761, "timesteps_total": 1454604, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1454604, "timers": {"training_iteration_time_ms": 68578.673, "sample_time_ms": 42945.857, "load_time_ms": 2369.674, "load_throughput": 6599.219, "learn_time_ms": 22661.931, "learn_throughput": 690.056, "synch_weights_time_ms": 472.886}, "counters": {"num_env_steps_sampled": 1454604, "num_env_steps_trained": 1454604, "num_agent_steps_sampled": 1454604, "num_agent_steps_trained": 1454604}, "done": false, "episodes_total": 1416, "training_iteration": 101, "trial_id": "837cb_00000", "date": "2025-06-07_19-16-26", "timestamp": 1749316586, "time_this_iter_s": 70.89173460006714, "time_total_s": 6636.716665029526, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6636.716665029526, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 65.65925925925927, "ram_util_percent": 90.05185185185185, "gpu_util_percent0": 0.21296296296296297, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.545396000000004e-05, "total_loss": -0.0786613920089704, "policy_loss": -0.013655681608414108, "vf_loss": 0.01323716776191511, "vf_explained_var": 0.9593366139585322, "kl": 0.019097903558709235, "entropy": 16.250336707722056, "entropy_coeff": 0.004318094000000001}, "model": {}, "num_grad_updates_lifetime": 51465.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1470242, "num_env_steps_trained": 1470242, "num_agent_steps_sampled": 1470242, "num_agent_steps_trained": 1470242}, "sampler_results": {"episode_reward_max": 69.7985664036128, "episode_reward_min": 37.74102077017214, "episode_reward_mean": 57.47562365222007, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.464343094892136, 61.48968252250487, 53.426907736240885, 60.795908931721726, 47.84515139008608, 58.138227298601926, 69.7985664036128, 59.034221198921834, 61.3227187231555, 60.68544644697587, 61.324411225824555, 61.128004450082784, 57.099461153503555, 44.66854983310562, 62.29878623104605, 63.992458688857795, 57.76846517950449, 58.16757931215182, 37.74102077017214, 59.64250208038432, 57.39392385301981, 59.09389410117665, 64.60544797907019, 57.37651361449567, 65.04850932518889, 57.288159536674364, 65.24612615602294, 43.45207098417775, 60.56466689567457, 63.438119975640106, 59.565471897059545, 59.56354965051271, 48.75647230649911, 61.485777550262874, 60.34381380922306, 53.886698447273154, 63.03605442835702, 60.79922933759683, 60.74820815031798, 56.4704292823348, 58.525783414641765, 44.18150925971247, 60.60810578962771, 61.734338448300484, 54.905270670711296, 59.84599879991856, 43.813762353212944, 57.434646405684646, 62.14108118879181, 57.304395011253746, 61.589740020631325, 61.60131663713502, 62.573436752974715, 59.07924976936969, 61.477276642977536, 43.86172166226389, 56.08593333309034, 59.47900651160861, 54.55163474596327, 58.32311252549228, 41.95581948188298, 61.24862995854372, 59.25745583347978, 55.01440618065561, 58.741630119658026, 56.673980394850695, 60.08139349842383, 55.40923305265518, 56.95229849494429, 43.30762354104158, 54.7269129385093, 65.49398251072343, 54.30303290536481, 58.91254278152809, 44.68633300441303, 59.43488356813462, 62.29022564638023, 58.57201971567841, 63.55158027118566, 60.270623521448094, 61.93010688457257, 51.37785298158417, 57.567868696942185, 45.54089138373825, 58.30238691906169, 60.84573984442831, 58.00085948005059, 59.28566991135719, 45.97232184728348, 59.5077325947515, 62.56005167521424, 55.424110513048696, 63.594842556955925, 58.91698391246937, 65.1283569341932, 56.44944283359561, 60.51532501006705, 41.798324730742614, 57.31339296135886, 62.532626235802866], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.788751721097646, "mean_inference_ms": 8.015901827907461, "mean_action_processing_ms": 0.5677773802919674, "mean_env_wait_ms": 24.215143359379212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040140628814697266, "StateBufferConnector_ms": 0.019824981689453125, "ViewRequirementAgentConnector_ms": 0.9227597713470459}}, "episode_reward_max": 69.7985664036128, "episode_reward_min": 37.74102077017214, "episode_reward_mean": 57.47562365222007, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.464343094892136, 61.48968252250487, 53.426907736240885, 60.795908931721726, 47.84515139008608, 58.138227298601926, 69.7985664036128, 59.034221198921834, 61.3227187231555, 60.68544644697587, 61.324411225824555, 61.128004450082784, 57.099461153503555, 44.66854983310562, 62.29878623104605, 63.992458688857795, 57.76846517950449, 58.16757931215182, 37.74102077017214, 59.64250208038432, 57.39392385301981, 59.09389410117665, 64.60544797907019, 57.37651361449567, 65.04850932518889, 57.288159536674364, 65.24612615602294, 43.45207098417775, 60.56466689567457, 63.438119975640106, 59.565471897059545, 59.56354965051271, 48.75647230649911, 61.485777550262874, 60.34381380922306, 53.886698447273154, 63.03605442835702, 60.79922933759683, 60.74820815031798, 56.4704292823348, 58.525783414641765, 44.18150925971247, 60.60810578962771, 61.734338448300484, 54.905270670711296, 59.84599879991856, 43.813762353212944, 57.434646405684646, 62.14108118879181, 57.304395011253746, 61.589740020631325, 61.60131663713502, 62.573436752974715, 59.07924976936969, 61.477276642977536, 43.86172166226389, 56.08593333309034, 59.47900651160861, 54.55163474596327, 58.32311252549228, 41.95581948188298, 61.24862995854372, 59.25745583347978, 55.01440618065561, 58.741630119658026, 56.673980394850695, 60.08139349842383, 55.40923305265518, 56.95229849494429, 43.30762354104158, 54.7269129385093, 65.49398251072343, 54.30303290536481, 58.91254278152809, 44.68633300441303, 59.43488356813462, 62.29022564638023, 58.57201971567841, 63.55158027118566, 60.270623521448094, 61.93010688457257, 51.37785298158417, 57.567868696942185, 45.54089138373825, 58.30238691906169, 60.84573984442831, 58.00085948005059, 59.28566991135719, 45.97232184728348, 59.5077325947515, 62.56005167521424, 55.424110513048696, 63.594842556955925, 58.91698391246937, 65.1283569341932, 56.44944283359561, 60.51532501006705, 41.798324730742614, 57.31339296135886, 62.532626235802866], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.788751721097646, "mean_inference_ms": 8.015901827907461, "mean_action_processing_ms": 0.5677773802919674, "mean_env_wait_ms": 24.215143359379212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040140628814697266, "StateBufferConnector_ms": 0.019824981689453125, "ViewRequirementAgentConnector_ms": 0.9227597713470459}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1470242, "num_agent_steps_trained": 1470242, "num_env_steps_sampled": 1470242, "num_env_steps_trained": 1470242, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 230.06429897290425, "num_env_steps_trained_throughput_per_sec": 230.06429897290425, "timesteps_total": 1470242, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1470242, "timers": {"training_iteration_time_ms": 68582.04, "sample_time_ms": 42852.994, "load_time_ms": 2375.055, "load_throughput": 6584.269, "learn_time_ms": 22749.893, "learn_throughput": 687.388, "synch_weights_time_ms": 474.92}, "counters": {"num_env_steps_sampled": 1470242, "num_env_steps_trained": 1470242, "num_agent_steps_sampled": 1470242, "num_agent_steps_trained": 1470242}, "done": false, "episodes_total": 1430, "training_iteration": 102, "trial_id": "837cb_00000", "date": "2025-06-07_19-17-34", "timestamp": 1749316654, "time_this_iter_s": 67.98985505104065, "time_total_s": 6704.706520080566, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6704.706520080566, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 64.54871794871795, "ram_util_percent": 90.16538461538462, "gpu_util_percent0": 0.22487179487179496, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.529757999999998e-05, "total_loss": -0.08930646217904392, "policy_loss": -0.024765445936672306, "vf_loss": 0.013394539974291216, "vf_explained_var": 0.9560553328557448, "kl": 0.018838573661132927, "entropy": 16.23811009840532, "entropy_coeff": 0.004294637000000001}, "model": {}, "num_grad_updates_lifetime": 52015.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1485880, "num_env_steps_trained": 1485880, "num_agent_steps_sampled": 1485880, "num_agent_steps_trained": 1485880}, "sampler_results": {"episode_reward_max": 66.7053587062048, "episode_reward_min": 37.74102077017214, "episode_reward_mean": 57.46052415567865, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.29878623104605, 63.992458688857795, 57.76846517950449, 58.16757931215182, 37.74102077017214, 59.64250208038432, 57.39392385301981, 59.09389410117665, 64.60544797907019, 57.37651361449567, 65.04850932518889, 57.288159536674364, 65.24612615602294, 43.45207098417775, 60.56466689567457, 63.438119975640106, 59.565471897059545, 59.56354965051271, 48.75647230649911, 61.485777550262874, 60.34381380922306, 53.886698447273154, 63.03605442835702, 60.79922933759683, 60.74820815031798, 56.4704292823348, 58.525783414641765, 44.18150925971247, 60.60810578962771, 61.734338448300484, 54.905270670711296, 59.84599879991856, 43.813762353212944, 57.434646405684646, 62.14108118879181, 57.304395011253746, 61.589740020631325, 61.60131663713502, 62.573436752974715, 59.07924976936969, 61.477276642977536, 43.86172166226389, 56.08593333309034, 59.47900651160861, 54.55163474596327, 58.32311252549228, 41.95581948188298, 61.24862995854372, 59.25745583347978, 55.01440618065561, 58.741630119658026, 56.673980394850695, 60.08139349842383, 55.40923305265518, 56.95229849494429, 43.30762354104158, 54.7269129385093, 65.49398251072343, 54.30303290536481, 58.91254278152809, 44.68633300441303, 59.43488356813462, 62.29022564638023, 58.57201971567841, 63.55158027118566, 60.270623521448094, 61.93010688457257, 51.37785298158417, 57.567868696942185, 45.54089138373825, 58.30238691906169, 60.84573984442831, 58.00085948005059, 59.28566991135719, 45.97232184728348, 59.5077325947515, 62.56005167521424, 55.424110513048696, 63.594842556955925, 58.91698391246937, 65.1283569341932, 56.44944283359561, 60.51532501006705, 41.798324730742614, 57.31339296135886, 62.532626235802866, 54.883390891653065, 56.25954836234547, 49.23590298283591, 61.824207540976424, 65.89755804140871, 56.24521337499317, 66.7053587062048, 58.83787956681415, 62.45771040538276, 59.46435418579777, 61.080566904292745, 44.596478258250386, 57.43345543343164, 60.790026100700516], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7900135223708005, "mean_inference_ms": 8.017955636631973, "mean_action_processing_ms": 0.5678636314507645, "mean_env_wait_ms": 24.21919006036943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03917264938354492, "StateBufferConnector_ms": 0.022931575775146484, "ViewRequirementAgentConnector_ms": 0.934628963470459}}, "episode_reward_max": 66.7053587062048, "episode_reward_min": 37.74102077017214, "episode_reward_mean": 57.46052415567865, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [62.29878623104605, 63.992458688857795, 57.76846517950449, 58.16757931215182, 37.74102077017214, 59.64250208038432, 57.39392385301981, 59.09389410117665, 64.60544797907019, 57.37651361449567, 65.04850932518889, 57.288159536674364, 65.24612615602294, 43.45207098417775, 60.56466689567457, 63.438119975640106, 59.565471897059545, 59.56354965051271, 48.75647230649911, 61.485777550262874, 60.34381380922306, 53.886698447273154, 63.03605442835702, 60.79922933759683, 60.74820815031798, 56.4704292823348, 58.525783414641765, 44.18150925971247, 60.60810578962771, 61.734338448300484, 54.905270670711296, 59.84599879991856, 43.813762353212944, 57.434646405684646, 62.14108118879181, 57.304395011253746, 61.589740020631325, 61.60131663713502, 62.573436752974715, 59.07924976936969, 61.477276642977536, 43.86172166226389, 56.08593333309034, 59.47900651160861, 54.55163474596327, 58.32311252549228, 41.95581948188298, 61.24862995854372, 59.25745583347978, 55.01440618065561, 58.741630119658026, 56.673980394850695, 60.08139349842383, 55.40923305265518, 56.95229849494429, 43.30762354104158, 54.7269129385093, 65.49398251072343, 54.30303290536481, 58.91254278152809, 44.68633300441303, 59.43488356813462, 62.29022564638023, 58.57201971567841, 63.55158027118566, 60.270623521448094, 61.93010688457257, 51.37785298158417, 57.567868696942185, 45.54089138373825, 58.30238691906169, 60.84573984442831, 58.00085948005059, 59.28566991135719, 45.97232184728348, 59.5077325947515, 62.56005167521424, 55.424110513048696, 63.594842556955925, 58.91698391246937, 65.1283569341932, 56.44944283359561, 60.51532501006705, 41.798324730742614, 57.31339296135886, 62.532626235802866, 54.883390891653065, 56.25954836234547, 49.23590298283591, 61.824207540976424, 65.89755804140871, 56.24521337499317, 66.7053587062048, 58.83787956681415, 62.45771040538276, 59.46435418579777, 61.080566904292745, 44.596478258250386, 57.43345543343164, 60.790026100700516], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7900135223708005, "mean_inference_ms": 8.017955636631973, "mean_action_processing_ms": 0.5678636314507645, "mean_env_wait_ms": 24.21919006036943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03917264938354492, "StateBufferConnector_ms": 0.022931575775146484, "ViewRequirementAgentConnector_ms": 0.934628963470459}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1485880, "num_agent_steps_trained": 1485880, "num_env_steps_sampled": 1485880, "num_env_steps_trained": 1485880, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.8962673571836, "num_env_steps_trained_throughput_per_sec": 228.8962673571836, "timesteps_total": 1485880, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1485880, "timers": {"training_iteration_time_ms": 68631.243, "sample_time_ms": 42837.872, "load_time_ms": 2362.504, "load_throughput": 6619.249, "learn_time_ms": 22832.9, "learn_throughput": 684.889, "synch_weights_time_ms": 470.109}, "counters": {"num_env_steps_sampled": 1485880, "num_env_steps_trained": 1485880, "num_agent_steps_sampled": 1485880, "num_agent_steps_trained": 1485880}, "done": false, "episodes_total": 1444, "training_iteration": 103, "trial_id": "837cb_00000", "date": "2025-06-07_19-18-43", "timestamp": 1749316723, "time_this_iter_s": 68.33518385887146, "time_total_s": 6773.041703939438, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6773.041703939438, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 65.16666666666667, "ram_util_percent": 90.26538461538463, "gpu_util_percent0": 0.2171794871794872, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.51412e-05, "total_loss": -0.0706305260875855, "policy_loss": -0.00635751304751135, "vf_loss": 0.01459529557900334, "vf_explained_var": 0.9535533880103718, "kl": 0.019468162873900782, "entropy": 16.35809406974099, "entropy_coeff": 0.00427118}, "model": {}, "num_grad_updates_lifetime": 52565.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1501518, "num_env_steps_trained": 1501518, "num_agent_steps_sampled": 1501518, "num_agent_steps_trained": 1501518}, "sampler_results": {"episode_reward_max": 66.7053587062048, "episode_reward_min": 41.798324730742614, "episode_reward_mean": 57.32787017211229, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.56466689567457, 63.438119975640106, 59.565471897059545, 59.56354965051271, 48.75647230649911, 61.485777550262874, 60.34381380922306, 53.886698447273154, 63.03605442835702, 60.79922933759683, 60.74820815031798, 56.4704292823348, 58.525783414641765, 44.18150925971247, 60.60810578962771, 61.734338448300484, 54.905270670711296, 59.84599879991856, 43.813762353212944, 57.434646405684646, 62.14108118879181, 57.304395011253746, 61.589740020631325, 61.60131663713502, 62.573436752974715, 59.07924976936969, 61.477276642977536, 43.86172166226389, 56.08593333309034, 59.47900651160861, 54.55163474596327, 58.32311252549228, 41.95581948188298, 61.24862995854372, 59.25745583347978, 55.01440618065561, 58.741630119658026, 56.673980394850695, 60.08139349842383, 55.40923305265518, 56.95229849494429, 43.30762354104158, 54.7269129385093, 65.49398251072343, 54.30303290536481, 58.91254278152809, 44.68633300441303, 59.43488356813462, 62.29022564638023, 58.57201971567841, 63.55158027118566, 60.270623521448094, 61.93010688457257, 51.37785298158417, 57.567868696942185, 45.54089138373825, 58.30238691906169, 60.84573984442831, 58.00085948005059, 59.28566991135719, 45.97232184728348, 59.5077325947515, 62.56005167521424, 55.424110513048696, 63.594842556955925, 58.91698391246937, 65.1283569341932, 56.44944283359561, 60.51532501006705, 41.798324730742614, 57.31339296135886, 62.532626235802866, 54.883390891653065, 56.25954836234547, 49.23590298283591, 61.824207540976424, 65.89755804140871, 56.24521337499317, 66.7053587062048, 58.83787956681415, 62.45771040538276, 59.46435418579777, 61.080566904292745, 44.596478258250386, 57.43345543343164, 60.790026100700516, 55.851188004199216, 58.43561094297526, 46.378553968368124, 59.42392631543381, 63.44412158743217, 53.6463439809824, 59.421782831628526, 57.874935909860966, 61.18806417975087, 59.430105665720696, 59.568338061892305, 45.55467817021159, 59.66898260954586, 55.96342722730587], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.790934510384797, "mean_inference_ms": 8.019429135422854, "mean_action_processing_ms": 0.5678789139188753, "mean_env_wait_ms": 24.223057696566016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04021143913269043, "StateBufferConnector_ms": 0.022931814193725586, "ViewRequirementAgentConnector_ms": 0.9601747989654541}}, "episode_reward_max": 66.7053587062048, "episode_reward_min": 41.798324730742614, "episode_reward_mean": 57.32787017211229, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.56466689567457, 63.438119975640106, 59.565471897059545, 59.56354965051271, 48.75647230649911, 61.485777550262874, 60.34381380922306, 53.886698447273154, 63.03605442835702, 60.79922933759683, 60.74820815031798, 56.4704292823348, 58.525783414641765, 44.18150925971247, 60.60810578962771, 61.734338448300484, 54.905270670711296, 59.84599879991856, 43.813762353212944, 57.434646405684646, 62.14108118879181, 57.304395011253746, 61.589740020631325, 61.60131663713502, 62.573436752974715, 59.07924976936969, 61.477276642977536, 43.86172166226389, 56.08593333309034, 59.47900651160861, 54.55163474596327, 58.32311252549228, 41.95581948188298, 61.24862995854372, 59.25745583347978, 55.01440618065561, 58.741630119658026, 56.673980394850695, 60.08139349842383, 55.40923305265518, 56.95229849494429, 43.30762354104158, 54.7269129385093, 65.49398251072343, 54.30303290536481, 58.91254278152809, 44.68633300441303, 59.43488356813462, 62.29022564638023, 58.57201971567841, 63.55158027118566, 60.270623521448094, 61.93010688457257, 51.37785298158417, 57.567868696942185, 45.54089138373825, 58.30238691906169, 60.84573984442831, 58.00085948005059, 59.28566991135719, 45.97232184728348, 59.5077325947515, 62.56005167521424, 55.424110513048696, 63.594842556955925, 58.91698391246937, 65.1283569341932, 56.44944283359561, 60.51532501006705, 41.798324730742614, 57.31339296135886, 62.532626235802866, 54.883390891653065, 56.25954836234547, 49.23590298283591, 61.824207540976424, 65.89755804140871, 56.24521337499317, 66.7053587062048, 58.83787956681415, 62.45771040538276, 59.46435418579777, 61.080566904292745, 44.596478258250386, 57.43345543343164, 60.790026100700516, 55.851188004199216, 58.43561094297526, 46.378553968368124, 59.42392631543381, 63.44412158743217, 53.6463439809824, 59.421782831628526, 57.874935909860966, 61.18806417975087, 59.430105665720696, 59.568338061892305, 45.55467817021159, 59.66898260954586, 55.96342722730587], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.790934510384797, "mean_inference_ms": 8.019429135422854, "mean_action_processing_ms": 0.5678789139188753, "mean_env_wait_ms": 24.223057696566016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04021143913269043, "StateBufferConnector_ms": 0.022931814193725586, "ViewRequirementAgentConnector_ms": 0.9601747989654541}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1501518, "num_agent_steps_trained": 1501518, "num_env_steps_sampled": 1501518, "num_env_steps_trained": 1501518, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.41236218246092, "num_env_steps_trained_throughput_per_sec": 228.41236218246092, "timesteps_total": 1501518, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1501518, "timers": {"training_iteration_time_ms": 68436.335, "sample_time_ms": 42769.479, "load_time_ms": 2314.116, "load_throughput": 6757.656, "learn_time_ms": 22760.336, "learn_throughput": 687.072, "synch_weights_time_ms": 466.609}, "counters": {"num_env_steps_sampled": 1501518, "num_env_steps_trained": 1501518, "num_agent_steps_sampled": 1501518, "num_agent_steps_trained": 1501518}, "done": false, "episodes_total": 1458, "training_iteration": 104, "trial_id": "837cb_00000", "date": "2025-06-07_19-19-51", "timestamp": 1749316791, "time_this_iter_s": 68.4804470539093, "time_total_s": 6841.522150993347, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6841.522150993347, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 64.86329113924053, "ram_util_percent": 89.84810126582279, "gpu_util_percent0": 0.21848101265822786, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.498481999999999e-05, "total_loss": -0.06265313838291067, "policy_loss": 0.0010674104626840826, "vf_loss": 0.01457013553304767, "vf_explained_var": 0.9563263610276309, "kl": 0.0193620029358825, "entropy": 16.315025828968395, "entropy_coeff": 0.004247723}, "model": {}, "num_grad_updates_lifetime": 53115.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1517156, "num_env_steps_trained": 1517156, "num_agent_steps_sampled": 1517156, "num_agent_steps_trained": 1517156}, "sampler_results": {"episode_reward_max": 66.7053587062048, "episode_reward_min": 41.5840048719834, "episode_reward_mean": 57.0447534165789, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.60810578962771, 61.734338448300484, 54.905270670711296, 59.84599879991856, 43.813762353212944, 57.434646405684646, 62.14108118879181, 57.304395011253746, 61.589740020631325, 61.60131663713502, 62.573436752974715, 59.07924976936969, 61.477276642977536, 43.86172166226389, 56.08593333309034, 59.47900651160861, 54.55163474596327, 58.32311252549228, 41.95581948188298, 61.24862995854372, 59.25745583347978, 55.01440618065561, 58.741630119658026, 56.673980394850695, 60.08139349842383, 55.40923305265518, 56.95229849494429, 43.30762354104158, 54.7269129385093, 65.49398251072343, 54.30303290536481, 58.91254278152809, 44.68633300441303, 59.43488356813462, 62.29022564638023, 58.57201971567841, 63.55158027118566, 60.270623521448094, 61.93010688457257, 51.37785298158417, 57.567868696942185, 45.54089138373825, 58.30238691906169, 60.84573984442831, 58.00085948005059, 59.28566991135719, 45.97232184728348, 59.5077325947515, 62.56005167521424, 55.424110513048696, 63.594842556955925, 58.91698391246937, 65.1283569341932, 56.44944283359561, 60.51532501006705, 41.798324730742614, 57.31339296135886, 62.532626235802866, 54.883390891653065, 56.25954836234547, 49.23590298283591, 61.824207540976424, 65.89755804140871, 56.24521337499317, 66.7053587062048, 58.83787956681415, 62.45771040538276, 59.46435418579777, 61.080566904292745, 44.596478258250386, 57.43345543343164, 60.790026100700516, 55.851188004199216, 58.43561094297526, 46.378553968368124, 59.42392631543381, 63.44412158743217, 53.6463439809824, 59.421782831628526, 57.874935909860966, 61.18806417975087, 59.430105665720696, 59.568338061892305, 45.55467817021159, 59.66898260954586, 55.96342722730587, 54.63136337227652, 57.69857299071695, 46.91755211729243, 56.167858734642564, 64.92651950532343, 51.621237398633646, 61.845355617431544, 56.099305769080935, 59.96942334632821, 53.4091205117892, 58.20687078536155, 41.5840048719834, 59.46553525864529, 60.51138857226137], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7912817752606434, "mean_inference_ms": 8.020128710509361, "mean_action_processing_ms": 0.5678346632411163, "mean_env_wait_ms": 24.227318348411323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034739017486572266, "StateBufferConnector_ms": 0.026886940002441406, "ViewRequirementAgentConnector_ms": 0.9742181301116943}}, "episode_reward_max": 66.7053587062048, "episode_reward_min": 41.5840048719834, "episode_reward_mean": 57.0447534165789, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.60810578962771, 61.734338448300484, 54.905270670711296, 59.84599879991856, 43.813762353212944, 57.434646405684646, 62.14108118879181, 57.304395011253746, 61.589740020631325, 61.60131663713502, 62.573436752974715, 59.07924976936969, 61.477276642977536, 43.86172166226389, 56.08593333309034, 59.47900651160861, 54.55163474596327, 58.32311252549228, 41.95581948188298, 61.24862995854372, 59.25745583347978, 55.01440618065561, 58.741630119658026, 56.673980394850695, 60.08139349842383, 55.40923305265518, 56.95229849494429, 43.30762354104158, 54.7269129385093, 65.49398251072343, 54.30303290536481, 58.91254278152809, 44.68633300441303, 59.43488356813462, 62.29022564638023, 58.57201971567841, 63.55158027118566, 60.270623521448094, 61.93010688457257, 51.37785298158417, 57.567868696942185, 45.54089138373825, 58.30238691906169, 60.84573984442831, 58.00085948005059, 59.28566991135719, 45.97232184728348, 59.5077325947515, 62.56005167521424, 55.424110513048696, 63.594842556955925, 58.91698391246937, 65.1283569341932, 56.44944283359561, 60.51532501006705, 41.798324730742614, 57.31339296135886, 62.532626235802866, 54.883390891653065, 56.25954836234547, 49.23590298283591, 61.824207540976424, 65.89755804140871, 56.24521337499317, 66.7053587062048, 58.83787956681415, 62.45771040538276, 59.46435418579777, 61.080566904292745, 44.596478258250386, 57.43345543343164, 60.790026100700516, 55.851188004199216, 58.43561094297526, 46.378553968368124, 59.42392631543381, 63.44412158743217, 53.6463439809824, 59.421782831628526, 57.874935909860966, 61.18806417975087, 59.430105665720696, 59.568338061892305, 45.55467817021159, 59.66898260954586, 55.96342722730587, 54.63136337227652, 57.69857299071695, 46.91755211729243, 56.167858734642564, 64.92651950532343, 51.621237398633646, 61.845355617431544, 56.099305769080935, 59.96942334632821, 53.4091205117892, 58.20687078536155, 41.5840048719834, 59.46553525864529, 60.51138857226137], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7912817752606434, "mean_inference_ms": 8.020128710509361, "mean_action_processing_ms": 0.5678346632411163, "mean_env_wait_ms": 24.227318348411323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034739017486572266, "StateBufferConnector_ms": 0.026886940002441406, "ViewRequirementAgentConnector_ms": 0.9742181301116943}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1517156, "num_agent_steps_trained": 1517156, "num_env_steps_sampled": 1517156, "num_env_steps_trained": 1517156, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.79605679470353, "num_env_steps_trained_throughput_per_sec": 227.79605679470353, "timesteps_total": 1517156, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1517156, "timers": {"training_iteration_time_ms": 68458.805, "sample_time_ms": 42671.334, "load_time_ms": 2305.807, "load_throughput": 6782.009, "learn_time_ms": 22887.099, "learn_throughput": 683.267, "synch_weights_time_ms": 469.524}, "counters": {"num_env_steps_sampled": 1517156, "num_env_steps_trained": 1517156, "num_agent_steps_sampled": 1517156, "num_agent_steps_trained": 1517156}, "done": false, "episodes_total": 1472, "training_iteration": 105, "trial_id": "837cb_00000", "date": "2025-06-07_19-21-00", "timestamp": 1749316860, "time_this_iter_s": 68.66499042510986, "time_total_s": 6910.187141418457, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6910.187141418457, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 64.22692307692307, "ram_util_percent": 89.6115384615385, "gpu_util_percent0": 0.2171794871794872, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.482844000000001e-05, "total_loss": -0.06711871212369508, "policy_loss": -0.0034143416871401395, "vf_loss": 0.013972159624946388, "vf_explained_var": 0.9554184218970212, "kl": 0.019037581155693754, "entropy": 16.354526497233998, "entropy_coeff": 0.004224266}, "model": {}, "num_grad_updates_lifetime": 53665.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1532794, "num_env_steps_trained": 1532794, "num_agent_steps_sampled": 1532794, "num_agent_steps_trained": 1532794}, "sampler_results": {"episode_reward_max": 66.7053587062048, "episode_reward_min": 41.5840048719834, "episode_reward_mean": 56.75056077129998, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.08593333309034, 59.47900651160861, 54.55163474596327, 58.32311252549228, 41.95581948188298, 61.24862995854372, 59.25745583347978, 55.01440618065561, 58.741630119658026, 56.673980394850695, 60.08139349842383, 55.40923305265518, 56.95229849494429, 43.30762354104158, 54.7269129385093, 65.49398251072343, 54.30303290536481, 58.91254278152809, 44.68633300441303, 59.43488356813462, 62.29022564638023, 58.57201971567841, 63.55158027118566, 60.270623521448094, 61.93010688457257, 51.37785298158417, 57.567868696942185, 45.54089138373825, 58.30238691906169, 60.84573984442831, 58.00085948005059, 59.28566991135719, 45.97232184728348, 59.5077325947515, 62.56005167521424, 55.424110513048696, 63.594842556955925, 58.91698391246937, 65.1283569341932, 56.44944283359561, 60.51532501006705, 41.798324730742614, 57.31339296135886, 62.532626235802866, 54.883390891653065, 56.25954836234547, 49.23590298283591, 61.824207540976424, 65.89755804140871, 56.24521337499317, 66.7053587062048, 58.83787956681415, 62.45771040538276, 59.46435418579777, 61.080566904292745, 44.596478258250386, 57.43345543343164, 60.790026100700516, 55.851188004199216, 58.43561094297526, 46.378553968368124, 59.42392631543381, 63.44412158743217, 53.6463439809824, 59.421782831628526, 57.874935909860966, 61.18806417975087, 59.430105665720696, 59.568338061892305, 45.55467817021159, 59.66898260954586, 55.96342722730587, 54.63136337227652, 57.69857299071695, 46.91755211729243, 56.167858734642564, 64.92651950532343, 51.621237398633646, 61.845355617431544, 56.099305769080935, 59.96942334632821, 53.4091205117892, 58.20687078536155, 41.5840048719834, 59.46553525864529, 60.51138857226137, 51.88886372247858, 57.23588931197882, 43.73410315102119, 56.40341372475534, 59.98200509736899, 59.28892856194759, 62.656171343311684, 56.56125935471727, 55.399559495842254, 58.57343334584526, 54.68741697862107, 43.3032885833533, 60.09030850675731, 58.74643444696246], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7908871268168864, "mean_inference_ms": 8.020151189099407, "mean_action_processing_ms": 0.5677582311585655, "mean_env_wait_ms": 24.23113897130755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03466296195983887, "StateBufferConnector_ms": 0.03140115737915039, "ViewRequirementAgentConnector_ms": 0.9723289012908936}}, "episode_reward_max": 66.7053587062048, "episode_reward_min": 41.5840048719834, "episode_reward_mean": 56.75056077129998, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [56.08593333309034, 59.47900651160861, 54.55163474596327, 58.32311252549228, 41.95581948188298, 61.24862995854372, 59.25745583347978, 55.01440618065561, 58.741630119658026, 56.673980394850695, 60.08139349842383, 55.40923305265518, 56.95229849494429, 43.30762354104158, 54.7269129385093, 65.49398251072343, 54.30303290536481, 58.91254278152809, 44.68633300441303, 59.43488356813462, 62.29022564638023, 58.57201971567841, 63.55158027118566, 60.270623521448094, 61.93010688457257, 51.37785298158417, 57.567868696942185, 45.54089138373825, 58.30238691906169, 60.84573984442831, 58.00085948005059, 59.28566991135719, 45.97232184728348, 59.5077325947515, 62.56005167521424, 55.424110513048696, 63.594842556955925, 58.91698391246937, 65.1283569341932, 56.44944283359561, 60.51532501006705, 41.798324730742614, 57.31339296135886, 62.532626235802866, 54.883390891653065, 56.25954836234547, 49.23590298283591, 61.824207540976424, 65.89755804140871, 56.24521337499317, 66.7053587062048, 58.83787956681415, 62.45771040538276, 59.46435418579777, 61.080566904292745, 44.596478258250386, 57.43345543343164, 60.790026100700516, 55.851188004199216, 58.43561094297526, 46.378553968368124, 59.42392631543381, 63.44412158743217, 53.6463439809824, 59.421782831628526, 57.874935909860966, 61.18806417975087, 59.430105665720696, 59.568338061892305, 45.55467817021159, 59.66898260954586, 55.96342722730587, 54.63136337227652, 57.69857299071695, 46.91755211729243, 56.167858734642564, 64.92651950532343, 51.621237398633646, 61.845355617431544, 56.099305769080935, 59.96942334632821, 53.4091205117892, 58.20687078536155, 41.5840048719834, 59.46553525864529, 60.51138857226137, 51.88886372247858, 57.23588931197882, 43.73410315102119, 56.40341372475534, 59.98200509736899, 59.28892856194759, 62.656171343311684, 56.56125935471727, 55.399559495842254, 58.57343334584526, 54.68741697862107, 43.3032885833533, 60.09030850675731, 58.74643444696246], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7908871268168864, "mean_inference_ms": 8.020151189099407, "mean_action_processing_ms": 0.5677582311585655, "mean_env_wait_ms": 24.23113897130755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03466296195983887, "StateBufferConnector_ms": 0.03140115737915039, "ViewRequirementAgentConnector_ms": 0.9723289012908936}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1532794, "num_agent_steps_trained": 1532794, "num_env_steps_sampled": 1532794, "num_env_steps_trained": 1532794, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.16692180227076, "num_env_steps_trained_throughput_per_sec": 227.16692180227076, "timesteps_total": 1532794, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1532794, "timers": {"training_iteration_time_ms": 68454.372, "sample_time_ms": 42509.405, "load_time_ms": 2372.066, "load_throughput": 6592.566, "learn_time_ms": 22980.954, "learn_throughput": 680.477, "synch_weights_time_ms": 467.712}, "counters": {"num_env_steps_sampled": 1532794, "num_env_steps_trained": 1532794, "num_agent_steps_sampled": 1532794, "num_agent_steps_trained": 1532794}, "done": false, "episodes_total": 1486, "training_iteration": 106, "trial_id": "837cb_00000", "date": "2025-06-07_19-22-09", "timestamp": 1749316929, "time_this_iter_s": 68.87317252159119, "time_total_s": 6979.060313940048, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6979.060313940048, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 63.97594936708859, "ram_util_percent": 90.26708860759494, "gpu_util_percent0": 0.21481012658227847, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.467206000000001e-05, "total_loss": -0.08247939819554713, "policy_loss": -0.01921630141579292, "vf_loss": 0.013585032239048318, "vf_explained_var": 0.9542982749505476, "kl": 0.019524850917835207, "entropy": 16.320405575145376, "entropy_coeff": 0.004200809}, "model": {}, "num_grad_updates_lifetime": 54215.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1548432, "num_env_steps_trained": 1548432, "num_agent_steps_sampled": 1548432, "num_agent_steps_trained": 1548432}, "sampler_results": {"episode_reward_max": 66.7053587062048, "episode_reward_min": 41.5840048719834, "episode_reward_mean": 56.939273692518945, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.7269129385093, 65.49398251072343, 54.30303290536481, 58.91254278152809, 44.68633300441303, 59.43488356813462, 62.29022564638023, 58.57201971567841, 63.55158027118566, 60.270623521448094, 61.93010688457257, 51.37785298158417, 57.567868696942185, 45.54089138373825, 58.30238691906169, 60.84573984442831, 58.00085948005059, 59.28566991135719, 45.97232184728348, 59.5077325947515, 62.56005167521424, 55.424110513048696, 63.594842556955925, 58.91698391246937, 65.1283569341932, 56.44944283359561, 60.51532501006705, 41.798324730742614, 57.31339296135886, 62.532626235802866, 54.883390891653065, 56.25954836234547, 49.23590298283591, 61.824207540976424, 65.89755804140871, 56.24521337499317, 66.7053587062048, 58.83787956681415, 62.45771040538276, 59.46435418579777, 61.080566904292745, 44.596478258250386, 57.43345543343164, 60.790026100700516, 55.851188004199216, 58.43561094297526, 46.378553968368124, 59.42392631543381, 63.44412158743217, 53.6463439809824, 59.421782831628526, 57.874935909860966, 61.18806417975087, 59.430105665720696, 59.568338061892305, 45.55467817021159, 59.66898260954586, 55.96342722730587, 54.63136337227652, 57.69857299071695, 46.91755211729243, 56.167858734642564, 64.92651950532343, 51.621237398633646, 61.845355617431544, 56.099305769080935, 59.96942334632821, 53.4091205117892, 58.20687078536155, 41.5840048719834, 59.46553525864529, 60.51138857226137, 51.88886372247858, 57.23588931197882, 43.73410315102119, 56.40341372475534, 59.98200509736899, 59.28892856194759, 62.656171343311684, 56.56125935471727, 55.399559495842254, 58.57343334584526, 54.68741697862107, 43.3032885833533, 60.09030850675731, 58.74643444696246, 55.86956745099126, 55.975781117393566, 48.159108382251596, 55.12985469950743, 65.35734949714941, 55.23131495313532, 64.10623782849896, 61.94498674724007, 58.86375936095143, 52.80861917541321, 56.16771327603757, 43.669679010464066, 60.36745234286294, 62.30202595229052], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.790086436275305, "mean_inference_ms": 8.019429920504802, "mean_action_processing_ms": 0.5676312132234729, "mean_env_wait_ms": 24.235027534048395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04071950912475586, "StateBufferConnector_ms": 0.03371024131774902, "ViewRequirementAgentConnector_ms": 1.0614140033721924}}, "episode_reward_max": 66.7053587062048, "episode_reward_min": 41.5840048719834, "episode_reward_mean": 56.939273692518945, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.7269129385093, 65.49398251072343, 54.30303290536481, 58.91254278152809, 44.68633300441303, 59.43488356813462, 62.29022564638023, 58.57201971567841, 63.55158027118566, 60.270623521448094, 61.93010688457257, 51.37785298158417, 57.567868696942185, 45.54089138373825, 58.30238691906169, 60.84573984442831, 58.00085948005059, 59.28566991135719, 45.97232184728348, 59.5077325947515, 62.56005167521424, 55.424110513048696, 63.594842556955925, 58.91698391246937, 65.1283569341932, 56.44944283359561, 60.51532501006705, 41.798324730742614, 57.31339296135886, 62.532626235802866, 54.883390891653065, 56.25954836234547, 49.23590298283591, 61.824207540976424, 65.89755804140871, 56.24521337499317, 66.7053587062048, 58.83787956681415, 62.45771040538276, 59.46435418579777, 61.080566904292745, 44.596478258250386, 57.43345543343164, 60.790026100700516, 55.851188004199216, 58.43561094297526, 46.378553968368124, 59.42392631543381, 63.44412158743217, 53.6463439809824, 59.421782831628526, 57.874935909860966, 61.18806417975087, 59.430105665720696, 59.568338061892305, 45.55467817021159, 59.66898260954586, 55.96342722730587, 54.63136337227652, 57.69857299071695, 46.91755211729243, 56.167858734642564, 64.92651950532343, 51.621237398633646, 61.845355617431544, 56.099305769080935, 59.96942334632821, 53.4091205117892, 58.20687078536155, 41.5840048719834, 59.46553525864529, 60.51138857226137, 51.88886372247858, 57.23588931197882, 43.73410315102119, 56.40341372475534, 59.98200509736899, 59.28892856194759, 62.656171343311684, 56.56125935471727, 55.399559495842254, 58.57343334584526, 54.68741697862107, 43.3032885833533, 60.09030850675731, 58.74643444696246, 55.86956745099126, 55.975781117393566, 48.159108382251596, 55.12985469950743, 65.35734949714941, 55.23131495313532, 64.10623782849896, 61.94498674724007, 58.86375936095143, 52.80861917541321, 56.16771327603757, 43.669679010464066, 60.36745234286294, 62.30202595229052], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.790086436275305, "mean_inference_ms": 8.019429920504802, "mean_action_processing_ms": 0.5676312132234729, "mean_env_wait_ms": 24.235027534048395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04071950912475586, "StateBufferConnector_ms": 0.03371024131774902, "ViewRequirementAgentConnector_ms": 1.0614140033721924}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1548432, "num_agent_steps_trained": 1548432, "num_env_steps_sampled": 1548432, "num_env_steps_trained": 1548432, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.95971322779866, "num_env_steps_trained_throughput_per_sec": 227.95971322779866, "timesteps_total": 1548432, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1548432, "timers": {"training_iteration_time_ms": 68539.081, "sample_time_ms": 42514.015, "load_time_ms": 2361.433, "load_throughput": 6622.251, "learn_time_ms": 23074.495, "learn_throughput": 677.718, "synch_weights_time_ms": 466.274}, "counters": {"num_env_steps_sampled": 1548432, "num_env_steps_trained": 1548432, "num_agent_steps_sampled": 1548432, "num_agent_steps_trained": 1548432}, "done": false, "episodes_total": 1500, "training_iteration": 107, "trial_id": "837cb_00000", "date": "2025-06-07_19-23-18", "timestamp": 1749316998, "time_this_iter_s": 68.61783266067505, "time_total_s": 7047.678146600723, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7047.678146600723, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 65.1367088607595, "ram_util_percent": 88.78354430379747, "gpu_util_percent0": 0.21392405063291137, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.451568e-05, "total_loss": -0.0823508978787471, "policy_loss": -0.01931453732905952, "vf_loss": 0.013520038589327172, "vf_explained_var": 0.9597905145991932, "kl": 0.019310743011489957, "entropy": 16.34990192933516, "entropy_coeff": 0.004177352000000001}, "model": {}, "num_grad_updates_lifetime": 54765.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1564070, "num_env_steps_trained": 1564070, "num_agent_steps_sampled": 1564070, "num_agent_steps_trained": 1564070}, "sampler_results": {"episode_reward_max": 66.7053587062048, "episode_reward_min": 40.56795475606187, "episode_reward_mean": 56.92277503000281, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [58.30238691906169, 60.84573984442831, 58.00085948005059, 59.28566991135719, 45.97232184728348, 59.5077325947515, 62.56005167521424, 55.424110513048696, 63.594842556955925, 58.91698391246937, 65.1283569341932, 56.44944283359561, 60.51532501006705, 41.798324730742614, 57.31339296135886, 62.532626235802866, 54.883390891653065, 56.25954836234547, 49.23590298283591, 61.824207540976424, 65.89755804140871, 56.24521337499317, 66.7053587062048, 58.83787956681415, 62.45771040538276, 59.46435418579777, 61.080566904292745, 44.596478258250386, 57.43345543343164, 60.790026100700516, 55.851188004199216, 58.43561094297526, 46.378553968368124, 59.42392631543381, 63.44412158743217, 53.6463439809824, 59.421782831628526, 57.874935909860966, 61.18806417975087, 59.430105665720696, 59.568338061892305, 45.55467817021159, 59.66898260954586, 55.96342722730587, 54.63136337227652, 57.69857299071695, 46.91755211729243, 56.167858734642564, 64.92651950532343, 51.621237398633646, 61.845355617431544, 56.099305769080935, 59.96942334632821, 53.4091205117892, 58.20687078536155, 41.5840048719834, 59.46553525864529, 60.51138857226137, 51.88886372247858, 57.23588931197882, 43.73410315102119, 56.40341372475534, 59.98200509736899, 59.28892856194759, 62.656171343311684, 56.56125935471727, 55.399559495842254, 58.57343334584526, 54.68741697862107, 43.3032885833533, 60.09030850675731, 58.74643444696246, 55.86956745099126, 55.975781117393566, 48.159108382251596, 55.12985469950743, 65.35734949714941, 55.23131495313532, 64.10623782849896, 61.94498674724007, 58.86375936095143, 52.80861917541321, 56.16771327603757, 43.669679010464066, 60.36745234286294, 62.30202595229052, 57.948765545078665, 57.934496583967466, 47.70330920670414, 61.55126024839962, 62.4033089931704, 58.77094956741026, 61.496536128525506, 60.165189472622785, 59.49839621465051, 55.29043483179642, 60.072124833408225, 40.56795475606187, 56.49786945769988, 57.10839471909288], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.789128281221817, "mean_inference_ms": 8.017996028119537, "mean_action_processing_ms": 0.5674220675982407, "mean_env_wait_ms": 24.237360223115335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03963756561279297, "StateBufferConnector_ms": 0.038771867752075195, "ViewRequirementAgentConnector_ms": 1.0445926189422607}}, "episode_reward_max": 66.7053587062048, "episode_reward_min": 40.56795475606187, "episode_reward_mean": 56.92277503000281, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [58.30238691906169, 60.84573984442831, 58.00085948005059, 59.28566991135719, 45.97232184728348, 59.5077325947515, 62.56005167521424, 55.424110513048696, 63.594842556955925, 58.91698391246937, 65.1283569341932, 56.44944283359561, 60.51532501006705, 41.798324730742614, 57.31339296135886, 62.532626235802866, 54.883390891653065, 56.25954836234547, 49.23590298283591, 61.824207540976424, 65.89755804140871, 56.24521337499317, 66.7053587062048, 58.83787956681415, 62.45771040538276, 59.46435418579777, 61.080566904292745, 44.596478258250386, 57.43345543343164, 60.790026100700516, 55.851188004199216, 58.43561094297526, 46.378553968368124, 59.42392631543381, 63.44412158743217, 53.6463439809824, 59.421782831628526, 57.874935909860966, 61.18806417975087, 59.430105665720696, 59.568338061892305, 45.55467817021159, 59.66898260954586, 55.96342722730587, 54.63136337227652, 57.69857299071695, 46.91755211729243, 56.167858734642564, 64.92651950532343, 51.621237398633646, 61.845355617431544, 56.099305769080935, 59.96942334632821, 53.4091205117892, 58.20687078536155, 41.5840048719834, 59.46553525864529, 60.51138857226137, 51.88886372247858, 57.23588931197882, 43.73410315102119, 56.40341372475534, 59.98200509736899, 59.28892856194759, 62.656171343311684, 56.56125935471727, 55.399559495842254, 58.57343334584526, 54.68741697862107, 43.3032885833533, 60.09030850675731, 58.74643444696246, 55.86956745099126, 55.975781117393566, 48.159108382251596, 55.12985469950743, 65.35734949714941, 55.23131495313532, 64.10623782849896, 61.94498674724007, 58.86375936095143, 52.80861917541321, 56.16771327603757, 43.669679010464066, 60.36745234286294, 62.30202595229052, 57.948765545078665, 57.934496583967466, 47.70330920670414, 61.55126024839962, 62.4033089931704, 58.77094956741026, 61.496536128525506, 60.165189472622785, 59.49839621465051, 55.29043483179642, 60.072124833408225, 40.56795475606187, 56.49786945769988, 57.10839471909288], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.789128281221817, "mean_inference_ms": 8.017996028119537, "mean_action_processing_ms": 0.5674220675982407, "mean_env_wait_ms": 24.237360223115335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03963756561279297, "StateBufferConnector_ms": 0.038771867752075195, "ViewRequirementAgentConnector_ms": 1.0445926189422607}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1564070, "num_agent_steps_trained": 1564070, "num_env_steps_sampled": 1564070, "num_env_steps_trained": 1564070, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.78797878880633, "num_env_steps_trained_throughput_per_sec": 227.78797878880633, "timesteps_total": 1564070, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1564070, "timers": {"training_iteration_time_ms": 68629.686, "sample_time_ms": 42537.912, "load_time_ms": 2350.435, "load_throughput": 6653.237, "learn_time_ms": 23173.781, "learn_throughput": 674.814, "synch_weights_time_ms": 453.645}, "counters": {"num_env_steps_sampled": 1564070, "num_env_steps_trained": 1564070, "num_agent_steps_sampled": 1564070, "num_agent_steps_trained": 1564070}, "done": false, "episodes_total": 1514, "training_iteration": 108, "trial_id": "837cb_00000", "date": "2025-06-07_19-24-26", "timestamp": 1749317066, "time_this_iter_s": 68.69388771057129, "time_total_s": 7116.372034311295, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7116.372034311295, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 65.34615384615384, "ram_util_percent": 87.87179487179488, "gpu_util_percent0": 0.21499999999999994, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.435929999999999e-05, "total_loss": -0.06666673605160957, "policy_loss": -0.0037727321961111473, "vf_loss": 0.01372035660865632, "vf_explained_var": 0.9592572019316933, "kl": 0.019605782711193696, "entropy": 16.426864291104405, "entropy_coeff": 0.004153895}, "model": {}, "num_grad_updates_lifetime": 55315.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1579708, "num_env_steps_trained": 1579708, "num_agent_steps_sampled": 1579708, "num_agent_steps_trained": 1579708}, "sampler_results": {"episode_reward_max": 66.7053587062048, "episode_reward_min": 40.56795475606187, "episode_reward_mean": 56.6529325463114, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.31339296135886, 62.532626235802866, 54.883390891653065, 56.25954836234547, 49.23590298283591, 61.824207540976424, 65.89755804140871, 56.24521337499317, 66.7053587062048, 58.83787956681415, 62.45771040538276, 59.46435418579777, 61.080566904292745, 44.596478258250386, 57.43345543343164, 60.790026100700516, 55.851188004199216, 58.43561094297526, 46.378553968368124, 59.42392631543381, 63.44412158743217, 53.6463439809824, 59.421782831628526, 57.874935909860966, 61.18806417975087, 59.430105665720696, 59.568338061892305, 45.55467817021159, 59.66898260954586, 55.96342722730587, 54.63136337227652, 57.69857299071695, 46.91755211729243, 56.167858734642564, 64.92651950532343, 51.621237398633646, 61.845355617431544, 56.099305769080935, 59.96942334632821, 53.4091205117892, 58.20687078536155, 41.5840048719834, 59.46553525864529, 60.51138857226137, 51.88886372247858, 57.23588931197882, 43.73410315102119, 56.40341372475534, 59.98200509736899, 59.28892856194759, 62.656171343311684, 56.56125935471727, 55.399559495842254, 58.57343334584526, 54.68741697862107, 43.3032885833533, 60.09030850675731, 58.74643444696246, 55.86956745099126, 55.975781117393566, 48.159108382251596, 55.12985469950743, 65.35734949714941, 55.23131495313532, 64.10623782849896, 61.94498674724007, 58.86375936095143, 52.80861917541321, 56.16771327603757, 43.669679010464066, 60.36745234286294, 62.30202595229052, 57.948765545078665, 57.934496583967466, 47.70330920670414, 61.55126024839962, 62.4033089931704, 58.77094956741026, 61.496536128525506, 60.165189472622785, 59.49839621465051, 55.29043483179642, 60.072124833408225, 40.56795475606187, 56.49786945769988, 57.10839471909288, 52.3344070249577, 54.857164324998976, 42.7551580384037, 57.55355346493166, 60.29342046236444, 57.30268529542781, 62.16546633985844, 55.07268949273754, 59.68150388899383, 55.33628418335664, 54.274487986917315, 45.69569500453437, 60.76491994159666, 61.23046494500051], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.788371161346954, "mean_inference_ms": 8.016408900975808, "mean_action_processing_ms": 0.5671922296795687, "mean_env_wait_ms": 24.238884902217166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04473137855529785, "StateBufferConnector_ms": 0.03779768943786621, "ViewRequirementAgentConnector_ms": 1.026186227798462}}, "episode_reward_max": 66.7053587062048, "episode_reward_min": 40.56795475606187, "episode_reward_mean": 56.6529325463114, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [57.31339296135886, 62.532626235802866, 54.883390891653065, 56.25954836234547, 49.23590298283591, 61.824207540976424, 65.89755804140871, 56.24521337499317, 66.7053587062048, 58.83787956681415, 62.45771040538276, 59.46435418579777, 61.080566904292745, 44.596478258250386, 57.43345543343164, 60.790026100700516, 55.851188004199216, 58.43561094297526, 46.378553968368124, 59.42392631543381, 63.44412158743217, 53.6463439809824, 59.421782831628526, 57.874935909860966, 61.18806417975087, 59.430105665720696, 59.568338061892305, 45.55467817021159, 59.66898260954586, 55.96342722730587, 54.63136337227652, 57.69857299071695, 46.91755211729243, 56.167858734642564, 64.92651950532343, 51.621237398633646, 61.845355617431544, 56.099305769080935, 59.96942334632821, 53.4091205117892, 58.20687078536155, 41.5840048719834, 59.46553525864529, 60.51138857226137, 51.88886372247858, 57.23588931197882, 43.73410315102119, 56.40341372475534, 59.98200509736899, 59.28892856194759, 62.656171343311684, 56.56125935471727, 55.399559495842254, 58.57343334584526, 54.68741697862107, 43.3032885833533, 60.09030850675731, 58.74643444696246, 55.86956745099126, 55.975781117393566, 48.159108382251596, 55.12985469950743, 65.35734949714941, 55.23131495313532, 64.10623782849896, 61.94498674724007, 58.86375936095143, 52.80861917541321, 56.16771327603757, 43.669679010464066, 60.36745234286294, 62.30202595229052, 57.948765545078665, 57.934496583967466, 47.70330920670414, 61.55126024839962, 62.4033089931704, 58.77094956741026, 61.496536128525506, 60.165189472622785, 59.49839621465051, 55.29043483179642, 60.072124833408225, 40.56795475606187, 56.49786945769988, 57.10839471909288, 52.3344070249577, 54.857164324998976, 42.7551580384037, 57.55355346493166, 60.29342046236444, 57.30268529542781, 62.16546633985844, 55.07268949273754, 59.68150388899383, 55.33628418335664, 54.274487986917315, 45.69569500453437, 60.76491994159666, 61.23046494500051], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.788371161346954, "mean_inference_ms": 8.016408900975808, "mean_action_processing_ms": 0.5671922296795687, "mean_env_wait_ms": 24.238884902217166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04473137855529785, "StateBufferConnector_ms": 0.03779768943786621, "ViewRequirementAgentConnector_ms": 1.026186227798462}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1579708, "num_agent_steps_trained": 1579708, "num_env_steps_sampled": 1579708, "num_env_steps_trained": 1579708, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 231.635772404673, "num_env_steps_trained_throughput_per_sec": 231.635772404673, "timesteps_total": 1579708, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1579708, "timers": {"training_iteration_time_ms": 68608.942, "sample_time_ms": 42426.193, "load_time_ms": 2351.991, "load_throughput": 6648.835, "learn_time_ms": 23253.067, "learn_throughput": 672.513, "synch_weights_time_ms": 461.014}, "counters": {"num_env_steps_sampled": 1579708, "num_env_steps_trained": 1579708, "num_agent_steps_sampled": 1579708, "num_agent_steps_trained": 1579708}, "done": false, "episodes_total": 1528, "training_iteration": 109, "trial_id": "837cb_00000", "date": "2025-06-07_19-25-34", "timestamp": 1749317134, "time_this_iter_s": 67.52915453910828, "time_total_s": 7183.901188850403, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7183.901188850403, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 64.29871794871794, "ram_util_percent": 88.53076923076921, "gpu_util_percent0": 0.2206410256410257, "vram_util_percent0": 0.9650065104166671}}
{"evaluation": {"sampler_results": {"episode_reward_max": -2.6945991645189373, "episode_reward_min": -3.2548853531707933, "episode_reward_mean": -2.944310308497575, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0987199122609685, -2.799989102381854, -3.2548853531707933, -2.873358010155321, -2.6945991645189373], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.909920236666487, "mean_inference_ms": 4.056382256997761, "mean_action_processing_ms": 0.29573274711742314, "mean_env_wait_ms": 12.78797148621703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020051002502441406, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.7030296325683594}}, "episode_reward_max": -2.6945991645189373, "episode_reward_min": -3.2548853531707933, "episode_reward_mean": -2.944310308497575, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0987199122609685, -2.799989102381854, -3.2548853531707933, -2.873358010155321, -2.6945991645189373], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.909920236666487, "mean_inference_ms": 4.056382256997761, "mean_action_processing_ms": 0.29573274711742314, "mean_env_wait_ms": 12.78797148621703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020051002502441406, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.7030296325683594}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.420292000000001e-05, "total_loss": -0.05616980111819099, "policy_loss": 0.0062771880931474944, "vf_loss": 0.013953534870154478, "vf_explained_var": 0.9594114524667914, "kl": 0.019256440970960274, "entropy": 16.423580070842394, "entropy_coeff": 0.004130438}, "model": {}, "num_grad_updates_lifetime": 55865.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1595346, "num_env_steps_trained": 1595346, "num_agent_steps_sampled": 1595346, "num_agent_steps_trained": 1595346}, "sampler_results": {"episode_reward_max": 65.35734949714941, "episode_reward_min": 40.56795475606187, "episode_reward_mean": 56.138622299542725, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.43345543343164, 60.790026100700516, 55.851188004199216, 58.43561094297526, 46.378553968368124, 59.42392631543381, 63.44412158743217, 53.6463439809824, 59.421782831628526, 57.874935909860966, 61.18806417975087, 59.430105665720696, 59.568338061892305, 45.55467817021159, 59.66898260954586, 55.96342722730587, 54.63136337227652, 57.69857299071695, 46.91755211729243, 56.167858734642564, 64.92651950532343, 51.621237398633646, 61.845355617431544, 56.099305769080935, 59.96942334632821, 53.4091205117892, 58.20687078536155, 41.5840048719834, 59.46553525864529, 60.51138857226137, 51.88886372247858, 57.23588931197882, 43.73410315102119, 56.40341372475534, 59.98200509736899, 59.28892856194759, 62.656171343311684, 56.56125935471727, 55.399559495842254, 58.57343334584526, 54.68741697862107, 43.3032885833533, 60.09030850675731, 58.74643444696246, 55.86956745099126, 55.975781117393566, 48.159108382251596, 55.12985469950743, 65.35734949714941, 55.23131495313532, 64.10623782849896, 61.94498674724007, 58.86375936095143, 52.80861917541321, 56.16771327603757, 43.669679010464066, 60.36745234286294, 62.30202595229052, 57.948765545078665, 57.934496583967466, 47.70330920670414, 61.55126024839962, 62.4033089931704, 58.77094956741026, 61.496536128525506, 60.165189472622785, 59.49839621465051, 55.29043483179642, 60.072124833408225, 40.56795475606187, 56.49786945769988, 57.10839471909288, 52.3344070249577, 54.857164324998976, 42.7551580384037, 57.55355346493166, 60.29342046236444, 57.30268529542781, 62.16546633985844, 55.07268949273754, 59.68150388899383, 55.33628418335664, 54.274487986917315, 45.69569500453437, 60.76491994159666, 61.23046494500051, 55.16650211942004, 56.11757097521659, 45.24253368042953, 53.04518489722059, 59.56194038312566, 49.30409822065419, 60.598740056368044, 51.13531018513746, 62.10794129470669, 54.87255769955197, 56.18952925825033, 43.07356074363809, 56.24091675506101, 63.24677747246867], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7873897778133623, "mean_inference_ms": 8.01468470630741, "mean_action_processing_ms": 0.5669452612409536, "mean_env_wait_ms": 24.24035845285349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04619312286376953, "StateBufferConnector_ms": 0.041738271713256836, "ViewRequirementAgentConnector_ms": 1.0319263935089111}}, "episode_reward_max": 65.35734949714941, "episode_reward_min": 40.56795475606187, "episode_reward_mean": 56.138622299542725, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [57.43345543343164, 60.790026100700516, 55.851188004199216, 58.43561094297526, 46.378553968368124, 59.42392631543381, 63.44412158743217, 53.6463439809824, 59.421782831628526, 57.874935909860966, 61.18806417975087, 59.430105665720696, 59.568338061892305, 45.55467817021159, 59.66898260954586, 55.96342722730587, 54.63136337227652, 57.69857299071695, 46.91755211729243, 56.167858734642564, 64.92651950532343, 51.621237398633646, 61.845355617431544, 56.099305769080935, 59.96942334632821, 53.4091205117892, 58.20687078536155, 41.5840048719834, 59.46553525864529, 60.51138857226137, 51.88886372247858, 57.23588931197882, 43.73410315102119, 56.40341372475534, 59.98200509736899, 59.28892856194759, 62.656171343311684, 56.56125935471727, 55.399559495842254, 58.57343334584526, 54.68741697862107, 43.3032885833533, 60.09030850675731, 58.74643444696246, 55.86956745099126, 55.975781117393566, 48.159108382251596, 55.12985469950743, 65.35734949714941, 55.23131495313532, 64.10623782849896, 61.94498674724007, 58.86375936095143, 52.80861917541321, 56.16771327603757, 43.669679010464066, 60.36745234286294, 62.30202595229052, 57.948765545078665, 57.934496583967466, 47.70330920670414, 61.55126024839962, 62.4033089931704, 58.77094956741026, 61.496536128525506, 60.165189472622785, 59.49839621465051, 55.29043483179642, 60.072124833408225, 40.56795475606187, 56.49786945769988, 57.10839471909288, 52.3344070249577, 54.857164324998976, 42.7551580384037, 57.55355346493166, 60.29342046236444, 57.30268529542781, 62.16546633985844, 55.07268949273754, 59.68150388899383, 55.33628418335664, 54.274487986917315, 45.69569500453437, 60.76491994159666, 61.23046494500051, 55.16650211942004, 56.11757097521659, 45.24253368042953, 53.04518489722059, 59.56194038312566, 49.30409822065419, 60.598740056368044, 51.13531018513746, 62.10794129470669, 54.87255769955197, 56.18952925825033, 43.07356074363809, 56.24091675506101, 63.24677747246867], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7873897778133623, "mean_inference_ms": 8.01468470630741, "mean_action_processing_ms": 0.5669452612409536, "mean_env_wait_ms": 24.24035845285349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04619312286376953, "StateBufferConnector_ms": 0.041738271713256836, "ViewRequirementAgentConnector_ms": 1.0319263935089111}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1595346, "num_agent_steps_trained": 1595346, "num_env_steps_sampled": 1595346, "num_env_steps_trained": 1595346, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 230.94711102163592, "num_env_steps_trained_throughput_per_sec": 230.94711102163592, "timesteps_total": 1595346, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1595346, "timers": {"training_iteration_time_ms": 68559.296, "sample_time_ms": 42332.096, "load_time_ms": 2342.621, "load_throughput": 6675.428, "learn_time_ms": 23325.556, "learn_throughput": 670.423, "synch_weights_time_ms": 443.801}, "counters": {"num_env_steps_sampled": 1595346, "num_env_steps_trained": 1595346, "num_agent_steps_sampled": 1595346, "num_agent_steps_trained": 1595346}, "done": false, "episodes_total": 1542, "training_iteration": 110, "trial_id": "837cb_00000", "date": "2025-06-07_19-26-57", "timestamp": 1749317217, "time_this_iter_s": 82.94940257072449, "time_total_s": 7266.850591421127, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7266.850591421127, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 56.9625, "ram_util_percent": 88.11354166666668, "gpu_util_percent0": 0.17875, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.404654000000001e-05, "total_loss": -0.07120156546673653, "policy_loss": -0.009309740443713964, "vf_loss": 0.013816310831514949, "vf_explained_var": 0.9601538081602616, "kl": 0.019492140015902337, "entropy": 16.375769056840376, "entropy_coeff": 0.004106981000000001}, "model": {}, "num_grad_updates_lifetime": 56415.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1610984, "num_env_steps_trained": 1610984, "num_agent_steps_sampled": 1610984, "num_agent_steps_trained": 1610984}, "sampler_results": {"episode_reward_max": 65.35734949714941, "episode_reward_min": 40.56795475606187, "episode_reward_mean": 55.81202147022724, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.66898260954586, 55.96342722730587, 54.63136337227652, 57.69857299071695, 46.91755211729243, 56.167858734642564, 64.92651950532343, 51.621237398633646, 61.845355617431544, 56.099305769080935, 59.96942334632821, 53.4091205117892, 58.20687078536155, 41.5840048719834, 59.46553525864529, 60.51138857226137, 51.88886372247858, 57.23588931197882, 43.73410315102119, 56.40341372475534, 59.98200509736899, 59.28892856194759, 62.656171343311684, 56.56125935471727, 55.399559495842254, 58.57343334584526, 54.68741697862107, 43.3032885833533, 60.09030850675731, 58.74643444696246, 55.86956745099126, 55.975781117393566, 48.159108382251596, 55.12985469950743, 65.35734949714941, 55.23131495313532, 64.10623782849896, 61.94498674724007, 58.86375936095143, 52.80861917541321, 56.16771327603757, 43.669679010464066, 60.36745234286294, 62.30202595229052, 57.948765545078665, 57.934496583967466, 47.70330920670414, 61.55126024839962, 62.4033089931704, 58.77094956741026, 61.496536128525506, 60.165189472622785, 59.49839621465051, 55.29043483179642, 60.072124833408225, 40.56795475606187, 56.49786945769988, 57.10839471909288, 52.3344070249577, 54.857164324998976, 42.7551580384037, 57.55355346493166, 60.29342046236444, 57.30268529542781, 62.16546633985844, 55.07268949273754, 59.68150388899383, 55.33628418335664, 54.274487986917315, 45.69569500453437, 60.76491994159666, 61.23046494500051, 55.16650211942004, 56.11757097521659, 45.24253368042953, 53.04518489722059, 59.56194038312566, 49.30409822065419, 60.598740056368044, 51.13531018513746, 62.10794129470669, 54.87255769955197, 56.18952925825033, 43.07356074363809, 56.24091675506101, 63.24677747246867, 53.049860719775054, 55.462377921768415, 42.66209536967038, 59.6696538716943, 62.2271956996741, 54.70396318274202, 57.54018542249721, 55.33153596087589, 55.64340357217322, 54.08513079861441, 56.463883556911966, 43.60069754520055, 61.13943715027659, 54.201627449166224], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.786479872396488, "mean_inference_ms": 8.012878485274047, "mean_action_processing_ms": 0.5666940378911663, "mean_env_wait_ms": 24.241829807060537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04915142059326172, "StateBufferConnector_ms": 0.03969168663024902, "ViewRequirementAgentConnector_ms": 1.011382818222046}}, "episode_reward_max": 65.35734949714941, "episode_reward_min": 40.56795475606187, "episode_reward_mean": 55.81202147022724, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.66898260954586, 55.96342722730587, 54.63136337227652, 57.69857299071695, 46.91755211729243, 56.167858734642564, 64.92651950532343, 51.621237398633646, 61.845355617431544, 56.099305769080935, 59.96942334632821, 53.4091205117892, 58.20687078536155, 41.5840048719834, 59.46553525864529, 60.51138857226137, 51.88886372247858, 57.23588931197882, 43.73410315102119, 56.40341372475534, 59.98200509736899, 59.28892856194759, 62.656171343311684, 56.56125935471727, 55.399559495842254, 58.57343334584526, 54.68741697862107, 43.3032885833533, 60.09030850675731, 58.74643444696246, 55.86956745099126, 55.975781117393566, 48.159108382251596, 55.12985469950743, 65.35734949714941, 55.23131495313532, 64.10623782849896, 61.94498674724007, 58.86375936095143, 52.80861917541321, 56.16771327603757, 43.669679010464066, 60.36745234286294, 62.30202595229052, 57.948765545078665, 57.934496583967466, 47.70330920670414, 61.55126024839962, 62.4033089931704, 58.77094956741026, 61.496536128525506, 60.165189472622785, 59.49839621465051, 55.29043483179642, 60.072124833408225, 40.56795475606187, 56.49786945769988, 57.10839471909288, 52.3344070249577, 54.857164324998976, 42.7551580384037, 57.55355346493166, 60.29342046236444, 57.30268529542781, 62.16546633985844, 55.07268949273754, 59.68150388899383, 55.33628418335664, 54.274487986917315, 45.69569500453437, 60.76491994159666, 61.23046494500051, 55.16650211942004, 56.11757097521659, 45.24253368042953, 53.04518489722059, 59.56194038312566, 49.30409822065419, 60.598740056368044, 51.13531018513746, 62.10794129470669, 54.87255769955197, 56.18952925825033, 43.07356074363809, 56.24091675506101, 63.24677747246867, 53.049860719775054, 55.462377921768415, 42.66209536967038, 59.6696538716943, 62.2271956996741, 54.70396318274202, 57.54018542249721, 55.33153596087589, 55.64340357217322, 54.08513079861441, 56.463883556911966, 43.60069754520055, 61.13943715027659, 54.201627449166224], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.786479872396488, "mean_inference_ms": 8.012878485274047, "mean_action_processing_ms": 0.5666940378911663, "mean_env_wait_ms": 24.241829807060537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04915142059326172, "StateBufferConnector_ms": 0.03969168663024902, "ViewRequirementAgentConnector_ms": 1.011382818222046}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1610984, "num_agent_steps_trained": 1610984, "num_env_steps_sampled": 1610984, "num_env_steps_trained": 1610984, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.63317048811209, "num_env_steps_trained_throughput_per_sec": 229.63317048811209, "timesteps_total": 1610984, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1610984, "timers": {"training_iteration_time_ms": 68281.768, "sample_time_ms": 42070.162, "load_time_ms": 2312.004, "load_throughput": 6763.828, "learn_time_ms": 23338.506, "learn_throughput": 670.051, "synch_weights_time_ms": 445.798}, "counters": {"num_env_steps_sampled": 1610984, "num_env_steps_trained": 1610984, "num_agent_steps_sampled": 1610984, "num_agent_steps_trained": 1610984}, "done": false, "episodes_total": 1556, "training_iteration": 111, "trial_id": "837cb_00000", "date": "2025-06-07_19-28-05", "timestamp": 1749317285, "time_this_iter_s": 68.17142510414124, "time_total_s": 7335.022016525269, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7335.022016525269, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 63.98101265822786, "ram_util_percent": 88.85443037974684, "gpu_util_percent0": 0.21658227848101266, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.389016e-05, "total_loss": -0.06794331938705661, "policy_loss": -0.006431032250296663, "vf_loss": 0.013774630513296209, "vf_explained_var": 0.9577921395952051, "kl": 0.019321139246537562, "entropy": 16.371214703646572, "entropy_coeff": 0.004083523999999999}, "model": {}, "num_grad_updates_lifetime": 56965.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1626622, "num_env_steps_trained": 1626622, "num_agent_steps_sampled": 1626622, "num_agent_steps_trained": 1626622}, "sampler_results": {"episode_reward_max": 65.35734949714941, "episode_reward_min": 40.56795475606187, "episode_reward_mean": 55.677674567541146, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.46553525864529, 60.51138857226137, 51.88886372247858, 57.23588931197882, 43.73410315102119, 56.40341372475534, 59.98200509736899, 59.28892856194759, 62.656171343311684, 56.56125935471727, 55.399559495842254, 58.57343334584526, 54.68741697862107, 43.3032885833533, 60.09030850675731, 58.74643444696246, 55.86956745099126, 55.975781117393566, 48.159108382251596, 55.12985469950743, 65.35734949714941, 55.23131495313532, 64.10623782849896, 61.94498674724007, 58.86375936095143, 52.80861917541321, 56.16771327603757, 43.669679010464066, 60.36745234286294, 62.30202595229052, 57.948765545078665, 57.934496583967466, 47.70330920670414, 61.55126024839962, 62.4033089931704, 58.77094956741026, 61.496536128525506, 60.165189472622785, 59.49839621465051, 55.29043483179642, 60.072124833408225, 40.56795475606187, 56.49786945769988, 57.10839471909288, 52.3344070249577, 54.857164324998976, 42.7551580384037, 57.55355346493166, 60.29342046236444, 57.30268529542781, 62.16546633985844, 55.07268949273754, 59.68150388899383, 55.33628418335664, 54.274487986917315, 45.69569500453437, 60.76491994159666, 61.23046494500051, 55.16650211942004, 56.11757097521659, 45.24253368042953, 53.04518489722059, 59.56194038312566, 49.30409822065419, 60.598740056368044, 51.13531018513746, 62.10794129470669, 54.87255769955197, 56.18952925825033, 43.07356074363809, 56.24091675506101, 63.24677747246867, 53.049860719775054, 55.462377921768415, 42.66209536967038, 59.6696538716943, 62.2271956996741, 54.70396318274202, 57.54018542249721, 55.33153596087589, 55.64340357217322, 54.08513079861441, 56.463883556911966, 43.60069754520055, 61.13943715027659, 54.201627449166224, 53.36208951336481, 54.08069083991319, 46.05675384568714, 57.04040952187684, 60.763930130123725, 52.2429070305744, 56.57130778367714, 58.17445718565377, 58.77380515335565, 56.448422715009116, 57.01382899659708, 43.40796735766506, 56.63404171746844, 54.70429279813474], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7855894640880035, "mean_inference_ms": 8.011113329920901, "mean_action_processing_ms": 0.5664483198919072, "mean_env_wait_ms": 24.24274464096982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045920610427856445, "StateBufferConnector_ms": 0.04062485694885254, "ViewRequirementAgentConnector_ms": 0.9907553195953369}}, "episode_reward_max": 65.35734949714941, "episode_reward_min": 40.56795475606187, "episode_reward_mean": 55.677674567541146, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.46553525864529, 60.51138857226137, 51.88886372247858, 57.23588931197882, 43.73410315102119, 56.40341372475534, 59.98200509736899, 59.28892856194759, 62.656171343311684, 56.56125935471727, 55.399559495842254, 58.57343334584526, 54.68741697862107, 43.3032885833533, 60.09030850675731, 58.74643444696246, 55.86956745099126, 55.975781117393566, 48.159108382251596, 55.12985469950743, 65.35734949714941, 55.23131495313532, 64.10623782849896, 61.94498674724007, 58.86375936095143, 52.80861917541321, 56.16771327603757, 43.669679010464066, 60.36745234286294, 62.30202595229052, 57.948765545078665, 57.934496583967466, 47.70330920670414, 61.55126024839962, 62.4033089931704, 58.77094956741026, 61.496536128525506, 60.165189472622785, 59.49839621465051, 55.29043483179642, 60.072124833408225, 40.56795475606187, 56.49786945769988, 57.10839471909288, 52.3344070249577, 54.857164324998976, 42.7551580384037, 57.55355346493166, 60.29342046236444, 57.30268529542781, 62.16546633985844, 55.07268949273754, 59.68150388899383, 55.33628418335664, 54.274487986917315, 45.69569500453437, 60.76491994159666, 61.23046494500051, 55.16650211942004, 56.11757097521659, 45.24253368042953, 53.04518489722059, 59.56194038312566, 49.30409822065419, 60.598740056368044, 51.13531018513746, 62.10794129470669, 54.87255769955197, 56.18952925825033, 43.07356074363809, 56.24091675506101, 63.24677747246867, 53.049860719775054, 55.462377921768415, 42.66209536967038, 59.6696538716943, 62.2271956996741, 54.70396318274202, 57.54018542249721, 55.33153596087589, 55.64340357217322, 54.08513079861441, 56.463883556911966, 43.60069754520055, 61.13943715027659, 54.201627449166224, 53.36208951336481, 54.08069083991319, 46.05675384568714, 57.04040952187684, 60.763930130123725, 52.2429070305744, 56.57130778367714, 58.17445718565377, 58.77380515335565, 56.448422715009116, 57.01382899659708, 43.40796735766506, 56.63404171746844, 54.70429279813474], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7855894640880035, "mean_inference_ms": 8.011113329920901, "mean_action_processing_ms": 0.5664483198919072, "mean_env_wait_ms": 24.24274464096982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045920610427856445, "StateBufferConnector_ms": 0.04062485694885254, "ViewRequirementAgentConnector_ms": 0.9907553195953369}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1626622, "num_agent_steps_trained": 1626622, "num_env_steps_sampled": 1626622, "num_env_steps_trained": 1626622, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 230.69197090507635, "num_env_steps_trained_throughput_per_sec": 230.69197090507635, "timesteps_total": 1626622, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1626622, "timers": {"training_iteration_time_ms": 68263.274, "sample_time_ms": 42057.284, "load_time_ms": 2317.53, "load_throughput": 6747.702, "learn_time_ms": 23326.326, "learn_throughput": 670.401, "synch_weights_time_ms": 448.17}, "counters": {"num_env_steps_sampled": 1626622, "num_env_steps_trained": 1626622, "num_agent_steps_sampled": 1626622, "num_agent_steps_trained": 1626622}, "done": false, "episodes_total": 1570, "training_iteration": 112, "trial_id": "837cb_00000", "date": "2025-06-07_19-29-13", "timestamp": 1749317353, "time_this_iter_s": 67.80836248397827, "time_total_s": 7402.830379009247, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7402.830379009247, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 65.0974358974359, "ram_util_percent": 89.17051282051278, "gpu_util_percent0": 0.2137179487179487, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.373378000000002e-05, "total_loss": -0.06714008099082011, "policy_loss": -0.006012333232951774, "vf_loss": 0.013804031318392265, "vf_explained_var": 0.9578349552371285, "kl": 0.020105473850645487, "entropy": 16.385333515514027, "entropy_coeff": 0.0040600670000000005}, "model": {}, "num_grad_updates_lifetime": 57515.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1642260, "num_env_steps_trained": 1642260, "num_agent_steps_sampled": 1642260, "num_agent_steps_trained": 1642260}, "sampler_results": {"episode_reward_max": 65.35734949714941, "episode_reward_min": 40.56795475606187, "episode_reward_mean": 55.4535796534327, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.09030850675731, 58.74643444696246, 55.86956745099126, 55.975781117393566, 48.159108382251596, 55.12985469950743, 65.35734949714941, 55.23131495313532, 64.10623782849896, 61.94498674724007, 58.86375936095143, 52.80861917541321, 56.16771327603757, 43.669679010464066, 60.36745234286294, 62.30202595229052, 57.948765545078665, 57.934496583967466, 47.70330920670414, 61.55126024839962, 62.4033089931704, 58.77094956741026, 61.496536128525506, 60.165189472622785, 59.49839621465051, 55.29043483179642, 60.072124833408225, 40.56795475606187, 56.49786945769988, 57.10839471909288, 52.3344070249577, 54.857164324998976, 42.7551580384037, 57.55355346493166, 60.29342046236444, 57.30268529542781, 62.16546633985844, 55.07268949273754, 59.68150388899383, 55.33628418335664, 54.274487986917315, 45.69569500453437, 60.76491994159666, 61.23046494500051, 55.16650211942004, 56.11757097521659, 45.24253368042953, 53.04518489722059, 59.56194038312566, 49.30409822065419, 60.598740056368044, 51.13531018513746, 62.10794129470669, 54.87255769955197, 56.18952925825033, 43.07356074363809, 56.24091675506101, 63.24677747246867, 53.049860719775054, 55.462377921768415, 42.66209536967038, 59.6696538716943, 62.2271956996741, 54.70396318274202, 57.54018542249721, 55.33153596087589, 55.64340357217322, 54.08513079861441, 56.463883556911966, 43.60069754520055, 61.13943715027659, 54.201627449166224, 53.36208951336481, 54.08069083991319, 46.05675384568714, 57.04040952187684, 60.763930130123725, 52.2429070305744, 56.57130778367714, 58.17445718565377, 58.77380515335565, 56.448422715009116, 57.01382899659708, 43.40796735766506, 56.63404171746844, 54.70429279813474, 54.69716356054045, 55.372463575060785, 41.85645600226434, 55.90323746903268, 57.68108772795858, 49.54221880714005, 60.66530494747018, 54.0681101706089, 56.686637316863994, 56.78201448097549, 53.6644133185855, 45.55015751362392, 56.70154515304006, 58.1109550481386], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.784794454575356, "mean_inference_ms": 8.009224170361001, "mean_action_processing_ms": 0.566190760920952, "mean_env_wait_ms": 24.243282177356917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04445338249206543, "StateBufferConnector_ms": 0.04224753379821777, "ViewRequirementAgentConnector_ms": 1.0063323974609375}}, "episode_reward_max": 65.35734949714941, "episode_reward_min": 40.56795475606187, "episode_reward_mean": 55.4535796534327, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.09030850675731, 58.74643444696246, 55.86956745099126, 55.975781117393566, 48.159108382251596, 55.12985469950743, 65.35734949714941, 55.23131495313532, 64.10623782849896, 61.94498674724007, 58.86375936095143, 52.80861917541321, 56.16771327603757, 43.669679010464066, 60.36745234286294, 62.30202595229052, 57.948765545078665, 57.934496583967466, 47.70330920670414, 61.55126024839962, 62.4033089931704, 58.77094956741026, 61.496536128525506, 60.165189472622785, 59.49839621465051, 55.29043483179642, 60.072124833408225, 40.56795475606187, 56.49786945769988, 57.10839471909288, 52.3344070249577, 54.857164324998976, 42.7551580384037, 57.55355346493166, 60.29342046236444, 57.30268529542781, 62.16546633985844, 55.07268949273754, 59.68150388899383, 55.33628418335664, 54.274487986917315, 45.69569500453437, 60.76491994159666, 61.23046494500051, 55.16650211942004, 56.11757097521659, 45.24253368042953, 53.04518489722059, 59.56194038312566, 49.30409822065419, 60.598740056368044, 51.13531018513746, 62.10794129470669, 54.87255769955197, 56.18952925825033, 43.07356074363809, 56.24091675506101, 63.24677747246867, 53.049860719775054, 55.462377921768415, 42.66209536967038, 59.6696538716943, 62.2271956996741, 54.70396318274202, 57.54018542249721, 55.33153596087589, 55.64340357217322, 54.08513079861441, 56.463883556911966, 43.60069754520055, 61.13943715027659, 54.201627449166224, 53.36208951336481, 54.08069083991319, 46.05675384568714, 57.04040952187684, 60.763930130123725, 52.2429070305744, 56.57130778367714, 58.17445718565377, 58.77380515335565, 56.448422715009116, 57.01382899659708, 43.40796735766506, 56.63404171746844, 54.70429279813474, 54.69716356054045, 55.372463575060785, 41.85645600226434, 55.90323746903268, 57.68108772795858, 49.54221880714005, 60.66530494747018, 54.0681101706089, 56.686637316863994, 56.78201448097549, 53.6644133185855, 45.55015751362392, 56.70154515304006, 58.1109550481386], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.784794454575356, "mean_inference_ms": 8.009224170361001, "mean_action_processing_ms": 0.566190760920952, "mean_env_wait_ms": 24.243282177356917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04445338249206543, "StateBufferConnector_ms": 0.04224753379821777, "ViewRequirementAgentConnector_ms": 1.0063323974609375}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1642260, "num_agent_steps_trained": 1642260, "num_env_steps_sampled": 1642260, "num_env_steps_trained": 1642260, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 231.92641436629586, "num_env_steps_trained_throughput_per_sec": 231.92641436629586, "timesteps_total": 1642260, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1642260, "timers": {"training_iteration_time_ms": 68174.014, "sample_time_ms": 41980.89, "load_time_ms": 2314.295, "load_throughput": 6757.135, "learn_time_ms": 23318.098, "learn_throughput": 670.638, "synch_weights_time_ms": 446.845}, "counters": {"num_env_steps_sampled": 1642260, "num_env_steps_trained": 1642260, "num_agent_steps_sampled": 1642260, "num_agent_steps_trained": 1642260}, "done": false, "episodes_total": 1584, "training_iteration": 113, "trial_id": "837cb_00000", "date": "2025-06-07_19-30-21", "timestamp": 1749317421, "time_this_iter_s": 67.47999000549316, "time_total_s": 7470.31036901474, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7470.31036901474, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 63.93076923076922, "ram_util_percent": 88.91025641025642, "gpu_util_percent0": 0.22230769230769232, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.357739999999999e-05, "total_loss": -0.07000401954018426, "policy_loss": -0.009247046159818473, "vf_loss": 0.015146179564551197, "vf_explained_var": 0.9566086800531908, "kl": 0.019961011878997306, "entropy": 16.48620718522505, "entropy_coeff": 0.004036610000000001}, "model": {}, "num_grad_updates_lifetime": 58065.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1657898, "num_env_steps_trained": 1657898, "num_agent_steps_sampled": 1657898, "num_agent_steps_trained": 1657898}, "sampler_results": {"episode_reward_max": 63.24677747246867, "episode_reward_min": 40.56795475606187, "episode_reward_mean": 55.06423628844399, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.36745234286294, 62.30202595229052, 57.948765545078665, 57.934496583967466, 47.70330920670414, 61.55126024839962, 62.4033089931704, 58.77094956741026, 61.496536128525506, 60.165189472622785, 59.49839621465051, 55.29043483179642, 60.072124833408225, 40.56795475606187, 56.49786945769988, 57.10839471909288, 52.3344070249577, 54.857164324998976, 42.7551580384037, 57.55355346493166, 60.29342046236444, 57.30268529542781, 62.16546633985844, 55.07268949273754, 59.68150388899383, 55.33628418335664, 54.274487986917315, 45.69569500453437, 60.76491994159666, 61.23046494500051, 55.16650211942004, 56.11757097521659, 45.24253368042953, 53.04518489722059, 59.56194038312566, 49.30409822065419, 60.598740056368044, 51.13531018513746, 62.10794129470669, 54.87255769955197, 56.18952925825033, 43.07356074363809, 56.24091675506101, 63.24677747246867, 53.049860719775054, 55.462377921768415, 42.66209536967038, 59.6696538716943, 62.2271956996741, 54.70396318274202, 57.54018542249721, 55.33153596087589, 55.64340357217322, 54.08513079861441, 56.463883556911966, 43.60069754520055, 61.13943715027659, 54.201627449166224, 53.36208951336481, 54.08069083991319, 46.05675384568714, 57.04040952187684, 60.763930130123725, 52.2429070305744, 56.57130778367714, 58.17445718565377, 58.77380515335565, 56.448422715009116, 57.01382899659708, 43.40796735766506, 56.63404171746844, 54.70429279813474, 54.69716356054045, 55.372463575060785, 41.85645600226434, 55.90323746903268, 57.68108772795858, 49.54221880714005, 60.66530494747018, 54.0681101706089, 56.686637316863994, 56.78201448097549, 53.6644133185855, 45.55015751362392, 56.70154515304006, 58.1109550481386, 54.28989501404268, 57.52498545455095, 44.63529829478965, 56.294330541884015, 59.61949853889347, 53.228778856604336, 60.01226677554812, 56.927995243401746, 50.29249969309888, 49.61875805187943, 54.57543048828277, 41.503442228674615, 55.9687370418183, 58.69446173041452], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7838172072894998, "mean_inference_ms": 8.007346486431612, "mean_action_processing_ms": 0.5659304687770058, "mean_env_wait_ms": 24.24413870320916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04341387748718262, "StateBufferConnector_ms": 0.04116535186767578, "ViewRequirementAgentConnector_ms": 0.9647767543792725}}, "episode_reward_max": 63.24677747246867, "episode_reward_min": 40.56795475606187, "episode_reward_mean": 55.06423628844399, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.36745234286294, 62.30202595229052, 57.948765545078665, 57.934496583967466, 47.70330920670414, 61.55126024839962, 62.4033089931704, 58.77094956741026, 61.496536128525506, 60.165189472622785, 59.49839621465051, 55.29043483179642, 60.072124833408225, 40.56795475606187, 56.49786945769988, 57.10839471909288, 52.3344070249577, 54.857164324998976, 42.7551580384037, 57.55355346493166, 60.29342046236444, 57.30268529542781, 62.16546633985844, 55.07268949273754, 59.68150388899383, 55.33628418335664, 54.274487986917315, 45.69569500453437, 60.76491994159666, 61.23046494500051, 55.16650211942004, 56.11757097521659, 45.24253368042953, 53.04518489722059, 59.56194038312566, 49.30409822065419, 60.598740056368044, 51.13531018513746, 62.10794129470669, 54.87255769955197, 56.18952925825033, 43.07356074363809, 56.24091675506101, 63.24677747246867, 53.049860719775054, 55.462377921768415, 42.66209536967038, 59.6696538716943, 62.2271956996741, 54.70396318274202, 57.54018542249721, 55.33153596087589, 55.64340357217322, 54.08513079861441, 56.463883556911966, 43.60069754520055, 61.13943715027659, 54.201627449166224, 53.36208951336481, 54.08069083991319, 46.05675384568714, 57.04040952187684, 60.763930130123725, 52.2429070305744, 56.57130778367714, 58.17445718565377, 58.77380515335565, 56.448422715009116, 57.01382899659708, 43.40796735766506, 56.63404171746844, 54.70429279813474, 54.69716356054045, 55.372463575060785, 41.85645600226434, 55.90323746903268, 57.68108772795858, 49.54221880714005, 60.66530494747018, 54.0681101706089, 56.686637316863994, 56.78201448097549, 53.6644133185855, 45.55015751362392, 56.70154515304006, 58.1109550481386, 54.28989501404268, 57.52498545455095, 44.63529829478965, 56.294330541884015, 59.61949853889347, 53.228778856604336, 60.01226677554812, 56.927995243401746, 50.29249969309888, 49.61875805187943, 54.57543048828277, 41.503442228674615, 55.9687370418183, 58.69446173041452], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7838172072894998, "mean_inference_ms": 8.007346486431612, "mean_action_processing_ms": 0.5659304687770058, "mean_env_wait_ms": 24.24413870320916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04341387748718262, "StateBufferConnector_ms": 0.04116535186767578, "ViewRequirementAgentConnector_ms": 0.9647767543792725}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1657898, "num_agent_steps_trained": 1657898, "num_env_steps_sampled": 1657898, "num_env_steps_trained": 1657898, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.38144350713088, "num_env_steps_trained_throughput_per_sec": 228.38144350713088, "timesteps_total": 1657898, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1657898, "timers": {"training_iteration_time_ms": 68174.941, "sample_time_ms": 41988.871, "load_time_ms": 2301.786, "load_throughput": 6793.856, "learn_time_ms": 23320.656, "learn_throughput": 670.564, "synch_weights_time_ms": 448.982}, "counters": {"num_env_steps_sampled": 1657898, "num_env_steps_trained": 1657898, "num_agent_steps_sampled": 1657898, "num_agent_steps_trained": 1657898}, "done": false, "episodes_total": 1598, "training_iteration": 114, "trial_id": "837cb_00000", "date": "2025-06-07_19-31-29", "timestamp": 1749317489, "time_this_iter_s": 68.49015092849731, "time_total_s": 7538.800519943237, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7538.800519943237, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 64.4909090909091, "ram_util_percent": 88.6896103896104, "gpu_util_percent0": 0.21961038961038964, "vram_util_percent0": 0.965006510416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.342102e-05, "total_loss": -0.06849507214289836, "policy_loss": -0.00813086225217293, "vf_loss": 0.014247473944825204, "vf_explained_var": 0.953193328814073, "kl": 0.019764819387985254, "entropy": 16.41446407318115, "entropy_coeff": 0.004013152999999999}, "model": {}, "num_grad_updates_lifetime": 58615.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1673536, "num_env_steps_trained": 1673536, "num_agent_steps_sampled": 1673536, "num_agent_steps_trained": 1673536}, "sampler_results": {"episode_reward_max": 63.24677747246867, "episode_reward_min": 41.503442228674615, "episode_reward_mean": 54.524180367923265, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.49786945769988, 57.10839471909288, 52.3344070249577, 54.857164324998976, 42.7551580384037, 57.55355346493166, 60.29342046236444, 57.30268529542781, 62.16546633985844, 55.07268949273754, 59.68150388899383, 55.33628418335664, 54.274487986917315, 45.69569500453437, 60.76491994159666, 61.23046494500051, 55.16650211942004, 56.11757097521659, 45.24253368042953, 53.04518489722059, 59.56194038312566, 49.30409822065419, 60.598740056368044, 51.13531018513746, 62.10794129470669, 54.87255769955197, 56.18952925825033, 43.07356074363809, 56.24091675506101, 63.24677747246867, 53.049860719775054, 55.462377921768415, 42.66209536967038, 59.6696538716943, 62.2271956996741, 54.70396318274202, 57.54018542249721, 55.33153596087589, 55.64340357217322, 54.08513079861441, 56.463883556911966, 43.60069754520055, 61.13943715027659, 54.201627449166224, 53.36208951336481, 54.08069083991319, 46.05675384568714, 57.04040952187684, 60.763930130123725, 52.2429070305744, 56.57130778367714, 58.17445718565377, 58.77380515335565, 56.448422715009116, 57.01382899659708, 43.40796735766506, 56.63404171746844, 54.70429279813474, 54.69716356054045, 55.372463575060785, 41.85645600226434, 55.90323746903268, 57.68108772795858, 49.54221880714005, 60.66530494747018, 54.0681101706089, 56.686637316863994, 56.78201448097549, 53.6644133185855, 45.55015751362392, 56.70154515304006, 58.1109550481386, 54.28989501404268, 57.52498545455095, 44.63529829478965, 56.294330541884015, 59.61949853889347, 53.228778856604336, 60.01226677554812, 56.927995243401746, 50.29249969309888, 49.61875805187943, 54.57543048828277, 41.503442228674615, 55.9687370418183, 58.69446173041452, 48.29378642296347, 57.23920187086706, 46.08332069125427, 56.842325464721, 56.90315655634023, 47.26299649973436, 55.567741770351766, 55.59367891121521, 56.896693559390215, 53.064465341182206, 58.135824714038435, 42.86968855915255, 57.4547443054207, 59.858987958245265], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7832749775931767, "mean_inference_ms": 8.005330900487957, "mean_action_processing_ms": 0.5656756469120924, "mean_env_wait_ms": 24.24429574149859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0423731803894043, "StateBufferConnector_ms": 0.03920745849609375, "ViewRequirementAgentConnector_ms": 0.9646773338317871}}, "episode_reward_max": 63.24677747246867, "episode_reward_min": 41.503442228674615, "episode_reward_mean": 54.524180367923265, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [56.49786945769988, 57.10839471909288, 52.3344070249577, 54.857164324998976, 42.7551580384037, 57.55355346493166, 60.29342046236444, 57.30268529542781, 62.16546633985844, 55.07268949273754, 59.68150388899383, 55.33628418335664, 54.274487986917315, 45.69569500453437, 60.76491994159666, 61.23046494500051, 55.16650211942004, 56.11757097521659, 45.24253368042953, 53.04518489722059, 59.56194038312566, 49.30409822065419, 60.598740056368044, 51.13531018513746, 62.10794129470669, 54.87255769955197, 56.18952925825033, 43.07356074363809, 56.24091675506101, 63.24677747246867, 53.049860719775054, 55.462377921768415, 42.66209536967038, 59.6696538716943, 62.2271956996741, 54.70396318274202, 57.54018542249721, 55.33153596087589, 55.64340357217322, 54.08513079861441, 56.463883556911966, 43.60069754520055, 61.13943715027659, 54.201627449166224, 53.36208951336481, 54.08069083991319, 46.05675384568714, 57.04040952187684, 60.763930130123725, 52.2429070305744, 56.57130778367714, 58.17445718565377, 58.77380515335565, 56.448422715009116, 57.01382899659708, 43.40796735766506, 56.63404171746844, 54.70429279813474, 54.69716356054045, 55.372463575060785, 41.85645600226434, 55.90323746903268, 57.68108772795858, 49.54221880714005, 60.66530494747018, 54.0681101706089, 56.686637316863994, 56.78201448097549, 53.6644133185855, 45.55015751362392, 56.70154515304006, 58.1109550481386, 54.28989501404268, 57.52498545455095, 44.63529829478965, 56.294330541884015, 59.61949853889347, 53.228778856604336, 60.01226677554812, 56.927995243401746, 50.29249969309888, 49.61875805187943, 54.57543048828277, 41.503442228674615, 55.9687370418183, 58.69446173041452, 48.29378642296347, 57.23920187086706, 46.08332069125427, 56.842325464721, 56.90315655634023, 47.26299649973436, 55.567741770351766, 55.59367891121521, 56.896693559390215, 53.064465341182206, 58.135824714038435, 42.86968855915255, 57.4547443054207, 59.858987958245265], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7832749775931767, "mean_inference_ms": 8.005330900487957, "mean_action_processing_ms": 0.5656756469120924, "mean_env_wait_ms": 24.24429574149859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0423731803894043, "StateBufferConnector_ms": 0.03920745849609375, "ViewRequirementAgentConnector_ms": 0.9646773338317871}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1673536, "num_agent_steps_trained": 1673536, "num_env_steps_sampled": 1673536, "num_env_steps_trained": 1673536, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.70108158959718, "num_env_steps_trained_throughput_per_sec": 229.70108158959718, "timesteps_total": 1673536, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1673536, "timers": {"training_iteration_time_ms": 68118.007, "sample_time_ms": 41981.237, "load_time_ms": 2300.301, "load_throughput": 6798.241, "learn_time_ms": 23269.345, "learn_throughput": 672.043, "synch_weights_time_ms": 451.621}, "counters": {"num_env_steps_sampled": 1673536, "num_env_steps_trained": 1673536, "num_agent_steps_sampled": 1673536, "num_agent_steps_trained": 1673536}, "done": false, "episodes_total": 1612, "training_iteration": 115, "trial_id": "837cb_00000", "date": "2025-06-07_19-32-38", "timestamp": 1749317558, "time_this_iter_s": 68.0883252620697, "time_total_s": 7606.888845205307, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7606.888845205307, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 64.99999999999999, "ram_util_percent": 89.12435897435896, "gpu_util_percent0": 0.2151282051282051, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.326464000000003e-05, "total_loss": -0.06791193934051659, "policy_loss": -0.007669982242990624, "vf_loss": 0.012917255755852569, "vf_explained_var": 0.9573419873280958, "kl": 0.020177385488138747, "entropy": 16.386766421578148, "entropy_coeff": 0.003989695999999999}, "model": {}, "num_grad_updates_lifetime": 59165.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1689174, "num_env_steps_trained": 1689174, "num_agent_steps_sampled": 1689174, "num_agent_steps_trained": 1689174}, "sampler_results": {"episode_reward_max": 63.24677747246867, "episode_reward_min": 41.503442228674615, "episode_reward_mean": 54.56268339314957, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.76491994159666, 61.23046494500051, 55.16650211942004, 56.11757097521659, 45.24253368042953, 53.04518489722059, 59.56194038312566, 49.30409822065419, 60.598740056368044, 51.13531018513746, 62.10794129470669, 54.87255769955197, 56.18952925825033, 43.07356074363809, 56.24091675506101, 63.24677747246867, 53.049860719775054, 55.462377921768415, 42.66209536967038, 59.6696538716943, 62.2271956996741, 54.70396318274202, 57.54018542249721, 55.33153596087589, 55.64340357217322, 54.08513079861441, 56.463883556911966, 43.60069754520055, 61.13943715027659, 54.201627449166224, 53.36208951336481, 54.08069083991319, 46.05675384568714, 57.04040952187684, 60.763930130123725, 52.2429070305744, 56.57130778367714, 58.17445718565377, 58.77380515335565, 56.448422715009116, 57.01382899659708, 43.40796735766506, 56.63404171746844, 54.70429279813474, 54.69716356054045, 55.372463575060785, 41.85645600226434, 55.90323746903268, 57.68108772795858, 49.54221880714005, 60.66530494747018, 54.0681101706089, 56.686637316863994, 56.78201448097549, 53.6644133185855, 45.55015751362392, 56.70154515304006, 58.1109550481386, 54.28989501404268, 57.52498545455095, 44.63529829478965, 56.294330541884015, 59.61949853889347, 53.228778856604336, 60.01226677554812, 56.927995243401746, 50.29249969309888, 49.61875805187943, 54.57543048828277, 41.503442228674615, 55.9687370418183, 58.69446173041452, 48.29378642296347, 57.23920187086706, 46.08332069125427, 56.842325464721, 56.90315655634023, 47.26299649973436, 55.567741770351766, 55.59367891121521, 56.896693559390215, 53.064465341182206, 58.135824714038435, 42.86968855915255, 57.4547443054207, 59.858987958245265, 53.31314394152444, 56.95387946478296, 45.917901705578196, 56.026592879564475, 62.31596450675926, 51.194792369760115, 62.99508914429931, 56.031011619918765, 58.04675305918589, 57.66099351524737, 56.74992693900878, 42.4288869019047, 55.46742877117554, 59.67671738819579], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7826439562973975, "mean_inference_ms": 8.003511313038342, "mean_action_processing_ms": 0.5654199481006674, "mean_env_wait_ms": 24.244580137152326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04231142997741699, "StateBufferConnector_ms": 0.04727506637573242, "ViewRequirementAgentConnector_ms": 0.9823641777038574}}, "episode_reward_max": 63.24677747246867, "episode_reward_min": 41.503442228674615, "episode_reward_mean": 54.56268339314957, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [60.76491994159666, 61.23046494500051, 55.16650211942004, 56.11757097521659, 45.24253368042953, 53.04518489722059, 59.56194038312566, 49.30409822065419, 60.598740056368044, 51.13531018513746, 62.10794129470669, 54.87255769955197, 56.18952925825033, 43.07356074363809, 56.24091675506101, 63.24677747246867, 53.049860719775054, 55.462377921768415, 42.66209536967038, 59.6696538716943, 62.2271956996741, 54.70396318274202, 57.54018542249721, 55.33153596087589, 55.64340357217322, 54.08513079861441, 56.463883556911966, 43.60069754520055, 61.13943715027659, 54.201627449166224, 53.36208951336481, 54.08069083991319, 46.05675384568714, 57.04040952187684, 60.763930130123725, 52.2429070305744, 56.57130778367714, 58.17445718565377, 58.77380515335565, 56.448422715009116, 57.01382899659708, 43.40796735766506, 56.63404171746844, 54.70429279813474, 54.69716356054045, 55.372463575060785, 41.85645600226434, 55.90323746903268, 57.68108772795858, 49.54221880714005, 60.66530494747018, 54.0681101706089, 56.686637316863994, 56.78201448097549, 53.6644133185855, 45.55015751362392, 56.70154515304006, 58.1109550481386, 54.28989501404268, 57.52498545455095, 44.63529829478965, 56.294330541884015, 59.61949853889347, 53.228778856604336, 60.01226677554812, 56.927995243401746, 50.29249969309888, 49.61875805187943, 54.57543048828277, 41.503442228674615, 55.9687370418183, 58.69446173041452, 48.29378642296347, 57.23920187086706, 46.08332069125427, 56.842325464721, 56.90315655634023, 47.26299649973436, 55.567741770351766, 55.59367891121521, 56.896693559390215, 53.064465341182206, 58.135824714038435, 42.86968855915255, 57.4547443054207, 59.858987958245265, 53.31314394152444, 56.95387946478296, 45.917901705578196, 56.026592879564475, 62.31596450675926, 51.194792369760115, 62.99508914429931, 56.031011619918765, 58.04675305918589, 57.66099351524737, 56.74992693900878, 42.4288869019047, 55.46742877117554, 59.67671738819579], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7826439562973975, "mean_inference_ms": 8.003511313038342, "mean_action_processing_ms": 0.5654199481006674, "mean_env_wait_ms": 24.244580137152326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04231142997741699, "StateBufferConnector_ms": 0.04727506637573242, "ViewRequirementAgentConnector_ms": 0.9823641777038574}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1689174, "num_agent_steps_trained": 1689174, "num_env_steps_sampled": 1689174, "num_env_steps_trained": 1689174, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.78789322356872, "num_env_steps_trained_throughput_per_sec": 229.78789322356872, "timesteps_total": 1689174, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1689174, "timers": {"training_iteration_time_ms": 68039.489, "sample_time_ms": 41999.529, "load_time_ms": 2206.18, "load_throughput": 7088.27, "learn_time_ms": 23269.74, "learn_throughput": 672.032, "synch_weights_time_ms": 448.657}, "counters": {"num_env_steps_sampled": 1689174, "num_env_steps_trained": 1689174, "num_agent_steps_sampled": 1689174, "num_agent_steps_trained": 1689174}, "done": false, "episodes_total": 1626, "training_iteration": 116, "trial_id": "837cb_00000", "date": "2025-06-07_19-33-46", "timestamp": 1749317626, "time_this_iter_s": 68.07005333900452, "time_total_s": 7674.9588985443115, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7674.9588985443115, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 64.72435897435898, "ram_util_percent": 89.10512820512822, "gpu_util_percent0": 0.21243589743589744, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.310826e-05, "total_loss": -0.07866667656037449, "policy_loss": -0.01875701157714833, "vf_loss": 0.013500774330036207, "vf_explained_var": 0.9635657308318398, "kl": 0.019381652952556748, "entropy": 16.431499340750953, "entropy_coeff": 0.003966239}, "model": {}, "num_grad_updates_lifetime": 59715.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1704812, "num_env_steps_trained": 1704812, "num_agent_steps_sampled": 1704812, "num_agent_steps_trained": 1704812}, "sampler_results": {"episode_reward_max": 63.24677747246867, "episode_reward_min": 40.549410384568205, "episode_reward_mean": 54.402452137119305, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.24091675506101, 63.24677747246867, 53.049860719775054, 55.462377921768415, 42.66209536967038, 59.6696538716943, 62.2271956996741, 54.70396318274202, 57.54018542249721, 55.33153596087589, 55.64340357217322, 54.08513079861441, 56.463883556911966, 43.60069754520055, 61.13943715027659, 54.201627449166224, 53.36208951336481, 54.08069083991319, 46.05675384568714, 57.04040952187684, 60.763930130123725, 52.2429070305744, 56.57130778367714, 58.17445718565377, 58.77380515335565, 56.448422715009116, 57.01382899659708, 43.40796735766506, 56.63404171746844, 54.70429279813474, 54.69716356054045, 55.372463575060785, 41.85645600226434, 55.90323746903268, 57.68108772795858, 49.54221880714005, 60.66530494747018, 54.0681101706089, 56.686637316863994, 56.78201448097549, 53.6644133185855, 45.55015751362392, 56.70154515304006, 58.1109550481386, 54.28989501404268, 57.52498545455095, 44.63529829478965, 56.294330541884015, 59.61949853889347, 53.228778856604336, 60.01226677554812, 56.927995243401746, 50.29249969309888, 49.61875805187943, 54.57543048828277, 41.503442228674615, 55.9687370418183, 58.69446173041452, 48.29378642296347, 57.23920187086706, 46.08332069125427, 56.842325464721, 56.90315655634023, 47.26299649973436, 55.567741770351766, 55.59367891121521, 56.896693559390215, 53.064465341182206, 58.135824714038435, 42.86968855915255, 57.4547443054207, 59.858987958245265, 53.31314394152444, 56.95387946478296, 45.917901705578196, 56.026592879564475, 62.31596450675926, 51.194792369760115, 62.99508914429931, 56.031011619918765, 58.04675305918589, 57.66099351524737, 56.74992693900878, 42.4288869019047, 55.46742877117554, 59.67671738819579, 55.751178589324766, 52.84973925643014, 40.549410384568205, 50.89014784191149, 58.26865367052789, 51.94041338821423, 61.93843664198381, 55.87052115872122, 59.5601826471316, 56.71173481115036, 55.292560627812776, 40.90310920268154, 57.18013237905207, 54.681508197778975], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7819051846894722, "mean_inference_ms": 8.00201744598578, "mean_action_processing_ms": 0.5652034878392158, "mean_env_wait_ms": 24.245523150025956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03832674026489258, "StateBufferConnector_ms": 0.044373273849487305, "ViewRequirementAgentConnector_ms": 1.0524258613586426}}, "episode_reward_max": 63.24677747246867, "episode_reward_min": 40.549410384568205, "episode_reward_mean": 54.402452137119305, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [56.24091675506101, 63.24677747246867, 53.049860719775054, 55.462377921768415, 42.66209536967038, 59.6696538716943, 62.2271956996741, 54.70396318274202, 57.54018542249721, 55.33153596087589, 55.64340357217322, 54.08513079861441, 56.463883556911966, 43.60069754520055, 61.13943715027659, 54.201627449166224, 53.36208951336481, 54.08069083991319, 46.05675384568714, 57.04040952187684, 60.763930130123725, 52.2429070305744, 56.57130778367714, 58.17445718565377, 58.77380515335565, 56.448422715009116, 57.01382899659708, 43.40796735766506, 56.63404171746844, 54.70429279813474, 54.69716356054045, 55.372463575060785, 41.85645600226434, 55.90323746903268, 57.68108772795858, 49.54221880714005, 60.66530494747018, 54.0681101706089, 56.686637316863994, 56.78201448097549, 53.6644133185855, 45.55015751362392, 56.70154515304006, 58.1109550481386, 54.28989501404268, 57.52498545455095, 44.63529829478965, 56.294330541884015, 59.61949853889347, 53.228778856604336, 60.01226677554812, 56.927995243401746, 50.29249969309888, 49.61875805187943, 54.57543048828277, 41.503442228674615, 55.9687370418183, 58.69446173041452, 48.29378642296347, 57.23920187086706, 46.08332069125427, 56.842325464721, 56.90315655634023, 47.26299649973436, 55.567741770351766, 55.59367891121521, 56.896693559390215, 53.064465341182206, 58.135824714038435, 42.86968855915255, 57.4547443054207, 59.858987958245265, 53.31314394152444, 56.95387946478296, 45.917901705578196, 56.026592879564475, 62.31596450675926, 51.194792369760115, 62.99508914429931, 56.031011619918765, 58.04675305918589, 57.66099351524737, 56.74992693900878, 42.4288869019047, 55.46742877117554, 59.67671738819579, 55.751178589324766, 52.84973925643014, 40.549410384568205, 50.89014784191149, 58.26865367052789, 51.94041338821423, 61.93843664198381, 55.87052115872122, 59.5601826471316, 56.71173481115036, 55.292560627812776, 40.90310920268154, 57.18013237905207, 54.681508197778975], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7819051846894722, "mean_inference_ms": 8.00201744598578, "mean_action_processing_ms": 0.5652034878392158, "mean_env_wait_ms": 24.245523150025956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03832674026489258, "StateBufferConnector_ms": 0.044373273849487305, "ViewRequirementAgentConnector_ms": 1.0524258613586426}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1704812, "num_agent_steps_trained": 1704812, "num_env_steps_sampled": 1704812, "num_env_steps_trained": 1704812, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.41779988229268, "num_env_steps_trained_throughput_per_sec": 226.41779988229268, "timesteps_total": 1704812, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1704812, "timers": {"training_iteration_time_ms": 68086.205, "sample_time_ms": 42024.915, "load_time_ms": 2182.585, "load_throughput": 7164.899, "learn_time_ms": 23315.452, "learn_throughput": 670.714, "synch_weights_time_ms": 448.528}, "counters": {"num_env_steps_sampled": 1704812, "num_env_steps_trained": 1704812, "num_agent_steps_sampled": 1704812, "num_agent_steps_trained": 1704812}, "done": false, "episodes_total": 1640, "training_iteration": 117, "trial_id": "837cb_00000", "date": "2025-06-07_19-34-55", "timestamp": 1749317695, "time_this_iter_s": 69.10005831718445, "time_total_s": 7744.058956861496, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7744.058956861496, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 64.30384615384615, "ram_util_percent": 88.82435897435894, "gpu_util_percent0": 0.22320512820512825, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.295188e-05, "total_loss": -0.0761815980410161, "policy_loss": -0.016883323249322447, "vf_loss": 0.014452578287825665, "vf_explained_var": 0.9579765528982336, "kl": 0.019970234193662995, "entropy": 16.45594080144709, "entropy_coeff": 0.003942781999999999}, "model": {}, "num_grad_updates_lifetime": 60265.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1720450, "num_env_steps_trained": 1720450, "num_agent_steps_sampled": 1720450, "num_agent_steps_trained": 1720450}, "sampler_results": {"episode_reward_max": 62.99508914429931, "episode_reward_min": 39.09274290255255, "episode_reward_mean": 54.12004752615973, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.13943715027659, 54.201627449166224, 53.36208951336481, 54.08069083991319, 46.05675384568714, 57.04040952187684, 60.763930130123725, 52.2429070305744, 56.57130778367714, 58.17445718565377, 58.77380515335565, 56.448422715009116, 57.01382899659708, 43.40796735766506, 56.63404171746844, 54.70429279813474, 54.69716356054045, 55.372463575060785, 41.85645600226434, 55.90323746903268, 57.68108772795858, 49.54221880714005, 60.66530494747018, 54.0681101706089, 56.686637316863994, 56.78201448097549, 53.6644133185855, 45.55015751362392, 56.70154515304006, 58.1109550481386, 54.28989501404268, 57.52498545455095, 44.63529829478965, 56.294330541884015, 59.61949853889347, 53.228778856604336, 60.01226677554812, 56.927995243401746, 50.29249969309888, 49.61875805187943, 54.57543048828277, 41.503442228674615, 55.9687370418183, 58.69446173041452, 48.29378642296347, 57.23920187086706, 46.08332069125427, 56.842325464721, 56.90315655634023, 47.26299649973436, 55.567741770351766, 55.59367891121521, 56.896693559390215, 53.064465341182206, 58.135824714038435, 42.86968855915255, 57.4547443054207, 59.858987958245265, 53.31314394152444, 56.95387946478296, 45.917901705578196, 56.026592879564475, 62.31596450675926, 51.194792369760115, 62.99508914429931, 56.031011619918765, 58.04675305918589, 57.66099351524737, 56.74992693900878, 42.4288869019047, 55.46742877117554, 59.67671738819579, 55.751178589324766, 52.84973925643014, 40.549410384568205, 50.89014784191149, 58.26865367052789, 51.94041338821423, 61.93843664198381, 55.87052115872122, 59.5601826471316, 56.71173481115036, 55.292560627812776, 40.90310920268154, 57.18013237905207, 54.681508197778975, 48.95422191177854, 49.833609292799586, 39.09274290255255, 56.889612835153564, 61.090537265269546, 50.8730413488764, 58.98395901321448, 52.361334105935235, 56.650098007110465, 54.29412664053514, 55.59267221818487, 42.36416736837841, 56.68651626109724, 58.020577582284616], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7812359468135046, "mean_inference_ms": 8.000746850229081, "mean_action_processing_ms": 0.5650163025052009, "mean_env_wait_ms": 24.247352046213283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03428769111633301, "StateBufferConnector_ms": 0.04338264465332031, "ViewRequirementAgentConnector_ms": 1.0666649341583252}}, "episode_reward_max": 62.99508914429931, "episode_reward_min": 39.09274290255255, "episode_reward_mean": 54.12004752615973, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [61.13943715027659, 54.201627449166224, 53.36208951336481, 54.08069083991319, 46.05675384568714, 57.04040952187684, 60.763930130123725, 52.2429070305744, 56.57130778367714, 58.17445718565377, 58.77380515335565, 56.448422715009116, 57.01382899659708, 43.40796735766506, 56.63404171746844, 54.70429279813474, 54.69716356054045, 55.372463575060785, 41.85645600226434, 55.90323746903268, 57.68108772795858, 49.54221880714005, 60.66530494747018, 54.0681101706089, 56.686637316863994, 56.78201448097549, 53.6644133185855, 45.55015751362392, 56.70154515304006, 58.1109550481386, 54.28989501404268, 57.52498545455095, 44.63529829478965, 56.294330541884015, 59.61949853889347, 53.228778856604336, 60.01226677554812, 56.927995243401746, 50.29249969309888, 49.61875805187943, 54.57543048828277, 41.503442228674615, 55.9687370418183, 58.69446173041452, 48.29378642296347, 57.23920187086706, 46.08332069125427, 56.842325464721, 56.90315655634023, 47.26299649973436, 55.567741770351766, 55.59367891121521, 56.896693559390215, 53.064465341182206, 58.135824714038435, 42.86968855915255, 57.4547443054207, 59.858987958245265, 53.31314394152444, 56.95387946478296, 45.917901705578196, 56.026592879564475, 62.31596450675926, 51.194792369760115, 62.99508914429931, 56.031011619918765, 58.04675305918589, 57.66099351524737, 56.74992693900878, 42.4288869019047, 55.46742877117554, 59.67671738819579, 55.751178589324766, 52.84973925643014, 40.549410384568205, 50.89014784191149, 58.26865367052789, 51.94041338821423, 61.93843664198381, 55.87052115872122, 59.5601826471316, 56.71173481115036, 55.292560627812776, 40.90310920268154, 57.18013237905207, 54.681508197778975, 48.95422191177854, 49.833609292799586, 39.09274290255255, 56.889612835153564, 61.090537265269546, 50.8730413488764, 58.98395901321448, 52.361334105935235, 56.650098007110465, 54.29412664053514, 55.59267221818487, 42.36416736837841, 56.68651626109724, 58.020577582284616], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7812359468135046, "mean_inference_ms": 8.000746850229081, "mean_action_processing_ms": 0.5650163025052009, "mean_env_wait_ms": 24.247352046213283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03428769111633301, "StateBufferConnector_ms": 0.04338264465332031, "ViewRequirementAgentConnector_ms": 1.0666649341583252}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1720450, "num_agent_steps_trained": 1720450, "num_env_steps_sampled": 1720450, "num_env_steps_trained": 1720450, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.48060960840027, "num_env_steps_trained_throughput_per_sec": 226.48060960840027, "timesteps_total": 1720450, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1720450, "timers": {"training_iteration_time_ms": 68125.835, "sample_time_ms": 42057.384, "load_time_ms": 2200.868, "load_throughput": 7105.378, "learn_time_ms": 23307.666, "learn_throughput": 670.938, "synch_weights_time_ms": 446.151}, "counters": {"num_env_steps_sampled": 1720450, "num_env_steps_trained": 1720450, "num_agent_steps_sampled": 1720450, "num_agent_steps_trained": 1720450}, "done": false, "episodes_total": 1654, "training_iteration": 118, "trial_id": "837cb_00000", "date": "2025-06-07_19-36-04", "timestamp": 1749317764, "time_this_iter_s": 69.06764483451843, "time_total_s": 7813.126601696014, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7813.126601696014, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 65.18101265822786, "ram_util_percent": 88.60632911392406, "gpu_util_percent0": 0.21215189873417722, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.279550000000002e-05, "total_loss": -0.0790982213797344, "policy_loss": -0.020037032252346928, "vf_loss": 0.014471525456333024, "vf_explained_var": 0.961039710153233, "kl": 0.019874527181361654, "entropy": 16.49386247288097, "entropy_coeff": 0.0039193249999999995}, "model": {}, "num_grad_updates_lifetime": 60815.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1736088, "num_env_steps_trained": 1736088, "num_agent_steps_sampled": 1736088, "num_agent_steps_trained": 1736088}, "sampler_results": {"episode_reward_max": 62.99508914429931, "episode_reward_min": 39.09274290255255, "episode_reward_mean": 53.72882804571747, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.63404171746844, 54.70429279813474, 54.69716356054045, 55.372463575060785, 41.85645600226434, 55.90323746903268, 57.68108772795858, 49.54221880714005, 60.66530494747018, 54.0681101706089, 56.686637316863994, 56.78201448097549, 53.6644133185855, 45.55015751362392, 56.70154515304006, 58.1109550481386, 54.28989501404268, 57.52498545455095, 44.63529829478965, 56.294330541884015, 59.61949853889347, 53.228778856604336, 60.01226677554812, 56.927995243401746, 50.29249969309888, 49.61875805187943, 54.57543048828277, 41.503442228674615, 55.9687370418183, 58.69446173041452, 48.29378642296347, 57.23920187086706, 46.08332069125427, 56.842325464721, 56.90315655634023, 47.26299649973436, 55.567741770351766, 55.59367891121521, 56.896693559390215, 53.064465341182206, 58.135824714038435, 42.86968855915255, 57.4547443054207, 59.858987958245265, 53.31314394152444, 56.95387946478296, 45.917901705578196, 56.026592879564475, 62.31596450675926, 51.194792369760115, 62.99508914429931, 56.031011619918765, 58.04675305918589, 57.66099351524737, 56.74992693900878, 42.4288869019047, 55.46742877117554, 59.67671738819579, 55.751178589324766, 52.84973925643014, 40.549410384568205, 50.89014784191149, 58.26865367052789, 51.94041338821423, 61.93843664198381, 55.87052115872122, 59.5601826471316, 56.71173481115036, 55.292560627812776, 40.90310920268154, 57.18013237905207, 54.681508197778975, 48.95422191177854, 49.833609292799586, 39.09274290255255, 56.889612835153564, 61.090537265269546, 50.8730413488764, 58.98395901321448, 52.361334105935235, 56.650098007110465, 54.29412664053514, 55.59267221818487, 42.36416736837841, 56.68651626109724, 58.020577582284616, 53.562744259996364, 46.969837062450665, 40.35705632925666, 56.31259232744957, 57.422023847394165, 50.982262321795304, 53.9719940445771, 53.545071626067106, 55.867129271576964, 55.27284682167278, 51.299115920333406, 41.778529676943734, 55.04328996212773, 57.77119315707464], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.780292950821865, "mean_inference_ms": 7.999769477144098, "mean_action_processing_ms": 0.5648466341422234, "mean_env_wait_ms": 24.249774884915173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03753256797790527, "StateBufferConnector_ms": 0.045362234115600586, "ViewRequirementAgentConnector_ms": 1.0669200420379639}}, "episode_reward_max": 62.99508914429931, "episode_reward_min": 39.09274290255255, "episode_reward_mean": 53.72882804571747, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [56.63404171746844, 54.70429279813474, 54.69716356054045, 55.372463575060785, 41.85645600226434, 55.90323746903268, 57.68108772795858, 49.54221880714005, 60.66530494747018, 54.0681101706089, 56.686637316863994, 56.78201448097549, 53.6644133185855, 45.55015751362392, 56.70154515304006, 58.1109550481386, 54.28989501404268, 57.52498545455095, 44.63529829478965, 56.294330541884015, 59.61949853889347, 53.228778856604336, 60.01226677554812, 56.927995243401746, 50.29249969309888, 49.61875805187943, 54.57543048828277, 41.503442228674615, 55.9687370418183, 58.69446173041452, 48.29378642296347, 57.23920187086706, 46.08332069125427, 56.842325464721, 56.90315655634023, 47.26299649973436, 55.567741770351766, 55.59367891121521, 56.896693559390215, 53.064465341182206, 58.135824714038435, 42.86968855915255, 57.4547443054207, 59.858987958245265, 53.31314394152444, 56.95387946478296, 45.917901705578196, 56.026592879564475, 62.31596450675926, 51.194792369760115, 62.99508914429931, 56.031011619918765, 58.04675305918589, 57.66099351524737, 56.74992693900878, 42.4288869019047, 55.46742877117554, 59.67671738819579, 55.751178589324766, 52.84973925643014, 40.549410384568205, 50.89014784191149, 58.26865367052789, 51.94041338821423, 61.93843664198381, 55.87052115872122, 59.5601826471316, 56.71173481115036, 55.292560627812776, 40.90310920268154, 57.18013237905207, 54.681508197778975, 48.95422191177854, 49.833609292799586, 39.09274290255255, 56.889612835153564, 61.090537265269546, 50.8730413488764, 58.98395901321448, 52.361334105935235, 56.650098007110465, 54.29412664053514, 55.59267221818487, 42.36416736837841, 56.68651626109724, 58.020577582284616, 53.562744259996364, 46.969837062450665, 40.35705632925666, 56.31259232744957, 57.422023847394165, 50.982262321795304, 53.9719940445771, 53.545071626067106, 55.867129271576964, 55.27284682167278, 51.299115920333406, 41.778529676943734, 55.04328996212773, 57.77119315707464], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.780292950821865, "mean_inference_ms": 7.999769477144098, "mean_action_processing_ms": 0.5648466341422234, "mean_env_wait_ms": 24.249774884915173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03753256797790527, "StateBufferConnector_ms": 0.045362234115600586, "ViewRequirementAgentConnector_ms": 1.0669200420379639}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1736088, "num_agent_steps_trained": 1736088, "num_env_steps_sampled": 1736088, "num_env_steps_trained": 1736088, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.2792631165704, "num_env_steps_trained_throughput_per_sec": 227.2792631165704, "timesteps_total": 1736088, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1736088, "timers": {"training_iteration_time_ms": 68255.241, "sample_time_ms": 42141.399, "load_time_ms": 2249.701, "load_throughput": 6951.145, "learn_time_ms": 23311.455, "learn_throughput": 670.829, "synch_weights_time_ms": 441.722}, "counters": {"num_env_steps_sampled": 1736088, "num_env_steps_trained": 1736088, "num_agent_steps_sampled": 1736088, "num_agent_steps_trained": 1736088}, "done": false, "episodes_total": 1668, "training_iteration": 119, "trial_id": "837cb_00000", "date": "2025-06-07_19-37-13", "timestamp": 1749317833, "time_this_iter_s": 68.8202018737793, "time_total_s": 7881.946803569794, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7881.946803569794, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 64.69624999999999, "ram_util_percent": 89.19874999999999, "gpu_util_percent0": 0.21587500000000004, "vram_util_percent0": 0.9650065104166666}}
{"evaluation": {"sampler_results": {"episode_reward_max": 0.3801772234552257, "episode_reward_min": 0.06426200374337382, "episode_reward_mean": 0.18714224905181295, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.3801772234552257, 0.10784709716470202, 0.16627316655644592, 0.06426200374337382, 0.2171517543393173], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9208566724212155, "mean_inference_ms": 4.007817631926985, "mean_action_processing_ms": 0.2908442787216708, "mean_env_wait_ms": 12.616469326490899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3793478012084961}}, "episode_reward_max": 0.3801772234552257, "episode_reward_min": 0.06426200374337382, "episode_reward_mean": 0.18714224905181295, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.3801772234552257, 0.10784709716470202, 0.16627316655644592, 0.06426200374337382, 0.2171517543393173], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9208566724212155, "mean_inference_ms": 4.007817631926985, "mean_action_processing_ms": 0.2908442787216708, "mean_env_wait_ms": 12.616469326490899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3793478012084961}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.263912e-05, "total_loss": -0.0953573626906357, "policy_loss": -0.037002717714058234, "vf_loss": 0.016159876704808663, "vf_explained_var": 0.9589544208483263, "kl": 0.020016645758168212, "entropy": 16.544103974429042, "entropy_coeff": 0.0038958680000000002}, "model": {}, "num_grad_updates_lifetime": 61365.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1751726, "num_env_steps_trained": 1751726, "num_agent_steps_sampled": 1751726, "num_agent_steps_trained": 1751726}, "sampler_results": {"episode_reward_max": 63.55992584703205, "episode_reward_min": 39.09274290255255, "episode_reward_mean": 53.607897113491724, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.70154515304006, 58.1109550481386, 54.28989501404268, 57.52498545455095, 44.63529829478965, 56.294330541884015, 59.61949853889347, 53.228778856604336, 60.01226677554812, 56.927995243401746, 50.29249969309888, 49.61875805187943, 54.57543048828277, 41.503442228674615, 55.9687370418183, 58.69446173041452, 48.29378642296347, 57.23920187086706, 46.08332069125427, 56.842325464721, 56.90315655634023, 47.26299649973436, 55.567741770351766, 55.59367891121521, 56.896693559390215, 53.064465341182206, 58.135824714038435, 42.86968855915255, 57.4547443054207, 59.858987958245265, 53.31314394152444, 56.95387946478296, 45.917901705578196, 56.026592879564475, 62.31596450675926, 51.194792369760115, 62.99508914429931, 56.031011619918765, 58.04675305918589, 57.66099351524737, 56.74992693900878, 42.4288869019047, 55.46742877117554, 59.67671738819579, 55.751178589324766, 52.84973925643014, 40.549410384568205, 50.89014784191149, 58.26865367052789, 51.94041338821423, 61.93843664198381, 55.87052115872122, 59.5601826471316, 56.71173481115036, 55.292560627812776, 40.90310920268154, 57.18013237905207, 54.681508197778975, 48.95422191177854, 49.833609292799586, 39.09274290255255, 56.889612835153564, 61.090537265269546, 50.8730413488764, 58.98395901321448, 52.361334105935235, 56.650098007110465, 54.29412664053514, 55.59267221818487, 42.36416736837841, 56.68651626109724, 58.020577582284616, 53.562744259996364, 46.969837062450665, 40.35705632925666, 56.31259232744957, 57.422023847394165, 50.982262321795304, 53.9719940445771, 53.545071626067106, 55.867129271576964, 55.27284682167278, 51.299115920333406, 41.778529676943734, 55.04328996212773, 57.77119315707464, 51.28185448752818, 51.762687850879196, 42.856306879586946, 55.30657781141599, 62.324890628700835, 48.94931849566735, 63.55992584703205, 52.05658395170245, 55.62376602961713, 55.757802163967646, 48.76455674300506, 41.723923969283504, 56.59217913006103, 55.154132194705596], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.779828853036314, "mean_inference_ms": 7.9988259967552935, "mean_action_processing_ms": 0.5646721611307713, "mean_env_wait_ms": 24.252049352266127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03505706787109375, "StateBufferConnector_ms": 0.0382847785949707, "ViewRequirementAgentConnector_ms": 1.0512518882751465}}, "episode_reward_max": 63.55992584703205, "episode_reward_min": 39.09274290255255, "episode_reward_mean": 53.607897113491724, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [56.70154515304006, 58.1109550481386, 54.28989501404268, 57.52498545455095, 44.63529829478965, 56.294330541884015, 59.61949853889347, 53.228778856604336, 60.01226677554812, 56.927995243401746, 50.29249969309888, 49.61875805187943, 54.57543048828277, 41.503442228674615, 55.9687370418183, 58.69446173041452, 48.29378642296347, 57.23920187086706, 46.08332069125427, 56.842325464721, 56.90315655634023, 47.26299649973436, 55.567741770351766, 55.59367891121521, 56.896693559390215, 53.064465341182206, 58.135824714038435, 42.86968855915255, 57.4547443054207, 59.858987958245265, 53.31314394152444, 56.95387946478296, 45.917901705578196, 56.026592879564475, 62.31596450675926, 51.194792369760115, 62.99508914429931, 56.031011619918765, 58.04675305918589, 57.66099351524737, 56.74992693900878, 42.4288869019047, 55.46742877117554, 59.67671738819579, 55.751178589324766, 52.84973925643014, 40.549410384568205, 50.89014784191149, 58.26865367052789, 51.94041338821423, 61.93843664198381, 55.87052115872122, 59.5601826471316, 56.71173481115036, 55.292560627812776, 40.90310920268154, 57.18013237905207, 54.681508197778975, 48.95422191177854, 49.833609292799586, 39.09274290255255, 56.889612835153564, 61.090537265269546, 50.8730413488764, 58.98395901321448, 52.361334105935235, 56.650098007110465, 54.29412664053514, 55.59267221818487, 42.36416736837841, 56.68651626109724, 58.020577582284616, 53.562744259996364, 46.969837062450665, 40.35705632925666, 56.31259232744957, 57.422023847394165, 50.982262321795304, 53.9719940445771, 53.545071626067106, 55.867129271576964, 55.27284682167278, 51.299115920333406, 41.778529676943734, 55.04328996212773, 57.77119315707464, 51.28185448752818, 51.762687850879196, 42.856306879586946, 55.30657781141599, 62.324890628700835, 48.94931849566735, 63.55992584703205, 52.05658395170245, 55.62376602961713, 55.757802163967646, 48.76455674300506, 41.723923969283504, 56.59217913006103, 55.154132194705596], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.779828853036314, "mean_inference_ms": 7.9988259967552935, "mean_action_processing_ms": 0.5646721611307713, "mean_env_wait_ms": 24.252049352266127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03505706787109375, "StateBufferConnector_ms": 0.0382847785949707, "ViewRequirementAgentConnector_ms": 1.0512518882751465}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1751726, "num_agent_steps_trained": 1751726, "num_env_steps_sampled": 1751726, "num_env_steps_trained": 1751726, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 231.8143128169498, "num_env_steps_trained_throughput_per_sec": 231.8143128169498, "timesteps_total": 1751726, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1751726, "timers": {"training_iteration_time_ms": 68230.01, "sample_time_ms": 42123.004, "load_time_ms": 2236.529, "load_throughput": 6992.085, "learn_time_ms": 23314.973, "learn_throughput": 670.728, "synch_weights_time_ms": 444.052}, "counters": {"num_env_steps_sampled": 1751726, "num_env_steps_trained": 1751726, "num_agent_steps_sampled": 1751726, "num_agent_steps_trained": 1751726}, "done": false, "episodes_total": 1682, "training_iteration": 120, "trial_id": "837cb_00000", "date": "2025-06-07_19-38-36", "timestamp": 1749317916, "time_this_iter_s": 82.87349200248718, "time_total_s": 7964.820295572281, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7964.820295572281, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 56.13854166666666, "ram_util_percent": 88.76666666666667, "gpu_util_percent0": 0.178125, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.248274e-05, "total_loss": -0.08048694652568718, "policy_loss": -0.02266252617859705, "vf_loss": 0.016120870230211453, "vf_explained_var": 0.9577585883574052, "kl": 0.02025708283197558, "entropy": 16.50825537594882, "entropy_coeff": 0.003872411}, "model": {}, "num_grad_updates_lifetime": 61915.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1767364, "num_env_steps_trained": 1767364, "num_agent_steps_sampled": 1767364, "num_agent_steps_trained": 1767364}, "sampler_results": {"episode_reward_max": 63.55992584703205, "episode_reward_min": 39.09274290255255, "episode_reward_mean": 53.198232155048444, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.9687370418183, 58.69446173041452, 48.29378642296347, 57.23920187086706, 46.08332069125427, 56.842325464721, 56.90315655634023, 47.26299649973436, 55.567741770351766, 55.59367891121521, 56.896693559390215, 53.064465341182206, 58.135824714038435, 42.86968855915255, 57.4547443054207, 59.858987958245265, 53.31314394152444, 56.95387946478296, 45.917901705578196, 56.026592879564475, 62.31596450675926, 51.194792369760115, 62.99508914429931, 56.031011619918765, 58.04675305918589, 57.66099351524737, 56.74992693900878, 42.4288869019047, 55.46742877117554, 59.67671738819579, 55.751178589324766, 52.84973925643014, 40.549410384568205, 50.89014784191149, 58.26865367052789, 51.94041338821423, 61.93843664198381, 55.87052115872122, 59.5601826471316, 56.71173481115036, 55.292560627812776, 40.90310920268154, 57.18013237905207, 54.681508197778975, 48.95422191177854, 49.833609292799586, 39.09274290255255, 56.889612835153564, 61.090537265269546, 50.8730413488764, 58.98395901321448, 52.361334105935235, 56.650098007110465, 54.29412664053514, 55.59267221818487, 42.36416736837841, 56.68651626109724, 58.020577582284616, 53.562744259996364, 46.969837062450665, 40.35705632925666, 56.31259232744957, 57.422023847394165, 50.982262321795304, 53.9719940445771, 53.545071626067106, 55.867129271576964, 55.27284682167278, 51.299115920333406, 41.778529676943734, 55.04328996212773, 57.77119315707464, 51.28185448752818, 51.762687850879196, 42.856306879586946, 55.30657781141599, 62.324890628700835, 48.94931849566735, 63.55992584703205, 52.05658395170245, 55.62376602961713, 55.757802163967646, 48.76455674300506, 41.723923969283504, 56.59217913006103, 55.154132194705596, 52.25736282903706, 56.66346049883309, 42.33736392355203, 51.228864703170615, 49.819415436614456, 51.68041872010525, 55.04136952961721, 42.5288860379745, 56.87354134158446, 52.70254728816997, 51.56887367288228, 42.06285840249766, 53.709609758502985, 53.89461139595791], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7795675902712036, "mean_inference_ms": 7.998044674123938, "mean_action_processing_ms": 0.5645102121603416, "mean_env_wait_ms": 24.25469790124744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06066083908081055, "StateBufferConnector_ms": 0.039308786392211914, "ViewRequirementAgentConnector_ms": 1.0503146648406982}}, "episode_reward_max": 63.55992584703205, "episode_reward_min": 39.09274290255255, "episode_reward_mean": 53.198232155048444, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [55.9687370418183, 58.69446173041452, 48.29378642296347, 57.23920187086706, 46.08332069125427, 56.842325464721, 56.90315655634023, 47.26299649973436, 55.567741770351766, 55.59367891121521, 56.896693559390215, 53.064465341182206, 58.135824714038435, 42.86968855915255, 57.4547443054207, 59.858987958245265, 53.31314394152444, 56.95387946478296, 45.917901705578196, 56.026592879564475, 62.31596450675926, 51.194792369760115, 62.99508914429931, 56.031011619918765, 58.04675305918589, 57.66099351524737, 56.74992693900878, 42.4288869019047, 55.46742877117554, 59.67671738819579, 55.751178589324766, 52.84973925643014, 40.549410384568205, 50.89014784191149, 58.26865367052789, 51.94041338821423, 61.93843664198381, 55.87052115872122, 59.5601826471316, 56.71173481115036, 55.292560627812776, 40.90310920268154, 57.18013237905207, 54.681508197778975, 48.95422191177854, 49.833609292799586, 39.09274290255255, 56.889612835153564, 61.090537265269546, 50.8730413488764, 58.98395901321448, 52.361334105935235, 56.650098007110465, 54.29412664053514, 55.59267221818487, 42.36416736837841, 56.68651626109724, 58.020577582284616, 53.562744259996364, 46.969837062450665, 40.35705632925666, 56.31259232744957, 57.422023847394165, 50.982262321795304, 53.9719940445771, 53.545071626067106, 55.867129271576964, 55.27284682167278, 51.299115920333406, 41.778529676943734, 55.04328996212773, 57.77119315707464, 51.28185448752818, 51.762687850879196, 42.856306879586946, 55.30657781141599, 62.324890628700835, 48.94931849566735, 63.55992584703205, 52.05658395170245, 55.62376602961713, 55.757802163967646, 48.76455674300506, 41.723923969283504, 56.59217913006103, 55.154132194705596, 52.25736282903706, 56.66346049883309, 42.33736392355203, 51.228864703170615, 49.819415436614456, 51.68041872010525, 55.04136952961721, 42.5288860379745, 56.87354134158446, 52.70254728816997, 51.56887367288228, 42.06285840249766, 53.709609758502985, 53.89461139595791], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7795675902712036, "mean_inference_ms": 7.998044674123938, "mean_action_processing_ms": 0.5645102121603416, "mean_env_wait_ms": 24.25469790124744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06066083908081055, "StateBufferConnector_ms": 0.039308786392211914, "ViewRequirementAgentConnector_ms": 1.0503146648406982}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1767364, "num_agent_steps_trained": 1767364, "num_env_steps_sampled": 1767364, "num_env_steps_trained": 1767364, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.54043906349213, "num_env_steps_trained_throughput_per_sec": 227.54043906349213, "timesteps_total": 1767364, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1767364, "timers": {"training_iteration_time_ms": 68292.643, "sample_time_ms": 42175.841, "load_time_ms": 2260.693, "load_throughput": 6917.349, "learn_time_ms": 23303.791, "learn_throughput": 671.05, "synch_weights_time_ms": 440.844}, "counters": {"num_env_steps_sampled": 1767364, "num_env_steps_trained": 1767364, "num_agent_steps_sampled": 1767364, "num_agent_steps_trained": 1767364}, "done": false, "episodes_total": 1696, "training_iteration": 121, "trial_id": "837cb_00000", "date": "2025-06-07_19-39-45", "timestamp": 1749317985, "time_this_iter_s": 68.74209642410278, "time_total_s": 8033.562391996384, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8033.562391996384, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 64.88607594936708, "ram_util_percent": 89.42151898734177, "gpu_util_percent0": 0.21177215189873422, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.232636000000002e-05, "total_loss": -0.09067675678879658, "policy_loss": -0.03224775994048369, "vf_loss": 0.013459386468272317, "vf_explained_var": 0.9635887917605314, "kl": 0.01972756641454418, "entropy": 16.549895430478184, "entropy_coeff": 0.0038489540000000012}, "model": {}, "num_grad_updates_lifetime": 62465.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1783002, "num_env_steps_trained": 1783002, "num_agent_steps_sampled": 1783002, "num_agent_steps_trained": 1783002}, "sampler_results": {"episode_reward_max": 63.55992584703205, "episode_reward_min": 39.09274290255255, "episode_reward_mean": 53.12595277860387, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.4547443054207, 59.858987958245265, 53.31314394152444, 56.95387946478296, 45.917901705578196, 56.026592879564475, 62.31596450675926, 51.194792369760115, 62.99508914429931, 56.031011619918765, 58.04675305918589, 57.66099351524737, 56.74992693900878, 42.4288869019047, 55.46742877117554, 59.67671738819579, 55.751178589324766, 52.84973925643014, 40.549410384568205, 50.89014784191149, 58.26865367052789, 51.94041338821423, 61.93843664198381, 55.87052115872122, 59.5601826471316, 56.71173481115036, 55.292560627812776, 40.90310920268154, 57.18013237905207, 54.681508197778975, 48.95422191177854, 49.833609292799586, 39.09274290255255, 56.889612835153564, 61.090537265269546, 50.8730413488764, 58.98395901321448, 52.361334105935235, 56.650098007110465, 54.29412664053514, 55.59267221818487, 42.36416736837841, 56.68651626109724, 58.020577582284616, 53.562744259996364, 46.969837062450665, 40.35705632925666, 56.31259232744957, 57.422023847394165, 50.982262321795304, 53.9719940445771, 53.545071626067106, 55.867129271576964, 55.27284682167278, 51.299115920333406, 41.778529676943734, 55.04328996212773, 57.77119315707464, 51.28185448752818, 51.762687850879196, 42.856306879586946, 55.30657781141599, 62.324890628700835, 48.94931849566735, 63.55992584703205, 52.05658395170245, 55.62376602961713, 55.757802163967646, 48.76455674300506, 41.723923969283504, 56.59217913006103, 55.154132194705596, 52.25736282903706, 56.66346049883309, 42.33736392355203, 51.228864703170615, 49.819415436614456, 51.68041872010525, 55.04136952961721, 42.5288860379745, 56.87354134158446, 52.70254728816997, 51.56887367288228, 42.06285840249766, 53.709609758502985, 53.89461139595791, 54.02716406643324, 54.47964040239525, 41.489023195631425, 52.246081713368, 60.26722952416867, 51.58243142126933, 59.019739295146934, 50.426694682044214, 61.18586063174968, 50.221821311825046, 51.284539165971424, 41.60811434168526, 59.35161448898319, 54.99818724831472], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.779112698617054, "mean_inference_ms": 7.99752356810652, "mean_action_processing_ms": 0.5643496396273593, "mean_env_wait_ms": 24.257707158166014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059740543365478516, "StateBufferConnector_ms": 0.03839302062988281, "ViewRequirementAgentConnector_ms": 1.074704885482788}}, "episode_reward_max": 63.55992584703205, "episode_reward_min": 39.09274290255255, "episode_reward_mean": 53.12595277860387, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [57.4547443054207, 59.858987958245265, 53.31314394152444, 56.95387946478296, 45.917901705578196, 56.026592879564475, 62.31596450675926, 51.194792369760115, 62.99508914429931, 56.031011619918765, 58.04675305918589, 57.66099351524737, 56.74992693900878, 42.4288869019047, 55.46742877117554, 59.67671738819579, 55.751178589324766, 52.84973925643014, 40.549410384568205, 50.89014784191149, 58.26865367052789, 51.94041338821423, 61.93843664198381, 55.87052115872122, 59.5601826471316, 56.71173481115036, 55.292560627812776, 40.90310920268154, 57.18013237905207, 54.681508197778975, 48.95422191177854, 49.833609292799586, 39.09274290255255, 56.889612835153564, 61.090537265269546, 50.8730413488764, 58.98395901321448, 52.361334105935235, 56.650098007110465, 54.29412664053514, 55.59267221818487, 42.36416736837841, 56.68651626109724, 58.020577582284616, 53.562744259996364, 46.969837062450665, 40.35705632925666, 56.31259232744957, 57.422023847394165, 50.982262321795304, 53.9719940445771, 53.545071626067106, 55.867129271576964, 55.27284682167278, 51.299115920333406, 41.778529676943734, 55.04328996212773, 57.77119315707464, 51.28185448752818, 51.762687850879196, 42.856306879586946, 55.30657781141599, 62.324890628700835, 48.94931849566735, 63.55992584703205, 52.05658395170245, 55.62376602961713, 55.757802163967646, 48.76455674300506, 41.723923969283504, 56.59217913006103, 55.154132194705596, 52.25736282903706, 56.66346049883309, 42.33736392355203, 51.228864703170615, 49.819415436614456, 51.68041872010525, 55.04136952961721, 42.5288860379745, 56.87354134158446, 52.70254728816997, 51.56887367288228, 42.06285840249766, 53.709609758502985, 53.89461139595791, 54.02716406643324, 54.47964040239525, 41.489023195631425, 52.246081713368, 60.26722952416867, 51.58243142126933, 59.019739295146934, 50.426694682044214, 61.18586063174968, 50.221821311825046, 51.284539165971424, 41.60811434168526, 59.35161448898319, 54.99818724831472], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.779112698617054, "mean_inference_ms": 7.99752356810652, "mean_action_processing_ms": 0.5643496396273593, "mean_env_wait_ms": 24.257707158166014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059740543365478516, "StateBufferConnector_ms": 0.03839302062988281, "ViewRequirementAgentConnector_ms": 1.074704885482788}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1783002, "num_agent_steps_trained": 1783002, "num_env_steps_sampled": 1783002, "num_env_steps_trained": 1783002, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.15838720395976, "num_env_steps_trained_throughput_per_sec": 229.15838720395976, "timesteps_total": 1783002, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1783002, "timers": {"training_iteration_time_ms": 68338.007, "sample_time_ms": 42242.913, "load_time_ms": 2237.653, "load_throughput": 6988.573, "learn_time_ms": 23305.063, "learn_throughput": 671.013, "synch_weights_time_ms": 440.016}, "counters": {"num_env_steps_sampled": 1783002, "num_env_steps_trained": 1783002, "num_agent_steps_sampled": 1783002, "num_agent_steps_trained": 1783002}, "done": false, "episodes_total": 1710, "training_iteration": 122, "trial_id": "837cb_00000", "date": "2025-06-07_19-40-53", "timestamp": 1749318053, "time_this_iter_s": 68.25618624687195, "time_total_s": 8101.818578243256, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8101.818578243256, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 64.14999999999999, "ram_util_percent": 89.23333333333335, "gpu_util_percent0": 0.21833333333333335, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.216998e-05, "total_loss": -0.0876273024530912, "policy_loss": -0.02946107022617732, "vf_loss": 0.013036786163733764, "vf_explained_var": 0.9604523753036153, "kl": 0.019727794446944308, "entropy": 16.549549674987794, "entropy_coeff": 0.0038254970000000006}, "model": {}, "num_grad_updates_lifetime": 63015.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1798640, "num_env_steps_trained": 1798640, "num_agent_steps_sampled": 1798640, "num_agent_steps_trained": 1798640}, "sampler_results": {"episode_reward_max": 63.55992584703205, "episode_reward_min": 39.09274290255255, "episode_reward_mean": 52.703657581264245, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.46742877117554, 59.67671738819579, 55.751178589324766, 52.84973925643014, 40.549410384568205, 50.89014784191149, 58.26865367052789, 51.94041338821423, 61.93843664198381, 55.87052115872122, 59.5601826471316, 56.71173481115036, 55.292560627812776, 40.90310920268154, 57.18013237905207, 54.681508197778975, 48.95422191177854, 49.833609292799586, 39.09274290255255, 56.889612835153564, 61.090537265269546, 50.8730413488764, 58.98395901321448, 52.361334105935235, 56.650098007110465, 54.29412664053514, 55.59267221818487, 42.36416736837841, 56.68651626109724, 58.020577582284616, 53.562744259996364, 46.969837062450665, 40.35705632925666, 56.31259232744957, 57.422023847394165, 50.982262321795304, 53.9719940445771, 53.545071626067106, 55.867129271576964, 55.27284682167278, 51.299115920333406, 41.778529676943734, 55.04328996212773, 57.77119315707464, 51.28185448752818, 51.762687850879196, 42.856306879586946, 55.30657781141599, 62.324890628700835, 48.94931849566735, 63.55992584703205, 52.05658395170245, 55.62376602961713, 55.757802163967646, 48.76455674300506, 41.723923969283504, 56.59217913006103, 55.154132194705596, 52.25736282903706, 56.66346049883309, 42.33736392355203, 51.228864703170615, 49.819415436614456, 51.68041872010525, 55.04136952961721, 42.5288860379745, 56.87354134158446, 52.70254728816997, 51.56887367288228, 42.06285840249766, 53.709609758502985, 53.89461139595791, 54.02716406643324, 54.47964040239525, 41.489023195631425, 52.246081713368, 60.26722952416867, 51.58243142126933, 59.019739295146934, 50.426694682044214, 61.18586063174968, 50.221821311825046, 51.284539165971424, 41.60811434168526, 59.35161448898319, 54.99818724831472, 51.68859109050056, 48.48602825491282, 43.142005037621246, 52.994588687731564, 55.31565453382149, 54.449063034760265, 57.35960384932311, 55.71643775280606, 56.83223234814552, 53.47372399114296, 54.99257313308863, 40.68061971893934, 53.91693448419132, 55.671092660253294], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7785917352425367, "mean_inference_ms": 7.997104636398079, "mean_action_processing_ms": 0.5642137651783987, "mean_env_wait_ms": 24.26106677805555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06021475791931152, "StateBufferConnector_ms": 0.028967857360839844, "ViewRequirementAgentConnector_ms": 1.0959525108337402}}, "episode_reward_max": 63.55992584703205, "episode_reward_min": 39.09274290255255, "episode_reward_mean": 52.703657581264245, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [55.46742877117554, 59.67671738819579, 55.751178589324766, 52.84973925643014, 40.549410384568205, 50.89014784191149, 58.26865367052789, 51.94041338821423, 61.93843664198381, 55.87052115872122, 59.5601826471316, 56.71173481115036, 55.292560627812776, 40.90310920268154, 57.18013237905207, 54.681508197778975, 48.95422191177854, 49.833609292799586, 39.09274290255255, 56.889612835153564, 61.090537265269546, 50.8730413488764, 58.98395901321448, 52.361334105935235, 56.650098007110465, 54.29412664053514, 55.59267221818487, 42.36416736837841, 56.68651626109724, 58.020577582284616, 53.562744259996364, 46.969837062450665, 40.35705632925666, 56.31259232744957, 57.422023847394165, 50.982262321795304, 53.9719940445771, 53.545071626067106, 55.867129271576964, 55.27284682167278, 51.299115920333406, 41.778529676943734, 55.04328996212773, 57.77119315707464, 51.28185448752818, 51.762687850879196, 42.856306879586946, 55.30657781141599, 62.324890628700835, 48.94931849566735, 63.55992584703205, 52.05658395170245, 55.62376602961713, 55.757802163967646, 48.76455674300506, 41.723923969283504, 56.59217913006103, 55.154132194705596, 52.25736282903706, 56.66346049883309, 42.33736392355203, 51.228864703170615, 49.819415436614456, 51.68041872010525, 55.04136952961721, 42.5288860379745, 56.87354134158446, 52.70254728816997, 51.56887367288228, 42.06285840249766, 53.709609758502985, 53.89461139595791, 54.02716406643324, 54.47964040239525, 41.489023195631425, 52.246081713368, 60.26722952416867, 51.58243142126933, 59.019739295146934, 50.426694682044214, 61.18586063174968, 50.221821311825046, 51.284539165971424, 41.60811434168526, 59.35161448898319, 54.99818724831472, 51.68859109050056, 48.48602825491282, 43.142005037621246, 52.994588687731564, 55.31565453382149, 54.449063034760265, 57.35960384932311, 55.71643775280606, 56.83223234814552, 53.47372399114296, 54.99257313308863, 40.68061971893934, 53.91693448419132, 55.671092660253294], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7785917352425367, "mean_inference_ms": 7.997104636398079, "mean_action_processing_ms": 0.5642137651783987, "mean_env_wait_ms": 24.26106677805555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06021475791931152, "StateBufferConnector_ms": 0.028967857360839844, "ViewRequirementAgentConnector_ms": 1.0959525108337402}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1798640, "num_agent_steps_trained": 1798640, "num_env_steps_sampled": 1798640, "num_env_steps_trained": 1798640, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.06434687110794, "num_env_steps_trained_throughput_per_sec": 228.06434687110794, "timesteps_total": 1798640, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1798640, "timers": {"training_iteration_time_ms": 68452.188, "sample_time_ms": 42339.006, "load_time_ms": 2241.259, "load_throughput": 6977.329, "learn_time_ms": 23322.49, "learn_throughput": 670.512, "synch_weights_time_ms": 437.122}, "counters": {"num_env_steps_sampled": 1798640, "num_env_steps_trained": 1798640, "num_agent_steps_sampled": 1798640, "num_agent_steps_trained": 1798640}, "done": false, "episodes_total": 1724, "training_iteration": 123, "trial_id": "837cb_00000", "date": "2025-06-07_19-42-02", "timestamp": 1749318122, "time_this_iter_s": 68.58616900444031, "time_total_s": 8170.404747247696, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8170.404747247696, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 64.71923076923078, "ram_util_percent": 89.44102564102565, "gpu_util_percent0": 0.2155128205128205, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.20136e-05, "total_loss": -0.08435414454391735, "policy_loss": -0.02617424022751617, "vf_loss": 0.012929460888474503, "vf_explained_var": 0.9577293102307753, "kl": 0.019573295906573075, "entropy": 16.644242447939785, "entropy_coeff": 0.00380204}, "model": {}, "num_grad_updates_lifetime": 63565.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1814278, "num_env_steps_trained": 1814278, "num_agent_steps_sampled": 1814278, "num_agent_steps_trained": 1814278}, "sampler_results": {"episode_reward_max": 63.55992584703205, "episode_reward_min": 39.09274290255255, "episode_reward_mean": 52.47679138945734, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.18013237905207, 54.681508197778975, 48.95422191177854, 49.833609292799586, 39.09274290255255, 56.889612835153564, 61.090537265269546, 50.8730413488764, 58.98395901321448, 52.361334105935235, 56.650098007110465, 54.29412664053514, 55.59267221818487, 42.36416736837841, 56.68651626109724, 58.020577582284616, 53.562744259996364, 46.969837062450665, 40.35705632925666, 56.31259232744957, 57.422023847394165, 50.982262321795304, 53.9719940445771, 53.545071626067106, 55.867129271576964, 55.27284682167278, 51.299115920333406, 41.778529676943734, 55.04328996212773, 57.77119315707464, 51.28185448752818, 51.762687850879196, 42.856306879586946, 55.30657781141599, 62.324890628700835, 48.94931849566735, 63.55992584703205, 52.05658395170245, 55.62376602961713, 55.757802163967646, 48.76455674300506, 41.723923969283504, 56.59217913006103, 55.154132194705596, 52.25736282903706, 56.66346049883309, 42.33736392355203, 51.228864703170615, 49.819415436614456, 51.68041872010525, 55.04136952961721, 42.5288860379745, 56.87354134158446, 52.70254728816997, 51.56887367288228, 42.06285840249766, 53.709609758502985, 53.89461139595791, 54.02716406643324, 54.47964040239525, 41.489023195631425, 52.246081713368, 60.26722952416867, 51.58243142126933, 59.019739295146934, 50.426694682044214, 61.18586063174968, 50.221821311825046, 51.284539165971424, 41.60811434168526, 59.35161448898319, 54.99818724831472, 51.68859109050056, 48.48602825491282, 43.142005037621246, 52.994588687731564, 55.31565453382149, 54.449063034760265, 57.35960384932311, 55.71643775280606, 56.83223234814552, 53.47372399114296, 54.99257313308863, 40.68061971893934, 53.91693448419132, 55.671092660253294, 52.15852965414842, 52.04985789131575, 41.33504015551126, 56.797977038807666, 55.8144553164056, 51.59841811333071, 56.61804036284997, 53.075807591346006, 52.55149136916833, 51.161127609159834, 57.1465998844239, 42.800432205520956, 52.52687889221154, 57.348959114939056], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.778166117722055, "mean_inference_ms": 7.996590087722772, "mean_action_processing_ms": 0.5640653786572983, "mean_env_wait_ms": 24.26422743138421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06017637252807617, "StateBufferConnector_ms": 0.031584739685058594, "ViewRequirementAgentConnector_ms": 1.0295217037200928}}, "episode_reward_max": 63.55992584703205, "episode_reward_min": 39.09274290255255, "episode_reward_mean": 52.47679138945734, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [57.18013237905207, 54.681508197778975, 48.95422191177854, 49.833609292799586, 39.09274290255255, 56.889612835153564, 61.090537265269546, 50.8730413488764, 58.98395901321448, 52.361334105935235, 56.650098007110465, 54.29412664053514, 55.59267221818487, 42.36416736837841, 56.68651626109724, 58.020577582284616, 53.562744259996364, 46.969837062450665, 40.35705632925666, 56.31259232744957, 57.422023847394165, 50.982262321795304, 53.9719940445771, 53.545071626067106, 55.867129271576964, 55.27284682167278, 51.299115920333406, 41.778529676943734, 55.04328996212773, 57.77119315707464, 51.28185448752818, 51.762687850879196, 42.856306879586946, 55.30657781141599, 62.324890628700835, 48.94931849566735, 63.55992584703205, 52.05658395170245, 55.62376602961713, 55.757802163967646, 48.76455674300506, 41.723923969283504, 56.59217913006103, 55.154132194705596, 52.25736282903706, 56.66346049883309, 42.33736392355203, 51.228864703170615, 49.819415436614456, 51.68041872010525, 55.04136952961721, 42.5288860379745, 56.87354134158446, 52.70254728816997, 51.56887367288228, 42.06285840249766, 53.709609758502985, 53.89461139595791, 54.02716406643324, 54.47964040239525, 41.489023195631425, 52.246081713368, 60.26722952416867, 51.58243142126933, 59.019739295146934, 50.426694682044214, 61.18586063174968, 50.221821311825046, 51.284539165971424, 41.60811434168526, 59.35161448898319, 54.99818724831472, 51.68859109050056, 48.48602825491282, 43.142005037621246, 52.994588687731564, 55.31565453382149, 54.449063034760265, 57.35960384932311, 55.71643775280606, 56.83223234814552, 53.47372399114296, 54.99257313308863, 40.68061971893934, 53.91693448419132, 55.671092660253294, 52.15852965414842, 52.04985789131575, 41.33504015551126, 56.797977038807666, 55.8144553164056, 51.59841811333071, 56.61804036284997, 53.075807591346006, 52.55149136916833, 51.161127609159834, 57.1465998844239, 42.800432205520956, 52.52687889221154, 57.348959114939056], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.778166117722055, "mean_inference_ms": 7.996590087722772, "mean_action_processing_ms": 0.5640653786572983, "mean_env_wait_ms": 24.26422743138421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06017637252807617, "StateBufferConnector_ms": 0.031584739685058594, "ViewRequirementAgentConnector_ms": 1.0295217037200928}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1814278, "num_agent_steps_trained": 1814278, "num_env_steps_sampled": 1814278, "num_env_steps_trained": 1814278, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.17378350087495, "num_env_steps_trained_throughput_per_sec": 229.17378350087495, "timesteps_total": 1814278, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1814278, "timers": {"training_iteration_time_ms": 68428.515, "sample_time_ms": 42317.301, "load_time_ms": 2247.377, "load_throughput": 6958.335, "learn_time_ms": 23314.764, "learn_throughput": 670.734, "synch_weights_time_ms": 436.316}, "counters": {"num_env_steps_sampled": 1814278, "num_env_steps_trained": 1814278, "num_agent_steps_sampled": 1814278, "num_agent_steps_trained": 1814278}, "done": false, "episodes_total": 1738, "training_iteration": 124, "trial_id": "837cb_00000", "date": "2025-06-07_19-43-10", "timestamp": 1749318190, "time_this_iter_s": 68.25497388839722, "time_total_s": 8238.659721136093, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8238.659721136093, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 64.48987341772151, "ram_util_percent": 89.51139240506329, "gpu_util_percent0": 0.219873417721519, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.185722000000001e-05, "total_loss": -0.09103667261205953, "policy_loss": -0.033066920087334105, "vf_loss": 0.012825540310533887, "vf_explained_var": 0.9585940181125294, "kl": 0.019535218767498023, "entropy": 16.6830702903054, "entropy_coeff": 0.0037785830000000007}, "model": {}, "num_grad_updates_lifetime": 64115.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1829916, "num_env_steps_trained": 1829916, "num_agent_steps_sampled": 1829916, "num_agent_steps_trained": 1829916}, "sampler_results": {"episode_reward_max": 63.55992584703205, "episode_reward_min": 40.35705632925666, "episode_reward_mean": 52.70571306609142, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.68651626109724, 58.020577582284616, 53.562744259996364, 46.969837062450665, 40.35705632925666, 56.31259232744957, 57.422023847394165, 50.982262321795304, 53.9719940445771, 53.545071626067106, 55.867129271576964, 55.27284682167278, 51.299115920333406, 41.778529676943734, 55.04328996212773, 57.77119315707464, 51.28185448752818, 51.762687850879196, 42.856306879586946, 55.30657781141599, 62.324890628700835, 48.94931849566735, 63.55992584703205, 52.05658395170245, 55.62376602961713, 55.757802163967646, 48.76455674300506, 41.723923969283504, 56.59217913006103, 55.154132194705596, 52.25736282903706, 56.66346049883309, 42.33736392355203, 51.228864703170615, 49.819415436614456, 51.68041872010525, 55.04136952961721, 42.5288860379745, 56.87354134158446, 52.70254728816997, 51.56887367288228, 42.06285840249766, 53.709609758502985, 53.89461139595791, 54.02716406643324, 54.47964040239525, 41.489023195631425, 52.246081713368, 60.26722952416867, 51.58243142126933, 59.019739295146934, 50.426694682044214, 61.18586063174968, 50.221821311825046, 51.284539165971424, 41.60811434168526, 59.35161448898319, 54.99818724831472, 51.68859109050056, 48.48602825491282, 43.142005037621246, 52.994588687731564, 55.31565453382149, 54.449063034760265, 57.35960384932311, 55.71643775280606, 56.83223234814552, 53.47372399114296, 54.99257313308863, 40.68061971893934, 53.91693448419132, 55.671092660253294, 52.15852965414842, 52.04985789131575, 41.33504015551126, 56.797977038807666, 55.8144553164056, 51.59841811333071, 56.61804036284997, 53.075807591346006, 52.55149136916833, 51.161127609159834, 57.1465998844239, 42.800432205520956, 52.52687889221154, 57.348959114939056, 54.149037579807136, 54.69045022273649, 40.715970265471675, 59.31899319501216, 58.58619019641472, 54.210385791289994, 59.61864857787733, 56.3714250639748, 56.10205562478877, 55.42378150207988, 56.78238103335465, 41.49475966877831, 57.04600429975017, 57.223848128692325], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7776650876204774, "mean_inference_ms": 7.996071196546165, "mean_action_processing_ms": 0.5639113038888751, "mean_env_wait_ms": 24.266855608598874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06521964073181152, "StateBufferConnector_ms": 0.032634735107421875, "ViewRequirementAgentConnector_ms": 0.9880702495574951}}, "episode_reward_max": 63.55992584703205, "episode_reward_min": 40.35705632925666, "episode_reward_mean": 52.70571306609142, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [56.68651626109724, 58.020577582284616, 53.562744259996364, 46.969837062450665, 40.35705632925666, 56.31259232744957, 57.422023847394165, 50.982262321795304, 53.9719940445771, 53.545071626067106, 55.867129271576964, 55.27284682167278, 51.299115920333406, 41.778529676943734, 55.04328996212773, 57.77119315707464, 51.28185448752818, 51.762687850879196, 42.856306879586946, 55.30657781141599, 62.324890628700835, 48.94931849566735, 63.55992584703205, 52.05658395170245, 55.62376602961713, 55.757802163967646, 48.76455674300506, 41.723923969283504, 56.59217913006103, 55.154132194705596, 52.25736282903706, 56.66346049883309, 42.33736392355203, 51.228864703170615, 49.819415436614456, 51.68041872010525, 55.04136952961721, 42.5288860379745, 56.87354134158446, 52.70254728816997, 51.56887367288228, 42.06285840249766, 53.709609758502985, 53.89461139595791, 54.02716406643324, 54.47964040239525, 41.489023195631425, 52.246081713368, 60.26722952416867, 51.58243142126933, 59.019739295146934, 50.426694682044214, 61.18586063174968, 50.221821311825046, 51.284539165971424, 41.60811434168526, 59.35161448898319, 54.99818724831472, 51.68859109050056, 48.48602825491282, 43.142005037621246, 52.994588687731564, 55.31565453382149, 54.449063034760265, 57.35960384932311, 55.71643775280606, 56.83223234814552, 53.47372399114296, 54.99257313308863, 40.68061971893934, 53.91693448419132, 55.671092660253294, 52.15852965414842, 52.04985789131575, 41.33504015551126, 56.797977038807666, 55.8144553164056, 51.59841811333071, 56.61804036284997, 53.075807591346006, 52.55149136916833, 51.161127609159834, 57.1465998844239, 42.800432205520956, 52.52687889221154, 57.348959114939056, 54.149037579807136, 54.69045022273649, 40.715970265471675, 59.31899319501216, 58.58619019641472, 54.210385791289994, 59.61864857787733, 56.3714250639748, 56.10205562478877, 55.42378150207988, 56.78238103335465, 41.49475966877831, 57.04600429975017, 57.223848128692325], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7776650876204774, "mean_inference_ms": 7.996071196546165, "mean_action_processing_ms": 0.5639113038888751, "mean_env_wait_ms": 24.266855608598874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06521964073181152, "StateBufferConnector_ms": 0.032634735107421875, "ViewRequirementAgentConnector_ms": 0.9880702495574951}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1829916, "num_agent_steps_trained": 1829916, "num_env_steps_sampled": 1829916, "num_env_steps_trained": 1829916, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.66640929862407, "num_env_steps_trained_throughput_per_sec": 226.66640929862407, "timesteps_total": 1829916, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1829916, "timers": {"training_iteration_time_ms": 68519.662, "sample_time_ms": 42350.4, "load_time_ms": 2294.852, "load_throughput": 6814.384, "learn_time_ms": 23330.726, "learn_throughput": 670.275, "synch_weights_time_ms": 431.244}, "counters": {"num_env_steps_sampled": 1829916, "num_env_steps_trained": 1829916, "num_agent_steps_sampled": 1829916, "num_agent_steps_trained": 1829916}, "done": false, "episodes_total": 1752, "training_iteration": 125, "trial_id": "837cb_00000", "date": "2025-06-07_19-44-19", "timestamp": 1749318259, "time_this_iter_s": 69.0073573589325, "time_total_s": 8307.667078495026, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8307.667078495026, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 65.10759493670886, "ram_util_percent": 89.09113924050637, "gpu_util_percent0": 0.21139240506329118, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.170084e-05, "total_loss": -0.10448602445243689, "policy_loss": -0.046643180697944694, "vf_loss": 0.013033251974477687, "vf_explained_var": 0.9582511006702076, "kl": 0.01963459625650277, "entropy": 16.771736488342285, "entropy_coeff": 0.003755126000000001}, "model": {}, "num_grad_updates_lifetime": 64665.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1845554, "num_env_steps_trained": 1845554, "num_agent_steps_sampled": 1845554, "num_agent_steps_trained": 1845554}, "sampler_results": {"episode_reward_max": 63.55992584703205, "episode_reward_min": 40.68061971893934, "episode_reward_mean": 52.800507636772764, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.04328996212773, 57.77119315707464, 51.28185448752818, 51.762687850879196, 42.856306879586946, 55.30657781141599, 62.324890628700835, 48.94931849566735, 63.55992584703205, 52.05658395170245, 55.62376602961713, 55.757802163967646, 48.76455674300506, 41.723923969283504, 56.59217913006103, 55.154132194705596, 52.25736282903706, 56.66346049883309, 42.33736392355203, 51.228864703170615, 49.819415436614456, 51.68041872010525, 55.04136952961721, 42.5288860379745, 56.87354134158446, 52.70254728816997, 51.56887367288228, 42.06285840249766, 53.709609758502985, 53.89461139595791, 54.02716406643324, 54.47964040239525, 41.489023195631425, 52.246081713368, 60.26722952416867, 51.58243142126933, 59.019739295146934, 50.426694682044214, 61.18586063174968, 50.221821311825046, 51.284539165971424, 41.60811434168526, 59.35161448898319, 54.99818724831472, 51.68859109050056, 48.48602825491282, 43.142005037621246, 52.994588687731564, 55.31565453382149, 54.449063034760265, 57.35960384932311, 55.71643775280606, 56.83223234814552, 53.47372399114296, 54.99257313308863, 40.68061971893934, 53.91693448419132, 55.671092660253294, 52.15852965414842, 52.04985789131575, 41.33504015551126, 56.797977038807666, 55.8144553164056, 51.59841811333071, 56.61804036284997, 53.075807591346006, 52.55149136916833, 51.161127609159834, 57.1465998844239, 42.800432205520956, 52.52687889221154, 57.348959114939056, 54.149037579807136, 54.69045022273649, 40.715970265471675, 59.31899319501216, 58.58619019641472, 54.210385791289994, 59.61864857787733, 56.3714250639748, 56.10205562478877, 55.42378150207988, 56.78238103335465, 41.49475966877831, 57.04600429975017, 57.223848128692325, 51.0237626962811, 53.806274789689205, 43.51948452145685, 54.4376549560303, 58.72596491716561, 53.65094436357928, 59.82441052863533, 53.66327001859768, 56.75515134768211, 50.723402279286766, 53.24572883364178, 41.7394550924879, 53.15537504249377, 57.256875034001915], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7774774481330673, "mean_inference_ms": 7.995395043576858, "mean_action_processing_ms": 0.5637614004918876, "mean_env_wait_ms": 24.269037692674925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06425333023071289, "StateBufferConnector_ms": 0.03272247314453125, "ViewRequirementAgentConnector_ms": 0.9958429336547852}}, "episode_reward_max": 63.55992584703205, "episode_reward_min": 40.68061971893934, "episode_reward_mean": 52.800507636772764, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [55.04328996212773, 57.77119315707464, 51.28185448752818, 51.762687850879196, 42.856306879586946, 55.30657781141599, 62.324890628700835, 48.94931849566735, 63.55992584703205, 52.05658395170245, 55.62376602961713, 55.757802163967646, 48.76455674300506, 41.723923969283504, 56.59217913006103, 55.154132194705596, 52.25736282903706, 56.66346049883309, 42.33736392355203, 51.228864703170615, 49.819415436614456, 51.68041872010525, 55.04136952961721, 42.5288860379745, 56.87354134158446, 52.70254728816997, 51.56887367288228, 42.06285840249766, 53.709609758502985, 53.89461139595791, 54.02716406643324, 54.47964040239525, 41.489023195631425, 52.246081713368, 60.26722952416867, 51.58243142126933, 59.019739295146934, 50.426694682044214, 61.18586063174968, 50.221821311825046, 51.284539165971424, 41.60811434168526, 59.35161448898319, 54.99818724831472, 51.68859109050056, 48.48602825491282, 43.142005037621246, 52.994588687731564, 55.31565453382149, 54.449063034760265, 57.35960384932311, 55.71643775280606, 56.83223234814552, 53.47372399114296, 54.99257313308863, 40.68061971893934, 53.91693448419132, 55.671092660253294, 52.15852965414842, 52.04985789131575, 41.33504015551126, 56.797977038807666, 55.8144553164056, 51.59841811333071, 56.61804036284997, 53.075807591346006, 52.55149136916833, 51.161127609159834, 57.1465998844239, 42.800432205520956, 52.52687889221154, 57.348959114939056, 54.149037579807136, 54.69045022273649, 40.715970265471675, 59.31899319501216, 58.58619019641472, 54.210385791289994, 59.61864857787733, 56.3714250639748, 56.10205562478877, 55.42378150207988, 56.78238103335465, 41.49475966877831, 57.04600429975017, 57.223848128692325, 51.0237626962811, 53.806274789689205, 43.51948452145685, 54.4376549560303, 58.72596491716561, 53.65094436357928, 59.82441052863533, 53.66327001859768, 56.75515134768211, 50.723402279286766, 53.24572883364178, 41.7394550924879, 53.15537504249377, 57.256875034001915], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7774774481330673, "mean_inference_ms": 7.995395043576858, "mean_action_processing_ms": 0.5637614004918876, "mean_env_wait_ms": 24.269037692674925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06425333023071289, "StateBufferConnector_ms": 0.03272247314453125, "ViewRequirementAgentConnector_ms": 0.9958429336547852}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1845554, "num_agent_steps_trained": 1845554, "num_env_steps_sampled": 1845554, "num_env_steps_trained": 1845554, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.70226359972474, "num_env_steps_trained_throughput_per_sec": 228.70226359972474, "timesteps_total": 1845554, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1845554, "timers": {"training_iteration_time_ms": 68551.966, "sample_time_ms": 42383.869, "load_time_ms": 2302.875, "load_throughput": 6790.642, "learn_time_ms": 23319.414, "learn_throughput": 670.6, "synch_weights_time_ms": 433.697}, "counters": {"num_env_steps_sampled": 1845554, "num_env_steps_trained": 1845554, "num_agent_steps_sampled": 1845554, "num_agent_steps_trained": 1845554}, "done": false, "episodes_total": 1766, "training_iteration": 126, "trial_id": "837cb_00000", "date": "2025-06-07_19-45-28", "timestamp": 1749318328, "time_this_iter_s": 68.39511179924011, "time_total_s": 8376.062190294266, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8376.062190294266, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 64.15189873417721, "ram_util_percent": 89.29113924050633, "gpu_util_percent0": 0.21924050632911393, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.154446000000001e-05, "total_loss": -0.100003696763888, "policy_loss": -0.04231235280580057, "vf_loss": 0.012815887411548333, "vf_explained_var": 0.9608524949984117, "kl": 0.01963025990302477, "entropy": 16.81901653983376, "entropy_coeff": 0.0037316689999999995}, "model": {}, "num_grad_updates_lifetime": 65215.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1861192, "num_env_steps_trained": 1861192, "num_agent_steps_sampled": 1861192, "num_agent_steps_trained": 1861192}, "sampler_results": {"episode_reward_max": 61.18586063174968, "episode_reward_min": 40.4056484651689, "episode_reward_mean": 52.74370358440784, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.59217913006103, 55.154132194705596, 52.25736282903706, 56.66346049883309, 42.33736392355203, 51.228864703170615, 49.819415436614456, 51.68041872010525, 55.04136952961721, 42.5288860379745, 56.87354134158446, 52.70254728816997, 51.56887367288228, 42.06285840249766, 53.709609758502985, 53.89461139595791, 54.02716406643324, 54.47964040239525, 41.489023195631425, 52.246081713368, 60.26722952416867, 51.58243142126933, 59.019739295146934, 50.426694682044214, 61.18586063174968, 50.221821311825046, 51.284539165971424, 41.60811434168526, 59.35161448898319, 54.99818724831472, 51.68859109050056, 48.48602825491282, 43.142005037621246, 52.994588687731564, 55.31565453382149, 54.449063034760265, 57.35960384932311, 55.71643775280606, 56.83223234814552, 53.47372399114296, 54.99257313308863, 40.68061971893934, 53.91693448419132, 55.671092660253294, 52.15852965414842, 52.04985789131575, 41.33504015551126, 56.797977038807666, 55.8144553164056, 51.59841811333071, 56.61804036284997, 53.075807591346006, 52.55149136916833, 51.161127609159834, 57.1465998844239, 42.800432205520956, 52.52687889221154, 57.348959114939056, 54.149037579807136, 54.69045022273649, 40.715970265471675, 59.31899319501216, 58.58619019641472, 54.210385791289994, 59.61864857787733, 56.3714250639748, 56.10205562478877, 55.42378150207988, 56.78238103335465, 41.49475966877831, 57.04600429975017, 57.223848128692325, 51.0237626962811, 53.806274789689205, 43.51948452145685, 54.4376549560303, 58.72596491716561, 53.65094436357928, 59.82441052863533, 53.66327001859768, 56.75515134768211, 50.723402279286766, 53.24572883364178, 41.7394550924879, 53.15537504249377, 57.256875034001915, 50.65410085440543, 53.04032828732355, 42.75554891388384, 55.91476136775283, 58.87634506792532, 50.3279374246007, 56.138943095388754, 51.38580456144168, 56.98615725884455, 50.493567970244406, 55.68961246273255, 40.4056484651689, 56.555794272342986, 57.87772273903988], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.776933232847266, "mean_inference_ms": 7.994795809802014, "mean_action_processing_ms": 0.5636265776581795, "mean_env_wait_ms": 24.271905986978336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06501603126525879, "StateBufferConnector_ms": 0.033882856369018555, "ViewRequirementAgentConnector_ms": 1.006122350692749}}, "episode_reward_max": 61.18586063174968, "episode_reward_min": 40.4056484651689, "episode_reward_mean": 52.74370358440784, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [56.59217913006103, 55.154132194705596, 52.25736282903706, 56.66346049883309, 42.33736392355203, 51.228864703170615, 49.819415436614456, 51.68041872010525, 55.04136952961721, 42.5288860379745, 56.87354134158446, 52.70254728816997, 51.56887367288228, 42.06285840249766, 53.709609758502985, 53.89461139595791, 54.02716406643324, 54.47964040239525, 41.489023195631425, 52.246081713368, 60.26722952416867, 51.58243142126933, 59.019739295146934, 50.426694682044214, 61.18586063174968, 50.221821311825046, 51.284539165971424, 41.60811434168526, 59.35161448898319, 54.99818724831472, 51.68859109050056, 48.48602825491282, 43.142005037621246, 52.994588687731564, 55.31565453382149, 54.449063034760265, 57.35960384932311, 55.71643775280606, 56.83223234814552, 53.47372399114296, 54.99257313308863, 40.68061971893934, 53.91693448419132, 55.671092660253294, 52.15852965414842, 52.04985789131575, 41.33504015551126, 56.797977038807666, 55.8144553164056, 51.59841811333071, 56.61804036284997, 53.075807591346006, 52.55149136916833, 51.161127609159834, 57.1465998844239, 42.800432205520956, 52.52687889221154, 57.348959114939056, 54.149037579807136, 54.69045022273649, 40.715970265471675, 59.31899319501216, 58.58619019641472, 54.210385791289994, 59.61864857787733, 56.3714250639748, 56.10205562478877, 55.42378150207988, 56.78238103335465, 41.49475966877831, 57.04600429975017, 57.223848128692325, 51.0237626962811, 53.806274789689205, 43.51948452145685, 54.4376549560303, 58.72596491716561, 53.65094436357928, 59.82441052863533, 53.66327001859768, 56.75515134768211, 50.723402279286766, 53.24572883364178, 41.7394550924879, 53.15537504249377, 57.256875034001915, 50.65410085440543, 53.04032828732355, 42.75554891388384, 55.91476136775283, 58.87634506792532, 50.3279374246007, 56.138943095388754, 51.38580456144168, 56.98615725884455, 50.493567970244406, 55.68961246273255, 40.4056484651689, 56.555794272342986, 57.87772273903988], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.776933232847266, "mean_inference_ms": 7.994795809802014, "mean_action_processing_ms": 0.5636265776581795, "mean_env_wait_ms": 24.271905986978336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06501603126525879, "StateBufferConnector_ms": 0.033882856369018555, "ViewRequirementAgentConnector_ms": 1.006122350692749}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1861192, "num_agent_steps_trained": 1861192, "num_env_steps_sampled": 1861192, "num_env_steps_trained": 1861192, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.4466691521957, "num_env_steps_trained_throughput_per_sec": 228.4466691521957, "timesteps_total": 1861192, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1861192, "timers": {"training_iteration_time_ms": 68490.527, "sample_time_ms": 42360.505, "load_time_ms": 2306.611, "load_throughput": 6779.643, "learn_time_ms": 23277.988, "learn_throughput": 671.793, "synch_weights_time_ms": 431.244}, "counters": {"num_env_steps_sampled": 1861192, "num_env_steps_trained": 1861192, "num_agent_steps_sampled": 1861192, "num_agent_steps_trained": 1861192}, "done": false, "episodes_total": 1780, "training_iteration": 127, "trial_id": "837cb_00000", "date": "2025-06-07_19-46-36", "timestamp": 1749318396, "time_this_iter_s": 68.45934200286865, "time_total_s": 8444.521532297134, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8444.521532297134, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 65.16666666666669, "ram_util_percent": 89.25128205128206, "gpu_util_percent0": 0.2171794871794872, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.138807999999999e-05, "total_loss": -0.08011174047577449, "policy_loss": -0.02328832167497074, "vf_loss": 0.014748841360296038, "vf_explained_var": 0.9594739040461453, "kl": 0.019697861768870922, "entropy": 16.84887214487249, "entropy_coeff": 0.003708212}, "model": {}, "num_grad_updates_lifetime": 65765.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1876830, "num_env_steps_trained": 1876830, "num_agent_steps_sampled": 1876830, "num_agent_steps_trained": 1876830}, "sampler_results": {"episode_reward_max": 61.18586063174968, "episode_reward_min": 32.999046250534015, "episode_reward_mean": 52.79274155612299, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.709609758502985, 53.89461139595791, 54.02716406643324, 54.47964040239525, 41.489023195631425, 52.246081713368, 60.26722952416867, 51.58243142126933, 59.019739295146934, 50.426694682044214, 61.18586063174968, 50.221821311825046, 51.284539165971424, 41.60811434168526, 59.35161448898319, 54.99818724831472, 51.68859109050056, 48.48602825491282, 43.142005037621246, 52.994588687731564, 55.31565453382149, 54.449063034760265, 57.35960384932311, 55.71643775280606, 56.83223234814552, 53.47372399114296, 54.99257313308863, 40.68061971893934, 53.91693448419132, 55.671092660253294, 52.15852965414842, 52.04985789131575, 41.33504015551126, 56.797977038807666, 55.8144553164056, 51.59841811333071, 56.61804036284997, 53.075807591346006, 52.55149136916833, 51.161127609159834, 57.1465998844239, 42.800432205520956, 52.52687889221154, 57.348959114939056, 54.149037579807136, 54.69045022273649, 40.715970265471675, 59.31899319501216, 58.58619019641472, 54.210385791289994, 59.61864857787733, 56.3714250639748, 56.10205562478877, 55.42378150207988, 56.78238103335465, 41.49475966877831, 57.04600429975017, 57.223848128692325, 51.0237626962811, 53.806274789689205, 43.51948452145685, 54.4376549560303, 58.72596491716561, 53.65094436357928, 59.82441052863533, 53.66327001859768, 56.75515134768211, 50.723402279286766, 53.24572883364178, 41.7394550924879, 53.15537504249377, 57.256875034001915, 50.65410085440543, 53.04032828732355, 42.75554891388384, 55.91476136775283, 58.87634506792532, 50.3279374246007, 56.138943095388754, 51.38580456144168, 56.98615725884455, 50.493567970244406, 55.68961246273255, 40.4056484651689, 56.555794272342986, 57.87772273903988, 51.06572712391842, 54.551949311788796, 39.46536861736038, 53.86296083699347, 60.51716222880261, 53.54004715972895, 57.22627939610685, 53.38919833766069, 45.34206759505605, 54.09236105749023, 54.767443788157024, 32.999046250534015, 55.35375068256463, 55.24170849415922], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.776388917074212, "mean_inference_ms": 7.994284666660508, "mean_action_processing_ms": 0.5635082397866141, "mean_env_wait_ms": 24.274621279661904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03734588623046875, "StateBufferConnector_ms": 0.03679013252258301, "ViewRequirementAgentConnector_ms": 1.0344212055206299}}, "episode_reward_max": 61.18586063174968, "episode_reward_min": 32.999046250534015, "episode_reward_mean": 52.79274155612299, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.709609758502985, 53.89461139595791, 54.02716406643324, 54.47964040239525, 41.489023195631425, 52.246081713368, 60.26722952416867, 51.58243142126933, 59.019739295146934, 50.426694682044214, 61.18586063174968, 50.221821311825046, 51.284539165971424, 41.60811434168526, 59.35161448898319, 54.99818724831472, 51.68859109050056, 48.48602825491282, 43.142005037621246, 52.994588687731564, 55.31565453382149, 54.449063034760265, 57.35960384932311, 55.71643775280606, 56.83223234814552, 53.47372399114296, 54.99257313308863, 40.68061971893934, 53.91693448419132, 55.671092660253294, 52.15852965414842, 52.04985789131575, 41.33504015551126, 56.797977038807666, 55.8144553164056, 51.59841811333071, 56.61804036284997, 53.075807591346006, 52.55149136916833, 51.161127609159834, 57.1465998844239, 42.800432205520956, 52.52687889221154, 57.348959114939056, 54.149037579807136, 54.69045022273649, 40.715970265471675, 59.31899319501216, 58.58619019641472, 54.210385791289994, 59.61864857787733, 56.3714250639748, 56.10205562478877, 55.42378150207988, 56.78238103335465, 41.49475966877831, 57.04600429975017, 57.223848128692325, 51.0237626962811, 53.806274789689205, 43.51948452145685, 54.4376549560303, 58.72596491716561, 53.65094436357928, 59.82441052863533, 53.66327001859768, 56.75515134768211, 50.723402279286766, 53.24572883364178, 41.7394550924879, 53.15537504249377, 57.256875034001915, 50.65410085440543, 53.04032828732355, 42.75554891388384, 55.91476136775283, 58.87634506792532, 50.3279374246007, 56.138943095388754, 51.38580456144168, 56.98615725884455, 50.493567970244406, 55.68961246273255, 40.4056484651689, 56.555794272342986, 57.87772273903988, 51.06572712391842, 54.551949311788796, 39.46536861736038, 53.86296083699347, 60.51716222880261, 53.54004715972895, 57.22627939610685, 53.38919833766069, 45.34206759505605, 54.09236105749023, 54.767443788157024, 32.999046250534015, 55.35375068256463, 55.24170849415922], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.776388917074212, "mean_inference_ms": 7.994284666660508, "mean_action_processing_ms": 0.5635082397866141, "mean_env_wait_ms": 24.274621279661904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03734588623046875, "StateBufferConnector_ms": 0.03679013252258301, "ViewRequirementAgentConnector_ms": 1.0344212055206299}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1876830, "num_agent_steps_trained": 1876830, "num_env_steps_sampled": 1876830, "num_env_steps_trained": 1876830, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.85189347734755, "num_env_steps_trained_throughput_per_sec": 226.85189347734755, "timesteps_total": 1876830, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1876830, "timers": {"training_iteration_time_ms": 68479.226, "sample_time_ms": 42325.581, "load_time_ms": 2316.907, "load_throughput": 6749.515, "learn_time_ms": 23286.739, "learn_throughput": 671.541, "synch_weights_time_ms": 432.092}, "counters": {"num_env_steps_sampled": 1876830, "num_env_steps_trained": 1876830, "num_agent_steps_sampled": 1876830, "num_agent_steps_trained": 1876830}, "done": false, "episodes_total": 1794, "training_iteration": 128, "trial_id": "837cb_00000", "date": "2025-06-07_19-47-45", "timestamp": 1749318465, "time_this_iter_s": 68.94888424873352, "time_total_s": 8513.470416545868, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8513.470416545868, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 64.75500000000001, "ram_util_percent": 89.1025, "gpu_util_percent0": 0.21549999999999997, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.12317e-05, "total_loss": -0.09024911335732957, "policy_loss": -0.03346470031802627, "vf_loss": 0.014021908485499973, "vf_explained_var": 0.9611772320487283, "kl": 0.019896234819480486, "entropy": 16.889726219177245, "entropy_coeff": 0.0036847549999999996}, "model": {}, "num_grad_updates_lifetime": 66315.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1892468, "num_env_steps_trained": 1892468, "num_agent_steps_sampled": 1892468, "num_agent_steps_trained": 1892468}, "sampler_results": {"episode_reward_max": 60.65259478679809, "episode_reward_min": 32.999046250534015, "episode_reward_mean": 52.66923601887575, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.35161448898319, 54.99818724831472, 51.68859109050056, 48.48602825491282, 43.142005037621246, 52.994588687731564, 55.31565453382149, 54.449063034760265, 57.35960384932311, 55.71643775280606, 56.83223234814552, 53.47372399114296, 54.99257313308863, 40.68061971893934, 53.91693448419132, 55.671092660253294, 52.15852965414842, 52.04985789131575, 41.33504015551126, 56.797977038807666, 55.8144553164056, 51.59841811333071, 56.61804036284997, 53.075807591346006, 52.55149136916833, 51.161127609159834, 57.1465998844239, 42.800432205520956, 52.52687889221154, 57.348959114939056, 54.149037579807136, 54.69045022273649, 40.715970265471675, 59.31899319501216, 58.58619019641472, 54.210385791289994, 59.61864857787733, 56.3714250639748, 56.10205562478877, 55.42378150207988, 56.78238103335465, 41.49475966877831, 57.04600429975017, 57.223848128692325, 51.0237626962811, 53.806274789689205, 43.51948452145685, 54.4376549560303, 58.72596491716561, 53.65094436357928, 59.82441052863533, 53.66327001859768, 56.75515134768211, 50.723402279286766, 53.24572883364178, 41.7394550924879, 53.15537504249377, 57.256875034001915, 50.65410085440543, 53.04032828732355, 42.75554891388384, 55.91476136775283, 58.87634506792532, 50.3279374246007, 56.138943095388754, 51.38580456144168, 56.98615725884455, 50.493567970244406, 55.68961246273255, 40.4056484651689, 56.555794272342986, 57.87772273903988, 51.06572712391842, 54.551949311788796, 39.46536861736038, 53.86296083699347, 60.51716222880261, 53.54004715972895, 57.22627939610685, 53.38919833766069, 45.34206759505605, 54.09236105749023, 54.767443788157024, 32.999046250534015, 55.35375068256463, 55.24170849415922, 50.55722098225886, 48.57807594705793, 43.479347919703635, 56.031008639023504, 60.65259478679809, 48.867704306438256, 56.144196007547606, 52.04096905940519, 54.45826646155295, 52.69121335294796, 54.799661269537346, 40.87187344990129, 52.192644422165664, 51.727230577087255], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.776092592183301, "mean_inference_ms": 7.993540087442276, "mean_action_processing_ms": 0.5633945482310163, "mean_env_wait_ms": 24.276755000900483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04171895980834961, "StateBufferConnector_ms": 0.036333560943603516, "ViewRequirementAgentConnector_ms": 0.991959810256958}}, "episode_reward_max": 60.65259478679809, "episode_reward_min": 32.999046250534015, "episode_reward_mean": 52.66923601887575, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [59.35161448898319, 54.99818724831472, 51.68859109050056, 48.48602825491282, 43.142005037621246, 52.994588687731564, 55.31565453382149, 54.449063034760265, 57.35960384932311, 55.71643775280606, 56.83223234814552, 53.47372399114296, 54.99257313308863, 40.68061971893934, 53.91693448419132, 55.671092660253294, 52.15852965414842, 52.04985789131575, 41.33504015551126, 56.797977038807666, 55.8144553164056, 51.59841811333071, 56.61804036284997, 53.075807591346006, 52.55149136916833, 51.161127609159834, 57.1465998844239, 42.800432205520956, 52.52687889221154, 57.348959114939056, 54.149037579807136, 54.69045022273649, 40.715970265471675, 59.31899319501216, 58.58619019641472, 54.210385791289994, 59.61864857787733, 56.3714250639748, 56.10205562478877, 55.42378150207988, 56.78238103335465, 41.49475966877831, 57.04600429975017, 57.223848128692325, 51.0237626962811, 53.806274789689205, 43.51948452145685, 54.4376549560303, 58.72596491716561, 53.65094436357928, 59.82441052863533, 53.66327001859768, 56.75515134768211, 50.723402279286766, 53.24572883364178, 41.7394550924879, 53.15537504249377, 57.256875034001915, 50.65410085440543, 53.04032828732355, 42.75554891388384, 55.91476136775283, 58.87634506792532, 50.3279374246007, 56.138943095388754, 51.38580456144168, 56.98615725884455, 50.493567970244406, 55.68961246273255, 40.4056484651689, 56.555794272342986, 57.87772273903988, 51.06572712391842, 54.551949311788796, 39.46536861736038, 53.86296083699347, 60.51716222880261, 53.54004715972895, 57.22627939610685, 53.38919833766069, 45.34206759505605, 54.09236105749023, 54.767443788157024, 32.999046250534015, 55.35375068256463, 55.24170849415922, 50.55722098225886, 48.57807594705793, 43.479347919703635, 56.031008639023504, 60.65259478679809, 48.867704306438256, 56.144196007547606, 52.04096905940519, 54.45826646155295, 52.69121335294796, 54.799661269537346, 40.87187344990129, 52.192644422165664, 51.727230577087255], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.776092592183301, "mean_inference_ms": 7.993540087442276, "mean_action_processing_ms": 0.5633945482310163, "mean_env_wait_ms": 24.276755000900483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04171895980834961, "StateBufferConnector_ms": 0.036333560943603516, "ViewRequirementAgentConnector_ms": 0.991959810256958}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1892468, "num_agent_steps_trained": 1892468, "num_env_steps_sampled": 1892468, "num_env_steps_trained": 1892468, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.5913655520769, "num_env_steps_trained_throughput_per_sec": 229.5913655520769, "timesteps_total": 1892468, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1892468, "timers": {"training_iteration_time_ms": 68409.936, "sample_time_ms": 42265.175, "load_time_ms": 2288.047, "load_throughput": 6834.65, "learn_time_ms": 23303.482, "learn_throughput": 671.059, "synch_weights_time_ms": 430.223}, "counters": {"num_env_steps_sampled": 1892468, "num_env_steps_trained": 1892468, "num_agent_steps_sampled": 1892468, "num_agent_steps_trained": 1892468}, "done": false, "episodes_total": 1808, "training_iteration": 129, "trial_id": "837cb_00000", "date": "2025-06-07_19-48-53", "timestamp": 1749318533, "time_this_iter_s": 68.12305951118469, "time_total_s": 8581.593476057053, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8581.593476057053, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 64.33076923076923, "ram_util_percent": 89.6679487179487, "gpu_util_percent0": 0.21910256410256415, "vram_util_percent0": 0.9650065104166671}}
{"evaluation": {"sampler_results": {"episode_reward_max": 1.9344240276947682, "episode_reward_min": 1.232404250388821, "episode_reward_mean": 1.5254537988678496, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.9344240276947682, 1.6797164450860063, 1.4781027543903469, 1.232404250388821, 1.3026215167793063], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8761816775058286, "mean_inference_ms": 4.029102642772768, "mean_action_processing_ms": 0.2918560542188035, "mean_env_wait_ms": 12.45277434844116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 1.0821771621704102}}, "episode_reward_max": 1.9344240276947682, "episode_reward_min": 1.232404250388821, "episode_reward_mean": 1.5254537988678496, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.9344240276947682, 1.6797164450860063, 1.4781027543903469, 1.232404250388821, 1.3026215167793063], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8761816775058286, "mean_inference_ms": 4.029102642772768, "mean_action_processing_ms": 0.2918560542188035, "mean_env_wait_ms": 12.45277434844116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 1.0821771621704102}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.107532000000003e-05, "total_loss": -0.09392897274853154, "policy_loss": -0.03692341513881812, "vf_loss": 0.012628607559017837, "vf_explained_var": 0.96399026426402, "kl": 0.019306733673517804, "entropy": 16.934106381156226, "entropy_coeff": 0.003661298}, "model": {}, "num_grad_updates_lifetime": 66865.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1908106, "num_env_steps_trained": 1908106, "num_agent_steps_sampled": 1908106, "num_agent_steps_trained": 1908106}, "sampler_results": {"episode_reward_max": 60.65259478679809, "episode_reward_min": 32.999046250534015, "episode_reward_mean": 52.59472263868064, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.91693448419132, 55.671092660253294, 52.15852965414842, 52.04985789131575, 41.33504015551126, 56.797977038807666, 55.8144553164056, 51.59841811333071, 56.61804036284997, 53.075807591346006, 52.55149136916833, 51.161127609159834, 57.1465998844239, 42.800432205520956, 52.52687889221154, 57.348959114939056, 54.149037579807136, 54.69045022273649, 40.715970265471675, 59.31899319501216, 58.58619019641472, 54.210385791289994, 59.61864857787733, 56.3714250639748, 56.10205562478877, 55.42378150207988, 56.78238103335465, 41.49475966877831, 57.04600429975017, 57.223848128692325, 51.0237626962811, 53.806274789689205, 43.51948452145685, 54.4376549560303, 58.72596491716561, 53.65094436357928, 59.82441052863533, 53.66327001859768, 56.75515134768211, 50.723402279286766, 53.24572883364178, 41.7394550924879, 53.15537504249377, 57.256875034001915, 50.65410085440543, 53.04032828732355, 42.75554891388384, 55.91476136775283, 58.87634506792532, 50.3279374246007, 56.138943095388754, 51.38580456144168, 56.98615725884455, 50.493567970244406, 55.68961246273255, 40.4056484651689, 56.555794272342986, 57.87772273903988, 51.06572712391842, 54.551949311788796, 39.46536861736038, 53.86296083699347, 60.51716222880261, 53.54004715972895, 57.22627939610685, 53.38919833766069, 45.34206759505605, 54.09236105749023, 54.767443788157024, 32.999046250534015, 55.35375068256463, 55.24170849415922, 50.55722098225886, 48.57807594705793, 43.479347919703635, 56.031008639023504, 60.65259478679809, 48.867704306438256, 56.144196007547606, 52.04096905940519, 54.45826646155295, 52.69121335294796, 54.799661269537346, 40.87187344990129, 52.192644422165664, 51.727230577087255, 49.03263948951135, 51.04302202732159, 42.40687662053414, 53.48822486405374, 58.09860278923767, 50.153354106279174, 56.51104666960743, 56.52239416807577, 56.03005097585298, 56.08118973494176, 58.092361203638745, 38.51512636579859, 50.06325599399008, 55.991440141736355], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7756432083550324, "mean_inference_ms": 7.992963367779703, "mean_action_processing_ms": 0.563281595302056, "mean_env_wait_ms": 24.279429075502684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041207313537597656, "StateBufferConnector_ms": 0.035887956619262695, "ViewRequirementAgentConnector_ms": 0.9424664974212646}}, "episode_reward_max": 60.65259478679809, "episode_reward_min": 32.999046250534015, "episode_reward_mean": 52.59472263868064, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.91693448419132, 55.671092660253294, 52.15852965414842, 52.04985789131575, 41.33504015551126, 56.797977038807666, 55.8144553164056, 51.59841811333071, 56.61804036284997, 53.075807591346006, 52.55149136916833, 51.161127609159834, 57.1465998844239, 42.800432205520956, 52.52687889221154, 57.348959114939056, 54.149037579807136, 54.69045022273649, 40.715970265471675, 59.31899319501216, 58.58619019641472, 54.210385791289994, 59.61864857787733, 56.3714250639748, 56.10205562478877, 55.42378150207988, 56.78238103335465, 41.49475966877831, 57.04600429975017, 57.223848128692325, 51.0237626962811, 53.806274789689205, 43.51948452145685, 54.4376549560303, 58.72596491716561, 53.65094436357928, 59.82441052863533, 53.66327001859768, 56.75515134768211, 50.723402279286766, 53.24572883364178, 41.7394550924879, 53.15537504249377, 57.256875034001915, 50.65410085440543, 53.04032828732355, 42.75554891388384, 55.91476136775283, 58.87634506792532, 50.3279374246007, 56.138943095388754, 51.38580456144168, 56.98615725884455, 50.493567970244406, 55.68961246273255, 40.4056484651689, 56.555794272342986, 57.87772273903988, 51.06572712391842, 54.551949311788796, 39.46536861736038, 53.86296083699347, 60.51716222880261, 53.54004715972895, 57.22627939610685, 53.38919833766069, 45.34206759505605, 54.09236105749023, 54.767443788157024, 32.999046250534015, 55.35375068256463, 55.24170849415922, 50.55722098225886, 48.57807594705793, 43.479347919703635, 56.031008639023504, 60.65259478679809, 48.867704306438256, 56.144196007547606, 52.04096905940519, 54.45826646155295, 52.69121335294796, 54.799661269537346, 40.87187344990129, 52.192644422165664, 51.727230577087255, 49.03263948951135, 51.04302202732159, 42.40687662053414, 53.48822486405374, 58.09860278923767, 50.153354106279174, 56.51104666960743, 56.52239416807577, 56.03005097585298, 56.08118973494176, 58.092361203638745, 38.51512636579859, 50.06325599399008, 55.991440141736355], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7756432083550324, "mean_inference_ms": 7.992963367779703, "mean_action_processing_ms": 0.563281595302056, "mean_env_wait_ms": 24.279429075502684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041207313537597656, "StateBufferConnector_ms": 0.035887956619262695, "ViewRequirementAgentConnector_ms": 0.9424664974212646}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1908106, "num_agent_steps_trained": 1908106, "num_env_steps_sampled": 1908106, "num_env_steps_trained": 1908106, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 222.96143388581083, "num_env_steps_trained_throughput_per_sec": 222.96143388581083, "timesteps_total": 1908106, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1908106, "timers": {"training_iteration_time_ms": 68677.788, "sample_time_ms": 42459.974, "load_time_ms": 2291.595, "load_throughput": 6824.069, "learn_time_ms": 23340.666, "learn_throughput": 669.989, "synch_weights_time_ms": 458.393}, "counters": {"num_env_steps_sampled": 1908106, "num_env_steps_trained": 1908106, "num_agent_steps_sampled": 1908106, "num_agent_steps_trained": 1908106}, "done": false, "episodes_total": 1822, "training_iteration": 130, "trial_id": "837cb_00000", "date": "2025-06-07_19-50-19", "timestamp": 1749318619, "time_this_iter_s": 85.37214708328247, "time_total_s": 8666.965623140335, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8666.965623140335, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 57.09591836734695, "ram_util_percent": 89.08571428571429, "gpu_util_percent0": 0.17367346938775513, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.091894000000001e-05, "total_loss": -0.07024958988524635, "policy_loss": -0.013939059917756822, "vf_loss": 0.014480965763161128, "vf_explained_var": 0.9583636682683772, "kl": 0.02004060216417367, "entropy": 17.01760955810547, "entropy_coeff": 0.0036378409999999993}, "model": {}, "num_grad_updates_lifetime": 67415.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1923744, "num_env_steps_trained": 1923744, "num_agent_steps_sampled": 1923744, "num_agent_steps_trained": 1923744}, "sampler_results": {"episode_reward_max": 60.65259478679809, "episode_reward_min": 32.999046250534015, "episode_reward_mean": 52.330318432639366, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.52687889221154, 57.348959114939056, 54.149037579807136, 54.69045022273649, 40.715970265471675, 59.31899319501216, 58.58619019641472, 54.210385791289994, 59.61864857787733, 56.3714250639748, 56.10205562478877, 55.42378150207988, 56.78238103335465, 41.49475966877831, 57.04600429975017, 57.223848128692325, 51.0237626962811, 53.806274789689205, 43.51948452145685, 54.4376549560303, 58.72596491716561, 53.65094436357928, 59.82441052863533, 53.66327001859768, 56.75515134768211, 50.723402279286766, 53.24572883364178, 41.7394550924879, 53.15537504249377, 57.256875034001915, 50.65410085440543, 53.04032828732355, 42.75554891388384, 55.91476136775283, 58.87634506792532, 50.3279374246007, 56.138943095388754, 51.38580456144168, 56.98615725884455, 50.493567970244406, 55.68961246273255, 40.4056484651689, 56.555794272342986, 57.87772273903988, 51.06572712391842, 54.551949311788796, 39.46536861736038, 53.86296083699347, 60.51716222880261, 53.54004715972895, 57.22627939610685, 53.38919833766069, 45.34206759505605, 54.09236105749023, 54.767443788157024, 32.999046250534015, 55.35375068256463, 55.24170849415922, 50.55722098225886, 48.57807594705793, 43.479347919703635, 56.031008639023504, 60.65259478679809, 48.867704306438256, 56.144196007547606, 52.04096905940519, 54.45826646155295, 52.69121335294796, 54.799661269537346, 40.87187344990129, 52.192644422165664, 51.727230577087255, 49.03263948951135, 51.04302202732159, 42.40687662053414, 53.48822486405374, 58.09860278923767, 50.153354106279174, 56.51104666960743, 56.52239416807577, 56.03005097585298, 56.08118973494176, 58.092361203638745, 38.51512636579859, 50.06325599399008, 55.991440141736355, 47.82409299873795, 52.707798977470546, 38.593503694515576, 52.41719828523105, 56.15902397703734, 49.717672423015415, 54.973894579018435, 54.58489650582444, 53.816675386128644, 48.9989681272744, 52.19617027602857, 41.931003800931215, 54.98427663993257, 47.35020806116139], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7749610713860218, "mean_inference_ms": 7.992609869728529, "mean_action_processing_ms": 0.5632006237262902, "mean_env_wait_ms": 24.28213953748707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04022479057312012, "StateBufferConnector_ms": 0.03185915946960449, "ViewRequirementAgentConnector_ms": 0.9661955833435059}}, "episode_reward_max": 60.65259478679809, "episode_reward_min": 32.999046250534015, "episode_reward_mean": 52.330318432639366, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.52687889221154, 57.348959114939056, 54.149037579807136, 54.69045022273649, 40.715970265471675, 59.31899319501216, 58.58619019641472, 54.210385791289994, 59.61864857787733, 56.3714250639748, 56.10205562478877, 55.42378150207988, 56.78238103335465, 41.49475966877831, 57.04600429975017, 57.223848128692325, 51.0237626962811, 53.806274789689205, 43.51948452145685, 54.4376549560303, 58.72596491716561, 53.65094436357928, 59.82441052863533, 53.66327001859768, 56.75515134768211, 50.723402279286766, 53.24572883364178, 41.7394550924879, 53.15537504249377, 57.256875034001915, 50.65410085440543, 53.04032828732355, 42.75554891388384, 55.91476136775283, 58.87634506792532, 50.3279374246007, 56.138943095388754, 51.38580456144168, 56.98615725884455, 50.493567970244406, 55.68961246273255, 40.4056484651689, 56.555794272342986, 57.87772273903988, 51.06572712391842, 54.551949311788796, 39.46536861736038, 53.86296083699347, 60.51716222880261, 53.54004715972895, 57.22627939610685, 53.38919833766069, 45.34206759505605, 54.09236105749023, 54.767443788157024, 32.999046250534015, 55.35375068256463, 55.24170849415922, 50.55722098225886, 48.57807594705793, 43.479347919703635, 56.031008639023504, 60.65259478679809, 48.867704306438256, 56.144196007547606, 52.04096905940519, 54.45826646155295, 52.69121335294796, 54.799661269537346, 40.87187344990129, 52.192644422165664, 51.727230577087255, 49.03263948951135, 51.04302202732159, 42.40687662053414, 53.48822486405374, 58.09860278923767, 50.153354106279174, 56.51104666960743, 56.52239416807577, 56.03005097585298, 56.08118973494176, 58.092361203638745, 38.51512636579859, 50.06325599399008, 55.991440141736355, 47.82409299873795, 52.707798977470546, 38.593503694515576, 52.41719828523105, 56.15902397703734, 49.717672423015415, 54.973894579018435, 54.58489650582444, 53.816675386128644, 48.9989681272744, 52.19617027602857, 41.931003800931215, 54.98427663993257, 47.35020806116139], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7749610713860218, "mean_inference_ms": 7.992609869728529, "mean_action_processing_ms": 0.5632006237262902, "mean_env_wait_ms": 24.28213953748707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04022479057312012, "StateBufferConnector_ms": 0.03185915946960449, "ViewRequirementAgentConnector_ms": 0.9661955833435059}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1923744, "num_agent_steps_trained": 1923744, "num_env_steps_sampled": 1923744, "num_env_steps_trained": 1923744, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.02877760589712, "num_env_steps_trained_throughput_per_sec": 228.02877760589712, "timesteps_total": 1923744, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1923744, "timers": {"training_iteration_time_ms": 68663.07, "sample_time_ms": 42442.602, "load_time_ms": 2287.964, "load_throughput": 6834.899, "learn_time_ms": 23342.533, "learn_throughput": 669.936, "synch_weights_time_ms": 461.664}, "counters": {"num_env_steps_sampled": 1923744, "num_env_steps_trained": 1923744, "num_agent_steps_sampled": 1923744, "num_agent_steps_trained": 1923744}, "done": false, "episodes_total": 1836, "training_iteration": 131, "trial_id": "837cb_00000", "date": "2025-06-07_19-51-28", "timestamp": 1749318688, "time_this_iter_s": 68.60833382606506, "time_total_s": 8735.5739569664, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8735.5739569664, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 64.32784810126581, "ram_util_percent": 90.14683544303793, "gpu_util_percent0": 0.21430379746835448, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.076255999999998e-05, "total_loss": -0.08960579972020985, "policy_loss": -0.033039857827957764, "vf_loss": 0.012584843153387985, "vf_explained_var": 0.9678736866604198, "kl": 0.019948293212805286, "entropy": 17.0397393989563, "entropy_coeff": 0.0036143839999999996}, "model": {}, "num_grad_updates_lifetime": 67965.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1939382, "num_env_steps_trained": 1939382, "num_agent_steps_sampled": 1939382, "num_agent_steps_trained": 1939382}, "sampler_results": {"episode_reward_max": 60.65259478679809, "episode_reward_min": 32.999046250534015, "episode_reward_mean": 52.112692323931405, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.04600429975017, 57.223848128692325, 51.0237626962811, 53.806274789689205, 43.51948452145685, 54.4376549560303, 58.72596491716561, 53.65094436357928, 59.82441052863533, 53.66327001859768, 56.75515134768211, 50.723402279286766, 53.24572883364178, 41.7394550924879, 53.15537504249377, 57.256875034001915, 50.65410085440543, 53.04032828732355, 42.75554891388384, 55.91476136775283, 58.87634506792532, 50.3279374246007, 56.138943095388754, 51.38580456144168, 56.98615725884455, 50.493567970244406, 55.68961246273255, 40.4056484651689, 56.555794272342986, 57.87772273903988, 51.06572712391842, 54.551949311788796, 39.46536861736038, 53.86296083699347, 60.51716222880261, 53.54004715972895, 57.22627939610685, 53.38919833766069, 45.34206759505605, 54.09236105749023, 54.767443788157024, 32.999046250534015, 55.35375068256463, 55.24170849415922, 50.55722098225886, 48.57807594705793, 43.479347919703635, 56.031008639023504, 60.65259478679809, 48.867704306438256, 56.144196007547606, 52.04096905940519, 54.45826646155295, 52.69121335294796, 54.799661269537346, 40.87187344990129, 52.192644422165664, 51.727230577087255, 49.03263948951135, 51.04302202732159, 42.40687662053414, 53.48822486405374, 58.09860278923767, 50.153354106279174, 56.51104666960743, 56.52239416807577, 56.03005097585298, 56.08118973494176, 58.092361203638745, 38.51512636579859, 50.06325599399008, 55.991440141736355, 47.82409299873795, 52.707798977470546, 38.593503694515576, 52.41719828523105, 56.15902397703734, 49.717672423015415, 54.973894579018435, 54.58489650582444, 53.816675386128644, 48.9989681272744, 52.19617027602857, 41.931003800931215, 54.98427663993257, 47.35020806116139, 51.13980876078449, 53.46790733543907, 39.72233457469714, 55.86626227234863, 56.92080487356304, 52.625979957566926, 59.5137230861955, 52.07174657299393, 57.370004186262896, 51.018188116367554, 51.69473256157278, 41.08552500898405, 54.406176736875445, 58.6741118142864], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.774309534809059, "mean_inference_ms": 7.992172764481779, "mean_action_processing_ms": 0.5631148069407902, "mean_env_wait_ms": 24.28448021395106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03722953796386719, "StateBufferConnector_ms": 0.032807111740112305, "ViewRequirementAgentConnector_ms": 0.9796853065490723}}, "episode_reward_max": 60.65259478679809, "episode_reward_min": 32.999046250534015, "episode_reward_mean": 52.112692323931405, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [57.04600429975017, 57.223848128692325, 51.0237626962811, 53.806274789689205, 43.51948452145685, 54.4376549560303, 58.72596491716561, 53.65094436357928, 59.82441052863533, 53.66327001859768, 56.75515134768211, 50.723402279286766, 53.24572883364178, 41.7394550924879, 53.15537504249377, 57.256875034001915, 50.65410085440543, 53.04032828732355, 42.75554891388384, 55.91476136775283, 58.87634506792532, 50.3279374246007, 56.138943095388754, 51.38580456144168, 56.98615725884455, 50.493567970244406, 55.68961246273255, 40.4056484651689, 56.555794272342986, 57.87772273903988, 51.06572712391842, 54.551949311788796, 39.46536861736038, 53.86296083699347, 60.51716222880261, 53.54004715972895, 57.22627939610685, 53.38919833766069, 45.34206759505605, 54.09236105749023, 54.767443788157024, 32.999046250534015, 55.35375068256463, 55.24170849415922, 50.55722098225886, 48.57807594705793, 43.479347919703635, 56.031008639023504, 60.65259478679809, 48.867704306438256, 56.144196007547606, 52.04096905940519, 54.45826646155295, 52.69121335294796, 54.799661269537346, 40.87187344990129, 52.192644422165664, 51.727230577087255, 49.03263948951135, 51.04302202732159, 42.40687662053414, 53.48822486405374, 58.09860278923767, 50.153354106279174, 56.51104666960743, 56.52239416807577, 56.03005097585298, 56.08118973494176, 58.092361203638745, 38.51512636579859, 50.06325599399008, 55.991440141736355, 47.82409299873795, 52.707798977470546, 38.593503694515576, 52.41719828523105, 56.15902397703734, 49.717672423015415, 54.973894579018435, 54.58489650582444, 53.816675386128644, 48.9989681272744, 52.19617027602857, 41.931003800931215, 54.98427663993257, 47.35020806116139, 51.13980876078449, 53.46790733543907, 39.72233457469714, 55.86626227234863, 56.92080487356304, 52.625979957566926, 59.5137230861955, 52.07174657299393, 57.370004186262896, 51.018188116367554, 51.69473256157278, 41.08552500898405, 54.406176736875445, 58.6741118142864], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.774309534809059, "mean_inference_ms": 7.992172764481779, "mean_action_processing_ms": 0.5631148069407902, "mean_env_wait_ms": 24.28448021395106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03722953796386719, "StateBufferConnector_ms": 0.032807111740112305, "ViewRequirementAgentConnector_ms": 0.9796853065490723}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1939382, "num_agent_steps_trained": 1939382, "num_env_steps_sampled": 1939382, "num_env_steps_trained": 1939382, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.3648161872199, "num_env_steps_trained_throughput_per_sec": 229.3648161872199, "timesteps_total": 1939382, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1939382, "timers": {"training_iteration_time_ms": 68656.928, "sample_time_ms": 42411.146, "load_time_ms": 2305.279, "load_throughput": 6783.56, "learn_time_ms": 23351.831, "learn_throughput": 669.669, "synch_weights_time_ms": 459.442}, "counters": {"num_env_steps_sampled": 1939382, "num_env_steps_trained": 1939382, "num_agent_steps_sampled": 1939382, "num_agent_steps_trained": 1939382}, "done": false, "episodes_total": 1850, "training_iteration": 132, "trial_id": "837cb_00000", "date": "2025-06-07_19-52-36", "timestamp": 1749318756, "time_this_iter_s": 68.22912430763245, "time_total_s": 8803.803081274033, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8803.803081274033, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 64.20256410256411, "ram_util_percent": 90.12820512820514, "gpu_util_percent0": 0.2248717948717949, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.060618000000002e-05, "total_loss": -0.09368669154439968, "policy_loss": -0.037540331881239335, "vf_loss": 0.012902406147596511, "vf_explained_var": 0.9642284398729151, "kl": 0.019893328187119384, "entropy": 17.05977768464522, "entropy_coeff": 0.0035909270000000003}, "model": {}, "num_grad_updates_lifetime": 68515.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1955020, "num_env_steps_trained": 1955020, "num_agent_steps_sampled": 1955020, "num_agent_steps_trained": 1955020}, "sampler_results": {"episode_reward_max": 61.9312540616051, "episode_reward_min": 32.999046250534015, "episode_reward_mean": 51.948630521598744, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.15537504249377, 57.256875034001915, 50.65410085440543, 53.04032828732355, 42.75554891388384, 55.91476136775283, 58.87634506792532, 50.3279374246007, 56.138943095388754, 51.38580456144168, 56.98615725884455, 50.493567970244406, 55.68961246273255, 40.4056484651689, 56.555794272342986, 57.87772273903988, 51.06572712391842, 54.551949311788796, 39.46536861736038, 53.86296083699347, 60.51716222880261, 53.54004715972895, 57.22627939610685, 53.38919833766069, 45.34206759505605, 54.09236105749023, 54.767443788157024, 32.999046250534015, 55.35375068256463, 55.24170849415922, 50.55722098225886, 48.57807594705793, 43.479347919703635, 56.031008639023504, 60.65259478679809, 48.867704306438256, 56.144196007547606, 52.04096905940519, 54.45826646155295, 52.69121335294796, 54.799661269537346, 40.87187344990129, 52.192644422165664, 51.727230577087255, 49.03263948951135, 51.04302202732159, 42.40687662053414, 53.48822486405374, 58.09860278923767, 50.153354106279174, 56.51104666960743, 56.52239416807577, 56.03005097585298, 56.08118973494176, 58.092361203638745, 38.51512636579859, 50.06325599399008, 55.991440141736355, 47.82409299873795, 52.707798977470546, 38.593503694515576, 52.41719828523105, 56.15902397703734, 49.717672423015415, 54.973894579018435, 54.58489650582444, 53.816675386128644, 48.9989681272744, 52.19617027602857, 41.931003800931215, 54.98427663993257, 47.35020806116139, 51.13980876078449, 53.46790733543907, 39.72233457469714, 55.86626227234863, 56.92080487356304, 52.625979957566926, 59.5137230861955, 52.07174657299393, 57.370004186262896, 51.018188116367554, 51.69473256157278, 41.08552500898405, 54.406176736875445, 58.6741118142864, 47.64900725487272, 51.042731381004195, 42.079041008851014, 54.99334264414182, 55.41530715599226, 51.32337038600384, 61.9312540616051, 51.60114847059189, 57.19863818838762, 54.190216242525814, 55.71763324584224, 41.07344078489943, 50.047200397336034, 54.716845317658404], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.773534752347834, "mean_inference_ms": 7.991629283910183, "mean_action_processing_ms": 0.5630325551672718, "mean_env_wait_ms": 24.28677772788054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03611016273498535, "StateBufferConnector_ms": 0.02968120574951172, "ViewRequirementAgentConnector_ms": 0.9932332038879395}}, "episode_reward_max": 61.9312540616051, "episode_reward_min": 32.999046250534015, "episode_reward_mean": 51.948630521598744, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.15537504249377, 57.256875034001915, 50.65410085440543, 53.04032828732355, 42.75554891388384, 55.91476136775283, 58.87634506792532, 50.3279374246007, 56.138943095388754, 51.38580456144168, 56.98615725884455, 50.493567970244406, 55.68961246273255, 40.4056484651689, 56.555794272342986, 57.87772273903988, 51.06572712391842, 54.551949311788796, 39.46536861736038, 53.86296083699347, 60.51716222880261, 53.54004715972895, 57.22627939610685, 53.38919833766069, 45.34206759505605, 54.09236105749023, 54.767443788157024, 32.999046250534015, 55.35375068256463, 55.24170849415922, 50.55722098225886, 48.57807594705793, 43.479347919703635, 56.031008639023504, 60.65259478679809, 48.867704306438256, 56.144196007547606, 52.04096905940519, 54.45826646155295, 52.69121335294796, 54.799661269537346, 40.87187344990129, 52.192644422165664, 51.727230577087255, 49.03263948951135, 51.04302202732159, 42.40687662053414, 53.48822486405374, 58.09860278923767, 50.153354106279174, 56.51104666960743, 56.52239416807577, 56.03005097585298, 56.08118973494176, 58.092361203638745, 38.51512636579859, 50.06325599399008, 55.991440141736355, 47.82409299873795, 52.707798977470546, 38.593503694515576, 52.41719828523105, 56.15902397703734, 49.717672423015415, 54.973894579018435, 54.58489650582444, 53.816675386128644, 48.9989681272744, 52.19617027602857, 41.931003800931215, 54.98427663993257, 47.35020806116139, 51.13980876078449, 53.46790733543907, 39.72233457469714, 55.86626227234863, 56.92080487356304, 52.625979957566926, 59.5137230861955, 52.07174657299393, 57.370004186262896, 51.018188116367554, 51.69473256157278, 41.08552500898405, 54.406176736875445, 58.6741118142864, 47.64900725487272, 51.042731381004195, 42.079041008851014, 54.99334264414182, 55.41530715599226, 51.32337038600384, 61.9312540616051, 51.60114847059189, 57.19863818838762, 54.190216242525814, 55.71763324584224, 41.07344078489943, 50.047200397336034, 54.716845317658404], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.773534752347834, "mean_inference_ms": 7.991629283910183, "mean_action_processing_ms": 0.5630325551672718, "mean_env_wait_ms": 24.28677772788054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03611016273498535, "StateBufferConnector_ms": 0.02968120574951172, "ViewRequirementAgentConnector_ms": 0.9932332038879395}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1955020, "num_agent_steps_trained": 1955020, "num_env_steps_sampled": 1955020, "num_env_steps_trained": 1955020, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.5137674946201, "num_env_steps_trained_throughput_per_sec": 229.5137674946201, "timesteps_total": 1955020, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1955020, "timers": {"training_iteration_time_ms": 68613.626, "sample_time_ms": 42388.101, "load_time_ms": 2288.087, "load_throughput": 6834.529, "learn_time_ms": 23336.98, "learn_throughput": 670.095, "synch_weights_time_ms": 470.516}, "counters": {"num_env_steps_sampled": 1955020, "num_env_steps_trained": 1955020, "num_agent_steps_sampled": 1955020, "num_agent_steps_trained": 1955020}, "done": false, "episodes_total": 1864, "training_iteration": 133, "trial_id": "837cb_00000", "date": "2025-06-07_19-53-44", "timestamp": 1749318824, "time_this_iter_s": 68.14452719688416, "time_total_s": 8871.947608470917, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8871.947608470917, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 64.7102564102564, "ram_util_percent": 89.34102564102561, "gpu_util_percent0": 0.21833333333333335, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.044979999999999e-05, "total_loss": -0.07707416088584895, "policy_loss": -0.021461391778853298, "vf_loss": 0.013510405158793384, "vf_explained_var": 0.9591471570188349, "kl": 0.019862494366455145, "entropy": 17.072966851321134, "entropy_coeff": 0.00356747}, "model": {}, "num_grad_updates_lifetime": 69065.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1970658, "num_env_steps_trained": 1970658, "num_agent_steps_sampled": 1970658, "num_agent_steps_trained": 1970658}, "sampler_results": {"episode_reward_max": 61.9312540616051, "episode_reward_min": 32.999046250534015, "episode_reward_mean": 51.84099399237841, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.555794272342986, 57.87772273903988, 51.06572712391842, 54.551949311788796, 39.46536861736038, 53.86296083699347, 60.51716222880261, 53.54004715972895, 57.22627939610685, 53.38919833766069, 45.34206759505605, 54.09236105749023, 54.767443788157024, 32.999046250534015, 55.35375068256463, 55.24170849415922, 50.55722098225886, 48.57807594705793, 43.479347919703635, 56.031008639023504, 60.65259478679809, 48.867704306438256, 56.144196007547606, 52.04096905940519, 54.45826646155295, 52.69121335294796, 54.799661269537346, 40.87187344990129, 52.192644422165664, 51.727230577087255, 49.03263948951135, 51.04302202732159, 42.40687662053414, 53.48822486405374, 58.09860278923767, 50.153354106279174, 56.51104666960743, 56.52239416807577, 56.03005097585298, 56.08118973494176, 58.092361203638745, 38.51512636579859, 50.06325599399008, 55.991440141736355, 47.82409299873795, 52.707798977470546, 38.593503694515576, 52.41719828523105, 56.15902397703734, 49.717672423015415, 54.973894579018435, 54.58489650582444, 53.816675386128644, 48.9989681272744, 52.19617027602857, 41.931003800931215, 54.98427663993257, 47.35020806116139, 51.13980876078449, 53.46790733543907, 39.72233457469714, 55.86626227234863, 56.92080487356304, 52.625979957566926, 59.5137230861955, 52.07174657299393, 57.370004186262896, 51.018188116367554, 51.69473256157278, 41.08552500898405, 54.406176736875445, 58.6741118142864, 47.64900725487272, 51.042731381004195, 42.079041008851014, 54.99334264414182, 55.41530715599226, 51.32337038600384, 61.9312540616051, 51.60114847059189, 57.19863818838762, 54.190216242525814, 55.71763324584224, 41.07344078489943, 50.047200397336034, 54.716845317658404, 48.59223405229549, 52.23908135796429, 40.77304661661331, 54.32446733968094, 53.1204991230164, 50.94833226248781, 60.524217231185766, 51.56576667322966, 57.4909262965025, 52.0182047549899, 52.26784176047488, 40.973110583670504, 50.82697533321146, 56.65264949884996], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.772979425634661, "mean_inference_ms": 7.991180562582977, "mean_action_processing_ms": 0.5629626291036011, "mean_env_wait_ms": 24.288914907639555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03753185272216797, "StateBufferConnector_ms": 0.026175975799560547, "ViewRequirementAgentConnector_ms": 1.000458002090454}}, "episode_reward_max": 61.9312540616051, "episode_reward_min": 32.999046250534015, "episode_reward_mean": 51.84099399237841, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [56.555794272342986, 57.87772273903988, 51.06572712391842, 54.551949311788796, 39.46536861736038, 53.86296083699347, 60.51716222880261, 53.54004715972895, 57.22627939610685, 53.38919833766069, 45.34206759505605, 54.09236105749023, 54.767443788157024, 32.999046250534015, 55.35375068256463, 55.24170849415922, 50.55722098225886, 48.57807594705793, 43.479347919703635, 56.031008639023504, 60.65259478679809, 48.867704306438256, 56.144196007547606, 52.04096905940519, 54.45826646155295, 52.69121335294796, 54.799661269537346, 40.87187344990129, 52.192644422165664, 51.727230577087255, 49.03263948951135, 51.04302202732159, 42.40687662053414, 53.48822486405374, 58.09860278923767, 50.153354106279174, 56.51104666960743, 56.52239416807577, 56.03005097585298, 56.08118973494176, 58.092361203638745, 38.51512636579859, 50.06325599399008, 55.991440141736355, 47.82409299873795, 52.707798977470546, 38.593503694515576, 52.41719828523105, 56.15902397703734, 49.717672423015415, 54.973894579018435, 54.58489650582444, 53.816675386128644, 48.9989681272744, 52.19617027602857, 41.931003800931215, 54.98427663993257, 47.35020806116139, 51.13980876078449, 53.46790733543907, 39.72233457469714, 55.86626227234863, 56.92080487356304, 52.625979957566926, 59.5137230861955, 52.07174657299393, 57.370004186262896, 51.018188116367554, 51.69473256157278, 41.08552500898405, 54.406176736875445, 58.6741118142864, 47.64900725487272, 51.042731381004195, 42.079041008851014, 54.99334264414182, 55.41530715599226, 51.32337038600384, 61.9312540616051, 51.60114847059189, 57.19863818838762, 54.190216242525814, 55.71763324584224, 41.07344078489943, 50.047200397336034, 54.716845317658404, 48.59223405229549, 52.23908135796429, 40.77304661661331, 54.32446733968094, 53.1204991230164, 50.94833226248781, 60.524217231185766, 51.56576667322966, 57.4909262965025, 52.0182047549899, 52.26784176047488, 40.973110583670504, 50.82697533321146, 56.65264949884996], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.772979425634661, "mean_inference_ms": 7.991180562582977, "mean_action_processing_ms": 0.5629626291036011, "mean_env_wait_ms": 24.288914907639555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03753185272216797, "StateBufferConnector_ms": 0.026175975799560547, "ViewRequirementAgentConnector_ms": 1.000458002090454}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1970658, "num_agent_steps_trained": 1970658, "num_env_steps_sampled": 1970658, "num_env_steps_trained": 1970658, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 224.8266128270832, "num_env_steps_trained_throughput_per_sec": 224.8266128270832, "timesteps_total": 1970658, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1970658, "timers": {"training_iteration_time_ms": 68745.566, "sample_time_ms": 42413.964, "load_time_ms": 2402.618, "load_throughput": 6508.733, "learn_time_ms": 23330.032, "learn_throughput": 670.295, "synch_weights_time_ms": 469.542}, "counters": {"num_env_steps_sampled": 1970658, "num_env_steps_trained": 1970658, "num_agent_steps_sampled": 1970658, "num_agent_steps_trained": 1970658}, "done": false, "episodes_total": 1878, "training_iteration": 134, "trial_id": "837cb_00000", "date": "2025-06-07_19-54-54", "timestamp": 1749318894, "time_this_iter_s": 69.57099294662476, "time_total_s": 8941.518601417542, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8941.518601417542, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 64.23291139240507, "ram_util_percent": 88.64810126582282, "gpu_util_percent0": 0.21481012658227847, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.029342e-05, "total_loss": -0.05443710784046826, "policy_loss": 0.0008372857472435995, "vf_loss": 0.013158886148594319, "vf_explained_var": 0.9650564388795333, "kl": 0.020636127925143907, "entropy": 17.07437777779319, "entropy_coeff": 0.003544013}, "model": {}, "num_grad_updates_lifetime": 69615.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1986296, "num_env_steps_trained": 1986296, "num_agent_steps_sampled": 1986296, "num_agent_steps_trained": 1986296}, "sampler_results": {"episode_reward_max": 61.9312540616051, "episode_reward_min": 38.51512636579859, "episode_reward_mean": 51.70915092659247, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.35375068256463, 55.24170849415922, 50.55722098225886, 48.57807594705793, 43.479347919703635, 56.031008639023504, 60.65259478679809, 48.867704306438256, 56.144196007547606, 52.04096905940519, 54.45826646155295, 52.69121335294796, 54.799661269537346, 40.87187344990129, 52.192644422165664, 51.727230577087255, 49.03263948951135, 51.04302202732159, 42.40687662053414, 53.48822486405374, 58.09860278923767, 50.153354106279174, 56.51104666960743, 56.52239416807577, 56.03005097585298, 56.08118973494176, 58.092361203638745, 38.51512636579859, 50.06325599399008, 55.991440141736355, 47.82409299873795, 52.707798977470546, 38.593503694515576, 52.41719828523105, 56.15902397703734, 49.717672423015415, 54.973894579018435, 54.58489650582444, 53.816675386128644, 48.9989681272744, 52.19617027602857, 41.931003800931215, 54.98427663993257, 47.35020806116139, 51.13980876078449, 53.46790733543907, 39.72233457469714, 55.86626227234863, 56.92080487356304, 52.625979957566926, 59.5137230861955, 52.07174657299393, 57.370004186262896, 51.018188116367554, 51.69473256157278, 41.08552500898405, 54.406176736875445, 58.6741118142864, 47.64900725487272, 51.042731381004195, 42.079041008851014, 54.99334264414182, 55.41530715599226, 51.32337038600384, 61.9312540616051, 51.60114847059189, 57.19863818838762, 54.190216242525814, 55.71763324584224, 41.07344078489943, 50.047200397336034, 54.716845317658404, 48.59223405229549, 52.23908135796429, 40.77304661661331, 54.32446733968094, 53.1204991230164, 50.94833226248781, 60.524217231185766, 51.56576667322966, 57.4909262965025, 52.0182047549899, 52.26784176047488, 40.973110583670504, 50.82697533321146, 56.65264949884996, 52.60017877338045, 51.46089085176525, 41.35916103062125, 52.78138608386329, 55.52631276435756, 50.484599061378944, 57.52971342418116, 49.58733688245447, 54.80547416696039, 53.03531649712505, 48.59200742045564, 42.03709872793256, 47.271226762520314, 54.99811968939071], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.772355494046886, "mean_inference_ms": 7.990686994719777, "mean_action_processing_ms": 0.562873614039923, "mean_env_wait_ms": 24.290885229621082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03647494316101074, "StateBufferConnector_ms": 0.0262906551361084, "ViewRequirementAgentConnector_ms": 1.0164422988891602}}, "episode_reward_max": 61.9312540616051, "episode_reward_min": 38.51512636579859, "episode_reward_mean": 51.70915092659247, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [55.35375068256463, 55.24170849415922, 50.55722098225886, 48.57807594705793, 43.479347919703635, 56.031008639023504, 60.65259478679809, 48.867704306438256, 56.144196007547606, 52.04096905940519, 54.45826646155295, 52.69121335294796, 54.799661269537346, 40.87187344990129, 52.192644422165664, 51.727230577087255, 49.03263948951135, 51.04302202732159, 42.40687662053414, 53.48822486405374, 58.09860278923767, 50.153354106279174, 56.51104666960743, 56.52239416807577, 56.03005097585298, 56.08118973494176, 58.092361203638745, 38.51512636579859, 50.06325599399008, 55.991440141736355, 47.82409299873795, 52.707798977470546, 38.593503694515576, 52.41719828523105, 56.15902397703734, 49.717672423015415, 54.973894579018435, 54.58489650582444, 53.816675386128644, 48.9989681272744, 52.19617027602857, 41.931003800931215, 54.98427663993257, 47.35020806116139, 51.13980876078449, 53.46790733543907, 39.72233457469714, 55.86626227234863, 56.92080487356304, 52.625979957566926, 59.5137230861955, 52.07174657299393, 57.370004186262896, 51.018188116367554, 51.69473256157278, 41.08552500898405, 54.406176736875445, 58.6741118142864, 47.64900725487272, 51.042731381004195, 42.079041008851014, 54.99334264414182, 55.41530715599226, 51.32337038600384, 61.9312540616051, 51.60114847059189, 57.19863818838762, 54.190216242525814, 55.71763324584224, 41.07344078489943, 50.047200397336034, 54.716845317658404, 48.59223405229549, 52.23908135796429, 40.77304661661331, 54.32446733968094, 53.1204991230164, 50.94833226248781, 60.524217231185766, 51.56576667322966, 57.4909262965025, 52.0182047549899, 52.26784176047488, 40.973110583670504, 50.82697533321146, 56.65264949884996, 52.60017877338045, 51.46089085176525, 41.35916103062125, 52.78138608386329, 55.52631276435756, 50.484599061378944, 57.52971342418116, 49.58733688245447, 54.80547416696039, 53.03531649712505, 48.59200742045564, 42.03709872793256, 47.271226762520314, 54.99811968939071], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.772355494046886, "mean_inference_ms": 7.990686994719777, "mean_action_processing_ms": 0.562873614039923, "mean_env_wait_ms": 24.290885229621082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03647494316101074, "StateBufferConnector_ms": 0.0262906551361084, "ViewRequirementAgentConnector_ms": 1.0164422988891602}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1986296, "num_agent_steps_trained": 1986296, "num_env_steps_sampled": 1986296, "num_env_steps_trained": 1986296, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.52545570072002, "num_env_steps_trained_throughput_per_sec": 228.52545570072002, "timesteps_total": 1986296, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1986296, "timers": {"training_iteration_time_ms": 68689.442, "sample_time_ms": 42391.452, "load_time_ms": 2372.485, "load_throughput": 6591.401, "learn_time_ms": 23327.433, "learn_throughput": 670.37, "synch_weights_time_ms": 468.643}, "counters": {"num_env_steps_sampled": 1986296, "num_env_steps_trained": 1986296, "num_agent_steps_sampled": 1986296, "num_agent_steps_trained": 1986296}, "done": false, "episodes_total": 1892, "training_iteration": 135, "trial_id": "837cb_00000", "date": "2025-06-07_19-56-02", "timestamp": 1749318962, "time_this_iter_s": 68.44600486755371, "time_total_s": 9009.964606285095, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9009.964606285095, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 64.86923076923077, "ram_util_percent": 88.61538461538466, "gpu_util_percent0": 0.21576923076923074, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 8.013704000000003e-05, "total_loss": -0.07287437364056876, "policy_loss": -0.018086988680297508, "vf_loss": 0.013498983618549325, "vf_explained_var": 0.9624160338531841, "kl": 0.020624466707509285, "entropy": 17.078583483262495, "entropy_coeff": 0.0035205560000000006}, "model": {}, "num_grad_updates_lifetime": 70165.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2001934, "num_env_steps_trained": 2001934, "num_agent_steps_sampled": 2001934, "num_agent_steps_trained": 2001934}, "sampler_results": {"episode_reward_max": 61.9312540616051, "episode_reward_min": 38.51512636579859, "episode_reward_mean": 51.568276813243536, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.192644422165664, 51.727230577087255, 49.03263948951135, 51.04302202732159, 42.40687662053414, 53.48822486405374, 58.09860278923767, 50.153354106279174, 56.51104666960743, 56.52239416807577, 56.03005097585298, 56.08118973494176, 58.092361203638745, 38.51512636579859, 50.06325599399008, 55.991440141736355, 47.82409299873795, 52.707798977470546, 38.593503694515576, 52.41719828523105, 56.15902397703734, 49.717672423015415, 54.973894579018435, 54.58489650582444, 53.816675386128644, 48.9989681272744, 52.19617027602857, 41.931003800931215, 54.98427663993257, 47.35020806116139, 51.13980876078449, 53.46790733543907, 39.72233457469714, 55.86626227234863, 56.92080487356304, 52.625979957566926, 59.5137230861955, 52.07174657299393, 57.370004186262896, 51.018188116367554, 51.69473256157278, 41.08552500898405, 54.406176736875445, 58.6741118142864, 47.64900725487272, 51.042731381004195, 42.079041008851014, 54.99334264414182, 55.41530715599226, 51.32337038600384, 61.9312540616051, 51.60114847059189, 57.19863818838762, 54.190216242525814, 55.71763324584224, 41.07344078489943, 50.047200397336034, 54.716845317658404, 48.59223405229549, 52.23908135796429, 40.77304661661331, 54.32446733968094, 53.1204991230164, 50.94833226248781, 60.524217231185766, 51.56576667322966, 57.4909262965025, 52.0182047549899, 52.26784176047488, 40.973110583670504, 50.82697533321146, 56.65264949884996, 52.60017877338045, 51.46089085176525, 41.35916103062125, 52.78138608386329, 55.52631276435756, 50.484599061378944, 57.52971342418116, 49.58733688245447, 54.80547416696039, 53.03531649712505, 48.59200742045564, 42.03709872793256, 47.271226762520314, 54.99811968939071, 46.42255283603737, 51.4934170699047, 42.13987356763836, 55.214173708095004, 55.058820608492425, 50.871004271869545, 56.37540584920941, 52.679913467725235, 56.82187907531341, 54.24933995971276, 54.04797359345197, 39.852248916281575, 50.08733271078137, 50.366244389490596], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7712177430065292, "mean_inference_ms": 7.990274867652395, "mean_action_processing_ms": 0.5627963753835573, "mean_env_wait_ms": 24.29312203872902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03229975700378418, "StateBufferConnector_ms": 0.03162980079650879, "ViewRequirementAgentConnector_ms": 1.012155294418335}}, "episode_reward_max": 61.9312540616051, "episode_reward_min": 38.51512636579859, "episode_reward_mean": 51.568276813243536, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.192644422165664, 51.727230577087255, 49.03263948951135, 51.04302202732159, 42.40687662053414, 53.48822486405374, 58.09860278923767, 50.153354106279174, 56.51104666960743, 56.52239416807577, 56.03005097585298, 56.08118973494176, 58.092361203638745, 38.51512636579859, 50.06325599399008, 55.991440141736355, 47.82409299873795, 52.707798977470546, 38.593503694515576, 52.41719828523105, 56.15902397703734, 49.717672423015415, 54.973894579018435, 54.58489650582444, 53.816675386128644, 48.9989681272744, 52.19617027602857, 41.931003800931215, 54.98427663993257, 47.35020806116139, 51.13980876078449, 53.46790733543907, 39.72233457469714, 55.86626227234863, 56.92080487356304, 52.625979957566926, 59.5137230861955, 52.07174657299393, 57.370004186262896, 51.018188116367554, 51.69473256157278, 41.08552500898405, 54.406176736875445, 58.6741118142864, 47.64900725487272, 51.042731381004195, 42.079041008851014, 54.99334264414182, 55.41530715599226, 51.32337038600384, 61.9312540616051, 51.60114847059189, 57.19863818838762, 54.190216242525814, 55.71763324584224, 41.07344078489943, 50.047200397336034, 54.716845317658404, 48.59223405229549, 52.23908135796429, 40.77304661661331, 54.32446733968094, 53.1204991230164, 50.94833226248781, 60.524217231185766, 51.56576667322966, 57.4909262965025, 52.0182047549899, 52.26784176047488, 40.973110583670504, 50.82697533321146, 56.65264949884996, 52.60017877338045, 51.46089085176525, 41.35916103062125, 52.78138608386329, 55.52631276435756, 50.484599061378944, 57.52971342418116, 49.58733688245447, 54.80547416696039, 53.03531649712505, 48.59200742045564, 42.03709872793256, 47.271226762520314, 54.99811968939071, 46.42255283603737, 51.4934170699047, 42.13987356763836, 55.214173708095004, 55.058820608492425, 50.871004271869545, 56.37540584920941, 52.679913467725235, 56.82187907531341, 54.24933995971276, 54.04797359345197, 39.852248916281575, 50.08733271078137, 50.366244389490596], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7712177430065292, "mean_inference_ms": 7.990274867652395, "mean_action_processing_ms": 0.5627963753835573, "mean_env_wait_ms": 24.29312203872902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03229975700378418, "StateBufferConnector_ms": 0.03162980079650879, "ViewRequirementAgentConnector_ms": 1.012155294418335}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2001934, "num_agent_steps_trained": 2001934, "num_env_steps_sampled": 2001934, "num_env_steps_trained": 2001934, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.5782482307872, "num_env_steps_trained_throughput_per_sec": 229.5782482307872, "timesteps_total": 2001934, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2001934, "timers": {"training_iteration_time_ms": 68663.352, "sample_time_ms": 42356.377, "load_time_ms": 2373.424, "load_throughput": 6588.793, "learn_time_ms": 23327.316, "learn_throughput": 670.373, "synch_weights_time_ms": 471.201}, "counters": {"num_env_steps_sampled": 2001934, "num_env_steps_trained": 2001934, "num_agent_steps_sampled": 2001934, "num_agent_steps_trained": 2001934}, "done": false, "episodes_total": 1906, "training_iteration": 136, "trial_id": "837cb_00000", "date": "2025-06-07_19-57-11", "timestamp": 1749319031, "time_this_iter_s": 68.13374423980713, "time_total_s": 9078.098350524902, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9078.098350524902, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 64.41898734177215, "ram_util_percent": 88.8405063291139, "gpu_util_percent0": 0.22240506329113924, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.998066000000001e-05, "total_loss": -0.07966847944475541, "policy_loss": -0.024892663326516577, "vf_loss": 0.012414931699379602, "vf_explained_var": 0.9618176645582373, "kl": 0.020740791804173667, "entropy": 17.098913407759234, "entropy_coeff": 0.003497099}, "model": {}, "num_grad_updates_lifetime": 70715.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2017572, "num_env_steps_trained": 2017572, "num_agent_steps_sampled": 2017572, "num_agent_steps_trained": 2017572}, "sampler_results": {"episode_reward_max": 61.9312540616051, "episode_reward_min": 38.593503694515576, "episode_reward_mean": 51.49082106299635, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.06325599399008, 55.991440141736355, 47.82409299873795, 52.707798977470546, 38.593503694515576, 52.41719828523105, 56.15902397703734, 49.717672423015415, 54.973894579018435, 54.58489650582444, 53.816675386128644, 48.9989681272744, 52.19617027602857, 41.931003800931215, 54.98427663993257, 47.35020806116139, 51.13980876078449, 53.46790733543907, 39.72233457469714, 55.86626227234863, 56.92080487356304, 52.625979957566926, 59.5137230861955, 52.07174657299393, 57.370004186262896, 51.018188116367554, 51.69473256157278, 41.08552500898405, 54.406176736875445, 58.6741118142864, 47.64900725487272, 51.042731381004195, 42.079041008851014, 54.99334264414182, 55.41530715599226, 51.32337038600384, 61.9312540616051, 51.60114847059189, 57.19863818838762, 54.190216242525814, 55.71763324584224, 41.07344078489943, 50.047200397336034, 54.716845317658404, 48.59223405229549, 52.23908135796429, 40.77304661661331, 54.32446733968094, 53.1204991230164, 50.94833226248781, 60.524217231185766, 51.56576667322966, 57.4909262965025, 52.0182047549899, 52.26784176047488, 40.973110583670504, 50.82697533321146, 56.65264949884996, 52.60017877338045, 51.46089085176525, 41.35916103062125, 52.78138608386329, 55.52631276435756, 50.484599061378944, 57.52971342418116, 49.58733688245447, 54.80547416696039, 53.03531649712505, 48.59200742045564, 42.03709872793256, 47.271226762520314, 54.99811968939071, 46.42255283603737, 51.4934170699047, 42.13987356763836, 55.214173708095004, 55.058820608492425, 50.871004271869545, 56.37540584920941, 52.679913467725235, 56.82187907531341, 54.24933995971276, 54.04797359345197, 39.852248916281575, 50.08733271078137, 50.366244389490596, 47.40852649312801, 51.78304904739204, 41.41244760816799, 53.471325360810646, 56.40146138521156, 50.56616037384683, 59.32533499796414, 53.98546052455343, 54.79572128315421, 50.77838480594105, 56.672810465183844, 41.25421291748722, 52.79354977433045, 51.500743952216844], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7702141372667173, "mean_inference_ms": 7.989729618726761, "mean_action_processing_ms": 0.56271350523223, "mean_env_wait_ms": 24.29484762733608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03409147262573242, "StateBufferConnector_ms": 0.029570817947387695, "ViewRequirementAgentConnector_ms": 1.03059720993042}}, "episode_reward_max": 61.9312540616051, "episode_reward_min": 38.593503694515576, "episode_reward_mean": 51.49082106299635, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.06325599399008, 55.991440141736355, 47.82409299873795, 52.707798977470546, 38.593503694515576, 52.41719828523105, 56.15902397703734, 49.717672423015415, 54.973894579018435, 54.58489650582444, 53.816675386128644, 48.9989681272744, 52.19617027602857, 41.931003800931215, 54.98427663993257, 47.35020806116139, 51.13980876078449, 53.46790733543907, 39.72233457469714, 55.86626227234863, 56.92080487356304, 52.625979957566926, 59.5137230861955, 52.07174657299393, 57.370004186262896, 51.018188116367554, 51.69473256157278, 41.08552500898405, 54.406176736875445, 58.6741118142864, 47.64900725487272, 51.042731381004195, 42.079041008851014, 54.99334264414182, 55.41530715599226, 51.32337038600384, 61.9312540616051, 51.60114847059189, 57.19863818838762, 54.190216242525814, 55.71763324584224, 41.07344078489943, 50.047200397336034, 54.716845317658404, 48.59223405229549, 52.23908135796429, 40.77304661661331, 54.32446733968094, 53.1204991230164, 50.94833226248781, 60.524217231185766, 51.56576667322966, 57.4909262965025, 52.0182047549899, 52.26784176047488, 40.973110583670504, 50.82697533321146, 56.65264949884996, 52.60017877338045, 51.46089085176525, 41.35916103062125, 52.78138608386329, 55.52631276435756, 50.484599061378944, 57.52971342418116, 49.58733688245447, 54.80547416696039, 53.03531649712505, 48.59200742045564, 42.03709872793256, 47.271226762520314, 54.99811968939071, 46.42255283603737, 51.4934170699047, 42.13987356763836, 55.214173708095004, 55.058820608492425, 50.871004271869545, 56.37540584920941, 52.679913467725235, 56.82187907531341, 54.24933995971276, 54.04797359345197, 39.852248916281575, 50.08733271078137, 50.366244389490596, 47.40852649312801, 51.78304904739204, 41.41244760816799, 53.471325360810646, 56.40146138521156, 50.56616037384683, 59.32533499796414, 53.98546052455343, 54.79572128315421, 50.77838480594105, 56.672810465183844, 41.25421291748722, 52.79354977433045, 51.500743952216844], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7702141372667173, "mean_inference_ms": 7.989729618726761, "mean_action_processing_ms": 0.56271350523223, "mean_env_wait_ms": 24.29484762733608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03409147262573242, "StateBufferConnector_ms": 0.029570817947387695, "ViewRequirementAgentConnector_ms": 1.03059720993042}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2017572, "num_agent_steps_trained": 2017572, "num_env_steps_sampled": 2017572, "num_env_steps_trained": 2017572, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.72961279546504, "num_env_steps_trained_throughput_per_sec": 228.72961279546504, "timesteps_total": 2017572, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2017572, "timers": {"training_iteration_time_ms": 68654.984, "sample_time_ms": 42342.59, "load_time_ms": 2363.136, "load_throughput": 6617.477, "learn_time_ms": 23344.081, "learn_throughput": 669.891, "synch_weights_time_ms": 470.642}, "counters": {"num_env_steps_sampled": 2017572, "num_env_steps_trained": 2017572, "num_agent_steps_sampled": 2017572, "num_agent_steps_trained": 2017572}, "done": false, "episodes_total": 1920, "training_iteration": 137, "trial_id": "837cb_00000", "date": "2025-06-07_19-58-19", "timestamp": 1749319099, "time_this_iter_s": 68.38464307785034, "time_total_s": 9146.482993602753, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9146.482993602753, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 64.3025974025974, "ram_util_percent": 88.86363636363637, "gpu_util_percent0": 0.2158441558441558, "vram_util_percent0": 0.965006510416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.982428e-05, "total_loss": -0.08722661507358266, "policy_loss": -0.03282442373890345, "vf_loss": 0.013333982597105205, "vf_explained_var": 0.9636093415997246, "kl": 0.01982323304745175, "entropy": 17.16968472394076, "entropy_coeff": 0.003473642}, "model": {}, "num_grad_updates_lifetime": 71265.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2033210, "num_env_steps_trained": 2033210, "num_agent_steps_sampled": 2033210, "num_agent_steps_trained": 2033210}, "sampler_results": {"episode_reward_max": 61.9312540616051, "episode_reward_min": 38.125869634553744, "episode_reward_mean": 51.4428174944376, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.98427663993257, 47.35020806116139, 51.13980876078449, 53.46790733543907, 39.72233457469714, 55.86626227234863, 56.92080487356304, 52.625979957566926, 59.5137230861955, 52.07174657299393, 57.370004186262896, 51.018188116367554, 51.69473256157278, 41.08552500898405, 54.406176736875445, 58.6741118142864, 47.64900725487272, 51.042731381004195, 42.079041008851014, 54.99334264414182, 55.41530715599226, 51.32337038600384, 61.9312540616051, 51.60114847059189, 57.19863818838762, 54.190216242525814, 55.71763324584224, 41.07344078489943, 50.047200397336034, 54.716845317658404, 48.59223405229549, 52.23908135796429, 40.77304661661331, 54.32446733968094, 53.1204991230164, 50.94833226248781, 60.524217231185766, 51.56576667322966, 57.4909262965025, 52.0182047549899, 52.26784176047488, 40.973110583670504, 50.82697533321146, 56.65264949884996, 52.60017877338045, 51.46089085176525, 41.35916103062125, 52.78138608386329, 55.52631276435756, 50.484599061378944, 57.52971342418116, 49.58733688245447, 54.80547416696039, 53.03531649712505, 48.59200742045564, 42.03709872793256, 47.271226762520314, 54.99811968939071, 46.42255283603737, 51.4934170699047, 42.13987356763836, 55.214173708095004, 55.058820608492425, 50.871004271869545, 56.37540584920941, 52.679913467725235, 56.82187907531341, 54.24933995971276, 54.04797359345197, 39.852248916281575, 50.08733271078137, 50.366244389490596, 47.40852649312801, 51.78304904739204, 41.41244760816799, 53.471325360810646, 56.40146138521156, 50.56616037384683, 59.32533499796414, 53.98546052455343, 54.79572128315421, 50.77838480594105, 56.672810465183844, 41.25421291748722, 52.79354977433045, 51.500743952216844, 49.04775853564287, 52.40979831133378, 38.125869634553744, 54.20348266666523, 54.72452995796108, 50.64726377964771, 57.846990482867476, 47.778610277836684, 53.039505049065006, 50.23022736882979, 49.83974111120475, 40.72820103611501, 52.90484509859173, 53.648415000748585], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.769483815555763, "mean_inference_ms": 7.9891072250257364, "mean_action_processing_ms": 0.5626129989291563, "mean_env_wait_ms": 24.296540907055117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03999161720275879, "StateBufferConnector_ms": 0.02808547019958496, "ViewRequirementAgentConnector_ms": 1.0090749263763428}}, "episode_reward_max": 61.9312540616051, "episode_reward_min": 38.125869634553744, "episode_reward_mean": 51.4428174944376, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.98427663993257, 47.35020806116139, 51.13980876078449, 53.46790733543907, 39.72233457469714, 55.86626227234863, 56.92080487356304, 52.625979957566926, 59.5137230861955, 52.07174657299393, 57.370004186262896, 51.018188116367554, 51.69473256157278, 41.08552500898405, 54.406176736875445, 58.6741118142864, 47.64900725487272, 51.042731381004195, 42.079041008851014, 54.99334264414182, 55.41530715599226, 51.32337038600384, 61.9312540616051, 51.60114847059189, 57.19863818838762, 54.190216242525814, 55.71763324584224, 41.07344078489943, 50.047200397336034, 54.716845317658404, 48.59223405229549, 52.23908135796429, 40.77304661661331, 54.32446733968094, 53.1204991230164, 50.94833226248781, 60.524217231185766, 51.56576667322966, 57.4909262965025, 52.0182047549899, 52.26784176047488, 40.973110583670504, 50.82697533321146, 56.65264949884996, 52.60017877338045, 51.46089085176525, 41.35916103062125, 52.78138608386329, 55.52631276435756, 50.484599061378944, 57.52971342418116, 49.58733688245447, 54.80547416696039, 53.03531649712505, 48.59200742045564, 42.03709872793256, 47.271226762520314, 54.99811968939071, 46.42255283603737, 51.4934170699047, 42.13987356763836, 55.214173708095004, 55.058820608492425, 50.871004271869545, 56.37540584920941, 52.679913467725235, 56.82187907531341, 54.24933995971276, 54.04797359345197, 39.852248916281575, 50.08733271078137, 50.366244389490596, 47.40852649312801, 51.78304904739204, 41.41244760816799, 53.471325360810646, 56.40146138521156, 50.56616037384683, 59.32533499796414, 53.98546052455343, 54.79572128315421, 50.77838480594105, 56.672810465183844, 41.25421291748722, 52.79354977433045, 51.500743952216844, 49.04775853564287, 52.40979831133378, 38.125869634553744, 54.20348266666523, 54.72452995796108, 50.64726377964771, 57.846990482867476, 47.778610277836684, 53.039505049065006, 50.23022736882979, 49.83974111120475, 40.72820103611501, 52.90484509859173, 53.648415000748585], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.769483815555763, "mean_inference_ms": 7.9891072250257364, "mean_action_processing_ms": 0.5626129989291563, "mean_env_wait_ms": 24.296540907055117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03999161720275879, "StateBufferConnector_ms": 0.02808547019958496, "ViewRequirementAgentConnector_ms": 1.0090749263763428}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2033210, "num_agent_steps_trained": 2033210, "num_env_steps_sampled": 2033210, "num_env_steps_trained": 2033210, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.94154943004054, "num_env_steps_trained_throughput_per_sec": 227.94154943004054, "timesteps_total": 2033210, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2033210, "timers": {"training_iteration_time_ms": 68622.03, "sample_time_ms": 42345.971, "load_time_ms": 2346.543, "load_throughput": 6664.271, "learn_time_ms": 23326.536, "learn_throughput": 670.395, "synch_weights_time_ms": 472.946}, "counters": {"num_env_steps_sampled": 2033210, "num_env_steps_trained": 2033210, "num_agent_steps_sampled": 2033210, "num_agent_steps_trained": 2033210}, "done": false, "episodes_total": 1934, "training_iteration": 138, "trial_id": "837cb_00000", "date": "2025-06-07_19-59-28", "timestamp": 1749319168, "time_this_iter_s": 68.6253399848938, "time_total_s": 9215.108333587646, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9215.108333587646, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 64.74358974358974, "ram_util_percent": 88.86153846153843, "gpu_util_percent0": 0.2194871794871795, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.96679e-05, "total_loss": -0.0824972431463274, "policy_loss": -0.02851861312974837, "vf_loss": 0.013380673672919246, "vf_explained_var": 0.9656745393709703, "kl": 0.020441079911707016, "entropy": 17.178904751864348, "entropy_coeff": 0.003450185}, "model": {}, "num_grad_updates_lifetime": 71815.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2048848, "num_env_steps_trained": 2048848, "num_agent_steps_sampled": 2048848, "num_agent_steps_trained": 2048848}, "sampler_results": {"episode_reward_max": 61.9312540616051, "episode_reward_min": 38.125869634553744, "episode_reward_mean": 51.258230359379816, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.406176736875445, 58.6741118142864, 47.64900725487272, 51.042731381004195, 42.079041008851014, 54.99334264414182, 55.41530715599226, 51.32337038600384, 61.9312540616051, 51.60114847059189, 57.19863818838762, 54.190216242525814, 55.71763324584224, 41.07344078489943, 50.047200397336034, 54.716845317658404, 48.59223405229549, 52.23908135796429, 40.77304661661331, 54.32446733968094, 53.1204991230164, 50.94833226248781, 60.524217231185766, 51.56576667322966, 57.4909262965025, 52.0182047549899, 52.26784176047488, 40.973110583670504, 50.82697533321146, 56.65264949884996, 52.60017877338045, 51.46089085176525, 41.35916103062125, 52.78138608386329, 55.52631276435756, 50.484599061378944, 57.52971342418116, 49.58733688245447, 54.80547416696039, 53.03531649712505, 48.59200742045564, 42.03709872793256, 47.271226762520314, 54.99811968939071, 46.42255283603737, 51.4934170699047, 42.13987356763836, 55.214173708095004, 55.058820608492425, 50.871004271869545, 56.37540584920941, 52.679913467725235, 56.82187907531341, 54.24933995971276, 54.04797359345197, 39.852248916281575, 50.08733271078137, 50.366244389490596, 47.40852649312801, 51.78304904739204, 41.41244760816799, 53.471325360810646, 56.40146138521156, 50.56616037384683, 59.32533499796414, 53.98546052455343, 54.79572128315421, 50.77838480594105, 56.672810465183844, 41.25421291748722, 52.79354977433045, 51.500743952216844, 49.04775853564287, 52.40979831133378, 38.125869634553744, 54.20348266666523, 54.72452995796108, 50.64726377964771, 57.846990482867476, 47.778610277836684, 53.039505049065006, 50.23022736882979, 49.83974111120475, 40.72820103611501, 52.90484509859173, 53.648415000748585, 44.94052058942308, 51.16638792593794, 41.060544680772985, 52.749622022851455, 55.953915133293236, 53.09983436797127, 56.683316162425434, 49.39579172913538, 53.707211232503994, 49.005774535480725, 52.66486000154054, 41.76986237805368, 50.83760481269202, 53.33754293001063], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7687731465216627, "mean_inference_ms": 7.988712918134194, "mean_action_processing_ms": 0.5625265781652179, "mean_env_wait_ms": 24.2985996425053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04697060585021973, "StateBufferConnector_ms": 0.03209733963012695, "ViewRequirementAgentConnector_ms": 1.0130083560943604}}, "episode_reward_max": 61.9312540616051, "episode_reward_min": 38.125869634553744, "episode_reward_mean": 51.258230359379816, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.406176736875445, 58.6741118142864, 47.64900725487272, 51.042731381004195, 42.079041008851014, 54.99334264414182, 55.41530715599226, 51.32337038600384, 61.9312540616051, 51.60114847059189, 57.19863818838762, 54.190216242525814, 55.71763324584224, 41.07344078489943, 50.047200397336034, 54.716845317658404, 48.59223405229549, 52.23908135796429, 40.77304661661331, 54.32446733968094, 53.1204991230164, 50.94833226248781, 60.524217231185766, 51.56576667322966, 57.4909262965025, 52.0182047549899, 52.26784176047488, 40.973110583670504, 50.82697533321146, 56.65264949884996, 52.60017877338045, 51.46089085176525, 41.35916103062125, 52.78138608386329, 55.52631276435756, 50.484599061378944, 57.52971342418116, 49.58733688245447, 54.80547416696039, 53.03531649712505, 48.59200742045564, 42.03709872793256, 47.271226762520314, 54.99811968939071, 46.42255283603737, 51.4934170699047, 42.13987356763836, 55.214173708095004, 55.058820608492425, 50.871004271869545, 56.37540584920941, 52.679913467725235, 56.82187907531341, 54.24933995971276, 54.04797359345197, 39.852248916281575, 50.08733271078137, 50.366244389490596, 47.40852649312801, 51.78304904739204, 41.41244760816799, 53.471325360810646, 56.40146138521156, 50.56616037384683, 59.32533499796414, 53.98546052455343, 54.79572128315421, 50.77838480594105, 56.672810465183844, 41.25421291748722, 52.79354977433045, 51.500743952216844, 49.04775853564287, 52.40979831133378, 38.125869634553744, 54.20348266666523, 54.72452995796108, 50.64726377964771, 57.846990482867476, 47.778610277836684, 53.039505049065006, 50.23022736882979, 49.83974111120475, 40.72820103611501, 52.90484509859173, 53.648415000748585, 44.94052058942308, 51.16638792593794, 41.060544680772985, 52.749622022851455, 55.953915133293236, 53.09983436797127, 56.683316162425434, 49.39579172913538, 53.707211232503994, 49.005774535480725, 52.66486000154054, 41.76986237805368, 50.83760481269202, 53.33754293001063], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7687731465216627, "mean_inference_ms": 7.988712918134194, "mean_action_processing_ms": 0.5625265781652179, "mean_env_wait_ms": 24.2985996425053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04697060585021973, "StateBufferConnector_ms": 0.03209733963012695, "ViewRequirementAgentConnector_ms": 1.0130083560943604}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048848, "num_agent_steps_trained": 2048848, "num_env_steps_sampled": 2048848, "num_env_steps_trained": 2048848, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.33801184987144, "num_env_steps_trained_throughput_per_sec": 226.33801184987144, "timesteps_total": 2048848, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2048848, "timers": {"training_iteration_time_ms": 68719.934, "sample_time_ms": 42461.108, "load_time_ms": 2335.277, "load_throughput": 6696.423, "learn_time_ms": 23321.64, "learn_throughput": 670.536, "synch_weights_time_ms": 477.312}, "counters": {"num_env_steps_sampled": 2048848, "num_env_steps_trained": 2048848, "num_agent_steps_sampled": 2048848, "num_agent_steps_trained": 2048848}, "done": false, "episodes_total": 1948, "training_iteration": 139, "trial_id": "837cb_00000", "date": "2025-06-07_20-00-37", "timestamp": 1749319237, "time_this_iter_s": 69.10740375518799, "time_total_s": 9284.215737342834, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9284.215737342834, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 64.50506329113924, "ram_util_percent": 89.23164556962024, "gpu_util_percent0": 0.21797468354430383, "vram_util_percent0": 0.9650065104166671}}
{"evaluation": {"sampler_results": {"episode_reward_max": 3.099437478937916, "episode_reward_min": 2.4855692178110527, "episode_reward_mean": 2.787743268425056, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.6225539365624884, 2.4855692178110527, 2.6907989767335274, 3.099437478937916, 3.0403567320802947], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8510261721033903, "mean_inference_ms": 4.0055959734262565, "mean_action_processing_ms": 0.289324878970711, "mean_env_wait_ms": 12.333059984652413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.04016876220703125, "ViewRequirementAgentConnector_ms": 0.66314697265625}}, "episode_reward_max": 3.099437478937916, "episode_reward_min": 2.4855692178110527, "episode_reward_mean": 2.787743268425056, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.6225539365624884, 2.4855692178110527, 2.6907989767335274, 3.099437478937916, 3.0403567320802947], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8510261721033903, "mean_inference_ms": 4.0055959734262565, "mean_action_processing_ms": 0.289324878970711, "mean_env_wait_ms": 12.333059984652413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.04016876220703125, "ViewRequirementAgentConnector_ms": 0.66314697265625}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.951151999999997e-05, "total_loss": -0.07644354830665344, "policy_loss": -0.02300693949599835, "vf_loss": 0.013325228653424843, "vf_explained_var": 0.9623814651099118, "kl": 0.020194050331648686, "entropy": 17.128965481844816, "entropy_coeff": 0.0034267279999999995}, "model": {}, "num_grad_updates_lifetime": 72365.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2064486, "num_env_steps_trained": 2064486, "num_agent_steps_sampled": 2064486, "num_agent_steps_trained": 2064486}, "sampler_results": {"episode_reward_max": 60.524217231185766, "episode_reward_min": 38.125869634553744, "episode_reward_mean": 50.8691605682988, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.047200397336034, 54.716845317658404, 48.59223405229549, 52.23908135796429, 40.77304661661331, 54.32446733968094, 53.1204991230164, 50.94833226248781, 60.524217231185766, 51.56576667322966, 57.4909262965025, 52.0182047549899, 52.26784176047488, 40.973110583670504, 50.82697533321146, 56.65264949884996, 52.60017877338045, 51.46089085176525, 41.35916103062125, 52.78138608386329, 55.52631276435756, 50.484599061378944, 57.52971342418116, 49.58733688245447, 54.80547416696039, 53.03531649712505, 48.59200742045564, 42.03709872793256, 47.271226762520314, 54.99811968939071, 46.42255283603737, 51.4934170699047, 42.13987356763836, 55.214173708095004, 55.058820608492425, 50.871004271869545, 56.37540584920941, 52.679913467725235, 56.82187907531341, 54.24933995971276, 54.04797359345197, 39.852248916281575, 50.08733271078137, 50.366244389490596, 47.40852649312801, 51.78304904739204, 41.41244760816799, 53.471325360810646, 56.40146138521156, 50.56616037384683, 59.32533499796414, 53.98546052455343, 54.79572128315421, 50.77838480594105, 56.672810465183844, 41.25421291748722, 52.79354977433045, 51.500743952216844, 49.04775853564287, 52.40979831133378, 38.125869634553744, 54.20348266666523, 54.72452995796108, 50.64726377964771, 57.846990482867476, 47.778610277836684, 53.039505049065006, 50.23022736882979, 49.83974111120475, 40.72820103611501, 52.90484509859173, 53.648415000748585, 44.94052058942308, 51.16638792593794, 41.060544680772985, 52.749622022851455, 55.953915133293236, 53.09983436797127, 56.683316162425434, 49.39579172913538, 53.707211232503994, 49.005774535480725, 52.66486000154054, 41.76986237805368, 50.83760481269202, 53.33754293001063, 47.98317646587763, 48.52332509379396, 39.378047124669514, 48.64169568529336, 57.28198247556905, 51.080866813900755, 53.54820417708139, 53.75132247395947, 53.62200918628766, 48.20989119467023, 51.60659485870048, 40.20017832304805, 50.23631996043392, 54.32482643449325], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7681975441495323, "mean_inference_ms": 7.9883680238069585, "mean_action_processing_ms": 0.5624290424677307, "mean_env_wait_ms": 24.301193446825824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05001688003540039, "StateBufferConnector_ms": 0.03738522529602051, "ViewRequirementAgentConnector_ms": 1.0556063652038574}}, "episode_reward_max": 60.524217231185766, "episode_reward_min": 38.125869634553744, "episode_reward_mean": 50.8691605682988, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.047200397336034, 54.716845317658404, 48.59223405229549, 52.23908135796429, 40.77304661661331, 54.32446733968094, 53.1204991230164, 50.94833226248781, 60.524217231185766, 51.56576667322966, 57.4909262965025, 52.0182047549899, 52.26784176047488, 40.973110583670504, 50.82697533321146, 56.65264949884996, 52.60017877338045, 51.46089085176525, 41.35916103062125, 52.78138608386329, 55.52631276435756, 50.484599061378944, 57.52971342418116, 49.58733688245447, 54.80547416696039, 53.03531649712505, 48.59200742045564, 42.03709872793256, 47.271226762520314, 54.99811968939071, 46.42255283603737, 51.4934170699047, 42.13987356763836, 55.214173708095004, 55.058820608492425, 50.871004271869545, 56.37540584920941, 52.679913467725235, 56.82187907531341, 54.24933995971276, 54.04797359345197, 39.852248916281575, 50.08733271078137, 50.366244389490596, 47.40852649312801, 51.78304904739204, 41.41244760816799, 53.471325360810646, 56.40146138521156, 50.56616037384683, 59.32533499796414, 53.98546052455343, 54.79572128315421, 50.77838480594105, 56.672810465183844, 41.25421291748722, 52.79354977433045, 51.500743952216844, 49.04775853564287, 52.40979831133378, 38.125869634553744, 54.20348266666523, 54.72452995796108, 50.64726377964771, 57.846990482867476, 47.778610277836684, 53.039505049065006, 50.23022736882979, 49.83974111120475, 40.72820103611501, 52.90484509859173, 53.648415000748585, 44.94052058942308, 51.16638792593794, 41.060544680772985, 52.749622022851455, 55.953915133293236, 53.09983436797127, 56.683316162425434, 49.39579172913538, 53.707211232503994, 49.005774535480725, 52.66486000154054, 41.76986237805368, 50.83760481269202, 53.33754293001063, 47.98317646587763, 48.52332509379396, 39.378047124669514, 48.64169568529336, 57.28198247556905, 51.080866813900755, 53.54820417708139, 53.75132247395947, 53.62200918628766, 48.20989119467023, 51.60659485870048, 40.20017832304805, 50.23631996043392, 54.32482643449325], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7681975441495323, "mean_inference_ms": 7.9883680238069585, "mean_action_processing_ms": 0.5624290424677307, "mean_env_wait_ms": 24.301193446825824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05001688003540039, "StateBufferConnector_ms": 0.03738522529602051, "ViewRequirementAgentConnector_ms": 1.0556063652038574}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064486, "num_agent_steps_trained": 2064486, "num_env_steps_sampled": 2064486, "num_env_steps_trained": 2064486, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 225.4586868538902, "num_env_steps_trained_throughput_per_sec": 225.4586868538902, "timesteps_total": 2064486, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2064486, "timers": {"training_iteration_time_ms": 68642.247, "sample_time_ms": 42378.256, "load_time_ms": 2335.362, "load_throughput": 6696.18, "learn_time_ms": 23350.063, "learn_throughput": 669.72, "synch_weights_time_ms": 458.214}, "counters": {"num_env_steps_sampled": 2064486, "num_env_steps_trained": 2064486, "num_agent_steps_sampled": 2064486, "num_agent_steps_trained": 2064486}, "done": false, "episodes_total": 1962, "training_iteration": 140, "trial_id": "837cb_00000", "date": "2025-06-07_20-02-02", "timestamp": 1749319322, "time_this_iter_s": 84.54733562469482, "time_total_s": 9368.76307296753, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9368.76307296753, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 56.78163265306123, "ram_util_percent": 89.02653061224488, "gpu_util_percent0": 0.17581632653061222, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.935514e-05, "total_loss": -0.06880615486594087, "policy_loss": -0.015925258762859315, "vf_loss": 0.013047602329487828, "vf_explained_var": 0.964611161513762, "kl": 0.019945768366190893, "entropy": 17.054706077575684, "entropy_coeff": 0.003403271}, "model": {}, "num_grad_updates_lifetime": 72915.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2080124, "num_env_steps_trained": 2080124, "num_agent_steps_sampled": 2080124, "num_agent_steps_trained": 2080124}, "sampler_results": {"episode_reward_max": 59.32533499796414, "episode_reward_min": 38.125869634553744, "episode_reward_mean": 50.7359458376967, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.82697533321146, 56.65264949884996, 52.60017877338045, 51.46089085176525, 41.35916103062125, 52.78138608386329, 55.52631276435756, 50.484599061378944, 57.52971342418116, 49.58733688245447, 54.80547416696039, 53.03531649712505, 48.59200742045564, 42.03709872793256, 47.271226762520314, 54.99811968939071, 46.42255283603737, 51.4934170699047, 42.13987356763836, 55.214173708095004, 55.058820608492425, 50.871004271869545, 56.37540584920941, 52.679913467725235, 56.82187907531341, 54.24933995971276, 54.04797359345197, 39.852248916281575, 50.08733271078137, 50.366244389490596, 47.40852649312801, 51.78304904739204, 41.41244760816799, 53.471325360810646, 56.40146138521156, 50.56616037384683, 59.32533499796414, 53.98546052455343, 54.79572128315421, 50.77838480594105, 56.672810465183844, 41.25421291748722, 52.79354977433045, 51.500743952216844, 49.04775853564287, 52.40979831133378, 38.125869634553744, 54.20348266666523, 54.72452995796108, 50.64726377964771, 57.846990482867476, 47.778610277836684, 53.039505049065006, 50.23022736882979, 49.83974111120475, 40.72820103611501, 52.90484509859173, 53.648415000748585, 44.94052058942308, 51.16638792593794, 41.060544680772985, 52.749622022851455, 55.953915133293236, 53.09983436797127, 56.683316162425434, 49.39579172913538, 53.707211232503994, 49.005774535480725, 52.66486000154054, 41.76986237805368, 50.83760481269202, 53.33754293001063, 47.98317646587763, 48.52332509379396, 39.378047124669514, 48.64169568529336, 57.28198247556905, 51.080866813900755, 53.54820417708139, 53.75132247395947, 53.62200918628766, 48.20989119467023, 51.60659485870048, 40.20017832304805, 50.23631996043392, 54.32482643449325, 51.871001807022395, 50.38775325683015, 41.39601295532435, 51.206806527991525, 58.63747684958211, 52.47890658700943, 53.75252942046804, 53.89739148280189, 53.34033979420882, 45.64898585801706, 51.53231288301784, 38.71343103699532, 49.48089679166811, 53.936455455958054], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.767368153102051, "mean_inference_ms": 7.988254915180097, "mean_action_processing_ms": 0.5623276930690764, "mean_env_wait_ms": 24.30382969099245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0478520393371582, "StateBufferConnector_ms": 0.03776884078979492, "ViewRequirementAgentConnector_ms": 1.0205929279327393}}, "episode_reward_max": 59.32533499796414, "episode_reward_min": 38.125869634553744, "episode_reward_mean": 50.7359458376967, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.82697533321146, 56.65264949884996, 52.60017877338045, 51.46089085176525, 41.35916103062125, 52.78138608386329, 55.52631276435756, 50.484599061378944, 57.52971342418116, 49.58733688245447, 54.80547416696039, 53.03531649712505, 48.59200742045564, 42.03709872793256, 47.271226762520314, 54.99811968939071, 46.42255283603737, 51.4934170699047, 42.13987356763836, 55.214173708095004, 55.058820608492425, 50.871004271869545, 56.37540584920941, 52.679913467725235, 56.82187907531341, 54.24933995971276, 54.04797359345197, 39.852248916281575, 50.08733271078137, 50.366244389490596, 47.40852649312801, 51.78304904739204, 41.41244760816799, 53.471325360810646, 56.40146138521156, 50.56616037384683, 59.32533499796414, 53.98546052455343, 54.79572128315421, 50.77838480594105, 56.672810465183844, 41.25421291748722, 52.79354977433045, 51.500743952216844, 49.04775853564287, 52.40979831133378, 38.125869634553744, 54.20348266666523, 54.72452995796108, 50.64726377964771, 57.846990482867476, 47.778610277836684, 53.039505049065006, 50.23022736882979, 49.83974111120475, 40.72820103611501, 52.90484509859173, 53.648415000748585, 44.94052058942308, 51.16638792593794, 41.060544680772985, 52.749622022851455, 55.953915133293236, 53.09983436797127, 56.683316162425434, 49.39579172913538, 53.707211232503994, 49.005774535480725, 52.66486000154054, 41.76986237805368, 50.83760481269202, 53.33754293001063, 47.98317646587763, 48.52332509379396, 39.378047124669514, 48.64169568529336, 57.28198247556905, 51.080866813900755, 53.54820417708139, 53.75132247395947, 53.62200918628766, 48.20989119467023, 51.60659485870048, 40.20017832304805, 50.23631996043392, 54.32482643449325, 51.871001807022395, 50.38775325683015, 41.39601295532435, 51.206806527991525, 58.63747684958211, 52.47890658700943, 53.75252942046804, 53.89739148280189, 53.34033979420882, 45.64898585801706, 51.53231288301784, 38.71343103699532, 49.48089679166811, 53.936455455958054], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.767368153102051, "mean_inference_ms": 7.988254915180097, "mean_action_processing_ms": 0.5623276930690764, "mean_env_wait_ms": 24.30382969099245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0478520393371582, "StateBufferConnector_ms": 0.03776884078979492, "ViewRequirementAgentConnector_ms": 1.0205929279327393}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080124, "num_agent_steps_trained": 2080124, "num_env_steps_sampled": 2080124, "num_env_steps_trained": 2080124, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.91602137183747, "num_env_steps_trained_throughput_per_sec": 226.91602137183747, "timesteps_total": 2080124, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2080124, "timers": {"training_iteration_time_ms": 68675.877, "sample_time_ms": 42424.49, "load_time_ms": 2327.29, "load_throughput": 6719.403, "learn_time_ms": 23349.101, "learn_throughput": 669.747, "synch_weights_time_ms": 456.09}, "counters": {"num_env_steps_sampled": 2080124, "num_env_steps_trained": 2080124, "num_agent_steps_sampled": 2080124, "num_agent_steps_trained": 2080124}, "done": false, "episodes_total": 1976, "training_iteration": 141, "trial_id": "837cb_00000", "date": "2025-06-07_20-03-11", "timestamp": 1749319391, "time_this_iter_s": 68.93465852737427, "time_total_s": 9437.697731494904, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9437.697731494904, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 64.42151898734177, "ram_util_percent": 90.09240506329114, "gpu_util_percent0": 0.21531645569620256, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.919876000000002e-05, "total_loss": -0.06759646273493258, "policy_loss": -0.015419119352220812, "vf_loss": 0.013854353134097023, "vf_explained_var": 0.9648526035655629, "kl": 0.020132881873504472, "entropy": 17.039977883425625, "entropy_coeff": 0.003379814000000001}, "model": {}, "num_grad_updates_lifetime": 73465.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2095762, "num_env_steps_trained": 2095762, "num_agent_steps_sampled": 2095762, "num_agent_steps_trained": 2095762}, "sampler_results": {"episode_reward_max": 59.32533499796414, "episode_reward_min": 37.07771370569603, "episode_reward_mean": 50.5580611366511, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.271226762520314, 54.99811968939071, 46.42255283603737, 51.4934170699047, 42.13987356763836, 55.214173708095004, 55.058820608492425, 50.871004271869545, 56.37540584920941, 52.679913467725235, 56.82187907531341, 54.24933995971276, 54.04797359345197, 39.852248916281575, 50.08733271078137, 50.366244389490596, 47.40852649312801, 51.78304904739204, 41.41244760816799, 53.471325360810646, 56.40146138521156, 50.56616037384683, 59.32533499796414, 53.98546052455343, 54.79572128315421, 50.77838480594105, 56.672810465183844, 41.25421291748722, 52.79354977433045, 51.500743952216844, 49.04775853564287, 52.40979831133378, 38.125869634553744, 54.20348266666523, 54.72452995796108, 50.64726377964771, 57.846990482867476, 47.778610277836684, 53.039505049065006, 50.23022736882979, 49.83974111120475, 40.72820103611501, 52.90484509859173, 53.648415000748585, 44.94052058942308, 51.16638792593794, 41.060544680772985, 52.749622022851455, 55.953915133293236, 53.09983436797127, 56.683316162425434, 49.39579172913538, 53.707211232503994, 49.005774535480725, 52.66486000154054, 41.76986237805368, 50.83760481269202, 53.33754293001063, 47.98317646587763, 48.52332509379396, 39.378047124669514, 48.64169568529336, 57.28198247556905, 51.080866813900755, 53.54820417708139, 53.75132247395947, 53.62200918628766, 48.20989119467023, 51.60659485870048, 40.20017832304805, 50.23631996043392, 54.32482643449325, 51.871001807022395, 50.38775325683015, 41.39601295532435, 51.206806527991525, 58.63747684958211, 52.47890658700943, 53.75252942046804, 53.89739148280189, 53.34033979420882, 45.64898585801706, 51.53231288301784, 38.71343103699532, 49.48089679166811, 53.936455455958054, 47.81718694035321, 48.5067620858682, 40.34266773881943, 54.13412897857607, 56.86554745156892, 49.013905848228994, 53.01014860332269, 52.98562200258747, 53.342333984256555, 52.61689288980779, 46.14047692096397, 37.07771370569603, 52.76940196530905, 54.86784129661834], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7666309188266793, "mean_inference_ms": 7.988069510876525, "mean_action_processing_ms": 0.5622338318081429, "mean_env_wait_ms": 24.306084785939873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05898308753967285, "StateBufferConnector_ms": 0.03963184356689453, "ViewRequirementAgentConnector_ms": 1.0218887329101562}}, "episode_reward_max": 59.32533499796414, "episode_reward_min": 37.07771370569603, "episode_reward_mean": 50.5580611366511, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.271226762520314, 54.99811968939071, 46.42255283603737, 51.4934170699047, 42.13987356763836, 55.214173708095004, 55.058820608492425, 50.871004271869545, 56.37540584920941, 52.679913467725235, 56.82187907531341, 54.24933995971276, 54.04797359345197, 39.852248916281575, 50.08733271078137, 50.366244389490596, 47.40852649312801, 51.78304904739204, 41.41244760816799, 53.471325360810646, 56.40146138521156, 50.56616037384683, 59.32533499796414, 53.98546052455343, 54.79572128315421, 50.77838480594105, 56.672810465183844, 41.25421291748722, 52.79354977433045, 51.500743952216844, 49.04775853564287, 52.40979831133378, 38.125869634553744, 54.20348266666523, 54.72452995796108, 50.64726377964771, 57.846990482867476, 47.778610277836684, 53.039505049065006, 50.23022736882979, 49.83974111120475, 40.72820103611501, 52.90484509859173, 53.648415000748585, 44.94052058942308, 51.16638792593794, 41.060544680772985, 52.749622022851455, 55.953915133293236, 53.09983436797127, 56.683316162425434, 49.39579172913538, 53.707211232503994, 49.005774535480725, 52.66486000154054, 41.76986237805368, 50.83760481269202, 53.33754293001063, 47.98317646587763, 48.52332509379396, 39.378047124669514, 48.64169568529336, 57.28198247556905, 51.080866813900755, 53.54820417708139, 53.75132247395947, 53.62200918628766, 48.20989119467023, 51.60659485870048, 40.20017832304805, 50.23631996043392, 54.32482643449325, 51.871001807022395, 50.38775325683015, 41.39601295532435, 51.206806527991525, 58.63747684958211, 52.47890658700943, 53.75252942046804, 53.89739148280189, 53.34033979420882, 45.64898585801706, 51.53231288301784, 38.71343103699532, 49.48089679166811, 53.936455455958054, 47.81718694035321, 48.5067620858682, 40.34266773881943, 54.13412897857607, 56.86554745156892, 49.013905848228994, 53.01014860332269, 52.98562200258747, 53.342333984256555, 52.61689288980779, 46.14047692096397, 37.07771370569603, 52.76940196530905, 54.86784129661834], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7666309188266793, "mean_inference_ms": 7.988069510876525, "mean_action_processing_ms": 0.5622338318081429, "mean_env_wait_ms": 24.306084785939873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05898308753967285, "StateBufferConnector_ms": 0.03963184356689453, "ViewRequirementAgentConnector_ms": 1.0218887329101562}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2095762, "num_agent_steps_trained": 2095762, "num_env_steps_sampled": 2095762, "num_env_steps_trained": 2095762, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 228.2633375645177, "num_env_steps_trained_throughput_per_sec": 228.2633375645177, "timesteps_total": 2095762, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2095762, "timers": {"training_iteration_time_ms": 68708.777, "sample_time_ms": 42420.245, "load_time_ms": 2353.089, "load_throughput": 6645.731, "learn_time_ms": 23353.134, "learn_throughput": 669.632, "synch_weights_time_ms": 459.574}, "counters": {"num_env_steps_sampled": 2095762, "num_env_steps_trained": 2095762, "num_agent_steps_sampled": 2095762, "num_agent_steps_trained": 2095762}, "done": false, "episodes_total": 1990, "training_iteration": 142, "trial_id": "837cb_00000", "date": "2025-06-07_20-04-19", "timestamp": 1749319459, "time_this_iter_s": 68.5240273475647, "time_total_s": 9506.221758842468, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9506.221758842468, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 64.77215189873418, "ram_util_percent": 90.01645569620253, "gpu_util_percent0": 0.21746835443037985, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.904238e-05, "total_loss": -0.07086279918111607, "policy_loss": -0.01896045059553051, "vf_loss": 0.013425451892597431, "vf_explained_var": 0.9621610778028314, "kl": 0.020802158004746836, "entropy": 17.05126029448076, "entropy_coeff": 0.003356357}, "model": {}, "num_grad_updates_lifetime": 74015.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2111400, "num_env_steps_trained": 2111400, "num_agent_steps_sampled": 2111400, "num_agent_steps_trained": 2111400}, "sampler_results": {"episode_reward_max": 59.32533499796414, "episode_reward_min": 37.07771370569603, "episode_reward_mean": 50.51818867731654, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.08733271078137, 50.366244389490596, 47.40852649312801, 51.78304904739204, 41.41244760816799, 53.471325360810646, 56.40146138521156, 50.56616037384683, 59.32533499796414, 53.98546052455343, 54.79572128315421, 50.77838480594105, 56.672810465183844, 41.25421291748722, 52.79354977433045, 51.500743952216844, 49.04775853564287, 52.40979831133378, 38.125869634553744, 54.20348266666523, 54.72452995796108, 50.64726377964771, 57.846990482867476, 47.778610277836684, 53.039505049065006, 50.23022736882979, 49.83974111120475, 40.72820103611501, 52.90484509859173, 53.648415000748585, 44.94052058942308, 51.16638792593794, 41.060544680772985, 52.749622022851455, 55.953915133293236, 53.09983436797127, 56.683316162425434, 49.39579172913538, 53.707211232503994, 49.005774535480725, 52.66486000154054, 41.76986237805368, 50.83760481269202, 53.33754293001063, 47.98317646587763, 48.52332509379396, 39.378047124669514, 48.64169568529336, 57.28198247556905, 51.080866813900755, 53.54820417708139, 53.75132247395947, 53.62200918628766, 48.20989119467023, 51.60659485870048, 40.20017832304805, 50.23631996043392, 54.32482643449325, 51.871001807022395, 50.38775325683015, 41.39601295532435, 51.206806527991525, 58.63747684958211, 52.47890658700943, 53.75252942046804, 53.89739148280189, 53.34033979420882, 45.64898585801706, 51.53231288301784, 38.71343103699532, 49.48089679166811, 53.936455455958054, 47.81718694035321, 48.5067620858682, 40.34266773881943, 54.13412897857607, 56.86554745156892, 49.013905848228994, 53.01014860332269, 52.98562200258747, 53.342333984256555, 52.61689288980779, 46.14047692096397, 37.07771370569603, 52.76940196530905, 54.86784129661834, 48.07915226340843, 50.38546147426138, 41.697252690342005, 54.32415343552556, 55.009172826616066, 51.02575804047022, 56.4300635032564, 53.11222204799658, 52.5046954198086, 51.39399885189622, 50.47989964048143, 40.57891188922536, 54.19637792807159, 54.29158343082763], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.76641208791726, "mean_inference_ms": 7.987785021218027, "mean_action_processing_ms": 0.5621446225908334, "mean_env_wait_ms": 24.308434307971755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06405448913574219, "StateBufferConnector_ms": 0.037770986557006836, "ViewRequirementAgentConnector_ms": 1.0099306106567383}}, "episode_reward_max": 59.32533499796414, "episode_reward_min": 37.07771370569603, "episode_reward_mean": 50.51818867731654, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.08733271078137, 50.366244389490596, 47.40852649312801, 51.78304904739204, 41.41244760816799, 53.471325360810646, 56.40146138521156, 50.56616037384683, 59.32533499796414, 53.98546052455343, 54.79572128315421, 50.77838480594105, 56.672810465183844, 41.25421291748722, 52.79354977433045, 51.500743952216844, 49.04775853564287, 52.40979831133378, 38.125869634553744, 54.20348266666523, 54.72452995796108, 50.64726377964771, 57.846990482867476, 47.778610277836684, 53.039505049065006, 50.23022736882979, 49.83974111120475, 40.72820103611501, 52.90484509859173, 53.648415000748585, 44.94052058942308, 51.16638792593794, 41.060544680772985, 52.749622022851455, 55.953915133293236, 53.09983436797127, 56.683316162425434, 49.39579172913538, 53.707211232503994, 49.005774535480725, 52.66486000154054, 41.76986237805368, 50.83760481269202, 53.33754293001063, 47.98317646587763, 48.52332509379396, 39.378047124669514, 48.64169568529336, 57.28198247556905, 51.080866813900755, 53.54820417708139, 53.75132247395947, 53.62200918628766, 48.20989119467023, 51.60659485870048, 40.20017832304805, 50.23631996043392, 54.32482643449325, 51.871001807022395, 50.38775325683015, 41.39601295532435, 51.206806527991525, 58.63747684958211, 52.47890658700943, 53.75252942046804, 53.89739148280189, 53.34033979420882, 45.64898585801706, 51.53231288301784, 38.71343103699532, 49.48089679166811, 53.936455455958054, 47.81718694035321, 48.5067620858682, 40.34266773881943, 54.13412897857607, 56.86554745156892, 49.013905848228994, 53.01014860332269, 52.98562200258747, 53.342333984256555, 52.61689288980779, 46.14047692096397, 37.07771370569603, 52.76940196530905, 54.86784129661834, 48.07915226340843, 50.38546147426138, 41.697252690342005, 54.32415343552556, 55.009172826616066, 51.02575804047022, 56.4300635032564, 53.11222204799658, 52.5046954198086, 51.39399885189622, 50.47989964048143, 40.57891188922536, 54.19637792807159, 54.29158343082763], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.76641208791726, "mean_inference_ms": 7.987785021218027, "mean_action_processing_ms": 0.5621446225908334, "mean_env_wait_ms": 24.308434307971755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06405448913574219, "StateBufferConnector_ms": 0.037770986557006836, "ViewRequirementAgentConnector_ms": 1.0099306106567383}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2111400, "num_agent_steps_trained": 2111400, "num_env_steps_sampled": 2111400, "num_env_steps_trained": 2111400, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.3309925533979, "num_env_steps_trained_throughput_per_sec": 227.3309925533979, "timesteps_total": 2111400, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2111400, "timers": {"training_iteration_time_ms": 68774.199, "sample_time_ms": 42476.187, "load_time_ms": 2351.363, "load_throughput": 6650.61, "learn_time_ms": 23367.084, "learn_throughput": 669.232, "synch_weights_time_ms": 457.505}, "counters": {"num_env_steps_sampled": 2111400, "num_env_steps_trained": 2111400, "num_agent_steps_sampled": 2111400, "num_agent_steps_trained": 2111400}, "done": false, "episodes_total": 2004, "training_iteration": 143, "trial_id": "837cb_00000", "date": "2025-06-07_20-05-28", "timestamp": 1749319528, "time_this_iter_s": 68.82172727584839, "time_total_s": 9575.043486118317, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9575.043486118317, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 65.3278481012658, "ram_util_percent": 89.57594936708858, "gpu_util_percent0": 0.21253164556962023, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.8886e-05, "total_loss": -0.0660798271061768, "policy_loss": -0.01482022805668583, "vf_loss": 0.014517173567278819, "vf_explained_var": 0.9604297294399955, "kl": 0.02040579485935019, "entropy": 17.069252560355448, "entropy_coeff": 0.0033329}, "model": {}, "num_grad_updates_lifetime": 74565.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2127038, "num_env_steps_trained": 2127038, "num_agent_steps_sampled": 2127038, "num_agent_steps_trained": 2127038}, "sampler_results": {"episode_reward_max": 58.63747684958211, "episode_reward_min": 37.07771370569603, "episode_reward_mean": 50.25496716443458, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.79354977433045, 51.500743952216844, 49.04775853564287, 52.40979831133378, 38.125869634553744, 54.20348266666523, 54.72452995796108, 50.64726377964771, 57.846990482867476, 47.778610277836684, 53.039505049065006, 50.23022736882979, 49.83974111120475, 40.72820103611501, 52.90484509859173, 53.648415000748585, 44.94052058942308, 51.16638792593794, 41.060544680772985, 52.749622022851455, 55.953915133293236, 53.09983436797127, 56.683316162425434, 49.39579172913538, 53.707211232503994, 49.005774535480725, 52.66486000154054, 41.76986237805368, 50.83760481269202, 53.33754293001063, 47.98317646587763, 48.52332509379396, 39.378047124669514, 48.64169568529336, 57.28198247556905, 51.080866813900755, 53.54820417708139, 53.75132247395947, 53.62200918628766, 48.20989119467023, 51.60659485870048, 40.20017832304805, 50.23631996043392, 54.32482643449325, 51.871001807022395, 50.38775325683015, 41.39601295532435, 51.206806527991525, 58.63747684958211, 52.47890658700943, 53.75252942046804, 53.89739148280189, 53.34033979420882, 45.64898585801706, 51.53231288301784, 38.71343103699532, 49.48089679166811, 53.936455455958054, 47.81718694035321, 48.5067620858682, 40.34266773881943, 54.13412897857607, 56.86554745156892, 49.013905848228994, 53.01014860332269, 52.98562200258747, 53.342333984256555, 52.61689288980779, 46.14047692096397, 37.07771370569603, 52.76940196530905, 54.86784129661834, 48.07915226340843, 50.38546147426138, 41.697252690342005, 54.32415343552556, 55.009172826616066, 51.02575804047022, 56.4300635032564, 53.11222204799658, 52.5046954198086, 51.39399885189622, 50.47989964048143, 40.57891188922536, 54.19637792807159, 54.29158343082763, 51.2455837373804, 51.80230897317596, 42.00083455953056, 48.41601913407488, 53.669379666757735, 51.38853204651848, 46.473684766182025, 49.83747910007949, 51.013640206660675, 50.67661851106253, 52.501948305073405, 38.48043792064422, 50.7570597636258, 53.722794384150454], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.766244902014543, "mean_inference_ms": 7.98769334801012, "mean_action_processing_ms": 0.5620641878892702, "mean_env_wait_ms": 24.310910420779233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05870223045349121, "StateBufferConnector_ms": 0.038802146911621094, "ViewRequirementAgentConnector_ms": 1.0417098999023438}}, "episode_reward_max": 58.63747684958211, "episode_reward_min": 37.07771370569603, "episode_reward_mean": 50.25496716443458, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.79354977433045, 51.500743952216844, 49.04775853564287, 52.40979831133378, 38.125869634553744, 54.20348266666523, 54.72452995796108, 50.64726377964771, 57.846990482867476, 47.778610277836684, 53.039505049065006, 50.23022736882979, 49.83974111120475, 40.72820103611501, 52.90484509859173, 53.648415000748585, 44.94052058942308, 51.16638792593794, 41.060544680772985, 52.749622022851455, 55.953915133293236, 53.09983436797127, 56.683316162425434, 49.39579172913538, 53.707211232503994, 49.005774535480725, 52.66486000154054, 41.76986237805368, 50.83760481269202, 53.33754293001063, 47.98317646587763, 48.52332509379396, 39.378047124669514, 48.64169568529336, 57.28198247556905, 51.080866813900755, 53.54820417708139, 53.75132247395947, 53.62200918628766, 48.20989119467023, 51.60659485870048, 40.20017832304805, 50.23631996043392, 54.32482643449325, 51.871001807022395, 50.38775325683015, 41.39601295532435, 51.206806527991525, 58.63747684958211, 52.47890658700943, 53.75252942046804, 53.89739148280189, 53.34033979420882, 45.64898585801706, 51.53231288301784, 38.71343103699532, 49.48089679166811, 53.936455455958054, 47.81718694035321, 48.5067620858682, 40.34266773881943, 54.13412897857607, 56.86554745156892, 49.013905848228994, 53.01014860332269, 52.98562200258747, 53.342333984256555, 52.61689288980779, 46.14047692096397, 37.07771370569603, 52.76940196530905, 54.86784129661834, 48.07915226340843, 50.38546147426138, 41.697252690342005, 54.32415343552556, 55.009172826616066, 51.02575804047022, 56.4300635032564, 53.11222204799658, 52.5046954198086, 51.39399885189622, 50.47989964048143, 40.57891188922536, 54.19637792807159, 54.29158343082763, 51.2455837373804, 51.80230897317596, 42.00083455953056, 48.41601913407488, 53.669379666757735, 51.38853204651848, 46.473684766182025, 49.83747910007949, 51.013640206660675, 50.67661851106253, 52.501948305073405, 38.48043792064422, 50.7570597636258, 53.722794384150454], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.766244902014543, "mean_inference_ms": 7.98769334801012, "mean_action_processing_ms": 0.5620641878892702, "mean_env_wait_ms": 24.310910420779233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05870223045349121, "StateBufferConnector_ms": 0.038802146911621094, "ViewRequirementAgentConnector_ms": 1.0417098999023438}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2127038, "num_agent_steps_trained": 2127038, "num_env_steps_sampled": 2127038, "num_env_steps_trained": 2127038, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 225.7969510812298, "num_env_steps_trained_throughput_per_sec": 225.7969510812298, "timesteps_total": 2127038, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2127038, "timers": {"training_iteration_time_ms": 68744.308, "sample_time_ms": 42496.871, "load_time_ms": 2282.993, "load_throughput": 6849.78, "learn_time_ms": 23383.831, "learn_throughput": 668.753, "synch_weights_time_ms": 459.613}, "counters": {"num_env_steps_sampled": 2127038, "num_env_steps_trained": 2127038, "num_agent_steps_sampled": 2127038, "num_agent_steps_trained": 2127038}, "done": false, "episodes_total": 2018, "training_iteration": 144, "trial_id": "837cb_00000", "date": "2025-06-07_20-06-37", "timestamp": 1749319597, "time_this_iter_s": 69.27390098571777, "time_total_s": 9644.317387104034, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9644.317387104034, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 64.99493670886076, "ram_util_percent": 89.49746835443038, "gpu_util_percent0": 0.21392405063291142, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.872961999999999e-05, "total_loss": -0.06772725671910766, "policy_loss": -0.01681247617459369, "vf_loss": 0.013698578989556568, "vf_explained_var": 0.9624666704914787, "kl": 0.02081577055902783, "entropy": 17.019584040208297, "entropy_coeff": 0.0033094429999999996}, "model": {}, "num_grad_updates_lifetime": 75115.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2142676, "num_env_steps_trained": 2142676, "num_agent_steps_sampled": 2142676, "num_agent_steps_trained": 2142676}, "sampler_results": {"episode_reward_max": 58.63747684958211, "episode_reward_min": 37.07771370569603, "episode_reward_mean": 50.07899926078847, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.90484509859173, 53.648415000748585, 44.94052058942308, 51.16638792593794, 41.060544680772985, 52.749622022851455, 55.953915133293236, 53.09983436797127, 56.683316162425434, 49.39579172913538, 53.707211232503994, 49.005774535480725, 52.66486000154054, 41.76986237805368, 50.83760481269202, 53.33754293001063, 47.98317646587763, 48.52332509379396, 39.378047124669514, 48.64169568529336, 57.28198247556905, 51.080866813900755, 53.54820417708139, 53.75132247395947, 53.62200918628766, 48.20989119467023, 51.60659485870048, 40.20017832304805, 50.23631996043392, 54.32482643449325, 51.871001807022395, 50.38775325683015, 41.39601295532435, 51.206806527991525, 58.63747684958211, 52.47890658700943, 53.75252942046804, 53.89739148280189, 53.34033979420882, 45.64898585801706, 51.53231288301784, 38.71343103699532, 49.48089679166811, 53.936455455958054, 47.81718694035321, 48.5067620858682, 40.34266773881943, 54.13412897857607, 56.86554745156892, 49.013905848228994, 53.01014860332269, 52.98562200258747, 53.342333984256555, 52.61689288980779, 46.14047692096397, 37.07771370569603, 52.76940196530905, 54.86784129661834, 48.07915226340843, 50.38546147426138, 41.697252690342005, 54.32415343552556, 55.009172826616066, 51.02575804047022, 56.4300635032564, 53.11222204799658, 52.5046954198086, 51.39399885189622, 50.47989964048143, 40.57891188922536, 54.19637792807159, 54.29158343082763, 51.2455837373804, 51.80230897317596, 42.00083455953056, 48.41601913407488, 53.669379666757735, 51.38853204651848, 46.473684766182025, 49.83747910007949, 51.013640206660675, 50.67661851106253, 52.501948305073405, 38.48043792064422, 50.7570597636258, 53.722794384150454, 49.4278137239908, 51.802760044468215, 40.57621666497399, 49.38768387085322, 51.30700127928175, 47.73351123903606, 55.98500161564285, 44.47806877061931, 50.340187186141605, 49.689607367039635, 51.6469885457025, 37.80623550037398, 50.11344597922103, 55.024959786314035], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7658464410600936, "mean_inference_ms": 7.9875113736660595, "mean_action_processing_ms": 0.5619757162230286, "mean_env_wait_ms": 24.313085162419593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05127120018005371, "StateBufferConnector_ms": 0.04532623291015625, "ViewRequirementAgentConnector_ms": 1.0369155406951904}}, "episode_reward_max": 58.63747684958211, "episode_reward_min": 37.07771370569603, "episode_reward_mean": 50.07899926078847, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.90484509859173, 53.648415000748585, 44.94052058942308, 51.16638792593794, 41.060544680772985, 52.749622022851455, 55.953915133293236, 53.09983436797127, 56.683316162425434, 49.39579172913538, 53.707211232503994, 49.005774535480725, 52.66486000154054, 41.76986237805368, 50.83760481269202, 53.33754293001063, 47.98317646587763, 48.52332509379396, 39.378047124669514, 48.64169568529336, 57.28198247556905, 51.080866813900755, 53.54820417708139, 53.75132247395947, 53.62200918628766, 48.20989119467023, 51.60659485870048, 40.20017832304805, 50.23631996043392, 54.32482643449325, 51.871001807022395, 50.38775325683015, 41.39601295532435, 51.206806527991525, 58.63747684958211, 52.47890658700943, 53.75252942046804, 53.89739148280189, 53.34033979420882, 45.64898585801706, 51.53231288301784, 38.71343103699532, 49.48089679166811, 53.936455455958054, 47.81718694035321, 48.5067620858682, 40.34266773881943, 54.13412897857607, 56.86554745156892, 49.013905848228994, 53.01014860332269, 52.98562200258747, 53.342333984256555, 52.61689288980779, 46.14047692096397, 37.07771370569603, 52.76940196530905, 54.86784129661834, 48.07915226340843, 50.38546147426138, 41.697252690342005, 54.32415343552556, 55.009172826616066, 51.02575804047022, 56.4300635032564, 53.11222204799658, 52.5046954198086, 51.39399885189622, 50.47989964048143, 40.57891188922536, 54.19637792807159, 54.29158343082763, 51.2455837373804, 51.80230897317596, 42.00083455953056, 48.41601913407488, 53.669379666757735, 51.38853204651848, 46.473684766182025, 49.83747910007949, 51.013640206660675, 50.67661851106253, 52.501948305073405, 38.48043792064422, 50.7570597636258, 53.722794384150454, 49.4278137239908, 51.802760044468215, 40.57621666497399, 49.38768387085322, 51.30700127928175, 47.73351123903606, 55.98500161564285, 44.47806877061931, 50.340187186141605, 49.689607367039635, 51.6469885457025, 37.80623550037398, 50.11344597922103, 55.024959786314035], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7658464410600936, "mean_inference_ms": 7.9875113736660595, "mean_action_processing_ms": 0.5619757162230286, "mean_env_wait_ms": 24.313085162419593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05127120018005371, "StateBufferConnector_ms": 0.04532623291015625, "ViewRequirementAgentConnector_ms": 1.0369155406951904}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2142676, "num_agent_steps_trained": 2142676, "num_env_steps_sampled": 2142676, "num_env_steps_trained": 2142676, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.4524301140344, "num_env_steps_trained_throughput_per_sec": 229.4524301140344, "timesteps_total": 2142676, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2142676, "timers": {"training_iteration_time_ms": 68716.662, "sample_time_ms": 42478.64, "load_time_ms": 2280.607, "load_throughput": 6856.947, "learn_time_ms": 23375.841, "learn_throughput": 668.981, "synch_weights_time_ms": 460.268}, "counters": {"num_env_steps_sampled": 2142676, "num_env_steps_trained": 2142676, "num_agent_steps_sampled": 2142676, "num_agent_steps_trained": 2142676}, "done": false, "episodes_total": 2032, "training_iteration": 145, "trial_id": "837cb_00000", "date": "2025-06-07_20-07-46", "timestamp": 1749319666, "time_this_iter_s": 68.17110419273376, "time_total_s": 9712.488491296768, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9712.488491296768, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 64.7423076923077, "ram_util_percent": 89.4794871794872, "gpu_util_percent0": 0.2171794871794872, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.857323999999998e-05, "total_loss": -0.0674270917176777, "policy_loss": -0.016871246979571878, "vf_loss": 0.013265674188309772, "vf_explained_var": 0.9648116879029708, "kl": 0.020890634159868814, "entropy": 16.993746804324065, "entropy_coeff": 0.0032859860000000007}, "model": {}, "num_grad_updates_lifetime": 75665.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2158314, "num_env_steps_trained": 2158314, "num_agent_steps_sampled": 2158314, "num_agent_steps_trained": 2158314}, "sampler_results": {"episode_reward_max": 58.63747684958211, "episode_reward_min": 37.07771370569603, "episode_reward_mean": 49.891240000380705, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.83760481269202, 53.33754293001063, 47.98317646587763, 48.52332509379396, 39.378047124669514, 48.64169568529336, 57.28198247556905, 51.080866813900755, 53.54820417708139, 53.75132247395947, 53.62200918628766, 48.20989119467023, 51.60659485870048, 40.20017832304805, 50.23631996043392, 54.32482643449325, 51.871001807022395, 50.38775325683015, 41.39601295532435, 51.206806527991525, 58.63747684958211, 52.47890658700943, 53.75252942046804, 53.89739148280189, 53.34033979420882, 45.64898585801706, 51.53231288301784, 38.71343103699532, 49.48089679166811, 53.936455455958054, 47.81718694035321, 48.5067620858682, 40.34266773881943, 54.13412897857607, 56.86554745156892, 49.013905848228994, 53.01014860332269, 52.98562200258747, 53.342333984256555, 52.61689288980779, 46.14047692096397, 37.07771370569603, 52.76940196530905, 54.86784129661834, 48.07915226340843, 50.38546147426138, 41.697252690342005, 54.32415343552556, 55.009172826616066, 51.02575804047022, 56.4300635032564, 53.11222204799658, 52.5046954198086, 51.39399885189622, 50.47989964048143, 40.57891188922536, 54.19637792807159, 54.29158343082763, 51.2455837373804, 51.80230897317596, 42.00083455953056, 48.41601913407488, 53.669379666757735, 51.38853204651848, 46.473684766182025, 49.83747910007949, 51.013640206660675, 50.67661851106253, 52.501948305073405, 38.48043792064422, 50.7570597636258, 53.722794384150454, 49.4278137239908, 51.802760044468215, 40.57621666497399, 49.38768387085322, 51.30700127928175, 47.73351123903606, 55.98500161564285, 44.47806877061931, 50.340187186141605, 49.689607367039635, 51.6469885457025, 37.80623550037398, 50.11344597922103, 55.024959786314035, 49.1438663599514, 45.02116880604734, 40.886707208362104, 49.86647806289915, 52.18214073198174, 48.310482361816995, 58.48638045277565, 51.31127826884173, 52.200043156326444, 50.82086269393875, 49.8162636605082, 39.56809637477741, 51.54674860163741, 50.814458078088634], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7653844649008206, "mean_inference_ms": 7.9871929188044115, "mean_action_processing_ms": 0.5618888119627922, "mean_env_wait_ms": 24.31545821789851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052370548248291016, "StateBufferConnector_ms": 0.0427556037902832, "ViewRequirementAgentConnector_ms": 1.0148930549621582}}, "episode_reward_max": 58.63747684958211, "episode_reward_min": 37.07771370569603, "episode_reward_mean": 49.891240000380705, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.83760481269202, 53.33754293001063, 47.98317646587763, 48.52332509379396, 39.378047124669514, 48.64169568529336, 57.28198247556905, 51.080866813900755, 53.54820417708139, 53.75132247395947, 53.62200918628766, 48.20989119467023, 51.60659485870048, 40.20017832304805, 50.23631996043392, 54.32482643449325, 51.871001807022395, 50.38775325683015, 41.39601295532435, 51.206806527991525, 58.63747684958211, 52.47890658700943, 53.75252942046804, 53.89739148280189, 53.34033979420882, 45.64898585801706, 51.53231288301784, 38.71343103699532, 49.48089679166811, 53.936455455958054, 47.81718694035321, 48.5067620858682, 40.34266773881943, 54.13412897857607, 56.86554745156892, 49.013905848228994, 53.01014860332269, 52.98562200258747, 53.342333984256555, 52.61689288980779, 46.14047692096397, 37.07771370569603, 52.76940196530905, 54.86784129661834, 48.07915226340843, 50.38546147426138, 41.697252690342005, 54.32415343552556, 55.009172826616066, 51.02575804047022, 56.4300635032564, 53.11222204799658, 52.5046954198086, 51.39399885189622, 50.47989964048143, 40.57891188922536, 54.19637792807159, 54.29158343082763, 51.2455837373804, 51.80230897317596, 42.00083455953056, 48.41601913407488, 53.669379666757735, 51.38853204651848, 46.473684766182025, 49.83747910007949, 51.013640206660675, 50.67661851106253, 52.501948305073405, 38.48043792064422, 50.7570597636258, 53.722794384150454, 49.4278137239908, 51.802760044468215, 40.57621666497399, 49.38768387085322, 51.30700127928175, 47.73351123903606, 55.98500161564285, 44.47806877061931, 50.340187186141605, 49.689607367039635, 51.6469885457025, 37.80623550037398, 50.11344597922103, 55.024959786314035, 49.1438663599514, 45.02116880604734, 40.886707208362104, 49.86647806289915, 52.18214073198174, 48.310482361816995, 58.48638045277565, 51.31127826884173, 52.200043156326444, 50.82086269393875, 49.8162636605082, 39.56809637477741, 51.54674860163741, 50.814458078088634], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7653844649008206, "mean_inference_ms": 7.9871929188044115, "mean_action_processing_ms": 0.5618888119627922, "mean_env_wait_ms": 24.31545821789851, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052370548248291016, "StateBufferConnector_ms": 0.0427556037902832, "ViewRequirementAgentConnector_ms": 1.0148930549621582}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2158314, "num_agent_steps_trained": 2158314, "num_env_steps_sampled": 2158314, "num_env_steps_trained": 2158314, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.41166846032357, "num_env_steps_trained_throughput_per_sec": 226.41166846032357, "timesteps_total": 2158314, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2158314, "timers": {"training_iteration_time_ms": 68811.929, "sample_time_ms": 42576.375, "load_time_ms": 2275.747, "load_throughput": 6871.591, "learn_time_ms": 23384.047, "learn_throughput": 668.747, "synch_weights_time_ms": 454.781}, "counters": {"num_env_steps_sampled": 2158314, "num_env_steps_trained": 2158314, "num_agent_steps_sampled": 2158314, "num_agent_steps_trained": 2158314}, "done": false, "episodes_total": 2046, "training_iteration": 146, "trial_id": "837cb_00000", "date": "2025-06-07_20-08-55", "timestamp": 1749319735, "time_this_iter_s": 69.0688784122467, "time_total_s": 9781.557369709015, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9781.557369709015, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 63.83461538461539, "ram_util_percent": 89.68076923076923, "gpu_util_percent0": 0.22038461538461535, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.841686000000001e-05, "total_loss": -0.06660105152521283, "policy_loss": -0.015948643759528005, "vf_loss": 0.011937824463556436, "vf_explained_var": 0.9680385134436867, "kl": 0.020301274070414755, "entropy": 17.012135261188853, "entropy_coeff": 0.003262529}, "model": {}, "num_grad_updates_lifetime": 76215.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2173952, "num_env_steps_trained": 2173952, "num_agent_steps_sampled": 2173952, "num_agent_steps_trained": 2173952}, "sampler_results": {"episode_reward_max": 58.63747684958211, "episode_reward_min": 36.62024324680749, "episode_reward_mean": 49.829011338909076, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.23631996043392, 54.32482643449325, 51.871001807022395, 50.38775325683015, 41.39601295532435, 51.206806527991525, 58.63747684958211, 52.47890658700943, 53.75252942046804, 53.89739148280189, 53.34033979420882, 45.64898585801706, 51.53231288301784, 38.71343103699532, 49.48089679166811, 53.936455455958054, 47.81718694035321, 48.5067620858682, 40.34266773881943, 54.13412897857607, 56.86554745156892, 49.013905848228994, 53.01014860332269, 52.98562200258747, 53.342333984256555, 52.61689288980779, 46.14047692096397, 37.07771370569603, 52.76940196530905, 54.86784129661834, 48.07915226340843, 50.38546147426138, 41.697252690342005, 54.32415343552556, 55.009172826616066, 51.02575804047022, 56.4300635032564, 53.11222204799658, 52.5046954198086, 51.39399885189622, 50.47989964048143, 40.57891188922536, 54.19637792807159, 54.29158343082763, 51.2455837373804, 51.80230897317596, 42.00083455953056, 48.41601913407488, 53.669379666757735, 51.38853204651848, 46.473684766182025, 49.83747910007949, 51.013640206660675, 50.67661851106253, 52.501948305073405, 38.48043792064422, 50.7570597636258, 53.722794384150454, 49.4278137239908, 51.802760044468215, 40.57621666497399, 49.38768387085322, 51.30700127928175, 47.73351123903606, 55.98500161564285, 44.47806877061931, 50.340187186141605, 49.689607367039635, 51.6469885457025, 37.80623550037398, 50.11344597922103, 55.024959786314035, 49.1438663599514, 45.02116880604734, 40.886707208362104, 49.86647806289915, 52.18214073198174, 48.310482361816995, 58.48638045277565, 51.31127826884173, 52.200043156326444, 50.82086269393875, 49.8162636605082, 39.56809637477741, 51.54674860163741, 50.814458078088634, 50.789163631192196, 48.840841751481996, 38.83621103473991, 51.765308403188264, 55.64893188381249, 45.81854603298516, 53.871912798025676, 51.64852020924411, 52.5958078627188, 48.117121019743465, 50.08340241945752, 36.62024324680749, 55.48758123092548, 51.65598394407083], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7647104036561183, "mean_inference_ms": 7.98709327786677, "mean_action_processing_ms": 0.5618227841487939, "mean_env_wait_ms": 24.317832814187003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04441523551940918, "StateBufferConnector_ms": 0.037512779235839844, "ViewRequirementAgentConnector_ms": 1.004072904586792}}, "episode_reward_max": 58.63747684958211, "episode_reward_min": 36.62024324680749, "episode_reward_mean": 49.829011338909076, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.23631996043392, 54.32482643449325, 51.871001807022395, 50.38775325683015, 41.39601295532435, 51.206806527991525, 58.63747684958211, 52.47890658700943, 53.75252942046804, 53.89739148280189, 53.34033979420882, 45.64898585801706, 51.53231288301784, 38.71343103699532, 49.48089679166811, 53.936455455958054, 47.81718694035321, 48.5067620858682, 40.34266773881943, 54.13412897857607, 56.86554745156892, 49.013905848228994, 53.01014860332269, 52.98562200258747, 53.342333984256555, 52.61689288980779, 46.14047692096397, 37.07771370569603, 52.76940196530905, 54.86784129661834, 48.07915226340843, 50.38546147426138, 41.697252690342005, 54.32415343552556, 55.009172826616066, 51.02575804047022, 56.4300635032564, 53.11222204799658, 52.5046954198086, 51.39399885189622, 50.47989964048143, 40.57891188922536, 54.19637792807159, 54.29158343082763, 51.2455837373804, 51.80230897317596, 42.00083455953056, 48.41601913407488, 53.669379666757735, 51.38853204651848, 46.473684766182025, 49.83747910007949, 51.013640206660675, 50.67661851106253, 52.501948305073405, 38.48043792064422, 50.7570597636258, 53.722794384150454, 49.4278137239908, 51.802760044468215, 40.57621666497399, 49.38768387085322, 51.30700127928175, 47.73351123903606, 55.98500161564285, 44.47806877061931, 50.340187186141605, 49.689607367039635, 51.6469885457025, 37.80623550037398, 50.11344597922103, 55.024959786314035, 49.1438663599514, 45.02116880604734, 40.886707208362104, 49.86647806289915, 52.18214073198174, 48.310482361816995, 58.48638045277565, 51.31127826884173, 52.200043156326444, 50.82086269393875, 49.8162636605082, 39.56809637477741, 51.54674860163741, 50.814458078088634, 50.789163631192196, 48.840841751481996, 38.83621103473991, 51.765308403188264, 55.64893188381249, 45.81854603298516, 53.871912798025676, 51.64852020924411, 52.5958078627188, 48.117121019743465, 50.08340241945752, 36.62024324680749, 55.48758123092548, 51.65598394407083], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7647104036561183, "mean_inference_ms": 7.98709327786677, "mean_action_processing_ms": 0.5618227841487939, "mean_env_wait_ms": 24.317832814187003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04441523551940918, "StateBufferConnector_ms": 0.037512779235839844, "ViewRequirementAgentConnector_ms": 1.004072904586792}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2173952, "num_agent_steps_trained": 2173952, "num_env_steps_sampled": 2173952, "num_env_steps_trained": 2173952, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.03969019337907, "num_env_steps_trained_throughput_per_sec": 227.03969019337907, "timesteps_total": 2173952, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2173952, "timers": {"training_iteration_time_ms": 68862.818, "sample_time_ms": 42615.78, "load_time_ms": 2296.138, "load_throughput": 6810.567, "learn_time_ms": 23371.082, "learn_throughput": 669.117, "synch_weights_time_ms": 457.827}, "counters": {"num_env_steps_sampled": 2173952, "num_env_steps_trained": 2173952, "num_agent_steps_sampled": 2173952, "num_agent_steps_trained": 2173952}, "done": false, "episodes_total": 2060, "training_iteration": 147, "trial_id": "837cb_00000", "date": "2025-06-07_20-10-04", "timestamp": 1749319804, "time_this_iter_s": 68.89481210708618, "time_total_s": 9850.452181816101, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9850.452181816101, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 65.45443037974682, "ram_util_percent": 89.4493670886076, "gpu_util_percent0": 0.21759493670886082, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.826047999999999e-05, "total_loss": -0.08043097518532621, "policy_loss": -0.030418115926149767, "vf_loss": 0.012808665936728093, "vf_explained_var": 0.9624955331195485, "kl": 0.020990252276022133, "entropy": 17.03183880545876, "entropy_coeff": 0.003239072}, "model": {}, "num_grad_updates_lifetime": 76765.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2189590, "num_env_steps_trained": 2189590, "num_agent_steps_sampled": 2189590, "num_agent_steps_trained": 2189590}, "sampler_results": {"episode_reward_max": 58.48638045277565, "episode_reward_min": 36.62024324680749, "episode_reward_mean": 49.67726018934422, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.48089679166811, 53.936455455958054, 47.81718694035321, 48.5067620858682, 40.34266773881943, 54.13412897857607, 56.86554745156892, 49.013905848228994, 53.01014860332269, 52.98562200258747, 53.342333984256555, 52.61689288980779, 46.14047692096397, 37.07771370569603, 52.76940196530905, 54.86784129661834, 48.07915226340843, 50.38546147426138, 41.697252690342005, 54.32415343552556, 55.009172826616066, 51.02575804047022, 56.4300635032564, 53.11222204799658, 52.5046954198086, 51.39399885189622, 50.47989964048143, 40.57891188922536, 54.19637792807159, 54.29158343082763, 51.2455837373804, 51.80230897317596, 42.00083455953056, 48.41601913407488, 53.669379666757735, 51.38853204651848, 46.473684766182025, 49.83747910007949, 51.013640206660675, 50.67661851106253, 52.501948305073405, 38.48043792064422, 50.7570597636258, 53.722794384150454, 49.4278137239908, 51.802760044468215, 40.57621666497399, 49.38768387085322, 51.30700127928175, 47.73351123903606, 55.98500161564285, 44.47806877061931, 50.340187186141605, 49.689607367039635, 51.6469885457025, 37.80623550037398, 50.11344597922103, 55.024959786314035, 49.1438663599514, 45.02116880604734, 40.886707208362104, 49.86647806289915, 52.18214073198174, 48.310482361816995, 58.48638045277565, 51.31127826884173, 52.200043156326444, 50.82086269393875, 49.8162636605082, 39.56809637477741, 51.54674860163741, 50.814458078088634, 50.789163631192196, 48.840841751481996, 38.83621103473991, 51.765308403188264, 55.64893188381249, 45.81854603298516, 53.871912798025676, 51.64852020924411, 52.5958078627188, 48.117121019743465, 50.08340241945752, 36.62024324680749, 55.48758123092548, 51.65598394407083, 49.979915128479334, 49.365440946355974, 40.18666122207085, 48.6834004251876, 52.91212927557233, 48.35742408467833, 55.8331317900887, 54.95163166095832, 51.78692103250073, 51.472865061918874, 52.11364295346021, 39.81487912160902, 48.34779818647192, 48.44313900835708], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7640379453156703, "mean_inference_ms": 7.986989164656617, "mean_action_processing_ms": 0.561781183775119, "mean_env_wait_ms": 24.320122693580497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03839874267578125, "StateBufferConnector_ms": 0.04152870178222656, "ViewRequirementAgentConnector_ms": 0.973217248916626}}, "episode_reward_max": 58.48638045277565, "episode_reward_min": 36.62024324680749, "episode_reward_mean": 49.67726018934422, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [49.48089679166811, 53.936455455958054, 47.81718694035321, 48.5067620858682, 40.34266773881943, 54.13412897857607, 56.86554745156892, 49.013905848228994, 53.01014860332269, 52.98562200258747, 53.342333984256555, 52.61689288980779, 46.14047692096397, 37.07771370569603, 52.76940196530905, 54.86784129661834, 48.07915226340843, 50.38546147426138, 41.697252690342005, 54.32415343552556, 55.009172826616066, 51.02575804047022, 56.4300635032564, 53.11222204799658, 52.5046954198086, 51.39399885189622, 50.47989964048143, 40.57891188922536, 54.19637792807159, 54.29158343082763, 51.2455837373804, 51.80230897317596, 42.00083455953056, 48.41601913407488, 53.669379666757735, 51.38853204651848, 46.473684766182025, 49.83747910007949, 51.013640206660675, 50.67661851106253, 52.501948305073405, 38.48043792064422, 50.7570597636258, 53.722794384150454, 49.4278137239908, 51.802760044468215, 40.57621666497399, 49.38768387085322, 51.30700127928175, 47.73351123903606, 55.98500161564285, 44.47806877061931, 50.340187186141605, 49.689607367039635, 51.6469885457025, 37.80623550037398, 50.11344597922103, 55.024959786314035, 49.1438663599514, 45.02116880604734, 40.886707208362104, 49.86647806289915, 52.18214073198174, 48.310482361816995, 58.48638045277565, 51.31127826884173, 52.200043156326444, 50.82086269393875, 49.8162636605082, 39.56809637477741, 51.54674860163741, 50.814458078088634, 50.789163631192196, 48.840841751481996, 38.83621103473991, 51.765308403188264, 55.64893188381249, 45.81854603298516, 53.871912798025676, 51.64852020924411, 52.5958078627188, 48.117121019743465, 50.08340241945752, 36.62024324680749, 55.48758123092548, 51.65598394407083, 49.979915128479334, 49.365440946355974, 40.18666122207085, 48.6834004251876, 52.91212927557233, 48.35742408467833, 55.8331317900887, 54.95163166095832, 51.78692103250073, 51.472865061918874, 52.11364295346021, 39.81487912160902, 48.34779818647192, 48.44313900835708], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7640379453156703, "mean_inference_ms": 7.986989164656617, "mean_action_processing_ms": 0.561781183775119, "mean_env_wait_ms": 24.320122693580497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03839874267578125, "StateBufferConnector_ms": 0.04152870178222656, "ViewRequirementAgentConnector_ms": 0.973217248916626}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2189590, "num_agent_steps_trained": 2189590, "num_env_steps_sampled": 2189590, "num_env_steps_trained": 2189590, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.36054009792272, "num_env_steps_trained_throughput_per_sec": 226.36054009792272, "timesteps_total": 2189590, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2189590, "timers": {"training_iteration_time_ms": 68910.735, "sample_time_ms": 42631.134, "load_time_ms": 2304.677, "load_throughput": 6785.332, "learn_time_ms": 23394.023, "learn_throughput": 668.461, "synch_weights_time_ms": 458.573}, "counters": {"num_env_steps_sampled": 2189590, "num_env_steps_trained": 2189590, "num_agent_steps_sampled": 2189590, "num_agent_steps_trained": 2189590}, "done": false, "episodes_total": 2074, "training_iteration": 148, "trial_id": "837cb_00000", "date": "2025-06-07_20-11-13", "timestamp": 1749319873, "time_this_iter_s": 69.1059262752533, "time_total_s": 9919.558108091354, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9919.558108091354, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 64.45822784810125, "ram_util_percent": 89.63291139240508, "gpu_util_percent0": 0.21518987341772156, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.810410000000002e-05, "total_loss": -0.04342509717966261, "policy_loss": 0.006034566044849767, "vf_loss": 0.013473423960280012, "vf_explained_var": 0.9647705867073753, "kl": 0.021549872950947083, "entropy": 17.056942532279276, "entropy_coeff": 0.003215615000000001}, "model": {}, "num_grad_updates_lifetime": 77315.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2205228, "num_env_steps_trained": 2205228, "num_agent_steps_sampled": 2205228, "num_agent_steps_trained": 2205228}, "sampler_results": {"episode_reward_max": 58.48638045277565, "episode_reward_min": 36.59934182043771, "episode_reward_mean": 49.337267710716226, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.76940196530905, 54.86784129661834, 48.07915226340843, 50.38546147426138, 41.697252690342005, 54.32415343552556, 55.009172826616066, 51.02575804047022, 56.4300635032564, 53.11222204799658, 52.5046954198086, 51.39399885189622, 50.47989964048143, 40.57891188922536, 54.19637792807159, 54.29158343082763, 51.2455837373804, 51.80230897317596, 42.00083455953056, 48.41601913407488, 53.669379666757735, 51.38853204651848, 46.473684766182025, 49.83747910007949, 51.013640206660675, 50.67661851106253, 52.501948305073405, 38.48043792064422, 50.7570597636258, 53.722794384150454, 49.4278137239908, 51.802760044468215, 40.57621666497399, 49.38768387085322, 51.30700127928175, 47.73351123903606, 55.98500161564285, 44.47806877061931, 50.340187186141605, 49.689607367039635, 51.6469885457025, 37.80623550037398, 50.11344597922103, 55.024959786314035, 49.1438663599514, 45.02116880604734, 40.886707208362104, 49.86647806289915, 52.18214073198174, 48.310482361816995, 58.48638045277565, 51.31127826884173, 52.200043156326444, 50.82086269393875, 49.8162636605082, 39.56809637477741, 51.54674860163741, 50.814458078088634, 50.789163631192196, 48.840841751481996, 38.83621103473991, 51.765308403188264, 55.64893188381249, 45.81854603298516, 53.871912798025676, 51.64852020924411, 52.5958078627188, 48.117121019743465, 50.08340241945752, 36.62024324680749, 55.48758123092548, 51.65598394407083, 49.979915128479334, 49.365440946355974, 40.18666122207085, 48.6834004251876, 52.91212927557233, 48.35742408467833, 55.8331317900887, 54.95163166095832, 51.78692103250073, 51.472865061918874, 52.11364295346021, 39.81487912160902, 48.34779818647192, 48.44313900835708, 45.2904647019318, 49.5020492947991, 38.88043242209515, 41.490498798287845, 54.09722368982152, 41.51204561810312, 52.29391554281647, 51.95966691341315, 51.87601524996049, 46.00102034823018, 49.05940687803659, 36.59934182043771, 50.38347915560147, 52.32593110134189], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7633259287598095, "mean_inference_ms": 7.986931911581838, "mean_action_processing_ms": 0.5617454632026072, "mean_env_wait_ms": 24.323223043701272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02935624122619629, "StateBufferConnector_ms": 0.043506622314453125, "ViewRequirementAgentConnector_ms": 0.9493923187255859}}, "episode_reward_max": 58.48638045277565, "episode_reward_min": 36.59934182043771, "episode_reward_mean": 49.337267710716226, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.76940196530905, 54.86784129661834, 48.07915226340843, 50.38546147426138, 41.697252690342005, 54.32415343552556, 55.009172826616066, 51.02575804047022, 56.4300635032564, 53.11222204799658, 52.5046954198086, 51.39399885189622, 50.47989964048143, 40.57891188922536, 54.19637792807159, 54.29158343082763, 51.2455837373804, 51.80230897317596, 42.00083455953056, 48.41601913407488, 53.669379666757735, 51.38853204651848, 46.473684766182025, 49.83747910007949, 51.013640206660675, 50.67661851106253, 52.501948305073405, 38.48043792064422, 50.7570597636258, 53.722794384150454, 49.4278137239908, 51.802760044468215, 40.57621666497399, 49.38768387085322, 51.30700127928175, 47.73351123903606, 55.98500161564285, 44.47806877061931, 50.340187186141605, 49.689607367039635, 51.6469885457025, 37.80623550037398, 50.11344597922103, 55.024959786314035, 49.1438663599514, 45.02116880604734, 40.886707208362104, 49.86647806289915, 52.18214073198174, 48.310482361816995, 58.48638045277565, 51.31127826884173, 52.200043156326444, 50.82086269393875, 49.8162636605082, 39.56809637477741, 51.54674860163741, 50.814458078088634, 50.789163631192196, 48.840841751481996, 38.83621103473991, 51.765308403188264, 55.64893188381249, 45.81854603298516, 53.871912798025676, 51.64852020924411, 52.5958078627188, 48.117121019743465, 50.08340241945752, 36.62024324680749, 55.48758123092548, 51.65598394407083, 49.979915128479334, 49.365440946355974, 40.18666122207085, 48.6834004251876, 52.91212927557233, 48.35742408467833, 55.8331317900887, 54.95163166095832, 51.78692103250073, 51.472865061918874, 52.11364295346021, 39.81487912160902, 48.34779818647192, 48.44313900835708, 45.2904647019318, 49.5020492947991, 38.88043242209515, 41.490498798287845, 54.09722368982152, 41.51204561810312, 52.29391554281647, 51.95966691341315, 51.87601524996049, 46.00102034823018, 49.05940687803659, 36.59934182043771, 50.38347915560147, 52.32593110134189], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7633259287598095, "mean_inference_ms": 7.986931911581838, "mean_action_processing_ms": 0.5617454632026072, "mean_env_wait_ms": 24.323223043701272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02935624122619629, "StateBufferConnector_ms": 0.043506622314453125, "ViewRequirementAgentConnector_ms": 0.9493923187255859}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2205228, "num_agent_steps_trained": 2205228, "num_env_steps_sampled": 2205228, "num_env_steps_trained": 2205228, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.24093026820296, "num_env_steps_trained_throughput_per_sec": 226.24093026820296, "timesteps_total": 2205228, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2205228, "timers": {"training_iteration_time_ms": 68913.7, "sample_time_ms": 42632.391, "load_time_ms": 2305.241, "load_throughput": 6783.672, "learn_time_ms": 23395.154, "learn_throughput": 668.429, "synch_weights_time_ms": 453.898}, "counters": {"num_env_steps_sampled": 2205228, "num_env_steps_trained": 2205228, "num_agent_steps_sampled": 2205228, "num_agent_steps_trained": 2205228}, "done": false, "episodes_total": 2088, "training_iteration": 149, "trial_id": "837cb_00000", "date": "2025-06-07_20-12-22", "timestamp": 1749319942, "time_this_iter_s": 69.13396787643433, "time_total_s": 9988.692075967789, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9988.692075967789, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 64.92784810126581, "ram_util_percent": 89.9886075949367, "gpu_util_percent0": 0.21632911392405063, "vram_util_percent0": 0.9650065104166671}}
{"evaluation": {"sampler_results": {"episode_reward_max": 2.9551930116085274, "episode_reward_min": 2.2465226820140445, "episode_reward_mean": 2.6993790779548403, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.9551930116085274, 2.2465226820140445, 2.827820607629615, 2.6244556676775397, 2.842903420844475], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8231007044112004, "mean_inference_ms": 4.0011606512877504, "mean_action_processing_ms": 0.29085627604840364, "mean_env_wait_ms": 12.239576811272547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3144645690917969, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4526329040527344}}, "episode_reward_max": 2.9551930116085274, "episode_reward_min": 2.2465226820140445, "episode_reward_mean": 2.6993790779548403, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.9551930116085274, 2.2465226820140445, 2.827820607629615, 2.6244556676775397, 2.842903420844475], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8231007044112004, "mean_inference_ms": 4.0011606512877504, "mean_action_processing_ms": 0.29085627604840364, "mean_env_wait_ms": 12.239576811272547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3144645690917969, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4526329040527344}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.794772000000001e-05, "total_loss": -0.06284326121888377, "policy_loss": -0.013876026225599079, "vf_loss": 0.01330861597491259, "vf_explained_var": 0.9641687607765198, "kl": 0.021525196785916675, "entropy": 17.01204799825495, "entropy_coeff": 0.0031921580000000005}, "model": {}, "num_grad_updates_lifetime": 77865.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2220866, "num_env_steps_trained": 2220866, "num_agent_steps_sampled": 2220866, "num_agent_steps_trained": 2220866}, "sampler_results": {"episode_reward_max": 58.48638045277565, "episode_reward_min": 36.59934182043771, "episode_reward_mean": 48.94138591134815, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.19637792807159, 54.29158343082763, 51.2455837373804, 51.80230897317596, 42.00083455953056, 48.41601913407488, 53.669379666757735, 51.38853204651848, 46.473684766182025, 49.83747910007949, 51.013640206660675, 50.67661851106253, 52.501948305073405, 38.48043792064422, 50.7570597636258, 53.722794384150454, 49.4278137239908, 51.802760044468215, 40.57621666497399, 49.38768387085322, 51.30700127928175, 47.73351123903606, 55.98500161564285, 44.47806877061931, 50.340187186141605, 49.689607367039635, 51.6469885457025, 37.80623550037398, 50.11344597922103, 55.024959786314035, 49.1438663599514, 45.02116880604734, 40.886707208362104, 49.86647806289915, 52.18214073198174, 48.310482361816995, 58.48638045277565, 51.31127826884173, 52.200043156326444, 50.82086269393875, 49.8162636605082, 39.56809637477741, 51.54674860163741, 50.814458078088634, 50.789163631192196, 48.840841751481996, 38.83621103473991, 51.765308403188264, 55.64893188381249, 45.81854603298516, 53.871912798025676, 51.64852020924411, 52.5958078627188, 48.117121019743465, 50.08340241945752, 36.62024324680749, 55.48758123092548, 51.65598394407083, 49.979915128479334, 49.365440946355974, 40.18666122207085, 48.6834004251876, 52.91212927557233, 48.35742408467833, 55.8331317900887, 54.95163166095832, 51.78692103250073, 51.472865061918874, 52.11364295346021, 39.81487912160902, 48.34779818647192, 48.44313900835708, 45.2904647019318, 49.5020492947991, 38.88043242209515, 41.490498798287845, 54.09722368982152, 41.51204561810312, 52.29391554281647, 51.95966691341315, 51.87601524996049, 46.00102034823018, 49.05940687803659, 36.59934182043771, 50.38347915560147, 52.32593110134189, 43.47763709881828, 49.31453882538038, 41.03206563052721, 50.142933785477375, 51.824587604029844, 46.561764974843676, 55.128693021215625, 45.34495193946742, 50.41700688891991, 47.43476546126423, 50.70613803070089, 38.912218087231906, 52.89431817595543, 49.878185884577086], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.762447867890119, "mean_inference_ms": 7.987058990613382, "mean_action_processing_ms": 0.5617062146952135, "mean_env_wait_ms": 24.326580667223208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02383565902709961, "StateBufferConnector_ms": 0.04143977165222168, "ViewRequirementAgentConnector_ms": 0.945565938949585}}, "episode_reward_max": 58.48638045277565, "episode_reward_min": 36.59934182043771, "episode_reward_mean": 48.94138591134815, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.19637792807159, 54.29158343082763, 51.2455837373804, 51.80230897317596, 42.00083455953056, 48.41601913407488, 53.669379666757735, 51.38853204651848, 46.473684766182025, 49.83747910007949, 51.013640206660675, 50.67661851106253, 52.501948305073405, 38.48043792064422, 50.7570597636258, 53.722794384150454, 49.4278137239908, 51.802760044468215, 40.57621666497399, 49.38768387085322, 51.30700127928175, 47.73351123903606, 55.98500161564285, 44.47806877061931, 50.340187186141605, 49.689607367039635, 51.6469885457025, 37.80623550037398, 50.11344597922103, 55.024959786314035, 49.1438663599514, 45.02116880604734, 40.886707208362104, 49.86647806289915, 52.18214073198174, 48.310482361816995, 58.48638045277565, 51.31127826884173, 52.200043156326444, 50.82086269393875, 49.8162636605082, 39.56809637477741, 51.54674860163741, 50.814458078088634, 50.789163631192196, 48.840841751481996, 38.83621103473991, 51.765308403188264, 55.64893188381249, 45.81854603298516, 53.871912798025676, 51.64852020924411, 52.5958078627188, 48.117121019743465, 50.08340241945752, 36.62024324680749, 55.48758123092548, 51.65598394407083, 49.979915128479334, 49.365440946355974, 40.18666122207085, 48.6834004251876, 52.91212927557233, 48.35742408467833, 55.8331317900887, 54.95163166095832, 51.78692103250073, 51.472865061918874, 52.11364295346021, 39.81487912160902, 48.34779818647192, 48.44313900835708, 45.2904647019318, 49.5020492947991, 38.88043242209515, 41.490498798287845, 54.09722368982152, 41.51204561810312, 52.29391554281647, 51.95966691341315, 51.87601524996049, 46.00102034823018, 49.05940687803659, 36.59934182043771, 50.38347915560147, 52.32593110134189, 43.47763709881828, 49.31453882538038, 41.03206563052721, 50.142933785477375, 51.824587604029844, 46.561764974843676, 55.128693021215625, 45.34495193946742, 50.41700688891991, 47.43476546126423, 50.70613803070089, 38.912218087231906, 52.89431817595543, 49.878185884577086], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.762447867890119, "mean_inference_ms": 7.987058990613382, "mean_action_processing_ms": 0.5617062146952135, "mean_env_wait_ms": 24.326580667223208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02383565902709961, "StateBufferConnector_ms": 0.04143977165222168, "ViewRequirementAgentConnector_ms": 0.945565938949585}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2220866, "num_agent_steps_trained": 2220866, "num_env_steps_sampled": 2220866, "num_env_steps_trained": 2220866, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 227.978630325591, "num_env_steps_trained_throughput_per_sec": 227.978630325591, "timesteps_total": 2220866, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2220866, "timers": {"training_iteration_time_ms": 68837.033, "sample_time_ms": 42651.681, "load_time_ms": 2303.639, "load_throughput": 6788.389, "learn_time_ms": 23309.45, "learn_throughput": 670.887, "synch_weights_time_ms": 445.499}, "counters": {"num_env_steps_sampled": 2220866, "num_env_steps_trained": 2220866, "num_agent_steps_sampled": 2220866, "num_agent_steps_trained": 2220866}, "done": false, "episodes_total": 2102, "training_iteration": 150, "trial_id": "837cb_00000", "date": "2025-06-07_20-13-46", "timestamp": 1749320026, "time_this_iter_s": 84.06316661834717, "time_total_s": 10072.755242586136, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10072.755242586136, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 56.55257731958762, "ram_util_percent": 89.41752577319589, "gpu_util_percent0": 0.17402061855670106, "vram_util_percent0": 0.9650065104166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.779134000000001e-05, "total_loss": -0.05592356746846979, "policy_loss": -0.007394014194247906, "vf_loss": 0.013924324555237863, "vf_explained_var": 0.9618136376684362, "kl": 0.021478129076772125, "entropy": 17.057221724770287, "entropy_coeff": 0.003168701}, "model": {}, "num_grad_updates_lifetime": 78415.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2236504, "num_env_steps_trained": 2236504, "num_agent_steps_sampled": 2236504, "num_agent_steps_trained": 2236504}, "sampler_results": {"episode_reward_max": 58.48638045277565, "episode_reward_min": 36.59934182043771, "episode_reward_mean": 48.69929125402553, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.7570597636258, 53.722794384150454, 49.4278137239908, 51.802760044468215, 40.57621666497399, 49.38768387085322, 51.30700127928175, 47.73351123903606, 55.98500161564285, 44.47806877061931, 50.340187186141605, 49.689607367039635, 51.6469885457025, 37.80623550037398, 50.11344597922103, 55.024959786314035, 49.1438663599514, 45.02116880604734, 40.886707208362104, 49.86647806289915, 52.18214073198174, 48.310482361816995, 58.48638045277565, 51.31127826884173, 52.200043156326444, 50.82086269393875, 49.8162636605082, 39.56809637477741, 51.54674860163741, 50.814458078088634, 50.789163631192196, 48.840841751481996, 38.83621103473991, 51.765308403188264, 55.64893188381249, 45.81854603298516, 53.871912798025676, 51.64852020924411, 52.5958078627188, 48.117121019743465, 50.08340241945752, 36.62024324680749, 55.48758123092548, 51.65598394407083, 49.979915128479334, 49.365440946355974, 40.18666122207085, 48.6834004251876, 52.91212927557233, 48.35742408467833, 55.8331317900887, 54.95163166095832, 51.78692103250073, 51.472865061918874, 52.11364295346021, 39.81487912160902, 48.34779818647192, 48.44313900835708, 45.2904647019318, 49.5020492947991, 38.88043242209515, 41.490498798287845, 54.09722368982152, 41.51204561810312, 52.29391554281647, 51.95966691341315, 51.87601524996049, 46.00102034823018, 49.05940687803659, 36.59934182043771, 50.38347915560147, 52.32593110134189, 43.47763709881828, 49.31453882538038, 41.03206563052721, 50.142933785477375, 51.824587604029844, 46.561764974843676, 55.128693021215625, 45.34495193946742, 50.41700688891991, 47.43476546126423, 50.70613803070089, 38.912218087231906, 52.89431817595543, 49.878185884577086, 42.26690725555053, 50.66816012913007, 40.49546524432818, 47.31288018738479, 52.1607595803827, 50.72146387956932, 52.799031343499585, 49.6745353311903, 51.90083121911495, 43.880038698149455, 50.02611282082852, 39.06746739645811, 52.820974510633036, 47.9903349575559], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.761360494116074, "mean_inference_ms": 7.987264951849723, "mean_action_processing_ms": 0.5616716739132156, "mean_env_wait_ms": 24.329994861999907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024261951446533203, "StateBufferConnector_ms": 0.03989219665527344, "ViewRequirementAgentConnector_ms": 0.9393224716186523}}, "episode_reward_max": 58.48638045277565, "episode_reward_min": 36.59934182043771, "episode_reward_mean": 48.69929125402553, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.7570597636258, 53.722794384150454, 49.4278137239908, 51.802760044468215, 40.57621666497399, 49.38768387085322, 51.30700127928175, 47.73351123903606, 55.98500161564285, 44.47806877061931, 50.340187186141605, 49.689607367039635, 51.6469885457025, 37.80623550037398, 50.11344597922103, 55.024959786314035, 49.1438663599514, 45.02116880604734, 40.886707208362104, 49.86647806289915, 52.18214073198174, 48.310482361816995, 58.48638045277565, 51.31127826884173, 52.200043156326444, 50.82086269393875, 49.8162636605082, 39.56809637477741, 51.54674860163741, 50.814458078088634, 50.789163631192196, 48.840841751481996, 38.83621103473991, 51.765308403188264, 55.64893188381249, 45.81854603298516, 53.871912798025676, 51.64852020924411, 52.5958078627188, 48.117121019743465, 50.08340241945752, 36.62024324680749, 55.48758123092548, 51.65598394407083, 49.979915128479334, 49.365440946355974, 40.18666122207085, 48.6834004251876, 52.91212927557233, 48.35742408467833, 55.8331317900887, 54.95163166095832, 51.78692103250073, 51.472865061918874, 52.11364295346021, 39.81487912160902, 48.34779818647192, 48.44313900835708, 45.2904647019318, 49.5020492947991, 38.88043242209515, 41.490498798287845, 54.09722368982152, 41.51204561810312, 52.29391554281647, 51.95966691341315, 51.87601524996049, 46.00102034823018, 49.05940687803659, 36.59934182043771, 50.38347915560147, 52.32593110134189, 43.47763709881828, 49.31453882538038, 41.03206563052721, 50.142933785477375, 51.824587604029844, 46.561764974843676, 55.128693021215625, 45.34495193946742, 50.41700688891991, 47.43476546126423, 50.70613803070089, 38.912218087231906, 52.89431817595543, 49.878185884577086, 42.26690725555053, 50.66816012913007, 40.49546524432818, 47.31288018738479, 52.1607595803827, 50.72146387956932, 52.799031343499585, 49.6745353311903, 51.90083121911495, 43.880038698149455, 50.02611282082852, 39.06746739645811, 52.820974510633036, 47.9903349575559], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.761360494116074, "mean_inference_ms": 7.987264951849723, "mean_action_processing_ms": 0.5616716739132156, "mean_env_wait_ms": 24.329994861999907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024261951446533203, "StateBufferConnector_ms": 0.03989219665527344, "ViewRequirementAgentConnector_ms": 0.9393224716186523}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2236504, "num_agent_steps_trained": 2236504, "num_env_steps_sampled": 2236504, "num_env_steps_trained": 2236504, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.90511069030276, "num_env_steps_trained_throughput_per_sec": 226.90511069030276, "timesteps_total": 2236504, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2236504, "timers": {"training_iteration_time_ms": 68837.364, "sample_time_ms": 42630.348, "load_time_ms": 2320.418, "load_throughput": 6739.302, "learn_time_ms": 23315.006, "learn_throughput": 670.727, "synch_weights_time_ms": 444.714}, "counters": {"num_env_steps_sampled": 2236504, "num_env_steps_trained": 2236504, "num_agent_steps_sampled": 2236504, "num_agent_steps_trained": 2236504}, "done": false, "episodes_total": 2116, "training_iteration": 151, "trial_id": "837cb_00000", "date": "2025-06-07_20-14-56", "timestamp": 1749320096, "time_this_iter_s": 68.93556594848633, "time_total_s": 10141.690808534622, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10141.690808534622, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 64.64936708860759, "ram_util_percent": 90.34177215189878, "gpu_util_percent0": 0.21189873417721516, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.763496e-05, "total_loss": -0.06361162614003248, "policy_loss": -0.015124414133923975, "vf_loss": 0.013184831371869554, "vf_explained_var": 0.9602339080247012, "kl": 0.021341123121364013, "entropy": 17.09771329359575, "entropy_coeff": 0.003145243999999999}, "model": {}, "num_grad_updates_lifetime": 78965.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2252142, "num_env_steps_trained": 2252142, "num_agent_steps_sampled": 2252142, "num_agent_steps_trained": 2252142}, "sampler_results": {"episode_reward_max": 58.48638045277565, "episode_reward_min": 36.59934182043771, "episode_reward_mean": 48.64028071357156, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.11344597922103, 55.024959786314035, 49.1438663599514, 45.02116880604734, 40.886707208362104, 49.86647806289915, 52.18214073198174, 48.310482361816995, 58.48638045277565, 51.31127826884173, 52.200043156326444, 50.82086269393875, 49.8162636605082, 39.56809637477741, 51.54674860163741, 50.814458078088634, 50.789163631192196, 48.840841751481996, 38.83621103473991, 51.765308403188264, 55.64893188381249, 45.81854603298516, 53.871912798025676, 51.64852020924411, 52.5958078627188, 48.117121019743465, 50.08340241945752, 36.62024324680749, 55.48758123092548, 51.65598394407083, 49.979915128479334, 49.365440946355974, 40.18666122207085, 48.6834004251876, 52.91212927557233, 48.35742408467833, 55.8331317900887, 54.95163166095832, 51.78692103250073, 51.472865061918874, 52.11364295346021, 39.81487912160902, 48.34779818647192, 48.44313900835708, 45.2904647019318, 49.5020492947991, 38.88043242209515, 41.490498798287845, 54.09722368982152, 41.51204561810312, 52.29391554281647, 51.95966691341315, 51.87601524996049, 46.00102034823018, 49.05940687803659, 36.59934182043771, 50.38347915560147, 52.32593110134189, 43.47763709881828, 49.31453882538038, 41.03206563052721, 50.142933785477375, 51.824587604029844, 46.561764974843676, 55.128693021215625, 45.34495193946742, 50.41700688891991, 47.43476546126423, 50.70613803070089, 38.912218087231906, 52.89431817595543, 49.878185884577086, 42.26690725555053, 50.66816012913007, 40.49546524432818, 47.31288018738479, 52.1607595803827, 50.72146387956932, 52.799031343499585, 49.6745353311903, 51.90083121911495, 43.880038698149455, 50.02611282082852, 39.06746739645811, 52.820974510633036, 47.9903349575559, 45.229907886180115, 46.48786081726164, 40.49548412177021, 50.498326236225296, 54.51914508872664, 47.917611358251555, 54.82402996477274, 51.57823259484347, 51.03791731297898, 51.171146266261495, 47.93807359484015, 38.7726883746568, 50.29481559226723, 47.99463670146894], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7605928858948756, "mean_inference_ms": 7.98885883273511, "mean_action_processing_ms": 0.5617353006952943, "mean_env_wait_ms": 24.335824326014407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02693033218383789, "StateBufferConnector_ms": 0.050077199935913086, "ViewRequirementAgentConnector_ms": 0.9735589027404785}}, "episode_reward_max": 58.48638045277565, "episode_reward_min": 36.59934182043771, "episode_reward_mean": 48.64028071357156, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.11344597922103, 55.024959786314035, 49.1438663599514, 45.02116880604734, 40.886707208362104, 49.86647806289915, 52.18214073198174, 48.310482361816995, 58.48638045277565, 51.31127826884173, 52.200043156326444, 50.82086269393875, 49.8162636605082, 39.56809637477741, 51.54674860163741, 50.814458078088634, 50.789163631192196, 48.840841751481996, 38.83621103473991, 51.765308403188264, 55.64893188381249, 45.81854603298516, 53.871912798025676, 51.64852020924411, 52.5958078627188, 48.117121019743465, 50.08340241945752, 36.62024324680749, 55.48758123092548, 51.65598394407083, 49.979915128479334, 49.365440946355974, 40.18666122207085, 48.6834004251876, 52.91212927557233, 48.35742408467833, 55.8331317900887, 54.95163166095832, 51.78692103250073, 51.472865061918874, 52.11364295346021, 39.81487912160902, 48.34779818647192, 48.44313900835708, 45.2904647019318, 49.5020492947991, 38.88043242209515, 41.490498798287845, 54.09722368982152, 41.51204561810312, 52.29391554281647, 51.95966691341315, 51.87601524996049, 46.00102034823018, 49.05940687803659, 36.59934182043771, 50.38347915560147, 52.32593110134189, 43.47763709881828, 49.31453882538038, 41.03206563052721, 50.142933785477375, 51.824587604029844, 46.561764974843676, 55.128693021215625, 45.34495193946742, 50.41700688891991, 47.43476546126423, 50.70613803070089, 38.912218087231906, 52.89431817595543, 49.878185884577086, 42.26690725555053, 50.66816012913007, 40.49546524432818, 47.31288018738479, 52.1607595803827, 50.72146387956932, 52.799031343499585, 49.6745353311903, 51.90083121911495, 43.880038698149455, 50.02611282082852, 39.06746739645811, 52.820974510633036, 47.9903349575559, 45.229907886180115, 46.48786081726164, 40.49548412177021, 50.498326236225296, 54.51914508872664, 47.917611358251555, 54.82402996477274, 51.57823259484347, 51.03791731297898, 51.171146266261495, 47.93807359484015, 38.7726883746568, 50.29481559226723, 47.99463670146894], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7605928858948756, "mean_inference_ms": 7.98885883273511, "mean_action_processing_ms": 0.5617353006952943, "mean_env_wait_ms": 24.335824326014407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02693033218383789, "StateBufferConnector_ms": 0.050077199935913086, "ViewRequirementAgentConnector_ms": 0.9735589027404785}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2252142, "num_agent_steps_trained": 2252142, "num_env_steps_sampled": 2252142, "num_env_steps_trained": 2252142, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 214.4082143806055, "num_env_steps_trained_throughput_per_sec": 214.4082143806055, "timesteps_total": 2252142, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2252142, "timers": {"training_iteration_time_ms": 69280.069, "sample_time_ms": 43145.385, "load_time_ms": 2331.414, "load_throughput": 6707.517, "learn_time_ms": 23236.928, "learn_throughput": 672.981, "synch_weights_time_ms": 439.551}, "counters": {"num_env_steps_sampled": 2252142, "num_env_steps_trained": 2252142, "num_agent_steps_sampled": 2252142, "num_agent_steps_trained": 2252142}, "done": false, "episodes_total": 2130, "training_iteration": 152, "trial_id": "837cb_00000", "date": "2025-06-07_20-16-09", "timestamp": 1749320169, "time_this_iter_s": 72.95803880691528, "time_total_s": 10214.648847341537, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10214.648847341537, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 67.83414634146342, "ram_util_percent": 90.76219512195121, "gpu_util_percent0": 0.21268292682926826, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.747858000000002e-05, "total_loss": -0.06766475804848597, "policy_loss": -0.01948880697756646, "vf_loss": 0.013240552728318354, "vf_explained_var": 0.9620760087533431, "kl": 0.021366248619007655, "entropy": 17.132337662089956, "entropy_coeff": 0.0031217870000000004}, "model": {}, "num_grad_updates_lifetime": 79515.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2267780, "num_env_steps_trained": 2267780, "num_agent_steps_sampled": 2267780, "num_agent_steps_trained": 2267780}, "sampler_results": {"episode_reward_max": 56.71729973395355, "episode_reward_min": 36.59934182043771, "episode_reward_mean": 48.604503762110724, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.54674860163741, 50.814458078088634, 50.789163631192196, 48.840841751481996, 38.83621103473991, 51.765308403188264, 55.64893188381249, 45.81854603298516, 53.871912798025676, 51.64852020924411, 52.5958078627188, 48.117121019743465, 50.08340241945752, 36.62024324680749, 55.48758123092548, 51.65598394407083, 49.979915128479334, 49.365440946355974, 40.18666122207085, 48.6834004251876, 52.91212927557233, 48.35742408467833, 55.8331317900887, 54.95163166095832, 51.78692103250073, 51.472865061918874, 52.11364295346021, 39.81487912160902, 48.34779818647192, 48.44313900835708, 45.2904647019318, 49.5020492947991, 38.88043242209515, 41.490498798287845, 54.09722368982152, 41.51204561810312, 52.29391554281647, 51.95966691341315, 51.87601524996049, 46.00102034823018, 49.05940687803659, 36.59934182043771, 50.38347915560147, 52.32593110134189, 43.47763709881828, 49.31453882538038, 41.03206563052721, 50.142933785477375, 51.824587604029844, 46.561764974843676, 55.128693021215625, 45.34495193946742, 50.41700688891991, 47.43476546126423, 50.70613803070089, 38.912218087231906, 52.89431817595543, 49.878185884577086, 42.26690725555053, 50.66816012913007, 40.49546524432818, 47.31288018738479, 52.1607595803827, 50.72146387956932, 52.799031343499585, 49.6745353311903, 51.90083121911495, 43.880038698149455, 50.02611282082852, 39.06746739645811, 52.820974510633036, 47.9903349575559, 45.229907886180115, 46.48786081726164, 40.49548412177021, 50.498326236225296, 54.51914508872664, 47.917611358251555, 54.82402996477274, 51.57823259484347, 51.03791731297898, 51.171146266261495, 47.93807359484015, 38.7726883746568, 50.29481559226723, 47.99463670146894, 46.44445484457895, 47.13049000867158, 38.57722424395472, 49.391759443773864, 56.23977619191679, 49.00843448663876, 56.71729973395355, 51.301297291227456, 54.46887409627967, 49.98342013234651, 51.74425128057746, 39.190489765970845, 49.72787280522848, 49.24883443255963], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.760094474575473, "mean_inference_ms": 7.99092433557126, "mean_action_processing_ms": 0.561837336450219, "mean_env_wait_ms": 24.34108944532296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02090287208557129, "StateBufferConnector_ms": 0.04936361312866211, "ViewRequirementAgentConnector_ms": 0.995704174041748}}, "episode_reward_max": 56.71729973395355, "episode_reward_min": 36.59934182043771, "episode_reward_mean": 48.604503762110724, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [51.54674860163741, 50.814458078088634, 50.789163631192196, 48.840841751481996, 38.83621103473991, 51.765308403188264, 55.64893188381249, 45.81854603298516, 53.871912798025676, 51.64852020924411, 52.5958078627188, 48.117121019743465, 50.08340241945752, 36.62024324680749, 55.48758123092548, 51.65598394407083, 49.979915128479334, 49.365440946355974, 40.18666122207085, 48.6834004251876, 52.91212927557233, 48.35742408467833, 55.8331317900887, 54.95163166095832, 51.78692103250073, 51.472865061918874, 52.11364295346021, 39.81487912160902, 48.34779818647192, 48.44313900835708, 45.2904647019318, 49.5020492947991, 38.88043242209515, 41.490498798287845, 54.09722368982152, 41.51204561810312, 52.29391554281647, 51.95966691341315, 51.87601524996049, 46.00102034823018, 49.05940687803659, 36.59934182043771, 50.38347915560147, 52.32593110134189, 43.47763709881828, 49.31453882538038, 41.03206563052721, 50.142933785477375, 51.824587604029844, 46.561764974843676, 55.128693021215625, 45.34495193946742, 50.41700688891991, 47.43476546126423, 50.70613803070089, 38.912218087231906, 52.89431817595543, 49.878185884577086, 42.26690725555053, 50.66816012913007, 40.49546524432818, 47.31288018738479, 52.1607595803827, 50.72146387956932, 52.799031343499585, 49.6745353311903, 51.90083121911495, 43.880038698149455, 50.02611282082852, 39.06746739645811, 52.820974510633036, 47.9903349575559, 45.229907886180115, 46.48786081726164, 40.49548412177021, 50.498326236225296, 54.51914508872664, 47.917611358251555, 54.82402996477274, 51.57823259484347, 51.03791731297898, 51.171146266261495, 47.93807359484015, 38.7726883746568, 50.29481559226723, 47.99463670146894, 46.44445484457895, 47.13049000867158, 38.57722424395472, 49.391759443773864, 56.23977619191679, 49.00843448663876, 56.71729973395355, 51.301297291227456, 54.46887409627967, 49.98342013234651, 51.74425128057746, 39.190489765970845, 49.72787280522848, 49.24883443255963], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.760094474575473, "mean_inference_ms": 7.99092433557126, "mean_action_processing_ms": 0.561837336450219, "mean_env_wait_ms": 24.34108944532296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02090287208557129, "StateBufferConnector_ms": 0.04936361312866211, "ViewRequirementAgentConnector_ms": 0.995704174041748}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2267780, "num_agent_steps_trained": 2267780, "num_env_steps_sampled": 2267780, "num_env_steps_trained": 2267780, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 229.58244451763287, "num_env_steps_trained_throughput_per_sec": 229.58244451763287, "timesteps_total": 2267780, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2267780, "timers": {"training_iteration_time_ms": 69212.609, "sample_time_ms": 43146.102, "load_time_ms": 2368.484, "load_throughput": 6602.534, "learn_time_ms": 23136.144, "learn_throughput": 675.912, "synch_weights_time_ms": 434.606}, "counters": {"num_env_steps_sampled": 2267780, "num_env_steps_trained": 2267780, "num_agent_steps_sampled": 2267780, "num_agent_steps_trained": 2267780}, "done": false, "episodes_total": 2144, "training_iteration": 153, "trial_id": "837cb_00000", "date": "2025-06-07_20-17-17", "timestamp": 1749320237, "time_this_iter_s": 68.13396334648132, "time_total_s": 10282.782810688019, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10282.782810688019, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 66.46962025316458, "ram_util_percent": 90.64177215189873, "gpu_util_percent0": 0.21822784810126586, "vram_util_percent0": 0.9650065104166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.73222e-05, "total_loss": -0.07094865106892857, "policy_loss": -0.023030368726639692, "vf_loss": 0.013002702501941134, "vf_explained_var": 0.9651847791671753, "kl": 0.02125923912761051, "entropy": 17.15369161085649, "entropy_coeff": 0.0030983300000000003}, "model": {}, "num_grad_updates_lifetime": 80065.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2283418, "num_env_steps_trained": 2283418, "num_agent_steps_sampled": 2283418, "num_agent_steps_trained": 2283418}, "sampler_results": {"episode_reward_max": 56.71729973395355, "episode_reward_min": 36.59934182043771, "episode_reward_mean": 48.445980730157615, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.48758123092548, 51.65598394407083, 49.979915128479334, 49.365440946355974, 40.18666122207085, 48.6834004251876, 52.91212927557233, 48.35742408467833, 55.8331317900887, 54.95163166095832, 51.78692103250073, 51.472865061918874, 52.11364295346021, 39.81487912160902, 48.34779818647192, 48.44313900835708, 45.2904647019318, 49.5020492947991, 38.88043242209515, 41.490498798287845, 54.09722368982152, 41.51204561810312, 52.29391554281647, 51.95966691341315, 51.87601524996049, 46.00102034823018, 49.05940687803659, 36.59934182043771, 50.38347915560147, 52.32593110134189, 43.47763709881828, 49.31453882538038, 41.03206563052721, 50.142933785477375, 51.824587604029844, 46.561764974843676, 55.128693021215625, 45.34495193946742, 50.41700688891991, 47.43476546126423, 50.70613803070089, 38.912218087231906, 52.89431817595543, 49.878185884577086, 42.26690725555053, 50.66816012913007, 40.49546524432818, 47.31288018738479, 52.1607595803827, 50.72146387956932, 52.799031343499585, 49.6745353311903, 51.90083121911495, 43.880038698149455, 50.02611282082852, 39.06746739645811, 52.820974510633036, 47.9903349575559, 45.229907886180115, 46.48786081726164, 40.49548412177021, 50.498326236225296, 54.51914508872664, 47.917611358251555, 54.82402996477274, 51.57823259484347, 51.03791731297898, 51.171146266261495, 47.93807359484015, 38.7726883746568, 50.29481559226723, 47.99463670146894, 46.44445484457895, 47.13049000867158, 38.57722424395472, 49.391759443773864, 56.23977619191679, 49.00843448663876, 56.71729973395355, 51.301297291227456, 54.46887409627967, 49.98342013234651, 51.74425128057746, 39.190489765970845, 49.72787280522848, 49.24883443255963, 45.41883421841074, 50.78950897803709, 37.59491578304256, 51.65893155864963, 50.432673620524426, 42.33367307347084, 53.848264342742524, 48.719868270567424, 52.13948292799935, 45.03101223455596, 50.61172160983446, 39.56116061636279, 51.90563534758813, 51.099231196024], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7600287694926027, "mean_inference_ms": 7.9934813190377145, "mean_action_processing_ms": 0.561977553278651, "mean_env_wait_ms": 24.34617731171495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021867036819458008, "StateBufferConnector_ms": 0.05548691749572754, "ViewRequirementAgentConnector_ms": 0.9925720691680908}}, "episode_reward_max": 56.71729973395355, "episode_reward_min": 36.59934182043771, "episode_reward_mean": 48.445980730157615, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [55.48758123092548, 51.65598394407083, 49.979915128479334, 49.365440946355974, 40.18666122207085, 48.6834004251876, 52.91212927557233, 48.35742408467833, 55.8331317900887, 54.95163166095832, 51.78692103250073, 51.472865061918874, 52.11364295346021, 39.81487912160902, 48.34779818647192, 48.44313900835708, 45.2904647019318, 49.5020492947991, 38.88043242209515, 41.490498798287845, 54.09722368982152, 41.51204561810312, 52.29391554281647, 51.95966691341315, 51.87601524996049, 46.00102034823018, 49.05940687803659, 36.59934182043771, 50.38347915560147, 52.32593110134189, 43.47763709881828, 49.31453882538038, 41.03206563052721, 50.142933785477375, 51.824587604029844, 46.561764974843676, 55.128693021215625, 45.34495193946742, 50.41700688891991, 47.43476546126423, 50.70613803070089, 38.912218087231906, 52.89431817595543, 49.878185884577086, 42.26690725555053, 50.66816012913007, 40.49546524432818, 47.31288018738479, 52.1607595803827, 50.72146387956932, 52.799031343499585, 49.6745353311903, 51.90083121911495, 43.880038698149455, 50.02611282082852, 39.06746739645811, 52.820974510633036, 47.9903349575559, 45.229907886180115, 46.48786081726164, 40.49548412177021, 50.498326236225296, 54.51914508872664, 47.917611358251555, 54.82402996477274, 51.57823259484347, 51.03791731297898, 51.171146266261495, 47.93807359484015, 38.7726883746568, 50.29481559226723, 47.99463670146894, 46.44445484457895, 47.13049000867158, 38.57722424395472, 49.391759443773864, 56.23977619191679, 49.00843448663876, 56.71729973395355, 51.301297291227456, 54.46887409627967, 49.98342013234651, 51.74425128057746, 39.190489765970845, 49.72787280522848, 49.24883443255963, 45.41883421841074, 50.78950897803709, 37.59491578304256, 51.65893155864963, 50.432673620524426, 42.33367307347084, 53.848264342742524, 48.719868270567424, 52.13948292799935, 45.03101223455596, 50.61172160983446, 39.56116061636279, 51.90563534758813, 51.099231196024], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7600287694926027, "mean_inference_ms": 7.9934813190377145, "mean_action_processing_ms": 0.561977553278651, "mean_env_wait_ms": 24.34617731171495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021867036819458008, "StateBufferConnector_ms": 0.05548691749572754, "ViewRequirementAgentConnector_ms": 0.9925720691680908}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2283418, "num_agent_steps_trained": 2283418, "num_env_steps_sampled": 2283418, "num_env_steps_trained": 2283418, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.8440572462517, "num_env_steps_trained_throughput_per_sec": 226.8440572462517, "timesteps_total": 2283418, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2283418, "timers": {"training_iteration_time_ms": 69180.64, "sample_time_ms": 43209.347, "load_time_ms": 2350.089, "load_throughput": 6654.217, "learn_time_ms": 23059.085, "learn_throughput": 678.171, "synch_weights_time_ms": 430.897}, "counters": {"num_env_steps_sampled": 2283418, "num_env_steps_trained": 2283418, "num_agent_steps_sampled": 2283418, "num_agent_steps_trained": 2283418}, "done": false, "episodes_total": 2158, "training_iteration": 154, "trial_id": "837cb_00000", "date": "2025-06-07_20-18-26", "timestamp": 1749320306, "time_this_iter_s": 68.95322155952454, "time_total_s": 10351.736032247543, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10351.736032247543, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 66.5275, "ram_util_percent": 90.82624999999999, "gpu_util_percent0": 0.214625, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.716582e-05, "total_loss": -0.06742271016182547, "policy_loss": -0.020242622935064982, "vf_loss": 0.014120915190486067, "vf_explained_var": 0.9614496827125549, "kl": 0.02191377925350521, "entropy": 17.1668795412237, "entropy_coeff": 0.0030748729999999992}, "model": {}, "num_grad_updates_lifetime": 80615.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2299056, "num_env_steps_trained": 2299056, "num_agent_steps_sampled": 2299056, "num_agent_steps_trained": 2299056}, "sampler_results": {"episode_reward_max": 56.71729973395355, "episode_reward_min": 36.59934182043771, "episode_reward_mean": 48.07266054476827, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.34779818647192, 48.44313900835708, 45.2904647019318, 49.5020492947991, 38.88043242209515, 41.490498798287845, 54.09722368982152, 41.51204561810312, 52.29391554281647, 51.95966691341315, 51.87601524996049, 46.00102034823018, 49.05940687803659, 36.59934182043771, 50.38347915560147, 52.32593110134189, 43.47763709881828, 49.31453882538038, 41.03206563052721, 50.142933785477375, 51.824587604029844, 46.561764974843676, 55.128693021215625, 45.34495193946742, 50.41700688891991, 47.43476546126423, 50.70613803070089, 38.912218087231906, 52.89431817595543, 49.878185884577086, 42.26690725555053, 50.66816012913007, 40.49546524432818, 47.31288018738479, 52.1607595803827, 50.72146387956932, 52.799031343499585, 49.6745353311903, 51.90083121911495, 43.880038698149455, 50.02611282082852, 39.06746739645811, 52.820974510633036, 47.9903349575559, 45.229907886180115, 46.48786081726164, 40.49548412177021, 50.498326236225296, 54.51914508872664, 47.917611358251555, 54.82402996477274, 51.57823259484347, 51.03791731297898, 51.171146266261495, 47.93807359484015, 38.7726883746568, 50.29481559226723, 47.99463670146894, 46.44445484457895, 47.13049000867158, 38.57722424395472, 49.391759443773864, 56.23977619191679, 49.00843448663876, 56.71729973395355, 51.301297291227456, 54.46887409627967, 49.98342013234651, 51.74425128057746, 39.190489765970845, 49.72787280522848, 49.24883443255963, 45.41883421841074, 50.78950897803709, 37.59491578304256, 51.65893155864963, 50.432673620524426, 42.33367307347084, 53.848264342742524, 48.719868270567424, 52.13948292799935, 45.03101223455596, 50.61172160983446, 39.56116061636279, 51.90563534758813, 51.099231196024, 43.69125273331256, 46.801197917354834, 38.61929198156585, 48.475677353615595, 55.131133264528245, 44.12133006215563, 54.16461842583991, 49.17967475979774, 51.595409548581245, 51.70542784836658, 46.42940609461844, 39.43225888230067, 49.695039713870834, 46.22787075303528], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.760363452180089, "mean_inference_ms": 7.9963954323017505, "mean_action_processing_ms": 0.5621334258652688, "mean_env_wait_ms": 24.351000668467467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027900218963623047, "StateBufferConnector_ms": 0.059638023376464844, "ViewRequirementAgentConnector_ms": 0.9952657222747803}}, "episode_reward_max": 56.71729973395355, "episode_reward_min": 36.59934182043771, "episode_reward_mean": 48.07266054476827, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [48.34779818647192, 48.44313900835708, 45.2904647019318, 49.5020492947991, 38.88043242209515, 41.490498798287845, 54.09722368982152, 41.51204561810312, 52.29391554281647, 51.95966691341315, 51.87601524996049, 46.00102034823018, 49.05940687803659, 36.59934182043771, 50.38347915560147, 52.32593110134189, 43.47763709881828, 49.31453882538038, 41.03206563052721, 50.142933785477375, 51.824587604029844, 46.561764974843676, 55.128693021215625, 45.34495193946742, 50.41700688891991, 47.43476546126423, 50.70613803070089, 38.912218087231906, 52.89431817595543, 49.878185884577086, 42.26690725555053, 50.66816012913007, 40.49546524432818, 47.31288018738479, 52.1607595803827, 50.72146387956932, 52.799031343499585, 49.6745353311903, 51.90083121911495, 43.880038698149455, 50.02611282082852, 39.06746739645811, 52.820974510633036, 47.9903349575559, 45.229907886180115, 46.48786081726164, 40.49548412177021, 50.498326236225296, 54.51914508872664, 47.917611358251555, 54.82402996477274, 51.57823259484347, 51.03791731297898, 51.171146266261495, 47.93807359484015, 38.7726883746568, 50.29481559226723, 47.99463670146894, 46.44445484457895, 47.13049000867158, 38.57722424395472, 49.391759443773864, 56.23977619191679, 49.00843448663876, 56.71729973395355, 51.301297291227456, 54.46887409627967, 49.98342013234651, 51.74425128057746, 39.190489765970845, 49.72787280522848, 49.24883443255963, 45.41883421841074, 50.78950897803709, 37.59491578304256, 51.65893155864963, 50.432673620524426, 42.33367307347084, 53.848264342742524, 48.719868270567424, 52.13948292799935, 45.03101223455596, 50.61172160983446, 39.56116061636279, 51.90563534758813, 51.099231196024, 43.69125273331256, 46.801197917354834, 38.61929198156585, 48.475677353615595, 55.131133264528245, 44.12133006215563, 54.16461842583991, 49.17967475979774, 51.595409548581245, 51.70542784836658, 46.42940609461844, 39.43225888230067, 49.695039713870834, 46.22787075303528], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.760363452180089, "mean_inference_ms": 7.9963954323017505, "mean_action_processing_ms": 0.5621334258652688, "mean_env_wait_ms": 24.351000668467467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027900218963623047, "StateBufferConnector_ms": 0.059638023376464844, "ViewRequirementAgentConnector_ms": 0.9952657222747803}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2299056, "num_agent_steps_trained": 2299056, "num_env_steps_sampled": 2299056, "num_env_steps_trained": 2299056, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 226.7108676797198, "num_env_steps_trained_throughput_per_sec": 226.7108676797198, "timesteps_total": 2299056, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2299056, "timers": {"training_iteration_time_ms": 69263.056, "sample_time_ms": 43324.987, "load_time_ms": 2340.256, "load_throughput": 6682.175, "learn_time_ms": 23024.509, "learn_throughput": 679.189, "synch_weights_time_ms": 441.586}, "counters": {"num_env_steps_sampled": 2299056, "num_env_steps_trained": 2299056, "num_agent_steps_sampled": 2299056, "num_agent_steps_trained": 2299056}, "done": false, "episodes_total": 2172, "training_iteration": 155, "trial_id": "837cb_00000", "date": "2025-06-07_20-19-35", "timestamp": 1749320375, "time_this_iter_s": 68.99571681022644, "time_total_s": 10420.73174905777, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10420.73174905777, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 67.8075, "ram_util_percent": 90.58624999999999, "gpu_util_percent0": 0.21174999999999997, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.700944000000002e-05, "total_loss": -0.06243854030458765, "policy_loss": -0.01507698294915661, "vf_loss": 0.012841417902064594, "vf_explained_var": 0.9650042967362837, "kl": 0.021532180720987417, "entropy": 17.224706608165395, "entropy_coeff": 0.0030514160000000012}, "model": {}, "num_grad_updates_lifetime": 81165.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2314694, "num_env_steps_trained": 2314694, "num_agent_steps_sampled": 2314694, "num_agent_steps_trained": 2314694}, "sampler_results": {"episode_reward_max": 56.71729973395355, "episode_reward_min": 37.56758624695828, "episode_reward_mean": 48.2958000203378, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.38347915560147, 52.32593110134189, 43.47763709881828, 49.31453882538038, 41.03206563052721, 50.142933785477375, 51.824587604029844, 46.561764974843676, 55.128693021215625, 45.34495193946742, 50.41700688891991, 47.43476546126423, 50.70613803070089, 38.912218087231906, 52.89431817595543, 49.878185884577086, 42.26690725555053, 50.66816012913007, 40.49546524432818, 47.31288018738479, 52.1607595803827, 50.72146387956932, 52.799031343499585, 49.6745353311903, 51.90083121911495, 43.880038698149455, 50.02611282082852, 39.06746739645811, 52.820974510633036, 47.9903349575559, 45.229907886180115, 46.48786081726164, 40.49548412177021, 50.498326236225296, 54.51914508872664, 47.917611358251555, 54.82402996477274, 51.57823259484347, 51.03791731297898, 51.171146266261495, 47.93807359484015, 38.7726883746568, 50.29481559226723, 47.99463670146894, 46.44445484457895, 47.13049000867158, 38.57722424395472, 49.391759443773864, 56.23977619191679, 49.00843448663876, 56.71729973395355, 51.301297291227456, 54.46887409627967, 49.98342013234651, 51.74425128057746, 39.190489765970845, 49.72787280522848, 49.24883443255963, 45.41883421841074, 50.78950897803709, 37.59491578304256, 51.65893155864963, 50.432673620524426, 42.33367307347084, 53.848264342742524, 48.719868270567424, 52.13948292799935, 45.03101223455596, 50.61172160983446, 39.56116061636279, 51.90563534758813, 51.099231196024, 43.69125273331256, 46.801197917354834, 38.61929198156585, 48.475677353615595, 55.131133264528245, 44.12133006215563, 54.16461842583991, 49.17967475979774, 51.595409548581245, 51.70542784836658, 46.42940609461844, 39.43225888230067, 49.695039713870834, 46.22787075303528, 45.45036749107798, 44.99265198114263, 37.56758624695828, 52.56577447250711, 53.21565265426359, 47.80825261803577, 51.14653226089193, 51.36564603728707, 52.17339948066841, 48.873745377157064, 47.91645408039518, 41.01531812013718, 51.86406301198127, 51.711522197212645], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.761297627865086, "mean_inference_ms": 8.001330801687724, "mean_action_processing_ms": 0.5624214473321416, "mean_env_wait_ms": 24.357902087168096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028705120086669922, "StateBufferConnector_ms": 0.052802324295043945, "ViewRequirementAgentConnector_ms": 1.0159993171691895}}, "episode_reward_max": 56.71729973395355, "episode_reward_min": 37.56758624695828, "episode_reward_mean": 48.2958000203378, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.38347915560147, 52.32593110134189, 43.47763709881828, 49.31453882538038, 41.03206563052721, 50.142933785477375, 51.824587604029844, 46.561764974843676, 55.128693021215625, 45.34495193946742, 50.41700688891991, 47.43476546126423, 50.70613803070089, 38.912218087231906, 52.89431817595543, 49.878185884577086, 42.26690725555053, 50.66816012913007, 40.49546524432818, 47.31288018738479, 52.1607595803827, 50.72146387956932, 52.799031343499585, 49.6745353311903, 51.90083121911495, 43.880038698149455, 50.02611282082852, 39.06746739645811, 52.820974510633036, 47.9903349575559, 45.229907886180115, 46.48786081726164, 40.49548412177021, 50.498326236225296, 54.51914508872664, 47.917611358251555, 54.82402996477274, 51.57823259484347, 51.03791731297898, 51.171146266261495, 47.93807359484015, 38.7726883746568, 50.29481559226723, 47.99463670146894, 46.44445484457895, 47.13049000867158, 38.57722424395472, 49.391759443773864, 56.23977619191679, 49.00843448663876, 56.71729973395355, 51.301297291227456, 54.46887409627967, 49.98342013234651, 51.74425128057746, 39.190489765970845, 49.72787280522848, 49.24883443255963, 45.41883421841074, 50.78950897803709, 37.59491578304256, 51.65893155864963, 50.432673620524426, 42.33367307347084, 53.848264342742524, 48.719868270567424, 52.13948292799935, 45.03101223455596, 50.61172160983446, 39.56116061636279, 51.90563534758813, 51.099231196024, 43.69125273331256, 46.801197917354834, 38.61929198156585, 48.475677353615595, 55.131133264528245, 44.12133006215563, 54.16461842583991, 49.17967475979774, 51.595409548581245, 51.70542784836658, 46.42940609461844, 39.43225888230067, 49.695039713870834, 46.22787075303528, 45.45036749107798, 44.99265198114263, 37.56758624695828, 52.56577447250711, 53.21565265426359, 47.80825261803577, 51.14653226089193, 51.36564603728707, 52.17339948066841, 48.873745377157064, 47.91645408039518, 41.01531812013718, 51.86406301198127, 51.711522197212645], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.761297627865086, "mean_inference_ms": 8.001330801687724, "mean_action_processing_ms": 0.5624214473321416, "mean_env_wait_ms": 24.357902087168096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028705120086669922, "StateBufferConnector_ms": 0.052802324295043945, "ViewRequirementAgentConnector_ms": 1.0159993171691895}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2314694, "num_agent_steps_trained": 2314694, "num_env_steps_sampled": 2314694, "num_env_steps_trained": 2314694, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 208.44287670358855, "num_env_steps_trained_throughput_per_sec": 208.44287670358855, "timesteps_total": 2314694, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2314694, "timers": {"training_iteration_time_ms": 69858.464, "sample_time_ms": 43871.425, "load_time_ms": 2441.609, "load_throughput": 6404.793, "learn_time_ms": 22963.562, "learn_throughput": 680.992, "synch_weights_time_ms": 451.509}, "counters": {"num_env_steps_sampled": 2314694, "num_env_steps_trained": 2314694, "num_agent_steps_sampled": 2314694, "num_agent_steps_trained": 2314694}, "done": false, "episodes_total": 2186, "training_iteration": 156, "trial_id": "837cb_00000", "date": "2025-06-07_20-20-50", "timestamp": 1749320450, "time_this_iter_s": 75.04395627975464, "time_total_s": 10495.775705337524, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10495.775705337524, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 68.4267441860465, "ram_util_percent": 91.02441860465116, "gpu_util_percent0": 0.1909302325581395, "vram_util_percent0": 0.965006510416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.685306000000001e-05, "total_loss": -0.06791200419252907, "policy_loss": -0.021159679245531814, "vf_loss": 0.013313155007463965, "vf_explained_var": 0.9645383038304068, "kl": 0.020341548777604045, "entropy": 17.179102358384565, "entropy_coeff": 0.003027959}, "model": {}, "num_grad_updates_lifetime": 81715.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2330332, "num_env_steps_trained": 2330332, "num_agent_steps_sampled": 2330332, "num_agent_steps_trained": 2330332}, "sampler_results": {"episode_reward_max": 56.71729973395355, "episode_reward_min": 37.00489162050046, "episode_reward_mean": 48.35578740455551, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.89431817595543, 49.878185884577086, 42.26690725555053, 50.66816012913007, 40.49546524432818, 47.31288018738479, 52.1607595803827, 50.72146387956932, 52.799031343499585, 49.6745353311903, 51.90083121911495, 43.880038698149455, 50.02611282082852, 39.06746739645811, 52.820974510633036, 47.9903349575559, 45.229907886180115, 46.48786081726164, 40.49548412177021, 50.498326236225296, 54.51914508872664, 47.917611358251555, 54.82402996477274, 51.57823259484347, 51.03791731297898, 51.171146266261495, 47.93807359484015, 38.7726883746568, 50.29481559226723, 47.99463670146894, 46.44445484457895, 47.13049000867158, 38.57722424395472, 49.391759443773864, 56.23977619191679, 49.00843448663876, 56.71729973395355, 51.301297291227456, 54.46887409627967, 49.98342013234651, 51.74425128057746, 39.190489765970845, 49.72787280522848, 49.24883443255963, 45.41883421841074, 50.78950897803709, 37.59491578304256, 51.65893155864963, 50.432673620524426, 42.33367307347084, 53.848264342742524, 48.719868270567424, 52.13948292799935, 45.03101223455596, 50.61172160983446, 39.56116061636279, 51.90563534758813, 51.099231196024, 43.69125273331256, 46.801197917354834, 38.61929198156585, 48.475677353615595, 55.131133264528245, 44.12133006215563, 54.16461842583991, 49.17967475979774, 51.595409548581245, 51.70542784836658, 46.42940609461844, 39.43225888230067, 49.695039713870834, 46.22787075303528, 45.45036749107798, 44.99265198114263, 37.56758624695828, 52.56577447250711, 53.21565265426359, 47.80825261803577, 51.14653226089193, 51.36564603728707, 52.17339948066841, 48.873745377157064, 47.91645408039518, 41.01531812013718, 51.86406301198127, 51.711522197212645, 45.41991122780786, 44.979113239127145, 37.00489162050046, 48.50554143504311, 51.30798669763482, 49.572990731364634, 56.524426628795005, 47.19299623514923, 53.20323201383845, 50.69035932549047, 51.62295572574868, 37.91346411968093, 51.152726805412186, 53.91485422099648], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.76256966760985, "mean_inference_ms": 8.00684119727137, "mean_action_processing_ms": 0.5627469829097175, "mean_env_wait_ms": 24.364454790601922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03018021583557129, "StateBufferConnector_ms": 0.05179429054260254, "ViewRequirementAgentConnector_ms": 1.0190205574035645}}, "episode_reward_max": 56.71729973395355, "episode_reward_min": 37.00489162050046, "episode_reward_mean": 48.35578740455551, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.89431817595543, 49.878185884577086, 42.26690725555053, 50.66816012913007, 40.49546524432818, 47.31288018738479, 52.1607595803827, 50.72146387956932, 52.799031343499585, 49.6745353311903, 51.90083121911495, 43.880038698149455, 50.02611282082852, 39.06746739645811, 52.820974510633036, 47.9903349575559, 45.229907886180115, 46.48786081726164, 40.49548412177021, 50.498326236225296, 54.51914508872664, 47.917611358251555, 54.82402996477274, 51.57823259484347, 51.03791731297898, 51.171146266261495, 47.93807359484015, 38.7726883746568, 50.29481559226723, 47.99463670146894, 46.44445484457895, 47.13049000867158, 38.57722424395472, 49.391759443773864, 56.23977619191679, 49.00843448663876, 56.71729973395355, 51.301297291227456, 54.46887409627967, 49.98342013234651, 51.74425128057746, 39.190489765970845, 49.72787280522848, 49.24883443255963, 45.41883421841074, 50.78950897803709, 37.59491578304256, 51.65893155864963, 50.432673620524426, 42.33367307347084, 53.848264342742524, 48.719868270567424, 52.13948292799935, 45.03101223455596, 50.61172160983446, 39.56116061636279, 51.90563534758813, 51.099231196024, 43.69125273331256, 46.801197917354834, 38.61929198156585, 48.475677353615595, 55.131133264528245, 44.12133006215563, 54.16461842583991, 49.17967475979774, 51.595409548581245, 51.70542784836658, 46.42940609461844, 39.43225888230067, 49.695039713870834, 46.22787075303528, 45.45036749107798, 44.99265198114263, 37.56758624695828, 52.56577447250711, 53.21565265426359, 47.80825261803577, 51.14653226089193, 51.36564603728707, 52.17339948066841, 48.873745377157064, 47.91645408039518, 41.01531812013718, 51.86406301198127, 51.711522197212645, 45.41991122780786, 44.979113239127145, 37.00489162050046, 48.50554143504311, 51.30798669763482, 49.572990731364634, 56.524426628795005, 47.19299623514923, 53.20323201383845, 50.69035932549047, 51.62295572574868, 37.91346411968093, 51.152726805412186, 53.91485422099648], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.76256966760985, "mean_inference_ms": 8.00684119727137, "mean_action_processing_ms": 0.5627469829097175, "mean_env_wait_ms": 24.364454790601922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03018021583557129, "StateBufferConnector_ms": 0.05179429054260254, "ViewRequirementAgentConnector_ms": 1.0190205574035645}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2330332, "num_agent_steps_trained": 2330332, "num_env_steps_sampled": 2330332, "num_env_steps_trained": 2330332, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 225.53983364296013, "num_env_steps_trained_throughput_per_sec": 225.53983364296013, "timesteps_total": 2330332, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2330332, "timers": {"training_iteration_time_ms": 69904.268, "sample_time_ms": 43979.22, "load_time_ms": 2453.731, "load_throughput": 6373.152, "learn_time_ms": 22882.92, "learn_throughput": 683.392, "synch_weights_time_ms": 457.697}, "counters": {"num_env_steps_sampled": 2330332, "num_env_steps_trained": 2330332, "num_agent_steps_sampled": 2330332, "num_agent_steps_trained": 2330332}, "done": false, "episodes_total": 2200, "training_iteration": 157, "trial_id": "837cb_00000", "date": "2025-06-07_20-22-00", "timestamp": 1749320520, "time_this_iter_s": 69.35844612121582, "time_total_s": 10565.13415145874, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10565.13415145874, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 66.55499999999999, "ram_util_percent": 90.14124999999999, "gpu_util_percent0": 0.213625, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.669668e-05, "total_loss": -0.07400459453791634, "policy_loss": -0.027707330586642705, "vf_loss": 0.013533100063319911, "vf_explained_var": 0.9672285176407207, "kl": 0.02117103745931161, "entropy": 17.20098119909113, "entropy_coeff": 0.0030045019999999996}, "model": {}, "num_grad_updates_lifetime": 82265.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2345970, "num_env_steps_trained": 2345970, "num_agent_steps_sampled": 2345970, "num_agent_steps_trained": 2345970}, "sampler_results": {"episode_reward_max": 56.71729973395355, "episode_reward_min": 37.00489162050046, "episode_reward_mean": 48.318863560951094, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.820974510633036, 47.9903349575559, 45.229907886180115, 46.48786081726164, 40.49548412177021, 50.498326236225296, 54.51914508872664, 47.917611358251555, 54.82402996477274, 51.57823259484347, 51.03791731297898, 51.171146266261495, 47.93807359484015, 38.7726883746568, 50.29481559226723, 47.99463670146894, 46.44445484457895, 47.13049000867158, 38.57722424395472, 49.391759443773864, 56.23977619191679, 49.00843448663876, 56.71729973395355, 51.301297291227456, 54.46887409627967, 49.98342013234651, 51.74425128057746, 39.190489765970845, 49.72787280522848, 49.24883443255963, 45.41883421841074, 50.78950897803709, 37.59491578304256, 51.65893155864963, 50.432673620524426, 42.33367307347084, 53.848264342742524, 48.719868270567424, 52.13948292799935, 45.03101223455596, 50.61172160983446, 39.56116061636279, 51.90563534758813, 51.099231196024, 43.69125273331256, 46.801197917354834, 38.61929198156585, 48.475677353615595, 55.131133264528245, 44.12133006215563, 54.16461842583991, 49.17967475979774, 51.595409548581245, 51.70542784836658, 46.42940609461844, 39.43225888230067, 49.695039713870834, 46.22787075303528, 45.45036749107798, 44.99265198114263, 37.56758624695828, 52.56577447250711, 53.21565265426359, 47.80825261803577, 51.14653226089193, 51.36564603728707, 52.17339948066841, 48.873745377157064, 47.91645408039518, 41.01531812013718, 51.86406301198127, 51.711522197212645, 45.41991122780786, 44.979113239127145, 37.00489162050046, 48.50554143504311, 51.30798669763482, 49.572990731364634, 56.524426628795005, 47.19299623514923, 53.20323201383845, 50.69035932549047, 51.62295572574868, 37.91346411968093, 51.152726805412186, 53.91485422099648, 45.358074985545585, 50.98988284158422, 41.852335442688855, 45.78497439869221, 51.071440137097305, 44.291584722715164, 50.40213300436493, 48.104936411202445, 49.6383533224133, 49.76594127518956, 55.069857375990566, 37.68442479702842, 47.512177959578835, 52.52765611158626], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.76421344094129, "mean_inference_ms": 8.012805549813041, "mean_action_processing_ms": 0.5631162044731474, "mean_env_wait_ms": 24.370802485718023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031116724014282227, "StateBufferConnector_ms": 0.052864789962768555, "ViewRequirementAgentConnector_ms": 1.01841402053833}}, "episode_reward_max": 56.71729973395355, "episode_reward_min": 37.00489162050046, "episode_reward_mean": 48.318863560951094, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [52.820974510633036, 47.9903349575559, 45.229907886180115, 46.48786081726164, 40.49548412177021, 50.498326236225296, 54.51914508872664, 47.917611358251555, 54.82402996477274, 51.57823259484347, 51.03791731297898, 51.171146266261495, 47.93807359484015, 38.7726883746568, 50.29481559226723, 47.99463670146894, 46.44445484457895, 47.13049000867158, 38.57722424395472, 49.391759443773864, 56.23977619191679, 49.00843448663876, 56.71729973395355, 51.301297291227456, 54.46887409627967, 49.98342013234651, 51.74425128057746, 39.190489765970845, 49.72787280522848, 49.24883443255963, 45.41883421841074, 50.78950897803709, 37.59491578304256, 51.65893155864963, 50.432673620524426, 42.33367307347084, 53.848264342742524, 48.719868270567424, 52.13948292799935, 45.03101223455596, 50.61172160983446, 39.56116061636279, 51.90563534758813, 51.099231196024, 43.69125273331256, 46.801197917354834, 38.61929198156585, 48.475677353615595, 55.131133264528245, 44.12133006215563, 54.16461842583991, 49.17967475979774, 51.595409548581245, 51.70542784836658, 46.42940609461844, 39.43225888230067, 49.695039713870834, 46.22787075303528, 45.45036749107798, 44.99265198114263, 37.56758624695828, 52.56577447250711, 53.21565265426359, 47.80825261803577, 51.14653226089193, 51.36564603728707, 52.17339948066841, 48.873745377157064, 47.91645408039518, 41.01531812013718, 51.86406301198127, 51.711522197212645, 45.41991122780786, 44.979113239127145, 37.00489162050046, 48.50554143504311, 51.30798669763482, 49.572990731364634, 56.524426628795005, 47.19299623514923, 53.20323201383845, 50.69035932549047, 51.62295572574868, 37.91346411968093, 51.152726805412186, 53.91485422099648, 45.358074985545585, 50.98988284158422, 41.852335442688855, 45.78497439869221, 51.071440137097305, 44.291584722715164, 50.40213300436493, 48.104936411202445, 49.6383533224133, 49.76594127518956, 55.069857375990566, 37.68442479702842, 47.512177959578835, 52.52765611158626], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.76421344094129, "mean_inference_ms": 8.012805549813041, "mean_action_processing_ms": 0.5631162044731474, "mean_env_wait_ms": 24.370802485718023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031116724014282227, "StateBufferConnector_ms": 0.052864789962768555, "ViewRequirementAgentConnector_ms": 1.01841402053833}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2345970, "num_agent_steps_trained": 2345970, "num_env_steps_sampled": 2345970, "num_env_steps_trained": 2345970, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 224.4781779031662, "num_env_steps_trained_throughput_per_sec": 224.4781779031662, "timesteps_total": 2345970, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2345970, "timers": {"training_iteration_time_ms": 69962.199, "sample_time_ms": 44026.957, "load_time_ms": 2481.79, "load_throughput": 6301.097, "learn_time_ms": 22855.273, "learn_throughput": 684.218, "synch_weights_time_ms": 466.786}, "counters": {"num_env_steps_sampled": 2345970, "num_env_steps_trained": 2345970, "num_agent_steps_sampled": 2345970, "num_agent_steps_trained": 2345970}, "done": false, "episodes_total": 2214, "training_iteration": 158, "trial_id": "837cb_00000", "date": "2025-06-07_20-23-09", "timestamp": 1749320589, "time_this_iter_s": 69.68278646469116, "time_total_s": 10634.816937923431, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10634.816937923431, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 67.83456790123458, "ram_util_percent": 88.2925925925926, "gpu_util_percent0": 0.20740740740740737, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.654030000000002e-05, "total_loss": -0.06064666363336569, "policy_loss": -0.014478333127494393, "vf_loss": 0.013087195884436369, "vf_explained_var": 0.9669693723591891, "kl": 0.020832387509533777, "entropy": 17.24110636277632, "entropy_coeff": 0.002981045}, "model": {}, "num_grad_updates_lifetime": 82815.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2361608, "num_env_steps_trained": 2361608, "num_agent_steps_sampled": 2361608, "num_agent_steps_trained": 2361608}, "sampler_results": {"episode_reward_max": 56.71729973395355, "episode_reward_min": 37.00489162050046, "episode_reward_mean": 48.273603368918685, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.29481559226723, 47.99463670146894, 46.44445484457895, 47.13049000867158, 38.57722424395472, 49.391759443773864, 56.23977619191679, 49.00843448663876, 56.71729973395355, 51.301297291227456, 54.46887409627967, 49.98342013234651, 51.74425128057746, 39.190489765970845, 49.72787280522848, 49.24883443255963, 45.41883421841074, 50.78950897803709, 37.59491578304256, 51.65893155864963, 50.432673620524426, 42.33367307347084, 53.848264342742524, 48.719868270567424, 52.13948292799935, 45.03101223455596, 50.61172160983446, 39.56116061636279, 51.90563534758813, 51.099231196024, 43.69125273331256, 46.801197917354834, 38.61929198156585, 48.475677353615595, 55.131133264528245, 44.12133006215563, 54.16461842583991, 49.17967475979774, 51.595409548581245, 51.70542784836658, 46.42940609461844, 39.43225888230067, 49.695039713870834, 46.22787075303528, 45.45036749107798, 44.99265198114263, 37.56758624695828, 52.56577447250711, 53.21565265426359, 47.80825261803577, 51.14653226089193, 51.36564603728707, 52.17339948066841, 48.873745377157064, 47.91645408039518, 41.01531812013718, 51.86406301198127, 51.711522197212645, 45.41991122780786, 44.979113239127145, 37.00489162050046, 48.50554143504311, 51.30798669763482, 49.572990731364634, 56.524426628795005, 47.19299623514923, 53.20323201383845, 50.69035932549047, 51.62295572574868, 37.91346411968093, 51.152726805412186, 53.91485422099648, 45.358074985545585, 50.98988284158422, 41.852335442688855, 45.78497439869221, 51.071440137097305, 44.291584722715164, 50.40213300436493, 48.104936411202445, 49.6383533224133, 49.76594127518956, 55.069857375990566, 37.68442479702842, 47.512177959578835, 52.52765611158626, 47.84460135774572, 50.57210412100564, 39.18912499872814, 46.85267977124039, 52.907304443193745, 49.37318329877669, 52.223627254286825, 47.85994336601419, 52.14442766264249, 49.28151616022085, 50.69360977726998, 38.40326794254729, 47.903099263663805, 51.507224464381736], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7662201511875035, "mean_inference_ms": 8.018808172085368, "mean_action_processing_ms": 0.5635039308091423, "mean_env_wait_ms": 24.376478205597415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03701186180114746, "StateBufferConnector_ms": 0.03908348083496094, "ViewRequirementAgentConnector_ms": 1.0204334259033203}}, "episode_reward_max": 56.71729973395355, "episode_reward_min": 37.00489162050046, "episode_reward_mean": 48.273603368918685, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.29481559226723, 47.99463670146894, 46.44445484457895, 47.13049000867158, 38.57722424395472, 49.391759443773864, 56.23977619191679, 49.00843448663876, 56.71729973395355, 51.301297291227456, 54.46887409627967, 49.98342013234651, 51.74425128057746, 39.190489765970845, 49.72787280522848, 49.24883443255963, 45.41883421841074, 50.78950897803709, 37.59491578304256, 51.65893155864963, 50.432673620524426, 42.33367307347084, 53.848264342742524, 48.719868270567424, 52.13948292799935, 45.03101223455596, 50.61172160983446, 39.56116061636279, 51.90563534758813, 51.099231196024, 43.69125273331256, 46.801197917354834, 38.61929198156585, 48.475677353615595, 55.131133264528245, 44.12133006215563, 54.16461842583991, 49.17967475979774, 51.595409548581245, 51.70542784836658, 46.42940609461844, 39.43225888230067, 49.695039713870834, 46.22787075303528, 45.45036749107798, 44.99265198114263, 37.56758624695828, 52.56577447250711, 53.21565265426359, 47.80825261803577, 51.14653226089193, 51.36564603728707, 52.17339948066841, 48.873745377157064, 47.91645408039518, 41.01531812013718, 51.86406301198127, 51.711522197212645, 45.41991122780786, 44.979113239127145, 37.00489162050046, 48.50554143504311, 51.30798669763482, 49.572990731364634, 56.524426628795005, 47.19299623514923, 53.20323201383845, 50.69035932549047, 51.62295572574868, 37.91346411968093, 51.152726805412186, 53.91485422099648, 45.358074985545585, 50.98988284158422, 41.852335442688855, 45.78497439869221, 51.071440137097305, 44.291584722715164, 50.40213300436493, 48.104936411202445, 49.6383533224133, 49.76594127518956, 55.069857375990566, 37.68442479702842, 47.512177959578835, 52.52765611158626, 47.84460135774572, 50.57210412100564, 39.18912499872814, 46.85267977124039, 52.907304443193745, 49.37318329877669, 52.223627254286825, 47.85994336601419, 52.14442766264249, 49.28151616022085, 50.69360977726998, 38.40326794254729, 47.903099263663805, 51.507224464381736], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7662201511875035, "mean_inference_ms": 8.018808172085368, "mean_action_processing_ms": 0.5635039308091423, "mean_env_wait_ms": 24.376478205597415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03701186180114746, "StateBufferConnector_ms": 0.03908348083496094, "ViewRequirementAgentConnector_ms": 1.0204334259033203}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2361608, "num_agent_steps_trained": 2361608, "num_env_steps_sampled": 2361608, "num_env_steps_trained": 2361608, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 215.36355756966495, "num_env_steps_trained_throughput_per_sec": 215.36355756966495, "timesteps_total": 2361608, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2361608, "timers": {"training_iteration_time_ms": 70311.309, "sample_time_ms": 44385.386, "load_time_ms": 2502.598, "load_throughput": 6248.706, "learn_time_ms": 22824.847, "learn_throughput": 685.131, "synch_weights_time_ms": 470.737}, "counters": {"num_env_steps_sampled": 2361608, "num_env_steps_trained": 2361608, "num_agent_steps_sampled": 2361608, "num_agent_steps_trained": 2361608}, "done": false, "episodes_total": 2228, "training_iteration": 159, "trial_id": "837cb_00000", "date": "2025-06-07_20-24-22", "timestamp": 1749320662, "time_this_iter_s": 72.63009715080261, "time_total_s": 10707.447035074234, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10707.447035074234, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 69.07951807228916, "ram_util_percent": 89.6120481927711, "gpu_util_percent0": 0.2089156626506024, "vram_util_percent0": 0.9650065104166667}}
{"evaluation": {"sampler_results": {"episode_reward_max": 3.92081510964617, "episode_reward_min": 2.5415577023025344, "episode_reward_mean": 3.335627029759197, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.5415577023025344, 3.2799052297363853, 3.453275471054107, 3.482581636056787, 3.92081510964617], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8373149203003831, "mean_inference_ms": 3.999711038560843, "mean_action_processing_ms": 0.2971213275781671, "mean_env_wait_ms": 12.299850075945047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01990795135498047, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 1.2481927871704102}}, "episode_reward_max": 3.92081510964617, "episode_reward_min": 2.5415577023025344, "episode_reward_mean": 3.335627029759197, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.5415577023025344, 3.2799052297363853, 3.453275471054107, 3.482581636056787, 3.92081510964617], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8373149203003831, "mean_inference_ms": 3.999711038560843, "mean_action_processing_ms": 0.2971213275781671, "mean_env_wait_ms": 12.299850075945047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01990795135498047, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 1.2481927871704102}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.638391999999999e-05, "total_loss": -0.05621862026185474, "policy_loss": -0.01066365510505751, "vf_loss": 0.014260191483084451, "vf_explained_var": 0.9630497182499279, "kl": 0.021321621667281656, "entropy": 17.299780915000223, "entropy_coeff": 0.0029575880000000006}, "model": {}, "num_grad_updates_lifetime": 83365.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2377246, "num_env_steps_trained": 2377246, "num_agent_steps_sampled": 2377246, "num_agent_steps_trained": 2377246}, "sampler_results": {"episode_reward_max": 57.066299290114955, "episode_reward_min": 35.23721928826338, "episode_reward_mean": 48.03181747860462, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.72787280522848, 49.24883443255963, 45.41883421841074, 50.78950897803709, 37.59491578304256, 51.65893155864963, 50.432673620524426, 42.33367307347084, 53.848264342742524, 48.719868270567424, 52.13948292799935, 45.03101223455596, 50.61172160983446, 39.56116061636279, 51.90563534758813, 51.099231196024, 43.69125273331256, 46.801197917354834, 38.61929198156585, 48.475677353615595, 55.131133264528245, 44.12133006215563, 54.16461842583991, 49.17967475979774, 51.595409548581245, 51.70542784836658, 46.42940609461844, 39.43225888230067, 49.695039713870834, 46.22787075303528, 45.45036749107798, 44.99265198114263, 37.56758624695828, 52.56577447250711, 53.21565265426359, 47.80825261803577, 51.14653226089193, 51.36564603728707, 52.17339948066841, 48.873745377157064, 47.91645408039518, 41.01531812013718, 51.86406301198127, 51.711522197212645, 45.41991122780786, 44.979113239127145, 37.00489162050046, 48.50554143504311, 51.30798669763482, 49.572990731364634, 56.524426628795005, 47.19299623514923, 53.20323201383845, 50.69035932549047, 51.62295572574868, 37.91346411968093, 51.152726805412186, 53.91485422099648, 45.358074985545585, 50.98988284158422, 41.852335442688855, 45.78497439869221, 51.071440137097305, 44.291584722715164, 50.40213300436493, 48.104936411202445, 49.6383533224133, 49.76594127518956, 55.069857375990566, 37.68442479702842, 47.512177959578835, 52.52765611158626, 47.84460135774572, 50.57210412100564, 39.18912499872814, 46.85267977124039, 52.907304443193745, 49.37318329877669, 52.223627254286825, 47.85994336601419, 52.14442766264249, 49.28151616022085, 50.69360977726998, 38.40326794254729, 47.903099263663805, 51.507224464381736, 45.80953957242752, 42.79675695926555, 35.23721928826338, 52.71364998849263, 49.21979787952573, 47.656296871446294, 57.066299290114955, 46.31670546842499, 49.38022333705747, 50.01131732020681, 48.55746666783177, 35.47154189861008, 50.38608263532894, 53.685737605223665], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.768892115573132, "mean_inference_ms": 8.026240990397094, "mean_action_processing_ms": 0.5639733981521498, "mean_env_wait_ms": 24.384863923766392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043914794921875, "StateBufferConnector_ms": 0.039302825927734375, "ViewRequirementAgentConnector_ms": 1.060718059539795}}, "episode_reward_max": 57.066299290114955, "episode_reward_min": 35.23721928826338, "episode_reward_mean": 48.03181747860462, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [49.72787280522848, 49.24883443255963, 45.41883421841074, 50.78950897803709, 37.59491578304256, 51.65893155864963, 50.432673620524426, 42.33367307347084, 53.848264342742524, 48.719868270567424, 52.13948292799935, 45.03101223455596, 50.61172160983446, 39.56116061636279, 51.90563534758813, 51.099231196024, 43.69125273331256, 46.801197917354834, 38.61929198156585, 48.475677353615595, 55.131133264528245, 44.12133006215563, 54.16461842583991, 49.17967475979774, 51.595409548581245, 51.70542784836658, 46.42940609461844, 39.43225888230067, 49.695039713870834, 46.22787075303528, 45.45036749107798, 44.99265198114263, 37.56758624695828, 52.56577447250711, 53.21565265426359, 47.80825261803577, 51.14653226089193, 51.36564603728707, 52.17339948066841, 48.873745377157064, 47.91645408039518, 41.01531812013718, 51.86406301198127, 51.711522197212645, 45.41991122780786, 44.979113239127145, 37.00489162050046, 48.50554143504311, 51.30798669763482, 49.572990731364634, 56.524426628795005, 47.19299623514923, 53.20323201383845, 50.69035932549047, 51.62295572574868, 37.91346411968093, 51.152726805412186, 53.91485422099648, 45.358074985545585, 50.98988284158422, 41.852335442688855, 45.78497439869221, 51.071440137097305, 44.291584722715164, 50.40213300436493, 48.104936411202445, 49.6383533224133, 49.76594127518956, 55.069857375990566, 37.68442479702842, 47.512177959578835, 52.52765611158626, 47.84460135774572, 50.57210412100564, 39.18912499872814, 46.85267977124039, 52.907304443193745, 49.37318329877669, 52.223627254286825, 47.85994336601419, 52.14442766264249, 49.28151616022085, 50.69360977726998, 38.40326794254729, 47.903099263663805, 51.507224464381736, 45.80953957242752, 42.79675695926555, 35.23721928826338, 52.71364998849263, 49.21979787952573, 47.656296871446294, 57.066299290114955, 46.31670546842499, 49.38022333705747, 50.01131732020681, 48.55746666783177, 35.47154189861008, 50.38608263532894, 53.685737605223665], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.768892115573132, "mean_inference_ms": 8.026240990397094, "mean_action_processing_ms": 0.5639733981521498, "mean_env_wait_ms": 24.384863923766392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043914794921875, "StateBufferConnector_ms": 0.039302825927734375, "ViewRequirementAgentConnector_ms": 1.060718059539795}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2377246, "num_agent_steps_trained": 2377246, "num_env_steps_sampled": 2377246, "num_env_steps_trained": 2377246, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 201.88537498328702, "num_env_steps_trained_throughput_per_sec": 201.88537498328702, "timesteps_total": 2377246, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2377246, "timers": {"training_iteration_time_ms": 71197.873, "sample_time_ms": 45047.906, "load_time_ms": 2672.183, "load_throughput": 5852.144, "learn_time_ms": 22863.534, "learn_throughput": 683.971, "synch_weights_time_ms": 485.253}, "counters": {"num_env_steps_sampled": 2377246, "num_env_steps_trained": 2377246, "num_agent_steps_sampled": 2377246, "num_agent_steps_trained": 2377246}, "done": false, "episodes_total": 2242, "training_iteration": 160, "trial_id": "837cb_00000", "date": "2025-06-07_20-25-58", "timestamp": 1749320758, "time_this_iter_s": 95.83503794670105, "time_total_s": 10803.282073020935, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10803.282073020935, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 60.324770642201834, "ram_util_percent": 90.60091743119264, "gpu_util_percent0": 0.15743119266055047, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.622754000000001e-05, "total_loss": -0.06809528262989427, "policy_loss": -0.022676867597567086, "vf_loss": 0.01383143053559417, "vf_explained_var": 0.9639422855593941, "kl": 0.020728732049999178, "entropy": 17.33507759441029, "entropy_coeff": 0.0029341310000000004}, "model": {}, "num_grad_updates_lifetime": 83915.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2392884, "num_env_steps_trained": 2392884, "num_agent_steps_sampled": 2392884, "num_agent_steps_trained": 2392884}, "sampler_results": {"episode_reward_max": 57.066299290114955, "episode_reward_min": 33.88073466358054, "episode_reward_mean": 47.96044019773454, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.90563534758813, 51.099231196024, 43.69125273331256, 46.801197917354834, 38.61929198156585, 48.475677353615595, 55.131133264528245, 44.12133006215563, 54.16461842583991, 49.17967475979774, 51.595409548581245, 51.70542784836658, 46.42940609461844, 39.43225888230067, 49.695039713870834, 46.22787075303528, 45.45036749107798, 44.99265198114263, 37.56758624695828, 52.56577447250711, 53.21565265426359, 47.80825261803577, 51.14653226089193, 51.36564603728707, 52.17339948066841, 48.873745377157064, 47.91645408039518, 41.01531812013718, 51.86406301198127, 51.711522197212645, 45.41991122780786, 44.979113239127145, 37.00489162050046, 48.50554143504311, 51.30798669763482, 49.572990731364634, 56.524426628795005, 47.19299623514923, 53.20323201383845, 50.69035932549047, 51.62295572574868, 37.91346411968093, 51.152726805412186, 53.91485422099648, 45.358074985545585, 50.98988284158422, 41.852335442688855, 45.78497439869221, 51.071440137097305, 44.291584722715164, 50.40213300436493, 48.104936411202445, 49.6383533224133, 49.76594127518956, 55.069857375990566, 37.68442479702842, 47.512177959578835, 52.52765611158626, 47.84460135774572, 50.57210412100564, 39.18912499872814, 46.85267977124039, 52.907304443193745, 49.37318329877669, 52.223627254286825, 47.85994336601419, 52.14442766264249, 49.28151616022085, 50.69360977726998, 38.40326794254729, 47.903099263663805, 51.507224464381736, 45.80953957242752, 42.79675695926555, 35.23721928826338, 52.71364998849263, 49.21979787952573, 47.656296871446294, 57.066299290114955, 46.31670546842499, 49.38022333705747, 50.01131732020681, 48.55746666783177, 35.47154189861008, 50.38608263532894, 53.685737605223665, 42.914824608539796, 45.89969520178845, 37.40339496873031, 47.38469092372292, 54.41335296010629, 47.09789727941595, 52.82433959248122, 46.9606306699219, 51.923745011603906, 50.937421776089515, 49.10789717035014, 33.88073466358054, 48.52294261042137, 50.70745894822606], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7720001945673958, "mean_inference_ms": 8.034388467861783, "mean_action_processing_ms": 0.5644860838530603, "mean_env_wait_ms": 24.39442681954322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050943613052368164, "StateBufferConnector_ms": 0.04147219657897949, "ViewRequirementAgentConnector_ms": 1.078580617904663}}, "episode_reward_max": 57.066299290114955, "episode_reward_min": 33.88073466358054, "episode_reward_mean": 47.96044019773454, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [51.90563534758813, 51.099231196024, 43.69125273331256, 46.801197917354834, 38.61929198156585, 48.475677353615595, 55.131133264528245, 44.12133006215563, 54.16461842583991, 49.17967475979774, 51.595409548581245, 51.70542784836658, 46.42940609461844, 39.43225888230067, 49.695039713870834, 46.22787075303528, 45.45036749107798, 44.99265198114263, 37.56758624695828, 52.56577447250711, 53.21565265426359, 47.80825261803577, 51.14653226089193, 51.36564603728707, 52.17339948066841, 48.873745377157064, 47.91645408039518, 41.01531812013718, 51.86406301198127, 51.711522197212645, 45.41991122780786, 44.979113239127145, 37.00489162050046, 48.50554143504311, 51.30798669763482, 49.572990731364634, 56.524426628795005, 47.19299623514923, 53.20323201383845, 50.69035932549047, 51.62295572574868, 37.91346411968093, 51.152726805412186, 53.91485422099648, 45.358074985545585, 50.98988284158422, 41.852335442688855, 45.78497439869221, 51.071440137097305, 44.291584722715164, 50.40213300436493, 48.104936411202445, 49.6383533224133, 49.76594127518956, 55.069857375990566, 37.68442479702842, 47.512177959578835, 52.52765611158626, 47.84460135774572, 50.57210412100564, 39.18912499872814, 46.85267977124039, 52.907304443193745, 49.37318329877669, 52.223627254286825, 47.85994336601419, 52.14442766264249, 49.28151616022085, 50.69360977726998, 38.40326794254729, 47.903099263663805, 51.507224464381736, 45.80953957242752, 42.79675695926555, 35.23721928826338, 52.71364998849263, 49.21979787952573, 47.656296871446294, 57.066299290114955, 46.31670546842499, 49.38022333705747, 50.01131732020681, 48.55746666783177, 35.47154189861008, 50.38608263532894, 53.685737605223665, 42.914824608539796, 45.89969520178845, 37.40339496873031, 47.38469092372292, 54.41335296010629, 47.09789727941595, 52.82433959248122, 46.9606306699219, 51.923745011603906, 50.937421776089515, 49.10789717035014, 33.88073466358054, 48.52294261042137, 50.70745894822606], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7720001945673958, "mean_inference_ms": 8.034388467861783, "mean_action_processing_ms": 0.5644860838530603, "mean_env_wait_ms": 24.39442681954322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050943613052368164, "StateBufferConnector_ms": 0.04147219657897949, "ViewRequirementAgentConnector_ms": 1.078580617904663}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2392884, "num_agent_steps_trained": 2392884, "num_env_steps_sampled": 2392884, "num_env_steps_trained": 2392884, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 212.35617521836, "num_env_steps_trained_throughput_per_sec": 212.35617521836, "timesteps_total": 2392884, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2392884, "timers": {"training_iteration_time_ms": 71670.049, "sample_time_ms": 45440.623, "load_time_ms": 2790.905, "load_throughput": 5603.201, "learn_time_ms": 22814.969, "learn_throughput": 685.427, "synch_weights_time_ms": 493.245}, "counters": {"num_env_steps_sampled": 2392884, "num_env_steps_trained": 2392884, "num_agent_steps_sampled": 2392884, "num_agent_steps_trained": 2392884}, "done": false, "episodes_total": 2256, "training_iteration": 161, "trial_id": "837cb_00000", "date": "2025-06-07_20-27-12", "timestamp": 1749320832, "time_this_iter_s": 73.65949368476868, "time_total_s": 10876.941566705704, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10876.941566705704, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 68.17764705882354, "ram_util_percent": 89.88235294117646, "gpu_util_percent0": 0.1995294117647059, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.607116e-05, "total_loss": -0.06893816594669426, "policy_loss": -0.023854531901782716, "vf_loss": 0.013768272170881656, "vf_explained_var": 0.9629901438409632, "kl": 0.021773775860418995, "entropy": 17.37569295016202, "entropy_coeff": 0.0029106740000000002}, "model": {}, "num_grad_updates_lifetime": 84465.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2408522, "num_env_steps_trained": 2408522, "num_agent_steps_sampled": 2408522, "num_agent_steps_trained": 2408522}, "sampler_results": {"episode_reward_max": 57.066299290114955, "episode_reward_min": 33.88073466358054, "episode_reward_mean": 47.72748609661744, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.695039713870834, 46.22787075303528, 45.45036749107798, 44.99265198114263, 37.56758624695828, 52.56577447250711, 53.21565265426359, 47.80825261803577, 51.14653226089193, 51.36564603728707, 52.17339948066841, 48.873745377157064, 47.91645408039518, 41.01531812013718, 51.86406301198127, 51.711522197212645, 45.41991122780786, 44.979113239127145, 37.00489162050046, 48.50554143504311, 51.30798669763482, 49.572990731364634, 56.524426628795005, 47.19299623514923, 53.20323201383845, 50.69035932549047, 51.62295572574868, 37.91346411968093, 51.152726805412186, 53.91485422099648, 45.358074985545585, 50.98988284158422, 41.852335442688855, 45.78497439869221, 51.071440137097305, 44.291584722715164, 50.40213300436493, 48.104936411202445, 49.6383533224133, 49.76594127518956, 55.069857375990566, 37.68442479702842, 47.512177959578835, 52.52765611158626, 47.84460135774572, 50.57210412100564, 39.18912499872814, 46.85267977124039, 52.907304443193745, 49.37318329877669, 52.223627254286825, 47.85994336601419, 52.14442766264249, 49.28151616022085, 50.69360977726998, 38.40326794254729, 47.903099263663805, 51.507224464381736, 45.80953957242752, 42.79675695926555, 35.23721928826338, 52.71364998849263, 49.21979787952573, 47.656296871446294, 57.066299290114955, 46.31670546842499, 49.38022333705747, 50.01131732020681, 48.55746666783177, 35.47154189861008, 50.38608263532894, 53.685737605223665, 42.914824608539796, 45.89969520178845, 37.40339496873031, 47.38469092372292, 54.41335296010629, 47.09789727941595, 52.82433959248122, 46.9606306699219, 51.923745011603906, 50.937421776089515, 49.10789717035014, 33.88073466358054, 48.52294261042137, 50.70745894822606, 42.04421769083073, 48.78702407646271, 39.22735011608158, 48.029970348731425, 51.51987682489117, 45.03163809110167, 50.50743677404045, 48.332722084493874, 50.28555793988273, 41.94605374697255, 47.947673741462985, 40.348152179496175, 47.635034268350076, 47.41342742114043], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7755084098902683, "mean_inference_ms": 8.043427329618343, "mean_action_processing_ms": 0.5650583577155708, "mean_env_wait_ms": 24.40594219839973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048865556716918945, "StateBufferConnector_ms": 0.0423738956451416, "ViewRequirementAgentConnector_ms": 1.0969278812408447}}, "episode_reward_max": 57.066299290114955, "episode_reward_min": 33.88073466358054, "episode_reward_mean": 47.72748609661744, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [49.695039713870834, 46.22787075303528, 45.45036749107798, 44.99265198114263, 37.56758624695828, 52.56577447250711, 53.21565265426359, 47.80825261803577, 51.14653226089193, 51.36564603728707, 52.17339948066841, 48.873745377157064, 47.91645408039518, 41.01531812013718, 51.86406301198127, 51.711522197212645, 45.41991122780786, 44.979113239127145, 37.00489162050046, 48.50554143504311, 51.30798669763482, 49.572990731364634, 56.524426628795005, 47.19299623514923, 53.20323201383845, 50.69035932549047, 51.62295572574868, 37.91346411968093, 51.152726805412186, 53.91485422099648, 45.358074985545585, 50.98988284158422, 41.852335442688855, 45.78497439869221, 51.071440137097305, 44.291584722715164, 50.40213300436493, 48.104936411202445, 49.6383533224133, 49.76594127518956, 55.069857375990566, 37.68442479702842, 47.512177959578835, 52.52765611158626, 47.84460135774572, 50.57210412100564, 39.18912499872814, 46.85267977124039, 52.907304443193745, 49.37318329877669, 52.223627254286825, 47.85994336601419, 52.14442766264249, 49.28151616022085, 50.69360977726998, 38.40326794254729, 47.903099263663805, 51.507224464381736, 45.80953957242752, 42.79675695926555, 35.23721928826338, 52.71364998849263, 49.21979787952573, 47.656296871446294, 57.066299290114955, 46.31670546842499, 49.38022333705747, 50.01131732020681, 48.55746666783177, 35.47154189861008, 50.38608263532894, 53.685737605223665, 42.914824608539796, 45.89969520178845, 37.40339496873031, 47.38469092372292, 54.41335296010629, 47.09789727941595, 52.82433959248122, 46.9606306699219, 51.923745011603906, 50.937421776089515, 49.10789717035014, 33.88073466358054, 48.52294261042137, 50.70745894822606, 42.04421769083073, 48.78702407646271, 39.22735011608158, 48.029970348731425, 51.51987682489117, 45.03163809110167, 50.50743677404045, 48.332722084493874, 50.28555793988273, 41.94605374697255, 47.947673741462985, 40.348152179496175, 47.635034268350076, 47.41342742114043], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7755084098902683, "mean_inference_ms": 8.043427329618343, "mean_action_processing_ms": 0.5650583577155708, "mean_env_wait_ms": 24.40594219839973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048865556716918945, "StateBufferConnector_ms": 0.0423738956451416, "ViewRequirementAgentConnector_ms": 1.0969278812408447}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2408522, "num_agent_steps_trained": 2408522, "num_env_steps_sampled": 2408522, "num_env_steps_trained": 2408522, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 210.59233025287395, "num_env_steps_trained_throughput_per_sec": 210.59233025287395, "timesteps_total": 2408522, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2408522, "timers": {"training_iteration_time_ms": 71802.206, "sample_time_ms": 45509.114, "load_time_ms": 2777.865, "load_throughput": 5629.503, "learn_time_ms": 22886.911, "learn_throughput": 683.273, "synch_weights_time_ms": 501.45}, "counters": {"num_env_steps_sampled": 2408522, "num_env_steps_trained": 2408522, "num_agent_steps_sampled": 2408522, "num_agent_steps_trained": 2408522}, "done": false, "episodes_total": 2270, "training_iteration": 162, "trial_id": "837cb_00000", "date": "2025-06-07_20-28-26", "timestamp": 1749320906, "time_this_iter_s": 74.28121662139893, "time_total_s": 10951.222783327103, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10951.222783327103, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 69.9011904761905, "ram_util_percent": 87.17738095238094, "gpu_util_percent0": 0.20404761904761906, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.591478e-05, "total_loss": -0.08100455344188959, "policy_loss": -0.0359140767144378, "vf_loss": 0.012880780528807504, "vf_explained_var": 0.9656095091863112, "kl": 0.020694733595142182, "entropy": 17.403655003634366, "entropy_coeff": 0.0028872170000000005}, "model": {}, "num_grad_updates_lifetime": 85015.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2424160, "num_env_steps_trained": 2424160, "num_agent_steps_sampled": 2424160, "num_agent_steps_trained": 2424160}, "sampler_results": {"episode_reward_max": 57.066299290114955, "episode_reward_min": 33.88073466358054, "episode_reward_mean": 47.57276353479651, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.86406301198127, 51.711522197212645, 45.41991122780786, 44.979113239127145, 37.00489162050046, 48.50554143504311, 51.30798669763482, 49.572990731364634, 56.524426628795005, 47.19299623514923, 53.20323201383845, 50.69035932549047, 51.62295572574868, 37.91346411968093, 51.152726805412186, 53.91485422099648, 45.358074985545585, 50.98988284158422, 41.852335442688855, 45.78497439869221, 51.071440137097305, 44.291584722715164, 50.40213300436493, 48.104936411202445, 49.6383533224133, 49.76594127518956, 55.069857375990566, 37.68442479702842, 47.512177959578835, 52.52765611158626, 47.84460135774572, 50.57210412100564, 39.18912499872814, 46.85267977124039, 52.907304443193745, 49.37318329877669, 52.223627254286825, 47.85994336601419, 52.14442766264249, 49.28151616022085, 50.69360977726998, 38.40326794254729, 47.903099263663805, 51.507224464381736, 45.80953957242752, 42.79675695926555, 35.23721928826338, 52.71364998849263, 49.21979787952573, 47.656296871446294, 57.066299290114955, 46.31670546842499, 49.38022333705747, 50.01131732020681, 48.55746666783177, 35.47154189861008, 50.38608263532894, 53.685737605223665, 42.914824608539796, 45.89969520178845, 37.40339496873031, 47.38469092372292, 54.41335296010629, 47.09789727941595, 52.82433959248122, 46.9606306699219, 51.923745011603906, 50.937421776089515, 49.10789717035014, 33.88073466358054, 48.52294261042137, 50.70745894822606, 42.04421769083073, 48.78702407646271, 39.22735011608158, 48.029970348731425, 51.51987682489117, 45.03163809110167, 50.50743677404045, 48.332722084493874, 50.28555793988273, 41.94605374697255, 47.947673741462985, 40.348152179496175, 47.635034268350076, 47.41342742114043, 43.84609252705369, 48.77121624821204, 36.03299101213782, 46.46141114493963, 54.09224313655303, 44.67194546107988, 52.39017516554307, 49.11651569540117, 47.708549763991584, 48.07800990421095, 49.399388038338785, 38.644805370521055, 45.765998796591774, 49.56269284076069], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7789315306434195, "mean_inference_ms": 8.05230397283088, "mean_action_processing_ms": 0.565623158106806, "mean_env_wait_ms": 24.417926663713033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05003070831298828, "StateBufferConnector_ms": 0.041332244873046875, "ViewRequirementAgentConnector_ms": 1.0987722873687744}}, "episode_reward_max": 57.066299290114955, "episode_reward_min": 33.88073466358054, "episode_reward_mean": 47.57276353479651, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [51.86406301198127, 51.711522197212645, 45.41991122780786, 44.979113239127145, 37.00489162050046, 48.50554143504311, 51.30798669763482, 49.572990731364634, 56.524426628795005, 47.19299623514923, 53.20323201383845, 50.69035932549047, 51.62295572574868, 37.91346411968093, 51.152726805412186, 53.91485422099648, 45.358074985545585, 50.98988284158422, 41.852335442688855, 45.78497439869221, 51.071440137097305, 44.291584722715164, 50.40213300436493, 48.104936411202445, 49.6383533224133, 49.76594127518956, 55.069857375990566, 37.68442479702842, 47.512177959578835, 52.52765611158626, 47.84460135774572, 50.57210412100564, 39.18912499872814, 46.85267977124039, 52.907304443193745, 49.37318329877669, 52.223627254286825, 47.85994336601419, 52.14442766264249, 49.28151616022085, 50.69360977726998, 38.40326794254729, 47.903099263663805, 51.507224464381736, 45.80953957242752, 42.79675695926555, 35.23721928826338, 52.71364998849263, 49.21979787952573, 47.656296871446294, 57.066299290114955, 46.31670546842499, 49.38022333705747, 50.01131732020681, 48.55746666783177, 35.47154189861008, 50.38608263532894, 53.685737605223665, 42.914824608539796, 45.89969520178845, 37.40339496873031, 47.38469092372292, 54.41335296010629, 47.09789727941595, 52.82433959248122, 46.9606306699219, 51.923745011603906, 50.937421776089515, 49.10789717035014, 33.88073466358054, 48.52294261042137, 50.70745894822606, 42.04421769083073, 48.78702407646271, 39.22735011608158, 48.029970348731425, 51.51987682489117, 45.03163809110167, 50.50743677404045, 48.332722084493874, 50.28555793988273, 41.94605374697255, 47.947673741462985, 40.348152179496175, 47.635034268350076, 47.41342742114043, 43.84609252705369, 48.77121624821204, 36.03299101213782, 46.46141114493963, 54.09224313655303, 44.67194546107988, 52.39017516554307, 49.11651569540117, 47.708549763991584, 48.07800990421095, 49.399388038338785, 38.644805370521055, 45.765998796591774, 49.56269284076069], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7789315306434195, "mean_inference_ms": 8.05230397283088, "mean_action_processing_ms": 0.565623158106806, "mean_env_wait_ms": 24.417926663713033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05003070831298828, "StateBufferConnector_ms": 0.041332244873046875, "ViewRequirementAgentConnector_ms": 1.0987722873687744}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2424160, "num_agent_steps_trained": 2424160, "num_env_steps_sampled": 2424160, "num_env_steps_trained": 2424160, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 203.27310824735548, "num_env_steps_trained_throughput_per_sec": 203.27310824735548, "timesteps_total": 2424160, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2424160, "timers": {"training_iteration_time_ms": 72683.808, "sample_time_ms": 46099.811, "load_time_ms": 2909.222, "load_throughput": 5375.32, "learn_time_ms": 23015.653, "learn_throughput": 679.451, "synch_weights_time_ms": 503.458}, "counters": {"num_env_steps_sampled": 2424160, "num_env_steps_trained": 2424160, "num_agent_steps_sampled": 2424160, "num_agent_steps_trained": 2424160}, "done": false, "episodes_total": 2284, "training_iteration": 163, "trial_id": "837cb_00000", "date": "2025-06-07_20-29-43", "timestamp": 1749320983, "time_this_iter_s": 76.94950652122498, "time_total_s": 11028.172289848328, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 11028.172289848328, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 69.86516853932584, "ram_util_percent": 88.46404494382021, "gpu_util_percent0": 0.190561797752809, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.57584e-05, "total_loss": -0.0611477630532516, "policy_loss": -0.016687071140411056, "vf_loss": 0.012960099765014919, "vf_explained_var": 0.966142210635272, "kl": 0.021084823634229158, "entropy": 17.343115357485683, "entropy_coeff": 0.00286376}, "model": {}, "num_grad_updates_lifetime": 85565.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2439798, "num_env_steps_trained": 2439798, "num_agent_steps_sampled": 2439798, "num_agent_steps_trained": 2439798}, "sampler_results": {"episode_reward_max": 57.066299290114955, "episode_reward_min": 33.88073466358054, "episode_reward_mean": 47.35671081168685, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.152726805412186, 53.91485422099648, 45.358074985545585, 50.98988284158422, 41.852335442688855, 45.78497439869221, 51.071440137097305, 44.291584722715164, 50.40213300436493, 48.104936411202445, 49.6383533224133, 49.76594127518956, 55.069857375990566, 37.68442479702842, 47.512177959578835, 52.52765611158626, 47.84460135774572, 50.57210412100564, 39.18912499872814, 46.85267977124039, 52.907304443193745, 49.37318329877669, 52.223627254286825, 47.85994336601419, 52.14442766264249, 49.28151616022085, 50.69360977726998, 38.40326794254729, 47.903099263663805, 51.507224464381736, 45.80953957242752, 42.79675695926555, 35.23721928826338, 52.71364998849263, 49.21979787952573, 47.656296871446294, 57.066299290114955, 46.31670546842499, 49.38022333705747, 50.01131732020681, 48.55746666783177, 35.47154189861008, 50.38608263532894, 53.685737605223665, 42.914824608539796, 45.89969520178845, 37.40339496873031, 47.38469092372292, 54.41335296010629, 47.09789727941595, 52.82433959248122, 46.9606306699219, 51.923745011603906, 50.937421776089515, 49.10789717035014, 33.88073466358054, 48.52294261042137, 50.70745894822606, 42.04421769083073, 48.78702407646271, 39.22735011608158, 48.029970348731425, 51.51987682489117, 45.03163809110167, 50.50743677404045, 48.332722084493874, 50.28555793988273, 41.94605374697255, 47.947673741462985, 40.348152179496175, 47.635034268350076, 47.41342742114043, 43.84609252705369, 48.77121624821204, 36.03299101213782, 46.46141114493963, 54.09224313655303, 44.67194546107988, 52.39017516554307, 49.11651569540117, 47.708549763991584, 48.07800990421095, 49.399388038338785, 38.644805370521055, 45.765998796591774, 49.56269284076069, 46.56754267827485, 45.073648315283606, 39.357349927513376, 49.84206755082084, 50.03699769839521, 46.964594277491194, 48.518308991023034, 49.04947270142428, 53.03504245572341, 47.23356767204452, 49.30602535773801, 37.032511496835895, 45.77651097311302, 48.11454180272919], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7826141894999346, "mean_inference_ms": 8.061436592260085, "mean_action_processing_ms": 0.5662046332136103, "mean_env_wait_ms": 24.430379103916692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05095076560974121, "StateBufferConnector_ms": 0.04131889343261719, "ViewRequirementAgentConnector_ms": 1.0820021629333496}}, "episode_reward_max": 57.066299290114955, "episode_reward_min": 33.88073466358054, "episode_reward_mean": 47.35671081168685, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [51.152726805412186, 53.91485422099648, 45.358074985545585, 50.98988284158422, 41.852335442688855, 45.78497439869221, 51.071440137097305, 44.291584722715164, 50.40213300436493, 48.104936411202445, 49.6383533224133, 49.76594127518956, 55.069857375990566, 37.68442479702842, 47.512177959578835, 52.52765611158626, 47.84460135774572, 50.57210412100564, 39.18912499872814, 46.85267977124039, 52.907304443193745, 49.37318329877669, 52.223627254286825, 47.85994336601419, 52.14442766264249, 49.28151616022085, 50.69360977726998, 38.40326794254729, 47.903099263663805, 51.507224464381736, 45.80953957242752, 42.79675695926555, 35.23721928826338, 52.71364998849263, 49.21979787952573, 47.656296871446294, 57.066299290114955, 46.31670546842499, 49.38022333705747, 50.01131732020681, 48.55746666783177, 35.47154189861008, 50.38608263532894, 53.685737605223665, 42.914824608539796, 45.89969520178845, 37.40339496873031, 47.38469092372292, 54.41335296010629, 47.09789727941595, 52.82433959248122, 46.9606306699219, 51.923745011603906, 50.937421776089515, 49.10789717035014, 33.88073466358054, 48.52294261042137, 50.70745894822606, 42.04421769083073, 48.78702407646271, 39.22735011608158, 48.029970348731425, 51.51987682489117, 45.03163809110167, 50.50743677404045, 48.332722084493874, 50.28555793988273, 41.94605374697255, 47.947673741462985, 40.348152179496175, 47.635034268350076, 47.41342742114043, 43.84609252705369, 48.77121624821204, 36.03299101213782, 46.46141114493963, 54.09224313655303, 44.67194546107988, 52.39017516554307, 49.11651569540117, 47.708549763991584, 48.07800990421095, 49.399388038338785, 38.644805370521055, 45.765998796591774, 49.56269284076069, 46.56754267827485, 45.073648315283606, 39.357349927513376, 49.84206755082084, 50.03699769839521, 46.964594277491194, 48.518308991023034, 49.04947270142428, 53.03504245572341, 47.23356767204452, 49.30602535773801, 37.032511496835895, 45.77651097311302, 48.11454180272919], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7826141894999346, "mean_inference_ms": 8.061436592260085, "mean_action_processing_ms": 0.5662046332136103, "mean_env_wait_ms": 24.430379103916692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05095076560974121, "StateBufferConnector_ms": 0.04131889343261719, "ViewRequirementAgentConnector_ms": 1.0820021629333496}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2439798, "num_agent_steps_trained": 2439798, "num_env_steps_sampled": 2439798, "num_env_steps_trained": 2439798, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 219.53898338601272, "num_env_steps_trained_throughput_per_sec": 219.53898338601272, "timesteps_total": 2439798, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2439798, "timers": {"training_iteration_time_ms": 72913.194, "sample_time_ms": 46318.158, "load_time_ms": 2903.854, "load_throughput": 5385.256, "learn_time_ms": 23033.734, "learn_throughput": 678.917, "synch_weights_time_ms": 504.284}, "counters": {"num_env_steps_sampled": 2439798, "num_env_steps_trained": 2439798, "num_agent_steps_sampled": 2439798, "num_agent_steps_trained": 2439798}, "done": false, "episodes_total": 2298, "training_iteration": 164, "trial_id": "837cb_00000", "date": "2025-06-07_20-30-55", "timestamp": 1749321055, "time_this_iter_s": 71.25109076499939, "time_total_s": 11099.423380613327, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 11099.423380613327, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 69.20365853658538, "ram_util_percent": 89.36463414634146, "gpu_util_percent0": 0.20560975609756096, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.560202000000001e-05, "total_loss": -0.06489956076839007, "policy_loss": -0.021281248364936223, "vf_loss": 0.0136941348685121, "vf_explained_var": 0.9660072812167081, "kl": 0.02205903984915825, "entropy": 17.288734918074173, "entropy_coeff": 0.002840303}, "model": {}, "num_grad_updates_lifetime": 86115.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2455436, "num_env_steps_trained": 2455436, "num_agent_steps_sampled": 2455436, "num_agent_steps_trained": 2455436}, "sampler_results": {"episode_reward_max": 57.066299290114955, "episode_reward_min": 33.88073466358054, "episode_reward_mean": 47.234683675280756, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.512177959578835, 52.52765611158626, 47.84460135774572, 50.57210412100564, 39.18912499872814, 46.85267977124039, 52.907304443193745, 49.37318329877669, 52.223627254286825, 47.85994336601419, 52.14442766264249, 49.28151616022085, 50.69360977726998, 38.40326794254729, 47.903099263663805, 51.507224464381736, 45.80953957242752, 42.79675695926555, 35.23721928826338, 52.71364998849263, 49.21979787952573, 47.656296871446294, 57.066299290114955, 46.31670546842499, 49.38022333705747, 50.01131732020681, 48.55746666783177, 35.47154189861008, 50.38608263532894, 53.685737605223665, 42.914824608539796, 45.89969520178845, 37.40339496873031, 47.38469092372292, 54.41335296010629, 47.09789727941595, 52.82433959248122, 46.9606306699219, 51.923745011603906, 50.937421776089515, 49.10789717035014, 33.88073466358054, 48.52294261042137, 50.70745894822606, 42.04421769083073, 48.78702407646271, 39.22735011608158, 48.029970348731425, 51.51987682489117, 45.03163809110167, 50.50743677404045, 48.332722084493874, 50.28555793988273, 41.94605374697255, 47.947673741462985, 40.348152179496175, 47.635034268350076, 47.41342742114043, 43.84609252705369, 48.77121624821204, 36.03299101213782, 46.46141114493963, 54.09224313655303, 44.67194546107988, 52.39017516554307, 49.11651569540117, 47.708549763991584, 48.07800990421095, 49.399388038338785, 38.644805370521055, 45.765998796591774, 49.56269284076069, 46.56754267827485, 45.073648315283606, 39.357349927513376, 49.84206755082084, 50.03699769839521, 46.964594277491194, 48.518308991023034, 49.04947270142428, 53.03504245572341, 47.23356767204452, 49.30602535773801, 37.032511496835895, 45.77651097311302, 48.11454180272919, 42.92172195418723, 48.48989199772665, 38.458346480183835, 49.31686523194522, 55.548269104370675, 47.54864959869792, 49.61357571350072, 48.64633027798324, 52.956093852132355, 47.46420235833447, 47.75854808728421, 35.802556750842946, 47.46697480662983, 50.88677988649245], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7866746767958768, "mean_inference_ms": 8.070741753297051, "mean_action_processing_ms": 0.5668019229604349, "mean_env_wait_ms": 24.443573020300555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049755096435546875, "StateBufferConnector_ms": 0.04033064842224121, "ViewRequirementAgentConnector_ms": 1.1068768501281738}}, "episode_reward_max": 57.066299290114955, "episode_reward_min": 33.88073466358054, "episode_reward_mean": 47.234683675280756, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.512177959578835, 52.52765611158626, 47.84460135774572, 50.57210412100564, 39.18912499872814, 46.85267977124039, 52.907304443193745, 49.37318329877669, 52.223627254286825, 47.85994336601419, 52.14442766264249, 49.28151616022085, 50.69360977726998, 38.40326794254729, 47.903099263663805, 51.507224464381736, 45.80953957242752, 42.79675695926555, 35.23721928826338, 52.71364998849263, 49.21979787952573, 47.656296871446294, 57.066299290114955, 46.31670546842499, 49.38022333705747, 50.01131732020681, 48.55746666783177, 35.47154189861008, 50.38608263532894, 53.685737605223665, 42.914824608539796, 45.89969520178845, 37.40339496873031, 47.38469092372292, 54.41335296010629, 47.09789727941595, 52.82433959248122, 46.9606306699219, 51.923745011603906, 50.937421776089515, 49.10789717035014, 33.88073466358054, 48.52294261042137, 50.70745894822606, 42.04421769083073, 48.78702407646271, 39.22735011608158, 48.029970348731425, 51.51987682489117, 45.03163809110167, 50.50743677404045, 48.332722084493874, 50.28555793988273, 41.94605374697255, 47.947673741462985, 40.348152179496175, 47.635034268350076, 47.41342742114043, 43.84609252705369, 48.77121624821204, 36.03299101213782, 46.46141114493963, 54.09224313655303, 44.67194546107988, 52.39017516554307, 49.11651569540117, 47.708549763991584, 48.07800990421095, 49.399388038338785, 38.644805370521055, 45.765998796591774, 49.56269284076069, 46.56754267827485, 45.073648315283606, 39.357349927513376, 49.84206755082084, 50.03699769839521, 46.964594277491194, 48.518308991023034, 49.04947270142428, 53.03504245572341, 47.23356767204452, 49.30602535773801, 37.032511496835895, 45.77651097311302, 48.11454180272919, 42.92172195418723, 48.48989199772665, 38.458346480183835, 49.31686523194522, 55.548269104370675, 47.54864959869792, 49.61357571350072, 48.64633027798324, 52.956093852132355, 47.46420235833447, 47.75854808728421, 35.802556750842946, 47.46697480662983, 50.88677988649245], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7866746767958768, "mean_inference_ms": 8.070741753297051, "mean_action_processing_ms": 0.5668019229604349, "mean_env_wait_ms": 24.443573020300555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049755096435546875, "StateBufferConnector_ms": 0.04033064842224121, "ViewRequirementAgentConnector_ms": 1.1068768501281738}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2455436, "num_agent_steps_trained": 2455436, "num_env_steps_sampled": 2455436, "num_env_steps_trained": 2455436, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 219.06547568412424, "num_env_steps_trained_throughput_per_sec": 219.06547568412424, "timesteps_total": 2455436, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2455436, "timers": {"training_iteration_time_ms": 73153.927, "sample_time_ms": 46536.696, "load_time_ms": 2929.786, "load_throughput": 5337.59, "learn_time_ms": 23031.675, "learn_throughput": 678.978, "synch_weights_time_ms": 501.399}, "counters": {"num_env_steps_sampled": 2455436, "num_env_steps_trained": 2455436, "num_agent_steps_sampled": 2455436, "num_agent_steps_trained": 2455436}, "done": false, "episodes_total": 2312, "training_iteration": 165, "trial_id": "837cb_00000", "date": "2025-06-07_20-32-06", "timestamp": 1749321126, "time_this_iter_s": 71.41205263137817, "time_total_s": 11170.835433244705, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 11170.835433244705, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 68.79756097560974, "ram_util_percent": 88.87195121951221, "gpu_util_percent0": 0.208780487804878, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.544564000000001e-05, "total_loss": -0.0675331765784755, "policy_loss": -0.023993828254037494, "vf_loss": 0.012678468219343235, "vf_explained_var": 0.9645082191987471, "kl": 0.0211643305090763, "entropy": 17.276649762933904, "entropy_coeff": 0.0028168460000000005}, "model": {}, "num_grad_updates_lifetime": 86665.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2471074, "num_env_steps_trained": 2471074, "num_agent_steps_sampled": 2471074, "num_agent_steps_trained": 2471074}, "sampler_results": {"episode_reward_max": 57.066299290114955, "episode_reward_min": 33.88073466358054, "episode_reward_mean": 47.15642621344314, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.903099263663805, 51.507224464381736, 45.80953957242752, 42.79675695926555, 35.23721928826338, 52.71364998849263, 49.21979787952573, 47.656296871446294, 57.066299290114955, 46.31670546842499, 49.38022333705747, 50.01131732020681, 48.55746666783177, 35.47154189861008, 50.38608263532894, 53.685737605223665, 42.914824608539796, 45.89969520178845, 37.40339496873031, 47.38469092372292, 54.41335296010629, 47.09789727941595, 52.82433959248122, 46.9606306699219, 51.923745011603906, 50.937421776089515, 49.10789717035014, 33.88073466358054, 48.52294261042137, 50.70745894822606, 42.04421769083073, 48.78702407646271, 39.22735011608158, 48.029970348731425, 51.51987682489117, 45.03163809110167, 50.50743677404045, 48.332722084493874, 50.28555793988273, 41.94605374697255, 47.947673741462985, 40.348152179496175, 47.635034268350076, 47.41342742114043, 43.84609252705369, 48.77121624821204, 36.03299101213782, 46.46141114493963, 54.09224313655303, 44.67194546107988, 52.39017516554307, 49.11651569540117, 47.708549763991584, 48.07800990421095, 49.399388038338785, 38.644805370521055, 45.765998796591774, 49.56269284076069, 46.56754267827485, 45.073648315283606, 39.357349927513376, 49.84206755082084, 50.03699769839521, 46.964594277491194, 48.518308991023034, 49.04947270142428, 53.03504245572341, 47.23356767204452, 49.30602535773801, 37.032511496835895, 45.77651097311302, 48.11454180272919, 42.92172195418723, 48.48989199772665, 38.458346480183835, 49.31686523194522, 55.548269104370675, 47.54864959869792, 49.61357571350072, 48.64633027798324, 52.956093852132355, 47.46420235833447, 47.75854808728421, 35.802556750842946, 47.46697480662983, 50.88677988649245, 45.9851713491113, 48.88643521501997, 40.20758083723727, 48.97152412411354, 55.623192895513895, 47.421689090515606, 50.10318444011932, 44.16178167225885, 50.52738706356463, 48.19407859577184, 48.36367351948276, 41.641491383940526, 49.30120688390971, 50.17108097051484], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7907562782925983, "mean_inference_ms": 8.079981394690446, "mean_action_processing_ms": 0.567383315308559, "mean_env_wait_ms": 24.457066711692775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044678688049316406, "StateBufferConnector_ms": 0.04231691360473633, "ViewRequirementAgentConnector_ms": 1.1293056011199951}}, "episode_reward_max": 57.066299290114955, "episode_reward_min": 33.88073466358054, "episode_reward_mean": 47.15642621344314, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.903099263663805, 51.507224464381736, 45.80953957242752, 42.79675695926555, 35.23721928826338, 52.71364998849263, 49.21979787952573, 47.656296871446294, 57.066299290114955, 46.31670546842499, 49.38022333705747, 50.01131732020681, 48.55746666783177, 35.47154189861008, 50.38608263532894, 53.685737605223665, 42.914824608539796, 45.89969520178845, 37.40339496873031, 47.38469092372292, 54.41335296010629, 47.09789727941595, 52.82433959248122, 46.9606306699219, 51.923745011603906, 50.937421776089515, 49.10789717035014, 33.88073466358054, 48.52294261042137, 50.70745894822606, 42.04421769083073, 48.78702407646271, 39.22735011608158, 48.029970348731425, 51.51987682489117, 45.03163809110167, 50.50743677404045, 48.332722084493874, 50.28555793988273, 41.94605374697255, 47.947673741462985, 40.348152179496175, 47.635034268350076, 47.41342742114043, 43.84609252705369, 48.77121624821204, 36.03299101213782, 46.46141114493963, 54.09224313655303, 44.67194546107988, 52.39017516554307, 49.11651569540117, 47.708549763991584, 48.07800990421095, 49.399388038338785, 38.644805370521055, 45.765998796591774, 49.56269284076069, 46.56754267827485, 45.073648315283606, 39.357349927513376, 49.84206755082084, 50.03699769839521, 46.964594277491194, 48.518308991023034, 49.04947270142428, 53.03504245572341, 47.23356767204452, 49.30602535773801, 37.032511496835895, 45.77651097311302, 48.11454180272919, 42.92172195418723, 48.48989199772665, 38.458346480183835, 49.31686523194522, 55.548269104370675, 47.54864959869792, 49.61357571350072, 48.64633027798324, 52.956093852132355, 47.46420235833447, 47.75854808728421, 35.802556750842946, 47.46697480662983, 50.88677988649245, 45.9851713491113, 48.88643521501997, 40.20758083723727, 48.97152412411354, 55.623192895513895, 47.421689090515606, 50.10318444011932, 44.16178167225885, 50.52738706356463, 48.19407859577184, 48.36367351948276, 41.641491383940526, 49.30120688390971, 50.17108097051484], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7907562782925983, "mean_inference_ms": 8.079981394690446, "mean_action_processing_ms": 0.567383315308559, "mean_env_wait_ms": 24.457066711692775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044678688049316406, "StateBufferConnector_ms": 0.04231691360473633, "ViewRequirementAgentConnector_ms": 1.1293056011199951}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2471074, "num_agent_steps_trained": 2471074, "num_env_steps_sampled": 2471074, "num_env_steps_trained": 2471074, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 214.7589318952762, "num_env_steps_trained_throughput_per_sec": 214.7589318952762, "timesteps_total": 2471074, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2471074, "timers": {"training_iteration_time_ms": 72933.284, "sample_time_ms": 46357.804, "load_time_ms": 2837.974, "load_throughput": 5510.269, "learn_time_ms": 23076.874, "learn_throughput": 677.648, "synch_weights_time_ms": 507.701}, "counters": {"num_env_steps_sampled": 2471074, "num_env_steps_trained": 2471074, "num_agent_steps_sampled": 2471074, "num_agent_steps_trained": 2471074}, "done": false, "episodes_total": 2326, "training_iteration": 166, "trial_id": "837cb_00000", "date": "2025-06-07_20-33-19", "timestamp": 1749321199, "time_this_iter_s": 72.84954357147217, "time_total_s": 11243.684976816177, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 11243.684976816177, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 68.85714285714286, "ram_util_percent": 89.43571428571428, "gpu_util_percent0": 0.20476190476190478, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.528926000000001e-05, "total_loss": -0.06078284791014581, "policy_loss": -0.01758369928289374, "vf_loss": 0.012569894186983054, "vf_explained_var": 0.9651090956817974, "kl": 0.021475974453131288, "entropy": 17.295251962488347, "entropy_coeff": 0.002793389}, "model": {}, "num_grad_updates_lifetime": 87215.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2486712, "num_env_steps_trained": 2486712, "num_agent_steps_sampled": 2486712, "num_agent_steps_trained": 2486712}, "sampler_results": {"episode_reward_max": 55.623192895513895, "episode_reward_min": 33.88073466358054, "episode_reward_mean": 47.12836456816736, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.38608263532894, 53.685737605223665, 42.914824608539796, 45.89969520178845, 37.40339496873031, 47.38469092372292, 54.41335296010629, 47.09789727941595, 52.82433959248122, 46.9606306699219, 51.923745011603906, 50.937421776089515, 49.10789717035014, 33.88073466358054, 48.52294261042137, 50.70745894822606, 42.04421769083073, 48.78702407646271, 39.22735011608158, 48.029970348731425, 51.51987682489117, 45.03163809110167, 50.50743677404045, 48.332722084493874, 50.28555793988273, 41.94605374697255, 47.947673741462985, 40.348152179496175, 47.635034268350076, 47.41342742114043, 43.84609252705369, 48.77121624821204, 36.03299101213782, 46.46141114493963, 54.09224313655303, 44.67194546107988, 52.39017516554307, 49.11651569540117, 47.708549763991584, 48.07800990421095, 49.399388038338785, 38.644805370521055, 45.765998796591774, 49.56269284076069, 46.56754267827485, 45.073648315283606, 39.357349927513376, 49.84206755082084, 50.03699769839521, 46.964594277491194, 48.518308991023034, 49.04947270142428, 53.03504245572341, 47.23356767204452, 49.30602535773801, 37.032511496835895, 45.77651097311302, 48.11454180272919, 42.92172195418723, 48.48989199772665, 38.458346480183835, 49.31686523194522, 55.548269104370675, 47.54864959869792, 49.61357571350072, 48.64633027798324, 52.956093852132355, 47.46420235833447, 47.75854808728421, 35.802556750842946, 47.46697480662983, 50.88677988649245, 45.9851713491113, 48.88643521501997, 40.20758083723727, 48.97152412411354, 55.623192895513895, 47.421689090515606, 50.10318444011932, 44.16178167225885, 50.52738706356463, 48.19407859577184, 48.36367351948276, 41.641491383940526, 49.30120688390971, 50.17108097051484, 48.14357256957924, 47.425176010170844, 40.11205121599752, 46.45348881746352, 54.86051156628607, 47.575106326263125, 51.65442495479791, 48.177035438791805, 49.45400417241964, 45.88667486309467, 49.15908595157558, 37.08477227306219, 44.35094977208963, 46.50411981054302], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7945540733383485, "mean_inference_ms": 8.088288680213564, "mean_action_processing_ms": 0.5679134554107702, "mean_env_wait_ms": 24.4692065821502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0426485538482666, "StateBufferConnector_ms": 0.045487403869628906, "ViewRequirementAgentConnector_ms": 1.1327593326568604}}, "episode_reward_max": 55.623192895513895, "episode_reward_min": 33.88073466358054, "episode_reward_mean": 47.12836456816736, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.38608263532894, 53.685737605223665, 42.914824608539796, 45.89969520178845, 37.40339496873031, 47.38469092372292, 54.41335296010629, 47.09789727941595, 52.82433959248122, 46.9606306699219, 51.923745011603906, 50.937421776089515, 49.10789717035014, 33.88073466358054, 48.52294261042137, 50.70745894822606, 42.04421769083073, 48.78702407646271, 39.22735011608158, 48.029970348731425, 51.51987682489117, 45.03163809110167, 50.50743677404045, 48.332722084493874, 50.28555793988273, 41.94605374697255, 47.947673741462985, 40.348152179496175, 47.635034268350076, 47.41342742114043, 43.84609252705369, 48.77121624821204, 36.03299101213782, 46.46141114493963, 54.09224313655303, 44.67194546107988, 52.39017516554307, 49.11651569540117, 47.708549763991584, 48.07800990421095, 49.399388038338785, 38.644805370521055, 45.765998796591774, 49.56269284076069, 46.56754267827485, 45.073648315283606, 39.357349927513376, 49.84206755082084, 50.03699769839521, 46.964594277491194, 48.518308991023034, 49.04947270142428, 53.03504245572341, 47.23356767204452, 49.30602535773801, 37.032511496835895, 45.77651097311302, 48.11454180272919, 42.92172195418723, 48.48989199772665, 38.458346480183835, 49.31686523194522, 55.548269104370675, 47.54864959869792, 49.61357571350072, 48.64633027798324, 52.956093852132355, 47.46420235833447, 47.75854808728421, 35.802556750842946, 47.46697480662983, 50.88677988649245, 45.9851713491113, 48.88643521501997, 40.20758083723727, 48.97152412411354, 55.623192895513895, 47.421689090515606, 50.10318444011932, 44.16178167225885, 50.52738706356463, 48.19407859577184, 48.36367351948276, 41.641491383940526, 49.30120688390971, 50.17108097051484, 48.14357256957924, 47.425176010170844, 40.11205121599752, 46.45348881746352, 54.86051156628607, 47.575106326263125, 51.65442495479791, 48.177035438791805, 49.45400417241964, 45.88667486309467, 49.15908595157558, 37.08477227306219, 44.35094977208963, 46.50411981054302], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7945540733383485, "mean_inference_ms": 8.088288680213564, "mean_action_processing_ms": 0.5679134554107702, "mean_env_wait_ms": 24.4692065821502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0426485538482666, "StateBufferConnector_ms": 0.045487403869628906, "ViewRequirementAgentConnector_ms": 1.1327593326568604}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2486712, "num_agent_steps_trained": 2486712, "num_env_steps_sampled": 2486712, "num_env_steps_trained": 2486712, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 215.89077437655308, "num_env_steps_trained_throughput_per_sec": 215.89077437655308, "timesteps_total": 2486712, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2486712, "timers": {"training_iteration_time_ms": 73243.175, "sample_time_ms": 46618.81, "load_time_ms": 2849.501, "load_throughput": 5487.978, "learn_time_ms": 23112.755, "learn_throughput": 676.596, "synch_weights_time_ms": 507.838}, "counters": {"num_env_steps_sampled": 2486712, "num_env_steps_trained": 2486712, "num_agent_steps_sampled": 2486712, "num_agent_steps_trained": 2486712}, "done": false, "episodes_total": 2340, "training_iteration": 167, "trial_id": "837cb_00000", "date": "2025-06-07_20-34-32", "timestamp": 1749321272, "time_this_iter_s": 72.4469575881958, "time_total_s": 11316.131934404373, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 11316.131934404373, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 68.83012048192772, "ram_util_percent": 90.04819277108435, "gpu_util_percent0": 0.20433734939759038, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.513288000000002e-05, "total_loss": -0.06296603547028182, "policy_loss": -0.020067527116149324, "vf_loss": 0.012691968262449584, "vf_explained_var": 0.9672172319889069, "kl": 0.021103113185651633, "entropy": 17.337987034537576, "entropy_coeff": 0.0027699319999999997}, "model": {}, "num_grad_updates_lifetime": 87765.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2502350, "num_env_steps_trained": 2502350, "num_agent_steps_sampled": 2502350, "num_agent_steps_trained": 2502350}, "sampler_results": {"episode_reward_max": 55.623192895513895, "episode_reward_min": 35.802556750842946, "episode_reward_mean": 47.015055026700686, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.52294261042137, 50.70745894822606, 42.04421769083073, 48.78702407646271, 39.22735011608158, 48.029970348731425, 51.51987682489117, 45.03163809110167, 50.50743677404045, 48.332722084493874, 50.28555793988273, 41.94605374697255, 47.947673741462985, 40.348152179496175, 47.635034268350076, 47.41342742114043, 43.84609252705369, 48.77121624821204, 36.03299101213782, 46.46141114493963, 54.09224313655303, 44.67194546107988, 52.39017516554307, 49.11651569540117, 47.708549763991584, 48.07800990421095, 49.399388038338785, 38.644805370521055, 45.765998796591774, 49.56269284076069, 46.56754267827485, 45.073648315283606, 39.357349927513376, 49.84206755082084, 50.03699769839521, 46.964594277491194, 48.518308991023034, 49.04947270142428, 53.03504245572341, 47.23356767204452, 49.30602535773801, 37.032511496835895, 45.77651097311302, 48.11454180272919, 42.92172195418723, 48.48989199772665, 38.458346480183835, 49.31686523194522, 55.548269104370675, 47.54864959869792, 49.61357571350072, 48.64633027798324, 52.956093852132355, 47.46420235833447, 47.75854808728421, 35.802556750842946, 47.46697480662983, 50.88677988649245, 45.9851713491113, 48.88643521501997, 40.20758083723727, 48.97152412411354, 55.623192895513895, 47.421689090515606, 50.10318444011932, 44.16178167225885, 50.52738706356463, 48.19407859577184, 48.36367351948276, 41.641491383940526, 49.30120688390971, 50.17108097051484, 48.14357256957924, 47.425176010170844, 40.11205121599752, 46.45348881746352, 54.86051156628607, 47.575106326263125, 51.65442495479791, 48.177035438791805, 49.45400417241964, 45.88667486309467, 49.15908595157558, 37.08477227306219, 44.35094977208963, 46.50411981054302, 45.18844443289593, 47.541493520461984, 38.37259011713651, 48.96787110957542, 50.821223811797225, 45.681074137942915, 53.46657666404538, 46.25654004367467, 47.423205458595675, 43.89638231454662, 50.69206360326908, 38.506763542692326, 48.92801854836035, 47.74724361522219], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.798094373798672, "mean_inference_ms": 8.09636375625403, "mean_action_processing_ms": 0.568426540732764, "mean_env_wait_ms": 24.48136707225561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038608551025390625, "StateBufferConnector_ms": 0.04024362564086914, "ViewRequirementAgentConnector_ms": 1.113196611404419}}, "episode_reward_max": 55.623192895513895, "episode_reward_min": 35.802556750842946, "episode_reward_mean": 47.015055026700686, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [48.52294261042137, 50.70745894822606, 42.04421769083073, 48.78702407646271, 39.22735011608158, 48.029970348731425, 51.51987682489117, 45.03163809110167, 50.50743677404045, 48.332722084493874, 50.28555793988273, 41.94605374697255, 47.947673741462985, 40.348152179496175, 47.635034268350076, 47.41342742114043, 43.84609252705369, 48.77121624821204, 36.03299101213782, 46.46141114493963, 54.09224313655303, 44.67194546107988, 52.39017516554307, 49.11651569540117, 47.708549763991584, 48.07800990421095, 49.399388038338785, 38.644805370521055, 45.765998796591774, 49.56269284076069, 46.56754267827485, 45.073648315283606, 39.357349927513376, 49.84206755082084, 50.03699769839521, 46.964594277491194, 48.518308991023034, 49.04947270142428, 53.03504245572341, 47.23356767204452, 49.30602535773801, 37.032511496835895, 45.77651097311302, 48.11454180272919, 42.92172195418723, 48.48989199772665, 38.458346480183835, 49.31686523194522, 55.548269104370675, 47.54864959869792, 49.61357571350072, 48.64633027798324, 52.956093852132355, 47.46420235833447, 47.75854808728421, 35.802556750842946, 47.46697480662983, 50.88677988649245, 45.9851713491113, 48.88643521501997, 40.20758083723727, 48.97152412411354, 55.623192895513895, 47.421689090515606, 50.10318444011932, 44.16178167225885, 50.52738706356463, 48.19407859577184, 48.36367351948276, 41.641491383940526, 49.30120688390971, 50.17108097051484, 48.14357256957924, 47.425176010170844, 40.11205121599752, 46.45348881746352, 54.86051156628607, 47.575106326263125, 51.65442495479791, 48.177035438791805, 49.45400417241964, 45.88667486309467, 49.15908595157558, 37.08477227306219, 44.35094977208963, 46.50411981054302, 45.18844443289593, 47.541493520461984, 38.37259011713651, 48.96787110957542, 50.821223811797225, 45.681074137942915, 53.46657666404538, 46.25654004367467, 47.423205458595675, 43.89638231454662, 50.69206360326908, 38.506763542692326, 48.92801854836035, 47.74724361522219], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.798094373798672, "mean_inference_ms": 8.09636375625403, "mean_action_processing_ms": 0.568426540732764, "mean_env_wait_ms": 24.48136707225561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038608551025390625, "StateBufferConnector_ms": 0.04024362564086914, "ViewRequirementAgentConnector_ms": 1.113196611404419}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2502350, "num_agent_steps_trained": 2502350, "num_env_steps_sampled": 2502350, "num_env_steps_trained": 2502350, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 213.69851476096727, "num_env_steps_trained_throughput_per_sec": 213.69851476096727, "timesteps_total": 2502350, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2502350, "timers": {"training_iteration_time_ms": 73594.582, "sample_time_ms": 46969.294, "load_time_ms": 2852.316, "load_throughput": 5482.562, "learn_time_ms": 23109.569, "learn_throughput": 676.689, "synch_weights_time_ms": 509.033}, "counters": {"num_env_steps_sampled": 2502350, "num_env_steps_trained": 2502350, "num_agent_steps_sampled": 2502350, "num_agent_steps_trained": 2502350}, "done": false, "episodes_total": 2354, "training_iteration": 168, "trial_id": "837cb_00000", "date": "2025-06-07_20-35-45", "timestamp": 1749321345, "time_this_iter_s": 73.20085906982422, "time_total_s": 11389.332793474197, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 11389.332793474197, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 69.48588235294116, "ram_util_percent": 89.8364705882353, "gpu_util_percent0": 0.2070588235294118, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.49765e-05, "total_loss": -0.05662329517879037, "policy_loss": -0.014563342566517267, "vf_loss": 0.013396032925017856, "vf_explained_var": 0.9637191424586556, "kl": 0.02195169187109158, "entropy": 17.276961239901457, "entropy_coeff": 0.0027464749999999995}, "model": {}, "num_grad_updates_lifetime": 88315.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2517988, "num_env_steps_trained": 2517988, "num_agent_steps_sampled": 2517988, "num_agent_steps_trained": 2517988}, "sampler_results": {"episode_reward_max": 55.623192895513895, "episode_reward_min": 35.802556750842946, "episode_reward_mean": 47.03495844732224, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.635034268350076, 47.41342742114043, 43.84609252705369, 48.77121624821204, 36.03299101213782, 46.46141114493963, 54.09224313655303, 44.67194546107988, 52.39017516554307, 49.11651569540117, 47.708549763991584, 48.07800990421095, 49.399388038338785, 38.644805370521055, 45.765998796591774, 49.56269284076069, 46.56754267827485, 45.073648315283606, 39.357349927513376, 49.84206755082084, 50.03699769839521, 46.964594277491194, 48.518308991023034, 49.04947270142428, 53.03504245572341, 47.23356767204452, 49.30602535773801, 37.032511496835895, 45.77651097311302, 48.11454180272919, 42.92172195418723, 48.48989199772665, 38.458346480183835, 49.31686523194522, 55.548269104370675, 47.54864959869792, 49.61357571350072, 48.64633027798324, 52.956093852132355, 47.46420235833447, 47.75854808728421, 35.802556750842946, 47.46697480662983, 50.88677988649245, 45.9851713491113, 48.88643521501997, 40.20758083723727, 48.97152412411354, 55.623192895513895, 47.421689090515606, 50.10318444011932, 44.16178167225885, 50.52738706356463, 48.19407859577184, 48.36367351948276, 41.641491383940526, 49.30120688390971, 50.17108097051484, 48.14357256957924, 47.425176010170844, 40.11205121599752, 46.45348881746352, 54.86051156628607, 47.575106326263125, 51.65442495479791, 48.177035438791805, 49.45400417241964, 45.88667486309467, 49.15908595157558, 37.08477227306219, 44.35094977208963, 46.50411981054302, 45.18844443289593, 47.541493520461984, 38.37259011713651, 48.96787110957542, 50.821223811797225, 45.681074137942915, 53.46657666404538, 46.25654004367467, 47.423205458595675, 43.89638231454662, 50.69206360326908, 38.506763542692326, 48.92801854836035, 47.74724361522219, 46.44845175011162, 48.03111018172194, 39.11318335738474, 44.78535671966068, 49.55473731875704, 46.58987556882438, 53.74512658356175, 48.7292788653113, 46.026450568691786, 50.3941684159352, 47.855790236468735, 37.13141494240368, 46.866433193734814, 49.95703953268238], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.801586930578081, "mean_inference_ms": 8.104457430394573, "mean_action_processing_ms": 0.5689415363699449, "mean_env_wait_ms": 24.49470916674284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03263974189758301, "StateBufferConnector_ms": 0.031201839447021484, "ViewRequirementAgentConnector_ms": 1.0938348770141602}}, "episode_reward_max": 55.623192895513895, "episode_reward_min": 35.802556750842946, "episode_reward_mean": 47.03495844732224, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.635034268350076, 47.41342742114043, 43.84609252705369, 48.77121624821204, 36.03299101213782, 46.46141114493963, 54.09224313655303, 44.67194546107988, 52.39017516554307, 49.11651569540117, 47.708549763991584, 48.07800990421095, 49.399388038338785, 38.644805370521055, 45.765998796591774, 49.56269284076069, 46.56754267827485, 45.073648315283606, 39.357349927513376, 49.84206755082084, 50.03699769839521, 46.964594277491194, 48.518308991023034, 49.04947270142428, 53.03504245572341, 47.23356767204452, 49.30602535773801, 37.032511496835895, 45.77651097311302, 48.11454180272919, 42.92172195418723, 48.48989199772665, 38.458346480183835, 49.31686523194522, 55.548269104370675, 47.54864959869792, 49.61357571350072, 48.64633027798324, 52.956093852132355, 47.46420235833447, 47.75854808728421, 35.802556750842946, 47.46697480662983, 50.88677988649245, 45.9851713491113, 48.88643521501997, 40.20758083723727, 48.97152412411354, 55.623192895513895, 47.421689090515606, 50.10318444011932, 44.16178167225885, 50.52738706356463, 48.19407859577184, 48.36367351948276, 41.641491383940526, 49.30120688390971, 50.17108097051484, 48.14357256957924, 47.425176010170844, 40.11205121599752, 46.45348881746352, 54.86051156628607, 47.575106326263125, 51.65442495479791, 48.177035438791805, 49.45400417241964, 45.88667486309467, 49.15908595157558, 37.08477227306219, 44.35094977208963, 46.50411981054302, 45.18844443289593, 47.541493520461984, 38.37259011713651, 48.96787110957542, 50.821223811797225, 45.681074137942915, 53.46657666404538, 46.25654004367467, 47.423205458595675, 43.89638231454662, 50.69206360326908, 38.506763542692326, 48.92801854836035, 47.74724361522219, 46.44845175011162, 48.03111018172194, 39.11318335738474, 44.78535671966068, 49.55473731875704, 46.58987556882438, 53.74512658356175, 48.7292788653113, 46.026450568691786, 50.3941684159352, 47.855790236468735, 37.13141494240368, 46.866433193734814, 49.95703953268238], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.801586930578081, "mean_inference_ms": 8.104457430394573, "mean_action_processing_ms": 0.5689415363699449, "mean_env_wait_ms": 24.49470916674284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03263974189758301, "StateBufferConnector_ms": 0.031201839447021484, "ViewRequirementAgentConnector_ms": 1.0938348770141602}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2517988, "num_agent_steps_trained": 2517988, "num_env_steps_sampled": 2517988, "num_env_steps_trained": 2517988, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 203.8127252193734, "num_env_steps_trained_throughput_per_sec": 203.8127252193734, "timesteps_total": 2517988, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2517988, "timers": {"training_iteration_time_ms": 74005.903, "sample_time_ms": 47222.771, "load_time_ms": 2948.626, "load_throughput": 5303.487, "learn_time_ms": 23157.641, "learn_throughput": 675.285, "synch_weights_time_ms": 522.297}, "counters": {"num_env_steps_sampled": 2517988, "num_env_steps_trained": 2517988, "num_agent_steps_sampled": 2517988, "num_agent_steps_trained": 2517988}, "done": false, "episodes_total": 2368, "training_iteration": 169, "trial_id": "837cb_00000", "date": "2025-06-07_20-37-02", "timestamp": 1749321422, "time_this_iter_s": 76.75231504440308, "time_total_s": 11466.0851085186, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 11466.0851085186, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 69.41724137931034, "ram_util_percent": 90.82758620689656, "gpu_util_percent0": 0.18896551724137933, "vram_util_percent0": 0.965006510416667}}
{"evaluation": {"sampler_results": {"episode_reward_max": 2.597838552615521, "episode_reward_min": 2.023143964953975, "episode_reward_mean": 2.3405891380268415, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.465971760969007, 2.023143964953975, 2.597838552615521, 2.3409195499541653, 2.2750718616415395], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8511230199738358, "mean_inference_ms": 4.0250999163380135, "mean_action_processing_ms": 0.29347552781244973, "mean_env_wait_ms": 12.408079100145981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5626583099365234}}, "episode_reward_max": 2.597838552615521, "episode_reward_min": 2.023143964953975, "episode_reward_mean": 2.3405891380268415, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.465971760969007, 2.023143964953975, 2.597838552615521, 2.3409195499541653, 2.2750718616415395], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8511230199738358, "mean_inference_ms": 4.0250999163380135, "mean_action_processing_ms": 0.29347552781244973, "mean_env_wait_ms": 12.408079100145981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5626583099365234}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.482012000000001e-05, "total_loss": -0.045869356894611635, "policy_loss": -0.004890982526597905, "vf_loss": 0.015745529859242113, "vf_explained_var": 0.9618433636968786, "kl": 0.021840359984575022, "entropy": 17.28488551226529, "entropy_coeff": 0.0027230180000000002}, "model": {}, "num_grad_updates_lifetime": 88865.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2533626, "num_env_steps_trained": 2533626, "num_agent_steps_sampled": 2533626, "num_agent_steps_trained": 2533626}, "sampler_results": {"episode_reward_max": 55.623192895513895, "episode_reward_min": 35.802556750842946, "episode_reward_mean": 46.8656211727781, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.765998796591774, 49.56269284076069, 46.56754267827485, 45.073648315283606, 39.357349927513376, 49.84206755082084, 50.03699769839521, 46.964594277491194, 48.518308991023034, 49.04947270142428, 53.03504245572341, 47.23356767204452, 49.30602535773801, 37.032511496835895, 45.77651097311302, 48.11454180272919, 42.92172195418723, 48.48989199772665, 38.458346480183835, 49.31686523194522, 55.548269104370675, 47.54864959869792, 49.61357571350072, 48.64633027798324, 52.956093852132355, 47.46420235833447, 47.75854808728421, 35.802556750842946, 47.46697480662983, 50.88677988649245, 45.9851713491113, 48.88643521501997, 40.20758083723727, 48.97152412411354, 55.623192895513895, 47.421689090515606, 50.10318444011932, 44.16178167225885, 50.52738706356463, 48.19407859577184, 48.36367351948276, 41.641491383940526, 49.30120688390971, 50.17108097051484, 48.14357256957924, 47.425176010170844, 40.11205121599752, 46.45348881746352, 54.86051156628607, 47.575106326263125, 51.65442495479791, 48.177035438791805, 49.45400417241964, 45.88667486309467, 49.15908595157558, 37.08477227306219, 44.35094977208963, 46.50411981054302, 45.18844443289593, 47.541493520461984, 38.37259011713651, 48.96787110957542, 50.821223811797225, 45.681074137942915, 53.46657666404538, 46.25654004367467, 47.423205458595675, 43.89638231454662, 50.69206360326908, 38.506763542692326, 48.92801854836035, 47.74724361522219, 46.44845175011162, 48.03111018172194, 39.11318335738474, 44.78535671966068, 49.55473731875704, 46.58987556882438, 53.74512658356175, 48.7292788653113, 46.026450568691786, 50.3941684159352, 47.855790236468735, 37.13141494240368, 46.866433193734814, 49.95703953268238, 46.842692296722966, 48.23221173382962, 37.09258887026915, 36.233278096552596, 50.22189469626773, 47.66782473865481, 47.749678622034615, 47.45270146738962, 49.95936388872152, 38.63554698233415, 50.060282311400016, 37.130261056932305, 49.81309073843659, 50.236662203514385], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8049455927885476, "mean_inference_ms": 8.111768572067877, "mean_action_processing_ms": 0.5694166036177617, "mean_env_wait_ms": 24.506451647235913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03241109848022461, "StateBufferConnector_ms": 0.033307790756225586, "ViewRequirementAgentConnector_ms": 1.0869107246398926}}, "episode_reward_max": 55.623192895513895, "episode_reward_min": 35.802556750842946, "episode_reward_mean": 46.8656211727781, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.765998796591774, 49.56269284076069, 46.56754267827485, 45.073648315283606, 39.357349927513376, 49.84206755082084, 50.03699769839521, 46.964594277491194, 48.518308991023034, 49.04947270142428, 53.03504245572341, 47.23356767204452, 49.30602535773801, 37.032511496835895, 45.77651097311302, 48.11454180272919, 42.92172195418723, 48.48989199772665, 38.458346480183835, 49.31686523194522, 55.548269104370675, 47.54864959869792, 49.61357571350072, 48.64633027798324, 52.956093852132355, 47.46420235833447, 47.75854808728421, 35.802556750842946, 47.46697480662983, 50.88677988649245, 45.9851713491113, 48.88643521501997, 40.20758083723727, 48.97152412411354, 55.623192895513895, 47.421689090515606, 50.10318444011932, 44.16178167225885, 50.52738706356463, 48.19407859577184, 48.36367351948276, 41.641491383940526, 49.30120688390971, 50.17108097051484, 48.14357256957924, 47.425176010170844, 40.11205121599752, 46.45348881746352, 54.86051156628607, 47.575106326263125, 51.65442495479791, 48.177035438791805, 49.45400417241964, 45.88667486309467, 49.15908595157558, 37.08477227306219, 44.35094977208963, 46.50411981054302, 45.18844443289593, 47.541493520461984, 38.37259011713651, 48.96787110957542, 50.821223811797225, 45.681074137942915, 53.46657666404538, 46.25654004367467, 47.423205458595675, 43.89638231454662, 50.69206360326908, 38.506763542692326, 48.92801854836035, 47.74724361522219, 46.44845175011162, 48.03111018172194, 39.11318335738474, 44.78535671966068, 49.55473731875704, 46.58987556882438, 53.74512658356175, 48.7292788653113, 46.026450568691786, 50.3941684159352, 47.855790236468735, 37.13141494240368, 46.866433193734814, 49.95703953268238, 46.842692296722966, 48.23221173382962, 37.09258887026915, 36.233278096552596, 50.22189469626773, 47.66782473865481, 47.749678622034615, 47.45270146738962, 49.95936388872152, 38.63554698233415, 50.060282311400016, 37.130261056932305, 49.81309073843659, 50.236662203514385], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8049455927885476, "mean_inference_ms": 8.111768572067877, "mean_action_processing_ms": 0.5694166036177617, "mean_env_wait_ms": 24.506451647235913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03241109848022461, "StateBufferConnector_ms": 0.033307790756225586, "ViewRequirementAgentConnector_ms": 1.0869107246398926}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2533626, "num_agent_steps_trained": 2533626, "num_env_steps_sampled": 2533626, "num_env_steps_trained": 2533626, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 209.71960011515526, "num_env_steps_trained_throughput_per_sec": 209.71960011515526, "timesteps_total": 2533626, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2533626, "timers": {"training_iteration_time_ms": 73716.448, "sample_time_ms": 46819.919, "load_time_ms": 3022.523, "load_throughput": 5173.823, "learn_time_ms": 23196.478, "learn_throughput": 674.154, "synch_weights_time_ms": 523.489}, "counters": {"num_env_steps_sampled": 2533626, "num_env_steps_trained": 2533626, "num_agent_steps_sampled": 2533626, "num_agent_steps_trained": 2533626}, "done": false, "episodes_total": 2382, "training_iteration": 170, "trial_id": "837cb_00000", "date": "2025-06-07_20-38-36", "timestamp": 1749321516, "time_this_iter_s": 94.08156204223633, "time_total_s": 11560.166670560837, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 11560.166670560837, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 59.46944444444444, "ram_util_percent": 88.86666666666666, "gpu_util_percent0": 0.1582407407407407, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.466374e-05, "total_loss": -0.05332037248479372, "policy_loss": -0.011792470140551979, "vf_loss": 0.012586588923904029, "vf_explained_var": 0.967096612778577, "kl": 0.021848010359945793, "entropy": 17.28776648608121, "entropy_coeff": 0.002699561}, "model": {}, "num_grad_updates_lifetime": 89415.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2549264, "num_env_steps_trained": 2549264, "num_agent_steps_sampled": 2549264, "num_agent_steps_trained": 2549264}, "sampler_results": {"episode_reward_max": 55.623192895513895, "episode_reward_min": 35.802556750842946, "episode_reward_mean": 46.7474846378212, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.77651097311302, 48.11454180272919, 42.92172195418723, 48.48989199772665, 38.458346480183835, 49.31686523194522, 55.548269104370675, 47.54864959869792, 49.61357571350072, 48.64633027798324, 52.956093852132355, 47.46420235833447, 47.75854808728421, 35.802556750842946, 47.46697480662983, 50.88677988649245, 45.9851713491113, 48.88643521501997, 40.20758083723727, 48.97152412411354, 55.623192895513895, 47.421689090515606, 50.10318444011932, 44.16178167225885, 50.52738706356463, 48.19407859577184, 48.36367351948276, 41.641491383940526, 49.30120688390971, 50.17108097051484, 48.14357256957924, 47.425176010170844, 40.11205121599752, 46.45348881746352, 54.86051156628607, 47.575106326263125, 51.65442495479791, 48.177035438791805, 49.45400417241964, 45.88667486309467, 49.15908595157558, 37.08477227306219, 44.35094977208963, 46.50411981054302, 45.18844443289593, 47.541493520461984, 38.37259011713651, 48.96787110957542, 50.821223811797225, 45.681074137942915, 53.46657666404538, 46.25654004367467, 47.423205458595675, 43.89638231454662, 50.69206360326908, 38.506763542692326, 48.92801854836035, 47.74724361522219, 46.44845175011162, 48.03111018172194, 39.11318335738474, 44.78535671966068, 49.55473731875704, 46.58987556882438, 53.74512658356175, 48.7292788653113, 46.026450568691786, 50.3941684159352, 47.855790236468735, 37.13141494240368, 46.866433193734814, 49.95703953268238, 46.842692296722966, 48.23221173382962, 37.09258887026915, 36.233278096552596, 50.22189469626773, 47.66782473865481, 47.749678622034615, 47.45270146738962, 49.95936388872152, 38.63554698233415, 50.060282311400016, 37.130261056932305, 49.81309073843659, 50.236662203514385, 41.92666810591069, 45.22624766751314, 39.22658543103773, 46.209282284476664, 52.11959440308175, 47.2848653016677, 47.656482940951776, 46.17533394147372, 50.48068275450344, 44.31059239307548, 47.17970042181268, 37.814723775753265, 51.364250083324855, 48.55715775964809], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.808434471476821, "mean_inference_ms": 8.118997018832625, "mean_action_processing_ms": 0.5698807532500862, "mean_env_wait_ms": 24.518001091303436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037425994873046875, "StateBufferConnector_ms": 0.034279584884643555, "ViewRequirementAgentConnector_ms": 1.0770585536956787}}, "episode_reward_max": 55.623192895513895, "episode_reward_min": 35.802556750842946, "episode_reward_mean": 46.7474846378212, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.77651097311302, 48.11454180272919, 42.92172195418723, 48.48989199772665, 38.458346480183835, 49.31686523194522, 55.548269104370675, 47.54864959869792, 49.61357571350072, 48.64633027798324, 52.956093852132355, 47.46420235833447, 47.75854808728421, 35.802556750842946, 47.46697480662983, 50.88677988649245, 45.9851713491113, 48.88643521501997, 40.20758083723727, 48.97152412411354, 55.623192895513895, 47.421689090515606, 50.10318444011932, 44.16178167225885, 50.52738706356463, 48.19407859577184, 48.36367351948276, 41.641491383940526, 49.30120688390971, 50.17108097051484, 48.14357256957924, 47.425176010170844, 40.11205121599752, 46.45348881746352, 54.86051156628607, 47.575106326263125, 51.65442495479791, 48.177035438791805, 49.45400417241964, 45.88667486309467, 49.15908595157558, 37.08477227306219, 44.35094977208963, 46.50411981054302, 45.18844443289593, 47.541493520461984, 38.37259011713651, 48.96787110957542, 50.821223811797225, 45.681074137942915, 53.46657666404538, 46.25654004367467, 47.423205458595675, 43.89638231454662, 50.69206360326908, 38.506763542692326, 48.92801854836035, 47.74724361522219, 46.44845175011162, 48.03111018172194, 39.11318335738474, 44.78535671966068, 49.55473731875704, 46.58987556882438, 53.74512658356175, 48.7292788653113, 46.026450568691786, 50.3941684159352, 47.855790236468735, 37.13141494240368, 46.866433193734814, 49.95703953268238, 46.842692296722966, 48.23221173382962, 37.09258887026915, 36.233278096552596, 50.22189469626773, 47.66782473865481, 47.749678622034615, 47.45270146738962, 49.95936388872152, 38.63554698233415, 50.060282311400016, 37.130261056932305, 49.81309073843659, 50.236662203514385, 41.92666810591069, 45.22624766751314, 39.22658543103773, 46.209282284476664, 52.11959440308175, 47.2848653016677, 47.656482940951776, 46.17533394147372, 50.48068275450344, 44.31059239307548, 47.17970042181268, 37.814723775753265, 51.364250083324855, 48.55715775964809], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.808434471476821, "mean_inference_ms": 8.118997018832625, "mean_action_processing_ms": 0.5698807532500862, "mean_env_wait_ms": 24.518001091303436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037425994873046875, "StateBufferConnector_ms": 0.034279584884643555, "ViewRequirementAgentConnector_ms": 1.0770585536956787}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2549264, "num_agent_steps_trained": 2549264, "num_env_steps_sampled": 2549264, "num_env_steps_trained": 2549264, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 212.05051717296854, "num_env_steps_trained_throughput_per_sec": 212.05051717296854, "timesteps_total": 2549264, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2549264, "timers": {"training_iteration_time_ms": 73727.063, "sample_time_ms": 46824.081, "load_time_ms": 2952.004, "load_throughput": 5297.418, "learn_time_ms": 23273.446, "learn_throughput": 671.925, "synch_weights_time_ms": 526.166}, "counters": {"num_env_steps_sampled": 2549264, "num_env_steps_trained": 2549264, "num_agent_steps_sampled": 2549264, "num_agent_steps_trained": 2549264}, "done": false, "episodes_total": 2396, "training_iteration": 171, "trial_id": "837cb_00000", "date": "2025-06-07_20-39-50", "timestamp": 1749321590, "time_this_iter_s": 73.77863836288452, "time_total_s": 11633.945308923721, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 11633.945308923721, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 70.3404761904762, "ram_util_percent": 87.79166666666667, "gpu_util_percent0": 0.20226190476190475, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.450736000000001e-05, "total_loss": -0.06100688795516775, "policy_loss": -0.020208602048118005, "vf_loss": 0.013639160786670717, "vf_explained_var": 0.9658319759368896, "kl": 0.021028904915940737, "entropy": 17.26552502892234, "entropy_coeff": 0.0026761039999999995}, "model": {}, "num_grad_updates_lifetime": 89965.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2564902, "num_env_steps_trained": 2564902, "num_agent_steps_sampled": 2564902, "num_agent_steps_trained": 2564902}, "sampler_results": {"episode_reward_max": 55.623192895513895, "episode_reward_min": 33.28741267886459, "episode_reward_mean": 46.36981896958202, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.46697480662983, 50.88677988649245, 45.9851713491113, 48.88643521501997, 40.20758083723727, 48.97152412411354, 55.623192895513895, 47.421689090515606, 50.10318444011932, 44.16178167225885, 50.52738706356463, 48.19407859577184, 48.36367351948276, 41.641491383940526, 49.30120688390971, 50.17108097051484, 48.14357256957924, 47.425176010170844, 40.11205121599752, 46.45348881746352, 54.86051156628607, 47.575106326263125, 51.65442495479791, 48.177035438791805, 49.45400417241964, 45.88667486309467, 49.15908595157558, 37.08477227306219, 44.35094977208963, 46.50411981054302, 45.18844443289593, 47.541493520461984, 38.37259011713651, 48.96787110957542, 50.821223811797225, 45.681074137942915, 53.46657666404538, 46.25654004367467, 47.423205458595675, 43.89638231454662, 50.69206360326908, 38.506763542692326, 48.92801854836035, 47.74724361522219, 46.44845175011162, 48.03111018172194, 39.11318335738474, 44.78535671966068, 49.55473731875704, 46.58987556882438, 53.74512658356175, 48.7292788653113, 46.026450568691786, 50.3941684159352, 47.855790236468735, 37.13141494240368, 46.866433193734814, 49.95703953268238, 46.842692296722966, 48.23221173382962, 37.09258887026915, 36.233278096552596, 50.22189469626773, 47.66782473865481, 47.749678622034615, 47.45270146738962, 49.95936388872152, 38.63554698233415, 50.060282311400016, 37.130261056932305, 49.81309073843659, 50.236662203514385, 41.92666810591069, 45.22624766751314, 39.22658543103773, 46.209282284476664, 52.11959440308175, 47.2848653016677, 47.656482940951776, 46.17533394147372, 50.48068275450344, 44.31059239307548, 47.17970042181268, 37.814723775753265, 51.364250083324855, 48.55715775964809, 40.10611818251183, 45.43979679964926, 33.28741267886459, 45.59263071033305, 49.31827781457845, 43.07273958382646, 51.12127608156921, 39.92322326689448, 44.89950220483912, 48.48282992887796, 47.43101429925972, 36.81485814309267, 45.78494444626205, 49.37491321855517], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8113781404370792, "mean_inference_ms": 8.126717167700976, "mean_action_processing_ms": 0.5703724136127576, "mean_env_wait_ms": 24.53288815968322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03829646110534668, "StateBufferConnector_ms": 0.03970074653625488, "ViewRequirementAgentConnector_ms": 1.0494797229766846}}, "episode_reward_max": 55.623192895513895, "episode_reward_min": 33.28741267886459, "episode_reward_mean": 46.36981896958202, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.46697480662983, 50.88677988649245, 45.9851713491113, 48.88643521501997, 40.20758083723727, 48.97152412411354, 55.623192895513895, 47.421689090515606, 50.10318444011932, 44.16178167225885, 50.52738706356463, 48.19407859577184, 48.36367351948276, 41.641491383940526, 49.30120688390971, 50.17108097051484, 48.14357256957924, 47.425176010170844, 40.11205121599752, 46.45348881746352, 54.86051156628607, 47.575106326263125, 51.65442495479791, 48.177035438791805, 49.45400417241964, 45.88667486309467, 49.15908595157558, 37.08477227306219, 44.35094977208963, 46.50411981054302, 45.18844443289593, 47.541493520461984, 38.37259011713651, 48.96787110957542, 50.821223811797225, 45.681074137942915, 53.46657666404538, 46.25654004367467, 47.423205458595675, 43.89638231454662, 50.69206360326908, 38.506763542692326, 48.92801854836035, 47.74724361522219, 46.44845175011162, 48.03111018172194, 39.11318335738474, 44.78535671966068, 49.55473731875704, 46.58987556882438, 53.74512658356175, 48.7292788653113, 46.026450568691786, 50.3941684159352, 47.855790236468735, 37.13141494240368, 46.866433193734814, 49.95703953268238, 46.842692296722966, 48.23221173382962, 37.09258887026915, 36.233278096552596, 50.22189469626773, 47.66782473865481, 47.749678622034615, 47.45270146738962, 49.95936388872152, 38.63554698233415, 50.060282311400016, 37.130261056932305, 49.81309073843659, 50.236662203514385, 41.92666810591069, 45.22624766751314, 39.22658543103773, 46.209282284476664, 52.11959440308175, 47.2848653016677, 47.656482940951776, 46.17533394147372, 50.48068275450344, 44.31059239307548, 47.17970042181268, 37.814723775753265, 51.364250083324855, 48.55715775964809, 40.10611818251183, 45.43979679964926, 33.28741267886459, 45.59263071033305, 49.31827781457845, 43.07273958382646, 51.12127608156921, 39.92322326689448, 44.89950220483912, 48.48282992887796, 47.43101429925972, 36.81485814309267, 45.78494444626205, 49.37491321855517], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8113781404370792, "mean_inference_ms": 8.126717167700976, "mean_action_processing_ms": 0.5703724136127576, "mean_env_wait_ms": 24.53288815968322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03829646110534668, "StateBufferConnector_ms": 0.03970074653625488, "ViewRequirementAgentConnector_ms": 1.0494797229766846}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2564902, "num_agent_steps_trained": 2564902, "num_env_steps_sampled": 2564902, "num_env_steps_trained": 2564902, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 186.18235089714932, "num_env_steps_trained_throughput_per_sec": 186.18235089714932, "timesteps_total": 2564902, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2564902, "timers": {"training_iteration_time_ms": 74700.534, "sample_time_ms": 47120.634, "load_time_ms": 3385.316, "load_throughput": 4619.362, "learn_time_ms": 23469.084, "learn_throughput": 666.323, "synch_weights_time_ms": 541.01}, "counters": {"num_env_steps_sampled": 2564902, "num_env_steps_trained": 2564902, "num_agent_steps_sampled": 2564902, "num_agent_steps_trained": 2564902}, "done": false, "episodes_total": 2410, "training_iteration": 172, "trial_id": "837cb_00000", "date": "2025-06-07_20-41-14", "timestamp": 1749321674, "time_this_iter_s": 84.03030157089233, "time_total_s": 11717.975610494614, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 11717.975610494614, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 72.26021505376345, "ram_util_percent": 89.68709677419355, "gpu_util_percent0": 0.1774193548387097, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.435098000000003e-05, "total_loss": -0.04414746983442455, "policy_loss": -0.0036865888319020583, "vf_loss": 0.013022439718161794, "vf_explained_var": 0.9627273724295876, "kl": 0.02187650519979418, "entropy": 17.241229652057996, "entropy_coeff": 0.0026526470000000006}, "model": {}, "num_grad_updates_lifetime": 90515.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2580540, "num_env_steps_trained": 2580540, "num_agent_steps_sampled": 2580540, "num_agent_steps_trained": 2580540}, "sampler_results": {"episode_reward_max": 54.86051156628607, "episode_reward_min": 33.28741267886459, "episode_reward_mean": 46.025982775631675, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.30120688390971, 50.17108097051484, 48.14357256957924, 47.425176010170844, 40.11205121599752, 46.45348881746352, 54.86051156628607, 47.575106326263125, 51.65442495479791, 48.177035438791805, 49.45400417241964, 45.88667486309467, 49.15908595157558, 37.08477227306219, 44.35094977208963, 46.50411981054302, 45.18844443289593, 47.541493520461984, 38.37259011713651, 48.96787110957542, 50.821223811797225, 45.681074137942915, 53.46657666404538, 46.25654004367467, 47.423205458595675, 43.89638231454662, 50.69206360326908, 38.506763542692326, 48.92801854836035, 47.74724361522219, 46.44845175011162, 48.03111018172194, 39.11318335738474, 44.78535671966068, 49.55473731875704, 46.58987556882438, 53.74512658356175, 48.7292788653113, 46.026450568691786, 50.3941684159352, 47.855790236468735, 37.13141494240368, 46.866433193734814, 49.95703953268238, 46.842692296722966, 48.23221173382962, 37.09258887026915, 36.233278096552596, 50.22189469626773, 47.66782473865481, 47.749678622034615, 47.45270146738962, 49.95936388872152, 38.63554698233415, 50.060282311400016, 37.130261056932305, 49.81309073843659, 50.236662203514385, 41.92666810591069, 45.22624766751314, 39.22658543103773, 46.209282284476664, 52.11959440308175, 47.2848653016677, 47.656482940951776, 46.17533394147372, 50.48068275450344, 44.31059239307548, 47.17970042181268, 37.814723775753265, 51.364250083324855, 48.55715775964809, 40.10611818251183, 45.43979679964926, 33.28741267886459, 45.59263071033305, 49.31827781457845, 43.07273958382646, 51.12127608156921, 39.92322326689448, 44.89950220483912, 48.48282992887796, 47.43101429925972, 36.81485814309267, 45.78494444626205, 49.37491321855517, 45.01864824674724, 44.75467693486867, 36.59354940411939, 44.51966770229334, 49.72308753415261, 44.17225288702838, 48.344387985215214, 44.42723617881756, 46.89840727117269, 48.01509972677161, 46.50613879932655, 38.04401269747665, 46.84512875054077, 50.19503136620695], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.814476049319362, "mean_inference_ms": 8.134984081051961, "mean_action_processing_ms": 0.570894492454628, "mean_env_wait_ms": 24.547868276750613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04340624809265137, "StateBufferConnector_ms": 0.03575611114501953, "ViewRequirementAgentConnector_ms": 1.0374011993408203}}, "episode_reward_max": 54.86051156628607, "episode_reward_min": 33.28741267886459, "episode_reward_mean": 46.025982775631675, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [49.30120688390971, 50.17108097051484, 48.14357256957924, 47.425176010170844, 40.11205121599752, 46.45348881746352, 54.86051156628607, 47.575106326263125, 51.65442495479791, 48.177035438791805, 49.45400417241964, 45.88667486309467, 49.15908595157558, 37.08477227306219, 44.35094977208963, 46.50411981054302, 45.18844443289593, 47.541493520461984, 38.37259011713651, 48.96787110957542, 50.821223811797225, 45.681074137942915, 53.46657666404538, 46.25654004367467, 47.423205458595675, 43.89638231454662, 50.69206360326908, 38.506763542692326, 48.92801854836035, 47.74724361522219, 46.44845175011162, 48.03111018172194, 39.11318335738474, 44.78535671966068, 49.55473731875704, 46.58987556882438, 53.74512658356175, 48.7292788653113, 46.026450568691786, 50.3941684159352, 47.855790236468735, 37.13141494240368, 46.866433193734814, 49.95703953268238, 46.842692296722966, 48.23221173382962, 37.09258887026915, 36.233278096552596, 50.22189469626773, 47.66782473865481, 47.749678622034615, 47.45270146738962, 49.95936388872152, 38.63554698233415, 50.060282311400016, 37.130261056932305, 49.81309073843659, 50.236662203514385, 41.92666810591069, 45.22624766751314, 39.22658543103773, 46.209282284476664, 52.11959440308175, 47.2848653016677, 47.656482940951776, 46.17533394147372, 50.48068275450344, 44.31059239307548, 47.17970042181268, 37.814723775753265, 51.364250083324855, 48.55715775964809, 40.10611818251183, 45.43979679964926, 33.28741267886459, 45.59263071033305, 49.31827781457845, 43.07273958382646, 51.12127608156921, 39.92322326689448, 44.89950220483912, 48.48282992887796, 47.43101429925972, 36.81485814309267, 45.78494444626205, 49.37491321855517, 45.01864824674724, 44.75467693486867, 36.59354940411939, 44.51966770229334, 49.72308753415261, 44.17225288702838, 48.344387985215214, 44.42723617881756, 46.89840727117269, 48.01509972677161, 46.50613879932655, 38.04401269747665, 46.84512875054077, 50.19503136620695], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.814476049319362, "mean_inference_ms": 8.134984081051961, "mean_action_processing_ms": 0.570894492454628, "mean_env_wait_ms": 24.547868276750613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04340624809265137, "StateBufferConnector_ms": 0.03575611114501953, "ViewRequirementAgentConnector_ms": 1.0374011993408203}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2580540, "num_agent_steps_trained": 2580540, "num_env_steps_sampled": 2580540, "num_env_steps_trained": 2580540, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 209.7302008459935, "num_env_steps_trained_throughput_per_sec": 209.7302008459935, "timesteps_total": 2580540, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2580540, "timers": {"training_iteration_time_ms": 74463.682, "sample_time_ms": 47106.855, "load_time_ms": 3253.024, "load_throughput": 4807.219, "learn_time_ms": 23405.613, "learn_throughput": 668.13, "synch_weights_time_ms": 542.496}, "counters": {"num_env_steps_sampled": 2580540, "num_env_steps_trained": 2580540, "num_agent_steps_sampled": 2580540, "num_agent_steps_trained": 2580540}, "done": false, "episodes_total": 2424, "training_iteration": 173, "trial_id": "837cb_00000", "date": "2025-06-07_20-42-29", "timestamp": 1749321749, "time_this_iter_s": 74.58598804473877, "time_total_s": 11792.561598539352, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 11792.561598539352, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 69.16941176470588, "ram_util_percent": 86.91647058823533, "gpu_util_percent0": 0.1994117647058824, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.41946e-05, "total_loss": -0.054834782965851696, "policy_loss": -0.014863329469735618, "vf_loss": 0.013282791231335564, "vf_explained_var": 0.9660012860731645, "kl": 0.021642569082992853, "entropy": 17.233046793504194, "entropy_coeff": 0.0026291900000000004}, "model": {}, "num_grad_updates_lifetime": 91065.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2596178, "num_env_steps_trained": 2596178, "num_agent_steps_sampled": 2596178, "num_agent_steps_trained": 2596178}, "sampler_results": {"episode_reward_max": 53.74512658356175, "episode_reward_min": 33.28741267886459, "episode_reward_mean": 45.790141997997935, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.35094977208963, 46.50411981054302, 45.18844443289593, 47.541493520461984, 38.37259011713651, 48.96787110957542, 50.821223811797225, 45.681074137942915, 53.46657666404538, 46.25654004367467, 47.423205458595675, 43.89638231454662, 50.69206360326908, 38.506763542692326, 48.92801854836035, 47.74724361522219, 46.44845175011162, 48.03111018172194, 39.11318335738474, 44.78535671966068, 49.55473731875704, 46.58987556882438, 53.74512658356175, 48.7292788653113, 46.026450568691786, 50.3941684159352, 47.855790236468735, 37.13141494240368, 46.866433193734814, 49.95703953268238, 46.842692296722966, 48.23221173382962, 37.09258887026915, 36.233278096552596, 50.22189469626773, 47.66782473865481, 47.749678622034615, 47.45270146738962, 49.95936388872152, 38.63554698233415, 50.060282311400016, 37.130261056932305, 49.81309073843659, 50.236662203514385, 41.92666810591069, 45.22624766751314, 39.22658543103773, 46.209282284476664, 52.11959440308175, 47.2848653016677, 47.656482940951776, 46.17533394147372, 50.48068275450344, 44.31059239307548, 47.17970042181268, 37.814723775753265, 51.364250083324855, 48.55715775964809, 40.10611818251183, 45.43979679964926, 33.28741267886459, 45.59263071033305, 49.31827781457845, 43.07273958382646, 51.12127608156921, 39.92322326689448, 44.89950220483912, 48.48282992887796, 47.43101429925972, 36.81485814309267, 45.78494444626205, 49.37491321855517, 45.01864824674724, 44.75467693486867, 36.59354940411939, 44.51966770229334, 49.72308753415261, 44.17225288702838, 48.344387985215214, 44.42723617881756, 46.89840727117269, 48.01509972677161, 46.50613879932655, 38.04401269747665, 46.84512875054077, 50.19503136620695, 44.01502085397121, 42.12055922166585, 39.1412811379853, 43.63254493041992, 49.293011536172074, 44.127080929897346, 50.27069953212888, 45.73606786105556, 51.2149625745561, 47.61159610186181, 49.494365743339074, 33.91440662911835, 53.02812753323003, 48.274389665150245], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.817346811935087, "mean_inference_ms": 8.143403018120464, "mean_action_processing_ms": 0.5714244666730027, "mean_env_wait_ms": 24.56263069725914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043871164321899414, "StateBufferConnector_ms": 0.031723976135253906, "ViewRequirementAgentConnector_ms": 1.0128507614135742}}, "episode_reward_max": 53.74512658356175, "episode_reward_min": 33.28741267886459, "episode_reward_mean": 45.790141997997935, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.35094977208963, 46.50411981054302, 45.18844443289593, 47.541493520461984, 38.37259011713651, 48.96787110957542, 50.821223811797225, 45.681074137942915, 53.46657666404538, 46.25654004367467, 47.423205458595675, 43.89638231454662, 50.69206360326908, 38.506763542692326, 48.92801854836035, 47.74724361522219, 46.44845175011162, 48.03111018172194, 39.11318335738474, 44.78535671966068, 49.55473731875704, 46.58987556882438, 53.74512658356175, 48.7292788653113, 46.026450568691786, 50.3941684159352, 47.855790236468735, 37.13141494240368, 46.866433193734814, 49.95703953268238, 46.842692296722966, 48.23221173382962, 37.09258887026915, 36.233278096552596, 50.22189469626773, 47.66782473865481, 47.749678622034615, 47.45270146738962, 49.95936388872152, 38.63554698233415, 50.060282311400016, 37.130261056932305, 49.81309073843659, 50.236662203514385, 41.92666810591069, 45.22624766751314, 39.22658543103773, 46.209282284476664, 52.11959440308175, 47.2848653016677, 47.656482940951776, 46.17533394147372, 50.48068275450344, 44.31059239307548, 47.17970042181268, 37.814723775753265, 51.364250083324855, 48.55715775964809, 40.10611818251183, 45.43979679964926, 33.28741267886459, 45.59263071033305, 49.31827781457845, 43.07273958382646, 51.12127608156921, 39.92322326689448, 44.89950220483912, 48.48282992887796, 47.43101429925972, 36.81485814309267, 45.78494444626205, 49.37491321855517, 45.01864824674724, 44.75467693486867, 36.59354940411939, 44.51966770229334, 49.72308753415261, 44.17225288702838, 48.344387985215214, 44.42723617881756, 46.89840727117269, 48.01509972677161, 46.50613879932655, 38.04401269747665, 46.84512875054077, 50.19503136620695, 44.01502085397121, 42.12055922166585, 39.1412811379853, 43.63254493041992, 49.293011536172074, 44.127080929897346, 50.27069953212888, 45.73606786105556, 51.2149625745561, 47.61159610186181, 49.494365743339074, 33.91440662911835, 53.02812753323003, 48.274389665150245], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.817346811935087, "mean_inference_ms": 8.143403018120464, "mean_action_processing_ms": 0.5714244666730027, "mean_env_wait_ms": 24.56263069725914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043871164321899414, "StateBufferConnector_ms": 0.031723976135253906, "ViewRequirementAgentConnector_ms": 1.0128507614135742}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2596178, "num_agent_steps_trained": 2596178, "num_env_steps_sampled": 2596178, "num_env_steps_trained": 2596178, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 212.0417013984945, "num_env_steps_trained_throughput_per_sec": 212.0417013984945, "timesteps_total": 2596178, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2596178, "timers": {"training_iteration_time_ms": 74715.537, "sample_time_ms": 47163.902, "load_time_ms": 3351.404, "load_throughput": 4666.104, "learn_time_ms": 23493.876, "learn_throughput": 665.62, "synch_weights_time_ms": 545.42}, "counters": {"num_env_steps_sampled": 2596178, "num_env_steps_trained": 2596178, "num_agent_steps_sampled": 2596178, "num_agent_steps_trained": 2596178}, "done": false, "episodes_total": 2438, "training_iteration": 174, "trial_id": "837cb_00000", "date": "2025-06-07_20-43-43", "timestamp": 1749321823, "time_this_iter_s": 73.76965045928955, "time_total_s": 11866.331248998642, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 11866.331248998642, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 69.40714285714286, "ram_util_percent": 86.85595238095239, "gpu_util_percent0": 0.2061904761904762, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.403821999999999e-05, "total_loss": -0.054320366846143525, "policy_loss": -0.014705523192903705, "vf_loss": 0.012954515998505733, "vf_explained_var": 0.964673537015915, "kl": 0.021240006802418714, "entropy": 17.20387335170399, "entropy_coeff": 0.0026057329999999994}, "model": {}, "num_grad_updates_lifetime": 91615.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2611816, "num_env_steps_trained": 2611816, "num_agent_steps_sampled": 2611816, "num_agent_steps_trained": 2611816}, "sampler_results": {"episode_reward_max": 54.33764580605823, "episode_reward_min": 33.28741267886459, "episode_reward_mean": 45.92465054965542, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.92801854836035, 47.74724361522219, 46.44845175011162, 48.03111018172194, 39.11318335738474, 44.78535671966068, 49.55473731875704, 46.58987556882438, 53.74512658356175, 48.7292788653113, 46.026450568691786, 50.3941684159352, 47.855790236468735, 37.13141494240368, 46.866433193734814, 49.95703953268238, 46.842692296722966, 48.23221173382962, 37.09258887026915, 36.233278096552596, 50.22189469626773, 47.66782473865481, 47.749678622034615, 47.45270146738962, 49.95936388872152, 38.63554698233415, 50.060282311400016, 37.130261056932305, 49.81309073843659, 50.236662203514385, 41.92666810591069, 45.22624766751314, 39.22658543103773, 46.209282284476664, 52.11959440308175, 47.2848653016677, 47.656482940951776, 46.17533394147372, 50.48068275450344, 44.31059239307548, 47.17970042181268, 37.814723775753265, 51.364250083324855, 48.55715775964809, 40.10611818251183, 45.43979679964926, 33.28741267886459, 45.59263071033305, 49.31827781457845, 43.07273958382646, 51.12127608156921, 39.92322326689448, 44.89950220483912, 48.48282992887796, 47.43101429925972, 36.81485814309267, 45.78494444626205, 49.37491321855517, 45.01864824674724, 44.75467693486867, 36.59354940411939, 44.51966770229334, 49.72308753415261, 44.17225288702838, 48.344387985215214, 44.42723617881756, 46.89840727117269, 48.01509972677161, 46.50613879932655, 38.04401269747665, 46.84512875054077, 50.19503136620695, 44.01502085397121, 42.12055922166585, 39.1412811379853, 43.63254493041992, 49.293011536172074, 44.127080929897346, 50.27069953212888, 45.73606786105556, 51.2149625745561, 47.61159610186181, 49.494365743339074, 33.91440662911835, 53.02812753323003, 48.274389665150245, 47.22298265355777, 43.33552482344929, 39.312973883180696, 47.03024722736914, 51.40911852003619, 45.80865224112814, 48.74259689974284, 49.772599098091014, 54.33764580605823, 47.315844829178864, 45.860113067528275, 38.11795077970051, 50.6413632737056, 52.21254040228807], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8200065558776153, "mean_inference_ms": 8.15199339400629, "mean_action_processing_ms": 0.5719661176869036, "mean_env_wait_ms": 24.57938654444393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0400233268737793, "StateBufferConnector_ms": 0.034674882888793945, "ViewRequirementAgentConnector_ms": 1.0417745113372803}}, "episode_reward_max": 54.33764580605823, "episode_reward_min": 33.28741267886459, "episode_reward_mean": 45.92465054965542, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [48.92801854836035, 47.74724361522219, 46.44845175011162, 48.03111018172194, 39.11318335738474, 44.78535671966068, 49.55473731875704, 46.58987556882438, 53.74512658356175, 48.7292788653113, 46.026450568691786, 50.3941684159352, 47.855790236468735, 37.13141494240368, 46.866433193734814, 49.95703953268238, 46.842692296722966, 48.23221173382962, 37.09258887026915, 36.233278096552596, 50.22189469626773, 47.66782473865481, 47.749678622034615, 47.45270146738962, 49.95936388872152, 38.63554698233415, 50.060282311400016, 37.130261056932305, 49.81309073843659, 50.236662203514385, 41.92666810591069, 45.22624766751314, 39.22658543103773, 46.209282284476664, 52.11959440308175, 47.2848653016677, 47.656482940951776, 46.17533394147372, 50.48068275450344, 44.31059239307548, 47.17970042181268, 37.814723775753265, 51.364250083324855, 48.55715775964809, 40.10611818251183, 45.43979679964926, 33.28741267886459, 45.59263071033305, 49.31827781457845, 43.07273958382646, 51.12127608156921, 39.92322326689448, 44.89950220483912, 48.48282992887796, 47.43101429925972, 36.81485814309267, 45.78494444626205, 49.37491321855517, 45.01864824674724, 44.75467693486867, 36.59354940411939, 44.51966770229334, 49.72308753415261, 44.17225288702838, 48.344387985215214, 44.42723617881756, 46.89840727117269, 48.01509972677161, 46.50613879932655, 38.04401269747665, 46.84512875054077, 50.19503136620695, 44.01502085397121, 42.12055922166585, 39.1412811379853, 43.63254493041992, 49.293011536172074, 44.127080929897346, 50.27069953212888, 45.73606786105556, 51.2149625745561, 47.61159610186181, 49.494365743339074, 33.91440662911835, 53.02812753323003, 48.274389665150245, 47.22298265355777, 43.33552482344929, 39.312973883180696, 47.03024722736914, 51.40911852003619, 45.80865224112814, 48.74259689974284, 49.772599098091014, 54.33764580605823, 47.315844829178864, 45.860113067528275, 38.11795077970051, 50.6413632737056, 52.21254040228807], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8200065558776153, "mean_inference_ms": 8.15199339400629, "mean_action_processing_ms": 0.5719661176869036, "mean_env_wait_ms": 24.57938654444393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0400233268737793, "StateBufferConnector_ms": 0.034674882888793945, "ViewRequirementAgentConnector_ms": 1.0417745113372803}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2611816, "num_agent_steps_trained": 2611816, "num_env_steps_sampled": 2611816, "num_env_steps_trained": 2611816, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 202.42177191740808, "num_env_steps_trained_throughput_per_sec": 202.42177191740808, "timesteps_total": 2611816, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2611816, "timers": {"training_iteration_time_ms": 75302.486, "sample_time_ms": 47634.711, "load_time_ms": 3378.124, "load_throughput": 4629.196, "learn_time_ms": 23581.145, "learn_throughput": 663.157, "synch_weights_time_ms": 546.276}, "counters": {"num_env_steps_sampled": 2611816, "num_env_steps_trained": 2611816, "num_agent_steps_sampled": 2611816, "num_agent_steps_trained": 2611816}, "done": false, "episodes_total": 2452, "training_iteration": 175, "trial_id": "837cb_00000", "date": "2025-06-07_20-45-00", "timestamp": 1749321900, "time_this_iter_s": 77.28409719467163, "time_total_s": 11943.615346193314, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 11943.615346193314, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 72.3264367816092, "ram_util_percent": 86.64022988505747, "gpu_util_percent0": 0.1944827586206896, "vram_util_percent0": 0.965006510416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.388184e-05, "total_loss": -0.04860480172707784, "policy_loss": -0.009466038950591942, "vf_loss": 0.013160631270571188, "vf_explained_var": 0.9671426554159684, "kl": 0.020874264145660106, "entropy": 17.19087842767889, "entropy_coeff": 0.002582276}, "model": {}, "num_grad_updates_lifetime": 92165.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2627454, "num_env_steps_trained": 2627454, "num_agent_steps_sampled": 2627454, "num_agent_steps_trained": 2627454}, "sampler_results": {"episode_reward_max": 54.33764580605823, "episode_reward_min": 33.28741267886459, "episode_reward_mean": 45.86130312300494, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.866433193734814, 49.95703953268238, 46.842692296722966, 48.23221173382962, 37.09258887026915, 36.233278096552596, 50.22189469626773, 47.66782473865481, 47.749678622034615, 47.45270146738962, 49.95936388872152, 38.63554698233415, 50.060282311400016, 37.130261056932305, 49.81309073843659, 50.236662203514385, 41.92666810591069, 45.22624766751314, 39.22658543103773, 46.209282284476664, 52.11959440308175, 47.2848653016677, 47.656482940951776, 46.17533394147372, 50.48068275450344, 44.31059239307548, 47.17970042181268, 37.814723775753265, 51.364250083324855, 48.55715775964809, 40.10611818251183, 45.43979679964926, 33.28741267886459, 45.59263071033305, 49.31827781457845, 43.07273958382646, 51.12127608156921, 39.92322326689448, 44.89950220483912, 48.48282992887796, 47.43101429925972, 36.81485814309267, 45.78494444626205, 49.37491321855517, 45.01864824674724, 44.75467693486867, 36.59354940411939, 44.51966770229334, 49.72308753415261, 44.17225288702838, 48.344387985215214, 44.42723617881756, 46.89840727117269, 48.01509972677161, 46.50613879932655, 38.04401269747665, 46.84512875054077, 50.19503136620695, 44.01502085397121, 42.12055922166585, 39.1412811379853, 43.63254493041992, 49.293011536172074, 44.127080929897346, 50.27069953212888, 45.73606786105556, 51.2149625745561, 47.61159610186181, 49.494365743339074, 33.91440662911835, 53.02812753323003, 48.274389665150245, 47.22298265355777, 43.33552482344929, 39.312973883180696, 47.03024722736914, 51.40911852003619, 45.80865224112814, 48.74259689974284, 49.772599098091014, 54.33764580605823, 47.315844829178864, 45.860113067528275, 38.11795077970051, 50.6413632737056, 52.21254040228807, 44.48921509524505, 47.455373747976545, 38.36592785812457, 44.32541403958849, 52.26050899601501, 46.288008838308436, 52.40029787555922, 50.7099073251266, 48.557042165578906, 46.46058416312455, 49.021789182789064, 36.11715959807212, 44.275196753637644, 48.019038368220606], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8221065979453828, "mean_inference_ms": 8.161460365763025, "mean_action_processing_ms": 0.5725578573447323, "mean_env_wait_ms": 24.597249978100987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04465174674987793, "StateBufferConnector_ms": 0.03464937210083008, "ViewRequirementAgentConnector_ms": 1.0620362758636475}}, "episode_reward_max": 54.33764580605823, "episode_reward_min": 33.28741267886459, "episode_reward_mean": 45.86130312300494, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.866433193734814, 49.95703953268238, 46.842692296722966, 48.23221173382962, 37.09258887026915, 36.233278096552596, 50.22189469626773, 47.66782473865481, 47.749678622034615, 47.45270146738962, 49.95936388872152, 38.63554698233415, 50.060282311400016, 37.130261056932305, 49.81309073843659, 50.236662203514385, 41.92666810591069, 45.22624766751314, 39.22658543103773, 46.209282284476664, 52.11959440308175, 47.2848653016677, 47.656482940951776, 46.17533394147372, 50.48068275450344, 44.31059239307548, 47.17970042181268, 37.814723775753265, 51.364250083324855, 48.55715775964809, 40.10611818251183, 45.43979679964926, 33.28741267886459, 45.59263071033305, 49.31827781457845, 43.07273958382646, 51.12127608156921, 39.92322326689448, 44.89950220483912, 48.48282992887796, 47.43101429925972, 36.81485814309267, 45.78494444626205, 49.37491321855517, 45.01864824674724, 44.75467693486867, 36.59354940411939, 44.51966770229334, 49.72308753415261, 44.17225288702838, 48.344387985215214, 44.42723617881756, 46.89840727117269, 48.01509972677161, 46.50613879932655, 38.04401269747665, 46.84512875054077, 50.19503136620695, 44.01502085397121, 42.12055922166585, 39.1412811379853, 43.63254493041992, 49.293011536172074, 44.127080929897346, 50.27069953212888, 45.73606786105556, 51.2149625745561, 47.61159610186181, 49.494365743339074, 33.91440662911835, 53.02812753323003, 48.274389665150245, 47.22298265355777, 43.33552482344929, 39.312973883180696, 47.03024722736914, 51.40911852003619, 45.80865224112814, 48.74259689974284, 49.772599098091014, 54.33764580605823, 47.315844829178864, 45.860113067528275, 38.11795077970051, 50.6413632737056, 52.21254040228807, 44.48921509524505, 47.455373747976545, 38.36592785812457, 44.32541403958849, 52.26050899601501, 46.288008838308436, 52.40029787555922, 50.7099073251266, 48.557042165578906, 46.46058416312455, 49.021789182789064, 36.11715959807212, 44.275196753637644, 48.019038368220606], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8221065979453828, "mean_inference_ms": 8.161460365763025, "mean_action_processing_ms": 0.5725578573447323, "mean_env_wait_ms": 24.597249978100987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04465174674987793, "StateBufferConnector_ms": 0.03464937210083008, "ViewRequirementAgentConnector_ms": 1.0620362758636475}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2627454, "num_agent_steps_trained": 2627454, "num_env_steps_sampled": 2627454, "num_env_steps_trained": 2627454, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 195.15867938742733, "num_env_steps_trained_throughput_per_sec": 195.15867938742733, "timesteps_total": 2627454, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2627454, "timers": {"training_iteration_time_ms": 76033.699, "sample_time_ms": 48178.841, "load_time_ms": 3493.651, "load_throughput": 4476.119, "learn_time_ms": 23646.216, "learn_throughput": 661.332, "synch_weights_time_ms": 550.984}, "counters": {"num_env_steps_sampled": 2627454, "num_env_steps_trained": 2627454, "num_agent_steps_sampled": 2627454, "num_agent_steps_trained": 2627454}, "done": false, "episodes_total": 2466, "training_iteration": 176, "trial_id": "837cb_00000", "date": "2025-06-07_20-46-21", "timestamp": 1749321981, "time_this_iter_s": 80.14955496788025, "time_total_s": 12023.764901161194, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 12023.764901161194, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 72.27142857142857, "ram_util_percent": 91.13736263736264, "gpu_util_percent0": 0.1908791208791209, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.372545999999998e-05, "total_loss": -0.048537244802044535, "policy_loss": -0.009822093280196316, "vf_loss": 0.012777600541118194, "vf_explained_var": 0.9640562902797353, "kl": 0.021066334880048096, "entropy": 17.14270428397439, "entropy_coeff": 0.0025588189999999995}, "model": {}, "num_grad_updates_lifetime": 92715.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2643092, "num_env_steps_trained": 2643092, "num_agent_steps_sampled": 2643092, "num_agent_steps_trained": 2643092}, "sampler_results": {"episode_reward_max": 54.33764580605823, "episode_reward_min": 33.28741267886459, "episode_reward_mean": 46.03117125168734, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.81309073843659, 50.236662203514385, 41.92666810591069, 45.22624766751314, 39.22658543103773, 46.209282284476664, 52.11959440308175, 47.2848653016677, 47.656482940951776, 46.17533394147372, 50.48068275450344, 44.31059239307548, 47.17970042181268, 37.814723775753265, 51.364250083324855, 48.55715775964809, 40.10611818251183, 45.43979679964926, 33.28741267886459, 45.59263071033305, 49.31827781457845, 43.07273958382646, 51.12127608156921, 39.92322326689448, 44.89950220483912, 48.48282992887796, 47.43101429925972, 36.81485814309267, 45.78494444626205, 49.37491321855517, 45.01864824674724, 44.75467693486867, 36.59354940411939, 44.51966770229334, 49.72308753415261, 44.17225288702838, 48.344387985215214, 44.42723617881756, 46.89840727117269, 48.01509972677161, 46.50613879932655, 38.04401269747665, 46.84512875054077, 50.19503136620695, 44.01502085397121, 42.12055922166585, 39.1412811379853, 43.63254493041992, 49.293011536172074, 44.127080929897346, 50.27069953212888, 45.73606786105556, 51.2149625745561, 47.61159610186181, 49.494365743339074, 33.91440662911835, 53.02812753323003, 48.274389665150245, 47.22298265355777, 43.33552482344929, 39.312973883180696, 47.03024722736914, 51.40911852003619, 45.80865224112814, 48.74259689974284, 49.772599098091014, 54.33764580605823, 47.315844829178864, 45.860113067528275, 38.11795077970051, 50.6413632737056, 52.21254040228807, 44.48921509524505, 47.455373747976545, 38.36592785812457, 44.32541403958849, 52.26050899601501, 46.288008838308436, 52.40029787555922, 50.7099073251266, 48.557042165578906, 46.46058416312455, 49.021789182789064, 36.11715959807212, 44.275196753637644, 48.019038368220606, 44.46178946457683, 45.27609335260099, 35.468137751448864, 43.46132663937451, 50.39808454579486, 44.56347450569722, 53.96020531831258, 50.879069029833275, 51.31637531495907, 47.66100782153559, 47.43295783874715, 38.092598868303156, 49.065253970650666, 49.05223593393208], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.824455231189825, "mean_inference_ms": 8.171100098726463, "mean_action_processing_ms": 0.5731512273151983, "mean_env_wait_ms": 24.615548920806773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04436135292053223, "StateBufferConnector_ms": 0.044161319732666016, "ViewRequirementAgentConnector_ms": 1.0772027969360352}}, "episode_reward_max": 54.33764580605823, "episode_reward_min": 33.28741267886459, "episode_reward_mean": 46.03117125168734, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [49.81309073843659, 50.236662203514385, 41.92666810591069, 45.22624766751314, 39.22658543103773, 46.209282284476664, 52.11959440308175, 47.2848653016677, 47.656482940951776, 46.17533394147372, 50.48068275450344, 44.31059239307548, 47.17970042181268, 37.814723775753265, 51.364250083324855, 48.55715775964809, 40.10611818251183, 45.43979679964926, 33.28741267886459, 45.59263071033305, 49.31827781457845, 43.07273958382646, 51.12127608156921, 39.92322326689448, 44.89950220483912, 48.48282992887796, 47.43101429925972, 36.81485814309267, 45.78494444626205, 49.37491321855517, 45.01864824674724, 44.75467693486867, 36.59354940411939, 44.51966770229334, 49.72308753415261, 44.17225288702838, 48.344387985215214, 44.42723617881756, 46.89840727117269, 48.01509972677161, 46.50613879932655, 38.04401269747665, 46.84512875054077, 50.19503136620695, 44.01502085397121, 42.12055922166585, 39.1412811379853, 43.63254493041992, 49.293011536172074, 44.127080929897346, 50.27069953212888, 45.73606786105556, 51.2149625745561, 47.61159610186181, 49.494365743339074, 33.91440662911835, 53.02812753323003, 48.274389665150245, 47.22298265355777, 43.33552482344929, 39.312973883180696, 47.03024722736914, 51.40911852003619, 45.80865224112814, 48.74259689974284, 49.772599098091014, 54.33764580605823, 47.315844829178864, 45.860113067528275, 38.11795077970051, 50.6413632737056, 52.21254040228807, 44.48921509524505, 47.455373747976545, 38.36592785812457, 44.32541403958849, 52.26050899601501, 46.288008838308436, 52.40029787555922, 50.7099073251266, 48.557042165578906, 46.46058416312455, 49.021789182789064, 36.11715959807212, 44.275196753637644, 48.019038368220606, 44.46178946457683, 45.27609335260099, 35.468137751448864, 43.46132663937451, 50.39808454579486, 44.56347450569722, 53.96020531831258, 50.879069029833275, 51.31637531495907, 47.66100782153559, 47.43295783874715, 38.092598868303156, 49.065253970650666, 49.05223593393208], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.824455231189825, "mean_inference_ms": 8.171100098726463, "mean_action_processing_ms": 0.5731512273151983, "mean_env_wait_ms": 24.615548920806773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04436135292053223, "StateBufferConnector_ms": 0.044161319732666016, "ViewRequirementAgentConnector_ms": 1.0772027969360352}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2643092, "num_agent_steps_trained": 2643092, "num_env_steps_sampled": 2643092, "num_env_steps_trained": 2643092, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 207.83545009406564, "num_env_steps_trained_throughput_per_sec": 207.83545009406564, "timesteps_total": 2643092, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2643092, "timers": {"training_iteration_time_ms": 76314.443, "sample_time_ms": 48300.064, "load_time_ms": 3590.624, "load_throughput": 4355.232, "learn_time_ms": 23714.869, "learn_throughput": 659.418, "synch_weights_time_ms": 547.219}, "counters": {"num_env_steps_sampled": 2643092, "num_env_steps_trained": 2643092, "num_agent_steps_sampled": 2643092, "num_agent_steps_trained": 2643092}, "done": false, "episodes_total": 2480, "training_iteration": 177, "trial_id": "837cb_00000", "date": "2025-06-07_20-47-36", "timestamp": 1749322056, "time_this_iter_s": 75.26373243331909, "time_total_s": 12099.028633594513, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 12099.028633594513, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 69.80823529411765, "ram_util_percent": 91.46470588235294, "gpu_util_percent0": 0.1961176470588235, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.356908e-05, "total_loss": -0.06025235336654904, "policy_loss": -0.021770739783956244, "vf_loss": 0.012859989848749882, "vf_explained_var": 0.9681431252306157, "kl": 0.021873397520129484, "entropy": 17.238838552995162, "entropy_coeff": 0.002535362}, "model": {}, "num_grad_updates_lifetime": 93265.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2658730, "num_env_steps_trained": 2658730, "num_agent_steps_sampled": 2658730, "num_agent_steps_trained": 2658730}, "sampler_results": {"episode_reward_max": 54.33764580605823, "episode_reward_min": 33.28741267886459, "episode_reward_mean": 45.98305596912747, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.364250083324855, 48.55715775964809, 40.10611818251183, 45.43979679964926, 33.28741267886459, 45.59263071033305, 49.31827781457845, 43.07273958382646, 51.12127608156921, 39.92322326689448, 44.89950220483912, 48.48282992887796, 47.43101429925972, 36.81485814309267, 45.78494444626205, 49.37491321855517, 45.01864824674724, 44.75467693486867, 36.59354940411939, 44.51966770229334, 49.72308753415261, 44.17225288702838, 48.344387985215214, 44.42723617881756, 46.89840727117269, 48.01509972677161, 46.50613879932655, 38.04401269747665, 46.84512875054077, 50.19503136620695, 44.01502085397121, 42.12055922166585, 39.1412811379853, 43.63254493041992, 49.293011536172074, 44.127080929897346, 50.27069953212888, 45.73606786105556, 51.2149625745561, 47.61159610186181, 49.494365743339074, 33.91440662911835, 53.02812753323003, 48.274389665150245, 47.22298265355777, 43.33552482344929, 39.312973883180696, 47.03024722736914, 51.40911852003619, 45.80865224112814, 48.74259689974284, 49.772599098091014, 54.33764580605823, 47.315844829178864, 45.860113067528275, 38.11795077970051, 50.6413632737056, 52.21254040228807, 44.48921509524505, 47.455373747976545, 38.36592785812457, 44.32541403958849, 52.26050899601501, 46.288008838308436, 52.40029787555922, 50.7099073251266, 48.557042165578906, 46.46058416312455, 49.021789182789064, 36.11715959807212, 44.275196753637644, 48.019038368220606, 44.46178946457683, 45.27609335260099, 35.468137751448864, 43.46132663937451, 50.39808454579486, 44.56347450569722, 53.96020531831258, 50.879069029833275, 51.31637531495907, 47.66100782153559, 47.43295783874715, 38.092598868303156, 49.065253970650666, 49.05223593393208, 40.818952727335265, 44.994165754903406, 39.752563537669715, 48.137363053521284, 46.996817817174865, 45.83283900080437, 51.55534928548722, 47.68025753517895, 49.17561850060389, 44.5528336829906, 49.559684168964914, 34.91755789185293, 49.9296769108061, 46.94530423992885], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8266305995754375, "mean_inference_ms": 8.181615916281366, "mean_action_processing_ms": 0.5738101267817819, "mean_env_wait_ms": 24.635823382069134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03935575485229492, "StateBufferConnector_ms": 0.03817152976989746, "ViewRequirementAgentConnector_ms": 1.1292071342468262}}, "episode_reward_max": 54.33764580605823, "episode_reward_min": 33.28741267886459, "episode_reward_mean": 45.98305596912747, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [51.364250083324855, 48.55715775964809, 40.10611818251183, 45.43979679964926, 33.28741267886459, 45.59263071033305, 49.31827781457845, 43.07273958382646, 51.12127608156921, 39.92322326689448, 44.89950220483912, 48.48282992887796, 47.43101429925972, 36.81485814309267, 45.78494444626205, 49.37491321855517, 45.01864824674724, 44.75467693486867, 36.59354940411939, 44.51966770229334, 49.72308753415261, 44.17225288702838, 48.344387985215214, 44.42723617881756, 46.89840727117269, 48.01509972677161, 46.50613879932655, 38.04401269747665, 46.84512875054077, 50.19503136620695, 44.01502085397121, 42.12055922166585, 39.1412811379853, 43.63254493041992, 49.293011536172074, 44.127080929897346, 50.27069953212888, 45.73606786105556, 51.2149625745561, 47.61159610186181, 49.494365743339074, 33.91440662911835, 53.02812753323003, 48.274389665150245, 47.22298265355777, 43.33552482344929, 39.312973883180696, 47.03024722736914, 51.40911852003619, 45.80865224112814, 48.74259689974284, 49.772599098091014, 54.33764580605823, 47.315844829178864, 45.860113067528275, 38.11795077970051, 50.6413632737056, 52.21254040228807, 44.48921509524505, 47.455373747976545, 38.36592785812457, 44.32541403958849, 52.26050899601501, 46.288008838308436, 52.40029787555922, 50.7099073251266, 48.557042165578906, 46.46058416312455, 49.021789182789064, 36.11715959807212, 44.275196753637644, 48.019038368220606, 44.46178946457683, 45.27609335260099, 35.468137751448864, 43.46132663937451, 50.39808454579486, 44.56347450569722, 53.96020531831258, 50.879069029833275, 51.31637531495907, 47.66100782153559, 47.43295783874715, 38.092598868303156, 49.065253970650666, 49.05223593393208, 40.818952727335265, 44.994165754903406, 39.752563537669715, 48.137363053521284, 46.996817817174865, 45.83283900080437, 51.55534928548722, 47.68025753517895, 49.17561850060389, 44.5528336829906, 49.559684168964914, 34.91755789185293, 49.9296769108061, 46.94530423992885], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8266305995754375, "mean_inference_ms": 8.181615916281366, "mean_action_processing_ms": 0.5738101267817819, "mean_env_wait_ms": 24.635823382069134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03935575485229492, "StateBufferConnector_ms": 0.03817152976989746, "ViewRequirementAgentConnector_ms": 1.1292071342468262}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2658730, "num_agent_steps_trained": 2658730, "num_env_steps_sampled": 2658730, "num_env_steps_trained": 2658730, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 197.12423310903205, "num_env_steps_trained_throughput_per_sec": 197.12423310903205, "timesteps_total": 2658730, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2658730, "timers": {"training_iteration_time_ms": 76929.626, "sample_time_ms": 48673.018, "load_time_ms": 3725.833, "load_throughput": 4197.182, "learn_time_ms": 23823.585, "learn_throughput": 656.408, "synch_weights_time_ms": 544.719}, "counters": {"num_env_steps_sampled": 2658730, "num_env_steps_trained": 2658730, "num_agent_steps_sampled": 2658730, "num_agent_steps_trained": 2658730}, "done": false, "episodes_total": 2494, "training_iteration": 178, "trial_id": "837cb_00000", "date": "2025-06-07_20-48-55", "timestamp": 1749322135, "time_this_iter_s": 79.35386395454407, "time_total_s": 12178.382497549057, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 12178.382497549057, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 71.11648351648353, "ram_util_percent": 89.63846153846153, "gpu_util_percent0": 0.18846153846153846, "vram_util_percent0": 0.9650065104166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.34127e-05, "total_loss": -0.05354695251084526, "policy_loss": -0.015489662653470243, "vf_loss": 0.01334990589667789, "vf_explained_var": 0.9683759411898526, "kl": 0.021202022233423008, "entropy": 17.272702503204346, "entropy_coeff": 0.0025119050000000005}, "model": {}, "num_grad_updates_lifetime": 93815.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2674368, "num_env_steps_trained": 2674368, "num_agent_steps_sampled": 2674368, "num_agent_steps_trained": 2674368}, "sampler_results": {"episode_reward_max": 54.33764580605823, "episode_reward_min": 33.91440662911835, "episode_reward_mean": 45.916539240871735, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.78494444626205, 49.37491321855517, 45.01864824674724, 44.75467693486867, 36.59354940411939, 44.51966770229334, 49.72308753415261, 44.17225288702838, 48.344387985215214, 44.42723617881756, 46.89840727117269, 48.01509972677161, 46.50613879932655, 38.04401269747665, 46.84512875054077, 50.19503136620695, 44.01502085397121, 42.12055922166585, 39.1412811379853, 43.63254493041992, 49.293011536172074, 44.127080929897346, 50.27069953212888, 45.73606786105556, 51.2149625745561, 47.61159610186181, 49.494365743339074, 33.91440662911835, 53.02812753323003, 48.274389665150245, 47.22298265355777, 43.33552482344929, 39.312973883180696, 47.03024722736914, 51.40911852003619, 45.80865224112814, 48.74259689974284, 49.772599098091014, 54.33764580605823, 47.315844829178864, 45.860113067528275, 38.11795077970051, 50.6413632737056, 52.21254040228807, 44.48921509524505, 47.455373747976545, 38.36592785812457, 44.32541403958849, 52.26050899601501, 46.288008838308436, 52.40029787555922, 50.7099073251266, 48.557042165578906, 46.46058416312455, 49.021789182789064, 36.11715959807212, 44.275196753637644, 48.019038368220606, 44.46178946457683, 45.27609335260099, 35.468137751448864, 43.46132663937451, 50.39808454579486, 44.56347450569722, 53.96020531831258, 50.879069029833275, 51.31637531495907, 47.66100782153559, 47.43295783874715, 38.092598868303156, 49.065253970650666, 49.05223593393208, 40.818952727335265, 44.994165754903406, 39.752563537669715, 48.137363053521284, 46.996817817174865, 45.83283900080437, 51.55534928548722, 47.68025753517895, 49.17561850060389, 44.5528336829906, 49.559684168964914, 34.91755789185293, 49.9296769108061, 46.94530423992885, 42.1232596579118, 43.47135494038717, 34.962970121222874, 44.30804264417644, 51.83522519966459, 43.89794897564035, 49.005552802205834, 44.07316928291638, 42.59390785773565, 42.99106659485078, 44.46786947615208, 35.587818358813216, 50.234109511091255, 49.20711928892783], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.828448743524213, "mean_inference_ms": 8.19125138524578, "mean_action_processing_ms": 0.5744000390126851, "mean_env_wait_ms": 24.654634949718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0377345085144043, "StateBufferConnector_ms": 0.036759376525878906, "ViewRequirementAgentConnector_ms": 1.1228663921356201}}, "episode_reward_max": 54.33764580605823, "episode_reward_min": 33.91440662911835, "episode_reward_mean": 45.916539240871735, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.78494444626205, 49.37491321855517, 45.01864824674724, 44.75467693486867, 36.59354940411939, 44.51966770229334, 49.72308753415261, 44.17225288702838, 48.344387985215214, 44.42723617881756, 46.89840727117269, 48.01509972677161, 46.50613879932655, 38.04401269747665, 46.84512875054077, 50.19503136620695, 44.01502085397121, 42.12055922166585, 39.1412811379853, 43.63254493041992, 49.293011536172074, 44.127080929897346, 50.27069953212888, 45.73606786105556, 51.2149625745561, 47.61159610186181, 49.494365743339074, 33.91440662911835, 53.02812753323003, 48.274389665150245, 47.22298265355777, 43.33552482344929, 39.312973883180696, 47.03024722736914, 51.40911852003619, 45.80865224112814, 48.74259689974284, 49.772599098091014, 54.33764580605823, 47.315844829178864, 45.860113067528275, 38.11795077970051, 50.6413632737056, 52.21254040228807, 44.48921509524505, 47.455373747976545, 38.36592785812457, 44.32541403958849, 52.26050899601501, 46.288008838308436, 52.40029787555922, 50.7099073251266, 48.557042165578906, 46.46058416312455, 49.021789182789064, 36.11715959807212, 44.275196753637644, 48.019038368220606, 44.46178946457683, 45.27609335260099, 35.468137751448864, 43.46132663937451, 50.39808454579486, 44.56347450569722, 53.96020531831258, 50.879069029833275, 51.31637531495907, 47.66100782153559, 47.43295783874715, 38.092598868303156, 49.065253970650666, 49.05223593393208, 40.818952727335265, 44.994165754903406, 39.752563537669715, 48.137363053521284, 46.996817817174865, 45.83283900080437, 51.55534928548722, 47.68025753517895, 49.17561850060389, 44.5528336829906, 49.559684168964914, 34.91755789185293, 49.9296769108061, 46.94530423992885, 42.1232596579118, 43.47135494038717, 34.962970121222874, 44.30804264417644, 51.83522519966459, 43.89794897564035, 49.005552802205834, 44.07316928291638, 42.59390785773565, 42.99106659485078, 44.46786947615208, 35.587818358813216, 50.234109511091255, 49.20711928892783], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.828448743524213, "mean_inference_ms": 8.19125138524578, "mean_action_processing_ms": 0.5744000390126851, "mean_env_wait_ms": 24.654634949718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0377345085144043, "StateBufferConnector_ms": 0.036759376525878906, "ViewRequirementAgentConnector_ms": 1.1228663921356201}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2674368, "num_agent_steps_trained": 2674368, "num_env_steps_sampled": 2674368, "num_env_steps_trained": 2674368, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 209.56086695776085, "num_env_steps_trained_throughput_per_sec": 209.56086695776085, "timesteps_total": 2674368, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2674368, "timers": {"training_iteration_time_ms": 76719.266, "sample_time_ms": 48464.876, "load_time_ms": 3696.283, "load_throughput": 4230.736, "learn_time_ms": 23857.768, "learn_throughput": 655.468, "synch_weights_time_ms": 536.366}, "counters": {"num_env_steps_sampled": 2674368, "num_env_steps_trained": 2674368, "num_agent_steps_sampled": 2674368, "num_agent_steps_trained": 2674368}, "done": false, "episodes_total": 2508, "training_iteration": 179, "trial_id": "837cb_00000", "date": "2025-06-07_20-50-10", "timestamp": 1749322210, "time_this_iter_s": 74.64369320869446, "time_total_s": 12253.026190757751, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 12253.026190757751, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 68.26666666666665, "ram_util_percent": 90.0345238095238, "gpu_util_percent0": 0.2042857142857143, "vram_util_percent0": 0.9650065104166669}}
{"evaluation": {"sampler_results": {"episode_reward_max": 0.46728516732641917, "episode_reward_min": 0.15528157703110784, "episode_reward_mean": 0.280172938164596, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.46728516732641917, 0.15528157703110784, 0.2787650823567725, 0.17601671582618256, 0.323516148282498], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8530158588876326, "mean_inference_ms": 4.011409912238366, "mean_action_processing_ms": 0.29006868692622306, "mean_env_wait_ms": 12.389883558269744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2738332748413086}}, "episode_reward_max": 0.46728516732641917, "episode_reward_min": 0.15528157703110784, "episode_reward_mean": 0.280172938164596, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.46728516732641917, 0.15528157703110784, 0.2787650823567725, 0.17601671582618256, 0.323516148282498], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8530158588876326, "mean_inference_ms": 4.011409912238366, "mean_action_processing_ms": 0.29006868692622306, "mean_env_wait_ms": 12.389883558269744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2738332748413086}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.325631999999999e-05, "total_loss": -0.06059470911933617, "policy_loss": -0.022871382056566126, "vf_loss": 0.012789696650579573, "vf_explained_var": 0.9662742900848389, "kl": 0.02176290998379064, "entropy": 17.24786629590121, "entropy_coeff": 0.0024884480000000003}, "model": {}, "num_grad_updates_lifetime": 94365.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2690006, "num_env_steps_trained": 2690006, "num_agent_steps_sampled": 2690006, "num_agent_steps_trained": 2690006}, "sampler_results": {"episode_reward_max": 54.33764580605823, "episode_reward_min": 33.91440662911835, "episode_reward_mean": 45.931000134448055, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.84512875054077, 50.19503136620695, 44.01502085397121, 42.12055922166585, 39.1412811379853, 43.63254493041992, 49.293011536172074, 44.127080929897346, 50.27069953212888, 45.73606786105556, 51.2149625745561, 47.61159610186181, 49.494365743339074, 33.91440662911835, 53.02812753323003, 48.274389665150245, 47.22298265355777, 43.33552482344929, 39.312973883180696, 47.03024722736914, 51.40911852003619, 45.80865224112814, 48.74259689974284, 49.772599098091014, 54.33764580605823, 47.315844829178864, 45.860113067528275, 38.11795077970051, 50.6413632737056, 52.21254040228807, 44.48921509524505, 47.455373747976545, 38.36592785812457, 44.32541403958849, 52.26050899601501, 46.288008838308436, 52.40029787555922, 50.7099073251266, 48.557042165578906, 46.46058416312455, 49.021789182789064, 36.11715959807212, 44.275196753637644, 48.019038368220606, 44.46178946457683, 45.27609335260099, 35.468137751448864, 43.46132663937451, 50.39808454579486, 44.56347450569722, 53.96020531831258, 50.879069029833275, 51.31637531495907, 47.66100782153559, 47.43295783874715, 38.092598868303156, 49.065253970650666, 49.05223593393208, 40.818952727335265, 44.994165754903406, 39.752563537669715, 48.137363053521284, 46.996817817174865, 45.83283900080437, 51.55534928548722, 47.68025753517895, 49.17561850060389, 44.5528336829906, 49.559684168964914, 34.91755789185293, 49.9296769108061, 46.94530423992885, 42.1232596579118, 43.47135494038717, 34.962970121222874, 44.30804264417644, 51.83522519966459, 43.89794897564035, 49.005552802205834, 44.07316928291638, 42.59390785773565, 42.99106659485078, 44.46786947615208, 35.587818358813216, 50.234109511091255, 49.20711928892783, 42.83104344215825, 45.35327090217252, 34.6487814174062, 43.2784575079267, 51.69439347383609, 44.89309048649432, 48.04920610592885, 47.45822246922355, 47.86474891687147, 47.070217847155895, 46.27111912483302, 35.84213545695921, 50.283358648096105, 48.08506659137671], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.829996097920361, "mean_inference_ms": 8.20018071166216, "mean_action_processing_ms": 0.5749383137422976, "mean_env_wait_ms": 24.6748586596149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032614946365356445, "StateBufferConnector_ms": 0.03467535972595215, "ViewRequirementAgentConnector_ms": 1.163036823272705}}, "episode_reward_max": 54.33764580605823, "episode_reward_min": 33.91440662911835, "episode_reward_mean": 45.931000134448055, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.84512875054077, 50.19503136620695, 44.01502085397121, 42.12055922166585, 39.1412811379853, 43.63254493041992, 49.293011536172074, 44.127080929897346, 50.27069953212888, 45.73606786105556, 51.2149625745561, 47.61159610186181, 49.494365743339074, 33.91440662911835, 53.02812753323003, 48.274389665150245, 47.22298265355777, 43.33552482344929, 39.312973883180696, 47.03024722736914, 51.40911852003619, 45.80865224112814, 48.74259689974284, 49.772599098091014, 54.33764580605823, 47.315844829178864, 45.860113067528275, 38.11795077970051, 50.6413632737056, 52.21254040228807, 44.48921509524505, 47.455373747976545, 38.36592785812457, 44.32541403958849, 52.26050899601501, 46.288008838308436, 52.40029787555922, 50.7099073251266, 48.557042165578906, 46.46058416312455, 49.021789182789064, 36.11715959807212, 44.275196753637644, 48.019038368220606, 44.46178946457683, 45.27609335260099, 35.468137751448864, 43.46132663937451, 50.39808454579486, 44.56347450569722, 53.96020531831258, 50.879069029833275, 51.31637531495907, 47.66100782153559, 47.43295783874715, 38.092598868303156, 49.065253970650666, 49.05223593393208, 40.818952727335265, 44.994165754903406, 39.752563537669715, 48.137363053521284, 46.996817817174865, 45.83283900080437, 51.55534928548722, 47.68025753517895, 49.17561850060389, 44.5528336829906, 49.559684168964914, 34.91755789185293, 49.9296769108061, 46.94530423992885, 42.1232596579118, 43.47135494038717, 34.962970121222874, 44.30804264417644, 51.83522519966459, 43.89794897564035, 49.005552802205834, 44.07316928291638, 42.59390785773565, 42.99106659485078, 44.46786947615208, 35.587818358813216, 50.234109511091255, 49.20711928892783, 42.83104344215825, 45.35327090217252, 34.6487814174062, 43.2784575079267, 51.69439347383609, 44.89309048649432, 48.04920610592885, 47.45822246922355, 47.86474891687147, 47.070217847155895, 46.27111912483302, 35.84213545695921, 50.283358648096105, 48.08506659137671], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.829996097920361, "mean_inference_ms": 8.20018071166216, "mean_action_processing_ms": 0.5749383137422976, "mean_env_wait_ms": 24.6748586596149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032614946365356445, "StateBufferConnector_ms": 0.03467535972595215, "ViewRequirementAgentConnector_ms": 1.163036823272705}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2690006, "num_agent_steps_trained": 2690006, "num_env_steps_sampled": 2690006, "num_env_steps_trained": 2690006, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 198.3785124457761, "num_env_steps_trained_throughput_per_sec": 198.3785124457761, "timesteps_total": 2690006, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2690006, "timers": {"training_iteration_time_ms": 77145.552, "sample_time_ms": 48902.073, "load_time_ms": 3675.755, "load_throughput": 4254.365, "learn_time_ms": 23865.77, "learn_throughput": 655.248, "synch_weights_time_ms": 538.229}, "counters": {"num_env_steps_sampled": 2690006, "num_env_steps_trained": 2690006, "num_agent_steps_sampled": 2690006, "num_agent_steps_trained": 2690006}, "done": false, "episodes_total": 2522, "training_iteration": 180, "trial_id": "837cb_00000", "date": "2025-06-07_20-51-46", "timestamp": 1749322306, "time_this_iter_s": 95.6349823474884, "time_total_s": 12348.66117310524, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 12348.66117310524, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 60.06666666666666, "ram_util_percent": 89.15882352941173, "gpu_util_percent0": 0.17284313725490194, "vram_util_percent0": 0.9650065104166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.309994000000001e-05, "total_loss": -0.04710781009444459, "policy_loss": -0.009741902927655081, "vf_loss": 0.012198614391752264, "vf_explained_var": 0.9693272149562836, "kl": 0.022909694690879015, "entropy": 17.224138922257858, "entropy_coeff": 0.0024649909999999997}, "model": {}, "num_grad_updates_lifetime": 94915.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2705644, "num_env_steps_trained": 2705644, "num_agent_steps_sampled": 2705644, "num_agent_steps_trained": 2705644}, "sampler_results": {"episode_reward_max": 54.33764580605823, "episode_reward_min": 34.6487814174062, "episode_reward_mean": 45.96543447951387, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.02812753323003, 48.274389665150245, 47.22298265355777, 43.33552482344929, 39.312973883180696, 47.03024722736914, 51.40911852003619, 45.80865224112814, 48.74259689974284, 49.772599098091014, 54.33764580605823, 47.315844829178864, 45.860113067528275, 38.11795077970051, 50.6413632737056, 52.21254040228807, 44.48921509524505, 47.455373747976545, 38.36592785812457, 44.32541403958849, 52.26050899601501, 46.288008838308436, 52.40029787555922, 50.7099073251266, 48.557042165578906, 46.46058416312455, 49.021789182789064, 36.11715959807212, 44.275196753637644, 48.019038368220606, 44.46178946457683, 45.27609335260099, 35.468137751448864, 43.46132663937451, 50.39808454579486, 44.56347450569722, 53.96020531831258, 50.879069029833275, 51.31637531495907, 47.66100782153559, 47.43295783874715, 38.092598868303156, 49.065253970650666, 49.05223593393208, 40.818952727335265, 44.994165754903406, 39.752563537669715, 48.137363053521284, 46.996817817174865, 45.83283900080437, 51.55534928548722, 47.68025753517895, 49.17561850060389, 44.5528336829906, 49.559684168964914, 34.91755789185293, 49.9296769108061, 46.94530423992885, 42.1232596579118, 43.47135494038717, 34.962970121222874, 44.30804264417644, 51.83522519966459, 43.89794897564035, 49.005552802205834, 44.07316928291638, 42.59390785773565, 42.99106659485078, 44.46786947615208, 35.587818358813216, 50.234109511091255, 49.20711928892783, 42.83104344215825, 45.35327090217252, 34.6487814174062, 43.2784575079267, 51.69439347383609, 44.89309048649432, 48.04920610592885, 47.45822246922355, 47.86474891687147, 47.070217847155895, 46.27111912483302, 35.84213545695921, 50.283358648096105, 48.08506659137671, 45.45815143681359, 45.80829659089955, 36.876666685464464, 46.90077563047105, 46.21863065749306, 45.2391036917429, 50.3595590937316, 44.11293715684414, 49.58766017117146, 49.13541487835872, 44.62015245583157, 38.746477897598474, 49.07618218063743, 48.91518314844353], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8315148393139693, "mean_inference_ms": 8.208032220291726, "mean_action_processing_ms": 0.5754288133092739, "mean_env_wait_ms": 24.69488742277331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03367447853088379, "StateBufferConnector_ms": 0.036635637283325195, "ViewRequirementAgentConnector_ms": 1.1590466499328613}}, "episode_reward_max": 54.33764580605823, "episode_reward_min": 34.6487814174062, "episode_reward_mean": 45.96543447951387, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [53.02812753323003, 48.274389665150245, 47.22298265355777, 43.33552482344929, 39.312973883180696, 47.03024722736914, 51.40911852003619, 45.80865224112814, 48.74259689974284, 49.772599098091014, 54.33764580605823, 47.315844829178864, 45.860113067528275, 38.11795077970051, 50.6413632737056, 52.21254040228807, 44.48921509524505, 47.455373747976545, 38.36592785812457, 44.32541403958849, 52.26050899601501, 46.288008838308436, 52.40029787555922, 50.7099073251266, 48.557042165578906, 46.46058416312455, 49.021789182789064, 36.11715959807212, 44.275196753637644, 48.019038368220606, 44.46178946457683, 45.27609335260099, 35.468137751448864, 43.46132663937451, 50.39808454579486, 44.56347450569722, 53.96020531831258, 50.879069029833275, 51.31637531495907, 47.66100782153559, 47.43295783874715, 38.092598868303156, 49.065253970650666, 49.05223593393208, 40.818952727335265, 44.994165754903406, 39.752563537669715, 48.137363053521284, 46.996817817174865, 45.83283900080437, 51.55534928548722, 47.68025753517895, 49.17561850060389, 44.5528336829906, 49.559684168964914, 34.91755789185293, 49.9296769108061, 46.94530423992885, 42.1232596579118, 43.47135494038717, 34.962970121222874, 44.30804264417644, 51.83522519966459, 43.89794897564035, 49.005552802205834, 44.07316928291638, 42.59390785773565, 42.99106659485078, 44.46786947615208, 35.587818358813216, 50.234109511091255, 49.20711928892783, 42.83104344215825, 45.35327090217252, 34.6487814174062, 43.2784575079267, 51.69439347383609, 44.89309048649432, 48.04920610592885, 47.45822246922355, 47.86474891687147, 47.070217847155895, 46.27111912483302, 35.84213545695921, 50.283358648096105, 48.08506659137671, 45.45815143681359, 45.80829659089955, 36.876666685464464, 46.90077563047105, 46.21863065749306, 45.2391036917429, 50.3595590937316, 44.11293715684414, 49.58766017117146, 49.13541487835872, 44.62015245583157, 38.746477897598474, 49.07618218063743, 48.91518314844353], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8315148393139693, "mean_inference_ms": 8.208032220291726, "mean_action_processing_ms": 0.5754288133092739, "mean_env_wait_ms": 24.69488742277331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03367447853088379, "StateBufferConnector_ms": 0.036635637283325195, "ViewRequirementAgentConnector_ms": 1.1590466499328613}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2705644, "num_agent_steps_trained": 2705644, "num_env_steps_sampled": 2705644, "num_env_steps_trained": 2705644, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 218.52513194444327, "num_env_steps_trained_throughput_per_sec": 218.52513194444327, "timesteps_total": 2705644, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2705644, "timers": {"training_iteration_time_ms": 76927.05, "sample_time_ms": 48732.493, "load_time_ms": 3634.037, "load_throughput": 4303.203, "learn_time_ms": 23865.781, "learn_throughput": 655.248, "synch_weights_time_ms": 529.305}, "counters": {"num_env_steps_sampled": 2705644, "num_env_steps_trained": 2705644, "num_agent_steps_sampled": 2705644, "num_agent_steps_trained": 2705644}, "done": false, "episodes_total": 2536, "training_iteration": 181, "trial_id": "837cb_00000", "date": "2025-06-07_20-52-58", "timestamp": 1749322378, "time_this_iter_s": 71.5825765132904, "time_total_s": 12420.24374961853, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 12420.24374961853, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 68.25679012345678, "ram_util_percent": 87.31728395061728, "gpu_util_percent0": 0.2101234567901234, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.294356000000001e-05, "total_loss": -0.0626688139015724, "policy_loss": -0.02560723156139085, "vf_loss": 0.012256621861068363, "vf_explained_var": 0.9664604365825653, "kl": 0.0218135327991331, "entropy": 17.244041401256215, "entropy_coeff": 0.002441534}, "model": {}, "num_grad_updates_lifetime": 95465.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2721282, "num_env_steps_trained": 2721282, "num_agent_steps_sampled": 2721282, "num_agent_steps_trained": 2721282}, "sampler_results": {"episode_reward_max": 53.96020531831258, "episode_reward_min": 34.6487814174062, "episode_reward_mean": 45.81427646979885, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.6413632737056, 52.21254040228807, 44.48921509524505, 47.455373747976545, 38.36592785812457, 44.32541403958849, 52.26050899601501, 46.288008838308436, 52.40029787555922, 50.7099073251266, 48.557042165578906, 46.46058416312455, 49.021789182789064, 36.11715959807212, 44.275196753637644, 48.019038368220606, 44.46178946457683, 45.27609335260099, 35.468137751448864, 43.46132663937451, 50.39808454579486, 44.56347450569722, 53.96020531831258, 50.879069029833275, 51.31637531495907, 47.66100782153559, 47.43295783874715, 38.092598868303156, 49.065253970650666, 49.05223593393208, 40.818952727335265, 44.994165754903406, 39.752563537669715, 48.137363053521284, 46.996817817174865, 45.83283900080437, 51.55534928548722, 47.68025753517895, 49.17561850060389, 44.5528336829906, 49.559684168964914, 34.91755789185293, 49.9296769108061, 46.94530423992885, 42.1232596579118, 43.47135494038717, 34.962970121222874, 44.30804264417644, 51.83522519966459, 43.89794897564035, 49.005552802205834, 44.07316928291638, 42.59390785773565, 42.99106659485078, 44.46786947615208, 35.587818358813216, 50.234109511091255, 49.20711928892783, 42.83104344215825, 45.35327090217252, 34.6487814174062, 43.2784575079267, 51.69439347383609, 44.89309048649432, 48.04920610592885, 47.45822246922355, 47.86474891687147, 47.070217847155895, 46.27111912483302, 35.84213545695921, 50.283358648096105, 48.08506659137671, 45.45815143681359, 45.80829659089955, 36.876666685464464, 46.90077563047105, 46.21863065749306, 45.2391036917429, 50.3595590937316, 44.11293715684414, 49.58766017117146, 49.13541487835872, 44.62015245583157, 38.746477897598474, 49.07618218063743, 48.91518314844353, 45.32788519024689, 46.574458912793865, 38.22190505449964, 46.1460798498561, 48.918858755759715, 44.82239598635792, 49.65672942916067, 47.119197687701025, 48.85363159090219, 48.13062953760575, 49.6716615349342, 36.8432633004368, 46.22499199121094, 47.94127723443232], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.832654603222313, "mean_inference_ms": 8.214990438969991, "mean_action_processing_ms": 0.5758651677051332, "mean_env_wait_ms": 24.714502411974976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03666996955871582, "StateBufferConnector_ms": 0.035676002502441406, "ViewRequirementAgentConnector_ms": 1.144428014755249}}, "episode_reward_max": 53.96020531831258, "episode_reward_min": 34.6487814174062, "episode_reward_mean": 45.81427646979885, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [50.6413632737056, 52.21254040228807, 44.48921509524505, 47.455373747976545, 38.36592785812457, 44.32541403958849, 52.26050899601501, 46.288008838308436, 52.40029787555922, 50.7099073251266, 48.557042165578906, 46.46058416312455, 49.021789182789064, 36.11715959807212, 44.275196753637644, 48.019038368220606, 44.46178946457683, 45.27609335260099, 35.468137751448864, 43.46132663937451, 50.39808454579486, 44.56347450569722, 53.96020531831258, 50.879069029833275, 51.31637531495907, 47.66100782153559, 47.43295783874715, 38.092598868303156, 49.065253970650666, 49.05223593393208, 40.818952727335265, 44.994165754903406, 39.752563537669715, 48.137363053521284, 46.996817817174865, 45.83283900080437, 51.55534928548722, 47.68025753517895, 49.17561850060389, 44.5528336829906, 49.559684168964914, 34.91755789185293, 49.9296769108061, 46.94530423992885, 42.1232596579118, 43.47135494038717, 34.962970121222874, 44.30804264417644, 51.83522519966459, 43.89794897564035, 49.005552802205834, 44.07316928291638, 42.59390785773565, 42.99106659485078, 44.46786947615208, 35.587818358813216, 50.234109511091255, 49.20711928892783, 42.83104344215825, 45.35327090217252, 34.6487814174062, 43.2784575079267, 51.69439347383609, 44.89309048649432, 48.04920610592885, 47.45822246922355, 47.86474891687147, 47.070217847155895, 46.27111912483302, 35.84213545695921, 50.283358648096105, 48.08506659137671, 45.45815143681359, 45.80829659089955, 36.876666685464464, 46.90077563047105, 46.21863065749306, 45.2391036917429, 50.3595590937316, 44.11293715684414, 49.58766017117146, 49.13541487835872, 44.62015245583157, 38.746477897598474, 49.07618218063743, 48.91518314844353, 45.32788519024689, 46.574458912793865, 38.22190505449964, 46.1460798498561, 48.918858755759715, 44.82239598635792, 49.65672942916067, 47.119197687701025, 48.85363159090219, 48.13062953760575, 49.6716615349342, 36.8432633004368, 46.22499199121094, 47.94127723443232], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.832654603222313, "mean_inference_ms": 8.214990438969991, "mean_action_processing_ms": 0.5758651677051332, "mean_env_wait_ms": 24.714502411974976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03666996955871582, "StateBufferConnector_ms": 0.035676002502441406, "ViewRequirementAgentConnector_ms": 1.144428014755249}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2721282, "num_agent_steps_trained": 2721282, "num_env_steps_sampled": 2721282, "num_env_steps_trained": 2721282, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 201.82941264354724, "num_env_steps_trained_throughput_per_sec": 201.82941264354724, "timesteps_total": 2721282, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2721282, "timers": {"training_iteration_time_ms": 76275.985, "sample_time_ms": 48474.547, "load_time_ms": 3396.131, "load_throughput": 4604.652, "learn_time_ms": 23741.669, "learn_throughput": 658.673, "synch_weights_time_ms": 519.31}, "counters": {"num_env_steps_sampled": 2721282, "num_env_steps_trained": 2721282, "num_agent_steps_sampled": 2721282, "num_agent_steps_trained": 2721282}, "done": false, "episodes_total": 2550, "training_iteration": 182, "trial_id": "837cb_00000", "date": "2025-06-07_20-54-15", "timestamp": 1749322455, "time_this_iter_s": 77.50846719741821, "time_total_s": 12497.752216815948, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 12497.752216815948, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 69.61264367816091, "ram_util_percent": 89.74252873563219, "gpu_util_percent0": 0.1985057471264368, "vram_util_percent0": 0.965006510416667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.278717999999998e-05, "total_loss": -0.07223703727380118, "policy_loss": -0.03531428523646768, "vf_loss": 0.011779345928860659, "vf_explained_var": 0.9686934286897833, "kl": 0.021511418972469526, "entropy": 17.286883874373004, "entropy_coeff": 0.0024180770000000007}, "model": {}, "num_grad_updates_lifetime": 96015.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2736920, "num_env_steps_trained": 2736920, "num_agent_steps_sampled": 2736920, "num_agent_steps_trained": 2736920}, "sampler_results": {"episode_reward_max": 53.96020531831258, "episode_reward_min": 34.6487814174062, "episode_reward_mean": 45.64125228375841, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.275196753637644, 48.019038368220606, 44.46178946457683, 45.27609335260099, 35.468137751448864, 43.46132663937451, 50.39808454579486, 44.56347450569722, 53.96020531831258, 50.879069029833275, 51.31637531495907, 47.66100782153559, 47.43295783874715, 38.092598868303156, 49.065253970650666, 49.05223593393208, 40.818952727335265, 44.994165754903406, 39.752563537669715, 48.137363053521284, 46.996817817174865, 45.83283900080437, 51.55534928548722, 47.68025753517895, 49.17561850060389, 44.5528336829906, 49.559684168964914, 34.91755789185293, 49.9296769108061, 46.94530423992885, 42.1232596579118, 43.47135494038717, 34.962970121222874, 44.30804264417644, 51.83522519966459, 43.89794897564035, 49.005552802205834, 44.07316928291638, 42.59390785773565, 42.99106659485078, 44.46786947615208, 35.587818358813216, 50.234109511091255, 49.20711928892783, 42.83104344215825, 45.35327090217252, 34.6487814174062, 43.2784575079267, 51.69439347383609, 44.89309048649432, 48.04920610592885, 47.45822246922355, 47.86474891687147, 47.070217847155895, 46.27111912483302, 35.84213545695921, 50.283358648096105, 48.08506659137671, 45.45815143681359, 45.80829659089955, 36.876666685464464, 46.90077563047105, 46.21863065749306, 45.2391036917429, 50.3595590937316, 44.11293715684414, 49.58766017117146, 49.13541487835872, 44.62015245583157, 38.746477897598474, 49.07618218063743, 48.91518314844353, 45.32788519024689, 46.574458912793865, 38.22190505449964, 46.1460798498561, 48.918858755759715, 44.82239598635792, 49.65672942916067, 47.119197687701025, 48.85363159090219, 48.13062953760575, 49.6716615349342, 36.8432633004368, 46.22499199121094, 47.94127723443232, 45.42036350817693, 45.03076343025328, 38.928198734172554, 42.66113593768997, 49.44264464354503, 45.76165954662326, 53.254268194748846, 48.72015777778921, 45.37567342498559, 48.006784785287515, 48.01222640861118, 35.37523117608533, 47.969281680233486, 48.04432470925607], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8337223062035726, "mean_inference_ms": 8.219893282499386, "mean_action_processing_ms": 0.5761753136401135, "mean_env_wait_ms": 24.73086305355798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040593862533569336, "StateBufferConnector_ms": 0.0376431941986084, "ViewRequirementAgentConnector_ms": 1.0940046310424805}}, "episode_reward_max": 53.96020531831258, "episode_reward_min": 34.6487814174062, "episode_reward_mean": 45.64125228375841, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.275196753637644, 48.019038368220606, 44.46178946457683, 45.27609335260099, 35.468137751448864, 43.46132663937451, 50.39808454579486, 44.56347450569722, 53.96020531831258, 50.879069029833275, 51.31637531495907, 47.66100782153559, 47.43295783874715, 38.092598868303156, 49.065253970650666, 49.05223593393208, 40.818952727335265, 44.994165754903406, 39.752563537669715, 48.137363053521284, 46.996817817174865, 45.83283900080437, 51.55534928548722, 47.68025753517895, 49.17561850060389, 44.5528336829906, 49.559684168964914, 34.91755789185293, 49.9296769108061, 46.94530423992885, 42.1232596579118, 43.47135494038717, 34.962970121222874, 44.30804264417644, 51.83522519966459, 43.89794897564035, 49.005552802205834, 44.07316928291638, 42.59390785773565, 42.99106659485078, 44.46786947615208, 35.587818358813216, 50.234109511091255, 49.20711928892783, 42.83104344215825, 45.35327090217252, 34.6487814174062, 43.2784575079267, 51.69439347383609, 44.89309048649432, 48.04920610592885, 47.45822246922355, 47.86474891687147, 47.070217847155895, 46.27111912483302, 35.84213545695921, 50.283358648096105, 48.08506659137671, 45.45815143681359, 45.80829659089955, 36.876666685464464, 46.90077563047105, 46.21863065749306, 45.2391036917429, 50.3595590937316, 44.11293715684414, 49.58766017117146, 49.13541487835872, 44.62015245583157, 38.746477897598474, 49.07618218063743, 48.91518314844353, 45.32788519024689, 46.574458912793865, 38.22190505449964, 46.1460798498561, 48.918858755759715, 44.82239598635792, 49.65672942916067, 47.119197687701025, 48.85363159090219, 48.13062953760575, 49.6716615349342, 36.8432633004368, 46.22499199121094, 47.94127723443232, 45.42036350817693, 45.03076343025328, 38.928198734172554, 42.66113593768997, 49.44264464354503, 45.76165954662326, 53.254268194748846, 48.72015777778921, 45.37567342498559, 48.006784785287515, 48.01222640861118, 35.37523117608533, 47.969281680233486, 48.04432470925607], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8337223062035726, "mean_inference_ms": 8.219893282499386, "mean_action_processing_ms": 0.5761753136401135, "mean_env_wait_ms": 24.73086305355798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040593862533569336, "StateBufferConnector_ms": 0.0376431941986084, "ViewRequirementAgentConnector_ms": 1.0940046310424805}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2736920, "num_agent_steps_trained": 2736920, "num_env_steps_sampled": 2736920, "num_env_steps_trained": 2736920, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 220.2806335034834, "num_env_steps_trained_throughput_per_sec": 220.2806335034834, "timesteps_total": 2736920, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2736920, "timers": {"training_iteration_time_ms": 75918.865, "sample_time_ms": 48109.593, "load_time_ms": 3371.892, "load_throughput": 4637.753, "learn_time_ms": 23777.019, "learn_throughput": 657.694, "synch_weights_time_ms": 515.532}, "counters": {"num_env_steps_sampled": 2736920, "num_env_steps_trained": 2736920, "num_agent_steps_sampled": 2736920, "num_agent_steps_trained": 2736920}, "done": false, "episodes_total": 2564, "training_iteration": 183, "trial_id": "837cb_00000", "date": "2025-06-07_20-55-26", "timestamp": 1749322526, "time_this_iter_s": 71.00926804542542, "time_total_s": 12568.761484861374, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 12568.761484861374, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 68.20864197530864, "ram_util_percent": 88.57654320987655, "gpu_util_percent0": 0.21061728395061727, "vram_util_percent0": 0.9650065104166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 7.26308e-05, "total_loss": -0.049068994299000634, "policy_loss": -0.012725930973273618, "vf_loss": 0.012143774019046264, "vf_explained_var": 0.9687154366753318, "kl": 0.021492132438420825, "entropy": 17.259294619126752, "entropy_coeff": 0.00239462}, "model": {}, "num_grad_updates_lifetime": 96565.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2752558, "num_env_steps_trained": 2752558, "num_agent_steps_sampled": 2752558, "num_agent_steps_trained": 2752558}, "sampler_results": {"episode_reward_max": 53.254268194748846, "episode_reward_min": 34.14688773814928, "episode_reward_mean": 45.601749421859765, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.065253970650666, 49.05223593393208, 40.818952727335265, 44.994165754903406, 39.752563537669715, 48.137363053521284, 46.996817817174865, 45.83283900080437, 51.55534928548722, 47.68025753517895, 49.17561850060389, 44.5528336829906, 49.559684168964914, 34.91755789185293, 49.9296769108061, 46.94530423992885, 42.1232596579118, 43.47135494038717, 34.962970121222874, 44.30804264417644, 51.83522519966459, 43.89794897564035, 49.005552802205834, 44.07316928291638, 42.59390785773565, 42.99106659485078, 44.46786947615208, 35.587818358813216, 50.234109511091255, 49.20711928892783, 42.83104344215825, 45.35327090217252, 34.6487814174062, 43.2784575079267, 51.69439347383609, 44.89309048649432, 48.04920610592885, 47.45822246922355, 47.86474891687147, 47.070217847155895, 46.27111912483302, 35.84213545695921, 50.283358648096105, 48.08506659137671, 45.45815143681359, 45.80829659089955, 36.876666685464464, 46.90077563047105, 46.21863065749306, 45.2391036917429, 50.3595590937316, 44.11293715684414, 49.58766017117146, 49.13541487835872, 44.62015245583157, 38.746477897598474, 49.07618218063743, 48.91518314844353, 45.32788519024689, 46.574458912793865, 38.22190505449964, 46.1460798498561, 48.918858755759715, 44.82239598635792, 49.65672942916067, 47.119197687701025, 48.85363159090219, 48.13062953760575, 49.6716615349342, 36.8432633004368, 46.22499199121094, 47.94127723443232, 45.42036350817693, 45.03076343025328, 38.928198734172554, 42.66113593768997, 49.44264464354503, 45.76165954662326, 53.254268194748846, 48.72015777778921, 45.37567342498559, 48.006784785287515, 48.01222640861118, 35.37523117608533, 47.969281680233486, 48.04432470925607, 44.904433620775215, 48.544955688288724, 38.63760715226651, 46.25975241559842, 51.512797499397124, 44.03402493180077, 51.58762950951317, 44.751144428133664, 44.8360897783807, 44.92262622699007, 46.13503023076586, 34.14688773814928, 50.72016649544794, 50.321923667671506], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8343616188379817, "mean_inference_ms": 8.223579208158197, "mean_action_processing_ms": 0.5764089759759371, "mean_env_wait_ms": 24.74589725986238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03961634635925293, "StateBufferConnector_ms": 0.025049686431884766, "ViewRequirementAgentConnector_ms": 1.068448781967163}}, "episode_reward_max": 53.254268194748846, "episode_reward_min": 34.14688773814928, "episode_reward_mean": 45.601749421859765, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [49.065253970650666, 49.05223593393208, 40.818952727335265, 44.994165754903406, 39.752563537669715, 48.137363053521284, 46.996817817174865, 45.83283900080437, 51.55534928548722, 47.68025753517895, 49.17561850060389, 44.5528336829906, 49.559684168964914, 34.91755789185293, 49.9296769108061, 46.94530423992885, 42.1232596579118, 43.47135494038717, 34.962970121222874, 44.30804264417644, 51.83522519966459, 43.89794897564035, 49.005552802205834, 44.07316928291638, 42.59390785773565, 42.99106659485078, 44.46786947615208, 35.587818358813216, 50.234109511091255, 49.20711928892783, 42.83104344215825, 45.35327090217252, 34.6487814174062, 43.2784575079267, 51.69439347383609, 44.89309048649432, 48.04920610592885, 47.45822246922355, 47.86474891687147, 47.070217847155895, 46.27111912483302, 35.84213545695921, 50.283358648096105, 48.08506659137671, 45.45815143681359, 45.80829659089955, 36.876666685464464, 46.90077563047105, 46.21863065749306, 45.2391036917429, 50.3595590937316, 44.11293715684414, 49.58766017117146, 49.13541487835872, 44.62015245583157, 38.746477897598474, 49.07618218063743, 48.91518314844353, 45.32788519024689, 46.574458912793865, 38.22190505449964, 46.1460798498561, 48.918858755759715, 44.82239598635792, 49.65672942916067, 47.119197687701025, 48.85363159090219, 48.13062953760575, 49.6716615349342, 36.8432633004368, 46.22499199121094, 47.94127723443232, 45.42036350817693, 45.03076343025328, 38.928198734172554, 42.66113593768997, 49.44264464354503, 45.76165954662326, 53.254268194748846, 48.72015777778921, 45.37567342498559, 48.006784785287515, 48.01222640861118, 35.37523117608533, 47.969281680233486, 48.04432470925607, 44.904433620775215, 48.544955688288724, 38.63760715226651, 46.25975241559842, 51.512797499397124, 44.03402493180077, 51.58762950951317, 44.751144428133664, 44.8360897783807, 44.92262622699007, 46.13503023076586, 34.14688773814928, 50.72016649544794, 50.321923667671506], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8343616188379817, "mean_inference_ms": 8.223579208158197, "mean_action_processing_ms": 0.5764089759759371, "mean_env_wait_ms": 24.74589725986238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03961634635925293, "StateBufferConnector_ms": 0.025049686431884766, "ViewRequirementAgentConnector_ms": 1.068448781967163}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2752558, "num_agent_steps_trained": 2752558, "num_env_steps_sampled": 2752558, "num_env_steps_trained": 2752558, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 219.72274853514625, "num_env_steps_trained_throughput_per_sec": 219.72274853514625, "timesteps_total": 2752558, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2752558, "timers": {"training_iteration_time_ms": 75661.052, "sample_time_ms": 47963.736, "load_time_ms": 3276.047, "load_throughput": 4773.436, "learn_time_ms": 23769.313, "learn_throughput": 657.907, "synch_weights_time_ms": 508.032}, "counters": {"num_env_steps_sampled": 2752558, "num_env_steps_trained": 2752558, "num_agent_steps_sampled": 2752558, "num_agent_steps_trained": 2752558}, "done": false, "episodes_total": 2578, "training_iteration": 184, "trial_id": "837cb_00000", "date": "2025-06-07_20-56-38", "timestamp": 1749322598, "time_this_iter_s": 71.1855046749115, "time_total_s": 12639.946989536285, "pid": 120180, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x00000225D34A7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 12639.946989536285, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 69.15, "ram_util_percent": 88.23536585365854, "gpu_util_percent0": 0.2076829268292683, "vram_util_percent0": 0.9650065104166667}}
