{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5, "cur_lr": 0.00010000000000000003, "total_loss": -0.11550191532905128, "policy_loss": -0.04565767121120271, "vf_loss": 0.2039832963692871, "vf_explained_var": 0.11161753074689344, "kl": 0.017372654314915238, "entropy": 13.972556049173528, "entropy_coeff": 0.009999999999999998}, "model": {}, "num_grad_updates_lifetime": 110.5, "diff_num_grad_updates_vs_sampler_policy": 109.5}}, "num_env_steps_sampled": 6327, "num_env_steps_trained": 6327, "num_agent_steps_sampled": 6327, "num_agent_steps_trained": 6327}, "sampler_results": {"episode_reward_max": -8.818392112182613, "episode_reward_min": -56.588359052188565, "episode_reward_mean": -27.27791334010021, "episode_len_mean": 451.92857142857144, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.823252372917182, -31.974379656962842, -46.59986083433812, -8.818392112182613, -19.442365067364403, -18.324091485037634, -56.588359052188565, -35.35557307711445, -22.446792148349566, -19.95685925473788, -52.62578300493693, -16.60700653287384, -22.17159401327684, -20.15647814912203], "episode_lengths": [269, 338, 728, 1117, 295, 260, 685, 761, 296, 297, 433, 279, 274, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.641193941635357, "mean_inference_ms": 7.113564689447043, "mean_action_processing_ms": 0.48971858960973425, "mean_env_wait_ms": 23.476504496918526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02902916499546596, "ViewRequirementAgentConnector_ms": 0.8038844381059919}}, "episode_reward_max": -8.818392112182613, "episode_reward_min": -56.588359052188565, "episode_reward_mean": -27.27791334010021, "episode_len_mean": 451.92857142857144, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.823252372917182, -31.974379656962842, -46.59986083433812, -8.818392112182613, -19.442365067364403, -18.324091485037634, -56.588359052188565, -35.35557307711445, -22.446792148349566, -19.95685925473788, -52.62578300493693, -16.60700653287384, -22.17159401327684, -20.15647814912203], "episode_lengths": [269, 338, 728, 1117, 295, 260, 685, 761, 296, 297, 433, 279, 274, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.641193941635357, "mean_inference_ms": 7.113564689447043, "mean_action_processing_ms": 0.48971858960973425, "mean_env_wait_ms": 23.476504496918526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02902916499546596, "ViewRequirementAgentConnector_ms": 0.8038844381059919}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6327, "num_agent_steps_trained": 6327, "num_env_steps_sampled": 6327, "num_env_steps_trained": 6327, "num_env_steps_sampled_this_iter": 6327, "num_env_steps_trained_this_iter": 6327, "num_env_steps_sampled_throughput_per_sec": 190.03790844077213, "num_env_steps_trained_throughput_per_sec": 190.03790844077213, "timesteps_total": 6327, "num_steps_trained_this_iter": 6327, "agent_timesteps_total": 6327, "timers": {"training_iteration_time_ms": 33293.357, "sample_time_ms": 26063.847, "load_time_ms": 1742.308, "load_throughput": 3631.391, "learn_time_ms": 5006.986, "learn_throughput": 1263.634, "synch_weights_time_ms": 433.699}, "counters": {"num_env_steps_sampled": 6327, "num_env_steps_trained": 6327, "num_agent_steps_sampled": 6327, "num_agent_steps_trained": 6327}, "done": false, "episodes_total": 14, "training_iteration": 1, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-35-53", "timestamp": 1749299753, "time_this_iter_s": 33.310362100601196, "time_total_s": 33.310362100601196, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 33.310362100601196, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 52.443902439024384, "ram_util_percent": 58.38780487804877, "gpu_util_percent0": 0.04926829268292683, "vram_util_percent0": 0.05618410188008131}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5, "cur_lr": 9.993673000000001e-05, "total_loss": -0.14074385116497676, "policy_loss": -0.05379651008115616, "vf_loss": 0.16133826687388744, "vf_explained_var": 0.4448204912245274, "kl": 0.007996504271492962, "entropy": 13.978930167357127, "entropy_coeff": 0.009968365000000003}, "model": {}, "num_grad_updates_lifetime": 340.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 13259, "num_env_steps_trained": 13259, "num_agent_steps_sampled": 13259, "num_agent_steps_trained": 13259}, "sampler_results": {"episode_reward_max": 21.913888606463537, "episode_reward_min": -56.588359052188565, "episode_reward_mean": -17.071049756106813, "episode_len_mean": 473.5357142857143, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.823252372917182, -31.974379656962842, -46.59986083433812, -8.818392112182613, -19.442365067364403, -18.324091485037634, -56.588359052188565, -35.35557307711445, -22.446792148349566, -19.95685925473788, -52.62578300493693, -16.60700653287384, -22.17159401327684, -20.15647814912203, -13.535618208461981, -7.516993422718009, 6.643994864169072, -32.45828975994229, 2.780915032547828, -31.515988933763804, 21.913888606463537, -1.1852211537190733, 3.148783541351875, -23.767608686262957, 12.183215351772295, -6.179957914901087, -20.664948140755577, -5.944777585367666], "episode_lengths": [269, 338, 728, 1117, 295, 260, 685, 761, 296, 297, 433, 279, 274, 295, 747, 803, 395, 553, 148, 646, 799, 496, 151, 439, 259, 317, 798, 381]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.542133683129012, "mean_inference_ms": 7.163401822259123, "mean_action_processing_ms": 0.5036341313012811, "mean_env_wait_ms": 23.01367488121946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007150854383196149, "StateBufferConnector_ms": 0.025291953768048967, "ViewRequirementAgentConnector_ms": 0.781473091670445}}, "episode_reward_max": 21.913888606463537, "episode_reward_min": -56.588359052188565, "episode_reward_mean": -17.071049756106813, "episode_len_mean": 473.5357142857143, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.823252372917182, -31.974379656962842, -46.59986083433812, -8.818392112182613, -19.442365067364403, -18.324091485037634, -56.588359052188565, -35.35557307711445, -22.446792148349566, -19.95685925473788, -52.62578300493693, -16.60700653287384, -22.17159401327684, -20.15647814912203, -13.535618208461981, -7.516993422718009, 6.643994864169072, -32.45828975994229, 2.780915032547828, -31.515988933763804, 21.913888606463537, -1.1852211537190733, 3.148783541351875, -23.767608686262957, 12.183215351772295, -6.179957914901087, -20.664948140755577, -5.944777585367666], "episode_lengths": [269, 338, 728, 1117, 295, 260, 685, 761, 296, 297, 433, 279, 274, 295, 747, 803, 395, 553, 148, 646, 799, 496, 151, 439, 259, 317, 798, 381]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.542133683129012, "mean_inference_ms": 7.163401822259123, "mean_action_processing_ms": 0.5036341313012811, "mean_env_wait_ms": 23.01367488121946, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007150854383196149, "StateBufferConnector_ms": 0.025291953768048967, "ViewRequirementAgentConnector_ms": 0.781473091670445}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13259, "num_agent_steps_trained": 13259, "num_env_steps_sampled": 13259, "num_env_steps_trained": 13259, "num_env_steps_sampled_this_iter": 6932, "num_env_steps_trained_this_iter": 6932, "num_env_steps_sampled_throughput_per_sec": 230.81533428659483, "num_env_steps_trained_throughput_per_sec": 230.81533428659483, "timesteps_total": 13259, "num_steps_trained_this_iter": 6932, "agent_timesteps_total": 13259, "timers": {"training_iteration_time_ms": 31663.012, "sample_time_ms": 25128.243, "load_time_ms": 1276.366, "load_throughput": 5194.045, "learn_time_ms": 4794.417, "learn_throughput": 1382.754, "synch_weights_time_ms": 415.729}, "counters": {"num_env_steps_sampled": 13259, "num_env_steps_trained": 13259, "num_agent_steps_sampled": 13259, "num_agent_steps_trained": 13259}, "done": false, "episodes_total": 28, "training_iteration": 2, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-36-23", "timestamp": 1749299783, "time_this_iter_s": 30.048692226409912, "time_total_s": 63.35905432701111, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 63.35905432701111, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 70.23428571428572, "ram_util_percent": 61.265714285714274, "gpu_util_percent0": 0.04828571428571429, "vram_util_percent0": 0.24182012648809526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5, "cur_lr": 9.986740999999999e-05, "total_loss": -0.11319308899560823, "policy_loss": -0.010248845023283314, "vf_loss": 0.10838340584549212, "vf_explained_var": 0.7021727298536609, "kl": 0.007113643857273048, "entropy": 13.994384596424718, "entropy_coeff": 0.009933705000000001}, "model": {}, "num_grad_updates_lifetime": 615.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 21941, "num_env_steps_trained": 21941, "num_agent_steps_sampled": 21941, "num_agent_steps_trained": 21941}, "sampler_results": {"episode_reward_max": 27.175061037558542, "episode_reward_min": -56.588359052188565, "episode_reward_mean": -9.925249711454782, "episode_len_mean": 522.4047619047619, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.823252372917182, -31.974379656962842, -46.59986083433812, -8.818392112182613, -19.442365067364403, -18.324091485037634, -56.588359052188565, -35.35557307711445, -22.446792148349566, -19.95685925473788, -52.62578300493693, -16.60700653287384, -22.17159401327684, -20.15647814912203, -13.535618208461981, -7.516993422718009, 6.643994864169072, -32.45828975994229, 2.780915032547828, -31.515988933763804, 21.913888606463537, -1.1852211537190733, 3.148783541351875, -23.767608686262957, 12.183215351772295, -6.179957914901087, -20.664948140755577, -5.944777585367666, -5.019983241257129, 15.851833074551, 27.175061037558542, 9.6397751620956, -6.079646569768005, 25.540432466426097, 11.698712356843451, 20.314414808822665, -20.23305687751804, 11.86170077862628, -5.050372273349697, -17.098220122525625, -15.83101484353593, 8.359269532920587], "episode_lengths": [269, 338, 728, 1117, 295, 260, 685, 761, 296, 297, 433, 279, 274, 295, 747, 803, 395, 553, 148, 646, 799, 496, 151, 439, 259, 317, 798, 381, 761, 294, 1117, 232, 302, 1117, 1005, 288, 834, 259, 439, 1117, 648, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4475109529281642, "mean_inference_ms": 7.10337905181758, "mean_action_processing_ms": 0.4987762455959492, "mean_env_wait_ms": 22.472491725455445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011987345559256417, "StateBufferConnector_ms": 0.02400818325224377, "ViewRequirementAgentConnector_ms": 0.7343439828781855}}, "episode_reward_max": 27.175061037558542, "episode_reward_min": -56.588359052188565, "episode_reward_mean": -9.925249711454782, "episode_len_mean": 522.4047619047619, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.823252372917182, -31.974379656962842, -46.59986083433812, -8.818392112182613, -19.442365067364403, -18.324091485037634, -56.588359052188565, -35.35557307711445, -22.446792148349566, -19.95685925473788, -52.62578300493693, -16.60700653287384, -22.17159401327684, -20.15647814912203, -13.535618208461981, -7.516993422718009, 6.643994864169072, -32.45828975994229, 2.780915032547828, -31.515988933763804, 21.913888606463537, -1.1852211537190733, 3.148783541351875, -23.767608686262957, 12.183215351772295, -6.179957914901087, -20.664948140755577, -5.944777585367666, -5.019983241257129, 15.851833074551, 27.175061037558542, 9.6397751620956, -6.079646569768005, 25.540432466426097, 11.698712356843451, 20.314414808822665, -20.23305687751804, 11.86170077862628, -5.050372273349697, -17.098220122525625, -15.83101484353593, 8.359269532920587], "episode_lengths": [269, 338, 728, 1117, 295, 260, 685, 761, 296, 297, 433, 279, 274, 295, 747, 803, 395, 553, 148, 646, 799, 496, 151, 439, 259, 317, 798, 381, 761, 294, 1117, 232, 302, 1117, 1005, 288, 834, 259, 439, 1117, 648, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4475109529281642, "mean_inference_ms": 7.10337905181758, "mean_action_processing_ms": 0.4987762455959492, "mean_env_wait_ms": 22.472491725455445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011987345559256417, "StateBufferConnector_ms": 0.02400818325224377, "ViewRequirementAgentConnector_ms": 0.7343439828781855}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21941, "num_agent_steps_trained": 21941, "num_env_steps_sampled": 21941, "num_env_steps_trained": 21941, "num_env_steps_sampled_this_iter": 8682, "num_env_steps_trained_this_iter": 8682, "num_env_steps_sampled_throughput_per_sec": 240.23304049093346, "num_env_steps_trained_throughput_per_sec": 240.23304049093346, "timesteps_total": 21941, "num_steps_trained_this_iter": 8682, "agent_timesteps_total": 21941, "timers": {"training_iteration_time_ms": 33155.311, "sample_time_ms": 26388.848, "load_time_ms": 1169.227, "load_throughput": 6255.127, "learn_time_ms": 5125.966, "learn_throughput": 1426.788, "synch_weights_time_ms": 417.848}, "counters": {"num_env_steps_sampled": 21941, "num_env_steps_trained": 21941, "num_agent_steps_sampled": 21941, "num_agent_steps_trained": 21941}, "done": false, "episodes_total": 42, "training_iteration": 3, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-36-59", "timestamp": 1749299819, "time_this_iter_s": 36.15557837486267, "time_total_s": 99.51463270187378, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 99.51463270187378, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 60.45227272727272, "ram_util_percent": 62.29318181818183, "gpu_util_percent0": 0.05659090909090909, "vram_util_percent0": 0.43819543087121215}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.25, "cur_lr": 9.978059000000001e-05, "total_loss": -0.10919965328183025, "policy_loss": -0.0034084684739355, "vf_loss": 0.10576209551654756, "vf_explained_var": 0.8513344877958298, "kl": 0.0069110147620090314, "entropy": 14.079213724136352, "entropy_coeff": 0.009890294999999999}, "model": {}, "num_grad_updates_lifetime": 870.5, "diff_num_grad_updates_vs_sampler_policy": 99.5}}, "num_env_steps_sampled": 27686, "num_env_steps_trained": 27686, "num_agent_steps_sampled": 27686, "num_agent_steps_trained": 27686}, "sampler_results": {"episode_reward_max": 27.175061037558542, "episode_reward_min": -56.588359052188565, "episode_reward_mean": -6.280741453645132, "episode_len_mean": 485.719298245614, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.823252372917182, -31.974379656962842, -46.59986083433812, -8.818392112182613, -19.442365067364403, -18.324091485037634, -56.588359052188565, -35.35557307711445, -22.446792148349566, -19.95685925473788, -52.62578300493693, -16.60700653287384, -22.17159401327684, -20.15647814912203, -13.535618208461981, -7.516993422718009, 6.643994864169072, -32.45828975994229, 2.780915032547828, -31.515988933763804, 21.913888606463537, -1.1852211537190733, 3.148783541351875, -23.767608686262957, 12.183215351772295, -6.179957914901087, -20.664948140755577, -5.944777585367666, -5.019983241257129, 15.851833074551, 27.175061037558542, 9.6397751620956, -6.079646569768005, 25.540432466426097, 11.698712356843451, 20.314414808822665, -20.23305687751804, 11.86170077862628, -5.050372273349697, -17.098220122525625, -15.83101484353593, 8.359269532920587, 13.821682057159814, -5.025497565494016, 19.95894780381941, -4.085716810794045, 1.161041478686475, 2.9691420845676, 13.056085062909231, 16.29980326863332, 4.434843148157348, -0.8240560224876177, -4.907826435803298, 10.323834041326826, 4.311228604333766, -16.624255112578524, 3.9889694208921083], "episode_lengths": [269, 338, 728, 1117, 295, 260, 685, 761, 296, 297, 433, 279, 274, 295, 747, 803, 395, 553, 148, 646, 799, 496, 151, 439, 259, 317, 798, 381, 761, 294, 1117, 232, 302, 1117, 1005, 288, 834, 259, 439, 1117, 648, 269, 259, 318, 302, 323, 244, 372, 206, 259, 96, 439, 406, 764, 232, 408, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3883169578355616, "mean_inference_ms": 7.04361006435067, "mean_action_processing_ms": 0.49316740577554, "mean_env_wait_ms": 22.07685635351542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012328750208804482, "StateBufferConnector_ms": 0.019444917377672698, "ViewRequirementAgentConnector_ms": 0.7613274089077062}}, "episode_reward_max": 27.175061037558542, "episode_reward_min": -56.588359052188565, "episode_reward_mean": -6.280741453645132, "episode_len_mean": 485.719298245614, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.823252372917182, -31.974379656962842, -46.59986083433812, -8.818392112182613, -19.442365067364403, -18.324091485037634, -56.588359052188565, -35.35557307711445, -22.446792148349566, -19.95685925473788, -52.62578300493693, -16.60700653287384, -22.17159401327684, -20.15647814912203, -13.535618208461981, -7.516993422718009, 6.643994864169072, -32.45828975994229, 2.780915032547828, -31.515988933763804, 21.913888606463537, -1.1852211537190733, 3.148783541351875, -23.767608686262957, 12.183215351772295, -6.179957914901087, -20.664948140755577, -5.944777585367666, -5.019983241257129, 15.851833074551, 27.175061037558542, 9.6397751620956, -6.079646569768005, 25.540432466426097, 11.698712356843451, 20.314414808822665, -20.23305687751804, 11.86170077862628, -5.050372273349697, -17.098220122525625, -15.83101484353593, 8.359269532920587, 13.821682057159814, -5.025497565494016, 19.95894780381941, -4.085716810794045, 1.161041478686475, 2.9691420845676, 13.056085062909231, 16.29980326863332, 4.434843148157348, -0.8240560224876177, -4.907826435803298, 10.323834041326826, 4.311228604333766, -16.624255112578524, 3.9889694208921083], "episode_lengths": [269, 338, 728, 1117, 295, 260, 685, 761, 296, 297, 433, 279, 274, 295, 747, 803, 395, 553, 148, 646, 799, 496, 151, 439, 259, 317, 798, 381, 761, 294, 1117, 232, 302, 1117, 1005, 288, 834, 259, 439, 1117, 648, 269, 259, 318, 302, 323, 244, 372, 206, 259, 96, 439, 406, 764, 232, 408, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3883169578355616, "mean_inference_ms": 7.04361006435067, "mean_action_processing_ms": 0.49316740577554, "mean_env_wait_ms": 22.07685635351542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012328750208804482, "StateBufferConnector_ms": 0.019444917377672698, "ViewRequirementAgentConnector_ms": 0.7613274089077062}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27686, "num_agent_steps_trained": 27686, "num_env_steps_sampled": 27686, "num_env_steps_trained": 27686, "num_env_steps_sampled_this_iter": 5745, "num_env_steps_trained_this_iter": 5745, "num_env_steps_sampled_throughput_per_sec": 192.57692623068078, "num_env_steps_trained_throughput_per_sec": 192.57692623068078, "timesteps_total": 27686, "num_steps_trained_this_iter": 5745, "agent_timesteps_total": 27686, "timers": {"training_iteration_time_ms": 32324.542, "sample_time_ms": 26025.725, "load_time_ms": 1065.617, "load_throughput": 6495.3, "learn_time_ms": 4762.438, "learn_throughput": 1453.352, "synch_weights_time_ms": 419.05}, "counters": {"num_env_steps_sampled": 27686, "num_env_steps_trained": 27686, "num_agent_steps_sampled": 27686, "num_agent_steps_trained": 27686}, "done": false, "episodes_total": 57, "training_iteration": 4, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-37-29", "timestamp": 1749299849, "time_this_iter_s": 29.851232051849365, "time_total_s": 129.36586475372314, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 129.36586475372314, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 51.31388888888889, "ram_util_percent": 61.811111111111096, "gpu_util_percent0": 0.04750000000000001, "vram_util_percent0": 0.62255859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.972314e-05, "total_loss": -0.13250205796502995, "policy_loss": -0.02556374041547921, "vf_loss": 0.10457915014897784, "vf_explained_var": 0.8778252107401688, "kl": 0.007625310753928716, "entropy": 14.12201497554779, "entropy_coeff": 0.009861569999999997}, "model": {}, "num_grad_updates_lifetime": 1090.5, "diff_num_grad_updates_vs_sampler_policy": 119.5}}, "num_env_steps_sampled": 34577, "num_env_steps_trained": 34577, "num_agent_steps_sampled": 34577, "num_agent_steps_trained": 34577}, "sampler_results": {"episode_reward_max": 27.175061037558542, "episode_reward_min": -56.588359052188565, "episode_reward_mean": -5.325368988981587, "episode_len_mean": 487.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.823252372917182, -31.974379656962842, -46.59986083433812, -8.818392112182613, -19.442365067364403, -18.324091485037634, -56.588359052188565, -35.35557307711445, -22.446792148349566, -19.95685925473788, -52.62578300493693, -16.60700653287384, -22.17159401327684, -20.15647814912203, -13.535618208461981, -7.516993422718009, 6.643994864169072, -32.45828975994229, 2.780915032547828, -31.515988933763804, 21.913888606463537, -1.1852211537190733, 3.148783541351875, -23.767608686262957, 12.183215351772295, -6.179957914901087, -20.664948140755577, -5.944777585367666, -5.019983241257129, 15.851833074551, 27.175061037558542, 9.6397751620956, -6.079646569768005, 25.540432466426097, 11.698712356843451, 20.314414808822665, -20.23305687751804, 11.86170077862628, -5.050372273349697, -17.098220122525625, -15.83101484353593, 8.359269532920587, 13.821682057159814, -5.025497565494016, 19.95894780381941, -4.085716810794045, 1.161041478686475, 2.9691420845676, 13.056085062909231, 16.29980326863332, 4.434843148157348, -0.8240560224876177, -4.907826435803298, 10.323834041326826, 4.311228604333766, -16.624255112578524, 3.9889694208921083, -7.645522104270397, 15.679341809161187, -3.7281276367745204, -23.672587081662016, -2.773381060382596, 15.324257202811843, -11.439418289274222, -6.432837310550895, 4.771397505376575, -10.725535600033954, 15.707428410726308, 2.1765275448937844, 7.6207805881654895, -14.961259338106794], "episode_lengths": [269, 338, 728, 1117, 295, 260, 685, 761, 296, 297, 433, 279, 274, 295, 747, 803, 395, 553, 148, 646, 799, 496, 151, 439, 259, 317, 798, 381, 761, 294, 1117, 232, 302, 1117, 1005, 288, 834, 259, 439, 1117, 648, 269, 259, 318, 302, 323, 244, 372, 206, 259, 96, 439, 406, 764, 232, 408, 1117, 406, 259, 567, 858, 373, 232, 615, 680, 190, 531, 299, 139, 786, 956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3460335575300153, "mean_inference_ms": 7.0064865986856875, "mean_action_processing_ms": 0.48993579106213136, "mean_env_wait_ms": 21.8192005785099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03644311931771292, "StateBufferConnector_ms": 0.015610708317286531, "ViewRequirementAgentConnector_ms": 0.737824238521952}}, "episode_reward_max": 27.175061037558542, "episode_reward_min": -56.588359052188565, "episode_reward_mean": -5.325368988981587, "episode_len_mean": 487.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.823252372917182, -31.974379656962842, -46.59986083433812, -8.818392112182613, -19.442365067364403, -18.324091485037634, -56.588359052188565, -35.35557307711445, -22.446792148349566, -19.95685925473788, -52.62578300493693, -16.60700653287384, -22.17159401327684, -20.15647814912203, -13.535618208461981, -7.516993422718009, 6.643994864169072, -32.45828975994229, 2.780915032547828, -31.515988933763804, 21.913888606463537, -1.1852211537190733, 3.148783541351875, -23.767608686262957, 12.183215351772295, -6.179957914901087, -20.664948140755577, -5.944777585367666, -5.019983241257129, 15.851833074551, 27.175061037558542, 9.6397751620956, -6.079646569768005, 25.540432466426097, 11.698712356843451, 20.314414808822665, -20.23305687751804, 11.86170077862628, -5.050372273349697, -17.098220122525625, -15.83101484353593, 8.359269532920587, 13.821682057159814, -5.025497565494016, 19.95894780381941, -4.085716810794045, 1.161041478686475, 2.9691420845676, 13.056085062909231, 16.29980326863332, 4.434843148157348, -0.8240560224876177, -4.907826435803298, 10.323834041326826, 4.311228604333766, -16.624255112578524, 3.9889694208921083, -7.645522104270397, 15.679341809161187, -3.7281276367745204, -23.672587081662016, -2.773381060382596, 15.324257202811843, -11.439418289274222, -6.432837310550895, 4.771397505376575, -10.725535600033954, 15.707428410726308, 2.1765275448937844, 7.6207805881654895, -14.961259338106794], "episode_lengths": [269, 338, 728, 1117, 295, 260, 685, 761, 296, 297, 433, 279, 274, 295, 747, 803, 395, 553, 148, 646, 799, 496, 151, 439, 259, 317, 798, 381, 761, 294, 1117, 232, 302, 1117, 1005, 288, 834, 259, 439, 1117, 648, 269, 259, 318, 302, 323, 244, 372, 206, 259, 96, 439, 406, 764, 232, 408, 1117, 406, 259, 567, 858, 373, 232, 615, 680, 190, 531, 299, 139, 786, 956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3460335575300153, "mean_inference_ms": 7.0064865986856875, "mean_action_processing_ms": 0.48993579106213136, "mean_env_wait_ms": 21.8192005785099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03644311931771292, "StateBufferConnector_ms": 0.015610708317286531, "ViewRequirementAgentConnector_ms": 0.737824238521952}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34577, "num_agent_steps_trained": 34577, "num_env_steps_sampled": 34577, "num_env_steps_trained": 34577, "num_env_steps_sampled_this_iter": 6891, "num_env_steps_trained_this_iter": 6891, "num_env_steps_sampled_throughput_per_sec": 230.8359324338205, "num_env_steps_trained_throughput_per_sec": 230.8359324338205, "timesteps_total": 34577, "num_steps_trained_this_iter": 6891, "agent_timesteps_total": 34577, "timers": {"training_iteration_time_ms": 31830.108, "sample_time_ms": 25631.771, "load_time_ms": 1019.13, "load_throughput": 6785.594, "learn_time_ms": 4698.61, "learn_throughput": 1471.797, "synch_weights_time_ms": 426.062}, "counters": {"num_env_steps_sampled": 34577, "num_env_steps_trained": 34577, "num_agent_steps_sampled": 34577, "num_agent_steps_trained": 34577}, "done": false, "episodes_total": 71, "training_iteration": 5, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-37-59", "timestamp": 1749299879, "time_this_iter_s": 29.867234706878662, "time_total_s": 159.2330994606018, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 159.2330994606018, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 60.9388888888889, "ram_util_percent": 62.03333333333332, "gpu_util_percent0": 0.053888888888888896, "vram_util_percent0": 0.62255859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.965422999999998e-05, "total_loss": -0.12898124922066928, "policy_loss": -0.021141344364042636, "vf_loss": 0.1010788826064931, "vf_explained_var": 0.8560245933356109, "kl": 0.007603741707647128, "entropy": 14.1561429977417, "entropy_coeff": 0.009827114999999999}, "model": {}, "num_grad_updates_lifetime": 1345.5, "diff_num_grad_updates_vs_sampler_policy": 134.5}}, "num_env_steps_sampled": 42316, "num_env_steps_trained": 42316, "num_agent_steps_sampled": 42316, "num_agent_steps_trained": 42316}, "sampler_results": {"episode_reward_max": 27.175061037558542, "episode_reward_min": -56.588359052188565, "episode_reward_mean": -4.0673683270821, "episode_len_mean": 497.83529411764704, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.823252372917182, -31.974379656962842, -46.59986083433812, -8.818392112182613, -19.442365067364403, -18.324091485037634, -56.588359052188565, -35.35557307711445, -22.446792148349566, -19.95685925473788, -52.62578300493693, -16.60700653287384, -22.17159401327684, -20.15647814912203, -13.535618208461981, -7.516993422718009, 6.643994864169072, -32.45828975994229, 2.780915032547828, -31.515988933763804, 21.913888606463537, -1.1852211537190733, 3.148783541351875, -23.767608686262957, 12.183215351772295, -6.179957914901087, -20.664948140755577, -5.944777585367666, -5.019983241257129, 15.851833074551, 27.175061037558542, 9.6397751620956, -6.079646569768005, 25.540432466426097, 11.698712356843451, 20.314414808822665, -20.23305687751804, 11.86170077862628, -5.050372273349697, -17.098220122525625, -15.83101484353593, 8.359269532920587, 13.821682057159814, -5.025497565494016, 19.95894780381941, -4.085716810794045, 1.161041478686475, 2.9691420845676, 13.056085062909231, 16.29980326863332, 4.434843148157348, -0.8240560224876177, -4.907826435803298, 10.323834041326826, 4.311228604333766, -16.624255112578524, 3.9889694208921083, -7.645522104270397, 15.679341809161187, -3.7281276367745204, -23.672587081662016, -2.773381060382596, 15.324257202811843, -11.439418289274222, -6.432837310550895, 4.771397505376575, -10.725535600033954, 15.707428410726308, 2.1765275448937844, 7.6207805881654895, -14.961259338106794, 3.6570037146716308, 7.146386045900513, 11.596452128454938, -13.995456876714979, -16.157754866570823, -11.840335609075945, 1.8675445803199024, 9.854141808224693, 4.143184044160587, 14.106022528129145, 17.893603379451072, -9.872003465343875, 11.57347500369179, 2.402628000415567], "episode_lengths": [269, 338, 728, 1117, 295, 260, 685, 761, 296, 297, 433, 279, 274, 295, 747, 803, 395, 553, 148, 646, 799, 496, 151, 439, 259, 317, 798, 381, 761, 294, 1117, 232, 302, 1117, 1005, 288, 834, 259, 439, 1117, 648, 269, 259, 318, 302, 323, 244, 372, 206, 259, 96, 439, 406, 764, 232, 408, 1117, 406, 259, 567, 858, 373, 232, 615, 680, 190, 531, 299, 139, 786, 956, 794, 148, 323, 1117, 758, 406, 763, 148, 385, 1078, 791, 406, 325, 297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.312202607880846, "mean_inference_ms": 6.965998664914097, "mean_action_processing_ms": 0.4863713996859524, "mean_env_wait_ms": 21.590614814377556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030440723194795495, "StateBufferConnector_ms": 0.014241723453297335, "ViewRequirementAgentConnector_ms": 0.7384258158066693}}, "episode_reward_max": 27.175061037558542, "episode_reward_min": -56.588359052188565, "episode_reward_mean": -4.0673683270821, "episode_len_mean": 497.83529411764704, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.823252372917182, -31.974379656962842, -46.59986083433812, -8.818392112182613, -19.442365067364403, -18.324091485037634, -56.588359052188565, -35.35557307711445, -22.446792148349566, -19.95685925473788, -52.62578300493693, -16.60700653287384, -22.17159401327684, -20.15647814912203, -13.535618208461981, -7.516993422718009, 6.643994864169072, -32.45828975994229, 2.780915032547828, -31.515988933763804, 21.913888606463537, -1.1852211537190733, 3.148783541351875, -23.767608686262957, 12.183215351772295, -6.179957914901087, -20.664948140755577, -5.944777585367666, -5.019983241257129, 15.851833074551, 27.175061037558542, 9.6397751620956, -6.079646569768005, 25.540432466426097, 11.698712356843451, 20.314414808822665, -20.23305687751804, 11.86170077862628, -5.050372273349697, -17.098220122525625, -15.83101484353593, 8.359269532920587, 13.821682057159814, -5.025497565494016, 19.95894780381941, -4.085716810794045, 1.161041478686475, 2.9691420845676, 13.056085062909231, 16.29980326863332, 4.434843148157348, -0.8240560224876177, -4.907826435803298, 10.323834041326826, 4.311228604333766, -16.624255112578524, 3.9889694208921083, -7.645522104270397, 15.679341809161187, -3.7281276367745204, -23.672587081662016, -2.773381060382596, 15.324257202811843, -11.439418289274222, -6.432837310550895, 4.771397505376575, -10.725535600033954, 15.707428410726308, 2.1765275448937844, 7.6207805881654895, -14.961259338106794, 3.6570037146716308, 7.146386045900513, 11.596452128454938, -13.995456876714979, -16.157754866570823, -11.840335609075945, 1.8675445803199024, 9.854141808224693, 4.143184044160587, 14.106022528129145, 17.893603379451072, -9.872003465343875, 11.57347500369179, 2.402628000415567], "episode_lengths": [269, 338, 728, 1117, 295, 260, 685, 761, 296, 297, 433, 279, 274, 295, 747, 803, 395, 553, 148, 646, 799, 496, 151, 439, 259, 317, 798, 381, 761, 294, 1117, 232, 302, 1117, 1005, 288, 834, 259, 439, 1117, 648, 269, 259, 318, 302, 323, 244, 372, 206, 259, 96, 439, 406, 764, 232, 408, 1117, 406, 259, 567, 858, 373, 232, 615, 680, 190, 531, 299, 139, 786, 956, 794, 148, 323, 1117, 758, 406, 763, 148, 385, 1078, 791, 406, 325, 297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.312202607880846, "mean_inference_ms": 6.965998664914097, "mean_action_processing_ms": 0.4863713996859524, "mean_env_wait_ms": 21.590614814377556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030440723194795495, "StateBufferConnector_ms": 0.014241723453297335, "ViewRequirementAgentConnector_ms": 0.7384258158066693}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42316, "num_agent_steps_trained": 42316, "num_env_steps_sampled": 42316, "num_env_steps_trained": 42316, "num_env_steps_sampled_this_iter": 7739, "num_env_steps_trained_this_iter": 7739, "num_env_steps_sampled_throughput_per_sec": 231.31364618606491, "num_env_steps_trained_throughput_per_sec": 231.31364618606491, "timesteps_total": 42316, "num_steps_trained_this_iter": 7739, "agent_timesteps_total": 42316, "timers": {"training_iteration_time_ms": 32101.213, "sample_time_ms": 25879.381, "load_time_ms": 991.803, "load_throughput": 7110.956, "learn_time_ms": 4744.009, "learn_throughput": 1486.647, "synch_weights_time_ms": 430.575}, "counters": {"num_env_steps_sampled": 42316, "num_env_steps_trained": 42316, "num_agent_steps_sampled": 42316, "num_agent_steps_trained": 42316}, "done": false, "episodes_total": 85, "training_iteration": 6, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-38-33", "timestamp": 1749299913, "time_this_iter_s": 33.47373390197754, "time_total_s": 192.70683336257935, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 192.70683336257935, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 58.92750000000001, "ram_util_percent": 62.467499999999994, "gpu_util_percent0": 0.05800000000000001, "vram_util_percent0": 0.62255859375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.125, "cur_lr": 9.957683999999999e-05, "total_loss": -0.10662376768887043, "policy_loss": -0.002077132253076083, "vf_loss": 0.11024118015941764, "vf_explained_var": 0.8569541358522006, "kl": 0.007452716950852586, "entropy": 14.154540201595852, "entropy_coeff": 0.00978842}, "model": {}, "num_grad_updates_lifetime": 1620.5, "diff_num_grad_updates_vs_sampler_policy": 139.5}}, "num_env_steps_sampled": 50232, "num_env_steps_trained": 50232, "num_agent_steps_sampled": 50232, "num_agent_steps_trained": 50232}, "sampler_results": {"episode_reward_max": 27.175061037558542, "episode_reward_min": -56.588359052188565, "episode_reward_mean": -3.1017339063196037, "episode_len_mean": 507.3939393939394, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.823252372917182, -31.974379656962842, -46.59986083433812, -8.818392112182613, -19.442365067364403, -18.324091485037634, -56.588359052188565, -35.35557307711445, -22.446792148349566, -19.95685925473788, -52.62578300493693, -16.60700653287384, -22.17159401327684, -20.15647814912203, -13.535618208461981, -7.516993422718009, 6.643994864169072, -32.45828975994229, 2.780915032547828, -31.515988933763804, 21.913888606463537, -1.1852211537190733, 3.148783541351875, -23.767608686262957, 12.183215351772295, -6.179957914901087, -20.664948140755577, -5.944777585367666, -5.019983241257129, 15.851833074551, 27.175061037558542, 9.6397751620956, -6.079646569768005, 25.540432466426097, 11.698712356843451, 20.314414808822665, -20.23305687751804, 11.86170077862628, -5.050372273349697, -17.098220122525625, -15.83101484353593, 8.359269532920587, 13.821682057159814, -5.025497565494016, 19.95894780381941, -4.085716810794045, 1.161041478686475, 2.9691420845676, 13.056085062909231, 16.29980326863332, 4.434843148157348, -0.8240560224876177, -4.907826435803298, 10.323834041326826, 4.311228604333766, -16.624255112578524, 3.9889694208921083, -7.645522104270397, 15.679341809161187, -3.7281276367745204, -23.672587081662016, -2.773381060382596, 15.324257202811843, -11.439418289274222, -6.432837310550895, 4.771397505376575, -10.725535600033954, 15.707428410726308, 2.1765275448937844, 7.6207805881654895, -14.961259338106794, 3.6570037146716308, 7.146386045900513, 11.596452128454938, -13.995456876714979, -16.157754866570823, -11.840335609075945, 1.8675445803199024, 9.854141808224693, 4.143184044160587, 14.106022528129145, 17.893603379451072, -9.872003465343875, 11.57347500369179, 2.402628000415567, 6.1631835727632795, 5.518172988586242, -15.77584939159059, 4.754380347137223, -17.402424994041365, 2.286675579602615, 3.8087999764635097, -20.003531453490385, 10.977762454819745, 2.316650609554288, 25.618283318832727, 2.9608081240013684, 17.590565549919795, 9.841174393779278], "episode_lengths": [269, 338, 728, 1117, 295, 260, 685, 761, 296, 297, 433, 279, 274, 295, 747, 803, 395, 553, 148, 646, 799, 496, 151, 439, 259, 317, 798, 381, 761, 294, 1117, 232, 302, 1117, 1005, 288, 834, 259, 439, 1117, 648, 269, 259, 318, 302, 323, 244, 372, 206, 259, 96, 439, 406, 764, 232, 408, 1117, 406, 259, 567, 858, 373, 232, 615, 680, 190, 531, 299, 139, 786, 956, 794, 148, 323, 1117, 758, 406, 763, 148, 385, 1078, 791, 406, 325, 297, 295, 288, 614, 1106, 398, 295, 863, 640, 1117, 376, 1117, 295, 239, 273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.286717249067964, "mean_inference_ms": 6.938486292009117, "mean_action_processing_ms": 0.48400737760743334, "mean_env_wait_ms": 21.41601031059475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02613597446017795, "StateBufferConnector_ms": 0.01629314037284466, "ViewRequirementAgentConnector_ms": 0.7562603613342902}}, "episode_reward_max": 27.175061037558542, "episode_reward_min": -56.588359052188565, "episode_reward_mean": -3.1017339063196037, "episode_len_mean": 507.3939393939394, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10.823252372917182, -31.974379656962842, -46.59986083433812, -8.818392112182613, -19.442365067364403, -18.324091485037634, -56.588359052188565, -35.35557307711445, -22.446792148349566, -19.95685925473788, -52.62578300493693, -16.60700653287384, -22.17159401327684, -20.15647814912203, -13.535618208461981, -7.516993422718009, 6.643994864169072, -32.45828975994229, 2.780915032547828, -31.515988933763804, 21.913888606463537, -1.1852211537190733, 3.148783541351875, -23.767608686262957, 12.183215351772295, -6.179957914901087, -20.664948140755577, -5.944777585367666, -5.019983241257129, 15.851833074551, 27.175061037558542, 9.6397751620956, -6.079646569768005, 25.540432466426097, 11.698712356843451, 20.314414808822665, -20.23305687751804, 11.86170077862628, -5.050372273349697, -17.098220122525625, -15.83101484353593, 8.359269532920587, 13.821682057159814, -5.025497565494016, 19.95894780381941, -4.085716810794045, 1.161041478686475, 2.9691420845676, 13.056085062909231, 16.29980326863332, 4.434843148157348, -0.8240560224876177, -4.907826435803298, 10.323834041326826, 4.311228604333766, -16.624255112578524, 3.9889694208921083, -7.645522104270397, 15.679341809161187, -3.7281276367745204, -23.672587081662016, -2.773381060382596, 15.324257202811843, -11.439418289274222, -6.432837310550895, 4.771397505376575, -10.725535600033954, 15.707428410726308, 2.1765275448937844, 7.6207805881654895, -14.961259338106794, 3.6570037146716308, 7.146386045900513, 11.596452128454938, -13.995456876714979, -16.157754866570823, -11.840335609075945, 1.8675445803199024, 9.854141808224693, 4.143184044160587, 14.106022528129145, 17.893603379451072, -9.872003465343875, 11.57347500369179, 2.402628000415567, 6.1631835727632795, 5.518172988586242, -15.77584939159059, 4.754380347137223, -17.402424994041365, 2.286675579602615, 3.8087999764635097, -20.003531453490385, 10.977762454819745, 2.316650609554288, 25.618283318832727, 2.9608081240013684, 17.590565549919795, 9.841174393779278], "episode_lengths": [269, 338, 728, 1117, 295, 260, 685, 761, 296, 297, 433, 279, 274, 295, 747, 803, 395, 553, 148, 646, 799, 496, 151, 439, 259, 317, 798, 381, 761, 294, 1117, 232, 302, 1117, 1005, 288, 834, 259, 439, 1117, 648, 269, 259, 318, 302, 323, 244, 372, 206, 259, 96, 439, 406, 764, 232, 408, 1117, 406, 259, 567, 858, 373, 232, 615, 680, 190, 531, 299, 139, 786, 956, 794, 148, 323, 1117, 758, 406, 763, 148, 385, 1078, 791, 406, 325, 297, 295, 288, 614, 1106, 398, 295, 863, 640, 1117, 376, 1117, 295, 239, 273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.286717249067964, "mean_inference_ms": 6.938486292009117, "mean_action_processing_ms": 0.48400737760743334, "mean_env_wait_ms": 21.41601031059475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02613597446017795, "StateBufferConnector_ms": 0.01629314037284466, "ViewRequirementAgentConnector_ms": 0.7562603613342902}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50232, "num_agent_steps_trained": 50232, "num_env_steps_sampled": 50232, "num_env_steps_trained": 50232, "num_env_steps_sampled_this_iter": 7916, "num_env_steps_trained_this_iter": 7916, "num_env_steps_sampled_throughput_per_sec": 231.12006706009757, "num_env_steps_trained_throughput_per_sec": 231.12006706009757, "timesteps_total": 50232, "num_steps_trained_this_iter": 7916, "agent_timesteps_total": 50232, "timers": {"training_iteration_time_ms": 32408.267, "sample_time_ms": 26132.959, "load_time_ms": 974.81, "load_throughput": 7361.435, "learn_time_ms": 4814.577, "learn_throughput": 1490.474, "synch_weights_time_ms": 429.269}, "counters": {"num_env_steps_sampled": 50232, "num_env_steps_trained": 50232, "num_agent_steps_sampled": 50232, "num_agent_steps_trained": 50232}, "done": false, "episodes_total": 99, "training_iteration": 7, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-39-07", "timestamp": 1749299947, "time_this_iter_s": 34.2666232585907, "time_total_s": 226.97345662117004, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 226.97345662117004, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 59.28536585365853, "ram_util_percent": 63.00487804878048, "gpu_util_percent0": 0.05365853658536586, "vram_util_percent0": 0.6629549352134146}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0625, "cur_lr": 9.949767999999998e-05, "total_loss": -0.10836201471317074, "policy_loss": -0.0009410495080215775, "vf_loss": 0.10360521334830834, "vf_explained_var": 0.9087080603060516, "kl": 0.007287646165376223, "entropy": 14.253799712139628, "entropy_coeff": 0.009748840000000002}, "model": {}, "num_grad_updates_lifetime": 1875.5, "diff_num_grad_updates_vs_sampler_policy": 114.5}}, "num_env_steps_sampled": 56881, "num_env_steps_trained": 56881, "num_agent_steps_sampled": 56881, "num_agent_steps_trained": 56881}, "sampler_results": {"episode_reward_max": 28.33593478795615, "episode_reward_min": -32.45828975994229, "episode_reward_mean": 1.0092138152421677, "episode_len_mean": 508.49, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.15647814912203, -13.535618208461981, -7.516993422718009, 6.643994864169072, -32.45828975994229, 2.780915032547828, -31.515988933763804, 21.913888606463537, -1.1852211537190733, 3.148783541351875, -23.767608686262957, 12.183215351772295, -6.179957914901087, -20.664948140755577, -5.944777585367666, -5.019983241257129, 15.851833074551, 27.175061037558542, 9.6397751620956, -6.079646569768005, 25.540432466426097, 11.698712356843451, 20.314414808822665, -20.23305687751804, 11.86170077862628, -5.050372273349697, -17.098220122525625, -15.83101484353593, 8.359269532920587, 13.821682057159814, -5.025497565494016, 19.95894780381941, -4.085716810794045, 1.161041478686475, 2.9691420845676, 13.056085062909231, 16.29980326863332, 4.434843148157348, -0.8240560224876177, -4.907826435803298, 10.323834041326826, 4.311228604333766, -16.624255112578524, 3.9889694208921083, -7.645522104270397, 15.679341809161187, -3.7281276367745204, -23.672587081662016, -2.773381060382596, 15.324257202811843, -11.439418289274222, -6.432837310550895, 4.771397505376575, -10.725535600033954, 15.707428410726308, 2.1765275448937844, 7.6207805881654895, -14.961259338106794, 3.6570037146716308, 7.146386045900513, 11.596452128454938, -13.995456876714979, -16.157754866570823, -11.840335609075945, 1.8675445803199024, 9.854141808224693, 4.143184044160587, 14.106022528129145, 17.893603379451072, -9.872003465343875, 11.57347500369179, 2.402628000415567, 6.1631835727632795, 5.518172988586242, -15.77584939159059, 4.754380347137223, -17.402424994041365, 2.286675579602615, 3.8087999764635097, -20.003531453490385, 10.977762454819745, 2.316650609554288, 25.618283318832727, 2.9608081240013684, 17.590565549919795, 9.841174393779278, 10.72392126497807, -12.494313233202663, -20.695221331562742, -8.099898171193114, 6.9468417567030105, 7.592066493708884, 28.33593478795615, 7.819755672374823, 8.045658130436234, 8.112486006032599, 9.240467392562888, -15.798559128481429, 6.060658932551257, 10.468931064712732], "episode_lengths": [295, 747, 803, 395, 553, 148, 646, 799, 496, 151, 439, 259, 317, 798, 381, 761, 294, 1117, 232, 302, 1117, 1005, 288, 834, 259, 439, 1117, 648, 269, 259, 318, 302, 323, 244, 372, 206, 259, 96, 439, 406, 764, 232, 408, 1117, 406, 259, 567, 858, 373, 232, 615, 680, 190, 531, 299, 139, 786, 956, 794, 148, 323, 1117, 758, 406, 763, 148, 385, 1078, 791, 406, 325, 297, 295, 288, 614, 1106, 398, 295, 863, 640, 1117, 376, 1117, 295, 239, 273, 259, 766, 630, 556, 1117, 259, 881, 168, 259, 317, 382, 486, 300, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.216823624310685, "mean_inference_ms": 6.900152072365594, "mean_action_processing_ms": 0.4807240296204858, "mean_env_wait_ms": 21.001117080159975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029847383499145508, "StateBufferConnector_ms": 0.01608109474182129, "ViewRequirementAgentConnector_ms": 0.737088680267334}}, "episode_reward_max": 28.33593478795615, "episode_reward_min": -32.45828975994229, "episode_reward_mean": 1.0092138152421677, "episode_len_mean": 508.49, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-20.15647814912203, -13.535618208461981, -7.516993422718009, 6.643994864169072, -32.45828975994229, 2.780915032547828, -31.515988933763804, 21.913888606463537, -1.1852211537190733, 3.148783541351875, -23.767608686262957, 12.183215351772295, -6.179957914901087, -20.664948140755577, -5.944777585367666, -5.019983241257129, 15.851833074551, 27.175061037558542, 9.6397751620956, -6.079646569768005, 25.540432466426097, 11.698712356843451, 20.314414808822665, -20.23305687751804, 11.86170077862628, -5.050372273349697, -17.098220122525625, -15.83101484353593, 8.359269532920587, 13.821682057159814, -5.025497565494016, 19.95894780381941, -4.085716810794045, 1.161041478686475, 2.9691420845676, 13.056085062909231, 16.29980326863332, 4.434843148157348, -0.8240560224876177, -4.907826435803298, 10.323834041326826, 4.311228604333766, -16.624255112578524, 3.9889694208921083, -7.645522104270397, 15.679341809161187, -3.7281276367745204, -23.672587081662016, -2.773381060382596, 15.324257202811843, -11.439418289274222, -6.432837310550895, 4.771397505376575, -10.725535600033954, 15.707428410726308, 2.1765275448937844, 7.6207805881654895, -14.961259338106794, 3.6570037146716308, 7.146386045900513, 11.596452128454938, -13.995456876714979, -16.157754866570823, -11.840335609075945, 1.8675445803199024, 9.854141808224693, 4.143184044160587, 14.106022528129145, 17.893603379451072, -9.872003465343875, 11.57347500369179, 2.402628000415567, 6.1631835727632795, 5.518172988586242, -15.77584939159059, 4.754380347137223, -17.402424994041365, 2.286675579602615, 3.8087999764635097, -20.003531453490385, 10.977762454819745, 2.316650609554288, 25.618283318832727, 2.9608081240013684, 17.590565549919795, 9.841174393779278, 10.72392126497807, -12.494313233202663, -20.695221331562742, -8.099898171193114, 6.9468417567030105, 7.592066493708884, 28.33593478795615, 7.819755672374823, 8.045658130436234, 8.112486006032599, 9.240467392562888, -15.798559128481429, 6.060658932551257, 10.468931064712732], "episode_lengths": [295, 747, 803, 395, 553, 148, 646, 799, 496, 151, 439, 259, 317, 798, 381, 761, 294, 1117, 232, 302, 1117, 1005, 288, 834, 259, 439, 1117, 648, 269, 259, 318, 302, 323, 244, 372, 206, 259, 96, 439, 406, 764, 232, 408, 1117, 406, 259, 567, 858, 373, 232, 615, 680, 190, 531, 299, 139, 786, 956, 794, 148, 323, 1117, 758, 406, 763, 148, 385, 1078, 791, 406, 325, 297, 295, 288, 614, 1106, 398, 295, 863, 640, 1117, 376, 1117, 295, 239, 273, 259, 766, 630, 556, 1117, 259, 881, 168, 259, 317, 382, 486, 300, 269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.216823624310685, "mean_inference_ms": 6.900152072365594, "mean_action_processing_ms": 0.4807240296204858, "mean_env_wait_ms": 21.001117080159975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029847383499145508, "StateBufferConnector_ms": 0.01608109474182129, "ViewRequirementAgentConnector_ms": 0.737088680267334}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56881, "num_agent_steps_trained": 56881, "num_env_steps_sampled": 56881, "num_env_steps_trained": 56881, "num_env_steps_sampled_this_iter": 6649, "num_env_steps_trained_this_iter": 6649, "num_env_steps_sampled_throughput_per_sec": 211.3327873686682, "num_env_steps_trained_throughput_per_sec": 211.3327873686682, "timesteps_total": 56881, "num_steps_trained_this_iter": 6649, "agent_timesteps_total": 56881, "timers": {"training_iteration_time_ms": 32290.012, "sample_time_ms": 26071.025, "load_time_ms": 947.492, "load_throughput": 7504.15, "learn_time_ms": 4749.25, "learn_throughput": 1497.105, "synch_weights_time_ms": 462.233}, "counters": {"num_env_steps_sampled": 56881, "num_env_steps_trained": 56881, "num_agent_steps_sampled": 56881, "num_agent_steps_trained": 56881}, "done": false, "episodes_total": 113, "training_iteration": 8, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-39-39", "timestamp": 1749299979, "time_this_iter_s": 31.474236011505127, "time_total_s": 258.44769263267517, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 258.44769263267517, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 54.32631578947369, "ram_util_percent": 61.63684210526314, "gpu_util_percent0": 0.05447368421052631, "vram_util_percent0": 0.82958984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.943118999999999e-05, "total_loss": -0.13746362766090395, "policy_loss": -0.027696816127040776, "vf_loss": 0.09597441814197548, "vf_explained_var": 0.918399704324788, "kl": 0.007945156978656524, "entropy": 14.287073812813594, "entropy_coeff": 0.009715594999999999}, "model": {}, "num_grad_updates_lifetime": 2135.5, "diff_num_grad_updates_vs_sampler_policy": 144.5}}, "num_env_steps_sampled": 65092, "num_env_steps_trained": 65092, "num_agent_steps_sampled": 65092, "num_agent_steps_trained": 65092}, "sampler_results": {"episode_reward_max": 28.33593478795615, "episode_reward_min": -45.73512452822024, "episode_reward_mean": 2.1455786418089606, "episode_len_mean": 518.33, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.019983241257129, 15.851833074551, 27.175061037558542, 9.6397751620956, -6.079646569768005, 25.540432466426097, 11.698712356843451, 20.314414808822665, -20.23305687751804, 11.86170077862628, -5.050372273349697, -17.098220122525625, -15.83101484353593, 8.359269532920587, 13.821682057159814, -5.025497565494016, 19.95894780381941, -4.085716810794045, 1.161041478686475, 2.9691420845676, 13.056085062909231, 16.29980326863332, 4.434843148157348, -0.8240560224876177, -4.907826435803298, 10.323834041326826, 4.311228604333766, -16.624255112578524, 3.9889694208921083, -7.645522104270397, 15.679341809161187, -3.7281276367745204, -23.672587081662016, -2.773381060382596, 15.324257202811843, -11.439418289274222, -6.432837310550895, 4.771397505376575, -10.725535600033954, 15.707428410726308, 2.1765275448937844, 7.6207805881654895, -14.961259338106794, 3.6570037146716308, 7.146386045900513, 11.596452128454938, -13.995456876714979, -16.157754866570823, -11.840335609075945, 1.8675445803199024, 9.854141808224693, 4.143184044160587, 14.106022528129145, 17.893603379451072, -9.872003465343875, 11.57347500369179, 2.402628000415567, 6.1631835727632795, 5.518172988586242, -15.77584939159059, 4.754380347137223, -17.402424994041365, 2.286675579602615, 3.8087999764635097, -20.003531453490385, 10.977762454819745, 2.316650609554288, 25.618283318832727, 2.9608081240013684, 17.590565549919795, 9.841174393779278, 10.72392126497807, -12.494313233202663, -20.695221331562742, -8.099898171193114, 6.9468417567030105, 7.592066493708884, 28.33593478795615, 7.819755672374823, 8.045658130436234, 8.112486006032599, 9.240467392562888, -15.798559128481429, 6.060658932551257, 10.468931064712732, 7.102437262560008, 6.053831222954919, -10.920526930974765, 2.4305514425715398, 8.66759047144039, 10.181414686400204, -1.8006472401239075, 25.069925499353275, 17.4185190265745, 0.46298453308503396, -12.742283490886821, -45.73512452822024, -12.195594083537356, 23.82881637000662, -20.44049614323399], "episode_lengths": [761, 294, 1117, 232, 302, 1117, 1005, 288, 834, 259, 439, 1117, 648, 269, 259, 318, 302, 323, 244, 372, 206, 259, 96, 439, 406, 764, 232, 408, 1117, 406, 259, 567, 858, 373, 232, 615, 680, 190, 531, 299, 139, 786, 956, 794, 148, 323, 1117, 758, 406, 763, 148, 385, 1078, 791, 406, 325, 297, 295, 288, 614, 1106, 398, 295, 863, 640, 1117, 376, 1117, 295, 239, 273, 259, 766, 630, 556, 1117, 259, 881, 168, 259, 317, 382, 486, 300, 269, 1117, 91, 761, 373, 148, 261, 410, 934, 259, 317, 490, 680, 795, 1117, 458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.159008042417421, "mean_inference_ms": 6.815433293288744, "mean_action_processing_ms": 0.47267312837228614, "mean_env_wait_ms": 20.604638968499057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03084111213684082, "StateBufferConnector_ms": 0.012029170989990234, "ViewRequirementAgentConnector_ms": 0.7240746021270752}}, "episode_reward_max": 28.33593478795615, "episode_reward_min": -45.73512452822024, "episode_reward_mean": 2.1455786418089606, "episode_len_mean": 518.33, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-5.019983241257129, 15.851833074551, 27.175061037558542, 9.6397751620956, -6.079646569768005, 25.540432466426097, 11.698712356843451, 20.314414808822665, -20.23305687751804, 11.86170077862628, -5.050372273349697, -17.098220122525625, -15.83101484353593, 8.359269532920587, 13.821682057159814, -5.025497565494016, 19.95894780381941, -4.085716810794045, 1.161041478686475, 2.9691420845676, 13.056085062909231, 16.29980326863332, 4.434843148157348, -0.8240560224876177, -4.907826435803298, 10.323834041326826, 4.311228604333766, -16.624255112578524, 3.9889694208921083, -7.645522104270397, 15.679341809161187, -3.7281276367745204, -23.672587081662016, -2.773381060382596, 15.324257202811843, -11.439418289274222, -6.432837310550895, 4.771397505376575, -10.725535600033954, 15.707428410726308, 2.1765275448937844, 7.6207805881654895, -14.961259338106794, 3.6570037146716308, 7.146386045900513, 11.596452128454938, -13.995456876714979, -16.157754866570823, -11.840335609075945, 1.8675445803199024, 9.854141808224693, 4.143184044160587, 14.106022528129145, 17.893603379451072, -9.872003465343875, 11.57347500369179, 2.402628000415567, 6.1631835727632795, 5.518172988586242, -15.77584939159059, 4.754380347137223, -17.402424994041365, 2.286675579602615, 3.8087999764635097, -20.003531453490385, 10.977762454819745, 2.316650609554288, 25.618283318832727, 2.9608081240013684, 17.590565549919795, 9.841174393779278, 10.72392126497807, -12.494313233202663, -20.695221331562742, -8.099898171193114, 6.9468417567030105, 7.592066493708884, 28.33593478795615, 7.819755672374823, 8.045658130436234, 8.112486006032599, 9.240467392562888, -15.798559128481429, 6.060658932551257, 10.468931064712732, 7.102437262560008, 6.053831222954919, -10.920526930974765, 2.4305514425715398, 8.66759047144039, 10.181414686400204, -1.8006472401239075, 25.069925499353275, 17.4185190265745, 0.46298453308503396, -12.742283490886821, -45.73512452822024, -12.195594083537356, 23.82881637000662, -20.44049614323399], "episode_lengths": [761, 294, 1117, 232, 302, 1117, 1005, 288, 834, 259, 439, 1117, 648, 269, 259, 318, 302, 323, 244, 372, 206, 259, 96, 439, 406, 764, 232, 408, 1117, 406, 259, 567, 858, 373, 232, 615, 680, 190, 531, 299, 139, 786, 956, 794, 148, 323, 1117, 758, 406, 763, 148, 385, 1078, 791, 406, 325, 297, 295, 288, 614, 1106, 398, 295, 863, 640, 1117, 376, 1117, 295, 239, 273, 259, 766, 630, 556, 1117, 259, 881, 168, 259, 317, 382, 486, 300, 269, 1117, 91, 761, 373, 148, 261, 410, 934, 259, 317, 490, 680, 795, 1117, 458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.159008042417421, "mean_inference_ms": 6.815433293288744, "mean_action_processing_ms": 0.47267312837228614, "mean_env_wait_ms": 20.604638968499057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03084111213684082, "StateBufferConnector_ms": 0.012029170989990234, "ViewRequirementAgentConnector_ms": 0.7240746021270752}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65092, "num_agent_steps_trained": 65092, "num_env_steps_sampled": 65092, "num_env_steps_trained": 65092, "num_env_steps_sampled_this_iter": 8211, "num_env_steps_trained_this_iter": 8211, "num_env_steps_sampled_throughput_per_sec": 237.27314182740685, "num_env_steps_trained_throughput_per_sec": 237.27314182740685, "timesteps_total": 65092, "num_steps_trained_this_iter": 8211, "agent_timesteps_total": 65092, "timers": {"training_iteration_time_ms": 32547.309, "sample_time_ms": 26263.275, "load_time_ms": 954.283, "load_throughput": 7578.928, "learn_time_ms": 4812.223, "learn_throughput": 1502.932, "synch_weights_time_ms": 457.293}, "counters": {"num_env_steps_sampled": 65092, "num_env_steps_trained": 65092, "num_agent_steps_sampled": 65092, "num_agent_steps_trained": 65092}, "done": false, "episodes_total": 128, "training_iteration": 9, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-40-13", "timestamp": 1749300013, "time_this_iter_s": 34.62321209907532, "time_total_s": 293.0709047317505, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 293.0709047317505, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 59.02439024390244, "ram_util_percent": 60.617073170731715, "gpu_util_percent0": 0.05292682926829268, "vram_util_percent0": 0.82958984375}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.9656019869399155, "episode_reward_min": -7.06046319677002, "episode_reward_mean": -4.279192803855519, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.06046319677002, -6.11017118930351, -3.7060410109052007, -2.553686635358951, -1.9656019869399155], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4604093197502608, "mean_inference_ms": 3.387555496182685, "mean_action_processing_ms": 0.31767813054021615, "mean_env_wait_ms": 10.964509589146584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01995086669921875, "ViewRequirementAgentConnector_ms": 0.32029151916503906}}, "episode_reward_max": -1.9656019869399155, "episode_reward_min": -7.06046319677002, "episode_reward_mean": -4.279192803855519, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.06046319677002, -6.11017118930351, -3.7060410109052007, -2.553686635358951, -1.9656019869399155], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4604093197502608, "mean_inference_ms": 3.387555496182685, "mean_action_processing_ms": 0.31767813054021615, "mean_env_wait_ms": 10.964509589146584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01995086669921875, "ViewRequirementAgentConnector_ms": 0.32029151916503906}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.934908e-05, "total_loss": -0.12728110348913246, "policy_loss": -0.017210374557628083, "vf_loss": 0.09270172879601327, "vf_explained_var": 0.8948294155872785, "kl": 0.009033934043761222, "entropy": 14.28115090590257, "entropy_coeff": 0.00967454}, "model": {}, "num_grad_updates_lifetime": 2410.5, "diff_num_grad_updates_vs_sampler_policy": 129.5}}, "num_env_steps_sampled": 72589, "num_env_steps_trained": 72589, "num_agent_steps_sampled": 72589, "num_agent_steps_trained": 72589}, "sampler_results": {"episode_reward_max": 28.33593478795615, "episode_reward_min": -45.73512452822024, "episode_reward_mean": 1.6342585907157092, "episode_len_mean": 506.48, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.821682057159814, -5.025497565494016, 19.95894780381941, -4.085716810794045, 1.161041478686475, 2.9691420845676, 13.056085062909231, 16.29980326863332, 4.434843148157348, -0.8240560224876177, -4.907826435803298, 10.323834041326826, 4.311228604333766, -16.624255112578524, 3.9889694208921083, -7.645522104270397, 15.679341809161187, -3.7281276367745204, -23.672587081662016, -2.773381060382596, 15.324257202811843, -11.439418289274222, -6.432837310550895, 4.771397505376575, -10.725535600033954, 15.707428410726308, 2.1765275448937844, 7.6207805881654895, -14.961259338106794, 3.6570037146716308, 7.146386045900513, 11.596452128454938, -13.995456876714979, -16.157754866570823, -11.840335609075945, 1.8675445803199024, 9.854141808224693, 4.143184044160587, 14.106022528129145, 17.893603379451072, -9.872003465343875, 11.57347500369179, 2.402628000415567, 6.1631835727632795, 5.518172988586242, -15.77584939159059, 4.754380347137223, -17.402424994041365, 2.286675579602615, 3.8087999764635097, -20.003531453490385, 10.977762454819745, 2.316650609554288, 25.618283318832727, 2.9608081240013684, 17.590565549919795, 9.841174393779278, 10.72392126497807, -12.494313233202663, -20.695221331562742, -8.099898171193114, 6.9468417567030105, 7.592066493708884, 28.33593478795615, 7.819755672374823, 8.045658130436234, 8.112486006032599, 9.240467392562888, -15.798559128481429, 6.060658932551257, 10.468931064712732, 7.102437262560008, 6.053831222954919, -10.920526930974765, 2.4305514425715398, 8.66759047144039, 10.181414686400204, -1.8006472401239075, 25.069925499353275, 17.4185190265745, 0.46298453308503396, -12.742283490886821, -45.73512452822024, -12.195594083537356, 23.82881637000662, -20.44049614323399, 6.237922963664953, 18.16739448069303, -1.713756907248119, -37.64671927571364, 10.875927177016967, 19.091255870053086, 15.810183143373383, -43.5787429909403, 2.838845735047856, 8.331728121817543, 19.529627664757367, 12.969187517059678, -12.1860198037697, -8.729933515247453], "episode_lengths": [259, 318, 302, 323, 244, 372, 206, 259, 96, 439, 406, 764, 232, 408, 1117, 406, 259, 567, 858, 373, 232, 615, 680, 190, 531, 299, 139, 786, 956, 794, 148, 323, 1117, 758, 406, 763, 148, 385, 1078, 791, 406, 325, 297, 295, 288, 614, 1106, 398, 295, 863, 640, 1117, 376, 1117, 295, 239, 273, 259, 766, 630, 556, 1117, 259, 881, 168, 259, 317, 382, 486, 300, 269, 1117, 91, 761, 373, 148, 261, 410, 934, 259, 317, 490, 680, 795, 1117, 458, 308, 1117, 377, 416, 230, 1117, 814, 680, 295, 321, 259, 295, 653, 615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1308430965287344, "mean_inference_ms": 6.774052501519649, "mean_action_processing_ms": 0.4686924043677335, "mean_env_wait_ms": 20.411157773862957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029801368713378906, "StateBufferConnector_ms": 0.010035037994384766, "ViewRequirementAgentConnector_ms": 0.7109279632568359}}, "episode_reward_max": 28.33593478795615, "episode_reward_min": -45.73512452822024, "episode_reward_mean": 1.6342585907157092, "episode_len_mean": 506.48, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.821682057159814, -5.025497565494016, 19.95894780381941, -4.085716810794045, 1.161041478686475, 2.9691420845676, 13.056085062909231, 16.29980326863332, 4.434843148157348, -0.8240560224876177, -4.907826435803298, 10.323834041326826, 4.311228604333766, -16.624255112578524, 3.9889694208921083, -7.645522104270397, 15.679341809161187, -3.7281276367745204, -23.672587081662016, -2.773381060382596, 15.324257202811843, -11.439418289274222, -6.432837310550895, 4.771397505376575, -10.725535600033954, 15.707428410726308, 2.1765275448937844, 7.6207805881654895, -14.961259338106794, 3.6570037146716308, 7.146386045900513, 11.596452128454938, -13.995456876714979, -16.157754866570823, -11.840335609075945, 1.8675445803199024, 9.854141808224693, 4.143184044160587, 14.106022528129145, 17.893603379451072, -9.872003465343875, 11.57347500369179, 2.402628000415567, 6.1631835727632795, 5.518172988586242, -15.77584939159059, 4.754380347137223, -17.402424994041365, 2.286675579602615, 3.8087999764635097, -20.003531453490385, 10.977762454819745, 2.316650609554288, 25.618283318832727, 2.9608081240013684, 17.590565549919795, 9.841174393779278, 10.72392126497807, -12.494313233202663, -20.695221331562742, -8.099898171193114, 6.9468417567030105, 7.592066493708884, 28.33593478795615, 7.819755672374823, 8.045658130436234, 8.112486006032599, 9.240467392562888, -15.798559128481429, 6.060658932551257, 10.468931064712732, 7.102437262560008, 6.053831222954919, -10.920526930974765, 2.4305514425715398, 8.66759047144039, 10.181414686400204, -1.8006472401239075, 25.069925499353275, 17.4185190265745, 0.46298453308503396, -12.742283490886821, -45.73512452822024, -12.195594083537356, 23.82881637000662, -20.44049614323399, 6.237922963664953, 18.16739448069303, -1.713756907248119, -37.64671927571364, 10.875927177016967, 19.091255870053086, 15.810183143373383, -43.5787429909403, 2.838845735047856, 8.331728121817543, 19.529627664757367, 12.969187517059678, -12.1860198037697, -8.729933515247453], "episode_lengths": [259, 318, 302, 323, 244, 372, 206, 259, 96, 439, 406, 764, 232, 408, 1117, 406, 259, 567, 858, 373, 232, 615, 680, 190, 531, 299, 139, 786, 956, 794, 148, 323, 1117, 758, 406, 763, 148, 385, 1078, 791, 406, 325, 297, 295, 288, 614, 1106, 398, 295, 863, 640, 1117, 376, 1117, 295, 239, 273, 259, 766, 630, 556, 1117, 259, 881, 168, 259, 317, 382, 486, 300, 269, 1117, 91, 761, 373, 148, 261, 410, 934, 259, 317, 490, 680, 795, 1117, 458, 308, 1117, 377, 416, 230, 1117, 814, 680, 295, 321, 259, 295, 653, 615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1308430965287344, "mean_inference_ms": 6.774052501519649, "mean_action_processing_ms": 0.4686924043677335, "mean_env_wait_ms": 20.411157773862957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029801368713378906, "StateBufferConnector_ms": 0.010035037994384766, "ViewRequirementAgentConnector_ms": 0.7109279632568359}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72589, "num_agent_steps_trained": 72589, "num_env_steps_sampled": 72589, "num_env_steps_trained": 72589, "num_env_steps_sampled_this_iter": 7497, "num_env_steps_trained_this_iter": 7497, "num_env_steps_sampled_throughput_per_sec": 228.19129719428096, "num_env_steps_trained_throughput_per_sec": 228.19129719428096, "timesteps_total": 72589, "num_steps_trained_this_iter": 7497, "agent_timesteps_total": 72589, "timers": {"training_iteration_time_ms": 32577.98, "sample_time_ms": 26308.315, "load_time_ms": 944.633, "load_throughput": 7684.359, "learn_time_ms": 4808.311, "learn_throughput": 1509.657, "synch_weights_time_ms": 456.004}, "counters": {"num_env_steps_sampled": 72589, "num_env_steps_trained": 72589, "num_agent_steps_sampled": 72589, "num_agent_steps_trained": 72589}, "done": false, "episodes_total": 142, "training_iteration": 10, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-41-01", "timestamp": 1749300061, "time_this_iter_s": 47.882599115371704, "time_total_s": 340.9535038471222, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 340.9535038471222, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 46.91034482758621, "ram_util_percent": 60.76551724137932, "gpu_util_percent0": 0.04017241379310345, "vram_util_percent0": 0.82958984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.927411000000002e-05, "total_loss": -0.16692343872536214, "policy_loss": -0.05662583644922462, "vf_loss": 0.08985251626600661, "vf_explained_var": 0.9028924601693307, "kl": 0.008046994997365267, "entropy": 14.268345509805988, "entropy_coeff": 0.009637055000000002}, "model": {}, "num_grad_updates_lifetime": 2695.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 81269, "num_env_steps_trained": 81269, "num_agent_steps_sampled": 81269, "num_agent_steps_trained": 81269}, "sampler_results": {"episode_reward_max": 28.33593478795615, "episode_reward_min": -45.73512452822024, "episode_reward_mean": 0.7229698764656434, "episode_len_mean": 547.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.9889694208921083, -7.645522104270397, 15.679341809161187, -3.7281276367745204, -23.672587081662016, -2.773381060382596, 15.324257202811843, -11.439418289274222, -6.432837310550895, 4.771397505376575, -10.725535600033954, 15.707428410726308, 2.1765275448937844, 7.6207805881654895, -14.961259338106794, 3.6570037146716308, 7.146386045900513, 11.596452128454938, -13.995456876714979, -16.157754866570823, -11.840335609075945, 1.8675445803199024, 9.854141808224693, 4.143184044160587, 14.106022528129145, 17.893603379451072, -9.872003465343875, 11.57347500369179, 2.402628000415567, 6.1631835727632795, 5.518172988586242, -15.77584939159059, 4.754380347137223, -17.402424994041365, 2.286675579602615, 3.8087999764635097, -20.003531453490385, 10.977762454819745, 2.316650609554288, 25.618283318832727, 2.9608081240013684, 17.590565549919795, 9.841174393779278, 10.72392126497807, -12.494313233202663, -20.695221331562742, -8.099898171193114, 6.9468417567030105, 7.592066493708884, 28.33593478795615, 7.819755672374823, 8.045658130436234, 8.112486006032599, 9.240467392562888, -15.798559128481429, 6.060658932551257, 10.468931064712732, 7.102437262560008, 6.053831222954919, -10.920526930974765, 2.4305514425715398, 8.66759047144039, 10.181414686400204, -1.8006472401239075, 25.069925499353275, 17.4185190265745, 0.46298453308503396, -12.742283490886821, -45.73512452822024, -12.195594083537356, 23.82881637000662, -20.44049614323399, 6.237922963664953, 18.16739448069303, -1.713756907248119, -37.64671927571364, 10.875927177016967, 19.091255870053086, 15.810183143373383, -43.5787429909403, 2.838845735047856, 8.331728121817543, 19.529627664757367, 12.969187517059678, -12.1860198037697, -8.729933515247453, 8.806749483208975, -41.39594320104065, -5.817913134193094, 12.924028189377632, -13.704070454807114, 9.200067800670064, 5.063186109281624, 11.329289573341972, 2.062369991724343, 6.448907477938909, -6.840045964016475, -25.912658014071408, -0.7128043771173518, 2.2892206971322904], "episode_lengths": [1117, 406, 259, 567, 858, 373, 232, 615, 680, 190, 531, 299, 139, 786, 956, 794, 148, 323, 1117, 758, 406, 763, 148, 385, 1078, 791, 406, 325, 297, 295, 288, 614, 1106, 398, 295, 863, 640, 1117, 376, 1117, 295, 239, 273, 259, 766, 630, 556, 1117, 259, 881, 168, 259, 317, 382, 486, 300, 269, 1117, 91, 761, 373, 148, 261, 410, 934, 259, 317, 490, 680, 795, 1117, 458, 308, 1117, 377, 416, 230, 1117, 814, 680, 295, 321, 259, 295, 653, 615, 269, 757, 373, 795, 440, 148, 831, 288, 307, 1117, 848, 537, 853, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.109168436500947, "mean_inference_ms": 6.763866847408234, "mean_action_processing_ms": 0.4671394762539131, "mean_env_wait_ms": 20.309854800838572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03282284736633301, "StateBufferConnector_ms": 0.013022184371948242, "ViewRequirementAgentConnector_ms": 0.698145866394043}}, "episode_reward_max": 28.33593478795615, "episode_reward_min": -45.73512452822024, "episode_reward_mean": 0.7229698764656434, "episode_len_mean": 547.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.9889694208921083, -7.645522104270397, 15.679341809161187, -3.7281276367745204, -23.672587081662016, -2.773381060382596, 15.324257202811843, -11.439418289274222, -6.432837310550895, 4.771397505376575, -10.725535600033954, 15.707428410726308, 2.1765275448937844, 7.6207805881654895, -14.961259338106794, 3.6570037146716308, 7.146386045900513, 11.596452128454938, -13.995456876714979, -16.157754866570823, -11.840335609075945, 1.8675445803199024, 9.854141808224693, 4.143184044160587, 14.106022528129145, 17.893603379451072, -9.872003465343875, 11.57347500369179, 2.402628000415567, 6.1631835727632795, 5.518172988586242, -15.77584939159059, 4.754380347137223, -17.402424994041365, 2.286675579602615, 3.8087999764635097, -20.003531453490385, 10.977762454819745, 2.316650609554288, 25.618283318832727, 2.9608081240013684, 17.590565549919795, 9.841174393779278, 10.72392126497807, -12.494313233202663, -20.695221331562742, -8.099898171193114, 6.9468417567030105, 7.592066493708884, 28.33593478795615, 7.819755672374823, 8.045658130436234, 8.112486006032599, 9.240467392562888, -15.798559128481429, 6.060658932551257, 10.468931064712732, 7.102437262560008, 6.053831222954919, -10.920526930974765, 2.4305514425715398, 8.66759047144039, 10.181414686400204, -1.8006472401239075, 25.069925499353275, 17.4185190265745, 0.46298453308503396, -12.742283490886821, -45.73512452822024, -12.195594083537356, 23.82881637000662, -20.44049614323399, 6.237922963664953, 18.16739448069303, -1.713756907248119, -37.64671927571364, 10.875927177016967, 19.091255870053086, 15.810183143373383, -43.5787429909403, 2.838845735047856, 8.331728121817543, 19.529627664757367, 12.969187517059678, -12.1860198037697, -8.729933515247453, 8.806749483208975, -41.39594320104065, -5.817913134193094, 12.924028189377632, -13.704070454807114, 9.200067800670064, 5.063186109281624, 11.329289573341972, 2.062369991724343, 6.448907477938909, -6.840045964016475, -25.912658014071408, -0.7128043771173518, 2.2892206971322904], "episode_lengths": [1117, 406, 259, 567, 858, 373, 232, 615, 680, 190, 531, 299, 139, 786, 956, 794, 148, 323, 1117, 758, 406, 763, 148, 385, 1078, 791, 406, 325, 297, 295, 288, 614, 1106, 398, 295, 863, 640, 1117, 376, 1117, 295, 239, 273, 259, 766, 630, 556, 1117, 259, 881, 168, 259, 317, 382, 486, 300, 269, 1117, 91, 761, 373, 148, 261, 410, 934, 259, 317, 490, 680, 795, 1117, 458, 308, 1117, 377, 416, 230, 1117, 814, 680, 295, 321, 259, 295, 653, 615, 269, 757, 373, 795, 440, 148, 831, 288, 307, 1117, 848, 537, 853, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.109168436500947, "mean_inference_ms": 6.763866847408234, "mean_action_processing_ms": 0.4671394762539131, "mean_env_wait_ms": 20.309854800838572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03282284736633301, "StateBufferConnector_ms": 0.013022184371948242, "ViewRequirementAgentConnector_ms": 0.698145866394043}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81269, "num_agent_steps_trained": 81269, "num_env_steps_sampled": 81269, "num_env_steps_trained": 81269, "num_env_steps_sampled_this_iter": 8680, "num_env_steps_trained_this_iter": 8680, "num_env_steps_sampled_throughput_per_sec": 204.69279232504329, "num_env_steps_trained_throughput_per_sec": 204.69279232504329, "timesteps_total": 81269, "num_steps_trained_this_iter": 8680, "agent_timesteps_total": 81269, "timers": {"training_iteration_time_ms": 33489.145, "sample_time_ms": 27070.546, "load_time_ms": 875.259, "load_throughput": 8562.261, "learn_time_ms": 5020.943, "learn_throughput": 1492.588, "synch_weights_time_ms": 459.634}, "counters": {"num_env_steps_sampled": 81269, "num_env_steps_trained": 81269, "num_agent_steps_sampled": 81269, "num_agent_steps_trained": 81269}, "done": false, "episodes_total": 156, "training_iteration": 11, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-41-44", "timestamp": 1749300104, "time_this_iter_s": 42.422810316085815, "time_total_s": 383.376314163208, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 383.376314163208, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 62.407999999999994, "ram_util_percent": 62.065999999999995, "gpu_util_percent0": 0.05, "vram_util_percent0": 0.82958984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.918731e-05, "total_loss": -0.12408404249542704, "policy_loss": -0.01589072957634926, "vf_loss": 0.09391536456532776, "vf_explained_var": 0.9207423241933187, "kl": 0.009044667953179063, "entropy": 14.243847901026408, "entropy_coeff": 0.009593655}, "model": {}, "num_grad_updates_lifetime": 3000.5, "diff_num_grad_updates_vs_sampler_policy": 149.5}}, "num_env_steps_sampled": 89681, "num_env_steps_trained": 89681, "num_agent_steps_sampled": 89681, "num_agent_steps_trained": 89681}, "sampler_results": {"episode_reward_max": 28.33593478795615, "episode_reward_min": -47.67570706960651, "episode_reward_mean": 0.4241717530024776, "episode_len_mean": 560.6, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.961259338106794, 3.6570037146716308, 7.146386045900513, 11.596452128454938, -13.995456876714979, -16.157754866570823, -11.840335609075945, 1.8675445803199024, 9.854141808224693, 4.143184044160587, 14.106022528129145, 17.893603379451072, -9.872003465343875, 11.57347500369179, 2.402628000415567, 6.1631835727632795, 5.518172988586242, -15.77584939159059, 4.754380347137223, -17.402424994041365, 2.286675579602615, 3.8087999764635097, -20.003531453490385, 10.977762454819745, 2.316650609554288, 25.618283318832727, 2.9608081240013684, 17.590565549919795, 9.841174393779278, 10.72392126497807, -12.494313233202663, -20.695221331562742, -8.099898171193114, 6.9468417567030105, 7.592066493708884, 28.33593478795615, 7.819755672374823, 8.045658130436234, 8.112486006032599, 9.240467392562888, -15.798559128481429, 6.060658932551257, 10.468931064712732, 7.102437262560008, 6.053831222954919, -10.920526930974765, 2.4305514425715398, 8.66759047144039, 10.181414686400204, -1.8006472401239075, 25.069925499353275, 17.4185190265745, 0.46298453308503396, -12.742283490886821, -45.73512452822024, -12.195594083537356, 23.82881637000662, -20.44049614323399, 6.237922963664953, 18.16739448069303, -1.713756907248119, -37.64671927571364, 10.875927177016967, 19.091255870053086, 15.810183143373383, -43.5787429909403, 2.838845735047856, 8.331728121817543, 19.529627664757367, 12.969187517059678, -12.1860198037697, -8.729933515247453, 8.806749483208975, -41.39594320104065, -5.817913134193094, 12.924028189377632, -13.704070454807114, 9.200067800670064, 5.063186109281624, 11.329289573341972, 2.062369991724343, 6.448907477938909, -6.840045964016475, -25.912658014071408, -0.7128043771173518, 2.2892206971322904, 4.79217139220945, 10.884793671971936, 7.945776003749275, 12.889810856616352, -10.44747935219388, -21.97639895417863, -13.082718873367376, 16.52920370517329, -10.846327569806316, 9.489426760481992, -1.910432659820717, 2.112866572328636, -47.67570706960651, 10.266496569204627], "episode_lengths": [956, 794, 148, 323, 1117, 758, 406, 763, 148, 385, 1078, 791, 406, 325, 297, 295, 288, 614, 1106, 398, 295, 863, 640, 1117, 376, 1117, 295, 239, 273, 259, 766, 630, 556, 1117, 259, 881, 168, 259, 317, 382, 486, 300, 269, 1117, 91, 761, 373, 148, 261, 410, 934, 259, 317, 490, 680, 795, 1117, 458, 308, 1117, 377, 416, 230, 1117, 814, 680, 295, 321, 259, 295, 653, 615, 269, 757, 373, 795, 440, 148, 831, 288, 307, 1117, 848, 537, 853, 1117, 295, 295, 373, 295, 767, 561, 757, 259, 824, 978, 335, 1117, 439, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0903153477916177, "mean_inference_ms": 6.765063789598827, "mean_action_processing_ms": 0.4662697609434485, "mean_env_wait_ms": 20.258010067723923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01695561408996582, "StateBufferConnector_ms": 0.014034509658813477, "ViewRequirementAgentConnector_ms": 0.739058256149292}}, "episode_reward_max": 28.33593478795615, "episode_reward_min": -47.67570706960651, "episode_reward_mean": 0.4241717530024776, "episode_len_mean": 560.6, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.961259338106794, 3.6570037146716308, 7.146386045900513, 11.596452128454938, -13.995456876714979, -16.157754866570823, -11.840335609075945, 1.8675445803199024, 9.854141808224693, 4.143184044160587, 14.106022528129145, 17.893603379451072, -9.872003465343875, 11.57347500369179, 2.402628000415567, 6.1631835727632795, 5.518172988586242, -15.77584939159059, 4.754380347137223, -17.402424994041365, 2.286675579602615, 3.8087999764635097, -20.003531453490385, 10.977762454819745, 2.316650609554288, 25.618283318832727, 2.9608081240013684, 17.590565549919795, 9.841174393779278, 10.72392126497807, -12.494313233202663, -20.695221331562742, -8.099898171193114, 6.9468417567030105, 7.592066493708884, 28.33593478795615, 7.819755672374823, 8.045658130436234, 8.112486006032599, 9.240467392562888, -15.798559128481429, 6.060658932551257, 10.468931064712732, 7.102437262560008, 6.053831222954919, -10.920526930974765, 2.4305514425715398, 8.66759047144039, 10.181414686400204, -1.8006472401239075, 25.069925499353275, 17.4185190265745, 0.46298453308503396, -12.742283490886821, -45.73512452822024, -12.195594083537356, 23.82881637000662, -20.44049614323399, 6.237922963664953, 18.16739448069303, -1.713756907248119, -37.64671927571364, 10.875927177016967, 19.091255870053086, 15.810183143373383, -43.5787429909403, 2.838845735047856, 8.331728121817543, 19.529627664757367, 12.969187517059678, -12.1860198037697, -8.729933515247453, 8.806749483208975, -41.39594320104065, -5.817913134193094, 12.924028189377632, -13.704070454807114, 9.200067800670064, 5.063186109281624, 11.329289573341972, 2.062369991724343, 6.448907477938909, -6.840045964016475, -25.912658014071408, -0.7128043771173518, 2.2892206971322904, 4.79217139220945, 10.884793671971936, 7.945776003749275, 12.889810856616352, -10.44747935219388, -21.97639895417863, -13.082718873367376, 16.52920370517329, -10.846327569806316, 9.489426760481992, -1.910432659820717, 2.112866572328636, -47.67570706960651, 10.266496569204627], "episode_lengths": [956, 794, 148, 323, 1117, 758, 406, 763, 148, 385, 1078, 791, 406, 325, 297, 295, 288, 614, 1106, 398, 295, 863, 640, 1117, 376, 1117, 295, 239, 273, 259, 766, 630, 556, 1117, 259, 881, 168, 259, 317, 382, 486, 300, 269, 1117, 91, 761, 373, 148, 261, 410, 934, 259, 317, 490, 680, 795, 1117, 458, 308, 1117, 377, 416, 230, 1117, 814, 680, 295, 321, 259, 295, 653, 615, 269, 757, 373, 795, 440, 148, 831, 288, 307, 1117, 848, 537, 853, 1117, 295, 295, 373, 295, 767, 561, 757, 259, 824, 978, 335, 1117, 439, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0903153477916177, "mean_inference_ms": 6.765063789598827, "mean_action_processing_ms": 0.4662697609434485, "mean_env_wait_ms": 20.258010067723923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01695561408996582, "StateBufferConnector_ms": 0.014034509658813477, "ViewRequirementAgentConnector_ms": 0.739058256149292}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89681, "num_agent_steps_trained": 89681, "num_env_steps_sampled": 89681, "num_env_steps_trained": 89681, "num_env_steps_sampled_this_iter": 8412, "num_env_steps_trained_this_iter": 8412, "num_env_steps_sampled_throughput_per_sec": 212.8628114006407, "num_env_steps_trained_throughput_per_sec": 212.8628114006407, "timesteps_total": 89681, "num_steps_trained_this_iter": 8412, "agent_timesteps_total": 89681, "timers": {"training_iteration_time_ms": 34437.619, "sample_time_ms": 27844.099, "load_time_ms": 907.807, "load_throughput": 8418.311, "learn_time_ms": 5159.677, "learn_throughput": 1481.139, "synch_weights_time_ms": 462.051}, "counters": {"num_env_steps_sampled": 89681, "num_env_steps_trained": 89681, "num_agent_steps_sampled": 89681, "num_agent_steps_trained": 89681}, "done": false, "episodes_total": 170, "training_iteration": 12, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-42-23", "timestamp": 1749300143, "time_this_iter_s": 39.536407470703125, "time_total_s": 422.91272163391113, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 422.91272163391113, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 58.15833333333333, "ram_util_percent": 62.56666666666666, "gpu_util_percent0": 0.055625, "vram_util_percent0": 0.8551025390625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.910318999999999e-05, "total_loss": -0.1105734009457671, "policy_loss": 0.004602713819653929, "vf_loss": 0.06664758669617384, "vf_explained_var": 0.9390113066072049, "kl": 0.008442283505840064, "entropy": 14.179224943078083, "entropy_coeff": 0.009551595}, "model": {}, "num_grad_updates_lifetime": 3265.5, "diff_num_grad_updates_vs_sampler_policy": 114.5}}, "num_env_steps_sampled": 96349, "num_env_steps_trained": 96349, "num_agent_steps_sampled": 96349, "num_agent_steps_trained": 96349}, "sampler_results": {"episode_reward_max": 28.33593478795615, "episode_reward_min": -47.67570706960651, "episode_reward_mean": 1.2357266458583627, "episode_len_mean": 543.3, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.402628000415567, 6.1631835727632795, 5.518172988586242, -15.77584939159059, 4.754380347137223, -17.402424994041365, 2.286675579602615, 3.8087999764635097, -20.003531453490385, 10.977762454819745, 2.316650609554288, 25.618283318832727, 2.9608081240013684, 17.590565549919795, 9.841174393779278, 10.72392126497807, -12.494313233202663, -20.695221331562742, -8.099898171193114, 6.9468417567030105, 7.592066493708884, 28.33593478795615, 7.819755672374823, 8.045658130436234, 8.112486006032599, 9.240467392562888, -15.798559128481429, 6.060658932551257, 10.468931064712732, 7.102437262560008, 6.053831222954919, -10.920526930974765, 2.4305514425715398, 8.66759047144039, 10.181414686400204, -1.8006472401239075, 25.069925499353275, 17.4185190265745, 0.46298453308503396, -12.742283490886821, -45.73512452822024, -12.195594083537356, 23.82881637000662, -20.44049614323399, 6.237922963664953, 18.16739448069303, -1.713756907248119, -37.64671927571364, 10.875927177016967, 19.091255870053086, 15.810183143373383, -43.5787429909403, 2.838845735047856, 8.331728121817543, 19.529627664757367, 12.969187517059678, -12.1860198037697, -8.729933515247453, 8.806749483208975, -41.39594320104065, -5.817913134193094, 12.924028189377632, -13.704070454807114, 9.200067800670064, 5.063186109281624, 11.329289573341972, 2.062369991724343, 6.448907477938909, -6.840045964016475, -25.912658014071408, -0.7128043771173518, 2.2892206971322904, 4.79217139220945, 10.884793671971936, 7.945776003749275, 12.889810856616352, -10.44747935219388, -21.97639895417863, -13.082718873367376, 16.52920370517329, -10.846327569806316, 9.489426760481992, -1.910432659820717, 2.112866572328636, -47.67570706960651, 10.266496569204627, 2.699666710247885, 8.311576955103657, 5.614579088742406, 18.700275856738962, 6.963028194363777, 0.8306850850948106, -6.708770797546159, 6.386722739833978, -5.458538489726993, 14.31195196084186, 16.028751812955488, 10.341440310494072, 16.3686742098532, 1.7764487257834374], "episode_lengths": [297, 295, 288, 614, 1106, 398, 295, 863, 640, 1117, 376, 1117, 295, 239, 273, 259, 766, 630, 556, 1117, 259, 881, 168, 259, 317, 382, 486, 300, 269, 1117, 91, 761, 373, 148, 261, 410, 934, 259, 317, 490, 680, 795, 1117, 458, 308, 1117, 377, 416, 230, 1117, 814, 680, 295, 321, 259, 295, 653, 615, 269, 757, 373, 795, 440, 148, 831, 288, 307, 1117, 848, 537, 853, 1117, 295, 295, 373, 295, 767, 561, 757, 259, 824, 978, 335, 1117, 439, 1117, 407, 932, 394, 308, 170, 376, 411, 372, 1077, 270, 269, 269, 296, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.078921469102321, "mean_inference_ms": 6.783855880860472, "mean_action_processing_ms": 0.46704291198000275, "mean_env_wait_ms": 20.264335747864145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025935888290405273, "StateBufferConnector_ms": 0.01301264762878418, "ViewRequirementAgentConnector_ms": 0.7529823780059814}}, "episode_reward_max": 28.33593478795615, "episode_reward_min": -47.67570706960651, "episode_reward_mean": 1.2357266458583627, "episode_len_mean": 543.3, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.402628000415567, 6.1631835727632795, 5.518172988586242, -15.77584939159059, 4.754380347137223, -17.402424994041365, 2.286675579602615, 3.8087999764635097, -20.003531453490385, 10.977762454819745, 2.316650609554288, 25.618283318832727, 2.9608081240013684, 17.590565549919795, 9.841174393779278, 10.72392126497807, -12.494313233202663, -20.695221331562742, -8.099898171193114, 6.9468417567030105, 7.592066493708884, 28.33593478795615, 7.819755672374823, 8.045658130436234, 8.112486006032599, 9.240467392562888, -15.798559128481429, 6.060658932551257, 10.468931064712732, 7.102437262560008, 6.053831222954919, -10.920526930974765, 2.4305514425715398, 8.66759047144039, 10.181414686400204, -1.8006472401239075, 25.069925499353275, 17.4185190265745, 0.46298453308503396, -12.742283490886821, -45.73512452822024, -12.195594083537356, 23.82881637000662, -20.44049614323399, 6.237922963664953, 18.16739448069303, -1.713756907248119, -37.64671927571364, 10.875927177016967, 19.091255870053086, 15.810183143373383, -43.5787429909403, 2.838845735047856, 8.331728121817543, 19.529627664757367, 12.969187517059678, -12.1860198037697, -8.729933515247453, 8.806749483208975, -41.39594320104065, -5.817913134193094, 12.924028189377632, -13.704070454807114, 9.200067800670064, 5.063186109281624, 11.329289573341972, 2.062369991724343, 6.448907477938909, -6.840045964016475, -25.912658014071408, -0.7128043771173518, 2.2892206971322904, 4.79217139220945, 10.884793671971936, 7.945776003749275, 12.889810856616352, -10.44747935219388, -21.97639895417863, -13.082718873367376, 16.52920370517329, -10.846327569806316, 9.489426760481992, -1.910432659820717, 2.112866572328636, -47.67570706960651, 10.266496569204627, 2.699666710247885, 8.311576955103657, 5.614579088742406, 18.700275856738962, 6.963028194363777, 0.8306850850948106, -6.708770797546159, 6.386722739833978, -5.458538489726993, 14.31195196084186, 16.028751812955488, 10.341440310494072, 16.3686742098532, 1.7764487257834374], "episode_lengths": [297, 295, 288, 614, 1106, 398, 295, 863, 640, 1117, 376, 1117, 295, 239, 273, 259, 766, 630, 556, 1117, 259, 881, 168, 259, 317, 382, 486, 300, 269, 1117, 91, 761, 373, 148, 261, 410, 934, 259, 317, 490, 680, 795, 1117, 458, 308, 1117, 377, 416, 230, 1117, 814, 680, 295, 321, 259, 295, 653, 615, 269, 757, 373, 795, 440, 148, 831, 288, 307, 1117, 848, 537, 853, 1117, 295, 295, 373, 295, 767, 561, 757, 259, 824, 978, 335, 1117, 439, 1117, 407, 932, 394, 308, 170, 376, 411, 372, 1077, 270, 269, 269, 296, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.078921469102321, "mean_inference_ms": 6.783855880860472, "mean_action_processing_ms": 0.46704291198000275, "mean_env_wait_ms": 20.264335747864145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025935888290405273, "StateBufferConnector_ms": 0.01301264762878418, "ViewRequirementAgentConnector_ms": 0.7529823780059814}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96349, "num_agent_steps_trained": 96349, "num_env_steps_sampled": 96349, "num_env_steps_trained": 96349, "num_env_steps_sampled_this_iter": 6668, "num_env_steps_trained_this_iter": 6668, "num_env_steps_sampled_throughput_per_sec": 191.99501992404518, "num_env_steps_trained_throughput_per_sec": 191.99501992404518, "timesteps_total": 96349, "num_steps_trained_this_iter": 6668, "agent_timesteps_total": 96349, "timers": {"training_iteration_time_ms": 34296.635, "sample_time_ms": 27837.572, "load_time_ms": 892.152, "load_throughput": 8340.281, "learn_time_ms": 5038.362, "learn_throughput": 1476.829, "synch_weights_time_ms": 465.54}, "counters": {"num_env_steps_sampled": 96349, "num_env_steps_trained": 96349, "num_agent_steps_sampled": 96349, "num_agent_steps_trained": 96349}, "done": false, "episodes_total": 184, "training_iteration": 13, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-42-58", "timestamp": 1749300178, "time_this_iter_s": 34.747618675231934, "time_total_s": 457.66034030914307, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 457.66034030914307, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 51.528571428571425, "ram_util_percent": 63.17857142857143, "gpu_util_percent0": 0.04428571428571429, "vram_util_percent0": 0.9656575520833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.903650999999999e-05, "total_loss": -0.14334639994317275, "policy_loss": -0.03002254296780417, "vf_loss": 0.07338739775464331, "vf_explained_var": 0.9392444618438419, "kl": 0.009247593335663384, "entropy": 14.249363713515432, "entropy_coeff": 0.009518255000000002}, "model": {}, "num_grad_updates_lifetime": 3570.5, "diff_num_grad_updates_vs_sampler_policy": 189.5}}, "num_env_steps_sampled": 107070, "num_env_steps_trained": 107070, "num_agent_steps_sampled": 107070, "num_agent_steps_trained": 107070}, "sampler_results": {"episode_reward_max": 33.44481939353335, "episode_reward_min": -47.67570706960651, "episode_reward_mean": 1.7016468176211843, "episode_len_mean": 571.11, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.841174393779278, 10.72392126497807, -12.494313233202663, -20.695221331562742, -8.099898171193114, 6.9468417567030105, 7.592066493708884, 28.33593478795615, 7.819755672374823, 8.045658130436234, 8.112486006032599, 9.240467392562888, -15.798559128481429, 6.060658932551257, 10.468931064712732, 7.102437262560008, 6.053831222954919, -10.920526930974765, 2.4305514425715398, 8.66759047144039, 10.181414686400204, -1.8006472401239075, 25.069925499353275, 17.4185190265745, 0.46298453308503396, -12.742283490886821, -45.73512452822024, -12.195594083537356, 23.82881637000662, -20.44049614323399, 6.237922963664953, 18.16739448069303, -1.713756907248119, -37.64671927571364, 10.875927177016967, 19.091255870053086, 15.810183143373383, -43.5787429909403, 2.838845735047856, 8.331728121817543, 19.529627664757367, 12.969187517059678, -12.1860198037697, -8.729933515247453, 8.806749483208975, -41.39594320104065, -5.817913134193094, 12.924028189377632, -13.704070454807114, 9.200067800670064, 5.063186109281624, 11.329289573341972, 2.062369991724343, 6.448907477938909, -6.840045964016475, -25.912658014071408, -0.7128043771173518, 2.2892206971322904, 4.79217139220945, 10.884793671971936, 7.945776003749275, 12.889810856616352, -10.44747935219388, -21.97639895417863, -13.082718873367376, 16.52920370517329, -10.846327569806316, 9.489426760481992, -1.910432659820717, 2.112866572328636, -47.67570706960651, 10.266496569204627, 2.699666710247885, 8.311576955103657, 5.614579088742406, 18.700275856738962, 6.963028194363777, 0.8306850850948106, -6.708770797546159, 6.386722739833978, -5.458538489726993, 14.31195196084186, 16.028751812955488, 10.341440310494072, 16.3686742098532, 1.7764487257834374, -1.4560587941702978, -14.68273211908798, 28.88668884382849, -6.51859115905601, -5.770741852348978, 9.924955487493918, 20.189205252752924, 13.252806528055357, -16.628650596402707, 11.716950000053929, 25.745349759763084, 7.0489144886106985, 33.44481939353335, -27.344793373769647], "episode_lengths": [273, 259, 766, 630, 556, 1117, 259, 881, 168, 259, 317, 382, 486, 300, 269, 1117, 91, 761, 373, 148, 261, 410, 934, 259, 317, 490, 680, 795, 1117, 458, 308, 1117, 377, 416, 230, 1117, 814, 680, 295, 321, 259, 295, 653, 615, 269, 757, 373, 795, 440, 148, 831, 288, 307, 1117, 848, 537, 853, 1117, 295, 295, 373, 295, 767, 561, 757, 259, 824, 978, 335, 1117, 439, 1117, 407, 932, 394, 308, 170, 376, 411, 372, 1077, 270, 269, 269, 296, 1117, 373, 455, 1117, 438, 761, 295, 915, 919, 439, 1117, 1117, 876, 1117, 782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0690289532491946, "mean_inference_ms": 6.805400098278426, "mean_action_processing_ms": 0.4681666250089421, "mean_env_wait_ms": 20.297206384466737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025935888290405273, "StateBufferConnector_ms": 0.01297450065612793, "ViewRequirementAgentConnector_ms": 0.7348365783691406}}, "episode_reward_max": 33.44481939353335, "episode_reward_min": -47.67570706960651, "episode_reward_mean": 1.7016468176211843, "episode_len_mean": 571.11, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.841174393779278, 10.72392126497807, -12.494313233202663, -20.695221331562742, -8.099898171193114, 6.9468417567030105, 7.592066493708884, 28.33593478795615, 7.819755672374823, 8.045658130436234, 8.112486006032599, 9.240467392562888, -15.798559128481429, 6.060658932551257, 10.468931064712732, 7.102437262560008, 6.053831222954919, -10.920526930974765, 2.4305514425715398, 8.66759047144039, 10.181414686400204, -1.8006472401239075, 25.069925499353275, 17.4185190265745, 0.46298453308503396, -12.742283490886821, -45.73512452822024, -12.195594083537356, 23.82881637000662, -20.44049614323399, 6.237922963664953, 18.16739448069303, -1.713756907248119, -37.64671927571364, 10.875927177016967, 19.091255870053086, 15.810183143373383, -43.5787429909403, 2.838845735047856, 8.331728121817543, 19.529627664757367, 12.969187517059678, -12.1860198037697, -8.729933515247453, 8.806749483208975, -41.39594320104065, -5.817913134193094, 12.924028189377632, -13.704070454807114, 9.200067800670064, 5.063186109281624, 11.329289573341972, 2.062369991724343, 6.448907477938909, -6.840045964016475, -25.912658014071408, -0.7128043771173518, 2.2892206971322904, 4.79217139220945, 10.884793671971936, 7.945776003749275, 12.889810856616352, -10.44747935219388, -21.97639895417863, -13.082718873367376, 16.52920370517329, -10.846327569806316, 9.489426760481992, -1.910432659820717, 2.112866572328636, -47.67570706960651, 10.266496569204627, 2.699666710247885, 8.311576955103657, 5.614579088742406, 18.700275856738962, 6.963028194363777, 0.8306850850948106, -6.708770797546159, 6.386722739833978, -5.458538489726993, 14.31195196084186, 16.028751812955488, 10.341440310494072, 16.3686742098532, 1.7764487257834374, -1.4560587941702978, -14.68273211908798, 28.88668884382849, -6.51859115905601, -5.770741852348978, 9.924955487493918, 20.189205252752924, 13.252806528055357, -16.628650596402707, 11.716950000053929, 25.745349759763084, 7.0489144886106985, 33.44481939353335, -27.344793373769647], "episode_lengths": [273, 259, 766, 630, 556, 1117, 259, 881, 168, 259, 317, 382, 486, 300, 269, 1117, 91, 761, 373, 148, 261, 410, 934, 259, 317, 490, 680, 795, 1117, 458, 308, 1117, 377, 416, 230, 1117, 814, 680, 295, 321, 259, 295, 653, 615, 269, 757, 373, 795, 440, 148, 831, 288, 307, 1117, 848, 537, 853, 1117, 295, 295, 373, 295, 767, 561, 757, 259, 824, 978, 335, 1117, 439, 1117, 407, 932, 394, 308, 170, 376, 411, 372, 1077, 270, 269, 269, 296, 1117, 373, 455, 1117, 438, 761, 295, 915, 919, 439, 1117, 1117, 876, 1117, 782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0690289532491946, "mean_inference_ms": 6.805400098278426, "mean_action_processing_ms": 0.4681666250089421, "mean_env_wait_ms": 20.297206384466737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025935888290405273, "StateBufferConnector_ms": 0.01297450065612793, "ViewRequirementAgentConnector_ms": 0.7348365783691406}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107070, "num_agent_steps_trained": 107070, "num_env_steps_sampled": 107070, "num_env_steps_trained": 107070, "num_env_steps_sampled_this_iter": 10721, "num_env_steps_trained_this_iter": 10721, "num_env_steps_sampled_throughput_per_sec": 205.0635295987262, "num_env_steps_trained_throughput_per_sec": 205.0635295987262, "timesteps_total": 107070, "num_steps_trained_this_iter": 10721, "agent_timesteps_total": 107070, "timers": {"training_iteration_time_ms": 36541.548, "sample_time_ms": 28757.473, "load_time_ms": 1061.003, "load_throughput": 7481.98, "learn_time_ms": 6190.114, "learn_throughput": 1282.432, "synch_weights_time_ms": 466.751}, "counters": {"num_env_steps_sampled": 107070, "num_env_steps_trained": 107070, "num_agent_steps_sampled": 107070, "num_agent_steps_trained": 107070}, "done": false, "episodes_total": 198, "training_iteration": 14, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-43-51", "timestamp": 1749300231, "time_this_iter_s": 52.301379919052124, "time_total_s": 509.9617202281952, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 509.9617202281952, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 57.62222222222222, "ram_util_percent": 66.35873015873014, "gpu_util_percent0": 0.173015873015873, "vram_util_percent0": 0.9656575520833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.892930000000001e-05, "total_loss": -0.13290885650951947, "policy_loss": -0.02049305904157726, "vf_loss": 0.07358134277431028, "vf_explained_var": 0.8821619745663234, "kl": 0.00863683700715358, "entropy": 14.238254729679653, "entropy_coeff": 0.00946465}, "model": {}, "num_grad_updates_lifetime": 3935.5, "diff_num_grad_updates_vs_sampler_policy": 174.5}}, "num_env_steps_sampled": 117032, "num_env_steps_trained": 117032, "num_agent_steps_sampled": 117032, "num_agent_steps_trained": 117032}, "sampler_results": {"episode_reward_max": 33.76242367432032, "episode_reward_min": -47.67570706960651, "episode_reward_mean": 2.2037367811007496, "episode_len_mean": 604.2, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.468931064712732, 7.102437262560008, 6.053831222954919, -10.920526930974765, 2.4305514425715398, 8.66759047144039, 10.181414686400204, -1.8006472401239075, 25.069925499353275, 17.4185190265745, 0.46298453308503396, -12.742283490886821, -45.73512452822024, -12.195594083537356, 23.82881637000662, -20.44049614323399, 6.237922963664953, 18.16739448069303, -1.713756907248119, -37.64671927571364, 10.875927177016967, 19.091255870053086, 15.810183143373383, -43.5787429909403, 2.838845735047856, 8.331728121817543, 19.529627664757367, 12.969187517059678, -12.1860198037697, -8.729933515247453, 8.806749483208975, -41.39594320104065, -5.817913134193094, 12.924028189377632, -13.704070454807114, 9.200067800670064, 5.063186109281624, 11.329289573341972, 2.062369991724343, 6.448907477938909, -6.840045964016475, -25.912658014071408, -0.7128043771173518, 2.2892206971322904, 4.79217139220945, 10.884793671971936, 7.945776003749275, 12.889810856616352, -10.44747935219388, -21.97639895417863, -13.082718873367376, 16.52920370517329, -10.846327569806316, 9.489426760481992, -1.910432659820717, 2.112866572328636, -47.67570706960651, 10.266496569204627, 2.699666710247885, 8.311576955103657, 5.614579088742406, 18.700275856738962, 6.963028194363777, 0.8306850850948106, -6.708770797546159, 6.386722739833978, -5.458538489726993, 14.31195196084186, 16.028751812955488, 10.341440310494072, 16.3686742098532, 1.7764487257834374, -1.4560587941702978, -14.68273211908798, 28.88668884382849, -6.51859115905601, -5.770741852348978, 9.924955487493918, 20.189205252752924, 13.252806528055357, -16.628650596402707, 11.716950000053929, 25.745349759763084, 7.0489144886106985, 33.44481939353335, -27.344793373769647, 12.435278949287312, 19.96405338532251, 33.429737702564495, -0.7478245800630671, 0.4662795666405557, -3.077848520986971, 33.76242367432032, 13.65667111393854, -24.068486201743347, 8.366505678518857, 9.47468027418283, 7.330367901572799, 2.5326008379885305, -17.68447046694361], "episode_lengths": [269, 1117, 91, 761, 373, 148, 261, 410, 934, 259, 317, 490, 680, 795, 1117, 458, 308, 1117, 377, 416, 230, 1117, 814, 680, 295, 321, 259, 295, 653, 615, 269, 757, 373, 795, 440, 148, 831, 288, 307, 1117, 848, 537, 853, 1117, 295, 295, 373, 295, 767, 561, 757, 259, 824, 978, 335, 1117, 439, 1117, 407, 932, 394, 308, 170, 376, 411, 372, 1077, 270, 269, 269, 296, 1117, 373, 455, 1117, 438, 761, 295, 915, 919, 439, 1117, 1117, 876, 1117, 782, 1117, 295, 1117, 610, 1117, 439, 1117, 1117, 1034, 215, 150, 786, 318, 530]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.060882126419703, "mean_inference_ms": 6.831132572228574, "mean_action_processing_ms": 0.46964426470674087, "mean_env_wait_ms": 20.345793204289926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023978710174560547, "StateBufferConnector_ms": 0.011974573135375977, "ViewRequirementAgentConnector_ms": 0.723888635635376}}, "episode_reward_max": 33.76242367432032, "episode_reward_min": -47.67570706960651, "episode_reward_mean": 2.2037367811007496, "episode_len_mean": 604.2, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.468931064712732, 7.102437262560008, 6.053831222954919, -10.920526930974765, 2.4305514425715398, 8.66759047144039, 10.181414686400204, -1.8006472401239075, 25.069925499353275, 17.4185190265745, 0.46298453308503396, -12.742283490886821, -45.73512452822024, -12.195594083537356, 23.82881637000662, -20.44049614323399, 6.237922963664953, 18.16739448069303, -1.713756907248119, -37.64671927571364, 10.875927177016967, 19.091255870053086, 15.810183143373383, -43.5787429909403, 2.838845735047856, 8.331728121817543, 19.529627664757367, 12.969187517059678, -12.1860198037697, -8.729933515247453, 8.806749483208975, -41.39594320104065, -5.817913134193094, 12.924028189377632, -13.704070454807114, 9.200067800670064, 5.063186109281624, 11.329289573341972, 2.062369991724343, 6.448907477938909, -6.840045964016475, -25.912658014071408, -0.7128043771173518, 2.2892206971322904, 4.79217139220945, 10.884793671971936, 7.945776003749275, 12.889810856616352, -10.44747935219388, -21.97639895417863, -13.082718873367376, 16.52920370517329, -10.846327569806316, 9.489426760481992, -1.910432659820717, 2.112866572328636, -47.67570706960651, 10.266496569204627, 2.699666710247885, 8.311576955103657, 5.614579088742406, 18.700275856738962, 6.963028194363777, 0.8306850850948106, -6.708770797546159, 6.386722739833978, -5.458538489726993, 14.31195196084186, 16.028751812955488, 10.341440310494072, 16.3686742098532, 1.7764487257834374, -1.4560587941702978, -14.68273211908798, 28.88668884382849, -6.51859115905601, -5.770741852348978, 9.924955487493918, 20.189205252752924, 13.252806528055357, -16.628650596402707, 11.716950000053929, 25.745349759763084, 7.0489144886106985, 33.44481939353335, -27.344793373769647, 12.435278949287312, 19.96405338532251, 33.429737702564495, -0.7478245800630671, 0.4662795666405557, -3.077848520986971, 33.76242367432032, 13.65667111393854, -24.068486201743347, 8.366505678518857, 9.47468027418283, 7.330367901572799, 2.5326008379885305, -17.68447046694361], "episode_lengths": [269, 1117, 91, 761, 373, 148, 261, 410, 934, 259, 317, 490, 680, 795, 1117, 458, 308, 1117, 377, 416, 230, 1117, 814, 680, 295, 321, 259, 295, 653, 615, 269, 757, 373, 795, 440, 148, 831, 288, 307, 1117, 848, 537, 853, 1117, 295, 295, 373, 295, 767, 561, 757, 259, 824, 978, 335, 1117, 439, 1117, 407, 932, 394, 308, 170, 376, 411, 372, 1077, 270, 269, 269, 296, 1117, 373, 455, 1117, 438, 761, 295, 915, 919, 439, 1117, 1117, 876, 1117, 782, 1117, 295, 1117, 610, 1117, 439, 1117, 1117, 1034, 215, 150, 786, 318, 530]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.060882126419703, "mean_inference_ms": 6.831132572228574, "mean_action_processing_ms": 0.46964426470674087, "mean_env_wait_ms": 20.345793204289926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023978710174560547, "StateBufferConnector_ms": 0.011974573135375977, "ViewRequirementAgentConnector_ms": 0.723888635635376}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 117032, "num_agent_steps_trained": 117032, "num_env_steps_sampled": 117032, "num_env_steps_trained": 117032, "num_env_steps_sampled_this_iter": 9962, "num_env_steps_trained_this_iter": 9962, "num_env_steps_sampled_throughput_per_sec": 211.83018576474745, "num_env_steps_trained_throughput_per_sec": 211.83018576474745, "timesteps_total": 117032, "num_steps_trained_this_iter": 9962, "agent_timesteps_total": 117032, "timers": {"training_iteration_time_ms": 38259.134, "sample_time_ms": 29660.904, "load_time_ms": 1149.45, "load_throughput": 7173.431, "learn_time_ms": 6909.708, "learn_throughput": 1193.321, "synch_weights_time_ms": 471.392}, "counters": {"num_env_steps_sampled": 117032, "num_env_steps_trained": 117032, "num_agent_steps_sampled": 117032, "num_agent_steps_trained": 117032}, "done": false, "episodes_total": 212, "training_iteration": 15, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-44-38", "timestamp": 1749300278, "time_this_iter_s": 47.04924178123474, "time_total_s": 557.0109620094299, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 557.0109620094299, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 58.13035714285714, "ram_util_percent": 70.70535714285714, "gpu_util_percent0": 0.13499999999999998, "vram_util_percent0": 0.9656575520833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.882968e-05, "total_loss": -0.11298832264912657, "policy_loss": -0.0027151417789833716, "vf_loss": 0.08104350457801239, "vf_explained_var": 0.915950053146011, "kl": 0.009544715065644362, "entropy": 14.326798014891775, "entropy_coeff": 0.009414840000000002}, "model": {}, "num_grad_updates_lifetime": 4300.5, "diff_num_grad_updates_vs_sampler_policy": 189.5}}, "num_env_steps_sampled": 127690, "num_env_steps_trained": 127690, "num_agent_steps_sampled": 127690, "num_agent_steps_trained": 127690}, "sampler_results": {"episode_reward_max": 33.76242367432032, "episode_reward_min": -47.67570706960651, "episode_reward_mean": 2.6281904531958036, "episode_len_mean": 641.73, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.82881637000662, -20.44049614323399, 6.237922963664953, 18.16739448069303, -1.713756907248119, -37.64671927571364, 10.875927177016967, 19.091255870053086, 15.810183143373383, -43.5787429909403, 2.838845735047856, 8.331728121817543, 19.529627664757367, 12.969187517059678, -12.1860198037697, -8.729933515247453, 8.806749483208975, -41.39594320104065, -5.817913134193094, 12.924028189377632, -13.704070454807114, 9.200067800670064, 5.063186109281624, 11.329289573341972, 2.062369991724343, 6.448907477938909, -6.840045964016475, -25.912658014071408, -0.7128043771173518, 2.2892206971322904, 4.79217139220945, 10.884793671971936, 7.945776003749275, 12.889810856616352, -10.44747935219388, -21.97639895417863, -13.082718873367376, 16.52920370517329, -10.846327569806316, 9.489426760481992, -1.910432659820717, 2.112866572328636, -47.67570706960651, 10.266496569204627, 2.699666710247885, 8.311576955103657, 5.614579088742406, 18.700275856738962, 6.963028194363777, 0.8306850850948106, -6.708770797546159, 6.386722739833978, -5.458538489726993, 14.31195196084186, 16.028751812955488, 10.341440310494072, 16.3686742098532, 1.7764487257834374, -1.4560587941702978, -14.68273211908798, 28.88668884382849, -6.51859115905601, -5.770741852348978, 9.924955487493918, 20.189205252752924, 13.252806528055357, -16.628650596402707, 11.716950000053929, 25.745349759763084, 7.0489144886106985, 33.44481939353335, -27.344793373769647, 12.435278949287312, 19.96405338532251, 33.429737702564495, -0.7478245800630671, 0.4662795666405557, -3.077848520986971, 33.76242367432032, 13.65667111393854, -24.068486201743347, 8.366505678518857, 9.47468027418283, 7.330367901572799, 2.5326008379885305, -17.68447046694361, -0.18223854617214574, 13.646993271858847, -8.527990512368564, 5.192039186237943, 17.475547563831675, -7.620243647122194, 27.626686773239392, 3.3197132197399117, 6.67309712229693, -4.557795107672224, -34.84829082802645, 16.10246868187135, 16.064425908875666, -3.4570369411751662], "episode_lengths": [1117, 458, 308, 1117, 377, 416, 230, 1117, 814, 680, 295, 321, 259, 295, 653, 615, 269, 757, 373, 795, 440, 148, 831, 288, 307, 1117, 848, 537, 853, 1117, 295, 295, 373, 295, 767, 561, 757, 259, 824, 978, 335, 1117, 439, 1117, 407, 932, 394, 308, 170, 376, 411, 372, 1077, 270, 269, 269, 296, 1117, 373, 455, 1117, 438, 761, 295, 915, 919, 439, 1117, 1117, 876, 1117, 782, 1117, 295, 1117, 610, 1117, 439, 1117, 1117, 1034, 215, 150, 786, 318, 530, 918, 1117, 417, 343, 1117, 373, 1097, 303, 1117, 916, 901, 1117, 317, 605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0558751375225017, "mean_inference_ms": 6.860989300403, "mean_action_processing_ms": 0.472108364330227, "mean_env_wait_ms": 20.417831473631768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200794219970703, "StateBufferConnector_ms": 0.015030145645141602, "ViewRequirementAgentConnector_ms": 0.7227842807769775}}, "episode_reward_max": 33.76242367432032, "episode_reward_min": -47.67570706960651, "episode_reward_mean": 2.6281904531958036, "episode_len_mean": 641.73, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.82881637000662, -20.44049614323399, 6.237922963664953, 18.16739448069303, -1.713756907248119, -37.64671927571364, 10.875927177016967, 19.091255870053086, 15.810183143373383, -43.5787429909403, 2.838845735047856, 8.331728121817543, 19.529627664757367, 12.969187517059678, -12.1860198037697, -8.729933515247453, 8.806749483208975, -41.39594320104065, -5.817913134193094, 12.924028189377632, -13.704070454807114, 9.200067800670064, 5.063186109281624, 11.329289573341972, 2.062369991724343, 6.448907477938909, -6.840045964016475, -25.912658014071408, -0.7128043771173518, 2.2892206971322904, 4.79217139220945, 10.884793671971936, 7.945776003749275, 12.889810856616352, -10.44747935219388, -21.97639895417863, -13.082718873367376, 16.52920370517329, -10.846327569806316, 9.489426760481992, -1.910432659820717, 2.112866572328636, -47.67570706960651, 10.266496569204627, 2.699666710247885, 8.311576955103657, 5.614579088742406, 18.700275856738962, 6.963028194363777, 0.8306850850948106, -6.708770797546159, 6.386722739833978, -5.458538489726993, 14.31195196084186, 16.028751812955488, 10.341440310494072, 16.3686742098532, 1.7764487257834374, -1.4560587941702978, -14.68273211908798, 28.88668884382849, -6.51859115905601, -5.770741852348978, 9.924955487493918, 20.189205252752924, 13.252806528055357, -16.628650596402707, 11.716950000053929, 25.745349759763084, 7.0489144886106985, 33.44481939353335, -27.344793373769647, 12.435278949287312, 19.96405338532251, 33.429737702564495, -0.7478245800630671, 0.4662795666405557, -3.077848520986971, 33.76242367432032, 13.65667111393854, -24.068486201743347, 8.366505678518857, 9.47468027418283, 7.330367901572799, 2.5326008379885305, -17.68447046694361, -0.18223854617214574, 13.646993271858847, -8.527990512368564, 5.192039186237943, 17.475547563831675, -7.620243647122194, 27.626686773239392, 3.3197132197399117, 6.67309712229693, -4.557795107672224, -34.84829082802645, 16.10246868187135, 16.064425908875666, -3.4570369411751662], "episode_lengths": [1117, 458, 308, 1117, 377, 416, 230, 1117, 814, 680, 295, 321, 259, 295, 653, 615, 269, 757, 373, 795, 440, 148, 831, 288, 307, 1117, 848, 537, 853, 1117, 295, 295, 373, 295, 767, 561, 757, 259, 824, 978, 335, 1117, 439, 1117, 407, 932, 394, 308, 170, 376, 411, 372, 1077, 270, 269, 269, 296, 1117, 373, 455, 1117, 438, 761, 295, 915, 919, 439, 1117, 1117, 876, 1117, 782, 1117, 295, 1117, 610, 1117, 439, 1117, 1117, 1034, 215, 150, 786, 318, 530, 918, 1117, 417, 343, 1117, 373, 1097, 303, 1117, 916, 901, 1117, 317, 605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0558751375225017, "mean_inference_ms": 6.860989300403, "mean_action_processing_ms": 0.472108364330227, "mean_env_wait_ms": 20.417831473631768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200794219970703, "StateBufferConnector_ms": 0.015030145645141602, "ViewRequirementAgentConnector_ms": 0.7227842807769775}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 127690, "num_agent_steps_trained": 127690, "num_env_steps_sampled": 127690, "num_env_steps_trained": 127690, "num_env_steps_sampled_this_iter": 10658, "num_env_steps_trained_this_iter": 10658, "num_env_steps_sampled_throughput_per_sec": 205.35434405096518, "num_env_steps_trained_throughput_per_sec": 205.35434405096518, "timesteps_total": 127690, "num_steps_trained_this_iter": 10658, "agent_timesteps_total": 127690, "timers": {"training_iteration_time_ms": 40103.514, "sample_time_ms": 30349.398, "load_time_ms": 1326.82, "load_throughput": 6434.484, "learn_time_ms": 7889.123, "learn_throughput": 1082.173, "synch_weights_time_ms": 467.438}, "counters": {"num_env_steps_sampled": 127690, "num_env_steps_trained": 127690, "num_agent_steps_sampled": 127690, "num_agent_steps_trained": 127690}, "done": false, "episodes_total": 226, "training_iteration": 16, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-45-30", "timestamp": 1749300330, "time_this_iter_s": 51.91653370857239, "time_total_s": 608.9274957180023, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 608.9274957180023, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 57.55806451612903, "ram_util_percent": 74.7661290322581, "gpu_util_percent0": 0.17500000000000002, "vram_util_percent0": 0.9656575520833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.87231e-05, "total_loss": -0.12662674766598325, "policy_loss": -0.02203057931716709, "vf_loss": 0.09808155721843695, "vf_explained_var": 0.8953934087897792, "kl": 0.009691202904805046, "entropy": 14.348423657272802, "entropy_coeff": 0.009361549999999998}, "model": {}, "num_grad_updates_lifetime": 4655.5, "diff_num_grad_updates_vs_sampler_policy": 164.5}}, "num_env_steps_sampled": 137004, "num_env_steps_trained": 137004, "num_agent_steps_sampled": 137004, "num_agent_steps_trained": 137004}, "sampler_results": {"episode_reward_max": 40.290784208007544, "episode_reward_min": -47.67570706960651, "episode_reward_mean": 2.545436394240239, "episode_len_mean": 656.83, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.1860198037697, -8.729933515247453, 8.806749483208975, -41.39594320104065, -5.817913134193094, 12.924028189377632, -13.704070454807114, 9.200067800670064, 5.063186109281624, 11.329289573341972, 2.062369991724343, 6.448907477938909, -6.840045964016475, -25.912658014071408, -0.7128043771173518, 2.2892206971322904, 4.79217139220945, 10.884793671971936, 7.945776003749275, 12.889810856616352, -10.44747935219388, -21.97639895417863, -13.082718873367376, 16.52920370517329, -10.846327569806316, 9.489426760481992, -1.910432659820717, 2.112866572328636, -47.67570706960651, 10.266496569204627, 2.699666710247885, 8.311576955103657, 5.614579088742406, 18.700275856738962, 6.963028194363777, 0.8306850850948106, -6.708770797546159, 6.386722739833978, -5.458538489726993, 14.31195196084186, 16.028751812955488, 10.341440310494072, 16.3686742098532, 1.7764487257834374, -1.4560587941702978, -14.68273211908798, 28.88668884382849, -6.51859115905601, -5.770741852348978, 9.924955487493918, 20.189205252752924, 13.252806528055357, -16.628650596402707, 11.716950000053929, 25.745349759763084, 7.0489144886106985, 33.44481939353335, -27.344793373769647, 12.435278949287312, 19.96405338532251, 33.429737702564495, -0.7478245800630671, 0.4662795666405557, -3.077848520986971, 33.76242367432032, 13.65667111393854, -24.068486201743347, 8.366505678518857, 9.47468027418283, 7.330367901572799, 2.5326008379885305, -17.68447046694361, -0.18223854617214574, 13.646993271858847, -8.527990512368564, 5.192039186237943, 17.475547563831675, -7.620243647122194, 27.626686773239392, 3.3197132197399117, 6.67309712229693, -4.557795107672224, -34.84829082802645, 16.10246868187135, 16.064425908875666, -3.4570369411751662, -21.614441736547672, -33.01688340269732, 6.473605169018325, 21.868078181566236, 18.342618140447954, -6.157663186033924, 3.019126894996268, 7.974865396374842, 1.7215569547085807, 8.462904216613754, 40.290784208007544, -6.069965079083829, -1.3005990498050084, -13.968218876767763], "episode_lengths": [653, 615, 269, 757, 373, 795, 440, 148, 831, 288, 307, 1117, 848, 537, 853, 1117, 295, 295, 373, 295, 767, 561, 757, 259, 824, 978, 335, 1117, 439, 1117, 407, 932, 394, 308, 170, 376, 411, 372, 1077, 270, 269, 269, 296, 1117, 373, 455, 1117, 438, 761, 295, 915, 919, 439, 1117, 1117, 876, 1117, 782, 1117, 295, 1117, 610, 1117, 439, 1117, 1117, 1034, 215, 150, 786, 318, 530, 918, 1117, 417, 343, 1117, 373, 1097, 303, 1117, 916, 901, 1117, 317, 605, 468, 532, 739, 372, 1117, 373, 761, 1117, 295, 295, 1117, 1117, 406, 605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.053388138474729, "mean_inference_ms": 6.898774980783531, "mean_action_processing_ms": 0.47469925990462547, "mean_env_wait_ms": 20.505122109867816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025051355361938477, "StateBufferConnector_ms": 0.015028953552246094, "ViewRequirementAgentConnector_ms": 0.7450282573699951}}, "episode_reward_max": 40.290784208007544, "episode_reward_min": -47.67570706960651, "episode_reward_mean": 2.545436394240239, "episode_len_mean": 656.83, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-12.1860198037697, -8.729933515247453, 8.806749483208975, -41.39594320104065, -5.817913134193094, 12.924028189377632, -13.704070454807114, 9.200067800670064, 5.063186109281624, 11.329289573341972, 2.062369991724343, 6.448907477938909, -6.840045964016475, -25.912658014071408, -0.7128043771173518, 2.2892206971322904, 4.79217139220945, 10.884793671971936, 7.945776003749275, 12.889810856616352, -10.44747935219388, -21.97639895417863, -13.082718873367376, 16.52920370517329, -10.846327569806316, 9.489426760481992, -1.910432659820717, 2.112866572328636, -47.67570706960651, 10.266496569204627, 2.699666710247885, 8.311576955103657, 5.614579088742406, 18.700275856738962, 6.963028194363777, 0.8306850850948106, -6.708770797546159, 6.386722739833978, -5.458538489726993, 14.31195196084186, 16.028751812955488, 10.341440310494072, 16.3686742098532, 1.7764487257834374, -1.4560587941702978, -14.68273211908798, 28.88668884382849, -6.51859115905601, -5.770741852348978, 9.924955487493918, 20.189205252752924, 13.252806528055357, -16.628650596402707, 11.716950000053929, 25.745349759763084, 7.0489144886106985, 33.44481939353335, -27.344793373769647, 12.435278949287312, 19.96405338532251, 33.429737702564495, -0.7478245800630671, 0.4662795666405557, -3.077848520986971, 33.76242367432032, 13.65667111393854, -24.068486201743347, 8.366505678518857, 9.47468027418283, 7.330367901572799, 2.5326008379885305, -17.68447046694361, -0.18223854617214574, 13.646993271858847, -8.527990512368564, 5.192039186237943, 17.475547563831675, -7.620243647122194, 27.626686773239392, 3.3197132197399117, 6.67309712229693, -4.557795107672224, -34.84829082802645, 16.10246868187135, 16.064425908875666, -3.4570369411751662, -21.614441736547672, -33.01688340269732, 6.473605169018325, 21.868078181566236, 18.342618140447954, -6.157663186033924, 3.019126894996268, 7.974865396374842, 1.7215569547085807, 8.462904216613754, 40.290784208007544, -6.069965079083829, -1.3005990498050084, -13.968218876767763], "episode_lengths": [653, 615, 269, 757, 373, 795, 440, 148, 831, 288, 307, 1117, 848, 537, 853, 1117, 295, 295, 373, 295, 767, 561, 757, 259, 824, 978, 335, 1117, 439, 1117, 407, 932, 394, 308, 170, 376, 411, 372, 1077, 270, 269, 269, 296, 1117, 373, 455, 1117, 438, 761, 295, 915, 919, 439, 1117, 1117, 876, 1117, 782, 1117, 295, 1117, 610, 1117, 439, 1117, 1117, 1034, 215, 150, 786, 318, 530, 918, 1117, 417, 343, 1117, 373, 1097, 303, 1117, 916, 901, 1117, 317, 605, 468, 532, 739, 372, 1117, 373, 761, 1117, 295, 295, 1117, 1117, 406, 605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.053388138474729, "mean_inference_ms": 6.898774980783531, "mean_action_processing_ms": 0.47469925990462547, "mean_env_wait_ms": 20.505122109867816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025051355361938477, "StateBufferConnector_ms": 0.015028953552246094, "ViewRequirementAgentConnector_ms": 0.7450282573699951}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137004, "num_agent_steps_trained": 137004, "num_env_steps_sampled": 137004, "num_env_steps_trained": 137004, "num_env_steps_sampled_this_iter": 9314, "num_env_steps_trained_this_iter": 9314, "num_env_steps_sampled_throughput_per_sec": 204.40859464949065, "num_env_steps_trained_throughput_per_sec": 204.40859464949065, "timesteps_total": 137004, "num_steps_trained_this_iter": 9314, "agent_timesteps_total": 137004, "timers": {"training_iteration_time_ms": 41235.014, "sample_time_ms": 30842.89, "load_time_ms": 1353.018, "load_throughput": 6413.22, "learn_time_ms": 8467.348, "learn_throughput": 1024.784, "synch_weights_time_ms": 501.014}, "counters": {"num_env_steps_sampled": 137004, "num_env_steps_trained": 137004, "num_agent_steps_sampled": 137004, "num_agent_steps_trained": 137004}, "done": false, "episodes_total": 240, "training_iteration": 17, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-46-16", "timestamp": 1749300376, "time_this_iter_s": 45.80037498474121, "time_total_s": 654.7278707027435, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 654.7278707027435, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 54.50178571428571, "ram_util_percent": 77.18928571428572, "gpu_util_percent0": 0.13785714285714287, "vram_util_percent0": 0.9656575520833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.862996e-05, "total_loss": -0.11348667066544295, "policy_loss": -0.0037367329110080997, "vf_loss": 0.07738296962653597, "vf_explained_var": 0.9207088090976079, "kl": 0.00975378763741901, "entropy": 14.307023175557454, "entropy_coeff": 0.00931498}, "model": {}, "num_grad_updates_lifetime": 4970.5, "diff_num_grad_updates_vs_sampler_policy": 149.5}}, "num_env_steps_sampled": 145666, "num_env_steps_trained": 145666, "num_agent_steps_sampled": 145666, "num_agent_steps_trained": 145666}, "sampler_results": {"episode_reward_max": 40.290784208007544, "episode_reward_min": -47.67570706960651, "episode_reward_mean": 4.224707468760158, "episode_len_mean": 663.67, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.7128043771173518, 2.2892206971322904, 4.79217139220945, 10.884793671971936, 7.945776003749275, 12.889810856616352, -10.44747935219388, -21.97639895417863, -13.082718873367376, 16.52920370517329, -10.846327569806316, 9.489426760481992, -1.910432659820717, 2.112866572328636, -47.67570706960651, 10.266496569204627, 2.699666710247885, 8.311576955103657, 5.614579088742406, 18.700275856738962, 6.963028194363777, 0.8306850850948106, -6.708770797546159, 6.386722739833978, -5.458538489726993, 14.31195196084186, 16.028751812955488, 10.341440310494072, 16.3686742098532, 1.7764487257834374, -1.4560587941702978, -14.68273211908798, 28.88668884382849, -6.51859115905601, -5.770741852348978, 9.924955487493918, 20.189205252752924, 13.252806528055357, -16.628650596402707, 11.716950000053929, 25.745349759763084, 7.0489144886106985, 33.44481939353335, -27.344793373769647, 12.435278949287312, 19.96405338532251, 33.429737702564495, -0.7478245800630671, 0.4662795666405557, -3.077848520986971, 33.76242367432032, 13.65667111393854, -24.068486201743347, 8.366505678518857, 9.47468027418283, 7.330367901572799, 2.5326008379885305, -17.68447046694361, -0.18223854617214574, 13.646993271858847, -8.527990512368564, 5.192039186237943, 17.475547563831675, -7.620243647122194, 27.626686773239392, 3.3197132197399117, 6.67309712229693, -4.557795107672224, -34.84829082802645, 16.10246868187135, 16.064425908875666, -3.4570369411751662, -21.614441736547672, -33.01688340269732, 6.473605169018325, 21.868078181566236, 18.342618140447954, -6.157663186033924, 3.019126894996268, 7.974865396374842, 1.7215569547085807, 8.462904216613754, 40.290784208007544, -6.069965079083829, -1.3005990498050084, -13.968218876767763, -3.030177129127196, -3.1800941572753434, 12.61441822072319, -11.141075336782299, 4.636258751859671, 18.162459503724467, 15.832750688234196, 22.147225832317645, -12.40503341620054, -11.10442596457562, 15.573523552643923, 16.230102606092455, 15.433161511997, 29.406027326757954], "episode_lengths": [853, 1117, 295, 295, 373, 295, 767, 561, 757, 259, 824, 978, 335, 1117, 439, 1117, 407, 932, 394, 308, 170, 376, 411, 372, 1077, 270, 269, 269, 296, 1117, 373, 455, 1117, 438, 761, 295, 915, 919, 439, 1117, 1117, 876, 1117, 782, 1117, 295, 1117, 610, 1117, 439, 1117, 1117, 1034, 215, 150, 786, 318, 530, 918, 1117, 417, 343, 1117, 373, 1097, 303, 1117, 916, 901, 1117, 317, 605, 468, 532, 739, 372, 1117, 373, 761, 1117, 295, 295, 1117, 1117, 406, 605, 1117, 784, 295, 763, 373, 1117, 295, 1117, 411, 439, 295, 295, 244, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0481066124239797, "mean_inference_ms": 6.917689573293717, "mean_action_processing_ms": 0.4763101922506972, "mean_env_wait_ms": 20.547345062534855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024028301239013672, "StateBufferConnector_ms": 0.012042522430419922, "ViewRequirementAgentConnector_ms": 0.7371511459350586}}, "episode_reward_max": 40.290784208007544, "episode_reward_min": -47.67570706960651, "episode_reward_mean": 4.224707468760158, "episode_len_mean": 663.67, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-0.7128043771173518, 2.2892206971322904, 4.79217139220945, 10.884793671971936, 7.945776003749275, 12.889810856616352, -10.44747935219388, -21.97639895417863, -13.082718873367376, 16.52920370517329, -10.846327569806316, 9.489426760481992, -1.910432659820717, 2.112866572328636, -47.67570706960651, 10.266496569204627, 2.699666710247885, 8.311576955103657, 5.614579088742406, 18.700275856738962, 6.963028194363777, 0.8306850850948106, -6.708770797546159, 6.386722739833978, -5.458538489726993, 14.31195196084186, 16.028751812955488, 10.341440310494072, 16.3686742098532, 1.7764487257834374, -1.4560587941702978, -14.68273211908798, 28.88668884382849, -6.51859115905601, -5.770741852348978, 9.924955487493918, 20.189205252752924, 13.252806528055357, -16.628650596402707, 11.716950000053929, 25.745349759763084, 7.0489144886106985, 33.44481939353335, -27.344793373769647, 12.435278949287312, 19.96405338532251, 33.429737702564495, -0.7478245800630671, 0.4662795666405557, -3.077848520986971, 33.76242367432032, 13.65667111393854, -24.068486201743347, 8.366505678518857, 9.47468027418283, 7.330367901572799, 2.5326008379885305, -17.68447046694361, -0.18223854617214574, 13.646993271858847, -8.527990512368564, 5.192039186237943, 17.475547563831675, -7.620243647122194, 27.626686773239392, 3.3197132197399117, 6.67309712229693, -4.557795107672224, -34.84829082802645, 16.10246868187135, 16.064425908875666, -3.4570369411751662, -21.614441736547672, -33.01688340269732, 6.473605169018325, 21.868078181566236, 18.342618140447954, -6.157663186033924, 3.019126894996268, 7.974865396374842, 1.7215569547085807, 8.462904216613754, 40.290784208007544, -6.069965079083829, -1.3005990498050084, -13.968218876767763, -3.030177129127196, -3.1800941572753434, 12.61441822072319, -11.141075336782299, 4.636258751859671, 18.162459503724467, 15.832750688234196, 22.147225832317645, -12.40503341620054, -11.10442596457562, 15.573523552643923, 16.230102606092455, 15.433161511997, 29.406027326757954], "episode_lengths": [853, 1117, 295, 295, 373, 295, 767, 561, 757, 259, 824, 978, 335, 1117, 439, 1117, 407, 932, 394, 308, 170, 376, 411, 372, 1077, 270, 269, 269, 296, 1117, 373, 455, 1117, 438, 761, 295, 915, 919, 439, 1117, 1117, 876, 1117, 782, 1117, 295, 1117, 610, 1117, 439, 1117, 1117, 1034, 215, 150, 786, 318, 530, 918, 1117, 417, 343, 1117, 373, 1097, 303, 1117, 916, 901, 1117, 317, 605, 468, 532, 739, 372, 1117, 373, 761, 1117, 295, 295, 1117, 1117, 406, 605, 1117, 784, 295, 763, 373, 1117, 295, 1117, 411, 439, 295, 295, 244, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0481066124239797, "mean_inference_ms": 6.917689573293717, "mean_action_processing_ms": 0.4763101922506972, "mean_env_wait_ms": 20.547345062534855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024028301239013672, "StateBufferConnector_ms": 0.012042522430419922, "ViewRequirementAgentConnector_ms": 0.7371511459350586}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145666, "num_agent_steps_trained": 145666, "num_env_steps_sampled": 145666, "num_env_steps_trained": 145666, "num_env_steps_sampled_this_iter": 8662, "num_env_steps_trained_this_iter": 8662, "num_env_steps_sampled_throughput_per_sec": 221.84754864398198, "num_env_steps_trained_throughput_per_sec": 221.84754864398198, "timesteps_total": 145666, "num_steps_trained_this_iter": 8662, "agent_timesteps_total": 145666, "timers": {"training_iteration_time_ms": 41993.174, "sample_time_ms": 31443.725, "load_time_ms": 1378.791, "load_throughput": 6439.339, "learn_time_ms": 8625.31, "learn_throughput": 1029.354, "synch_weights_time_ms": 476.0}, "counters": {"num_env_steps_sampled": 145666, "num_env_steps_trained": 145666, "num_agent_steps_sampled": 145666, "num_agent_steps_trained": 145666}, "done": false, "episodes_total": 254, "training_iteration": 18, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-46-55", "timestamp": 1749300415, "time_this_iter_s": 39.062676668167114, "time_total_s": 693.7905473709106, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 693.7905473709106, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 57.70851063829787, "ram_util_percent": 76.27021276595742, "gpu_util_percent0": 0.0551063829787234, "vram_util_percent0": 0.9656575520833337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.854334e-05, "total_loss": -0.12209099918220412, "policy_loss": -0.01325141102732981, "vf_loss": 0.08146327498423703, "vf_explained_var": 0.9088451881619061, "kl": 0.009039162771659903, "entropy": 14.40528497134938, "entropy_coeff": 0.00927167}, "model": {}, "num_grad_updates_lifetime": 5290.5, "diff_num_grad_updates_vs_sampler_policy": 169.5}}, "num_env_steps_sampled": 155450, "num_env_steps_trained": 155450, "num_agent_steps_sampled": 155450, "num_agent_steps_trained": 155450}, "sampler_results": {"episode_reward_max": 40.290784208007544, "episode_reward_min": -35.63994404567112, "episode_reward_mean": 5.584252643385514, "episode_len_mean": 668.86, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.266496569204627, 2.699666710247885, 8.311576955103657, 5.614579088742406, 18.700275856738962, 6.963028194363777, 0.8306850850948106, -6.708770797546159, 6.386722739833978, -5.458538489726993, 14.31195196084186, 16.028751812955488, 10.341440310494072, 16.3686742098532, 1.7764487257834374, -1.4560587941702978, -14.68273211908798, 28.88668884382849, -6.51859115905601, -5.770741852348978, 9.924955487493918, 20.189205252752924, 13.252806528055357, -16.628650596402707, 11.716950000053929, 25.745349759763084, 7.0489144886106985, 33.44481939353335, -27.344793373769647, 12.435278949287312, 19.96405338532251, 33.429737702564495, -0.7478245800630671, 0.4662795666405557, -3.077848520986971, 33.76242367432032, 13.65667111393854, -24.068486201743347, 8.366505678518857, 9.47468027418283, 7.330367901572799, 2.5326008379885305, -17.68447046694361, -0.18223854617214574, 13.646993271858847, -8.527990512368564, 5.192039186237943, 17.475547563831675, -7.620243647122194, 27.626686773239392, 3.3197132197399117, 6.67309712229693, -4.557795107672224, -34.84829082802645, 16.10246868187135, 16.064425908875666, -3.4570369411751662, -21.614441736547672, -33.01688340269732, 6.473605169018325, 21.868078181566236, 18.342618140447954, -6.157663186033924, 3.019126894996268, 7.974865396374842, 1.7215569547085807, 8.462904216613754, 40.290784208007544, -6.069965079083829, -1.3005990498050084, -13.968218876767763, -3.030177129127196, -3.1800941572753434, 12.61441822072319, -11.141075336782299, 4.636258751859671, 18.162459503724467, 15.832750688234196, 22.147225832317645, -12.40503341620054, -11.10442596457562, 15.573523552643923, 16.230102606092455, 15.433161511997, 29.406027326757954, 12.013643651017022, -15.264020897423158, -0.7657475134027365, 37.94492359681441, 20.076433777284727, 6.2827314220035495, -35.63994404567112, 14.51488101366522, 5.968319262855543, 7.906845260136974, 15.138806598345418, -22.20958701372205, 7.646406195201722, 27.954615141862057, 14.667611817140397], "episode_lengths": [1117, 407, 932, 394, 308, 170, 376, 411, 372, 1077, 270, 269, 269, 296, 1117, 373, 455, 1117, 438, 761, 295, 915, 919, 439, 1117, 1117, 876, 1117, 782, 1117, 295, 1117, 610, 1117, 439, 1117, 1117, 1034, 215, 150, 786, 318, 530, 918, 1117, 417, 343, 1117, 373, 1097, 303, 1117, 916, 901, 1117, 317, 605, 468, 532, 739, 372, 1117, 373, 761, 1117, 295, 295, 1117, 1117, 406, 605, 1117, 784, 295, 763, 373, 1117, 295, 1117, 411, 439, 295, 295, 244, 1117, 295, 896, 683, 1117, 295, 858, 514, 295, 799, 295, 295, 1117, 91, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.044508614503314, "mean_inference_ms": 6.929805046543326, "mean_action_processing_ms": 0.4778535314329669, "mean_env_wait_ms": 20.58110838657446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03468513488769531, "StateBufferConnector_ms": 0.012029647827148438, "ViewRequirementAgentConnector_ms": 0.6971168518066406}}, "episode_reward_max": 40.290784208007544, "episode_reward_min": -35.63994404567112, "episode_reward_mean": 5.584252643385514, "episode_len_mean": 668.86, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.266496569204627, 2.699666710247885, 8.311576955103657, 5.614579088742406, 18.700275856738962, 6.963028194363777, 0.8306850850948106, -6.708770797546159, 6.386722739833978, -5.458538489726993, 14.31195196084186, 16.028751812955488, 10.341440310494072, 16.3686742098532, 1.7764487257834374, -1.4560587941702978, -14.68273211908798, 28.88668884382849, -6.51859115905601, -5.770741852348978, 9.924955487493918, 20.189205252752924, 13.252806528055357, -16.628650596402707, 11.716950000053929, 25.745349759763084, 7.0489144886106985, 33.44481939353335, -27.344793373769647, 12.435278949287312, 19.96405338532251, 33.429737702564495, -0.7478245800630671, 0.4662795666405557, -3.077848520986971, 33.76242367432032, 13.65667111393854, -24.068486201743347, 8.366505678518857, 9.47468027418283, 7.330367901572799, 2.5326008379885305, -17.68447046694361, -0.18223854617214574, 13.646993271858847, -8.527990512368564, 5.192039186237943, 17.475547563831675, -7.620243647122194, 27.626686773239392, 3.3197132197399117, 6.67309712229693, -4.557795107672224, -34.84829082802645, 16.10246868187135, 16.064425908875666, -3.4570369411751662, -21.614441736547672, -33.01688340269732, 6.473605169018325, 21.868078181566236, 18.342618140447954, -6.157663186033924, 3.019126894996268, 7.974865396374842, 1.7215569547085807, 8.462904216613754, 40.290784208007544, -6.069965079083829, -1.3005990498050084, -13.968218876767763, -3.030177129127196, -3.1800941572753434, 12.61441822072319, -11.141075336782299, 4.636258751859671, 18.162459503724467, 15.832750688234196, 22.147225832317645, -12.40503341620054, -11.10442596457562, 15.573523552643923, 16.230102606092455, 15.433161511997, 29.406027326757954, 12.013643651017022, -15.264020897423158, -0.7657475134027365, 37.94492359681441, 20.076433777284727, 6.2827314220035495, -35.63994404567112, 14.51488101366522, 5.968319262855543, 7.906845260136974, 15.138806598345418, -22.20958701372205, 7.646406195201722, 27.954615141862057, 14.667611817140397], "episode_lengths": [1117, 407, 932, 394, 308, 170, 376, 411, 372, 1077, 270, 269, 269, 296, 1117, 373, 455, 1117, 438, 761, 295, 915, 919, 439, 1117, 1117, 876, 1117, 782, 1117, 295, 1117, 610, 1117, 439, 1117, 1117, 1034, 215, 150, 786, 318, 530, 918, 1117, 417, 343, 1117, 373, 1097, 303, 1117, 916, 901, 1117, 317, 605, 468, 532, 739, 372, 1117, 373, 761, 1117, 295, 295, 1117, 1117, 406, 605, 1117, 784, 295, 763, 373, 1117, 295, 1117, 411, 439, 295, 295, 244, 1117, 295, 896, 683, 1117, 295, 858, 514, 295, 799, 295, 295, 1117, 91, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.044508614503314, "mean_inference_ms": 6.929805046543326, "mean_action_processing_ms": 0.4778535314329669, "mean_env_wait_ms": 20.58110838657446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03468513488769531, "StateBufferConnector_ms": 0.012029647827148438, "ViewRequirementAgentConnector_ms": 0.6971168518066406}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155450, "num_agent_steps_trained": 155450, "num_env_steps_sampled": 155450, "num_env_steps_trained": 155450, "num_env_steps_sampled_this_iter": 9784, "num_env_steps_trained_this_iter": 9784, "num_env_steps_sampled_throughput_per_sec": 208.34102653987094, "num_env_steps_trained_throughput_per_sec": 208.34102653987094, "timesteps_total": 155450, "num_steps_trained_this_iter": 9784, "agent_timesteps_total": 155450, "timers": {"training_iteration_time_ms": 43228.752, "sample_time_ms": 32115.833, "load_time_ms": 1399.589, "load_throughput": 6456.037, "learn_time_ms": 9166.068, "learn_throughput": 985.788, "synch_weights_time_ms": 473.306}, "counters": {"num_env_steps_sampled": 155450, "num_env_steps_trained": 155450, "num_agent_steps_sampled": 155450, "num_agent_steps_trained": 155450}, "done": false, "episodes_total": 269, "training_iteration": 19, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-47-42", "timestamp": 1749300462, "time_this_iter_s": 46.9661762714386, "time_total_s": 740.7567236423492, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 740.7567236423492, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 55.93157894736843, "ram_util_percent": 77.07543859649121, "gpu_util_percent0": 0.1256140350877193, "vram_util_percent0": 0.9656575520833334}}
{"evaluation": {"sampler_results": {"episode_reward_max": 11.611583792980264, "episode_reward_min": 8.585818028189529, "episode_reward_mean": 9.889176364695292, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.10309466866665, 11.611583792980264, 10.679429436611388, 9.46595589702863, 8.585818028189529], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5744204627373244, "mean_inference_ms": 3.595978717710712, "mean_action_processing_ms": 0.30361654187336623, "mean_env_wait_ms": 12.104610850278739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01854419708251953, "ViewRequirementAgentConnector_ms": 0.37059783935546875}}, "episode_reward_max": 11.611583792980264, "episode_reward_min": 8.585818028189529, "episode_reward_mean": 9.889176364695292, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.10309466866665, 11.611583792980264, 10.679429436611388, 9.46595589702863, 8.585818028189529], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5744204627373244, "mean_inference_ms": 3.595978717710712, "mean_action_processing_ms": 0.30361654187336623, "mean_env_wait_ms": 12.104610850278739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01854419708251953, "ViewRequirementAgentConnector_ms": 0.37059783935546875}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.844549999999998e-05, "total_loss": -0.1347622897862116, "policy_loss": -0.027523793176486636, "vf_loss": 0.0908482792673678, "vf_explained_var": 0.918509990849146, "kl": 0.0095610871442551, "entropy": 14.615138614468458, "entropy_coeff": 0.00922275}, "model": {}, "num_grad_updates_lifetime": 5665.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 167001, "num_env_steps_trained": 167001, "num_agent_steps_sampled": 167001, "num_agent_steps_trained": 167001}, "sampler_results": {"episode_reward_max": 40.290784208007544, "episode_reward_min": -50.54487604451588, "episode_reward_mean": 4.546650740794444, "episode_len_mean": 717.69, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.7764487257834374, -1.4560587941702978, -14.68273211908798, 28.88668884382849, -6.51859115905601, -5.770741852348978, 9.924955487493918, 20.189205252752924, 13.252806528055357, -16.628650596402707, 11.716950000053929, 25.745349759763084, 7.0489144886106985, 33.44481939353335, -27.344793373769647, 12.435278949287312, 19.96405338532251, 33.429737702564495, -0.7478245800630671, 0.4662795666405557, -3.077848520986971, 33.76242367432032, 13.65667111393854, -24.068486201743347, 8.366505678518857, 9.47468027418283, 7.330367901572799, 2.5326008379885305, -17.68447046694361, -0.18223854617214574, 13.646993271858847, -8.527990512368564, 5.192039186237943, 17.475547563831675, -7.620243647122194, 27.626686773239392, 3.3197132197399117, 6.67309712229693, -4.557795107672224, -34.84829082802645, 16.10246868187135, 16.064425908875666, -3.4570369411751662, -21.614441736547672, -33.01688340269732, 6.473605169018325, 21.868078181566236, 18.342618140447954, -6.157663186033924, 3.019126894996268, 7.974865396374842, 1.7215569547085807, 8.462904216613754, 40.290784208007544, -6.069965079083829, -1.3005990498050084, -13.968218876767763, -3.030177129127196, -3.1800941572753434, 12.61441822072319, -11.141075336782299, 4.636258751859671, 18.162459503724467, 15.832750688234196, 22.147225832317645, -12.40503341620054, -11.10442596457562, 15.573523552643923, 16.230102606092455, 15.433161511997, 29.406027326757954, 12.013643651017022, -15.264020897423158, -0.7657475134027365, 37.94492359681441, 20.076433777284727, 6.2827314220035495, -35.63994404567112, 14.51488101366522, 5.968319262855543, 7.906845260136974, 15.138806598345418, -22.20958701372205, 7.646406195201722, 27.954615141862057, 14.667611817140397, 20.561598303199823, -20.22864461020148, 22.089715349210138, 15.411297223067177, -50.54487604451588, -20.176152629178908, -2.627886773419795, 3.9704296109854997, -14.625297600634688, 25.354235873931422, 6.546114267438639, 27.686455442024737, -11.686272243356967, -0.83436622145509], "episode_lengths": [1117, 373, 455, 1117, 438, 761, 295, 915, 919, 439, 1117, 1117, 876, 1117, 782, 1117, 295, 1117, 610, 1117, 439, 1117, 1117, 1034, 215, 150, 786, 318, 530, 918, 1117, 417, 343, 1117, 373, 1097, 303, 1117, 916, 901, 1117, 317, 605, 468, 532, 739, 372, 1117, 373, 761, 1117, 295, 295, 1117, 1117, 406, 605, 1117, 784, 295, 763, 373, 1117, 295, 1117, 411, 439, 295, 295, 244, 1117, 295, 896, 683, 1117, 295, 858, 514, 295, 799, 295, 295, 1117, 91, 1117, 1117, 1117, 632, 1117, 888, 653, 657, 697, 520, 409, 1117, 1117, 1117, 439, 1071]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0407647591415508, "mean_inference_ms": 6.941761607871321, "mean_action_processing_ms": 0.47916463667396575, "mean_env_wait_ms": 20.618876429471694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02770686149597168, "StateBufferConnector_ms": 0.013986825942993164, "ViewRequirementAgentConnector_ms": 0.6806986331939697}}, "episode_reward_max": 40.290784208007544, "episode_reward_min": -50.54487604451588, "episode_reward_mean": 4.546650740794444, "episode_len_mean": 717.69, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.7764487257834374, -1.4560587941702978, -14.68273211908798, 28.88668884382849, -6.51859115905601, -5.770741852348978, 9.924955487493918, 20.189205252752924, 13.252806528055357, -16.628650596402707, 11.716950000053929, 25.745349759763084, 7.0489144886106985, 33.44481939353335, -27.344793373769647, 12.435278949287312, 19.96405338532251, 33.429737702564495, -0.7478245800630671, 0.4662795666405557, -3.077848520986971, 33.76242367432032, 13.65667111393854, -24.068486201743347, 8.366505678518857, 9.47468027418283, 7.330367901572799, 2.5326008379885305, -17.68447046694361, -0.18223854617214574, 13.646993271858847, -8.527990512368564, 5.192039186237943, 17.475547563831675, -7.620243647122194, 27.626686773239392, 3.3197132197399117, 6.67309712229693, -4.557795107672224, -34.84829082802645, 16.10246868187135, 16.064425908875666, -3.4570369411751662, -21.614441736547672, -33.01688340269732, 6.473605169018325, 21.868078181566236, 18.342618140447954, -6.157663186033924, 3.019126894996268, 7.974865396374842, 1.7215569547085807, 8.462904216613754, 40.290784208007544, -6.069965079083829, -1.3005990498050084, -13.968218876767763, -3.030177129127196, -3.1800941572753434, 12.61441822072319, -11.141075336782299, 4.636258751859671, 18.162459503724467, 15.832750688234196, 22.147225832317645, -12.40503341620054, -11.10442596457562, 15.573523552643923, 16.230102606092455, 15.433161511997, 29.406027326757954, 12.013643651017022, -15.264020897423158, -0.7657475134027365, 37.94492359681441, 20.076433777284727, 6.2827314220035495, -35.63994404567112, 14.51488101366522, 5.968319262855543, 7.906845260136974, 15.138806598345418, -22.20958701372205, 7.646406195201722, 27.954615141862057, 14.667611817140397, 20.561598303199823, -20.22864461020148, 22.089715349210138, 15.411297223067177, -50.54487604451588, -20.176152629178908, -2.627886773419795, 3.9704296109854997, -14.625297600634688, 25.354235873931422, 6.546114267438639, 27.686455442024737, -11.686272243356967, -0.83436622145509], "episode_lengths": [1117, 373, 455, 1117, 438, 761, 295, 915, 919, 439, 1117, 1117, 876, 1117, 782, 1117, 295, 1117, 610, 1117, 439, 1117, 1117, 1034, 215, 150, 786, 318, 530, 918, 1117, 417, 343, 1117, 373, 1097, 303, 1117, 916, 901, 1117, 317, 605, 468, 532, 739, 372, 1117, 373, 761, 1117, 295, 295, 1117, 1117, 406, 605, 1117, 784, 295, 763, 373, 1117, 295, 1117, 411, 439, 295, 295, 244, 1117, 295, 896, 683, 1117, 295, 858, 514, 295, 799, 295, 295, 1117, 91, 1117, 1117, 1117, 632, 1117, 888, 653, 657, 697, 520, 409, 1117, 1117, 1117, 439, 1071]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0407647591415508, "mean_inference_ms": 6.941761607871321, "mean_action_processing_ms": 0.47916463667396575, "mean_env_wait_ms": 20.618876429471694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02770686149597168, "StateBufferConnector_ms": 0.013986825942993164, "ViewRequirementAgentConnector_ms": 0.6806986331939697}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167001, "num_agent_steps_trained": 167001, "num_env_steps_sampled": 167001, "num_env_steps_trained": 167001, "num_env_steps_sampled_this_iter": 11551, "num_env_steps_trained_this_iter": 11551, "num_env_steps_sampled_throughput_per_sec": 216.88014763842065, "num_env_steps_trained_throughput_per_sec": 216.88014763842065, "timesteps_total": 167001, "num_steps_trained_this_iter": 11551, "agent_timesteps_total": 167001, "timers": {"training_iteration_time_ms": 45269.334, "sample_time_ms": 32948.795, "load_time_ms": 1639.057, "load_throughput": 5760.141, "learn_time_ms": 10134.891, "learn_throughput": 931.554, "synch_weights_time_ms": 471.286}, "counters": {"num_env_steps_sampled": 167001, "num_env_steps_trained": 167001, "num_agent_steps_sampled": 167001, "num_agent_steps_trained": 167001}, "done": false, "episodes_total": 283, "training_iteration": 20, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-48-53", "timestamp": 1749300533, "time_this_iter_s": 70.92653036117554, "time_total_s": 811.6832540035248, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 811.6832540035248, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 49.34651162790697, "ram_util_percent": 80.61627906976744, "gpu_util_percent0": 0.12813953488372093, "vram_util_percent0": 0.962932261385659}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.832999000000001e-05, "total_loss": -0.2018612440511146, "policy_loss": -0.08992720088572241, "vf_loss": 0.06878976821351578, "vf_explained_var": 0.9046694285729352, "kl": 0.009148278466219541, "entropy": 14.49611985543195, "entropy_coeff": 0.009164994999999999}, "model": {}, "num_grad_updates_lifetime": 6040.5, "diff_num_grad_updates_vs_sampler_policy": 169.5}}, "num_env_steps_sampled": 176751, "num_env_steps_trained": 176751, "num_agent_steps_sampled": 176751, "num_agent_steps_trained": 176751}, "sampler_results": {"episode_reward_max": 40.290784208007544, "episode_reward_min": -50.54487604451588, "episode_reward_mean": 4.834842079923625, "episode_len_mean": 704.63, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.344793373769647, 12.435278949287312, 19.96405338532251, 33.429737702564495, -0.7478245800630671, 0.4662795666405557, -3.077848520986971, 33.76242367432032, 13.65667111393854, -24.068486201743347, 8.366505678518857, 9.47468027418283, 7.330367901572799, 2.5326008379885305, -17.68447046694361, -0.18223854617214574, 13.646993271858847, -8.527990512368564, 5.192039186237943, 17.475547563831675, -7.620243647122194, 27.626686773239392, 3.3197132197399117, 6.67309712229693, -4.557795107672224, -34.84829082802645, 16.10246868187135, 16.064425908875666, -3.4570369411751662, -21.614441736547672, -33.01688340269732, 6.473605169018325, 21.868078181566236, 18.342618140447954, -6.157663186033924, 3.019126894996268, 7.974865396374842, 1.7215569547085807, 8.462904216613754, 40.290784208007544, -6.069965079083829, -1.3005990498050084, -13.968218876767763, -3.030177129127196, -3.1800941572753434, 12.61441822072319, -11.141075336782299, 4.636258751859671, 18.162459503724467, 15.832750688234196, 22.147225832317645, -12.40503341620054, -11.10442596457562, 15.573523552643923, 16.230102606092455, 15.433161511997, 29.406027326757954, 12.013643651017022, -15.264020897423158, -0.7657475134027365, 37.94492359681441, 20.076433777284727, 6.2827314220035495, -35.63994404567112, 14.51488101366522, 5.968319262855543, 7.906845260136974, 15.138806598345418, -22.20958701372205, 7.646406195201722, 27.954615141862057, 14.667611817140397, 20.561598303199823, -20.22864461020148, 22.089715349210138, 15.411297223067177, -50.54487604451588, -20.176152629178908, -2.627886773419795, 3.9704296109854997, -14.625297600634688, 25.354235873931422, 6.546114267438639, 27.686455442024737, -11.686272243356967, -0.83436622145509, 11.073578152506936, 6.983232327201138, 11.030454459892248, 17.469076696077806, 4.576541571231402, 8.13276367178124, 33.80017393313285, -14.716820437596462, 21.55685488985704, 12.275119226455235, 17.247650493368408, 13.557785014139267, 25.984365841426236, -33.22227796774591], "episode_lengths": [782, 1117, 295, 1117, 610, 1117, 439, 1117, 1117, 1034, 215, 150, 786, 318, 530, 918, 1117, 417, 343, 1117, 373, 1097, 303, 1117, 916, 901, 1117, 317, 605, 468, 532, 739, 372, 1117, 373, 761, 1117, 295, 295, 1117, 1117, 406, 605, 1117, 784, 295, 763, 373, 1117, 295, 1117, 411, 439, 295, 295, 244, 1117, 295, 896, 683, 1117, 295, 858, 514, 295, 799, 295, 295, 1117, 91, 1117, 1117, 1117, 632, 1117, 888, 653, 657, 697, 520, 409, 1117, 1117, 1117, 439, 1071, 295, 733, 302, 1117, 295, 895, 1117, 642, 1117, 295, 269, 1117, 1117, 439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0389373747360207, "mean_inference_ms": 6.955369789211188, "mean_action_processing_ms": 0.48036302990673635, "mean_env_wait_ms": 20.654291900930847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033721208572387695, "StateBufferConnector_ms": 0.011995553970336914, "ViewRequirementAgentConnector_ms": 0.7103333473205566}}, "episode_reward_max": 40.290784208007544, "episode_reward_min": -50.54487604451588, "episode_reward_mean": 4.834842079923625, "episode_len_mean": 704.63, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-27.344793373769647, 12.435278949287312, 19.96405338532251, 33.429737702564495, -0.7478245800630671, 0.4662795666405557, -3.077848520986971, 33.76242367432032, 13.65667111393854, -24.068486201743347, 8.366505678518857, 9.47468027418283, 7.330367901572799, 2.5326008379885305, -17.68447046694361, -0.18223854617214574, 13.646993271858847, -8.527990512368564, 5.192039186237943, 17.475547563831675, -7.620243647122194, 27.626686773239392, 3.3197132197399117, 6.67309712229693, -4.557795107672224, -34.84829082802645, 16.10246868187135, 16.064425908875666, -3.4570369411751662, -21.614441736547672, -33.01688340269732, 6.473605169018325, 21.868078181566236, 18.342618140447954, -6.157663186033924, 3.019126894996268, 7.974865396374842, 1.7215569547085807, 8.462904216613754, 40.290784208007544, -6.069965079083829, -1.3005990498050084, -13.968218876767763, -3.030177129127196, -3.1800941572753434, 12.61441822072319, -11.141075336782299, 4.636258751859671, 18.162459503724467, 15.832750688234196, 22.147225832317645, -12.40503341620054, -11.10442596457562, 15.573523552643923, 16.230102606092455, 15.433161511997, 29.406027326757954, 12.013643651017022, -15.264020897423158, -0.7657475134027365, 37.94492359681441, 20.076433777284727, 6.2827314220035495, -35.63994404567112, 14.51488101366522, 5.968319262855543, 7.906845260136974, 15.138806598345418, -22.20958701372205, 7.646406195201722, 27.954615141862057, 14.667611817140397, 20.561598303199823, -20.22864461020148, 22.089715349210138, 15.411297223067177, -50.54487604451588, -20.176152629178908, -2.627886773419795, 3.9704296109854997, -14.625297600634688, 25.354235873931422, 6.546114267438639, 27.686455442024737, -11.686272243356967, -0.83436622145509, 11.073578152506936, 6.983232327201138, 11.030454459892248, 17.469076696077806, 4.576541571231402, 8.13276367178124, 33.80017393313285, -14.716820437596462, 21.55685488985704, 12.275119226455235, 17.247650493368408, 13.557785014139267, 25.984365841426236, -33.22227796774591], "episode_lengths": [782, 1117, 295, 1117, 610, 1117, 439, 1117, 1117, 1034, 215, 150, 786, 318, 530, 918, 1117, 417, 343, 1117, 373, 1097, 303, 1117, 916, 901, 1117, 317, 605, 468, 532, 739, 372, 1117, 373, 761, 1117, 295, 295, 1117, 1117, 406, 605, 1117, 784, 295, 763, 373, 1117, 295, 1117, 411, 439, 295, 295, 244, 1117, 295, 896, 683, 1117, 295, 858, 514, 295, 799, 295, 295, 1117, 91, 1117, 1117, 1117, 632, 1117, 888, 653, 657, 697, 520, 409, 1117, 1117, 1117, 439, 1071, 295, 733, 302, 1117, 295, 895, 1117, 642, 1117, 295, 269, 1117, 1117, 439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0389373747360207, "mean_inference_ms": 6.955369789211188, "mean_action_processing_ms": 0.48036302990673635, "mean_env_wait_ms": 20.654291900930847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033721208572387695, "StateBufferConnector_ms": 0.011995553970336914, "ViewRequirementAgentConnector_ms": 0.7103333473205566}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176751, "num_agent_steps_trained": 176751, "num_env_steps_sampled": 176751, "num_env_steps_trained": 176751, "num_env_steps_sampled_this_iter": 9750, "num_env_steps_trained_this_iter": 9750, "num_env_steps_sampled_throughput_per_sec": 188.67126303476806, "num_env_steps_trained_throughput_per_sec": 188.67126303476806, "timesteps_total": 176751, "num_steps_trained_this_iter": 9750, "agent_timesteps_total": 176751, "timers": {"training_iteration_time_ms": 46196.552, "sample_time_ms": 33095.206, "load_time_ms": 1683.555, "load_throughput": 5671.45, "learn_time_ms": 10869.96, "learn_throughput": 878.403, "synch_weights_time_ms": 471.273}, "counters": {"num_env_steps_sampled": 176751, "num_env_steps_trained": 176751, "num_agent_steps_sampled": 176751, "num_agent_steps_trained": 176751}, "done": false, "episodes_total": 297, "training_iteration": 21, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-49-45", "timestamp": 1749300585, "time_this_iter_s": 51.70018815994263, "time_total_s": 863.3834421634674, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 863.3834421634674, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 64.07704918032788, "ram_util_percent": 81.94754098360656, "gpu_util_percent0": 0.12508196721311476, "vram_util_percent0": 0.96044921875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.823248999999998e-05, "total_loss": -0.1304127347982548, "policy_loss": -0.023227083123229603, "vf_loss": 0.08186390903045206, "vf_explained_var": 0.8925071146894008, "kl": 0.009474459235610177, "entropy": 14.484132275682814, "entropy_coeff": 0.009116244999999997}, "model": {}, "num_grad_updates_lifetime": 6445.5, "diff_num_grad_updates_vs_sampler_policy": 234.5}}, "num_env_steps_sampled": 190092, "num_env_steps_trained": 190092, "num_agent_steps_sampled": 190092, "num_agent_steps_trained": 190092}, "sampler_results": {"episode_reward_max": 40.290784208007544, "episode_reward_min": -50.54487604451588, "episode_reward_mean": 4.719359663957999, "episode_len_mean": 735.9, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.68447046694361, -0.18223854617214574, 13.646993271858847, -8.527990512368564, 5.192039186237943, 17.475547563831675, -7.620243647122194, 27.626686773239392, 3.3197132197399117, 6.67309712229693, -4.557795107672224, -34.84829082802645, 16.10246868187135, 16.064425908875666, -3.4570369411751662, -21.614441736547672, -33.01688340269732, 6.473605169018325, 21.868078181566236, 18.342618140447954, -6.157663186033924, 3.019126894996268, 7.974865396374842, 1.7215569547085807, 8.462904216613754, 40.290784208007544, -6.069965079083829, -1.3005990498050084, -13.968218876767763, -3.030177129127196, -3.1800941572753434, 12.61441822072319, -11.141075336782299, 4.636258751859671, 18.162459503724467, 15.832750688234196, 22.147225832317645, -12.40503341620054, -11.10442596457562, 15.573523552643923, 16.230102606092455, 15.433161511997, 29.406027326757954, 12.013643651017022, -15.264020897423158, -0.7657475134027365, 37.94492359681441, 20.076433777284727, 6.2827314220035495, -35.63994404567112, 14.51488101366522, 5.968319262855543, 7.906845260136974, 15.138806598345418, -22.20958701372205, 7.646406195201722, 27.954615141862057, 14.667611817140397, 20.561598303199823, -20.22864461020148, 22.089715349210138, 15.411297223067177, -50.54487604451588, -20.176152629178908, -2.627886773419795, 3.9704296109854997, -14.625297600634688, 25.354235873931422, 6.546114267438639, 27.686455442024737, -11.686272243356967, -0.83436622145509, 11.073578152506936, 6.983232327201138, 11.030454459892248, 17.469076696077806, 4.576541571231402, 8.13276367178124, 33.80017393313285, -14.716820437596462, 21.55685488985704, 12.275119226455235, 17.247650493368408, 13.557785014139267, 25.984365841426236, -33.22227796774591, -47.89907884757628, -5.357656301323889, 3.0941031337824247, 11.521338464379498, 14.341968336743454, -1.0083021446537705, 21.203212487339137, 19.82822438113958, 13.877160997928836, -13.150313211261238, 11.065800950271202, 14.08333047310863, 25.431421148779734, 7.600194942553745], "episode_lengths": [530, 918, 1117, 417, 343, 1117, 373, 1097, 303, 1117, 916, 901, 1117, 317, 605, 468, 532, 739, 372, 1117, 373, 761, 1117, 295, 295, 1117, 1117, 406, 605, 1117, 784, 295, 763, 373, 1117, 295, 1117, 411, 439, 295, 295, 244, 1117, 295, 896, 683, 1117, 295, 858, 514, 295, 799, 295, 295, 1117, 91, 1117, 1117, 1117, 632, 1117, 888, 653, 657, 697, 520, 409, 1117, 1117, 1117, 439, 1071, 295, 733, 302, 1117, 295, 895, 1117, 642, 1117, 295, 269, 1117, 1117, 439, 697, 799, 1117, 302, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0465447985049803, "mean_inference_ms": 6.979505024030466, "mean_action_processing_ms": 0.48232655636780386, "mean_env_wait_ms": 20.712786961422623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03672504425048828, "StateBufferConnector_ms": 0.010023117065429688, "ViewRequirementAgentConnector_ms": 0.7365567684173584}}, "episode_reward_max": 40.290784208007544, "episode_reward_min": -50.54487604451588, "episode_reward_mean": 4.719359663957999, "episode_len_mean": 735.9, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-17.68447046694361, -0.18223854617214574, 13.646993271858847, -8.527990512368564, 5.192039186237943, 17.475547563831675, -7.620243647122194, 27.626686773239392, 3.3197132197399117, 6.67309712229693, -4.557795107672224, -34.84829082802645, 16.10246868187135, 16.064425908875666, -3.4570369411751662, -21.614441736547672, -33.01688340269732, 6.473605169018325, 21.868078181566236, 18.342618140447954, -6.157663186033924, 3.019126894996268, 7.974865396374842, 1.7215569547085807, 8.462904216613754, 40.290784208007544, -6.069965079083829, -1.3005990498050084, -13.968218876767763, -3.030177129127196, -3.1800941572753434, 12.61441822072319, -11.141075336782299, 4.636258751859671, 18.162459503724467, 15.832750688234196, 22.147225832317645, -12.40503341620054, -11.10442596457562, 15.573523552643923, 16.230102606092455, 15.433161511997, 29.406027326757954, 12.013643651017022, -15.264020897423158, -0.7657475134027365, 37.94492359681441, 20.076433777284727, 6.2827314220035495, -35.63994404567112, 14.51488101366522, 5.968319262855543, 7.906845260136974, 15.138806598345418, -22.20958701372205, 7.646406195201722, 27.954615141862057, 14.667611817140397, 20.561598303199823, -20.22864461020148, 22.089715349210138, 15.411297223067177, -50.54487604451588, -20.176152629178908, -2.627886773419795, 3.9704296109854997, -14.625297600634688, 25.354235873931422, 6.546114267438639, 27.686455442024737, -11.686272243356967, -0.83436622145509, 11.073578152506936, 6.983232327201138, 11.030454459892248, 17.469076696077806, 4.576541571231402, 8.13276367178124, 33.80017393313285, -14.716820437596462, 21.55685488985704, 12.275119226455235, 17.247650493368408, 13.557785014139267, 25.984365841426236, -33.22227796774591, -47.89907884757628, -5.357656301323889, 3.0941031337824247, 11.521338464379498, 14.341968336743454, -1.0083021446537705, 21.203212487339137, 19.82822438113958, 13.877160997928836, -13.150313211261238, 11.065800950271202, 14.08333047310863, 25.431421148779734, 7.600194942553745], "episode_lengths": [530, 918, 1117, 417, 343, 1117, 373, 1097, 303, 1117, 916, 901, 1117, 317, 605, 468, 532, 739, 372, 1117, 373, 761, 1117, 295, 295, 1117, 1117, 406, 605, 1117, 784, 295, 763, 373, 1117, 295, 1117, 411, 439, 295, 295, 244, 1117, 295, 896, 683, 1117, 295, 858, 514, 295, 799, 295, 295, 1117, 91, 1117, 1117, 1117, 632, 1117, 888, 653, 657, 697, 520, 409, 1117, 1117, 1117, 439, 1071, 295, 733, 302, 1117, 295, 895, 1117, 642, 1117, 295, 269, 1117, 1117, 439, 697, 799, 1117, 302, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0465447985049803, "mean_inference_ms": 6.979505024030466, "mean_action_processing_ms": 0.48232655636780386, "mean_env_wait_ms": 20.712786961422623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03672504425048828, "StateBufferConnector_ms": 0.010023117065429688, "ViewRequirementAgentConnector_ms": 0.7365567684173584}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190092, "num_agent_steps_trained": 190092, "num_env_steps_sampled": 190092, "num_env_steps_trained": 190092, "num_env_steps_sampled_this_iter": 13341, "num_env_steps_trained_this_iter": 13341, "num_env_steps_sampled_throughput_per_sec": 216.01206003366335, "num_env_steps_trained_throughput_per_sec": 216.01206003366335, "timesteps_total": 190092, "num_steps_trained_this_iter": 13341, "agent_timesteps_total": 190092, "timers": {"training_iteration_time_ms": 48420.855, "sample_time_ms": 33923.239, "load_time_ms": 1957.054, "load_throughput": 5130.723, "learn_time_ms": 11973.851, "learn_throughput": 838.586, "synch_weights_time_ms": 477.419}, "counters": {"num_env_steps_sampled": 190092, "num_env_steps_trained": 190092, "num_agent_steps_sampled": 190092, "num_agent_steps_trained": 190092}, "done": false, "episodes_total": 311, "training_iteration": 22, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-50-47", "timestamp": 1749300647, "time_this_iter_s": 61.7861750125885, "time_total_s": 925.1696171760559, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 925.1696171760559, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 68.14189189189189, "ram_util_percent": 80.44594594594595, "gpu_util_percent0": 0.13567567567567568, "vram_util_percent0": 0.96044921875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.809908000000003e-05, "total_loss": -0.11023906011862727, "policy_loss": -0.0025298300564874153, "vf_loss": 0.07812836842659192, "vf_explained_var": 0.9061263449681111, "kl": 0.010915883992912804, "entropy": 14.529894315279448, "entropy_coeff": 0.009049539999999998}, "model": {}, "num_grad_updates_lifetime": 6875.5, "diff_num_grad_updates_vs_sampler_policy": 194.5}}, "num_env_steps_sampled": 201050, "num_env_steps_trained": 201050, "num_agent_steps_sampled": 201050, "num_agent_steps_trained": 201050}, "sampler_results": {"episode_reward_max": 63.209162391923044, "episode_reward_min": -50.54487604451588, "episode_reward_mean": 6.868556651044408, "episode_len_mean": 739.65, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.4570369411751662, -21.614441736547672, -33.01688340269732, 6.473605169018325, 21.868078181566236, 18.342618140447954, -6.157663186033924, 3.019126894996268, 7.974865396374842, 1.7215569547085807, 8.462904216613754, 40.290784208007544, -6.069965079083829, -1.3005990498050084, -13.968218876767763, -3.030177129127196, -3.1800941572753434, 12.61441822072319, -11.141075336782299, 4.636258751859671, 18.162459503724467, 15.832750688234196, 22.147225832317645, -12.40503341620054, -11.10442596457562, 15.573523552643923, 16.230102606092455, 15.433161511997, 29.406027326757954, 12.013643651017022, -15.264020897423158, -0.7657475134027365, 37.94492359681441, 20.076433777284727, 6.2827314220035495, -35.63994404567112, 14.51488101366522, 5.968319262855543, 7.906845260136974, 15.138806598345418, -22.20958701372205, 7.646406195201722, 27.954615141862057, 14.667611817140397, 20.561598303199823, -20.22864461020148, 22.089715349210138, 15.411297223067177, -50.54487604451588, -20.176152629178908, -2.627886773419795, 3.9704296109854997, -14.625297600634688, 25.354235873931422, 6.546114267438639, 27.686455442024737, -11.686272243356967, -0.83436622145509, 11.073578152506936, 6.983232327201138, 11.030454459892248, 17.469076696077806, 4.576541571231402, 8.13276367178124, 33.80017393313285, -14.716820437596462, 21.55685488985704, 12.275119226455235, 17.247650493368408, 13.557785014139267, 25.984365841426236, -33.22227796774591, -47.89907884757628, -5.357656301323889, 3.0941031337824247, 11.521338464379498, 14.341968336743454, -1.0083021446537705, 21.203212487339137, 19.82822438113958, 13.877160997928836, -13.150313211261238, 11.065800950271202, 14.08333047310863, 25.431421148779734, 7.600194942553745, -21.402890525618478, 19.570732395675364, 6.5355152138619195, 44.38157256117581, 30.489877526884793, -4.155939411690001, 15.07228593122445, 28.288527933657615, 11.629486644052783, 5.900030038904047, 34.39917174846525, 63.209162391923044, 3.058351523848714, 10.623757355921848], "episode_lengths": [605, 468, 532, 739, 372, 1117, 373, 761, 1117, 295, 295, 1117, 1117, 406, 605, 1117, 784, 295, 763, 373, 1117, 295, 1117, 411, 439, 295, 295, 244, 1117, 295, 896, 683, 1117, 295, 858, 514, 295, 799, 295, 295, 1117, 91, 1117, 1117, 1117, 632, 1117, 888, 653, 657, 697, 520, 409, 1117, 1117, 1117, 439, 1071, 295, 733, 302, 1117, 295, 895, 1117, 642, 1117, 295, 269, 1117, 1117, 439, 697, 799, 1117, 302, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 569, 295, 1059, 1117, 1117, 406, 295, 1117, 295, 1042, 1117, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.053602286116656, "mean_inference_ms": 7.000721018828489, "mean_action_processing_ms": 0.48399845792456697, "mean_env_wait_ms": 20.764825270667565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03970527648925781, "StateBufferConnector_ms": 0.010002374649047852, "ViewRequirementAgentConnector_ms": 0.741335391998291}}, "episode_reward_max": 63.209162391923044, "episode_reward_min": -50.54487604451588, "episode_reward_mean": 6.868556651044408, "episode_len_mean": 739.65, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-3.4570369411751662, -21.614441736547672, -33.01688340269732, 6.473605169018325, 21.868078181566236, 18.342618140447954, -6.157663186033924, 3.019126894996268, 7.974865396374842, 1.7215569547085807, 8.462904216613754, 40.290784208007544, -6.069965079083829, -1.3005990498050084, -13.968218876767763, -3.030177129127196, -3.1800941572753434, 12.61441822072319, -11.141075336782299, 4.636258751859671, 18.162459503724467, 15.832750688234196, 22.147225832317645, -12.40503341620054, -11.10442596457562, 15.573523552643923, 16.230102606092455, 15.433161511997, 29.406027326757954, 12.013643651017022, -15.264020897423158, -0.7657475134027365, 37.94492359681441, 20.076433777284727, 6.2827314220035495, -35.63994404567112, 14.51488101366522, 5.968319262855543, 7.906845260136974, 15.138806598345418, -22.20958701372205, 7.646406195201722, 27.954615141862057, 14.667611817140397, 20.561598303199823, -20.22864461020148, 22.089715349210138, 15.411297223067177, -50.54487604451588, -20.176152629178908, -2.627886773419795, 3.9704296109854997, -14.625297600634688, 25.354235873931422, 6.546114267438639, 27.686455442024737, -11.686272243356967, -0.83436622145509, 11.073578152506936, 6.983232327201138, 11.030454459892248, 17.469076696077806, 4.576541571231402, 8.13276367178124, 33.80017393313285, -14.716820437596462, 21.55685488985704, 12.275119226455235, 17.247650493368408, 13.557785014139267, 25.984365841426236, -33.22227796774591, -47.89907884757628, -5.357656301323889, 3.0941031337824247, 11.521338464379498, 14.341968336743454, -1.0083021446537705, 21.203212487339137, 19.82822438113958, 13.877160997928836, -13.150313211261238, 11.065800950271202, 14.08333047310863, 25.431421148779734, 7.600194942553745, -21.402890525618478, 19.570732395675364, 6.5355152138619195, 44.38157256117581, 30.489877526884793, -4.155939411690001, 15.07228593122445, 28.288527933657615, 11.629486644052783, 5.900030038904047, 34.39917174846525, 63.209162391923044, 3.058351523848714, 10.623757355921848], "episode_lengths": [605, 468, 532, 739, 372, 1117, 373, 761, 1117, 295, 295, 1117, 1117, 406, 605, 1117, 784, 295, 763, 373, 1117, 295, 1117, 411, 439, 295, 295, 244, 1117, 295, 896, 683, 1117, 295, 858, 514, 295, 799, 295, 295, 1117, 91, 1117, 1117, 1117, 632, 1117, 888, 653, 657, 697, 520, 409, 1117, 1117, 1117, 439, 1071, 295, 733, 302, 1117, 295, 895, 1117, 642, 1117, 295, 269, 1117, 1117, 439, 697, 799, 1117, 302, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 569, 295, 1059, 1117, 1117, 406, 295, 1117, 295, 1042, 1117, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.053602286116656, "mean_inference_ms": 7.000721018828489, "mean_action_processing_ms": 0.48399845792456697, "mean_env_wait_ms": 20.764825270667565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03970527648925781, "StateBufferConnector_ms": 0.010002374649047852, "ViewRequirementAgentConnector_ms": 0.741335391998291}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201050, "num_agent_steps_trained": 201050, "num_env_steps_sampled": 201050, "num_env_steps_trained": 201050, "num_env_steps_sampled_this_iter": 10958, "num_env_steps_trained_this_iter": 10958, "num_env_steps_sampled_throughput_per_sec": 215.356865966162, "num_env_steps_trained_throughput_per_sec": 215.356865966162, "timesteps_total": 201050, "num_steps_trained_this_iter": 10958, "agent_timesteps_total": 201050, "timers": {"training_iteration_time_ms": 50036.147, "sample_time_ms": 34517.98, "load_time_ms": 2018.612, "load_throughput": 5186.782, "learn_time_ms": 12932.616, "learn_throughput": 809.589, "synch_weights_time_ms": 475.764}, "counters": {"num_env_steps_sampled": 201050, "num_env_steps_trained": 201050, "num_agent_steps_sampled": 201050, "num_agent_steps_trained": 201050}, "done": false, "episodes_total": 325, "training_iteration": 23, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-51-38", "timestamp": 1749300698, "time_this_iter_s": 50.89881730079651, "time_total_s": 976.0684344768524, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 976.0684344768524, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 58.38524590163935, "ram_util_percent": 80.69672131147539, "gpu_util_percent0": 0.1718032786885246, "vram_util_percent0": 0.96044921875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.798950000000005e-05, "total_loss": -0.12874145560975497, "policy_loss": -0.01929244113077099, "vf_loss": 0.07294910293227683, "vf_explained_var": 0.9204434310396512, "kl": 0.009659375253871378, "entropy": 14.634715453783672, "entropy_coeff": 0.008994749999999998}, "model": {}, "num_grad_updates_lifetime": 7310.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 214615, "num_env_steps_trained": 214615, "num_agent_steps_sampled": 214615, "num_agent_steps_trained": 214615}, "sampler_results": {"episode_reward_max": 63.209162391923044, "episode_reward_min": -50.54487604451588, "episode_reward_mean": 8.256316934943651, "episode_len_mean": 782.16, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.968218876767763, -3.030177129127196, -3.1800941572753434, 12.61441822072319, -11.141075336782299, 4.636258751859671, 18.162459503724467, 15.832750688234196, 22.147225832317645, -12.40503341620054, -11.10442596457562, 15.573523552643923, 16.230102606092455, 15.433161511997, 29.406027326757954, 12.013643651017022, -15.264020897423158, -0.7657475134027365, 37.94492359681441, 20.076433777284727, 6.2827314220035495, -35.63994404567112, 14.51488101366522, 5.968319262855543, 7.906845260136974, 15.138806598345418, -22.20958701372205, 7.646406195201722, 27.954615141862057, 14.667611817140397, 20.561598303199823, -20.22864461020148, 22.089715349210138, 15.411297223067177, -50.54487604451588, -20.176152629178908, -2.627886773419795, 3.9704296109854997, -14.625297600634688, 25.354235873931422, 6.546114267438639, 27.686455442024737, -11.686272243356967, -0.83436622145509, 11.073578152506936, 6.983232327201138, 11.030454459892248, 17.469076696077806, 4.576541571231402, 8.13276367178124, 33.80017393313285, -14.716820437596462, 21.55685488985704, 12.275119226455235, 17.247650493368408, 13.557785014139267, 25.984365841426236, -33.22227796774591, -47.89907884757628, -5.357656301323889, 3.0941031337824247, 11.521338464379498, 14.341968336743454, -1.0083021446537705, 21.203212487339137, 19.82822438113958, 13.877160997928836, -13.150313211261238, 11.065800950271202, 14.08333047310863, 25.431421148779734, 7.600194942553745, -21.402890525618478, 19.570732395675364, 6.5355152138619195, 44.38157256117581, 30.489877526884793, -4.155939411690001, 15.07228593122445, 28.288527933657615, 11.629486644052783, 5.900030038904047, 34.39917174846525, 63.209162391923044, 3.058351523848714, 10.623757355921848, 25.27679792871316, 36.784706675311725, 19.512872375793098, 32.51625968753979, -16.897524718351477, 14.01649212283626, 30.076389825089443, 13.127521949628125, -2.8332236298484808, 3.753505865911061, 2.7322716615622293, 13.034581786689108, 7.2968786485516155, -3.0845520231103984], "episode_lengths": [605, 1117, 784, 295, 763, 373, 1117, 295, 1117, 411, 439, 295, 295, 244, 1117, 295, 896, 683, 1117, 295, 858, 514, 295, 799, 295, 295, 1117, 91, 1117, 1117, 1117, 632, 1117, 888, 653, 657, 697, 520, 409, 1117, 1117, 1117, 439, 1071, 295, 733, 302, 1117, 295, 895, 1117, 642, 1117, 295, 269, 1117, 1117, 439, 697, 799, 1117, 302, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 569, 295, 1059, 1117, 1117, 406, 295, 1117, 295, 1042, 1117, 1117, 1117, 295, 1117, 1117, 986, 1117, 633, 1117, 1117, 1117, 295, 1117, 1117, 1117, 944, 654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0626171567738716, "mean_inference_ms": 7.024120393895713, "mean_action_processing_ms": 0.48564866350651026, "mean_env_wait_ms": 20.82644169934109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03568601608276367, "StateBufferConnector_ms": 0.01600480079650879, "ViewRequirementAgentConnector_ms": 0.7451655864715576}}, "episode_reward_max": 63.209162391923044, "episode_reward_min": -50.54487604451588, "episode_reward_mean": 8.256316934943651, "episode_len_mean": 782.16, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-13.968218876767763, -3.030177129127196, -3.1800941572753434, 12.61441822072319, -11.141075336782299, 4.636258751859671, 18.162459503724467, 15.832750688234196, 22.147225832317645, -12.40503341620054, -11.10442596457562, 15.573523552643923, 16.230102606092455, 15.433161511997, 29.406027326757954, 12.013643651017022, -15.264020897423158, -0.7657475134027365, 37.94492359681441, 20.076433777284727, 6.2827314220035495, -35.63994404567112, 14.51488101366522, 5.968319262855543, 7.906845260136974, 15.138806598345418, -22.20958701372205, 7.646406195201722, 27.954615141862057, 14.667611817140397, 20.561598303199823, -20.22864461020148, 22.089715349210138, 15.411297223067177, -50.54487604451588, -20.176152629178908, -2.627886773419795, 3.9704296109854997, -14.625297600634688, 25.354235873931422, 6.546114267438639, 27.686455442024737, -11.686272243356967, -0.83436622145509, 11.073578152506936, 6.983232327201138, 11.030454459892248, 17.469076696077806, 4.576541571231402, 8.13276367178124, 33.80017393313285, -14.716820437596462, 21.55685488985704, 12.275119226455235, 17.247650493368408, 13.557785014139267, 25.984365841426236, -33.22227796774591, -47.89907884757628, -5.357656301323889, 3.0941031337824247, 11.521338464379498, 14.341968336743454, -1.0083021446537705, 21.203212487339137, 19.82822438113958, 13.877160997928836, -13.150313211261238, 11.065800950271202, 14.08333047310863, 25.431421148779734, 7.600194942553745, -21.402890525618478, 19.570732395675364, 6.5355152138619195, 44.38157256117581, 30.489877526884793, -4.155939411690001, 15.07228593122445, 28.288527933657615, 11.629486644052783, 5.900030038904047, 34.39917174846525, 63.209162391923044, 3.058351523848714, 10.623757355921848, 25.27679792871316, 36.784706675311725, 19.512872375793098, 32.51625968753979, -16.897524718351477, 14.01649212283626, 30.076389825089443, 13.127521949628125, -2.8332236298484808, 3.753505865911061, 2.7322716615622293, 13.034581786689108, 7.2968786485516155, -3.0845520231103984], "episode_lengths": [605, 1117, 784, 295, 763, 373, 1117, 295, 1117, 411, 439, 295, 295, 244, 1117, 295, 896, 683, 1117, 295, 858, 514, 295, 799, 295, 295, 1117, 91, 1117, 1117, 1117, 632, 1117, 888, 653, 657, 697, 520, 409, 1117, 1117, 1117, 439, 1071, 295, 733, 302, 1117, 295, 895, 1117, 642, 1117, 295, 269, 1117, 1117, 439, 697, 799, 1117, 302, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 569, 295, 1059, 1117, 1117, 406, 295, 1117, 295, 1042, 1117, 1117, 1117, 295, 1117, 1117, 986, 1117, 633, 1117, 1117, 1117, 295, 1117, 1117, 1117, 944, 654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0626171567738716, "mean_inference_ms": 7.024120393895713, "mean_action_processing_ms": 0.48564866350651026, "mean_env_wait_ms": 20.82644169934109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03568601608276367, "StateBufferConnector_ms": 0.01600480079650879, "ViewRequirementAgentConnector_ms": 0.7451655864715576}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 214615, "num_agent_steps_trained": 214615, "num_env_steps_sampled": 214615, "num_env_steps_trained": 214615, "num_env_steps_sampled_this_iter": 13565, "num_env_steps_trained_this_iter": 13565, "num_env_steps_sampled_throughput_per_sec": 225.03123831932567, "num_env_steps_trained_throughput_per_sec": 225.03123831932567, "timesteps_total": 214615, "num_steps_trained_this_iter": 13565, "agent_timesteps_total": 214615, "timers": {"training_iteration_time_ms": 50836.063, "sample_time_ms": 34935.131, "load_time_ms": 2237.455, "load_throughput": 4806.577, "learn_time_ms": 13094.757, "learn_throughput": 821.283, "synch_weights_time_ms": 473.148}, "counters": {"num_env_steps_sampled": 214615, "num_env_steps_trained": 214615, "num_agent_steps_sampled": 214615, "num_agent_steps_trained": 214615}, "done": false, "episodes_total": 339, "training_iteration": 24, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-52-38", "timestamp": 1749300758, "time_this_iter_s": 60.294519901275635, "time_total_s": 1036.362954378128, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1036.362954378128, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 64.9, "ram_util_percent": 83.83380281690141, "gpu_util_percent0": 0.16211267605633803, "vram_util_percent0": 0.96044921875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.785385000000002e-05, "total_loss": -0.12813138934396665, "policy_loss": -0.021476427968418983, "vf_loss": 0.07966414374575295, "vf_explained_var": 0.915441823999087, "kl": 0.009922784523358572, "entropy": 14.659503864358973, "entropy_coeff": 0.008926925}, "model": {}, "num_grad_updates_lifetime": 7820.5, "diff_num_grad_updates_vs_sampler_policy": 269.5}}, "num_env_steps_sampled": 229945, "num_env_steps_trained": 229945, "num_agent_steps_sampled": 229945, "num_agent_steps_trained": 229945}, "sampler_results": {"episode_reward_max": 63.209162391923044, "episode_reward_min": -50.54487604451588, "episode_reward_mean": 9.900905507890563, "episode_len_mean": 853.96, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.406027326757954, 12.013643651017022, -15.264020897423158, -0.7657475134027365, 37.94492359681441, 20.076433777284727, 6.2827314220035495, -35.63994404567112, 14.51488101366522, 5.968319262855543, 7.906845260136974, 15.138806598345418, -22.20958701372205, 7.646406195201722, 27.954615141862057, 14.667611817140397, 20.561598303199823, -20.22864461020148, 22.089715349210138, 15.411297223067177, -50.54487604451588, -20.176152629178908, -2.627886773419795, 3.9704296109854997, -14.625297600634688, 25.354235873931422, 6.546114267438639, 27.686455442024737, -11.686272243356967, -0.83436622145509, 11.073578152506936, 6.983232327201138, 11.030454459892248, 17.469076696077806, 4.576541571231402, 8.13276367178124, 33.80017393313285, -14.716820437596462, 21.55685488985704, 12.275119226455235, 17.247650493368408, 13.557785014139267, 25.984365841426236, -33.22227796774591, -47.89907884757628, -5.357656301323889, 3.0941031337824247, 11.521338464379498, 14.341968336743454, -1.0083021446537705, 21.203212487339137, 19.82822438113958, 13.877160997928836, -13.150313211261238, 11.065800950271202, 14.08333047310863, 25.431421148779734, 7.600194942553745, -21.402890525618478, 19.570732395675364, 6.5355152138619195, 44.38157256117581, 30.489877526884793, -4.155939411690001, 15.07228593122445, 28.288527933657615, 11.629486644052783, 5.900030038904047, 34.39917174846525, 63.209162391923044, 3.058351523848714, 10.623757355921848, 25.27679792871316, 36.784706675311725, 19.512872375793098, 32.51625968753979, -16.897524718351477, 14.01649212283626, 30.076389825089443, 13.127521949628125, -2.8332236298484808, 3.753505865911061, 2.7322716615622293, 13.034581786689108, 7.2968786485516155, -3.0845520231103984, 30.102267549281194, 46.43342781518858, 20.776641406208125, 1.2602841803291942, -2.4024494027762615, -3.290203425273517, 54.9162897370555, 18.696449987278, 20.658432227154215, -3.578119789088189, 28.8155024078462, -14.540203329220132, 15.690794605744124, 16.720619111827766], "episode_lengths": [1117, 295, 896, 683, 1117, 295, 858, 514, 295, 799, 295, 295, 1117, 91, 1117, 1117, 1117, 632, 1117, 888, 653, 657, 697, 520, 409, 1117, 1117, 1117, 439, 1071, 295, 733, 302, 1117, 295, 895, 1117, 642, 1117, 295, 269, 1117, 1117, 439, 697, 799, 1117, 302, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 569, 295, 1059, 1117, 1117, 406, 295, 1117, 295, 1042, 1117, 1117, 1117, 295, 1117, 1117, 986, 1117, 633, 1117, 1117, 1117, 295, 1117, 1117, 1117, 944, 654, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1037, 1117, 1117, 1117, 889, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0790853781011447, "mean_inference_ms": 7.058904183454281, "mean_action_processing_ms": 0.4877578515045093, "mean_env_wait_ms": 20.914604908952068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03471255302429199, "StateBufferConnector_ms": 0.020957469940185547, "ViewRequirementAgentConnector_ms": 0.7675175666809082}}, "episode_reward_max": 63.209162391923044, "episode_reward_min": -50.54487604451588, "episode_reward_mean": 9.900905507890563, "episode_len_mean": 853.96, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.406027326757954, 12.013643651017022, -15.264020897423158, -0.7657475134027365, 37.94492359681441, 20.076433777284727, 6.2827314220035495, -35.63994404567112, 14.51488101366522, 5.968319262855543, 7.906845260136974, 15.138806598345418, -22.20958701372205, 7.646406195201722, 27.954615141862057, 14.667611817140397, 20.561598303199823, -20.22864461020148, 22.089715349210138, 15.411297223067177, -50.54487604451588, -20.176152629178908, -2.627886773419795, 3.9704296109854997, -14.625297600634688, 25.354235873931422, 6.546114267438639, 27.686455442024737, -11.686272243356967, -0.83436622145509, 11.073578152506936, 6.983232327201138, 11.030454459892248, 17.469076696077806, 4.576541571231402, 8.13276367178124, 33.80017393313285, -14.716820437596462, 21.55685488985704, 12.275119226455235, 17.247650493368408, 13.557785014139267, 25.984365841426236, -33.22227796774591, -47.89907884757628, -5.357656301323889, 3.0941031337824247, 11.521338464379498, 14.341968336743454, -1.0083021446537705, 21.203212487339137, 19.82822438113958, 13.877160997928836, -13.150313211261238, 11.065800950271202, 14.08333047310863, 25.431421148779734, 7.600194942553745, -21.402890525618478, 19.570732395675364, 6.5355152138619195, 44.38157256117581, 30.489877526884793, -4.155939411690001, 15.07228593122445, 28.288527933657615, 11.629486644052783, 5.900030038904047, 34.39917174846525, 63.209162391923044, 3.058351523848714, 10.623757355921848, 25.27679792871316, 36.784706675311725, 19.512872375793098, 32.51625968753979, -16.897524718351477, 14.01649212283626, 30.076389825089443, 13.127521949628125, -2.8332236298484808, 3.753505865911061, 2.7322716615622293, 13.034581786689108, 7.2968786485516155, -3.0845520231103984, 30.102267549281194, 46.43342781518858, 20.776641406208125, 1.2602841803291942, -2.4024494027762615, -3.290203425273517, 54.9162897370555, 18.696449987278, 20.658432227154215, -3.578119789088189, 28.8155024078462, -14.540203329220132, 15.690794605744124, 16.720619111827766], "episode_lengths": [1117, 295, 896, 683, 1117, 295, 858, 514, 295, 799, 295, 295, 1117, 91, 1117, 1117, 1117, 632, 1117, 888, 653, 657, 697, 520, 409, 1117, 1117, 1117, 439, 1071, 295, 733, 302, 1117, 295, 895, 1117, 642, 1117, 295, 269, 1117, 1117, 439, 697, 799, 1117, 302, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 569, 295, 1059, 1117, 1117, 406, 295, 1117, 295, 1042, 1117, 1117, 1117, 295, 1117, 1117, 986, 1117, 633, 1117, 1117, 1117, 295, 1117, 1117, 1117, 944, 654, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1037, 1117, 1117, 1117, 889, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0790853781011447, "mean_inference_ms": 7.058904183454281, "mean_action_processing_ms": 0.4877578515045093, "mean_env_wait_ms": 20.914604908952068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03471255302429199, "StateBufferConnector_ms": 0.020957469940185547, "ViewRequirementAgentConnector_ms": 0.7675175666809082}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229945, "num_agent_steps_trained": 229945, "num_env_steps_sampled": 229945, "num_env_steps_trained": 229945, "num_env_steps_sampled_this_iter": 15330, "num_env_steps_trained_this_iter": 15330, "num_env_steps_sampled_throughput_per_sec": 225.60732587776226, "num_env_steps_trained_throughput_per_sec": 225.60732587776226, "timesteps_total": 229945, "num_steps_trained_this_iter": 15330, "agent_timesteps_total": 229945, "timers": {"training_iteration_time_ms": 52928.231, "sample_time_ms": 35846.461, "load_time_ms": 2660.907, "load_throughput": 4243.402, "learn_time_ms": 13845.259, "learn_throughput": 815.535, "synch_weights_time_ms": 470.149}, "counters": {"num_env_steps_sampled": 229945, "num_env_steps_trained": 229945, "num_agent_steps_sampled": 229945, "num_agent_steps_trained": 229945}, "done": false, "episodes_total": 353, "training_iteration": 25, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-53-46", "timestamp": 1749300826, "time_this_iter_s": 67.96424508094788, "time_total_s": 1104.327199459076, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1104.327199459076, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 66.0525, "ram_util_percent": 90.1625, "gpu_util_percent0": 0.17887499999999998, "vram_util_percent0": 0.9611572265625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.770054999999999e-05, "total_loss": -0.13187502182766117, "policy_loss": -0.025817552527587394, "vf_loss": 0.07597571684216911, "vf_explained_var": 0.9104373734105717, "kl": 0.010175758733881487, "entropy": 14.59482155496424, "entropy_coeff": 0.008850275000000003}, "model": {}, "num_grad_updates_lifetime": 8310.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 242355, "num_env_steps_trained": 242355, "num_agent_steps_sampled": 242355, "num_agent_steps_trained": 242355}, "sampler_results": {"episode_reward_max": 63.209162391923044, "episode_reward_min": -50.54487604451588, "episode_reward_mean": 10.908431813135692, "episode_len_mean": 891.39, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.954615141862057, 14.667611817140397, 20.561598303199823, -20.22864461020148, 22.089715349210138, 15.411297223067177, -50.54487604451588, -20.176152629178908, -2.627886773419795, 3.9704296109854997, -14.625297600634688, 25.354235873931422, 6.546114267438639, 27.686455442024737, -11.686272243356967, -0.83436622145509, 11.073578152506936, 6.983232327201138, 11.030454459892248, 17.469076696077806, 4.576541571231402, 8.13276367178124, 33.80017393313285, -14.716820437596462, 21.55685488985704, 12.275119226455235, 17.247650493368408, 13.557785014139267, 25.984365841426236, -33.22227796774591, -47.89907884757628, -5.357656301323889, 3.0941031337824247, 11.521338464379498, 14.341968336743454, -1.0083021446537705, 21.203212487339137, 19.82822438113958, 13.877160997928836, -13.150313211261238, 11.065800950271202, 14.08333047310863, 25.431421148779734, 7.600194942553745, -21.402890525618478, 19.570732395675364, 6.5355152138619195, 44.38157256117581, 30.489877526884793, -4.155939411690001, 15.07228593122445, 28.288527933657615, 11.629486644052783, 5.900030038904047, 34.39917174846525, 63.209162391923044, 3.058351523848714, 10.623757355921848, 25.27679792871316, 36.784706675311725, 19.512872375793098, 32.51625968753979, -16.897524718351477, 14.01649212283626, 30.076389825089443, 13.127521949628125, -2.8332236298484808, 3.753505865911061, 2.7322716615622293, 13.034581786689108, 7.2968786485516155, -3.0845520231103984, 30.102267549281194, 46.43342781518858, 20.776641406208125, 1.2602841803291942, -2.4024494027762615, -3.290203425273517, 54.9162897370555, 18.696449987278, 20.658432227154215, -3.578119789088189, 28.8155024078462, -14.540203329220132, 15.690794605744124, 16.720619111827766, 23.051477229095617, 9.189403793906566, 21.906826235530513, -8.104883603692706, 13.166390008175977, 30.09958729661068, 22.348323708784147, 33.66658183279522, 24.17461708638964, 12.318205260541216, 26.702891805900936, -28.62941941448123, 3.7341184125350395, 0.14822950628460463], "episode_lengths": [1117, 1117, 1117, 632, 1117, 888, 653, 657, 697, 520, 409, 1117, 1117, 1117, 439, 1071, 295, 733, 302, 1117, 295, 895, 1117, 642, 1117, 295, 269, 1117, 1117, 439, 697, 799, 1117, 302, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 569, 295, 1059, 1117, 1117, 406, 295, 1117, 295, 1042, 1117, 1117, 1117, 295, 1117, 1117, 986, 1117, 633, 1117, 1117, 1117, 295, 1117, 1117, 1117, 944, 654, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1037, 1117, 1117, 1117, 889, 1117, 1117, 1117, 938, 1117, 1117, 295, 1117, 269, 1117, 1117, 295, 1117, 866, 982, 946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0962008494655446, "mean_inference_ms": 7.095483709353158, "mean_action_processing_ms": 0.4898919117279858, "mean_env_wait_ms": 21.00446020288141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02509450912475586, "StateBufferConnector_ms": 0.022969484329223633, "ViewRequirementAgentConnector_ms": 0.7731873989105225}}, "episode_reward_max": 63.209162391923044, "episode_reward_min": -50.54487604451588, "episode_reward_mean": 10.908431813135692, "episode_len_mean": 891.39, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.954615141862057, 14.667611817140397, 20.561598303199823, -20.22864461020148, 22.089715349210138, 15.411297223067177, -50.54487604451588, -20.176152629178908, -2.627886773419795, 3.9704296109854997, -14.625297600634688, 25.354235873931422, 6.546114267438639, 27.686455442024737, -11.686272243356967, -0.83436622145509, 11.073578152506936, 6.983232327201138, 11.030454459892248, 17.469076696077806, 4.576541571231402, 8.13276367178124, 33.80017393313285, -14.716820437596462, 21.55685488985704, 12.275119226455235, 17.247650493368408, 13.557785014139267, 25.984365841426236, -33.22227796774591, -47.89907884757628, -5.357656301323889, 3.0941031337824247, 11.521338464379498, 14.341968336743454, -1.0083021446537705, 21.203212487339137, 19.82822438113958, 13.877160997928836, -13.150313211261238, 11.065800950271202, 14.08333047310863, 25.431421148779734, 7.600194942553745, -21.402890525618478, 19.570732395675364, 6.5355152138619195, 44.38157256117581, 30.489877526884793, -4.155939411690001, 15.07228593122445, 28.288527933657615, 11.629486644052783, 5.900030038904047, 34.39917174846525, 63.209162391923044, 3.058351523848714, 10.623757355921848, 25.27679792871316, 36.784706675311725, 19.512872375793098, 32.51625968753979, -16.897524718351477, 14.01649212283626, 30.076389825089443, 13.127521949628125, -2.8332236298484808, 3.753505865911061, 2.7322716615622293, 13.034581786689108, 7.2968786485516155, -3.0845520231103984, 30.102267549281194, 46.43342781518858, 20.776641406208125, 1.2602841803291942, -2.4024494027762615, -3.290203425273517, 54.9162897370555, 18.696449987278, 20.658432227154215, -3.578119789088189, 28.8155024078462, -14.540203329220132, 15.690794605744124, 16.720619111827766, 23.051477229095617, 9.189403793906566, 21.906826235530513, -8.104883603692706, 13.166390008175977, 30.09958729661068, 22.348323708784147, 33.66658183279522, 24.17461708638964, 12.318205260541216, 26.702891805900936, -28.62941941448123, 3.7341184125350395, 0.14822950628460463], "episode_lengths": [1117, 1117, 1117, 632, 1117, 888, 653, 657, 697, 520, 409, 1117, 1117, 1117, 439, 1071, 295, 733, 302, 1117, 295, 895, 1117, 642, 1117, 295, 269, 1117, 1117, 439, 697, 799, 1117, 302, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 569, 295, 1059, 1117, 1117, 406, 295, 1117, 295, 1042, 1117, 1117, 1117, 295, 1117, 1117, 986, 1117, 633, 1117, 1117, 1117, 295, 1117, 1117, 1117, 944, 654, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1037, 1117, 1117, 1117, 889, 1117, 1117, 1117, 938, 1117, 1117, 295, 1117, 269, 1117, 1117, 295, 1117, 866, 982, 946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0962008494655446, "mean_inference_ms": 7.095483709353158, "mean_action_processing_ms": 0.4898919117279858, "mean_env_wait_ms": 21.00446020288141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02509450912475586, "StateBufferConnector_ms": 0.022969484329223633, "ViewRequirementAgentConnector_ms": 0.7731873989105225}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242355, "num_agent_steps_trained": 242355, "num_env_steps_sampled": 242355, "num_env_steps_trained": 242355, "num_env_steps_sampled_this_iter": 12410, "num_env_steps_trained_this_iter": 12410, "num_env_steps_sampled_throughput_per_sec": 237.51669141249826, "num_env_steps_trained_throughput_per_sec": 237.51669141249826, "timesteps_total": 242355, "num_steps_trained_this_iter": 12410, "agent_timesteps_total": 242355, "timers": {"training_iteration_time_ms": 52963.074, "sample_time_ms": 36101.395, "load_time_ms": 2570.256, "load_throughput": 4461.229, "learn_time_ms": 13707.438, "learn_throughput": 836.517, "synch_weights_time_ms": 478.131}, "counters": {"num_env_steps_sampled": 242355, "num_env_steps_trained": 242355, "num_agent_steps_sampled": 242355, "num_agent_steps_trained": 242355}, "done": false, "episodes_total": 367, "training_iteration": 26, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-54-38", "timestamp": 1749300878, "time_this_iter_s": 52.265958309173584, "time_total_s": 1156.5931577682495, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1156.5931577682495, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 65.6774193548387, "ram_util_percent": 89.98064516129033, "gpu_util_percent0": 0.13693548387096777, "vram_util_percent0": 0.96240234375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.757644999999999e-05, "total_loss": -0.10051532861318926, "policy_loss": 0.002366124849967574, "vf_loss": 0.08584826247216287, "vf_explained_var": 0.9104100912809372, "kl": 0.010610339133704242, "entropy": 14.675034624880011, "entropy_coeff": 0.008788224999999997}, "model": {}, "num_grad_updates_lifetime": 8750.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 254921, "num_env_steps_trained": 254921, "num_agent_steps_sampled": 254921, "num_agent_steps_trained": 254921}, "sampler_results": {"episode_reward_max": 63.209162391923044, "episode_reward_min": -47.89907884757628, "episode_reward_mean": 11.33830228882543, "episode_len_mean": 894.3, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.686272243356967, -0.83436622145509, 11.073578152506936, 6.983232327201138, 11.030454459892248, 17.469076696077806, 4.576541571231402, 8.13276367178124, 33.80017393313285, -14.716820437596462, 21.55685488985704, 12.275119226455235, 17.247650493368408, 13.557785014139267, 25.984365841426236, -33.22227796774591, -47.89907884757628, -5.357656301323889, 3.0941031337824247, 11.521338464379498, 14.341968336743454, -1.0083021446537705, 21.203212487339137, 19.82822438113958, 13.877160997928836, -13.150313211261238, 11.065800950271202, 14.08333047310863, 25.431421148779734, 7.600194942553745, -21.402890525618478, 19.570732395675364, 6.5355152138619195, 44.38157256117581, 30.489877526884793, -4.155939411690001, 15.07228593122445, 28.288527933657615, 11.629486644052783, 5.900030038904047, 34.39917174846525, 63.209162391923044, 3.058351523848714, 10.623757355921848, 25.27679792871316, 36.784706675311725, 19.512872375793098, 32.51625968753979, -16.897524718351477, 14.01649212283626, 30.076389825089443, 13.127521949628125, -2.8332236298484808, 3.753505865911061, 2.7322716615622293, 13.034581786689108, 7.2968786485516155, -3.0845520231103984, 30.102267549281194, 46.43342781518858, 20.776641406208125, 1.2602841803291942, -2.4024494027762615, -3.290203425273517, 54.9162897370555, 18.696449987278, 20.658432227154215, -3.578119789088189, 28.8155024078462, -14.540203329220132, 15.690794605744124, 16.720619111827766, 23.051477229095617, 9.189403793906566, 21.906826235530513, -8.104883603692706, 13.166390008175977, 30.09958729661068, 22.348323708784147, 33.66658183279522, 24.17461708638964, 12.318205260541216, 26.702891805900936, -28.62941941448123, 3.7341184125350395, 0.14822950628460463, -20.935654507186268, 44.50164045349431, 29.564079404695573, 15.925882972348967, -3.421926062726666, -15.46966125240436, 3.7667721677284502, 14.856614713122974, -17.342928965463948, 24.26767766333396, 36.284990953382845, 12.565600425108684, -14.948470057553092, -10.588354967998292], "episode_lengths": [439, 1071, 295, 733, 302, 1117, 295, 895, 1117, 642, 1117, 295, 269, 1117, 1117, 439, 697, 799, 1117, 302, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 569, 295, 1059, 1117, 1117, 406, 295, 1117, 295, 1042, 1117, 1117, 1117, 295, 1117, 1117, 986, 1117, 633, 1117, 1117, 1117, 295, 1117, 1117, 1117, 944, 654, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1037, 1117, 1117, 1117, 889, 1117, 1117, 1117, 938, 1117, 1117, 295, 1117, 269, 1117, 1117, 295, 1117, 866, 982, 946, 761, 1117, 1117, 949, 954, 807, 402, 295, 795, 1117, 1117, 1117, 901, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1127393751063095, "mean_inference_ms": 7.131969765385954, "mean_action_processing_ms": 0.49199618486750635, "mean_env_wait_ms": 21.092216721146272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02910757064819336, "StateBufferConnector_ms": 0.02505207061767578, "ViewRequirementAgentConnector_ms": 0.7821860313415527}}, "episode_reward_max": 63.209162391923044, "episode_reward_min": -47.89907884757628, "episode_reward_mean": 11.33830228882543, "episode_len_mean": 894.3, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-11.686272243356967, -0.83436622145509, 11.073578152506936, 6.983232327201138, 11.030454459892248, 17.469076696077806, 4.576541571231402, 8.13276367178124, 33.80017393313285, -14.716820437596462, 21.55685488985704, 12.275119226455235, 17.247650493368408, 13.557785014139267, 25.984365841426236, -33.22227796774591, -47.89907884757628, -5.357656301323889, 3.0941031337824247, 11.521338464379498, 14.341968336743454, -1.0083021446537705, 21.203212487339137, 19.82822438113958, 13.877160997928836, -13.150313211261238, 11.065800950271202, 14.08333047310863, 25.431421148779734, 7.600194942553745, -21.402890525618478, 19.570732395675364, 6.5355152138619195, 44.38157256117581, 30.489877526884793, -4.155939411690001, 15.07228593122445, 28.288527933657615, 11.629486644052783, 5.900030038904047, 34.39917174846525, 63.209162391923044, 3.058351523848714, 10.623757355921848, 25.27679792871316, 36.784706675311725, 19.512872375793098, 32.51625968753979, -16.897524718351477, 14.01649212283626, 30.076389825089443, 13.127521949628125, -2.8332236298484808, 3.753505865911061, 2.7322716615622293, 13.034581786689108, 7.2968786485516155, -3.0845520231103984, 30.102267549281194, 46.43342781518858, 20.776641406208125, 1.2602841803291942, -2.4024494027762615, -3.290203425273517, 54.9162897370555, 18.696449987278, 20.658432227154215, -3.578119789088189, 28.8155024078462, -14.540203329220132, 15.690794605744124, 16.720619111827766, 23.051477229095617, 9.189403793906566, 21.906826235530513, -8.104883603692706, 13.166390008175977, 30.09958729661068, 22.348323708784147, 33.66658183279522, 24.17461708638964, 12.318205260541216, 26.702891805900936, -28.62941941448123, 3.7341184125350395, 0.14822950628460463, -20.935654507186268, 44.50164045349431, 29.564079404695573, 15.925882972348967, -3.421926062726666, -15.46966125240436, 3.7667721677284502, 14.856614713122974, -17.342928965463948, 24.26767766333396, 36.284990953382845, 12.565600425108684, -14.948470057553092, -10.588354967998292], "episode_lengths": [439, 1071, 295, 733, 302, 1117, 295, 895, 1117, 642, 1117, 295, 269, 1117, 1117, 439, 697, 799, 1117, 302, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 569, 295, 1059, 1117, 1117, 406, 295, 1117, 295, 1042, 1117, 1117, 1117, 295, 1117, 1117, 986, 1117, 633, 1117, 1117, 1117, 295, 1117, 1117, 1117, 944, 654, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1037, 1117, 1117, 1117, 889, 1117, 1117, 1117, 938, 1117, 1117, 295, 1117, 269, 1117, 1117, 295, 1117, 866, 982, 946, 761, 1117, 1117, 949, 954, 807, 402, 295, 795, 1117, 1117, 1117, 901, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1127393751063095, "mean_inference_ms": 7.131969765385954, "mean_action_processing_ms": 0.49199618486750635, "mean_env_wait_ms": 21.092216721146272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02910757064819336, "StateBufferConnector_ms": 0.02505207061767578, "ViewRequirementAgentConnector_ms": 0.7821860313415527}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 254921, "num_agent_steps_trained": 254921, "num_env_steps_sampled": 254921, "num_env_steps_trained": 254921, "num_env_steps_sampled_this_iter": 12566, "num_env_steps_trained_this_iter": 12566, "num_env_steps_sampled_throughput_per_sec": 231.95469231436854, "num_env_steps_trained_throughput_per_sec": 231.95469231436854, "timesteps_total": 254921, "num_steps_trained_this_iter": 12566, "agent_timesteps_total": 254921, "timers": {"training_iteration_time_ms": 53823.951, "sample_time_ms": 36528.795, "load_time_ms": 2633.614, "load_throughput": 4477.384, "learn_time_ms": 14108.959, "learn_throughput": 835.76, "synch_weights_time_ms": 443.421}, "counters": {"num_env_steps_sampled": 254921, "num_env_steps_trained": 254921, "num_agent_steps_sampled": 254921, "num_agent_steps_trained": 254921}, "done": false, "episodes_total": 381, "training_iteration": 27, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-55-33", "timestamp": 1749300933, "time_this_iter_s": 54.19188404083252, "time_total_s": 1210.785041809082, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1210.785041809082, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 64.796875, "ram_util_percent": 88.759375, "gpu_util_percent0": 0.16328125000000002, "vram_util_percent0": 0.96240234375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.745079000000001e-05, "total_loss": -0.10438140880349757, "policy_loss": -0.0021628290392635835, "vf_loss": 0.08509392503294207, "vf_explained_var": 0.9231252040181841, "kl": 0.010106098689756196, "entropy": 14.67699407849993, "entropy_coeff": 0.008725394999999999}, "model": {}, "num_grad_updates_lifetime": 9180.5, "diff_num_grad_updates_vs_sampler_policy": 209.5}}, "num_env_steps_sampled": 266875, "num_env_steps_trained": 266875, "num_agent_steps_sampled": 266875, "num_agent_steps_trained": 266875}, "sampler_results": {"episode_reward_max": 63.209162391923044, "episode_reward_min": -80.23072985704015, "episode_reward_mean": 12.175972126367112, "episode_len_mean": 916.8, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.984365841426236, -33.22227796774591, -47.89907884757628, -5.357656301323889, 3.0941031337824247, 11.521338464379498, 14.341968336743454, -1.0083021446537705, 21.203212487339137, 19.82822438113958, 13.877160997928836, -13.150313211261238, 11.065800950271202, 14.08333047310863, 25.431421148779734, 7.600194942553745, -21.402890525618478, 19.570732395675364, 6.5355152138619195, 44.38157256117581, 30.489877526884793, -4.155939411690001, 15.07228593122445, 28.288527933657615, 11.629486644052783, 5.900030038904047, 34.39917174846525, 63.209162391923044, 3.058351523848714, 10.623757355921848, 25.27679792871316, 36.784706675311725, 19.512872375793098, 32.51625968753979, -16.897524718351477, 14.01649212283626, 30.076389825089443, 13.127521949628125, -2.8332236298484808, 3.753505865911061, 2.7322716615622293, 13.034581786689108, 7.2968786485516155, -3.0845520231103984, 30.102267549281194, 46.43342781518858, 20.776641406208125, 1.2602841803291942, -2.4024494027762615, -3.290203425273517, 54.9162897370555, 18.696449987278, 20.658432227154215, -3.578119789088189, 28.8155024078462, -14.540203329220132, 15.690794605744124, 16.720619111827766, 23.051477229095617, 9.189403793906566, 21.906826235530513, -8.104883603692706, 13.166390008175977, 30.09958729661068, 22.348323708784147, 33.66658183279522, 24.17461708638964, 12.318205260541216, 26.702891805900936, -28.62941941448123, 3.7341184125350395, 0.14822950628460463, -20.935654507186268, 44.50164045349431, 29.564079404695573, 15.925882972348967, -3.421926062726666, -15.46966125240436, 3.7667721677284502, 14.856614713122974, -17.342928965463948, 24.26767766333396, 36.284990953382845, 12.565600425108684, -14.948470057553092, -10.588354967998292, 10.184953330919232, -7.898499998688467, 27.675318111231498, 31.826627930179445, 26.918966104546378, 21.77162488729421, 46.6181784519002, 12.304016821171102, 35.39789462196631, -80.23072985704015, 18.945673411782742, -2.545724319690629, 54.634073132580674, 18.63038265925059], "episode_lengths": [1117, 439, 697, 799, 1117, 302, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 569, 295, 1059, 1117, 1117, 406, 295, 1117, 295, 1042, 1117, 1117, 1117, 295, 1117, 1117, 986, 1117, 633, 1117, 1117, 1117, 295, 1117, 1117, 1117, 944, 654, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1037, 1117, 1117, 1117, 889, 1117, 1117, 1117, 938, 1117, 1117, 295, 1117, 269, 1117, 1117, 295, 1117, 866, 982, 946, 761, 1117, 1117, 949, 954, 807, 402, 295, 795, 1117, 1117, 1117, 901, 1117, 269, 399, 1117, 1117, 1117, 1117, 1117, 269, 1117, 695, 269, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.128323592200467, "mean_inference_ms": 7.16344730605073, "mean_action_processing_ms": 0.49368067829328177, "mean_env_wait_ms": 21.17188124083952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02907538414001465, "StateBufferConnector_ms": 0.027039527893066406, "ViewRequirementAgentConnector_ms": 0.7563285827636719}}, "episode_reward_max": 63.209162391923044, "episode_reward_min": -80.23072985704015, "episode_reward_mean": 12.175972126367112, "episode_len_mean": 916.8, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.984365841426236, -33.22227796774591, -47.89907884757628, -5.357656301323889, 3.0941031337824247, 11.521338464379498, 14.341968336743454, -1.0083021446537705, 21.203212487339137, 19.82822438113958, 13.877160997928836, -13.150313211261238, 11.065800950271202, 14.08333047310863, 25.431421148779734, 7.600194942553745, -21.402890525618478, 19.570732395675364, 6.5355152138619195, 44.38157256117581, 30.489877526884793, -4.155939411690001, 15.07228593122445, 28.288527933657615, 11.629486644052783, 5.900030038904047, 34.39917174846525, 63.209162391923044, 3.058351523848714, 10.623757355921848, 25.27679792871316, 36.784706675311725, 19.512872375793098, 32.51625968753979, -16.897524718351477, 14.01649212283626, 30.076389825089443, 13.127521949628125, -2.8332236298484808, 3.753505865911061, 2.7322716615622293, 13.034581786689108, 7.2968786485516155, -3.0845520231103984, 30.102267549281194, 46.43342781518858, 20.776641406208125, 1.2602841803291942, -2.4024494027762615, -3.290203425273517, 54.9162897370555, 18.696449987278, 20.658432227154215, -3.578119789088189, 28.8155024078462, -14.540203329220132, 15.690794605744124, 16.720619111827766, 23.051477229095617, 9.189403793906566, 21.906826235530513, -8.104883603692706, 13.166390008175977, 30.09958729661068, 22.348323708784147, 33.66658183279522, 24.17461708638964, 12.318205260541216, 26.702891805900936, -28.62941941448123, 3.7341184125350395, 0.14822950628460463, -20.935654507186268, 44.50164045349431, 29.564079404695573, 15.925882972348967, -3.421926062726666, -15.46966125240436, 3.7667721677284502, 14.856614713122974, -17.342928965463948, 24.26767766333396, 36.284990953382845, 12.565600425108684, -14.948470057553092, -10.588354967998292, 10.184953330919232, -7.898499998688467, 27.675318111231498, 31.826627930179445, 26.918966104546378, 21.77162488729421, 46.6181784519002, 12.304016821171102, 35.39789462196631, -80.23072985704015, 18.945673411782742, -2.545724319690629, 54.634073132580674, 18.63038265925059], "episode_lengths": [1117, 439, 697, 799, 1117, 302, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 569, 295, 1059, 1117, 1117, 406, 295, 1117, 295, 1042, 1117, 1117, 1117, 295, 1117, 1117, 986, 1117, 633, 1117, 1117, 1117, 295, 1117, 1117, 1117, 944, 654, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1037, 1117, 1117, 1117, 889, 1117, 1117, 1117, 938, 1117, 1117, 295, 1117, 269, 1117, 1117, 295, 1117, 866, 982, 946, 761, 1117, 1117, 949, 954, 807, 402, 295, 795, 1117, 1117, 1117, 901, 1117, 269, 399, 1117, 1117, 1117, 1117, 1117, 269, 1117, 695, 269, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.128323592200467, "mean_inference_ms": 7.16344730605073, "mean_action_processing_ms": 0.49368067829328177, "mean_env_wait_ms": 21.17188124083952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02907538414001465, "StateBufferConnector_ms": 0.027039527893066406, "ViewRequirementAgentConnector_ms": 0.7563285827636719}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 266875, "num_agent_steps_trained": 266875, "num_env_steps_sampled": 266875, "num_env_steps_trained": 266875, "num_env_steps_sampled_this_iter": 11954, "num_env_steps_trained_this_iter": 11954, "num_env_steps_sampled_throughput_per_sec": 234.9558479048836, "num_env_steps_trained_throughput_per_sec": 234.9558479048836, "timesteps_total": 266875, "num_steps_trained_this_iter": 11954, "agent_timesteps_total": 266875, "timers": {"training_iteration_time_ms": 55007.333, "sample_time_ms": 36927.595, "load_time_ms": 2709.991, "load_throughput": 4472.671, "learn_time_ms": 14811.202, "learn_throughput": 818.36, "synch_weights_time_ms": 446.282}, "counters": {"num_env_steps_sampled": 266875, "num_env_steps_trained": 266875, "num_agent_steps_sampled": 266875, "num_agent_steps_trained": 266875}, "done": false, "episodes_total": 395, "training_iteration": 28, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-56-24", "timestamp": 1749300984, "time_this_iter_s": 50.896223306655884, "time_total_s": 1261.681265115738, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1261.681265115738, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 62.91475409836066, "ram_util_percent": 88.06065573770495, "gpu_util_percent0": 0.1427868852459017, "vram_util_percent0": 0.96240234375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.733125000000004e-05, "total_loss": -0.09906571494449798, "policy_loss": 0.00275659214662896, "vf_loss": 0.08170897006692196, "vf_explained_var": 0.9022175927053798, "kl": 0.01131383972110267, "entropy": 14.619668115269054, "entropy_coeff": 0.008665624999999998}, "model": {}, "num_grad_updates_lifetime": 9610.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 279346, "num_env_steps_trained": 279346, "num_agent_steps_sampled": 279346, "num_agent_steps_trained": 279346}, "sampler_results": {"episode_reward_max": 86.5025714097903, "episode_reward_min": -80.23072985704015, "episode_reward_mean": 15.852468369246331, "episode_len_mean": 914.88, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.431421148779734, 7.600194942553745, -21.402890525618478, 19.570732395675364, 6.5355152138619195, 44.38157256117581, 30.489877526884793, -4.155939411690001, 15.07228593122445, 28.288527933657615, 11.629486644052783, 5.900030038904047, 34.39917174846525, 63.209162391923044, 3.058351523848714, 10.623757355921848, 25.27679792871316, 36.784706675311725, 19.512872375793098, 32.51625968753979, -16.897524718351477, 14.01649212283626, 30.076389825089443, 13.127521949628125, -2.8332236298484808, 3.753505865911061, 2.7322716615622293, 13.034581786689108, 7.2968786485516155, -3.0845520231103984, 30.102267549281194, 46.43342781518858, 20.776641406208125, 1.2602841803291942, -2.4024494027762615, -3.290203425273517, 54.9162897370555, 18.696449987278, 20.658432227154215, -3.578119789088189, 28.8155024078462, -14.540203329220132, 15.690794605744124, 16.720619111827766, 23.051477229095617, 9.189403793906566, 21.906826235530513, -8.104883603692706, 13.166390008175977, 30.09958729661068, 22.348323708784147, 33.66658183279522, 24.17461708638964, 12.318205260541216, 26.702891805900936, -28.62941941448123, 3.7341184125350395, 0.14822950628460463, -20.935654507186268, 44.50164045349431, 29.564079404695573, 15.925882972348967, -3.421926062726666, -15.46966125240436, 3.7667721677284502, 14.856614713122974, -17.342928965463948, 24.26767766333396, 36.284990953382845, 12.565600425108684, -14.948470057553092, -10.588354967998292, 10.184953330919232, -7.898499998688467, 27.675318111231498, 31.826627930179445, 26.918966104546378, 21.77162488729421, 46.6181784519002, 12.304016821171102, 35.39789462196631, -80.23072985704015, 18.945673411782742, -2.545724319690629, 54.634073132580674, 18.63038265925059, 82.1931878244716, 19.69069217347798, 42.76259926184174, 39.72274810046837, 20.171958821576958, 3.058201233430988, 20.626558972774582, -0.6292908613334989, -7.9312703608232615, 18.220563044393117, 25.99023422302237, 12.221082640354064, 86.5025714097903, 39.41166439803453], "episode_lengths": [1117, 1117, 569, 295, 1059, 1117, 1117, 406, 295, 1117, 295, 1042, 1117, 1117, 1117, 295, 1117, 1117, 986, 1117, 633, 1117, 1117, 1117, 295, 1117, 1117, 1117, 944, 654, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1037, 1117, 1117, 1117, 889, 1117, 1117, 1117, 938, 1117, 1117, 295, 1117, 269, 1117, 1117, 295, 1117, 866, 982, 946, 761, 1117, 1117, 949, 954, 807, 402, 295, 795, 1117, 1117, 1117, 901, 1117, 269, 399, 1117, 1117, 1117, 1117, 1117, 269, 1117, 695, 269, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 416, 295, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1391551312924184, "mean_inference_ms": 7.186068720746004, "mean_action_processing_ms": 0.49494242110927106, "mean_env_wait_ms": 21.232287887846454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026060819625854492, "StateBufferConnector_ms": 0.028023242950439453, "ViewRequirementAgentConnector_ms": 0.7701315879821777}}, "episode_reward_max": 86.5025714097903, "episode_reward_min": -80.23072985704015, "episode_reward_mean": 15.852468369246331, "episode_len_mean": 914.88, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.431421148779734, 7.600194942553745, -21.402890525618478, 19.570732395675364, 6.5355152138619195, 44.38157256117581, 30.489877526884793, -4.155939411690001, 15.07228593122445, 28.288527933657615, 11.629486644052783, 5.900030038904047, 34.39917174846525, 63.209162391923044, 3.058351523848714, 10.623757355921848, 25.27679792871316, 36.784706675311725, 19.512872375793098, 32.51625968753979, -16.897524718351477, 14.01649212283626, 30.076389825089443, 13.127521949628125, -2.8332236298484808, 3.753505865911061, 2.7322716615622293, 13.034581786689108, 7.2968786485516155, -3.0845520231103984, 30.102267549281194, 46.43342781518858, 20.776641406208125, 1.2602841803291942, -2.4024494027762615, -3.290203425273517, 54.9162897370555, 18.696449987278, 20.658432227154215, -3.578119789088189, 28.8155024078462, -14.540203329220132, 15.690794605744124, 16.720619111827766, 23.051477229095617, 9.189403793906566, 21.906826235530513, -8.104883603692706, 13.166390008175977, 30.09958729661068, 22.348323708784147, 33.66658183279522, 24.17461708638964, 12.318205260541216, 26.702891805900936, -28.62941941448123, 3.7341184125350395, 0.14822950628460463, -20.935654507186268, 44.50164045349431, 29.564079404695573, 15.925882972348967, -3.421926062726666, -15.46966125240436, 3.7667721677284502, 14.856614713122974, -17.342928965463948, 24.26767766333396, 36.284990953382845, 12.565600425108684, -14.948470057553092, -10.588354967998292, 10.184953330919232, -7.898499998688467, 27.675318111231498, 31.826627930179445, 26.918966104546378, 21.77162488729421, 46.6181784519002, 12.304016821171102, 35.39789462196631, -80.23072985704015, 18.945673411782742, -2.545724319690629, 54.634073132580674, 18.63038265925059, 82.1931878244716, 19.69069217347798, 42.76259926184174, 39.72274810046837, 20.171958821576958, 3.058201233430988, 20.626558972774582, -0.6292908613334989, -7.9312703608232615, 18.220563044393117, 25.99023422302237, 12.221082640354064, 86.5025714097903, 39.41166439803453], "episode_lengths": [1117, 1117, 569, 295, 1059, 1117, 1117, 406, 295, 1117, 295, 1042, 1117, 1117, 1117, 295, 1117, 1117, 986, 1117, 633, 1117, 1117, 1117, 295, 1117, 1117, 1117, 944, 654, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1037, 1117, 1117, 1117, 889, 1117, 1117, 1117, 938, 1117, 1117, 295, 1117, 269, 1117, 1117, 295, 1117, 866, 982, 946, 761, 1117, 1117, 949, 954, 807, 402, 295, 795, 1117, 1117, 1117, 901, 1117, 269, 399, 1117, 1117, 1117, 1117, 1117, 269, 1117, 695, 269, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 416, 295, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1391551312924184, "mean_inference_ms": 7.186068720746004, "mean_action_processing_ms": 0.49494242110927106, "mean_env_wait_ms": 21.232287887846454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026060819625854492, "StateBufferConnector_ms": 0.028023242950439453, "ViewRequirementAgentConnector_ms": 0.7701315879821777}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279346, "num_agent_steps_trained": 279346, "num_env_steps_sampled": 279346, "num_env_steps_trained": 279346, "num_env_steps_sampled_this_iter": 12471, "num_env_steps_trained_this_iter": 12471, "num_env_steps_sampled_throughput_per_sec": 225.46303843715637, "num_env_steps_trained_throughput_per_sec": 225.46303843715637, "timesteps_total": 279346, "num_steps_trained_this_iter": 12471, "agent_timesteps_total": 279346, "timers": {"training_iteration_time_ms": 55842.47, "sample_time_ms": 37134.665, "load_time_ms": 2770.727, "load_throughput": 4471.606, "learn_time_ms": 15378.538, "learn_throughput": 805.642, "synch_weights_time_ms": 449.133}, "counters": {"num_env_steps_sampled": 279346, "num_env_steps_trained": 279346, "num_agent_steps_sampled": 279346, "num_agent_steps_trained": 279346}, "done": false, "episodes_total": 409, "training_iteration": 29, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-57-19", "timestamp": 1749301039, "time_this_iter_s": 55.33053278923035, "time_total_s": 1317.0117979049683, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1317.0117979049683, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 63.490769230769224, "ram_util_percent": 88.07384615384616, "gpu_util_percent0": 0.18430769230769228, "vram_util_percent0": 0.96240234375}}
{"evaluation": {"sampler_results": {"episode_reward_max": -5.53467353282184, "episode_reward_min": -7.176993992225324, "episode_reward_mean": -6.4211112445097, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.176993992225324, -6.894729504498895, -6.377159921279743, -5.53467353282184, -6.1219992717227], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6231462602294127, "mean_inference_ms": 3.7337972909719435, "mean_action_processing_ms": 0.2953166851139034, "mean_env_wait_ms": 12.258164565747133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08002758026123047}}, "episode_reward_max": -5.53467353282184, "episode_reward_min": -7.176993992225324, "episode_reward_mean": -6.4211112445097, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.176993992225324, -6.894729504498895, -6.377159921279743, -5.53467353282184, -6.1219992717227], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6231462602294127, "mean_inference_ms": 3.7337972909719435, "mean_action_processing_ms": 0.2953166851139034, "mean_env_wait_ms": 12.258164565747133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.08002758026123047}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.720654000000001e-05, "total_loss": -0.1215663077424324, "policy_loss": -0.016356669927760473, "vf_loss": 0.07103269484359771, "vf_explained_var": 0.9432773108283679, "kl": 0.01171204079302394, "entropy": 14.748514268795649, "entropy_coeff": 0.008603269999999998}, "model": {}, "num_grad_updates_lifetime": 10070.5, "diff_num_grad_updates_vs_sampler_policy": 239.5}}, "num_env_steps_sampled": 292884, "num_env_steps_trained": 292884, "num_agent_steps_sampled": 292884, "num_agent_steps_trained": 292884}, "sampler_results": {"episode_reward_max": 86.5025714097903, "episode_reward_min": -80.23072985704015, "episode_reward_mean": 15.939173848788428, "episode_len_mean": 932.46, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.058351523848714, 10.623757355921848, 25.27679792871316, 36.784706675311725, 19.512872375793098, 32.51625968753979, -16.897524718351477, 14.01649212283626, 30.076389825089443, 13.127521949628125, -2.8332236298484808, 3.753505865911061, 2.7322716615622293, 13.034581786689108, 7.2968786485516155, -3.0845520231103984, 30.102267549281194, 46.43342781518858, 20.776641406208125, 1.2602841803291942, -2.4024494027762615, -3.290203425273517, 54.9162897370555, 18.696449987278, 20.658432227154215, -3.578119789088189, 28.8155024078462, -14.540203329220132, 15.690794605744124, 16.720619111827766, 23.051477229095617, 9.189403793906566, 21.906826235530513, -8.104883603692706, 13.166390008175977, 30.09958729661068, 22.348323708784147, 33.66658183279522, 24.17461708638964, 12.318205260541216, 26.702891805900936, -28.62941941448123, 3.7341184125350395, 0.14822950628460463, -20.935654507186268, 44.50164045349431, 29.564079404695573, 15.925882972348967, -3.421926062726666, -15.46966125240436, 3.7667721677284502, 14.856614713122974, -17.342928965463948, 24.26767766333396, 36.284990953382845, 12.565600425108684, -14.948470057553092, -10.588354967998292, 10.184953330919232, -7.898499998688467, 27.675318111231498, 31.826627930179445, 26.918966104546378, 21.77162488729421, 46.6181784519002, 12.304016821171102, 35.39789462196631, -80.23072985704015, 18.945673411782742, -2.545724319690629, 54.634073132580674, 18.63038265925059, 82.1931878244716, 19.69069217347798, 42.76259926184174, 39.72274810046837, 20.171958821576958, 3.058201233430988, 20.626558972774582, -0.6292908613334989, -7.9312703608232615, 18.220563044393117, 25.99023422302237, 12.221082640354064, 86.5025714097903, 39.41166439803453, 11.205685694067158, 4.485665291355902, 16.75835572751334, 28.475907502224146, -1.102961638696812, 11.621677380823172, 24.106405290230796, 19.38359978523493, 23.747820330879755, 31.272267578602193, 45.471338909434245, 22.7600793151464, 9.135035300457343, 28.29882002678726], "episode_lengths": [1117, 295, 1117, 1117, 986, 1117, 633, 1117, 1117, 1117, 295, 1117, 1117, 1117, 944, 654, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1037, 1117, 1117, 1117, 889, 1117, 1117, 1117, 938, 1117, 1117, 295, 1117, 269, 1117, 1117, 295, 1117, 866, 982, 946, 761, 1117, 1117, 949, 954, 807, 402, 295, 795, 1117, 1117, 1117, 901, 1117, 269, 399, 1117, 1117, 1117, 1117, 1117, 269, 1117, 695, 269, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 416, 295, 1117, 295, 1117, 1117, 1117, 953, 1117, 1117, 419, 701, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1511199858826946, "mean_inference_ms": 7.208887270286125, "mean_action_processing_ms": 0.49623994962817847, "mean_env_wait_ms": 21.293894039048663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029363632202148438, "StateBufferConnector_ms": 0.027021408081054688, "ViewRequirementAgentConnector_ms": 0.7648506164550781}}, "episode_reward_max": 86.5025714097903, "episode_reward_min": -80.23072985704015, "episode_reward_mean": 15.939173848788428, "episode_len_mean": 932.46, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.058351523848714, 10.623757355921848, 25.27679792871316, 36.784706675311725, 19.512872375793098, 32.51625968753979, -16.897524718351477, 14.01649212283626, 30.076389825089443, 13.127521949628125, -2.8332236298484808, 3.753505865911061, 2.7322716615622293, 13.034581786689108, 7.2968786485516155, -3.0845520231103984, 30.102267549281194, 46.43342781518858, 20.776641406208125, 1.2602841803291942, -2.4024494027762615, -3.290203425273517, 54.9162897370555, 18.696449987278, 20.658432227154215, -3.578119789088189, 28.8155024078462, -14.540203329220132, 15.690794605744124, 16.720619111827766, 23.051477229095617, 9.189403793906566, 21.906826235530513, -8.104883603692706, 13.166390008175977, 30.09958729661068, 22.348323708784147, 33.66658183279522, 24.17461708638964, 12.318205260541216, 26.702891805900936, -28.62941941448123, 3.7341184125350395, 0.14822950628460463, -20.935654507186268, 44.50164045349431, 29.564079404695573, 15.925882972348967, -3.421926062726666, -15.46966125240436, 3.7667721677284502, 14.856614713122974, -17.342928965463948, 24.26767766333396, 36.284990953382845, 12.565600425108684, -14.948470057553092, -10.588354967998292, 10.184953330919232, -7.898499998688467, 27.675318111231498, 31.826627930179445, 26.918966104546378, 21.77162488729421, 46.6181784519002, 12.304016821171102, 35.39789462196631, -80.23072985704015, 18.945673411782742, -2.545724319690629, 54.634073132580674, 18.63038265925059, 82.1931878244716, 19.69069217347798, 42.76259926184174, 39.72274810046837, 20.171958821576958, 3.058201233430988, 20.626558972774582, -0.6292908613334989, -7.9312703608232615, 18.220563044393117, 25.99023422302237, 12.221082640354064, 86.5025714097903, 39.41166439803453, 11.205685694067158, 4.485665291355902, 16.75835572751334, 28.475907502224146, -1.102961638696812, 11.621677380823172, 24.106405290230796, 19.38359978523493, 23.747820330879755, 31.272267578602193, 45.471338909434245, 22.7600793151464, 9.135035300457343, 28.29882002678726], "episode_lengths": [1117, 295, 1117, 1117, 986, 1117, 633, 1117, 1117, 1117, 295, 1117, 1117, 1117, 944, 654, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1037, 1117, 1117, 1117, 889, 1117, 1117, 1117, 938, 1117, 1117, 295, 1117, 269, 1117, 1117, 295, 1117, 866, 982, 946, 761, 1117, 1117, 949, 954, 807, 402, 295, 795, 1117, 1117, 1117, 901, 1117, 269, 399, 1117, 1117, 1117, 1117, 1117, 269, 1117, 695, 269, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 416, 295, 1117, 295, 1117, 1117, 1117, 953, 1117, 1117, 419, 701, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1511199858826946, "mean_inference_ms": 7.208887270286125, "mean_action_processing_ms": 0.49623994962817847, "mean_env_wait_ms": 21.293894039048663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029363632202148438, "StateBufferConnector_ms": 0.027021408081054688, "ViewRequirementAgentConnector_ms": 0.7648506164550781}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292884, "num_agent_steps_trained": 292884, "num_env_steps_sampled": 292884, "num_env_steps_trained": 292884, "num_env_steps_sampled_this_iter": 13538, "num_env_steps_trained_this_iter": 13538, "num_env_steps_sampled_throughput_per_sec": 241.95236948876686, "num_env_steps_trained_throughput_per_sec": 241.95236948876686, "timesteps_total": 292884, "num_steps_trained_this_iter": 13538, "agent_timesteps_total": 292884, "timers": {"training_iteration_time_ms": 56111.803, "sample_time_ms": 37434.096, "load_time_ms": 2655.792, "load_throughput": 4739.943, "learn_time_ms": 15463.141, "learn_throughput": 814.084, "synch_weights_time_ms": 447.557}, "counters": {"num_env_steps_sampled": 292884, "num_env_steps_trained": 292884, "num_agent_steps_sampled": 292884, "num_agent_steps_trained": 292884}, "done": false, "episodes_total": 423, "training_iteration": 30, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-58-32", "timestamp": 1749301112, "time_this_iter_s": 73.22874188423157, "time_total_s": 1390.2405397891998, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1390.2405397891998, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 54.88636363636363, "ram_util_percent": 88.0715909090909, "gpu_util_percent0": 0.12045454545454543, "vram_util_percent0": 0.96240234375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.707116e-05, "total_loss": -0.1155295534970771, "policy_loss": -0.015806764476001264, "vf_loss": 0.08565580207588418, "vf_explained_var": 0.927294591665268, "kl": 0.009609926082278284, "entropy": 14.728916658673967, "entropy_coeff": 0.008535580000000001}, "model": {}, "num_grad_updates_lifetime": 10485.5, "diff_num_grad_updates_vs_sampler_policy": 174.5}}, "num_env_steps_sampled": 302848, "num_env_steps_trained": 302848, "num_agent_steps_sampled": 302848, "num_agent_steps_trained": 302848}, "sampler_results": {"episode_reward_max": 93.60064256138283, "episode_reward_min": -80.23072985704015, "episode_reward_mean": 16.24027472499628, "episode_len_mean": 898.31, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.2968786485516155, -3.0845520231103984, 30.102267549281194, 46.43342781518858, 20.776641406208125, 1.2602841803291942, -2.4024494027762615, -3.290203425273517, 54.9162897370555, 18.696449987278, 20.658432227154215, -3.578119789088189, 28.8155024078462, -14.540203329220132, 15.690794605744124, 16.720619111827766, 23.051477229095617, 9.189403793906566, 21.906826235530513, -8.104883603692706, 13.166390008175977, 30.09958729661068, 22.348323708784147, 33.66658183279522, 24.17461708638964, 12.318205260541216, 26.702891805900936, -28.62941941448123, 3.7341184125350395, 0.14822950628460463, -20.935654507186268, 44.50164045349431, 29.564079404695573, 15.925882972348967, -3.421926062726666, -15.46966125240436, 3.7667721677284502, 14.856614713122974, -17.342928965463948, 24.26767766333396, 36.284990953382845, 12.565600425108684, -14.948470057553092, -10.588354967998292, 10.184953330919232, -7.898499998688467, 27.675318111231498, 31.826627930179445, 26.918966104546378, 21.77162488729421, 46.6181784519002, 12.304016821171102, 35.39789462196631, -80.23072985704015, 18.945673411782742, -2.545724319690629, 54.634073132580674, 18.63038265925059, 82.1931878244716, 19.69069217347798, 42.76259926184174, 39.72274810046837, 20.171958821576958, 3.058201233430988, 20.626558972774582, -0.6292908613334989, -7.9312703608232615, 18.220563044393117, 25.99023422302237, 12.221082640354064, 86.5025714097903, 39.41166439803453, 11.205685694067158, 4.485665291355902, 16.75835572751334, 28.475907502224146, -1.102961638696812, 11.621677380823172, 24.106405290230796, 19.38359978523493, 23.747820330879755, 31.272267578602193, 45.471338909434245, 22.7600793151464, 9.135035300457343, 28.29882002678726, -52.09953622942177, -6.91263273186037, 11.158245104911233, 47.397420354129785, 0.3844112625882202, 18.1494424131602, 20.612826155316878, 93.60064256138283, 12.59793519646526, 25.959267917486425, -11.774910630851586, 6.269949002353386, 26.875537206991154, 22.67425044877813], "episode_lengths": [944, 654, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1037, 1117, 1117, 1117, 889, 1117, 1117, 1117, 938, 1117, 1117, 295, 1117, 269, 1117, 1117, 295, 1117, 866, 982, 946, 761, 1117, 1117, 949, 954, 807, 402, 295, 795, 1117, 1117, 1117, 901, 1117, 269, 399, 1117, 1117, 1117, 1117, 1117, 269, 1117, 695, 269, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 416, 295, 1117, 295, 1117, 1117, 1117, 953, 1117, 1117, 419, 701, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 661, 399, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 727, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1604756130600564, "mean_inference_ms": 7.226602377204268, "mean_action_processing_ms": 0.49732844615506666, "mean_env_wait_ms": 21.340150393386484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033899784088134766, "StateBufferConnector_ms": 0.0220181941986084, "ViewRequirementAgentConnector_ms": 0.7598817348480225}}, "episode_reward_max": 93.60064256138283, "episode_reward_min": -80.23072985704015, "episode_reward_mean": 16.24027472499628, "episode_len_mean": 898.31, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.2968786485516155, -3.0845520231103984, 30.102267549281194, 46.43342781518858, 20.776641406208125, 1.2602841803291942, -2.4024494027762615, -3.290203425273517, 54.9162897370555, 18.696449987278, 20.658432227154215, -3.578119789088189, 28.8155024078462, -14.540203329220132, 15.690794605744124, 16.720619111827766, 23.051477229095617, 9.189403793906566, 21.906826235530513, -8.104883603692706, 13.166390008175977, 30.09958729661068, 22.348323708784147, 33.66658183279522, 24.17461708638964, 12.318205260541216, 26.702891805900936, -28.62941941448123, 3.7341184125350395, 0.14822950628460463, -20.935654507186268, 44.50164045349431, 29.564079404695573, 15.925882972348967, -3.421926062726666, -15.46966125240436, 3.7667721677284502, 14.856614713122974, -17.342928965463948, 24.26767766333396, 36.284990953382845, 12.565600425108684, -14.948470057553092, -10.588354967998292, 10.184953330919232, -7.898499998688467, 27.675318111231498, 31.826627930179445, 26.918966104546378, 21.77162488729421, 46.6181784519002, 12.304016821171102, 35.39789462196631, -80.23072985704015, 18.945673411782742, -2.545724319690629, 54.634073132580674, 18.63038265925059, 82.1931878244716, 19.69069217347798, 42.76259926184174, 39.72274810046837, 20.171958821576958, 3.058201233430988, 20.626558972774582, -0.6292908613334989, -7.9312703608232615, 18.220563044393117, 25.99023422302237, 12.221082640354064, 86.5025714097903, 39.41166439803453, 11.205685694067158, 4.485665291355902, 16.75835572751334, 28.475907502224146, -1.102961638696812, 11.621677380823172, 24.106405290230796, 19.38359978523493, 23.747820330879755, 31.272267578602193, 45.471338909434245, 22.7600793151464, 9.135035300457343, 28.29882002678726, -52.09953622942177, -6.91263273186037, 11.158245104911233, 47.397420354129785, 0.3844112625882202, 18.1494424131602, 20.612826155316878, 93.60064256138283, 12.59793519646526, 25.959267917486425, -11.774910630851586, 6.269949002353386, 26.875537206991154, 22.67425044877813], "episode_lengths": [944, 654, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1037, 1117, 1117, 1117, 889, 1117, 1117, 1117, 938, 1117, 1117, 295, 1117, 269, 1117, 1117, 295, 1117, 866, 982, 946, 761, 1117, 1117, 949, 954, 807, 402, 295, 795, 1117, 1117, 1117, 901, 1117, 269, 399, 1117, 1117, 1117, 1117, 1117, 269, 1117, 695, 269, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 416, 295, 1117, 295, 1117, 1117, 1117, 953, 1117, 1117, 419, 701, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 661, 399, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 727, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1604756130600564, "mean_inference_ms": 7.226602377204268, "mean_action_processing_ms": 0.49732844615506666, "mean_env_wait_ms": 21.340150393386484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033899784088134766, "StateBufferConnector_ms": 0.0220181941986084, "ViewRequirementAgentConnector_ms": 0.7598817348480225}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 302848, "num_agent_steps_trained": 302848, "num_env_steps_sampled": 302848, "num_env_steps_trained": 302848, "num_env_steps_sampled_this_iter": 9964, "num_env_steps_trained_this_iter": 9964, "num_env_steps_sampled_throughput_per_sec": 206.72522072427006, "num_env_steps_trained_throughput_per_sec": 206.72522072427006, "timesteps_total": 302848, "num_steps_trained_this_iter": 9964, "agent_timesteps_total": 302848, "timers": {"training_iteration_time_ms": 55764.009, "sample_time_ms": 37284.449, "load_time_ms": 2627.672, "load_throughput": 4798.811, "learn_time_ms": 15297.817, "learn_throughput": 824.281, "synch_weights_time_ms": 441.776}, "counters": {"num_env_steps_sampled": 302848, "num_env_steps_trained": 302848, "num_agent_steps_sampled": 302848, "num_agent_steps_trained": 302848}, "done": false, "episodes_total": 437, "training_iteration": 31, "trial_id": "b7a4b_00000", "date": "2025-06-07_14-59-21", "timestamp": 1749301161, "time_this_iter_s": 48.21492671966553, "time_total_s": 1438.4554665088654, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1438.4554665088654, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 55.718965517241365, "ram_util_percent": 87.93103448275862, "gpu_util_percent0": 0.15793103448275864, "vram_util_percent0": 0.96240234375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.697152000000003e-05, "total_loss": -0.11513471040889271, "policy_loss": -0.014102396958994425, "vf_loss": 0.08001179439439014, "vf_explained_var": 0.9052064929496159, "kl": 0.01075359673536282, "entropy": 14.774388213591141, "entropy_coeff": 0.008485759999999998}, "model": {}, "num_grad_updates_lifetime": 10880.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 315198, "num_env_steps_trained": 315198, "num_agent_steps_sampled": 315198, "num_agent_steps_trained": 315198}, "sampler_results": {"episode_reward_max": 93.60064256138283, "episode_reward_min": -80.23072985704015, "episode_reward_mean": 16.942906612161977, "episode_len_mean": 874.87, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.690794605744124, 16.720619111827766, 23.051477229095617, 9.189403793906566, 21.906826235530513, -8.104883603692706, 13.166390008175977, 30.09958729661068, 22.348323708784147, 33.66658183279522, 24.17461708638964, 12.318205260541216, 26.702891805900936, -28.62941941448123, 3.7341184125350395, 0.14822950628460463, -20.935654507186268, 44.50164045349431, 29.564079404695573, 15.925882972348967, -3.421926062726666, -15.46966125240436, 3.7667721677284502, 14.856614713122974, -17.342928965463948, 24.26767766333396, 36.284990953382845, 12.565600425108684, -14.948470057553092, -10.588354967998292, 10.184953330919232, -7.898499998688467, 27.675318111231498, 31.826627930179445, 26.918966104546378, 21.77162488729421, 46.6181784519002, 12.304016821171102, 35.39789462196631, -80.23072985704015, 18.945673411782742, -2.545724319690629, 54.634073132580674, 18.63038265925059, 82.1931878244716, 19.69069217347798, 42.76259926184174, 39.72274810046837, 20.171958821576958, 3.058201233430988, 20.626558972774582, -0.6292908613334989, -7.9312703608232615, 18.220563044393117, 25.99023422302237, 12.221082640354064, 86.5025714097903, 39.41166439803453, 11.205685694067158, 4.485665291355902, 16.75835572751334, 28.475907502224146, -1.102961638696812, 11.621677380823172, 24.106405290230796, 19.38359978523493, 23.747820330879755, 31.272267578602193, 45.471338909434245, 22.7600793151464, 9.135035300457343, 28.29882002678726, -52.09953622942177, -6.91263273186037, 11.158245104911233, 47.397420354129785, 0.3844112625882202, 18.1494424131602, 20.612826155316878, 93.60064256138283, 12.59793519646526, 25.959267917486425, -11.774910630851586, 6.269949002353386, 26.875537206991154, 22.67425044877813, 14.855578045810311, 9.874048088475668, 2.4798573577335, 35.2334426026977, 24.15277768475375, 35.702692651849866, 27.53229347669146, 17.21662617120222, 21.059176259713684, 11.428405070603041, 31.616888780823682, 19.207362598281776, 17.289229726032385, 4.675456191324572], "episode_lengths": [1117, 1117, 1117, 938, 1117, 1117, 295, 1117, 269, 1117, 1117, 295, 1117, 866, 982, 946, 761, 1117, 1117, 949, 954, 807, 402, 295, 795, 1117, 1117, 1117, 901, 1117, 269, 399, 1117, 1117, 1117, 1117, 1117, 269, 1117, 695, 269, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 416, 295, 1117, 295, 1117, 1117, 1117, 953, 1117, 1117, 419, 701, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 661, 399, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 727, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1659337098541562, "mean_inference_ms": 7.233677858545024, "mean_action_processing_ms": 0.49770873676803334, "mean_env_wait_ms": 21.361716968102815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03086376190185547, "StateBufferConnector_ms": 0.021045923233032227, "ViewRequirementAgentConnector_ms": 0.7670671939849854}}, "episode_reward_max": 93.60064256138283, "episode_reward_min": -80.23072985704015, "episode_reward_mean": 16.942906612161977, "episode_len_mean": 874.87, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.690794605744124, 16.720619111827766, 23.051477229095617, 9.189403793906566, 21.906826235530513, -8.104883603692706, 13.166390008175977, 30.09958729661068, 22.348323708784147, 33.66658183279522, 24.17461708638964, 12.318205260541216, 26.702891805900936, -28.62941941448123, 3.7341184125350395, 0.14822950628460463, -20.935654507186268, 44.50164045349431, 29.564079404695573, 15.925882972348967, -3.421926062726666, -15.46966125240436, 3.7667721677284502, 14.856614713122974, -17.342928965463948, 24.26767766333396, 36.284990953382845, 12.565600425108684, -14.948470057553092, -10.588354967998292, 10.184953330919232, -7.898499998688467, 27.675318111231498, 31.826627930179445, 26.918966104546378, 21.77162488729421, 46.6181784519002, 12.304016821171102, 35.39789462196631, -80.23072985704015, 18.945673411782742, -2.545724319690629, 54.634073132580674, 18.63038265925059, 82.1931878244716, 19.69069217347798, 42.76259926184174, 39.72274810046837, 20.171958821576958, 3.058201233430988, 20.626558972774582, -0.6292908613334989, -7.9312703608232615, 18.220563044393117, 25.99023422302237, 12.221082640354064, 86.5025714097903, 39.41166439803453, 11.205685694067158, 4.485665291355902, 16.75835572751334, 28.475907502224146, -1.102961638696812, 11.621677380823172, 24.106405290230796, 19.38359978523493, 23.747820330879755, 31.272267578602193, 45.471338909434245, 22.7600793151464, 9.135035300457343, 28.29882002678726, -52.09953622942177, -6.91263273186037, 11.158245104911233, 47.397420354129785, 0.3844112625882202, 18.1494424131602, 20.612826155316878, 93.60064256138283, 12.59793519646526, 25.959267917486425, -11.774910630851586, 6.269949002353386, 26.875537206991154, 22.67425044877813, 14.855578045810311, 9.874048088475668, 2.4798573577335, 35.2334426026977, 24.15277768475375, 35.702692651849866, 27.53229347669146, 17.21662617120222, 21.059176259713684, 11.428405070603041, 31.616888780823682, 19.207362598281776, 17.289229726032385, 4.675456191324572], "episode_lengths": [1117, 1117, 1117, 938, 1117, 1117, 295, 1117, 269, 1117, 1117, 295, 1117, 866, 982, 946, 761, 1117, 1117, 949, 954, 807, 402, 295, 795, 1117, 1117, 1117, 901, 1117, 269, 399, 1117, 1117, 1117, 1117, 1117, 269, 1117, 695, 269, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 416, 295, 1117, 295, 1117, 1117, 1117, 953, 1117, 1117, 419, 701, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 661, 399, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 727, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1659337098541562, "mean_inference_ms": 7.233677858545024, "mean_action_processing_ms": 0.49770873676803334, "mean_env_wait_ms": 21.361716968102815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03086376190185547, "StateBufferConnector_ms": 0.021045923233032227, "ViewRequirementAgentConnector_ms": 0.7670671939849854}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 315198, "num_agent_steps_trained": 315198, "num_env_steps_sampled": 315198, "num_env_steps_trained": 315198, "num_env_steps_sampled_this_iter": 12350, "num_env_steps_trained_this_iter": 12350, "num_env_steps_sampled_throughput_per_sec": 232.36632589334457, "num_env_steps_trained_throughput_per_sec": 232.36632589334457, "timesteps_total": 315198, "num_steps_trained_this_iter": 12350, "agent_timesteps_total": 315198, "timers": {"training_iteration_time_ms": 54902.748, "sample_time_ms": 36910.97, "load_time_ms": 2407.632, "load_throughput": 5196.226, "learn_time_ms": 15042.075, "learn_throughput": 831.707, "synch_weights_time_ms": 439.183}, "counters": {"num_env_steps_sampled": 315198, "num_env_steps_trained": 315198, "num_agent_steps_sampled": 315198, "num_agent_steps_trained": 315198}, "done": false, "episodes_total": 451, "training_iteration": 32, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-00-14", "timestamp": 1749301214, "time_this_iter_s": 53.1708402633667, "time_total_s": 1491.626306772232, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1491.626306772232, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 64.23174603174604, "ram_util_percent": 86.86349206349206, "gpu_util_percent0": 0.15698412698412703, "vram_util_percent0": 0.96240234375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.684802e-05, "total_loss": -0.10261746889744432, "policy_loss": -0.000736842312826178, "vf_loss": 0.07681239946530416, "vf_explained_var": 0.9069046245171474, "kl": 0.011046231176162904, "entropy": 14.870536095056778, "entropy_coeff": 0.008424010000000001}, "model": {}, "num_grad_updates_lifetime": 11295.5, "diff_num_grad_updates_vs_sampler_policy": 194.5}}, "num_env_steps_sampled": 326372, "num_env_steps_trained": 326372, "num_agent_steps_sampled": 326372, "num_agent_steps_trained": 326372}, "sampler_results": {"episode_reward_max": 93.60064256138283, "episode_reward_min": -80.23072985704015, "episode_reward_mean": 17.545420610636082, "episode_len_mean": 859.45, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.7341184125350395, 0.14822950628460463, -20.935654507186268, 44.50164045349431, 29.564079404695573, 15.925882972348967, -3.421926062726666, -15.46966125240436, 3.7667721677284502, 14.856614713122974, -17.342928965463948, 24.26767766333396, 36.284990953382845, 12.565600425108684, -14.948470057553092, -10.588354967998292, 10.184953330919232, -7.898499998688467, 27.675318111231498, 31.826627930179445, 26.918966104546378, 21.77162488729421, 46.6181784519002, 12.304016821171102, 35.39789462196631, -80.23072985704015, 18.945673411782742, -2.545724319690629, 54.634073132580674, 18.63038265925059, 82.1931878244716, 19.69069217347798, 42.76259926184174, 39.72274810046837, 20.171958821576958, 3.058201233430988, 20.626558972774582, -0.6292908613334989, -7.9312703608232615, 18.220563044393117, 25.99023422302237, 12.221082640354064, 86.5025714097903, 39.41166439803453, 11.205685694067158, 4.485665291355902, 16.75835572751334, 28.475907502224146, -1.102961638696812, 11.621677380823172, 24.106405290230796, 19.38359978523493, 23.747820330879755, 31.272267578602193, 45.471338909434245, 22.7600793151464, 9.135035300457343, 28.29882002678726, -52.09953622942177, -6.91263273186037, 11.158245104911233, 47.397420354129785, 0.3844112625882202, 18.1494424131602, 20.612826155316878, 93.60064256138283, 12.59793519646526, 25.959267917486425, -11.774910630851586, 6.269949002353386, 26.875537206991154, 22.67425044877813, 14.855578045810311, 9.874048088475668, 2.4798573577335, 35.2334426026977, 24.15277768475375, 35.702692651849866, 27.53229347669146, 17.21662617120222, 21.059176259713684, 11.428405070603041, 31.616888780823682, 19.207362598281776, 17.289229726032385, 4.675456191324572, 7.97428424406197, 12.97779320936535, 14.191251908486928, 27.139086324966645, 18.869970720457793, 36.9393048130557, 30.54108035052758, 7.094986676524042, 8.276496125443199, 20.863514484101866, 11.39895130035688, 7.516258739736108, 16.869686610606593, 51.90014929684885], "episode_lengths": [982, 946, 761, 1117, 1117, 949, 954, 807, 402, 295, 795, 1117, 1117, 1117, 901, 1117, 269, 399, 1117, 1117, 1117, 1117, 1117, 269, 1117, 695, 269, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 416, 295, 1117, 295, 1117, 1117, 1117, 953, 1117, 1117, 419, 701, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 661, 399, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 727, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 763, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.170647861553307, "mean_inference_ms": 7.236765702651058, "mean_action_processing_ms": 0.49780095480394393, "mean_env_wait_ms": 21.37297687636652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02984619140625, "StateBufferConnector_ms": 0.01807117462158203, "ViewRequirementAgentConnector_ms": 0.7613425254821777}}, "episode_reward_max": 93.60064256138283, "episode_reward_min": -80.23072985704015, "episode_reward_mean": 17.545420610636082, "episode_len_mean": 859.45, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.7341184125350395, 0.14822950628460463, -20.935654507186268, 44.50164045349431, 29.564079404695573, 15.925882972348967, -3.421926062726666, -15.46966125240436, 3.7667721677284502, 14.856614713122974, -17.342928965463948, 24.26767766333396, 36.284990953382845, 12.565600425108684, -14.948470057553092, -10.588354967998292, 10.184953330919232, -7.898499998688467, 27.675318111231498, 31.826627930179445, 26.918966104546378, 21.77162488729421, 46.6181784519002, 12.304016821171102, 35.39789462196631, -80.23072985704015, 18.945673411782742, -2.545724319690629, 54.634073132580674, 18.63038265925059, 82.1931878244716, 19.69069217347798, 42.76259926184174, 39.72274810046837, 20.171958821576958, 3.058201233430988, 20.626558972774582, -0.6292908613334989, -7.9312703608232615, 18.220563044393117, 25.99023422302237, 12.221082640354064, 86.5025714097903, 39.41166439803453, 11.205685694067158, 4.485665291355902, 16.75835572751334, 28.475907502224146, -1.102961638696812, 11.621677380823172, 24.106405290230796, 19.38359978523493, 23.747820330879755, 31.272267578602193, 45.471338909434245, 22.7600793151464, 9.135035300457343, 28.29882002678726, -52.09953622942177, -6.91263273186037, 11.158245104911233, 47.397420354129785, 0.3844112625882202, 18.1494424131602, 20.612826155316878, 93.60064256138283, 12.59793519646526, 25.959267917486425, -11.774910630851586, 6.269949002353386, 26.875537206991154, 22.67425044877813, 14.855578045810311, 9.874048088475668, 2.4798573577335, 35.2334426026977, 24.15277768475375, 35.702692651849866, 27.53229347669146, 17.21662617120222, 21.059176259713684, 11.428405070603041, 31.616888780823682, 19.207362598281776, 17.289229726032385, 4.675456191324572, 7.97428424406197, 12.97779320936535, 14.191251908486928, 27.139086324966645, 18.869970720457793, 36.9393048130557, 30.54108035052758, 7.094986676524042, 8.276496125443199, 20.863514484101866, 11.39895130035688, 7.516258739736108, 16.869686610606593, 51.90014929684885], "episode_lengths": [982, 946, 761, 1117, 1117, 949, 954, 807, 402, 295, 795, 1117, 1117, 1117, 901, 1117, 269, 399, 1117, 1117, 1117, 1117, 1117, 269, 1117, 695, 269, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 416, 295, 1117, 295, 1117, 1117, 1117, 953, 1117, 1117, 419, 701, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 661, 399, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 727, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 763, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.170647861553307, "mean_inference_ms": 7.236765702651058, "mean_action_processing_ms": 0.49780095480394393, "mean_env_wait_ms": 21.37297687636652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02984619140625, "StateBufferConnector_ms": 0.01807117462158203, "ViewRequirementAgentConnector_ms": 0.7613425254821777}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 326372, "num_agent_steps_trained": 326372, "num_env_steps_sampled": 326372, "num_env_steps_trained": 326372, "num_env_steps_sampled_this_iter": 11174, "num_env_steps_trained_this_iter": 11174, "num_env_steps_sampled_throughput_per_sec": 221.46182118773385, "num_env_steps_trained_throughput_per_sec": 221.46182118773385, "timesteps_total": 326372, "num_steps_trained_this_iter": 11174, "agent_timesteps_total": 326372, "timers": {"training_iteration_time_ms": 54860.015, "sample_time_ms": 36884.901, "load_time_ms": 2403.725, "load_throughput": 5213.657, "learn_time_ms": 15026.905, "learn_throughput": 833.984, "synch_weights_time_ms": 440.003}, "counters": {"num_env_steps_sampled": 326372, "num_env_steps_trained": 326372, "num_agent_steps_sampled": 326372, "num_agent_steps_trained": 326372}, "done": false, "episodes_total": 465, "training_iteration": 33, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-01-05", "timestamp": 1749301265, "time_this_iter_s": 50.46781086921692, "time_total_s": 1542.094117641449, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1542.094117641449, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 58.98852459016394, "ram_util_percent": 85.54754098360657, "gpu_util_percent0": 0.17721311475409832, "vram_util_percent0": 0.96240234375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.673628e-05, "total_loss": -0.10267116073242505, "policy_loss": -0.0006160612349049189, "vf_loss": 0.07586273572407663, "vf_explained_var": 0.9242050124704838, "kl": 0.011554721192260331, "entropy": 14.958522038459778, "entropy_coeff": 0.008368139999999998}, "model": {}, "num_grad_updates_lifetime": 11690.5, "diff_num_grad_updates_vs_sampler_policy": 199.5}}, "num_env_steps_sampled": 337788, "num_env_steps_trained": 337788, "num_agent_steps_sampled": 337788, "num_agent_steps_trained": 337788}, "sampler_results": {"episode_reward_max": 93.60064256138283, "episode_reward_min": -80.23072985704015, "episode_reward_mean": 18.894760040974408, "episode_len_mean": 848.85, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.948470057553092, -10.588354967998292, 10.184953330919232, -7.898499998688467, 27.675318111231498, 31.826627930179445, 26.918966104546378, 21.77162488729421, 46.6181784519002, 12.304016821171102, 35.39789462196631, -80.23072985704015, 18.945673411782742, -2.545724319690629, 54.634073132580674, 18.63038265925059, 82.1931878244716, 19.69069217347798, 42.76259926184174, 39.72274810046837, 20.171958821576958, 3.058201233430988, 20.626558972774582, -0.6292908613334989, -7.9312703608232615, 18.220563044393117, 25.99023422302237, 12.221082640354064, 86.5025714097903, 39.41166439803453, 11.205685694067158, 4.485665291355902, 16.75835572751334, 28.475907502224146, -1.102961638696812, 11.621677380823172, 24.106405290230796, 19.38359978523493, 23.747820330879755, 31.272267578602193, 45.471338909434245, 22.7600793151464, 9.135035300457343, 28.29882002678726, -52.09953622942177, -6.91263273186037, 11.158245104911233, 47.397420354129785, 0.3844112625882202, 18.1494424131602, 20.612826155316878, 93.60064256138283, 12.59793519646526, 25.959267917486425, -11.774910630851586, 6.269949002353386, 26.875537206991154, 22.67425044877813, 14.855578045810311, 9.874048088475668, 2.4798573577335, 35.2334426026977, 24.15277768475375, 35.702692651849866, 27.53229347669146, 17.21662617120222, 21.059176259713684, 11.428405070603041, 31.616888780823682, 19.207362598281776, 17.289229726032385, 4.675456191324572, 7.97428424406197, 12.97779320936535, 14.191251908486928, 27.139086324966645, 18.869970720457793, 36.9393048130557, 30.54108035052758, 7.094986676524042, 8.276496125443199, 20.863514484101866, 11.39895130035688, 7.516258739736108, 16.869686610606593, 51.90014929684885, 47.132873588085324, 16.923017770606332, -20.456658649935786, 31.58514100189294, 16.520956354416153, 23.478210114141664, 19.646466157650057, -6.405424689398033, 23.984914682441453, 19.943662806648923, 18.693437886107702, 30.562554771939208, 18.12335339796805, 23.646873725522678], "episode_lengths": [901, 1117, 269, 399, 1117, 1117, 1117, 1117, 1117, 269, 1117, 695, 269, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 416, 295, 1117, 295, 1117, 1117, 1117, 953, 1117, 1117, 419, 701, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 661, 399, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 727, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 763, 295, 1117, 1117, 295, 537, 1117, 295, 1117, 295, 763, 1117, 1117, 1117, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1761692546321147, "mean_inference_ms": 7.2367254087958335, "mean_action_processing_ms": 0.4977543433179902, "mean_env_wait_ms": 21.376740786452594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024828195571899414, "StateBufferConnector_ms": 0.017077207565307617, "ViewRequirementAgentConnector_ms": 0.7618110179901123}}, "episode_reward_max": 93.60064256138283, "episode_reward_min": -80.23072985704015, "episode_reward_mean": 18.894760040974408, "episode_len_mean": 848.85, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-14.948470057553092, -10.588354967998292, 10.184953330919232, -7.898499998688467, 27.675318111231498, 31.826627930179445, 26.918966104546378, 21.77162488729421, 46.6181784519002, 12.304016821171102, 35.39789462196631, -80.23072985704015, 18.945673411782742, -2.545724319690629, 54.634073132580674, 18.63038265925059, 82.1931878244716, 19.69069217347798, 42.76259926184174, 39.72274810046837, 20.171958821576958, 3.058201233430988, 20.626558972774582, -0.6292908613334989, -7.9312703608232615, 18.220563044393117, 25.99023422302237, 12.221082640354064, 86.5025714097903, 39.41166439803453, 11.205685694067158, 4.485665291355902, 16.75835572751334, 28.475907502224146, -1.102961638696812, 11.621677380823172, 24.106405290230796, 19.38359978523493, 23.747820330879755, 31.272267578602193, 45.471338909434245, 22.7600793151464, 9.135035300457343, 28.29882002678726, -52.09953622942177, -6.91263273186037, 11.158245104911233, 47.397420354129785, 0.3844112625882202, 18.1494424131602, 20.612826155316878, 93.60064256138283, 12.59793519646526, 25.959267917486425, -11.774910630851586, 6.269949002353386, 26.875537206991154, 22.67425044877813, 14.855578045810311, 9.874048088475668, 2.4798573577335, 35.2334426026977, 24.15277768475375, 35.702692651849866, 27.53229347669146, 17.21662617120222, 21.059176259713684, 11.428405070603041, 31.616888780823682, 19.207362598281776, 17.289229726032385, 4.675456191324572, 7.97428424406197, 12.97779320936535, 14.191251908486928, 27.139086324966645, 18.869970720457793, 36.9393048130557, 30.54108035052758, 7.094986676524042, 8.276496125443199, 20.863514484101866, 11.39895130035688, 7.516258739736108, 16.869686610606593, 51.90014929684885, 47.132873588085324, 16.923017770606332, -20.456658649935786, 31.58514100189294, 16.520956354416153, 23.478210114141664, 19.646466157650057, -6.405424689398033, 23.984914682441453, 19.943662806648923, 18.693437886107702, 30.562554771939208, 18.12335339796805, 23.646873725522678], "episode_lengths": [901, 1117, 269, 399, 1117, 1117, 1117, 1117, 1117, 269, 1117, 695, 269, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 416, 295, 1117, 295, 1117, 1117, 1117, 953, 1117, 1117, 419, 701, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 661, 399, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 727, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 763, 295, 1117, 1117, 295, 537, 1117, 295, 1117, 295, 763, 1117, 1117, 1117, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1761692546321147, "mean_inference_ms": 7.2367254087958335, "mean_action_processing_ms": 0.4977543433179902, "mean_env_wait_ms": 21.376740786452594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024828195571899414, "StateBufferConnector_ms": 0.017077207565307617, "ViewRequirementAgentConnector_ms": 0.7618110179901123}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 337788, "num_agent_steps_trained": 337788, "num_env_steps_sampled": 337788, "num_env_steps_trained": 337788, "num_env_steps_sampled_this_iter": 11416, "num_env_steps_trained_this_iter": 11416, "num_env_steps_sampled_throughput_per_sec": 227.99684957708624, "num_env_steps_trained_throughput_per_sec": 227.99684957708624, "timesteps_total": 337788, "num_steps_trained_this_iter": 11416, "agent_timesteps_total": 337788, "timers": {"training_iteration_time_ms": 53839.05, "sample_time_ms": 36594.434, "load_time_ms": 2092.844, "load_throughput": 5885.438, "learn_time_ms": 14608.458, "learn_throughput": 843.162, "synch_weights_time_ms": 443.087}, "counters": {"num_env_steps_sampled": 337788, "num_env_steps_trained": 337788, "num_agent_steps_sampled": 337788, "num_agent_steps_trained": 337788}, "done": false, "episodes_total": 479, "training_iteration": 34, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-01-55", "timestamp": 1749301315, "time_this_iter_s": 50.08686542510986, "time_total_s": 1592.1809830665588, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1592.1809830665588, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 62.86610169491525, "ram_util_percent": 85.62203389830506, "gpu_util_percent0": 0.13898305084745763, "vram_util_percent0": 0.96240234375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.662212000000002e-05, "total_loss": -0.11728866606901743, "policy_loss": -0.01996952986442729, "vf_loss": 0.08813856043117611, "vf_explained_var": 0.9110080780167329, "kl": 0.011532132783874728, "entropy": 14.934446789089002, "entropy_coeff": 0.008311059999999999}, "model": {}, "num_grad_updates_lifetime": 12080.5, "diff_num_grad_updates_vs_sampler_policy": 189.5}}, "num_env_steps_sampled": 348629, "num_env_steps_trained": 348629, "num_agent_steps_sampled": 348629, "num_agent_steps_trained": 348629}, "sampler_results": {"episode_reward_max": 122.92519759403454, "episode_reward_min": -52.09953622942177, "episode_reward_mean": 21.031859702219343, "episode_len_mean": 839.88, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.634073132580674, 18.63038265925059, 82.1931878244716, 19.69069217347798, 42.76259926184174, 39.72274810046837, 20.171958821576958, 3.058201233430988, 20.626558972774582, -0.6292908613334989, -7.9312703608232615, 18.220563044393117, 25.99023422302237, 12.221082640354064, 86.5025714097903, 39.41166439803453, 11.205685694067158, 4.485665291355902, 16.75835572751334, 28.475907502224146, -1.102961638696812, 11.621677380823172, 24.106405290230796, 19.38359978523493, 23.747820330879755, 31.272267578602193, 45.471338909434245, 22.7600793151464, 9.135035300457343, 28.29882002678726, -52.09953622942177, -6.91263273186037, 11.158245104911233, 47.397420354129785, 0.3844112625882202, 18.1494424131602, 20.612826155316878, 93.60064256138283, 12.59793519646526, 25.959267917486425, -11.774910630851586, 6.269949002353386, 26.875537206991154, 22.67425044877813, 14.855578045810311, 9.874048088475668, 2.4798573577335, 35.2334426026977, 24.15277768475375, 35.702692651849866, 27.53229347669146, 17.21662617120222, 21.059176259713684, 11.428405070603041, 31.616888780823682, 19.207362598281776, 17.289229726032385, 4.675456191324572, 7.97428424406197, 12.97779320936535, 14.191251908486928, 27.139086324966645, 18.869970720457793, 36.9393048130557, 30.54108035052758, 7.094986676524042, 8.276496125443199, 20.863514484101866, 11.39895130035688, 7.516258739736108, 16.869686610606593, 51.90014929684885, 47.132873588085324, 16.923017770606332, -20.456658649935786, 31.58514100189294, 16.520956354416153, 23.478210114141664, 19.646466157650057, -6.405424689398033, 23.984914682441453, 19.943662806648923, 18.693437886107702, 30.562554771939208, 18.12335339796805, 23.646873725522678, 11.269504752321382, 25.0315348700762, 7.592991549940216, -27.056871927842465, -11.689021493662969, 16.18658242438214, 122.92519759403454, 45.184771452136516, 11.188286175975112, 19.37067245642849, 53.23634856082607, 9.80910222538957, 15.394794200691962, 30.697547753816657], "episode_lengths": [1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 416, 295, 1117, 295, 1117, 1117, 1117, 953, 1117, 1117, 419, 701, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 661, 399, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 727, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 763, 295, 1117, 1117, 295, 537, 1117, 295, 1117, 295, 763, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 763, 784, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1811085699837096, "mean_inference_ms": 7.236262347390915, "mean_action_processing_ms": 0.497782116351835, "mean_env_wait_ms": 21.380833335175147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020864248275756836, "StateBufferConnector_ms": 0.01806020736694336, "ViewRequirementAgentConnector_ms": 0.7650954723358154}}, "episode_reward_max": 122.92519759403454, "episode_reward_min": -52.09953622942177, "episode_reward_mean": 21.031859702219343, "episode_len_mean": 839.88, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.634073132580674, 18.63038265925059, 82.1931878244716, 19.69069217347798, 42.76259926184174, 39.72274810046837, 20.171958821576958, 3.058201233430988, 20.626558972774582, -0.6292908613334989, -7.9312703608232615, 18.220563044393117, 25.99023422302237, 12.221082640354064, 86.5025714097903, 39.41166439803453, 11.205685694067158, 4.485665291355902, 16.75835572751334, 28.475907502224146, -1.102961638696812, 11.621677380823172, 24.106405290230796, 19.38359978523493, 23.747820330879755, 31.272267578602193, 45.471338909434245, 22.7600793151464, 9.135035300457343, 28.29882002678726, -52.09953622942177, -6.91263273186037, 11.158245104911233, 47.397420354129785, 0.3844112625882202, 18.1494424131602, 20.612826155316878, 93.60064256138283, 12.59793519646526, 25.959267917486425, -11.774910630851586, 6.269949002353386, 26.875537206991154, 22.67425044877813, 14.855578045810311, 9.874048088475668, 2.4798573577335, 35.2334426026977, 24.15277768475375, 35.702692651849866, 27.53229347669146, 17.21662617120222, 21.059176259713684, 11.428405070603041, 31.616888780823682, 19.207362598281776, 17.289229726032385, 4.675456191324572, 7.97428424406197, 12.97779320936535, 14.191251908486928, 27.139086324966645, 18.869970720457793, 36.9393048130557, 30.54108035052758, 7.094986676524042, 8.276496125443199, 20.863514484101866, 11.39895130035688, 7.516258739736108, 16.869686610606593, 51.90014929684885, 47.132873588085324, 16.923017770606332, -20.456658649935786, 31.58514100189294, 16.520956354416153, 23.478210114141664, 19.646466157650057, -6.405424689398033, 23.984914682441453, 19.943662806648923, 18.693437886107702, 30.562554771939208, 18.12335339796805, 23.646873725522678, 11.269504752321382, 25.0315348700762, 7.592991549940216, -27.056871927842465, -11.689021493662969, 16.18658242438214, 122.92519759403454, 45.184771452136516, 11.188286175975112, 19.37067245642849, 53.23634856082607, 9.80910222538957, 15.394794200691962, 30.697547753816657], "episode_lengths": [1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 416, 295, 1117, 295, 1117, 1117, 1117, 953, 1117, 1117, 419, 701, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 661, 399, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 727, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 763, 295, 1117, 1117, 295, 537, 1117, 295, 1117, 295, 763, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 763, 784, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1811085699837096, "mean_inference_ms": 7.236262347390915, "mean_action_processing_ms": 0.497782116351835, "mean_env_wait_ms": 21.380833335175147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020864248275756836, "StateBufferConnector_ms": 0.01806020736694336, "ViewRequirementAgentConnector_ms": 0.7650954723358154}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348629, "num_agent_steps_trained": 348629, "num_env_steps_sampled": 348629, "num_env_steps_trained": 348629, "num_env_steps_sampled_this_iter": 10841, "num_env_steps_trained_this_iter": 10841, "num_env_steps_sampled_throughput_per_sec": 219.18076421922473, "num_env_steps_trained_throughput_per_sec": 219.18076421922473, "timesteps_total": 348629, "num_steps_trained_this_iter": 10841, "agent_timesteps_total": 348629, "timers": {"training_iteration_time_ms": 51990.203, "sample_time_ms": 35876.644, "load_time_ms": 1623.683, "load_throughput": 7309.553, "learn_time_ms": 13960.164, "learn_throughput": 850.162, "synch_weights_time_ms": 438.472}, "counters": {"num_env_steps_sampled": 348629, "num_env_steps_trained": 348629, "num_agent_steps_sampled": 348629, "num_agent_steps_trained": 348629}, "done": false, "episodes_total": 493, "training_iteration": 35, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-02-44", "timestamp": 1749301364, "time_this_iter_s": 49.478498458862305, "time_total_s": 1641.6594815254211, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1641.6594815254211, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 60.518644067796615, "ram_util_percent": 85.66101694915254, "gpu_util_percent0": 0.1440677966101695, "vram_util_percent0": 0.96240234375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.651371e-05, "total_loss": -0.11588966510358399, "policy_loss": -0.016608289123507262, "vf_loss": 0.08171450795073594, "vf_explained_var": 0.8685992401270639, "kl": 0.011112645302845132, "entropy": 15.035143218721663, "entropy_coeff": 0.008256855000000002}, "model": {}, "num_grad_updates_lifetime": 12480.5, "diff_num_grad_updates_vs_sampler_policy": 209.5}}, "num_env_steps_sampled": 360661, "num_env_steps_trained": 360661, "num_agent_steps_sampled": 360661, "num_agent_steps_trained": 360661}, "sampler_results": {"episode_reward_max": 122.92519759403454, "episode_reward_min": -52.09953622942177, "episode_reward_mean": 20.216056557859687, "episode_len_mean": 835.49, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.5025714097903, 39.41166439803453, 11.205685694067158, 4.485665291355902, 16.75835572751334, 28.475907502224146, -1.102961638696812, 11.621677380823172, 24.106405290230796, 19.38359978523493, 23.747820330879755, 31.272267578602193, 45.471338909434245, 22.7600793151464, 9.135035300457343, 28.29882002678726, -52.09953622942177, -6.91263273186037, 11.158245104911233, 47.397420354129785, 0.3844112625882202, 18.1494424131602, 20.612826155316878, 93.60064256138283, 12.59793519646526, 25.959267917486425, -11.774910630851586, 6.269949002353386, 26.875537206991154, 22.67425044877813, 14.855578045810311, 9.874048088475668, 2.4798573577335, 35.2334426026977, 24.15277768475375, 35.702692651849866, 27.53229347669146, 17.21662617120222, 21.059176259713684, 11.428405070603041, 31.616888780823682, 19.207362598281776, 17.289229726032385, 4.675456191324572, 7.97428424406197, 12.97779320936535, 14.191251908486928, 27.139086324966645, 18.869970720457793, 36.9393048130557, 30.54108035052758, 7.094986676524042, 8.276496125443199, 20.863514484101866, 11.39895130035688, 7.516258739736108, 16.869686610606593, 51.90014929684885, 47.132873588085324, 16.923017770606332, -20.456658649935786, 31.58514100189294, 16.520956354416153, 23.478210114141664, 19.646466157650057, -6.405424689398033, 23.984914682441453, 19.943662806648923, 18.693437886107702, 30.562554771939208, 18.12335339796805, 23.646873725522678, 11.269504752321382, 25.0315348700762, 7.592991549940216, -27.056871927842465, -11.689021493662969, 16.18658242438214, 122.92519759403454, 45.184771452136516, 11.188286175975112, 19.37067245642849, 53.23634856082607, 9.80910222538957, 15.394794200691962, 30.697547753816657, 14.038656457095676, 35.658517234298394, 3.889206856931332, 3.8901491521519693, 28.315069896011973, 34.889696195155835, 29.214567521635953, 76.76600621003573, 13.53965991398767, 18.618428123096137, 7.942827280361407, 17.14686775498506, 20.232150138135058, -36.36039630436126], "episode_lengths": [1117, 1117, 1117, 953, 1117, 1117, 419, 701, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 661, 399, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 727, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 763, 295, 1117, 1117, 295, 537, 1117, 295, 1117, 295, 763, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 763, 784, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1858418994425066, "mean_inference_ms": 7.238618664484929, "mean_action_processing_ms": 0.4978995005482548, "mean_env_wait_ms": 21.38918700263311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018859386444091797, "StateBufferConnector_ms": 0.017058849334716797, "ViewRequirementAgentConnector_ms": 0.7729723453521729}}, "episode_reward_max": 122.92519759403454, "episode_reward_min": -52.09953622942177, "episode_reward_mean": 20.216056557859687, "episode_len_mean": 835.49, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [86.5025714097903, 39.41166439803453, 11.205685694067158, 4.485665291355902, 16.75835572751334, 28.475907502224146, -1.102961638696812, 11.621677380823172, 24.106405290230796, 19.38359978523493, 23.747820330879755, 31.272267578602193, 45.471338909434245, 22.7600793151464, 9.135035300457343, 28.29882002678726, -52.09953622942177, -6.91263273186037, 11.158245104911233, 47.397420354129785, 0.3844112625882202, 18.1494424131602, 20.612826155316878, 93.60064256138283, 12.59793519646526, 25.959267917486425, -11.774910630851586, 6.269949002353386, 26.875537206991154, 22.67425044877813, 14.855578045810311, 9.874048088475668, 2.4798573577335, 35.2334426026977, 24.15277768475375, 35.702692651849866, 27.53229347669146, 17.21662617120222, 21.059176259713684, 11.428405070603041, 31.616888780823682, 19.207362598281776, 17.289229726032385, 4.675456191324572, 7.97428424406197, 12.97779320936535, 14.191251908486928, 27.139086324966645, 18.869970720457793, 36.9393048130557, 30.54108035052758, 7.094986676524042, 8.276496125443199, 20.863514484101866, 11.39895130035688, 7.516258739736108, 16.869686610606593, 51.90014929684885, 47.132873588085324, 16.923017770606332, -20.456658649935786, 31.58514100189294, 16.520956354416153, 23.478210114141664, 19.646466157650057, -6.405424689398033, 23.984914682441453, 19.943662806648923, 18.693437886107702, 30.562554771939208, 18.12335339796805, 23.646873725522678, 11.269504752321382, 25.0315348700762, 7.592991549940216, -27.056871927842465, -11.689021493662969, 16.18658242438214, 122.92519759403454, 45.184771452136516, 11.188286175975112, 19.37067245642849, 53.23634856082607, 9.80910222538957, 15.394794200691962, 30.697547753816657, 14.038656457095676, 35.658517234298394, 3.889206856931332, 3.8901491521519693, 28.315069896011973, 34.889696195155835, 29.214567521635953, 76.76600621003573, 13.53965991398767, 18.618428123096137, 7.942827280361407, 17.14686775498506, 20.232150138135058, -36.36039630436126], "episode_lengths": [1117, 1117, 1117, 953, 1117, 1117, 419, 701, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 661, 399, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 727, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 763, 295, 1117, 1117, 295, 537, 1117, 295, 1117, 295, 763, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 763, 784, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1858418994425066, "mean_inference_ms": 7.238618664484929, "mean_action_processing_ms": 0.4978995005482548, "mean_env_wait_ms": 21.38918700263311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018859386444091797, "StateBufferConnector_ms": 0.017058849334716797, "ViewRequirementAgentConnector_ms": 0.7729723453521729}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360661, "num_agent_steps_trained": 360661, "num_env_steps_sampled": 360661, "num_env_steps_trained": 360661, "num_env_steps_sampled_this_iter": 12032, "num_env_steps_trained_this_iter": 12032, "num_env_steps_sampled_throughput_per_sec": 218.22986099206057, "num_env_steps_trained_throughput_per_sec": 218.22986099206057, "timesteps_total": 360661, "num_steps_trained_this_iter": 12032, "agent_timesteps_total": 360661, "timers": {"training_iteration_time_ms": 52278.76, "sample_time_ms": 35996.763, "load_time_ms": 1623.708, "load_throughput": 7286.163, "learn_time_ms": 14128.794, "learn_throughput": 837.34, "synch_weights_time_ms": 436.49}, "counters": {"num_env_steps_sampled": 360661, "num_env_steps_trained": 360661, "num_agent_steps_sampled": 360661, "num_agent_steps_trained": 360661}, "done": false, "episodes_total": 507, "training_iteration": 36, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-03-40", "timestamp": 1749301420, "time_this_iter_s": 55.21370816230774, "time_total_s": 1696.8731896877289, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1696.8731896877289, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 67.01692307692306, "ram_util_percent": 86.80461538461539, "gpu_util_percent0": 0.16215384615384618, "vram_util_percent0": 0.9624924879807691}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.639338999999998e-05, "total_loss": -0.08672929841886055, "policy_loss": 0.014941436708049507, "vf_loss": 0.07299253935640564, "vf_explained_var": 0.9312419624961152, "kl": 0.011619536219728718, "entropy": 15.119705591396409, "entropy_coeff": 0.008196695000000002}, "model": {}, "num_grad_updates_lifetime": 12935.5, "diff_num_grad_updates_vs_sampler_policy": 244.5}}, "num_env_steps_sampled": 374470, "num_env_steps_trained": 374470, "num_agent_steps_sampled": 374470, "num_agent_steps_trained": 374470}, "sampler_results": {"episode_reward_max": 122.92519759403454, "episode_reward_min": -52.09953622942177, "episode_reward_mean": 19.941278700672118, "episode_len_mean": 838.2, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.135035300457343, 28.29882002678726, -52.09953622942177, -6.91263273186037, 11.158245104911233, 47.397420354129785, 0.3844112625882202, 18.1494424131602, 20.612826155316878, 93.60064256138283, 12.59793519646526, 25.959267917486425, -11.774910630851586, 6.269949002353386, 26.875537206991154, 22.67425044877813, 14.855578045810311, 9.874048088475668, 2.4798573577335, 35.2334426026977, 24.15277768475375, 35.702692651849866, 27.53229347669146, 17.21662617120222, 21.059176259713684, 11.428405070603041, 31.616888780823682, 19.207362598281776, 17.289229726032385, 4.675456191324572, 7.97428424406197, 12.97779320936535, 14.191251908486928, 27.139086324966645, 18.869970720457793, 36.9393048130557, 30.54108035052758, 7.094986676524042, 8.276496125443199, 20.863514484101866, 11.39895130035688, 7.516258739736108, 16.869686610606593, 51.90014929684885, 47.132873588085324, 16.923017770606332, -20.456658649935786, 31.58514100189294, 16.520956354416153, 23.478210114141664, 19.646466157650057, -6.405424689398033, 23.984914682441453, 19.943662806648923, 18.693437886107702, 30.562554771939208, 18.12335339796805, 23.646873725522678, 11.269504752321382, 25.0315348700762, 7.592991549940216, -27.056871927842465, -11.689021493662969, 16.18658242438214, 122.92519759403454, 45.184771452136516, 11.188286175975112, 19.37067245642849, 53.23634856082607, 9.80910222538957, 15.394794200691962, 30.697547753816657, 14.038656457095676, 35.658517234298394, 3.889206856931332, 3.8901491521519693, 28.315069896011973, 34.889696195155835, 29.214567521635953, 76.76600621003573, 13.53965991398767, 18.618428123096137, 7.942827280361407, 17.14686775498506, 20.232150138135058, -36.36039630436126, 19.04699231649845, 24.090140243124615, 3.7182598223858703, 55.45238891525617, 26.649349154768853, 30.62767423670041, 8.807088110708856, 47.040177095637745, 12.384116910718374, 27.86888658371047, 14.685466514741323, 13.026641271071712, 32.16111552895532, 21.063994551604946], "episode_lengths": [1117, 1117, 661, 399, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 727, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 763, 295, 1117, 1117, 295, 537, 1117, 295, 1117, 295, 763, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 763, 784, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 799, 1117, 1117, 932, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.192637512758292, "mean_inference_ms": 7.246733176586678, "mean_action_processing_ms": 0.4983033880037808, "mean_env_wait_ms": 21.41058548538295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015585184097290039, "StateBufferConnector_ms": 0.018047809600830078, "ViewRequirementAgentConnector_ms": 0.802954912185669}}, "episode_reward_max": 122.92519759403454, "episode_reward_min": -52.09953622942177, "episode_reward_mean": 19.941278700672118, "episode_len_mean": 838.2, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.135035300457343, 28.29882002678726, -52.09953622942177, -6.91263273186037, 11.158245104911233, 47.397420354129785, 0.3844112625882202, 18.1494424131602, 20.612826155316878, 93.60064256138283, 12.59793519646526, 25.959267917486425, -11.774910630851586, 6.269949002353386, 26.875537206991154, 22.67425044877813, 14.855578045810311, 9.874048088475668, 2.4798573577335, 35.2334426026977, 24.15277768475375, 35.702692651849866, 27.53229347669146, 17.21662617120222, 21.059176259713684, 11.428405070603041, 31.616888780823682, 19.207362598281776, 17.289229726032385, 4.675456191324572, 7.97428424406197, 12.97779320936535, 14.191251908486928, 27.139086324966645, 18.869970720457793, 36.9393048130557, 30.54108035052758, 7.094986676524042, 8.276496125443199, 20.863514484101866, 11.39895130035688, 7.516258739736108, 16.869686610606593, 51.90014929684885, 47.132873588085324, 16.923017770606332, -20.456658649935786, 31.58514100189294, 16.520956354416153, 23.478210114141664, 19.646466157650057, -6.405424689398033, 23.984914682441453, 19.943662806648923, 18.693437886107702, 30.562554771939208, 18.12335339796805, 23.646873725522678, 11.269504752321382, 25.0315348700762, 7.592991549940216, -27.056871927842465, -11.689021493662969, 16.18658242438214, 122.92519759403454, 45.184771452136516, 11.188286175975112, 19.37067245642849, 53.23634856082607, 9.80910222538957, 15.394794200691962, 30.697547753816657, 14.038656457095676, 35.658517234298394, 3.889206856931332, 3.8901491521519693, 28.315069896011973, 34.889696195155835, 29.214567521635953, 76.76600621003573, 13.53965991398767, 18.618428123096137, 7.942827280361407, 17.14686775498506, 20.232150138135058, -36.36039630436126, 19.04699231649845, 24.090140243124615, 3.7182598223858703, 55.45238891525617, 26.649349154768853, 30.62767423670041, 8.807088110708856, 47.040177095637745, 12.384116910718374, 27.86888658371047, 14.685466514741323, 13.026641271071712, 32.16111552895532, 21.063994551604946], "episode_lengths": [1117, 1117, 661, 399, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 727, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 763, 295, 1117, 1117, 295, 537, 1117, 295, 1117, 295, 763, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 763, 784, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 799, 1117, 1117, 932, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.192637512758292, "mean_inference_ms": 7.246733176586678, "mean_action_processing_ms": 0.4983033880037808, "mean_env_wait_ms": 21.41058548538295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015585184097290039, "StateBufferConnector_ms": 0.018047809600830078, "ViewRequirementAgentConnector_ms": 0.802954912185669}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 374470, "num_agent_steps_trained": 374470, "num_env_steps_sampled": 374470, "num_env_steps_trained": 374470, "num_env_steps_sampled_this_iter": 13809, "num_env_steps_trained_this_iter": 13809, "num_env_steps_sampled_throughput_per_sec": 217.86355490621327, "num_env_steps_trained_throughput_per_sec": 217.86355490621327, "timesteps_total": 374470, "num_steps_trained_this_iter": 13809, "agent_timesteps_total": 374470, "timers": {"training_iteration_time_ms": 53199.693, "sample_time_ms": 36597.007, "load_time_ms": 1686.401, "load_throughput": 7089.001, "learn_time_ms": 14384.317, "learn_throughput": 831.107, "synch_weights_time_ms": 436.814}, "counters": {"num_env_steps_sampled": 374470, "num_env_steps_trained": 374470, "num_agent_steps_sampled": 374470, "num_agent_steps_trained": 374470}, "done": false, "episodes_total": 521, "training_iteration": 37, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-04-43", "timestamp": 1749301483, "time_this_iter_s": 63.39671492576599, "time_total_s": 1760.2699046134949, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1760.2699046134949, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 71.65616438356166, "ram_util_percent": 89.43013698630136, "gpu_util_percent0": 0.159041095890411, "vram_util_percent0": 0.9627278645833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.625530000000001e-05, "total_loss": -0.10909762747568737, "policy_loss": -0.012407931024435817, "vf_loss": 0.08629672488697418, "vf_explained_var": 0.9103046097406526, "kl": 0.01105977580534907, "entropy": 15.124215688938047, "entropy_coeff": 0.00812765}, "model": {}, "num_grad_updates_lifetime": 13385.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 386026, "num_env_steps_trained": 386026, "num_agent_steps_sampled": 386026, "num_agent_steps_trained": 386026}, "sampler_results": {"episode_reward_max": 122.92519759403454, "episode_reward_min": -36.36039630436126, "episode_reward_mean": 20.436262061931906, "episode_len_mean": 854.12, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.875537206991154, 22.67425044877813, 14.855578045810311, 9.874048088475668, 2.4798573577335, 35.2334426026977, 24.15277768475375, 35.702692651849866, 27.53229347669146, 17.21662617120222, 21.059176259713684, 11.428405070603041, 31.616888780823682, 19.207362598281776, 17.289229726032385, 4.675456191324572, 7.97428424406197, 12.97779320936535, 14.191251908486928, 27.139086324966645, 18.869970720457793, 36.9393048130557, 30.54108035052758, 7.094986676524042, 8.276496125443199, 20.863514484101866, 11.39895130035688, 7.516258739736108, 16.869686610606593, 51.90014929684885, 47.132873588085324, 16.923017770606332, -20.456658649935786, 31.58514100189294, 16.520956354416153, 23.478210114141664, 19.646466157650057, -6.405424689398033, 23.984914682441453, 19.943662806648923, 18.693437886107702, 30.562554771939208, 18.12335339796805, 23.646873725522678, 11.269504752321382, 25.0315348700762, 7.592991549940216, -27.056871927842465, -11.689021493662969, 16.18658242438214, 122.92519759403454, 45.184771452136516, 11.188286175975112, 19.37067245642849, 53.23634856082607, 9.80910222538957, 15.394794200691962, 30.697547753816657, 14.038656457095676, 35.658517234298394, 3.889206856931332, 3.8901491521519693, 28.315069896011973, 34.889696195155835, 29.214567521635953, 76.76600621003573, 13.53965991398767, 18.618428123096137, 7.942827280361407, 17.14686775498506, 20.232150138135058, -36.36039630436126, 19.04699231649845, 24.090140243124615, 3.7182598223858703, 55.45238891525617, 26.649349154768853, 30.62767423670041, 8.807088110708856, 47.040177095637745, 12.384116910718374, 27.86888658371047, 14.685466514741323, 13.026641271071712, 32.16111552895532, 21.063994551604946, 13.015231955016985, 14.888418307686038, 46.2921656150075, 71.03380066352406, -26.902069473769178, 21.04711475245975, 22.167883820549314, 5.6043034331278605, -17.05237624143018, 11.04913411497791, 25.380409917100813, 9.330217058107069, 13.670371459773852, 42.75064644675219], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 763, 295, 1117, 1117, 295, 537, 1117, 295, 1117, 295, 763, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 763, 784, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 799, 1117, 1117, 932, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 323, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1999748151354552, "mean_inference_ms": 7.255880956402311, "mean_action_processing_ms": 0.4988445954896648, "mean_env_wait_ms": 21.434931966542862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019082307815551758, "StateBufferConnector_ms": 0.019541263580322266, "ViewRequirementAgentConnector_ms": 0.8019428253173828}}, "episode_reward_max": 122.92519759403454, "episode_reward_min": -36.36039630436126, "episode_reward_mean": 20.436262061931906, "episode_len_mean": 854.12, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.875537206991154, 22.67425044877813, 14.855578045810311, 9.874048088475668, 2.4798573577335, 35.2334426026977, 24.15277768475375, 35.702692651849866, 27.53229347669146, 17.21662617120222, 21.059176259713684, 11.428405070603041, 31.616888780823682, 19.207362598281776, 17.289229726032385, 4.675456191324572, 7.97428424406197, 12.97779320936535, 14.191251908486928, 27.139086324966645, 18.869970720457793, 36.9393048130557, 30.54108035052758, 7.094986676524042, 8.276496125443199, 20.863514484101866, 11.39895130035688, 7.516258739736108, 16.869686610606593, 51.90014929684885, 47.132873588085324, 16.923017770606332, -20.456658649935786, 31.58514100189294, 16.520956354416153, 23.478210114141664, 19.646466157650057, -6.405424689398033, 23.984914682441453, 19.943662806648923, 18.693437886107702, 30.562554771939208, 18.12335339796805, 23.646873725522678, 11.269504752321382, 25.0315348700762, 7.592991549940216, -27.056871927842465, -11.689021493662969, 16.18658242438214, 122.92519759403454, 45.184771452136516, 11.188286175975112, 19.37067245642849, 53.23634856082607, 9.80910222538957, 15.394794200691962, 30.697547753816657, 14.038656457095676, 35.658517234298394, 3.889206856931332, 3.8901491521519693, 28.315069896011973, 34.889696195155835, 29.214567521635953, 76.76600621003573, 13.53965991398767, 18.618428123096137, 7.942827280361407, 17.14686775498506, 20.232150138135058, -36.36039630436126, 19.04699231649845, 24.090140243124615, 3.7182598223858703, 55.45238891525617, 26.649349154768853, 30.62767423670041, 8.807088110708856, 47.040177095637745, 12.384116910718374, 27.86888658371047, 14.685466514741323, 13.026641271071712, 32.16111552895532, 21.063994551604946, 13.015231955016985, 14.888418307686038, 46.2921656150075, 71.03380066352406, -26.902069473769178, 21.04711475245975, 22.167883820549314, 5.6043034331278605, -17.05237624143018, 11.04913411497791, 25.380409917100813, 9.330217058107069, 13.670371459773852, 42.75064644675219], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 763, 295, 1117, 1117, 295, 537, 1117, 295, 1117, 295, 763, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 763, 784, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 799, 1117, 1117, 932, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 323, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1999748151354552, "mean_inference_ms": 7.255880956402311, "mean_action_processing_ms": 0.4988445954896648, "mean_env_wait_ms": 21.434931966542862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019082307815551758, "StateBufferConnector_ms": 0.019541263580322266, "ViewRequirementAgentConnector_ms": 0.8019428253173828}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 386026, "num_agent_steps_trained": 386026, "num_env_steps_sampled": 386026, "num_env_steps_trained": 386026, "num_env_steps_sampled_this_iter": 11556, "num_env_steps_trained_this_iter": 11556, "num_env_steps_sampled_throughput_per_sec": 214.8652205405723, "num_env_steps_trained_throughput_per_sec": 214.8652205405723, "timesteps_total": 386026, "num_steps_trained_this_iter": 11556, "agent_timesteps_total": 386026, "timers": {"training_iteration_time_ms": 53490.085, "sample_time_ms": 36716.555, "load_time_ms": 1678.325, "load_throughput": 7099.401, "learn_time_ms": 14567.06, "learn_throughput": 817.948, "synch_weights_time_ms": 434.684}, "counters": {"num_env_steps_sampled": 386026, "num_env_steps_trained": 386026, "num_agent_steps_sampled": 386026, "num_agent_steps_trained": 386026}, "done": false, "episodes_total": 535, "training_iteration": 38, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-05-37", "timestamp": 1749301537, "time_this_iter_s": 53.800559759140015, "time_total_s": 1814.070464372635, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1814.070464372635, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 63.479687500000004, "ram_util_percent": 88.21875, "gpu_util_percent0": 0.16562500000000002, "vram_util_percent0": 0.9627278645833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.613973999999999e-05, "total_loss": -0.12064606470687847, "policy_loss": -0.021907999304275276, "vf_loss": 0.07628194923911776, "vf_explained_var": 0.9225614638961092, "kl": 0.011547495616002114, "entropy": 15.115920205018957, "entropy_coeff": 0.008069870000000002}, "model": {}, "num_grad_updates_lifetime": 13835.5, "diff_num_grad_updates_vs_sampler_policy": 244.5}}, "num_env_steps_sampled": 399834, "num_env_steps_trained": 399834, "num_agent_steps_sampled": 399834, "num_agent_steps_trained": 399834}, "sampler_results": {"episode_reward_max": 122.92519759403454, "episode_reward_min": -36.36039630436126, "episode_reward_mean": 20.738874392815024, "episode_len_mean": 860.48, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.289229726032385, 4.675456191324572, 7.97428424406197, 12.97779320936535, 14.191251908486928, 27.139086324966645, 18.869970720457793, 36.9393048130557, 30.54108035052758, 7.094986676524042, 8.276496125443199, 20.863514484101866, 11.39895130035688, 7.516258739736108, 16.869686610606593, 51.90014929684885, 47.132873588085324, 16.923017770606332, -20.456658649935786, 31.58514100189294, 16.520956354416153, 23.478210114141664, 19.646466157650057, -6.405424689398033, 23.984914682441453, 19.943662806648923, 18.693437886107702, 30.562554771939208, 18.12335339796805, 23.646873725522678, 11.269504752321382, 25.0315348700762, 7.592991549940216, -27.056871927842465, -11.689021493662969, 16.18658242438214, 122.92519759403454, 45.184771452136516, 11.188286175975112, 19.37067245642849, 53.23634856082607, 9.80910222538957, 15.394794200691962, 30.697547753816657, 14.038656457095676, 35.658517234298394, 3.889206856931332, 3.8901491521519693, 28.315069896011973, 34.889696195155835, 29.214567521635953, 76.76600621003573, 13.53965991398767, 18.618428123096137, 7.942827280361407, 17.14686775498506, 20.232150138135058, -36.36039630436126, 19.04699231649845, 24.090140243124615, 3.7182598223858703, 55.45238891525617, 26.649349154768853, 30.62767423670041, 8.807088110708856, 47.040177095637745, 12.384116910718374, 27.86888658371047, 14.685466514741323, 13.026641271071712, 32.16111552895532, 21.063994551604946, 13.015231955016985, 14.888418307686038, 46.2921656150075, 71.03380066352406, -26.902069473769178, 21.04711475245975, 22.167883820549314, 5.6043034331278605, -17.05237624143018, 11.04913411497791, 25.380409917100813, 9.330217058107069, 13.670371459773852, 42.75064644675219, 67.34826438802571, -4.287996726699824, 20.99174832235769, 40.80158734253755, 24.950288220945936, 50.949172284526696, 22.894635122882274, 1.3252637746757114, -1.6844667490942486, 12.909740689351496, 45.242036476967165, 18.888105427969993, 12.83086674843655, 17.010924209834922], "episode_lengths": [295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 763, 295, 1117, 1117, 295, 537, 1117, 295, 1117, 295, 763, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 763, 784, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 799, 1117, 1117, 932, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 323, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 957, 1117, 1117, 1117, 1117, 269, 1117, 1117, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2077700840558516, "mean_inference_ms": 7.268188839966325, "mean_action_processing_ms": 0.4995415909236385, "mean_env_wait_ms": 21.465821619742528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021057605743408203, "StateBufferConnector_ms": 0.021571636199951172, "ViewRequirementAgentConnector_ms": 0.7806229591369629}}, "episode_reward_max": 122.92519759403454, "episode_reward_min": -36.36039630436126, "episode_reward_mean": 20.738874392815024, "episode_len_mean": 860.48, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.289229726032385, 4.675456191324572, 7.97428424406197, 12.97779320936535, 14.191251908486928, 27.139086324966645, 18.869970720457793, 36.9393048130557, 30.54108035052758, 7.094986676524042, 8.276496125443199, 20.863514484101866, 11.39895130035688, 7.516258739736108, 16.869686610606593, 51.90014929684885, 47.132873588085324, 16.923017770606332, -20.456658649935786, 31.58514100189294, 16.520956354416153, 23.478210114141664, 19.646466157650057, -6.405424689398033, 23.984914682441453, 19.943662806648923, 18.693437886107702, 30.562554771939208, 18.12335339796805, 23.646873725522678, 11.269504752321382, 25.0315348700762, 7.592991549940216, -27.056871927842465, -11.689021493662969, 16.18658242438214, 122.92519759403454, 45.184771452136516, 11.188286175975112, 19.37067245642849, 53.23634856082607, 9.80910222538957, 15.394794200691962, 30.697547753816657, 14.038656457095676, 35.658517234298394, 3.889206856931332, 3.8901491521519693, 28.315069896011973, 34.889696195155835, 29.214567521635953, 76.76600621003573, 13.53965991398767, 18.618428123096137, 7.942827280361407, 17.14686775498506, 20.232150138135058, -36.36039630436126, 19.04699231649845, 24.090140243124615, 3.7182598223858703, 55.45238891525617, 26.649349154768853, 30.62767423670041, 8.807088110708856, 47.040177095637745, 12.384116910718374, 27.86888658371047, 14.685466514741323, 13.026641271071712, 32.16111552895532, 21.063994551604946, 13.015231955016985, 14.888418307686038, 46.2921656150075, 71.03380066352406, -26.902069473769178, 21.04711475245975, 22.167883820549314, 5.6043034331278605, -17.05237624143018, 11.04913411497791, 25.380409917100813, 9.330217058107069, 13.670371459773852, 42.75064644675219, 67.34826438802571, -4.287996726699824, 20.99174832235769, 40.80158734253755, 24.950288220945936, 50.949172284526696, 22.894635122882274, 1.3252637746757114, -1.6844667490942486, 12.909740689351496, 45.242036476967165, 18.888105427969993, 12.83086674843655, 17.010924209834922], "episode_lengths": [295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 763, 295, 1117, 1117, 295, 537, 1117, 295, 1117, 295, 763, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 763, 784, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 799, 1117, 1117, 932, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 323, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 957, 1117, 1117, 1117, 1117, 269, 1117, 1117, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2077700840558516, "mean_inference_ms": 7.268188839966325, "mean_action_processing_ms": 0.4995415909236385, "mean_env_wait_ms": 21.465821619742528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021057605743408203, "StateBufferConnector_ms": 0.021571636199951172, "ViewRequirementAgentConnector_ms": 0.7806229591369629}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 399834, "num_agent_steps_trained": 399834, "num_env_steps_sampled": 399834, "num_env_steps_trained": 399834, "num_env_steps_sampled_this_iter": 13808, "num_env_steps_trained_this_iter": 13808, "num_env_steps_sampled_throughput_per_sec": 241.96901319101394, "num_env_steps_trained_throughput_per_sec": 241.96901319101394, "timesteps_total": 399834, "num_steps_trained_this_iter": 13808, "agent_timesteps_total": 399834, "timers": {"training_iteration_time_ms": 53665.317, "sample_time_ms": 37000.663, "load_time_ms": 1703.533, "load_throughput": 7072.829, "learn_time_ms": 14429.934, "learn_throughput": 834.986, "synch_weights_time_ms": 435.385}, "counters": {"num_env_steps_sampled": 399834, "num_env_steps_trained": 399834, "num_agent_steps_sampled": 399834, "num_agent_steps_trained": 399834}, "done": false, "episodes_total": 549, "training_iteration": 39, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-06-34", "timestamp": 1749301594, "time_this_iter_s": 57.09389305114746, "time_total_s": 1871.1643574237823, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1871.1643574237823, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 69.72686567164179, "ram_util_percent": 88.9029850746269, "gpu_util_percent0": 0.15253731343283583, "vram_util_percent0": 0.9627278645833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": 5.768904113881522, "episode_reward_min": 4.790064450157347, "episode_reward_mean": 5.311551380151667, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.768904113881522, 5.6050667487845045, 5.520118602280405, 4.790064450157347, 4.873602985654556], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7197346499483728, "mean_inference_ms": 3.761938686313852, "mean_action_processing_ms": 0.30299879487070563, "mean_env_wait_ms": 12.311802905268463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5178451538085938}}, "episode_reward_max": 5.768904113881522, "episode_reward_min": 4.790064450157347, "episode_reward_mean": 5.311551380151667, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.768904113881522, 5.6050667487845045, 5.520118602280405, 4.790064450157347, 4.873602985654556], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7197346499483728, "mean_inference_ms": 3.761938686313852, "mean_action_processing_ms": 0.30299879487070563, "mean_env_wait_ms": 12.311802905268463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5178451538085938}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.600166000000001e-05, "total_loss": -0.11579594149804139, "policy_loss": -0.016039659501984715, "vf_loss": 0.06888850902583687, "vf_explained_var": 0.9148760037219271, "kl": 0.01195653448428815, "entropy": 15.097993051244858, "entropy_coeff": 0.00800083}, "model": {}, "num_grad_updates_lifetime": 14315.5, "diff_num_grad_updates_vs_sampler_policy": 234.5}}, "num_env_steps_sampled": 413006, "num_env_steps_trained": 413006, "num_agent_steps_sampled": 413006, "num_agent_steps_trained": 413006}, "sampler_results": {"episode_reward_max": 122.92519759403454, "episode_reward_min": -36.36039630436126, "episode_reward_mean": 22.45525645808781, "episode_len_mean": 880.46, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.869686610606593, 51.90014929684885, 47.132873588085324, 16.923017770606332, -20.456658649935786, 31.58514100189294, 16.520956354416153, 23.478210114141664, 19.646466157650057, -6.405424689398033, 23.984914682441453, 19.943662806648923, 18.693437886107702, 30.562554771939208, 18.12335339796805, 23.646873725522678, 11.269504752321382, 25.0315348700762, 7.592991549940216, -27.056871927842465, -11.689021493662969, 16.18658242438214, 122.92519759403454, 45.184771452136516, 11.188286175975112, 19.37067245642849, 53.23634856082607, 9.80910222538957, 15.394794200691962, 30.697547753816657, 14.038656457095676, 35.658517234298394, 3.889206856931332, 3.8901491521519693, 28.315069896011973, 34.889696195155835, 29.214567521635953, 76.76600621003573, 13.53965991398767, 18.618428123096137, 7.942827280361407, 17.14686775498506, 20.232150138135058, -36.36039630436126, 19.04699231649845, 24.090140243124615, 3.7182598223858703, 55.45238891525617, 26.649349154768853, 30.62767423670041, 8.807088110708856, 47.040177095637745, 12.384116910718374, 27.86888658371047, 14.685466514741323, 13.026641271071712, 32.16111552895532, 21.063994551604946, 13.015231955016985, 14.888418307686038, 46.2921656150075, 71.03380066352406, -26.902069473769178, 21.04711475245975, 22.167883820549314, 5.6043034331278605, -17.05237624143018, 11.04913411497791, 25.380409917100813, 9.330217058107069, 13.670371459773852, 42.75064644675219, 67.34826438802571, -4.287996726699824, 20.99174832235769, 40.80158734253755, 24.950288220945936, 50.949172284526696, 22.894635122882274, 1.3252637746757114, -1.6844667490942486, 12.909740689351496, 45.242036476967165, 18.888105427969993, 12.83086674843655, 17.010924209834922, 28.076163218146547, 28.49902062906004, 16.370646725182457, 22.994138516554013, 14.48793289420913, 9.454979936131176, 21.680744468503736, 24.040667104752345, 65.9688986177544, 48.35756700194177, 43.02932447468315, 30.75632046729476, 18.149423145767578, 25.520044141738484], "episode_lengths": [295, 1117, 1117, 295, 537, 1117, 295, 1117, 295, 763, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 763, 784, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 799, 1117, 1117, 932, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 323, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 957, 1117, 1117, 1117, 1117, 269, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2163678175395156, "mean_inference_ms": 7.281680109727259, "mean_action_processing_ms": 0.5003102118141701, "mean_env_wait_ms": 21.500997569594407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022082805633544922, "StateBufferConnector_ms": 0.022500038146972656, "ViewRequirementAgentConnector_ms": 0.7723662853240967}}, "episode_reward_max": 122.92519759403454, "episode_reward_min": -36.36039630436126, "episode_reward_mean": 22.45525645808781, "episode_len_mean": 880.46, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.869686610606593, 51.90014929684885, 47.132873588085324, 16.923017770606332, -20.456658649935786, 31.58514100189294, 16.520956354416153, 23.478210114141664, 19.646466157650057, -6.405424689398033, 23.984914682441453, 19.943662806648923, 18.693437886107702, 30.562554771939208, 18.12335339796805, 23.646873725522678, 11.269504752321382, 25.0315348700762, 7.592991549940216, -27.056871927842465, -11.689021493662969, 16.18658242438214, 122.92519759403454, 45.184771452136516, 11.188286175975112, 19.37067245642849, 53.23634856082607, 9.80910222538957, 15.394794200691962, 30.697547753816657, 14.038656457095676, 35.658517234298394, 3.889206856931332, 3.8901491521519693, 28.315069896011973, 34.889696195155835, 29.214567521635953, 76.76600621003573, 13.53965991398767, 18.618428123096137, 7.942827280361407, 17.14686775498506, 20.232150138135058, -36.36039630436126, 19.04699231649845, 24.090140243124615, 3.7182598223858703, 55.45238891525617, 26.649349154768853, 30.62767423670041, 8.807088110708856, 47.040177095637745, 12.384116910718374, 27.86888658371047, 14.685466514741323, 13.026641271071712, 32.16111552895532, 21.063994551604946, 13.015231955016985, 14.888418307686038, 46.2921656150075, 71.03380066352406, -26.902069473769178, 21.04711475245975, 22.167883820549314, 5.6043034331278605, -17.05237624143018, 11.04913411497791, 25.380409917100813, 9.330217058107069, 13.670371459773852, 42.75064644675219, 67.34826438802571, -4.287996726699824, 20.99174832235769, 40.80158734253755, 24.950288220945936, 50.949172284526696, 22.894635122882274, 1.3252637746757114, -1.6844667490942486, 12.909740689351496, 45.242036476967165, 18.888105427969993, 12.83086674843655, 17.010924209834922, 28.076163218146547, 28.49902062906004, 16.370646725182457, 22.994138516554013, 14.48793289420913, 9.454979936131176, 21.680744468503736, 24.040667104752345, 65.9688986177544, 48.35756700194177, 43.02932447468315, 30.75632046729476, 18.149423145767578, 25.520044141738484], "episode_lengths": [295, 1117, 1117, 295, 537, 1117, 295, 1117, 295, 763, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 763, 784, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 799, 1117, 1117, 932, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 323, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 957, 1117, 1117, 1117, 1117, 269, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2163678175395156, "mean_inference_ms": 7.281680109727259, "mean_action_processing_ms": 0.5003102118141701, "mean_env_wait_ms": 21.500997569594407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022082805633544922, "StateBufferConnector_ms": 0.022500038146972656, "ViewRequirementAgentConnector_ms": 0.7723662853240967}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 413006, "num_agent_steps_trained": 413006, "num_env_steps_sampled": 413006, "num_env_steps_trained": 413006, "num_env_steps_sampled_this_iter": 13172, "num_env_steps_trained_this_iter": 13172, "num_env_steps_sampled_throughput_per_sec": 233.51056277471181, "num_env_steps_trained_throughput_per_sec": 233.51056277471181, "timesteps_total": 413006, "num_steps_trained_this_iter": 13172, "agent_timesteps_total": 413006, "timers": {"training_iteration_time_ms": 53710.859, "sample_time_ms": 37016.692, "load_time_ms": 1674.233, "load_throughput": 7174.747, "learn_time_ms": 14484.156, "learn_throughput": 829.334, "synch_weights_time_ms": 440.587}, "counters": {"num_env_steps_sampled": 413006, "num_env_steps_trained": 413006, "num_agent_steps_sampled": 413006, "num_agent_steps_trained": 413006}, "done": false, "episodes_total": 563, "training_iteration": 40, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-07-48", "timestamp": 1749301668, "time_this_iter_s": 73.76841449737549, "time_total_s": 1944.9327719211578, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 1944.9327719211578, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 55.30795454545455, "ram_util_percent": 88.53977272727273, "gpu_util_percent0": 0.13113636363636363, "vram_util_percent0": 0.9627278645833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.586994e-05, "total_loss": -0.10483973357503683, "policy_loss": -0.005517689727598322, "vf_loss": 0.0707387540828098, "vf_explained_var": 0.915163053707643, "kl": 0.012278848073170848, "entropy": 15.239804276553068, "entropy_coeff": 0.00793497}, "model": {}, "num_grad_updates_lifetime": 14770.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 425356, "num_env_steps_trained": 425356, "num_agent_steps_sampled": 425356, "num_agent_steps_trained": 425356}, "sampler_results": {"episode_reward_max": 122.92519759403454, "episode_reward_min": -36.36039630436126, "episode_reward_mean": 23.29264797546162, "episode_len_mean": 889.8, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.12335339796805, 23.646873725522678, 11.269504752321382, 25.0315348700762, 7.592991549940216, -27.056871927842465, -11.689021493662969, 16.18658242438214, 122.92519759403454, 45.184771452136516, 11.188286175975112, 19.37067245642849, 53.23634856082607, 9.80910222538957, 15.394794200691962, 30.697547753816657, 14.038656457095676, 35.658517234298394, 3.889206856931332, 3.8901491521519693, 28.315069896011973, 34.889696195155835, 29.214567521635953, 76.76600621003573, 13.53965991398767, 18.618428123096137, 7.942827280361407, 17.14686775498506, 20.232150138135058, -36.36039630436126, 19.04699231649845, 24.090140243124615, 3.7182598223858703, 55.45238891525617, 26.649349154768853, 30.62767423670041, 8.807088110708856, 47.040177095637745, 12.384116910718374, 27.86888658371047, 14.685466514741323, 13.026641271071712, 32.16111552895532, 21.063994551604946, 13.015231955016985, 14.888418307686038, 46.2921656150075, 71.03380066352406, -26.902069473769178, 21.04711475245975, 22.167883820549314, 5.6043034331278605, -17.05237624143018, 11.04913411497791, 25.380409917100813, 9.330217058107069, 13.670371459773852, 42.75064644675219, 67.34826438802571, -4.287996726699824, 20.99174832235769, 40.80158734253755, 24.950288220945936, 50.949172284526696, 22.894635122882274, 1.3252637746757114, -1.6844667490942486, 12.909740689351496, 45.242036476967165, 18.888105427969993, 12.83086674843655, 17.010924209834922, 28.076163218146547, 28.49902062906004, 16.370646725182457, 22.994138516554013, 14.48793289420913, 9.454979936131176, 21.680744468503736, 24.040667104752345, 65.9688986177544, 48.35756700194177, 43.02932447468315, 30.75632046729476, 18.149423145767578, 25.520044141738484, 15.928243452466575, -0.2200204080768175, 11.140908073114664, 67.92935784466927, 104.0495064037926, 51.70035640288055, 17.793805131450668, 13.05325573385833, 15.425160505133437, 12.73703453544309, 27.657726394084094, 17.859260085913217, 18.240890441608247, 0.8226548430942217], "episode_lengths": [1117, 295, 295, 1117, 295, 763, 784, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 799, 1117, 1117, 932, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 323, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 957, 1117, 1117, 1117, 1117, 269, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2257058063721256, "mean_inference_ms": 7.296307406259705, "mean_action_processing_ms": 0.5011912135629994, "mean_env_wait_ms": 21.538659373640115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03907036781311035, "StateBufferConnector_ms": 0.02326059341430664, "ViewRequirementAgentConnector_ms": 0.7900118827819824}}, "episode_reward_max": 122.92519759403454, "episode_reward_min": -36.36039630436126, "episode_reward_mean": 23.29264797546162, "episode_len_mean": 889.8, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.12335339796805, 23.646873725522678, 11.269504752321382, 25.0315348700762, 7.592991549940216, -27.056871927842465, -11.689021493662969, 16.18658242438214, 122.92519759403454, 45.184771452136516, 11.188286175975112, 19.37067245642849, 53.23634856082607, 9.80910222538957, 15.394794200691962, 30.697547753816657, 14.038656457095676, 35.658517234298394, 3.889206856931332, 3.8901491521519693, 28.315069896011973, 34.889696195155835, 29.214567521635953, 76.76600621003573, 13.53965991398767, 18.618428123096137, 7.942827280361407, 17.14686775498506, 20.232150138135058, -36.36039630436126, 19.04699231649845, 24.090140243124615, 3.7182598223858703, 55.45238891525617, 26.649349154768853, 30.62767423670041, 8.807088110708856, 47.040177095637745, 12.384116910718374, 27.86888658371047, 14.685466514741323, 13.026641271071712, 32.16111552895532, 21.063994551604946, 13.015231955016985, 14.888418307686038, 46.2921656150075, 71.03380066352406, -26.902069473769178, 21.04711475245975, 22.167883820549314, 5.6043034331278605, -17.05237624143018, 11.04913411497791, 25.380409917100813, 9.330217058107069, 13.670371459773852, 42.75064644675219, 67.34826438802571, -4.287996726699824, 20.99174832235769, 40.80158734253755, 24.950288220945936, 50.949172284526696, 22.894635122882274, 1.3252637746757114, -1.6844667490942486, 12.909740689351496, 45.242036476967165, 18.888105427969993, 12.83086674843655, 17.010924209834922, 28.076163218146547, 28.49902062906004, 16.370646725182457, 22.994138516554013, 14.48793289420913, 9.454979936131176, 21.680744468503736, 24.040667104752345, 65.9688986177544, 48.35756700194177, 43.02932447468315, 30.75632046729476, 18.149423145767578, 25.520044141738484, 15.928243452466575, -0.2200204080768175, 11.140908073114664, 67.92935784466927, 104.0495064037926, 51.70035640288055, 17.793805131450668, 13.05325573385833, 15.425160505133437, 12.73703453544309, 27.657726394084094, 17.859260085913217, 18.240890441608247, 0.8226548430942217], "episode_lengths": [1117, 295, 295, 1117, 295, 763, 784, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 799, 1117, 1117, 932, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 323, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 957, 1117, 1117, 1117, 1117, 269, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2257058063721256, "mean_inference_ms": 7.296307406259705, "mean_action_processing_ms": 0.5011912135629994, "mean_env_wait_ms": 21.538659373640115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03907036781311035, "StateBufferConnector_ms": 0.02326059341430664, "ViewRequirementAgentConnector_ms": 0.7900118827819824}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 425356, "num_agent_steps_trained": 425356, "num_env_steps_sampled": 425356, "num_env_steps_trained": 425356, "num_env_steps_sampled_this_iter": 12350, "num_env_steps_trained_this_iter": 12350, "num_env_steps_sampled_throughput_per_sec": 221.93351516464688, "num_env_steps_trained_throughput_per_sec": 221.93351516464688, "timesteps_total": 425356, "num_steps_trained_this_iter": 12350, "agent_timesteps_total": 425356, "timers": {"training_iteration_time_ms": 54455.664, "sample_time_ms": 37386.124, "load_time_ms": 1722.842, "load_throughput": 7110.807, "learn_time_ms": 14810.029, "learn_throughput": 827.196, "synch_weights_time_ms": 443.193}, "counters": {"num_env_steps_sampled": 425356, "num_env_steps_trained": 425356, "num_agent_steps_sampled": 425356, "num_agent_steps_trained": 425356}, "done": false, "episodes_total": 577, "training_iteration": 41, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-08-44", "timestamp": 1749301724, "time_this_iter_s": 55.666728258132935, "time_total_s": 2000.5995001792908, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2000.5995001792908, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 63.10757575757575, "ram_util_percent": 88.780303030303, "gpu_util_percent0": 0.17545454545454545, "vram_util_percent0": 0.9627278645833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.574644000000003e-05, "total_loss": -0.1134200319091267, "policy_loss": -0.017287662444727087, "vf_loss": 0.07695448483544878, "vf_explained_var": 0.9039568806566843, "kl": 0.011044452309172281, "entropy": 15.18614403561848, "entropy_coeff": 0.007873220000000002}, "model": {}, "num_grad_updates_lifetime": 15195.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 436884, "num_env_steps_trained": 436884, "num_agent_steps_sampled": 436884, "num_agent_steps_trained": 436884}, "sampler_results": {"episode_reward_max": 104.0495064037926, "episode_reward_min": -36.36039630436126, "episode_reward_mean": 23.923570616288842, "episode_len_mean": 896.67, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.394794200691962, 30.697547753816657, 14.038656457095676, 35.658517234298394, 3.889206856931332, 3.8901491521519693, 28.315069896011973, 34.889696195155835, 29.214567521635953, 76.76600621003573, 13.53965991398767, 18.618428123096137, 7.942827280361407, 17.14686775498506, 20.232150138135058, -36.36039630436126, 19.04699231649845, 24.090140243124615, 3.7182598223858703, 55.45238891525617, 26.649349154768853, 30.62767423670041, 8.807088110708856, 47.040177095637745, 12.384116910718374, 27.86888658371047, 14.685466514741323, 13.026641271071712, 32.16111552895532, 21.063994551604946, 13.015231955016985, 14.888418307686038, 46.2921656150075, 71.03380066352406, -26.902069473769178, 21.04711475245975, 22.167883820549314, 5.6043034331278605, -17.05237624143018, 11.04913411497791, 25.380409917100813, 9.330217058107069, 13.670371459773852, 42.75064644675219, 67.34826438802571, -4.287996726699824, 20.99174832235769, 40.80158734253755, 24.950288220945936, 50.949172284526696, 22.894635122882274, 1.3252637746757114, -1.6844667490942486, 12.909740689351496, 45.242036476967165, 18.888105427969993, 12.83086674843655, 17.010924209834922, 28.076163218146547, 28.49902062906004, 16.370646725182457, 22.994138516554013, 14.48793289420913, 9.454979936131176, 21.680744468503736, 24.040667104752345, 65.9688986177544, 48.35756700194177, 43.02932447468315, 30.75632046729476, 18.149423145767578, 25.520044141738484, 15.928243452466575, -0.2200204080768175, 11.140908073114664, 67.92935784466927, 104.0495064037926, 51.70035640288055, 17.793805131450668, 13.05325573385833, 15.425160505133437, 12.73703453544309, 27.657726394084094, 17.859260085913217, 18.240890441608247, 0.8226548430942217, 9.131849405508781, 49.36807705562996, 38.44689705017514, 10.780049400584648, 6.18323784010582, 15.679687394011882, 35.79032799846438, 16.63167239651906, 14.083030830218291, 49.61308737461025, 15.573302553448155, 31.925254775120216, 89.17921722791394, 5.525898543907882], "episode_lengths": [295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 799, 1117, 1117, 932, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 323, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 957, 1117, 1117, 1117, 1117, 269, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2360352946203603, "mean_inference_ms": 7.310470486664752, "mean_action_processing_ms": 0.5019802929102475, "mean_env_wait_ms": 21.574055795453173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04312777519226074, "StateBufferConnector_ms": 0.02526116371154785, "ViewRequirementAgentConnector_ms": 0.7902565002441406}}, "episode_reward_max": 104.0495064037926, "episode_reward_min": -36.36039630436126, "episode_reward_mean": 23.923570616288842, "episode_len_mean": 896.67, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.394794200691962, 30.697547753816657, 14.038656457095676, 35.658517234298394, 3.889206856931332, 3.8901491521519693, 28.315069896011973, 34.889696195155835, 29.214567521635953, 76.76600621003573, 13.53965991398767, 18.618428123096137, 7.942827280361407, 17.14686775498506, 20.232150138135058, -36.36039630436126, 19.04699231649845, 24.090140243124615, 3.7182598223858703, 55.45238891525617, 26.649349154768853, 30.62767423670041, 8.807088110708856, 47.040177095637745, 12.384116910718374, 27.86888658371047, 14.685466514741323, 13.026641271071712, 32.16111552895532, 21.063994551604946, 13.015231955016985, 14.888418307686038, 46.2921656150075, 71.03380066352406, -26.902069473769178, 21.04711475245975, 22.167883820549314, 5.6043034331278605, -17.05237624143018, 11.04913411497791, 25.380409917100813, 9.330217058107069, 13.670371459773852, 42.75064644675219, 67.34826438802571, -4.287996726699824, 20.99174832235769, 40.80158734253755, 24.950288220945936, 50.949172284526696, 22.894635122882274, 1.3252637746757114, -1.6844667490942486, 12.909740689351496, 45.242036476967165, 18.888105427969993, 12.83086674843655, 17.010924209834922, 28.076163218146547, 28.49902062906004, 16.370646725182457, 22.994138516554013, 14.48793289420913, 9.454979936131176, 21.680744468503736, 24.040667104752345, 65.9688986177544, 48.35756700194177, 43.02932447468315, 30.75632046729476, 18.149423145767578, 25.520044141738484, 15.928243452466575, -0.2200204080768175, 11.140908073114664, 67.92935784466927, 104.0495064037926, 51.70035640288055, 17.793805131450668, 13.05325573385833, 15.425160505133437, 12.73703453544309, 27.657726394084094, 17.859260085913217, 18.240890441608247, 0.8226548430942217, 9.131849405508781, 49.36807705562996, 38.44689705017514, 10.780049400584648, 6.18323784010582, 15.679687394011882, 35.79032799846438, 16.63167239651906, 14.083030830218291, 49.61308737461025, 15.573302553448155, 31.925254775120216, 89.17921722791394, 5.525898543907882], "episode_lengths": [295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 799, 1117, 1117, 932, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 323, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 957, 1117, 1117, 1117, 1117, 269, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2360352946203603, "mean_inference_ms": 7.310470486664752, "mean_action_processing_ms": 0.5019802929102475, "mean_env_wait_ms": 21.574055795453173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04312777519226074, "StateBufferConnector_ms": 0.02526116371154785, "ViewRequirementAgentConnector_ms": 0.7902565002441406}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436884, "num_agent_steps_trained": 436884, "num_env_steps_sampled": 436884, "num_env_steps_trained": 436884, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 219.68136687932304, "num_env_steps_trained_throughput_per_sec": 219.68136687932304, "timesteps_total": 436884, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 436884, "timers": {"training_iteration_time_ms": 54388.481, "sample_time_ms": 37305.274, "load_time_ms": 1715.445, "load_throughput": 7093.555, "learn_time_ms": 14833.663, "learn_throughput": 820.337, "synch_weights_time_ms": 442.225}, "counters": {"num_env_steps_sampled": 436884, "num_env_steps_trained": 436884, "num_agent_steps_sampled": 436884, "num_agent_steps_trained": 436884}, "done": false, "episodes_total": 591, "training_iteration": 42, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-09-36", "timestamp": 1749301776, "time_this_iter_s": 52.4950065612793, "time_total_s": 2053.09450674057, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2053.09450674057, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 60.81428571428571, "ram_util_percent": 87.51904761904763, "gpu_util_percent0": 0.16603174603174606, "vram_util_percent0": 0.9627278645833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.563115999999999e-05, "total_loss": -0.10461131278055043, "policy_loss": -0.012737175591543994, "vf_loss": 0.09211905641396614, "vf_explained_var": 0.9054244977506725, "kl": 0.011135132805793545, "entropy": 15.335756503451954, "entropy_coeff": 0.007815580000000003}, "model": {}, "num_grad_updates_lifetime": 15620.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 449234, "num_env_steps_trained": 449234, "num_agent_steps_sampled": 449234, "num_agent_steps_trained": 449234}, "sampler_results": {"episode_reward_max": 104.0495064037926, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 22.60242375445364, "episode_len_mean": 896.67, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.232150138135058, -36.36039630436126, 19.04699231649845, 24.090140243124615, 3.7182598223858703, 55.45238891525617, 26.649349154768853, 30.62767423670041, 8.807088110708856, 47.040177095637745, 12.384116910718374, 27.86888658371047, 14.685466514741323, 13.026641271071712, 32.16111552895532, 21.063994551604946, 13.015231955016985, 14.888418307686038, 46.2921656150075, 71.03380066352406, -26.902069473769178, 21.04711475245975, 22.167883820549314, 5.6043034331278605, -17.05237624143018, 11.04913411497791, 25.380409917100813, 9.330217058107069, 13.670371459773852, 42.75064644675219, 67.34826438802571, -4.287996726699824, 20.99174832235769, 40.80158734253755, 24.950288220945936, 50.949172284526696, 22.894635122882274, 1.3252637746757114, -1.6844667490942486, 12.909740689351496, 45.242036476967165, 18.888105427969993, 12.83086674843655, 17.010924209834922, 28.076163218146547, 28.49902062906004, 16.370646725182457, 22.994138516554013, 14.48793289420913, 9.454979936131176, 21.680744468503736, 24.040667104752345, 65.9688986177544, 48.35756700194177, 43.02932447468315, 30.75632046729476, 18.149423145767578, 25.520044141738484, 15.928243452466575, -0.2200204080768175, 11.140908073114664, 67.92935784466927, 104.0495064037926, 51.70035640288055, 17.793805131450668, 13.05325573385833, 15.425160505133437, 12.73703453544309, 27.657726394084094, 17.859260085913217, 18.240890441608247, 0.8226548430942217, 9.131849405508781, 49.36807705562996, 38.44689705017514, 10.780049400584648, 6.18323784010582, 15.679687394011882, 35.79032799846438, 16.63167239651906, 14.083030830218291, 49.61308737461025, 15.573302553448155, 31.925254775120216, 89.17921722791394, 5.525898543907882, 3.7341017623995896, 32.680793490540324, -17.46828846638582, 15.550388464692452, -0.0719960341707303, 36.358726177287224, 19.53648223921664, 18.526811182407403, 92.02477004908786, 9.365367821779088, 16.509273979068823, -35.17859752080039, -44.26644157256526, 50.58591679417811], "episode_lengths": [295, 799, 1117, 1117, 932, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 323, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 957, 1117, 1117, 1117, 1117, 269, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.245423842458874, "mean_inference_ms": 7.323697708240001, "mean_action_processing_ms": 0.5027254872369188, "mean_env_wait_ms": 21.608610707081088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04522585868835449, "StateBufferConnector_ms": 0.032291412353515625, "ViewRequirementAgentConnector_ms": 0.7907896041870117}}, "episode_reward_max": 104.0495064037926, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 22.60242375445364, "episode_len_mean": 896.67, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.232150138135058, -36.36039630436126, 19.04699231649845, 24.090140243124615, 3.7182598223858703, 55.45238891525617, 26.649349154768853, 30.62767423670041, 8.807088110708856, 47.040177095637745, 12.384116910718374, 27.86888658371047, 14.685466514741323, 13.026641271071712, 32.16111552895532, 21.063994551604946, 13.015231955016985, 14.888418307686038, 46.2921656150075, 71.03380066352406, -26.902069473769178, 21.04711475245975, 22.167883820549314, 5.6043034331278605, -17.05237624143018, 11.04913411497791, 25.380409917100813, 9.330217058107069, 13.670371459773852, 42.75064644675219, 67.34826438802571, -4.287996726699824, 20.99174832235769, 40.80158734253755, 24.950288220945936, 50.949172284526696, 22.894635122882274, 1.3252637746757114, -1.6844667490942486, 12.909740689351496, 45.242036476967165, 18.888105427969993, 12.83086674843655, 17.010924209834922, 28.076163218146547, 28.49902062906004, 16.370646725182457, 22.994138516554013, 14.48793289420913, 9.454979936131176, 21.680744468503736, 24.040667104752345, 65.9688986177544, 48.35756700194177, 43.02932447468315, 30.75632046729476, 18.149423145767578, 25.520044141738484, 15.928243452466575, -0.2200204080768175, 11.140908073114664, 67.92935784466927, 104.0495064037926, 51.70035640288055, 17.793805131450668, 13.05325573385833, 15.425160505133437, 12.73703453544309, 27.657726394084094, 17.859260085913217, 18.240890441608247, 0.8226548430942217, 9.131849405508781, 49.36807705562996, 38.44689705017514, 10.780049400584648, 6.18323784010582, 15.679687394011882, 35.79032799846438, 16.63167239651906, 14.083030830218291, 49.61308737461025, 15.573302553448155, 31.925254775120216, 89.17921722791394, 5.525898543907882, 3.7341017623995896, 32.680793490540324, -17.46828846638582, 15.550388464692452, -0.0719960341707303, 36.358726177287224, 19.53648223921664, 18.526811182407403, 92.02477004908786, 9.365367821779088, 16.509273979068823, -35.17859752080039, -44.26644157256526, 50.58591679417811], "episode_lengths": [295, 799, 1117, 1117, 932, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 323, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 957, 1117, 1117, 1117, 1117, 269, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.245423842458874, "mean_inference_ms": 7.323697708240001, "mean_action_processing_ms": 0.5027254872369188, "mean_env_wait_ms": 21.608610707081088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04522585868835449, "StateBufferConnector_ms": 0.032291412353515625, "ViewRequirementAgentConnector_ms": 0.7907896041870117}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 449234, "num_agent_steps_trained": 449234, "num_env_steps_sampled": 449234, "num_env_steps_trained": 449234, "num_env_steps_sampled_this_iter": 12350, "num_env_steps_trained_this_iter": 12350, "num_env_steps_sampled_throughput_per_sec": 222.19132569743297, "num_env_steps_trained_throughput_per_sec": 222.19132569743297, "timesteps_total": 449234, "num_steps_trained_this_iter": 12350, "agent_timesteps_total": 449234, "timers": {"training_iteration_time_ms": 54901.189, "sample_time_ms": 37668.548, "load_time_ms": 1740.004, "load_throughput": 7061.017, "learn_time_ms": 14956.707, "learn_throughput": 821.451, "synch_weights_time_ms": 443.476}, "counters": {"num_env_steps_sampled": 449234, "num_env_steps_trained": 449234, "num_agent_steps_sampled": 449234, "num_agent_steps_trained": 449234}, "done": false, "episodes_total": 605, "training_iteration": 43, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-10-32", "timestamp": 1749301832, "time_this_iter_s": 55.60074591636658, "time_total_s": 2108.6952526569366, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2108.6952526569366, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 66.0030303030303, "ram_util_percent": 87.9590909090909, "gpu_util_percent0": 0.16196969696969699, "vram_util_percent0": 0.9627278645833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.550766000000004e-05, "total_loss": -0.09973844656547322, "policy_loss": -0.004528623292156096, "vf_loss": 0.08054973780348593, "vf_explained_var": 0.9141472438160254, "kl": 0.012038704846649727, "entropy": 15.444104227727774, "entropy_coeff": 0.0077538300000000015}, "model": {}, "num_grad_updates_lifetime": 16085.5, "diff_num_grad_updates_vs_sampler_policy": 244.5}}, "num_env_steps_sampled": 463228, "num_env_steps_trained": 463228, "num_agent_steps_sampled": 463228, "num_agent_steps_trained": 463228}, "sampler_results": {"episode_reward_max": 124.82880459663758, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 24.513025465781798, "episode_len_mean": 901.7, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.16111552895532, 21.063994551604946, 13.015231955016985, 14.888418307686038, 46.2921656150075, 71.03380066352406, -26.902069473769178, 21.04711475245975, 22.167883820549314, 5.6043034331278605, -17.05237624143018, 11.04913411497791, 25.380409917100813, 9.330217058107069, 13.670371459773852, 42.75064644675219, 67.34826438802571, -4.287996726699824, 20.99174832235769, 40.80158734253755, 24.950288220945936, 50.949172284526696, 22.894635122882274, 1.3252637746757114, -1.6844667490942486, 12.909740689351496, 45.242036476967165, 18.888105427969993, 12.83086674843655, 17.010924209834922, 28.076163218146547, 28.49902062906004, 16.370646725182457, 22.994138516554013, 14.48793289420913, 9.454979936131176, 21.680744468503736, 24.040667104752345, 65.9688986177544, 48.35756700194177, 43.02932447468315, 30.75632046729476, 18.149423145767578, 25.520044141738484, 15.928243452466575, -0.2200204080768175, 11.140908073114664, 67.92935784466927, 104.0495064037926, 51.70035640288055, 17.793805131450668, 13.05325573385833, 15.425160505133437, 12.73703453544309, 27.657726394084094, 17.859260085913217, 18.240890441608247, 0.8226548430942217, 9.131849405508781, 49.36807705562996, 38.44689705017514, 10.780049400584648, 6.18323784010582, 15.679687394011882, 35.79032799846438, 16.63167239651906, 14.083030830218291, 49.61308737461025, 15.573302553448155, 31.925254775120216, 89.17921722791394, 5.525898543907882, 3.7341017623995896, 32.680793490540324, -17.46828846638582, 15.550388464692452, -0.0719960341707303, 36.358726177287224, 19.53648223921664, 18.526811182407403, 92.02477004908786, 9.365367821779088, 16.509273979068823, -35.17859752080039, -44.26644157256526, 50.58591679417811, -4.366691329252505, 27.623613696772647, 13.656396542916307, 24.294050889666483, 54.46537820286917, 50.94758813550946, 43.43422701583725, 23.07233699093423, 4.589089146422915, 13.425397668943999, 124.82880459663758, -16.486107659915515, 18.075851693635407, 80.7691705509351], "episode_lengths": [1117, 295, 1117, 295, 1117, 1117, 323, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 957, 1117, 1117, 1117, 1117, 269, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.253703229422031, "mean_inference_ms": 7.332217213124121, "mean_action_processing_ms": 0.5032158994231835, "mean_env_wait_ms": 21.634412609816117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04721522331237793, "StateBufferConnector_ms": 0.035309791564941406, "ViewRequirementAgentConnector_ms": 0.7878527641296387}}, "episode_reward_max": 124.82880459663758, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 24.513025465781798, "episode_len_mean": 901.7, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.16111552895532, 21.063994551604946, 13.015231955016985, 14.888418307686038, 46.2921656150075, 71.03380066352406, -26.902069473769178, 21.04711475245975, 22.167883820549314, 5.6043034331278605, -17.05237624143018, 11.04913411497791, 25.380409917100813, 9.330217058107069, 13.670371459773852, 42.75064644675219, 67.34826438802571, -4.287996726699824, 20.99174832235769, 40.80158734253755, 24.950288220945936, 50.949172284526696, 22.894635122882274, 1.3252637746757114, -1.6844667490942486, 12.909740689351496, 45.242036476967165, 18.888105427969993, 12.83086674843655, 17.010924209834922, 28.076163218146547, 28.49902062906004, 16.370646725182457, 22.994138516554013, 14.48793289420913, 9.454979936131176, 21.680744468503736, 24.040667104752345, 65.9688986177544, 48.35756700194177, 43.02932447468315, 30.75632046729476, 18.149423145767578, 25.520044141738484, 15.928243452466575, -0.2200204080768175, 11.140908073114664, 67.92935784466927, 104.0495064037926, 51.70035640288055, 17.793805131450668, 13.05325573385833, 15.425160505133437, 12.73703453544309, 27.657726394084094, 17.859260085913217, 18.240890441608247, 0.8226548430942217, 9.131849405508781, 49.36807705562996, 38.44689705017514, 10.780049400584648, 6.18323784010582, 15.679687394011882, 35.79032799846438, 16.63167239651906, 14.083030830218291, 49.61308737461025, 15.573302553448155, 31.925254775120216, 89.17921722791394, 5.525898543907882, 3.7341017623995896, 32.680793490540324, -17.46828846638582, 15.550388464692452, -0.0719960341707303, 36.358726177287224, 19.53648223921664, 18.526811182407403, 92.02477004908786, 9.365367821779088, 16.509273979068823, -35.17859752080039, -44.26644157256526, 50.58591679417811, -4.366691329252505, 27.623613696772647, 13.656396542916307, 24.294050889666483, 54.46537820286917, 50.94758813550946, 43.43422701583725, 23.07233699093423, 4.589089146422915, 13.425397668943999, 124.82880459663758, -16.486107659915515, 18.075851693635407, 80.7691705509351], "episode_lengths": [1117, 295, 1117, 295, 1117, 1117, 323, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 957, 1117, 1117, 1117, 1117, 269, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.253703229422031, "mean_inference_ms": 7.332217213124121, "mean_action_processing_ms": 0.5032158994231835, "mean_env_wait_ms": 21.634412609816117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04721522331237793, "StateBufferConnector_ms": 0.035309791564941406, "ViewRequirementAgentConnector_ms": 0.7878527641296387}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 463228, "num_agent_steps_trained": 463228, "num_env_steps_sampled": 463228, "num_env_steps_trained": 463228, "num_env_steps_sampled_this_iter": 13994, "num_env_steps_trained_this_iter": 13994, "num_env_steps_sampled_throughput_per_sec": 233.8958647796665, "num_env_steps_trained_throughput_per_sec": 233.8958647796665, "timesteps_total": 463228, "num_steps_trained_this_iter": 13994, "agent_timesteps_total": 463228, "timers": {"training_iteration_time_ms": 55877.106, "sample_time_ms": 38148.729, "load_time_ms": 1781.883, "load_throughput": 7039.744, "learn_time_ms": 15407.007, "learn_throughput": 814.175, "synch_weights_time_ms": 445.006}, "counters": {"num_env_steps_sampled": 463228, "num_env_steps_trained": 463228, "num_agent_steps_sampled": 463228, "num_agent_steps_trained": 463228}, "done": false, "episodes_total": 619, "training_iteration": 44, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-11-32", "timestamp": 1749301892, "time_this_iter_s": 59.85589933395386, "time_total_s": 2168.5511519908905, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2168.5511519908905, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 68.69428571428571, "ram_util_percent": 88.25285714285718, "gpu_util_percent0": 0.16842857142857146, "vram_util_percent0": 0.962727864583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.536772000000002e-05, "total_loss": -0.09442992588076529, "policy_loss": 0.0010066414304178166, "vf_loss": 0.0794669097691605, "vf_explained_var": 0.8804453695362264, "kl": 0.012635949744170913, "entropy": 15.574400899626992, "entropy_coeff": 0.007683860000000001}, "model": {}, "num_grad_updates_lifetime": 16550.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 475578, "num_env_steps_trained": 475578, "num_agent_steps_sampled": 475578, "num_agent_steps_trained": 475578}, "sampler_results": {"episode_reward_max": 124.82880459663758, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 25.631865259143286, "episode_len_mean": 909.64, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.670371459773852, 42.75064644675219, 67.34826438802571, -4.287996726699824, 20.99174832235769, 40.80158734253755, 24.950288220945936, 50.949172284526696, 22.894635122882274, 1.3252637746757114, -1.6844667490942486, 12.909740689351496, 45.242036476967165, 18.888105427969993, 12.83086674843655, 17.010924209834922, 28.076163218146547, 28.49902062906004, 16.370646725182457, 22.994138516554013, 14.48793289420913, 9.454979936131176, 21.680744468503736, 24.040667104752345, 65.9688986177544, 48.35756700194177, 43.02932447468315, 30.75632046729476, 18.149423145767578, 25.520044141738484, 15.928243452466575, -0.2200204080768175, 11.140908073114664, 67.92935784466927, 104.0495064037926, 51.70035640288055, 17.793805131450668, 13.05325573385833, 15.425160505133437, 12.73703453544309, 27.657726394084094, 17.859260085913217, 18.240890441608247, 0.8226548430942217, 9.131849405508781, 49.36807705562996, 38.44689705017514, 10.780049400584648, 6.18323784010582, 15.679687394011882, 35.79032799846438, 16.63167239651906, 14.083030830218291, 49.61308737461025, 15.573302553448155, 31.925254775120216, 89.17921722791394, 5.525898543907882, 3.7341017623995896, 32.680793490540324, -17.46828846638582, 15.550388464692452, -0.0719960341707303, 36.358726177287224, 19.53648223921664, 18.526811182407403, 92.02477004908786, 9.365367821779088, 16.509273979068823, -35.17859752080039, -44.26644157256526, 50.58591679417811, -4.366691329252505, 27.623613696772647, 13.656396542916307, 24.294050889666483, 54.46537820286917, 50.94758813550946, 43.43422701583725, 23.07233699093423, 4.589089146422915, 13.425397668943999, 124.82880459663758, -16.486107659915515, 18.075851693635407, 80.7691705509351, 11.539519259992845, 35.03753290449889, 48.56264178397476, 32.76086008873677, 10.919326426968649, -0.42359602323697787, 83.82041073639283, 16.698079864414, 37.381396580693654, 6.284161155794613, 18.803655549208134, 16.366828416612034, 18.078457333031626, 25.134049261985474], "episode_lengths": [295, 1117, 1117, 957, 1117, 1117, 1117, 1117, 269, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.261459918836594, "mean_inference_ms": 7.338889449425316, "mean_action_processing_ms": 0.5035690218523967, "mean_env_wait_ms": 21.655610163882933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0452580451965332, "StateBufferConnector_ms": 0.03277873992919922, "ViewRequirementAgentConnector_ms": 0.7763922214508057}}, "episode_reward_max": 124.82880459663758, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 25.631865259143286, "episode_len_mean": 909.64, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.670371459773852, 42.75064644675219, 67.34826438802571, -4.287996726699824, 20.99174832235769, 40.80158734253755, 24.950288220945936, 50.949172284526696, 22.894635122882274, 1.3252637746757114, -1.6844667490942486, 12.909740689351496, 45.242036476967165, 18.888105427969993, 12.83086674843655, 17.010924209834922, 28.076163218146547, 28.49902062906004, 16.370646725182457, 22.994138516554013, 14.48793289420913, 9.454979936131176, 21.680744468503736, 24.040667104752345, 65.9688986177544, 48.35756700194177, 43.02932447468315, 30.75632046729476, 18.149423145767578, 25.520044141738484, 15.928243452466575, -0.2200204080768175, 11.140908073114664, 67.92935784466927, 104.0495064037926, 51.70035640288055, 17.793805131450668, 13.05325573385833, 15.425160505133437, 12.73703453544309, 27.657726394084094, 17.859260085913217, 18.240890441608247, 0.8226548430942217, 9.131849405508781, 49.36807705562996, 38.44689705017514, 10.780049400584648, 6.18323784010582, 15.679687394011882, 35.79032799846438, 16.63167239651906, 14.083030830218291, 49.61308737461025, 15.573302553448155, 31.925254775120216, 89.17921722791394, 5.525898543907882, 3.7341017623995896, 32.680793490540324, -17.46828846638582, 15.550388464692452, -0.0719960341707303, 36.358726177287224, 19.53648223921664, 18.526811182407403, 92.02477004908786, 9.365367821779088, 16.509273979068823, -35.17859752080039, -44.26644157256526, 50.58591679417811, -4.366691329252505, 27.623613696772647, 13.656396542916307, 24.294050889666483, 54.46537820286917, 50.94758813550946, 43.43422701583725, 23.07233699093423, 4.589089146422915, 13.425397668943999, 124.82880459663758, -16.486107659915515, 18.075851693635407, 80.7691705509351, 11.539519259992845, 35.03753290449889, 48.56264178397476, 32.76086008873677, 10.919326426968649, -0.42359602323697787, 83.82041073639283, 16.698079864414, 37.381396580693654, 6.284161155794613, 18.803655549208134, 16.366828416612034, 18.078457333031626, 25.134049261985474], "episode_lengths": [295, 1117, 1117, 957, 1117, 1117, 1117, 1117, 269, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.261459918836594, "mean_inference_ms": 7.338889449425316, "mean_action_processing_ms": 0.5035690218523967, "mean_env_wait_ms": 21.655610163882933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0452580451965332, "StateBufferConnector_ms": 0.03277873992919922, "ViewRequirementAgentConnector_ms": 0.7763922214508057}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 475578, "num_agent_steps_trained": 475578, "num_env_steps_sampled": 475578, "num_env_steps_trained": 475578, "num_env_steps_sampled_this_iter": 12350, "num_env_steps_trained_this_iter": 12350, "num_env_steps_sampled_throughput_per_sec": 228.09879665941182, "num_env_steps_trained_throughput_per_sec": 228.09879665941182, "timesteps_total": 475578, "num_steps_trained_this_iter": 12350, "agent_timesteps_total": 475578, "timers": {"training_iteration_time_ms": 56345.281, "sample_time_ms": 38321.914, "load_time_ms": 1840.855, "load_throughput": 6896.199, "learn_time_ms": 15641.09, "learn_throughput": 811.638, "synch_weights_time_ms": 444.842}, "counters": {"num_env_steps_sampled": 475578, "num_env_steps_trained": 475578, "num_agent_steps_sampled": 475578, "num_agent_steps_trained": 475578}, "done": false, "episodes_total": 633, "training_iteration": 45, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-12-26", "timestamp": 1749301946, "time_this_iter_s": 54.15247178077698, "time_total_s": 2222.7036237716675, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2222.7036237716675, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 65.9140625, "ram_util_percent": 86.75312500000001, "gpu_util_percent0": 0.1571875, "vram_util_percent0": 0.9627278645833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.524421999999997e-05, "total_loss": -0.11472953652520096, "policy_loss": -0.019221794199655983, "vf_loss": 0.07428034499469327, "vf_explained_var": 0.9124973119758978, "kl": 0.013163884893690077, "entropy": 15.507938640873606, "entropy_coeff": 0.0076221100000000005}, "model": {}, "num_grad_updates_lifetime": 16975.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 487106, "num_env_steps_trained": 487106, "num_agent_steps_sampled": 487106, "num_agent_steps_trained": 487106}, "sampler_results": {"episode_reward_max": 124.82880459663758, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 25.93131808036687, "episode_len_mean": 895.06, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.83086674843655, 17.010924209834922, 28.076163218146547, 28.49902062906004, 16.370646725182457, 22.994138516554013, 14.48793289420913, 9.454979936131176, 21.680744468503736, 24.040667104752345, 65.9688986177544, 48.35756700194177, 43.02932447468315, 30.75632046729476, 18.149423145767578, 25.520044141738484, 15.928243452466575, -0.2200204080768175, 11.140908073114664, 67.92935784466927, 104.0495064037926, 51.70035640288055, 17.793805131450668, 13.05325573385833, 15.425160505133437, 12.73703453544309, 27.657726394084094, 17.859260085913217, 18.240890441608247, 0.8226548430942217, 9.131849405508781, 49.36807705562996, 38.44689705017514, 10.780049400584648, 6.18323784010582, 15.679687394011882, 35.79032799846438, 16.63167239651906, 14.083030830218291, 49.61308737461025, 15.573302553448155, 31.925254775120216, 89.17921722791394, 5.525898543907882, 3.7341017623995896, 32.680793490540324, -17.46828846638582, 15.550388464692452, -0.0719960341707303, 36.358726177287224, 19.53648223921664, 18.526811182407403, 92.02477004908786, 9.365367821779088, 16.509273979068823, -35.17859752080039, -44.26644157256526, 50.58591679417811, -4.366691329252505, 27.623613696772647, 13.656396542916307, 24.294050889666483, 54.46537820286917, 50.94758813550946, 43.43422701583725, 23.07233699093423, 4.589089146422915, 13.425397668943999, 124.82880459663758, -16.486107659915515, 18.075851693635407, 80.7691705509351, 11.539519259992845, 35.03753290449889, 48.56264178397476, 32.76086008873677, 10.919326426968649, -0.42359602323697787, 83.82041073639283, 16.698079864414, 37.381396580693654, 6.284161155794613, 18.803655549208134, 16.366828416612034, 18.078457333031626, 25.134049261985474, 26.82919571596199, 46.14814363540769, 10.805093447857514, 13.737097380735687, 19.143348935068797, 23.035771720171915, 25.490663687806478, 17.153771937281494, -24.720449848593486, 10.999572669849135, 103.89425855059707, 66.61187005803163, 19.270007510173308, 28.296333202981494], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2681892832522825, "mean_inference_ms": 7.344125578880493, "mean_action_processing_ms": 0.5038085986861602, "mean_env_wait_ms": 21.672203065620607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04644417762756348, "StateBufferConnector_ms": 0.03276252746582031, "ViewRequirementAgentConnector_ms": 0.8265838623046875}}, "episode_reward_max": 124.82880459663758, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 25.93131808036687, "episode_len_mean": 895.06, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.83086674843655, 17.010924209834922, 28.076163218146547, 28.49902062906004, 16.370646725182457, 22.994138516554013, 14.48793289420913, 9.454979936131176, 21.680744468503736, 24.040667104752345, 65.9688986177544, 48.35756700194177, 43.02932447468315, 30.75632046729476, 18.149423145767578, 25.520044141738484, 15.928243452466575, -0.2200204080768175, 11.140908073114664, 67.92935784466927, 104.0495064037926, 51.70035640288055, 17.793805131450668, 13.05325573385833, 15.425160505133437, 12.73703453544309, 27.657726394084094, 17.859260085913217, 18.240890441608247, 0.8226548430942217, 9.131849405508781, 49.36807705562996, 38.44689705017514, 10.780049400584648, 6.18323784010582, 15.679687394011882, 35.79032799846438, 16.63167239651906, 14.083030830218291, 49.61308737461025, 15.573302553448155, 31.925254775120216, 89.17921722791394, 5.525898543907882, 3.7341017623995896, 32.680793490540324, -17.46828846638582, 15.550388464692452, -0.0719960341707303, 36.358726177287224, 19.53648223921664, 18.526811182407403, 92.02477004908786, 9.365367821779088, 16.509273979068823, -35.17859752080039, -44.26644157256526, 50.58591679417811, -4.366691329252505, 27.623613696772647, 13.656396542916307, 24.294050889666483, 54.46537820286917, 50.94758813550946, 43.43422701583725, 23.07233699093423, 4.589089146422915, 13.425397668943999, 124.82880459663758, -16.486107659915515, 18.075851693635407, 80.7691705509351, 11.539519259992845, 35.03753290449889, 48.56264178397476, 32.76086008873677, 10.919326426968649, -0.42359602323697787, 83.82041073639283, 16.698079864414, 37.381396580693654, 6.284161155794613, 18.803655549208134, 16.366828416612034, 18.078457333031626, 25.134049261985474, 26.82919571596199, 46.14814363540769, 10.805093447857514, 13.737097380735687, 19.143348935068797, 23.035771720171915, 25.490663687806478, 17.153771937281494, -24.720449848593486, 10.999572669849135, 103.89425855059707, 66.61187005803163, 19.270007510173308, 28.296333202981494], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2681892832522825, "mean_inference_ms": 7.344125578880493, "mean_action_processing_ms": 0.5038085986861602, "mean_env_wait_ms": 21.672203065620607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04644417762756348, "StateBufferConnector_ms": 0.03276252746582031, "ViewRequirementAgentConnector_ms": 0.8265838623046875}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 487106, "num_agent_steps_trained": 487106, "num_env_steps_sampled": 487106, "num_env_steps_trained": 487106, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 216.71503840343698, "num_env_steps_trained_throughput_per_sec": 216.71503840343698, "timesteps_total": 487106, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 487106, "timers": {"training_iteration_time_ms": 56151.256, "sample_time_ms": 38184.571, "load_time_ms": 1808.861, "load_throughput": 6990.311, "learn_time_ms": 15624.549, "learn_throughput": 809.271, "synch_weights_time_ms": 439.531}, "counters": {"num_env_steps_sampled": 487106, "num_env_steps_trained": 487106, "num_agent_steps_sampled": 487106, "num_agent_steps_trained": 487106}, "done": false, "episodes_total": 647, "training_iteration": 46, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-13-20", "timestamp": 1749302000, "time_this_iter_s": 53.216277837753296, "time_total_s": 2275.919901609421, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2275.919901609421, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 62.50634920634922, "ram_util_percent": 86.58095238095235, "gpu_util_percent0": 0.1741269841269841, "vram_util_percent0": 0.9627278645833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.512894000000001e-05, "total_loss": -0.10593897421239512, "policy_loss": -0.011517025969877113, "vf_loss": 0.06989982867295422, "vf_explained_var": 0.9128017765719716, "kl": 0.013295669947388365, "entropy": 15.30938525781399, "entropy_coeff": 0.007564470000000003}, "model": {}, "num_grad_updates_lifetime": 17385.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 498634, "num_env_steps_trained": 498634, "num_agent_steps_sampled": 498634, "num_agent_steps_trained": 498634}, "sampler_results": {"episode_reward_max": 124.82880459663758, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 28.030426446847482, "episode_len_mean": 878.62, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.149423145767578, 25.520044141738484, 15.928243452466575, -0.2200204080768175, 11.140908073114664, 67.92935784466927, 104.0495064037926, 51.70035640288055, 17.793805131450668, 13.05325573385833, 15.425160505133437, 12.73703453544309, 27.657726394084094, 17.859260085913217, 18.240890441608247, 0.8226548430942217, 9.131849405508781, 49.36807705562996, 38.44689705017514, 10.780049400584648, 6.18323784010582, 15.679687394011882, 35.79032799846438, 16.63167239651906, 14.083030830218291, 49.61308737461025, 15.573302553448155, 31.925254775120216, 89.17921722791394, 5.525898543907882, 3.7341017623995896, 32.680793490540324, -17.46828846638582, 15.550388464692452, -0.0719960341707303, 36.358726177287224, 19.53648223921664, 18.526811182407403, 92.02477004908786, 9.365367821779088, 16.509273979068823, -35.17859752080039, -44.26644157256526, 50.58591679417811, -4.366691329252505, 27.623613696772647, 13.656396542916307, 24.294050889666483, 54.46537820286917, 50.94758813550946, 43.43422701583725, 23.07233699093423, 4.589089146422915, 13.425397668943999, 124.82880459663758, -16.486107659915515, 18.075851693635407, 80.7691705509351, 11.539519259992845, 35.03753290449889, 48.56264178397476, 32.76086008873677, 10.919326426968649, -0.42359602323697787, 83.82041073639283, 16.698079864414, 37.381396580693654, 6.284161155794613, 18.803655549208134, 16.366828416612034, 18.078457333031626, 25.134049261985474, 26.82919571596199, 46.14814363540769, 10.805093447857514, 13.737097380735687, 19.143348935068797, 23.035771720171915, 25.490663687806478, 17.153771937281494, -24.720449848593486, 10.999572669849135, 103.89425855059707, 66.61187005803163, 19.270007510173308, 28.296333202981494, 71.23782221597152, 70.27678959652877, 31.309545939708258, 44.82101338329735, 13.89083287446727, 30.241391859183455, 21.09955883562739, 121.62733499721345, 19.507200124447277, 29.54689048689749, 14.925377652843409, 112.47868687605767, 18.122631418105403, -5.616044599802387], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2738116672950976, "mean_inference_ms": 7.34840664394494, "mean_action_processing_ms": 0.5040178451191348, "mean_env_wait_ms": 21.68448613368379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04438304901123047, "StateBufferConnector_ms": 0.02781534194946289, "ViewRequirementAgentConnector_ms": 0.8365151882171631}}, "episode_reward_max": 124.82880459663758, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 28.030426446847482, "episode_len_mean": 878.62, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.149423145767578, 25.520044141738484, 15.928243452466575, -0.2200204080768175, 11.140908073114664, 67.92935784466927, 104.0495064037926, 51.70035640288055, 17.793805131450668, 13.05325573385833, 15.425160505133437, 12.73703453544309, 27.657726394084094, 17.859260085913217, 18.240890441608247, 0.8226548430942217, 9.131849405508781, 49.36807705562996, 38.44689705017514, 10.780049400584648, 6.18323784010582, 15.679687394011882, 35.79032799846438, 16.63167239651906, 14.083030830218291, 49.61308737461025, 15.573302553448155, 31.925254775120216, 89.17921722791394, 5.525898543907882, 3.7341017623995896, 32.680793490540324, -17.46828846638582, 15.550388464692452, -0.0719960341707303, 36.358726177287224, 19.53648223921664, 18.526811182407403, 92.02477004908786, 9.365367821779088, 16.509273979068823, -35.17859752080039, -44.26644157256526, 50.58591679417811, -4.366691329252505, 27.623613696772647, 13.656396542916307, 24.294050889666483, 54.46537820286917, 50.94758813550946, 43.43422701583725, 23.07233699093423, 4.589089146422915, 13.425397668943999, 124.82880459663758, -16.486107659915515, 18.075851693635407, 80.7691705509351, 11.539519259992845, 35.03753290449889, 48.56264178397476, 32.76086008873677, 10.919326426968649, -0.42359602323697787, 83.82041073639283, 16.698079864414, 37.381396580693654, 6.284161155794613, 18.803655549208134, 16.366828416612034, 18.078457333031626, 25.134049261985474, 26.82919571596199, 46.14814363540769, 10.805093447857514, 13.737097380735687, 19.143348935068797, 23.035771720171915, 25.490663687806478, 17.153771937281494, -24.720449848593486, 10.999572669849135, 103.89425855059707, 66.61187005803163, 19.270007510173308, 28.296333202981494, 71.23782221597152, 70.27678959652877, 31.309545939708258, 44.82101338329735, 13.89083287446727, 30.241391859183455, 21.09955883562739, 121.62733499721345, 19.507200124447277, 29.54689048689749, 14.925377652843409, 112.47868687605767, 18.122631418105403, -5.616044599802387], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2738116672950976, "mean_inference_ms": 7.34840664394494, "mean_action_processing_ms": 0.5040178451191348, "mean_env_wait_ms": 21.68448613368379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04438304901123047, "StateBufferConnector_ms": 0.02781534194946289, "ViewRequirementAgentConnector_ms": 0.8365151882171631}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 498634, "num_agent_steps_trained": 498634, "num_env_steps_sampled": 498634, "num_env_steps_trained": 498634, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 222.6427018534076, "num_env_steps_trained_throughput_per_sec": 222.6427018534076, "timesteps_total": 498634, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 498634, "timers": {"training_iteration_time_ms": 54990.688, "sample_time_ms": 37480.318, "load_time_ms": 1716.449, "load_throughput": 7233.773, "learn_time_ms": 15256.17, "learn_throughput": 813.861, "synch_weights_time_ms": 446.254}, "counters": {"num_env_steps_sampled": 498634, "num_env_steps_trained": 498634, "num_agent_steps_sampled": 498634, "num_agent_steps_trained": 498634}, "done": false, "episodes_total": 661, "training_iteration": 47, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-14-12", "timestamp": 1749302052, "time_this_iter_s": 51.80003547668457, "time_total_s": 2327.7199370861053, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2327.7199370861053, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 62.43387096774193, "ram_util_percent": 86.42419354838708, "gpu_util_percent0": 0.15629032258064515, "vram_util_percent0": 0.9627278645833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.501366000000003e-05, "total_loss": -0.12088139517619176, "policy_loss": -0.024937381608748532, "vf_loss": 0.06445232867560488, "vf_explained_var": 0.9088390361755452, "kl": 0.013740387406327732, "entropy": 15.413843195489113, "entropy_coeff": 0.007506830000000002}, "model": {}, "num_grad_updates_lifetime": 17825.5, "diff_num_grad_updates_vs_sampler_policy": 234.5}}, "num_env_steps_sampled": 511806, "num_env_steps_trained": 511806, "num_agent_steps_sampled": 511806, "num_agent_steps_trained": 511806}, "sampler_results": {"episode_reward_max": 124.82880459663758, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 30.09023332987684, "episode_len_mean": 886.84, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.240890441608247, 0.8226548430942217, 9.131849405508781, 49.36807705562996, 38.44689705017514, 10.780049400584648, 6.18323784010582, 15.679687394011882, 35.79032799846438, 16.63167239651906, 14.083030830218291, 49.61308737461025, 15.573302553448155, 31.925254775120216, 89.17921722791394, 5.525898543907882, 3.7341017623995896, 32.680793490540324, -17.46828846638582, 15.550388464692452, -0.0719960341707303, 36.358726177287224, 19.53648223921664, 18.526811182407403, 92.02477004908786, 9.365367821779088, 16.509273979068823, -35.17859752080039, -44.26644157256526, 50.58591679417811, -4.366691329252505, 27.623613696772647, 13.656396542916307, 24.294050889666483, 54.46537820286917, 50.94758813550946, 43.43422701583725, 23.07233699093423, 4.589089146422915, 13.425397668943999, 124.82880459663758, -16.486107659915515, 18.075851693635407, 80.7691705509351, 11.539519259992845, 35.03753290449889, 48.56264178397476, 32.76086008873677, 10.919326426968649, -0.42359602323697787, 83.82041073639283, 16.698079864414, 37.381396580693654, 6.284161155794613, 18.803655549208134, 16.366828416612034, 18.078457333031626, 25.134049261985474, 26.82919571596199, 46.14814363540769, 10.805093447857514, 13.737097380735687, 19.143348935068797, 23.035771720171915, 25.490663687806478, 17.153771937281494, -24.720449848593486, 10.999572669849135, 103.89425855059707, 66.61187005803163, 19.270007510173308, 28.296333202981494, 71.23782221597152, 70.27678959652877, 31.309545939708258, 44.82101338329735, 13.89083287446727, 30.241391859183455, 21.09955883562739, 121.62733499721345, 19.507200124447277, 29.54689048689749, 14.925377652843409, 112.47868687605767, 18.122631418105403, -5.616044599802387, 15.830373983566982, 96.48703400323079, 50.116728346095, 18.16590751885936, 7.151267165975617, 67.87996692973157, 100.708255342965, 15.254565110033635, 4.7926038033124465, 15.710476376135677, 108.75343973019218, 27.76081663659646, 34.50616636032212, 41.587148438154664], "episode_lengths": [1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2790436281976363, "mean_inference_ms": 7.353086923046265, "mean_action_processing_ms": 0.5042231491130931, "mean_env_wait_ms": 21.697559480895844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0384678840637207, "StateBufferConnector_ms": 0.02803516387939453, "ViewRequirementAgentConnector_ms": 0.8405561447143555}}, "episode_reward_max": 124.82880459663758, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 30.09023332987684, "episode_len_mean": 886.84, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.240890441608247, 0.8226548430942217, 9.131849405508781, 49.36807705562996, 38.44689705017514, 10.780049400584648, 6.18323784010582, 15.679687394011882, 35.79032799846438, 16.63167239651906, 14.083030830218291, 49.61308737461025, 15.573302553448155, 31.925254775120216, 89.17921722791394, 5.525898543907882, 3.7341017623995896, 32.680793490540324, -17.46828846638582, 15.550388464692452, -0.0719960341707303, 36.358726177287224, 19.53648223921664, 18.526811182407403, 92.02477004908786, 9.365367821779088, 16.509273979068823, -35.17859752080039, -44.26644157256526, 50.58591679417811, -4.366691329252505, 27.623613696772647, 13.656396542916307, 24.294050889666483, 54.46537820286917, 50.94758813550946, 43.43422701583725, 23.07233699093423, 4.589089146422915, 13.425397668943999, 124.82880459663758, -16.486107659915515, 18.075851693635407, 80.7691705509351, 11.539519259992845, 35.03753290449889, 48.56264178397476, 32.76086008873677, 10.919326426968649, -0.42359602323697787, 83.82041073639283, 16.698079864414, 37.381396580693654, 6.284161155794613, 18.803655549208134, 16.366828416612034, 18.078457333031626, 25.134049261985474, 26.82919571596199, 46.14814363540769, 10.805093447857514, 13.737097380735687, 19.143348935068797, 23.035771720171915, 25.490663687806478, 17.153771937281494, -24.720449848593486, 10.999572669849135, 103.89425855059707, 66.61187005803163, 19.270007510173308, 28.296333202981494, 71.23782221597152, 70.27678959652877, 31.309545939708258, 44.82101338329735, 13.89083287446727, 30.241391859183455, 21.09955883562739, 121.62733499721345, 19.507200124447277, 29.54689048689749, 14.925377652843409, 112.47868687605767, 18.122631418105403, -5.616044599802387, 15.830373983566982, 96.48703400323079, 50.116728346095, 18.16590751885936, 7.151267165975617, 67.87996692973157, 100.708255342965, 15.254565110033635, 4.7926038033124465, 15.710476376135677, 108.75343973019218, 27.76081663659646, 34.50616636032212, 41.587148438154664], "episode_lengths": [1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2790436281976363, "mean_inference_ms": 7.353086923046265, "mean_action_processing_ms": 0.5042231491130931, "mean_env_wait_ms": 21.697559480895844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0384678840637207, "StateBufferConnector_ms": 0.02803516387939453, "ViewRequirementAgentConnector_ms": 0.8405561447143555}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 511806, "num_agent_steps_trained": 511806, "num_env_steps_sampled": 511806, "num_env_steps_trained": 511806, "num_env_steps_sampled_this_iter": 13172, "num_env_steps_trained_this_iter": 13172, "num_env_steps_sampled_throughput_per_sec": 221.78204859372636, "num_env_steps_trained_throughput_per_sec": 221.78204859372636, "timesteps_total": 511806, "num_steps_trained_this_iter": 13172, "agent_timesteps_total": 511806, "timers": {"training_iteration_time_ms": 55551.697, "sample_time_ms": 37724.717, "load_time_ms": 1725.466, "load_throughput": 7289.624, "learn_time_ms": 15560.343, "learn_throughput": 808.337, "synch_weights_time_ms": 444.177}, "counters": {"num_env_steps_sampled": 511806, "num_env_steps_trained": 511806, "num_agent_steps_sampled": 511806, "num_agent_steps_trained": 511806}, "done": false, "episodes_total": 675, "training_iteration": 48, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-15-11", "timestamp": 1749302111, "time_this_iter_s": 59.409637689590454, "time_total_s": 2387.129574775696, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2387.129574775696, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 65.82, "ram_util_percent": 86.4457142857143, "gpu_util_percent0": 0.18642857142857144, "vram_util_percent0": 0.962727864583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.488194e-05, "total_loss": -0.12181869696952806, "policy_loss": -0.0253274558202886, "vf_loss": 0.06610852370447502, "vf_explained_var": 0.9179381922977726, "kl": 0.012881748227931897, "entropy": 15.686981133716863, "entropy_coeff": 0.007440970000000001}, "model": {}, "num_grad_updates_lifetime": 18265.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 523334, "num_env_steps_trained": 523334, "num_agent_steps_sampled": 523334, "num_agent_steps_trained": 523334}, "sampler_results": {"episode_reward_max": 124.82880459663758, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 31.216827392543177, "episode_len_mean": 886.84, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.17921722791394, 5.525898543907882, 3.7341017623995896, 32.680793490540324, -17.46828846638582, 15.550388464692452, -0.0719960341707303, 36.358726177287224, 19.53648223921664, 18.526811182407403, 92.02477004908786, 9.365367821779088, 16.509273979068823, -35.17859752080039, -44.26644157256526, 50.58591679417811, -4.366691329252505, 27.623613696772647, 13.656396542916307, 24.294050889666483, 54.46537820286917, 50.94758813550946, 43.43422701583725, 23.07233699093423, 4.589089146422915, 13.425397668943999, 124.82880459663758, -16.486107659915515, 18.075851693635407, 80.7691705509351, 11.539519259992845, 35.03753290449889, 48.56264178397476, 32.76086008873677, 10.919326426968649, -0.42359602323697787, 83.82041073639283, 16.698079864414, 37.381396580693654, 6.284161155794613, 18.803655549208134, 16.366828416612034, 18.078457333031626, 25.134049261985474, 26.82919571596199, 46.14814363540769, 10.805093447857514, 13.737097380735687, 19.143348935068797, 23.035771720171915, 25.490663687806478, 17.153771937281494, -24.720449848593486, 10.999572669849135, 103.89425855059707, 66.61187005803163, 19.270007510173308, 28.296333202981494, 71.23782221597152, 70.27678959652877, 31.309545939708258, 44.82101338329735, 13.89083287446727, 30.241391859183455, 21.09955883562739, 121.62733499721345, 19.507200124447277, 29.54689048689749, 14.925377652843409, 112.47868687605767, 18.122631418105403, -5.616044599802387, 15.830373983566982, 96.48703400323079, 50.116728346095, 18.16590751885936, 7.151267165975617, 67.87996692973157, 100.708255342965, 15.254565110033635, 4.7926038033124465, 15.710476376135677, 108.75343973019218, 27.76081663659646, 34.50616636032212, 41.587148438154664, 4.2214410191778455, 35.845886902760405, 5.922092653354798, -1.4511790907300033, 71.6385047383837, 19.219280161857974, 17.27823102866951, 18.916247804958072, 12.717431717620867, 85.56384210344116, 13.770194588005962, 41.32544932984607, 17.555433810097025, 82.40656885828923], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.284210115083491, "mean_inference_ms": 7.357785322897502, "mean_action_processing_ms": 0.5044686583085851, "mean_env_wait_ms": 21.710825821275943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029844999313354492, "StateBufferConnector_ms": 0.026017427444458008, "ViewRequirementAgentConnector_ms": 0.8592612743377686}}, "episode_reward_max": 124.82880459663758, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 31.216827392543177, "episode_len_mean": 886.84, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89.17921722791394, 5.525898543907882, 3.7341017623995896, 32.680793490540324, -17.46828846638582, 15.550388464692452, -0.0719960341707303, 36.358726177287224, 19.53648223921664, 18.526811182407403, 92.02477004908786, 9.365367821779088, 16.509273979068823, -35.17859752080039, -44.26644157256526, 50.58591679417811, -4.366691329252505, 27.623613696772647, 13.656396542916307, 24.294050889666483, 54.46537820286917, 50.94758813550946, 43.43422701583725, 23.07233699093423, 4.589089146422915, 13.425397668943999, 124.82880459663758, -16.486107659915515, 18.075851693635407, 80.7691705509351, 11.539519259992845, 35.03753290449889, 48.56264178397476, 32.76086008873677, 10.919326426968649, -0.42359602323697787, 83.82041073639283, 16.698079864414, 37.381396580693654, 6.284161155794613, 18.803655549208134, 16.366828416612034, 18.078457333031626, 25.134049261985474, 26.82919571596199, 46.14814363540769, 10.805093447857514, 13.737097380735687, 19.143348935068797, 23.035771720171915, 25.490663687806478, 17.153771937281494, -24.720449848593486, 10.999572669849135, 103.89425855059707, 66.61187005803163, 19.270007510173308, 28.296333202981494, 71.23782221597152, 70.27678959652877, 31.309545939708258, 44.82101338329735, 13.89083287446727, 30.241391859183455, 21.09955883562739, 121.62733499721345, 19.507200124447277, 29.54689048689749, 14.925377652843409, 112.47868687605767, 18.122631418105403, -5.616044599802387, 15.830373983566982, 96.48703400323079, 50.116728346095, 18.16590751885936, 7.151267165975617, 67.87996692973157, 100.708255342965, 15.254565110033635, 4.7926038033124465, 15.710476376135677, 108.75343973019218, 27.76081663659646, 34.50616636032212, 41.587148438154664, 4.2214410191778455, 35.845886902760405, 5.922092653354798, -1.4511790907300033, 71.6385047383837, 19.219280161857974, 17.27823102866951, 18.916247804958072, 12.717431717620867, 85.56384210344116, 13.770194588005962, 41.32544932984607, 17.555433810097025, 82.40656885828923], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.284210115083491, "mean_inference_ms": 7.357785322897502, "mean_action_processing_ms": 0.5044686583085851, "mean_env_wait_ms": 21.710825821275943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029844999313354492, "StateBufferConnector_ms": 0.026017427444458008, "ViewRequirementAgentConnector_ms": 0.8592612743377686}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 523334, "num_agent_steps_trained": 523334, "num_env_steps_sampled": 523334, "num_env_steps_trained": 523334, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 216.2262578577265, "num_env_steps_trained_throughput_per_sec": 216.2262578577265, "timesteps_total": 523334, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 523334, "timers": {"training_iteration_time_ms": 55176.633, "sample_time_ms": 37399.779, "load_time_ms": 1682.474, "load_throughput": 7340.38, "learn_time_ms": 15521.006, "learn_throughput": 795.696, "synch_weights_time_ms": 477.674}, "counters": {"num_env_steps_sampled": 523334, "num_env_steps_trained": 523334, "num_agent_steps_sampled": 523334, "num_agent_steps_trained": 523334}, "done": false, "episodes_total": 689, "training_iteration": 49, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-16-05", "timestamp": 1749302165, "time_this_iter_s": 53.3375244140625, "time_total_s": 2440.4670991897583, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2440.4670991897583, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 62.89206349206349, "ram_util_percent": 86.10476190476193, "gpu_util_percent0": 0.16761904761904764, "vram_util_percent0": 0.9627278645833336}}
{"evaluation": {"sampler_results": {"episode_reward_max": -9.558166503900287, "episode_reward_min": -11.549935415817158, "episode_reward_mean": -10.682403233058313, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.300430731014515, -11.373561468332815, -11.549935415817158, -10.629922046226788, -9.558166503900287], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7248788778482897, "mean_inference_ms": 3.7410404339636756, "mean_action_processing_ms": 0.3052850154088233, "mean_env_wait_ms": 12.435417749445948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.17251968383789062}}, "episode_reward_max": -9.558166503900287, "episode_reward_min": -11.549935415817158, "episode_reward_mean": -10.682403233058313, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.300430731014515, -11.373561468332815, -11.549935415817158, -10.629922046226788, -9.558166503900287], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7248788778482897, "mean_inference_ms": 3.7410404339636756, "mean_action_processing_ms": 0.3052850154088233, "mean_env_wait_ms": 12.435417749445948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.17251968383789062}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.476666e-05, "total_loss": -0.10926204298497973, "policy_loss": -0.01567998297410313, "vf_loss": 0.06672647526805721, "vf_explained_var": 0.9204925535655604, "kl": 0.012841692545682635, "entropy": 15.440365391242795, "entropy_coeff": 0.007383329999999998}, "model": {}, "num_grad_updates_lifetime": 18675.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 534862, "num_env_steps_trained": 534862, "num_agent_steps_sampled": 534862, "num_agent_steps_trained": 534862}, "sampler_results": {"episode_reward_max": 124.82880459663758, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 33.8224030575007, "episode_len_mean": 878.62, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.26644157256526, 50.58591679417811, -4.366691329252505, 27.623613696772647, 13.656396542916307, 24.294050889666483, 54.46537820286917, 50.94758813550946, 43.43422701583725, 23.07233699093423, 4.589089146422915, 13.425397668943999, 124.82880459663758, -16.486107659915515, 18.075851693635407, 80.7691705509351, 11.539519259992845, 35.03753290449889, 48.56264178397476, 32.76086008873677, 10.919326426968649, -0.42359602323697787, 83.82041073639283, 16.698079864414, 37.381396580693654, 6.284161155794613, 18.803655549208134, 16.366828416612034, 18.078457333031626, 25.134049261985474, 26.82919571596199, 46.14814363540769, 10.805093447857514, 13.737097380735687, 19.143348935068797, 23.035771720171915, 25.490663687806478, 17.153771937281494, -24.720449848593486, 10.999572669849135, 103.89425855059707, 66.61187005803163, 19.270007510173308, 28.296333202981494, 71.23782221597152, 70.27678959652877, 31.309545939708258, 44.82101338329735, 13.89083287446727, 30.241391859183455, 21.09955883562739, 121.62733499721345, 19.507200124447277, 29.54689048689749, 14.925377652843409, 112.47868687605767, 18.122631418105403, -5.616044599802387, 15.830373983566982, 96.48703400323079, 50.116728346095, 18.16590751885936, 7.151267165975617, 67.87996692973157, 100.708255342965, 15.254565110033635, 4.7926038033124465, 15.710476376135677, 108.75343973019218, 27.76081663659646, 34.50616636032212, 41.587148438154664, 4.2214410191778455, 35.845886902760405, 5.922092653354798, -1.4511790907300033, 71.6385047383837, 19.219280161857974, 17.27823102866951, 18.916247804958072, 12.717431717620867, 85.56384210344116, 13.770194588005962, 41.32544932984607, 17.555433810097025, 82.40656885828923, 8.719695795679648, 19.57051798565345, 18.86462764381186, 72.65759848771123, 13.937020995948542, 39.40813014507018, 17.519759745233614, 15.810494282122214, 78.99863830780873, 38.606298354491344, 67.72459782963382, 61.00402290315448, 16.49308847900565, 77.51602445737167], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2889856312435692, "mean_inference_ms": 7.361259566299425, "mean_action_processing_ms": 0.50462095091779, "mean_env_wait_ms": 21.720328621047006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028841733932495117, "StateBufferConnector_ms": 0.02001333236694336, "ViewRequirementAgentConnector_ms": 0.842426061630249}}, "episode_reward_max": 124.82880459663758, "episode_reward_min": -44.26644157256526, "episode_reward_mean": 33.8224030575007, "episode_len_mean": 878.62, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-44.26644157256526, 50.58591679417811, -4.366691329252505, 27.623613696772647, 13.656396542916307, 24.294050889666483, 54.46537820286917, 50.94758813550946, 43.43422701583725, 23.07233699093423, 4.589089146422915, 13.425397668943999, 124.82880459663758, -16.486107659915515, 18.075851693635407, 80.7691705509351, 11.539519259992845, 35.03753290449889, 48.56264178397476, 32.76086008873677, 10.919326426968649, -0.42359602323697787, 83.82041073639283, 16.698079864414, 37.381396580693654, 6.284161155794613, 18.803655549208134, 16.366828416612034, 18.078457333031626, 25.134049261985474, 26.82919571596199, 46.14814363540769, 10.805093447857514, 13.737097380735687, 19.143348935068797, 23.035771720171915, 25.490663687806478, 17.153771937281494, -24.720449848593486, 10.999572669849135, 103.89425855059707, 66.61187005803163, 19.270007510173308, 28.296333202981494, 71.23782221597152, 70.27678959652877, 31.309545939708258, 44.82101338329735, 13.89083287446727, 30.241391859183455, 21.09955883562739, 121.62733499721345, 19.507200124447277, 29.54689048689749, 14.925377652843409, 112.47868687605767, 18.122631418105403, -5.616044599802387, 15.830373983566982, 96.48703400323079, 50.116728346095, 18.16590751885936, 7.151267165975617, 67.87996692973157, 100.708255342965, 15.254565110033635, 4.7926038033124465, 15.710476376135677, 108.75343973019218, 27.76081663659646, 34.50616636032212, 41.587148438154664, 4.2214410191778455, 35.845886902760405, 5.922092653354798, -1.4511790907300033, 71.6385047383837, 19.219280161857974, 17.27823102866951, 18.916247804958072, 12.717431717620867, 85.56384210344116, 13.770194588005962, 41.32544932984607, 17.555433810097025, 82.40656885828923, 8.719695795679648, 19.57051798565345, 18.86462764381186, 72.65759848771123, 13.937020995948542, 39.40813014507018, 17.519759745233614, 15.810494282122214, 78.99863830780873, 38.606298354491344, 67.72459782963382, 61.00402290315448, 16.49308847900565, 77.51602445737167], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2889856312435692, "mean_inference_ms": 7.361259566299425, "mean_action_processing_ms": 0.50462095091779, "mean_env_wait_ms": 21.720328621047006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028841733932495117, "StateBufferConnector_ms": 0.02001333236694336, "ViewRequirementAgentConnector_ms": 0.842426061630249}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 534862, "num_agent_steps_trained": 534862, "num_env_steps_sampled": 534862, "num_env_steps_trained": 534862, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 223.01973046873388, "num_env_steps_trained_throughput_per_sec": 223.01973046873388, "timesteps_total": 534862, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 534862, "timers": {"training_iteration_time_ms": 54704.824, "sample_time_ms": 37130.004, "load_time_ms": 1640.876, "load_throughput": 7426.275, "learn_time_ms": 15364.246, "learn_throughput": 793.114, "synch_weights_time_ms": 474.242}, "counters": {"num_env_steps_sampled": 534862, "num_env_steps_trained": 534862, "num_agent_steps_sampled": 534862, "num_agent_steps_trained": 534862}, "done": false, "episodes_total": 703, "training_iteration": 50, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-17-14", "timestamp": 1749302234, "time_this_iter_s": 69.00605511665344, "time_total_s": 2509.4731543064117, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2509.4731543064117, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 51.533734939759036, "ram_util_percent": 85.84819277108433, "gpu_util_percent0": 0.12228915662650601, "vram_util_percent0": 0.9627278645833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.465138000000003e-05, "total_loss": -0.10750199119446482, "policy_loss": -0.017493729395890965, "vf_loss": 0.07575834638022996, "vf_explained_var": 0.9189197848451899, "kl": 0.014155242045193164, "entropy": 15.449482940105682, "entropy_coeff": 0.00732569}, "model": {}, "num_grad_updates_lifetime": 19115.5, "diff_num_grad_updates_vs_sampler_policy": 234.5}}, "num_env_steps_sampled": 548034, "num_env_steps_trained": 548034, "num_agent_steps_sampled": 548034, "num_agent_steps_trained": 548034}, "sampler_results": {"episode_reward_max": 121.62733499721345, "episode_reward_min": -24.720449848593486, "episode_reward_mean": 35.511790310570426, "episode_len_mean": 862.18, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.075851693635407, 80.7691705509351, 11.539519259992845, 35.03753290449889, 48.56264178397476, 32.76086008873677, 10.919326426968649, -0.42359602323697787, 83.82041073639283, 16.698079864414, 37.381396580693654, 6.284161155794613, 18.803655549208134, 16.366828416612034, 18.078457333031626, 25.134049261985474, 26.82919571596199, 46.14814363540769, 10.805093447857514, 13.737097380735687, 19.143348935068797, 23.035771720171915, 25.490663687806478, 17.153771937281494, -24.720449848593486, 10.999572669849135, 103.89425855059707, 66.61187005803163, 19.270007510173308, 28.296333202981494, 71.23782221597152, 70.27678959652877, 31.309545939708258, 44.82101338329735, 13.89083287446727, 30.241391859183455, 21.09955883562739, 121.62733499721345, 19.507200124447277, 29.54689048689749, 14.925377652843409, 112.47868687605767, 18.122631418105403, -5.616044599802387, 15.830373983566982, 96.48703400323079, 50.116728346095, 18.16590751885936, 7.151267165975617, 67.87996692973157, 100.708255342965, 15.254565110033635, 4.7926038033124465, 15.710476376135677, 108.75343973019218, 27.76081663659646, 34.50616636032212, 41.587148438154664, 4.2214410191778455, 35.845886902760405, 5.922092653354798, -1.4511790907300033, 71.6385047383837, 19.219280161857974, 17.27823102866951, 18.916247804958072, 12.717431717620867, 85.56384210344116, 13.770194588005962, 41.32544932984607, 17.555433810097025, 82.40656885828923, 8.719695795679648, 19.57051798565345, 18.86462764381186, 72.65759848771123, 13.937020995948542, 39.40813014507018, 17.519759745233614, 15.810494282122214, 78.99863830780873, 38.606298354491344, 67.72459782963382, 61.00402290315448, 16.49308847900565, 77.51602445737167, 14.105011033732266, 75.16335475605031, 85.78639692547063, 49.83765925810302, -13.840870830096582, 11.63711835517373, 49.364736262449235, 19.98272154886117, 34.2732336719357, 42.11424120683082, 107.36723962947342, 16.25420577200986, 16.381261468482837, 26.315975367450473], "episode_lengths": [295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2930750101534465, "mean_inference_ms": 7.365308820677082, "mean_action_processing_ms": 0.504823892003581, "mean_env_wait_ms": 21.731112692795783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025737762451171875, "StateBufferConnector_ms": 0.017053842544555664, "ViewRequirementAgentConnector_ms": 0.8350601196289062}}, "episode_reward_max": 121.62733499721345, "episode_reward_min": -24.720449848593486, "episode_reward_mean": 35.511790310570426, "episode_len_mean": 862.18, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.075851693635407, 80.7691705509351, 11.539519259992845, 35.03753290449889, 48.56264178397476, 32.76086008873677, 10.919326426968649, -0.42359602323697787, 83.82041073639283, 16.698079864414, 37.381396580693654, 6.284161155794613, 18.803655549208134, 16.366828416612034, 18.078457333031626, 25.134049261985474, 26.82919571596199, 46.14814363540769, 10.805093447857514, 13.737097380735687, 19.143348935068797, 23.035771720171915, 25.490663687806478, 17.153771937281494, -24.720449848593486, 10.999572669849135, 103.89425855059707, 66.61187005803163, 19.270007510173308, 28.296333202981494, 71.23782221597152, 70.27678959652877, 31.309545939708258, 44.82101338329735, 13.89083287446727, 30.241391859183455, 21.09955883562739, 121.62733499721345, 19.507200124447277, 29.54689048689749, 14.925377652843409, 112.47868687605767, 18.122631418105403, -5.616044599802387, 15.830373983566982, 96.48703400323079, 50.116728346095, 18.16590751885936, 7.151267165975617, 67.87996692973157, 100.708255342965, 15.254565110033635, 4.7926038033124465, 15.710476376135677, 108.75343973019218, 27.76081663659646, 34.50616636032212, 41.587148438154664, 4.2214410191778455, 35.845886902760405, 5.922092653354798, -1.4511790907300033, 71.6385047383837, 19.219280161857974, 17.27823102866951, 18.916247804958072, 12.717431717620867, 85.56384210344116, 13.770194588005962, 41.32544932984607, 17.555433810097025, 82.40656885828923, 8.719695795679648, 19.57051798565345, 18.86462764381186, 72.65759848771123, 13.937020995948542, 39.40813014507018, 17.519759745233614, 15.810494282122214, 78.99863830780873, 38.606298354491344, 67.72459782963382, 61.00402290315448, 16.49308847900565, 77.51602445737167, 14.105011033732266, 75.16335475605031, 85.78639692547063, 49.83765925810302, -13.840870830096582, 11.63711835517373, 49.364736262449235, 19.98272154886117, 34.2732336719357, 42.11424120683082, 107.36723962947342, 16.25420577200986, 16.381261468482837, 26.315975367450473], "episode_lengths": [295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2930750101534465, "mean_inference_ms": 7.365308820677082, "mean_action_processing_ms": 0.504823892003581, "mean_env_wait_ms": 21.731112692795783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025737762451171875, "StateBufferConnector_ms": 0.017053842544555664, "ViewRequirementAgentConnector_ms": 0.8350601196289062}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 548034, "num_agent_steps_trained": 548034, "num_env_steps_sampled": 548034, "num_env_steps_trained": 548034, "num_env_steps_sampled_this_iter": 13172, "num_env_steps_trained_this_iter": 13172, "num_env_steps_sampled_throughput_per_sec": 219.9102286855526, "num_env_steps_trained_throughput_per_sec": 219.9102286855526, "timesteps_total": 548034, "num_steps_trained_this_iter": 13172, "agent_timesteps_total": 548034, "timers": {"training_iteration_time_ms": 55129.611, "sample_time_ms": 37534.257, "load_time_ms": 1675.581, "load_throughput": 7321.519, "learn_time_ms": 15342.145, "learn_throughput": 799.614, "synch_weights_time_ms": 478.76}, "counters": {"num_env_steps_sampled": 548034, "num_env_steps_trained": 548034, "num_agent_steps_sampled": 548034, "num_agent_steps_trained": 548034}, "done": false, "episodes_total": 717, "training_iteration": 51, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-18-14", "timestamp": 1749302294, "time_this_iter_s": 59.916645526885986, "time_total_s": 2569.3897998332977, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2569.3897998332977, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 70.21714285714285, "ram_util_percent": 87.75428571428569, "gpu_util_percent0": 0.15214285714285714, "vram_util_percent0": 0.962727864583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.451966e-05, "total_loss": -0.11460446920955736, "policy_loss": -0.023074787808298247, "vf_loss": 0.054274348261561696, "vf_explained_var": 0.9061581852959424, "kl": 0.01281098352245577, "entropy": 14.905629095217076, "entropy_coeff": 0.007259829999999998}, "model": {}, "num_grad_updates_lifetime": 19555.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 559562, "num_env_steps_trained": 559562, "num_agent_steps_sampled": 559562, "num_agent_steps_trained": 559562}, "sampler_results": {"episode_reward_max": 132.87954862395338, "episode_reward_min": -24.720449848593486, "episode_reward_mean": 39.909613575348104, "episode_len_mean": 862.18, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.078457333031626, 25.134049261985474, 26.82919571596199, 46.14814363540769, 10.805093447857514, 13.737097380735687, 19.143348935068797, 23.035771720171915, 25.490663687806478, 17.153771937281494, -24.720449848593486, 10.999572669849135, 103.89425855059707, 66.61187005803163, 19.270007510173308, 28.296333202981494, 71.23782221597152, 70.27678959652877, 31.309545939708258, 44.82101338329735, 13.89083287446727, 30.241391859183455, 21.09955883562739, 121.62733499721345, 19.507200124447277, 29.54689048689749, 14.925377652843409, 112.47868687605767, 18.122631418105403, -5.616044599802387, 15.830373983566982, 96.48703400323079, 50.116728346095, 18.16590751885936, 7.151267165975617, 67.87996692973157, 100.708255342965, 15.254565110033635, 4.7926038033124465, 15.710476376135677, 108.75343973019218, 27.76081663659646, 34.50616636032212, 41.587148438154664, 4.2214410191778455, 35.845886902760405, 5.922092653354798, -1.4511790907300033, 71.6385047383837, 19.219280161857974, 17.27823102866951, 18.916247804958072, 12.717431717620867, 85.56384210344116, 13.770194588005962, 41.32544932984607, 17.555433810097025, 82.40656885828923, 8.719695795679648, 19.57051798565345, 18.86462764381186, 72.65759848771123, 13.937020995948542, 39.40813014507018, 17.519759745233614, 15.810494282122214, 78.99863830780873, 38.606298354491344, 67.72459782963382, 61.00402290315448, 16.49308847900565, 77.51602445737167, 14.105011033732266, 75.16335475605031, 85.78639692547063, 49.83765925810302, -13.840870830096582, 11.63711835517373, 49.364736262449235, 19.98272154886117, 34.2732336719357, 42.11424120683082, 107.36723962947342, 16.25420577200986, 16.381261468482837, 26.315975367450473, 55.37904338912159, 132.87954862395338, 12.151421336807253, 25.61650863677152, 14.326659363092414, 18.75839431321049, 112.7682087779823, 105.72663830269539, 77.4356942088211, 13.859655513583986, 110.37021287896086, 75.57542784210351, 83.87042336583424, 17.660328913451007], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.296379571947368, "mean_inference_ms": 7.368737939722025, "mean_action_processing_ms": 0.5050083593213384, "mean_env_wait_ms": 21.741117044113494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02564406394958496, "StateBufferConnector_ms": 0.0140533447265625, "ViewRequirementAgentConnector_ms": 0.8278427124023438}}, "episode_reward_max": 132.87954862395338, "episode_reward_min": -24.720449848593486, "episode_reward_mean": 39.909613575348104, "episode_len_mean": 862.18, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.078457333031626, 25.134049261985474, 26.82919571596199, 46.14814363540769, 10.805093447857514, 13.737097380735687, 19.143348935068797, 23.035771720171915, 25.490663687806478, 17.153771937281494, -24.720449848593486, 10.999572669849135, 103.89425855059707, 66.61187005803163, 19.270007510173308, 28.296333202981494, 71.23782221597152, 70.27678959652877, 31.309545939708258, 44.82101338329735, 13.89083287446727, 30.241391859183455, 21.09955883562739, 121.62733499721345, 19.507200124447277, 29.54689048689749, 14.925377652843409, 112.47868687605767, 18.122631418105403, -5.616044599802387, 15.830373983566982, 96.48703400323079, 50.116728346095, 18.16590751885936, 7.151267165975617, 67.87996692973157, 100.708255342965, 15.254565110033635, 4.7926038033124465, 15.710476376135677, 108.75343973019218, 27.76081663659646, 34.50616636032212, 41.587148438154664, 4.2214410191778455, 35.845886902760405, 5.922092653354798, -1.4511790907300033, 71.6385047383837, 19.219280161857974, 17.27823102866951, 18.916247804958072, 12.717431717620867, 85.56384210344116, 13.770194588005962, 41.32544932984607, 17.555433810097025, 82.40656885828923, 8.719695795679648, 19.57051798565345, 18.86462764381186, 72.65759848771123, 13.937020995948542, 39.40813014507018, 17.519759745233614, 15.810494282122214, 78.99863830780873, 38.606298354491344, 67.72459782963382, 61.00402290315448, 16.49308847900565, 77.51602445737167, 14.105011033732266, 75.16335475605031, 85.78639692547063, 49.83765925810302, -13.840870830096582, 11.63711835517373, 49.364736262449235, 19.98272154886117, 34.2732336719357, 42.11424120683082, 107.36723962947342, 16.25420577200986, 16.381261468482837, 26.315975367450473, 55.37904338912159, 132.87954862395338, 12.151421336807253, 25.61650863677152, 14.326659363092414, 18.75839431321049, 112.7682087779823, 105.72663830269539, 77.4356942088211, 13.859655513583986, 110.37021287896086, 75.57542784210351, 83.87042336583424, 17.660328913451007], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.296379571947368, "mean_inference_ms": 7.368737939722025, "mean_action_processing_ms": 0.5050083593213384, "mean_env_wait_ms": 21.741117044113494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02564406394958496, "StateBufferConnector_ms": 0.0140533447265625, "ViewRequirementAgentConnector_ms": 0.8278427124023438}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 559562, "num_agent_steps_trained": 559562, "num_env_steps_sampled": 559562, "num_env_steps_trained": 559562, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 215.7368740914679, "num_env_steps_trained_throughput_per_sec": 215.7368740914679, "timesteps_total": 559562, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 559562, "timers": {"training_iteration_time_ms": 55225.557, "sample_time_ms": 37584.463, "load_time_ms": 1687.854, "load_throughput": 7268.281, "learn_time_ms": 15369.937, "learn_throughput": 798.169, "synch_weights_time_ms": 481.25}, "counters": {"num_env_steps_sampled": 559562, "num_env_steps_trained": 559562, "num_agent_steps_sampled": 559562, "num_agent_steps_trained": 559562}, "done": false, "episodes_total": 731, "training_iteration": 52, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-19-07", "timestamp": 1749302347, "time_this_iter_s": 53.45913100242615, "time_total_s": 2622.848930835724, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2622.848930835724, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 62.74603174603175, "ram_util_percent": 88.18253968253964, "gpu_util_percent0": 0.170952380952381, "vram_util_percent0": 0.9627278645833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.440438e-05, "total_loss": -0.10212831367105359, "policy_loss": -0.010988327749811748, "vf_loss": 0.06248959945628374, "vf_explained_var": 0.9369591836522265, "kl": 0.013510068266925107, "entropy": 15.316043928192883, "entropy_coeff": 0.007202189999999998}, "model": {}, "num_grad_updates_lifetime": 19965.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 571090, "num_env_steps_trained": 571090, "num_agent_steps_sampled": 571090, "num_agent_steps_trained": 571090}, "sampler_results": {"episode_reward_max": 132.87954862395338, "episode_reward_min": -13.840870830096582, "episode_reward_mean": 42.349861641314746, "episode_len_mean": 853.96, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.270007510173308, 28.296333202981494, 71.23782221597152, 70.27678959652877, 31.309545939708258, 44.82101338329735, 13.89083287446727, 30.241391859183455, 21.09955883562739, 121.62733499721345, 19.507200124447277, 29.54689048689749, 14.925377652843409, 112.47868687605767, 18.122631418105403, -5.616044599802387, 15.830373983566982, 96.48703400323079, 50.116728346095, 18.16590751885936, 7.151267165975617, 67.87996692973157, 100.708255342965, 15.254565110033635, 4.7926038033124465, 15.710476376135677, 108.75343973019218, 27.76081663659646, 34.50616636032212, 41.587148438154664, 4.2214410191778455, 35.845886902760405, 5.922092653354798, -1.4511790907300033, 71.6385047383837, 19.219280161857974, 17.27823102866951, 18.916247804958072, 12.717431717620867, 85.56384210344116, 13.770194588005962, 41.32544932984607, 17.555433810097025, 82.40656885828923, 8.719695795679648, 19.57051798565345, 18.86462764381186, 72.65759848771123, 13.937020995948542, 39.40813014507018, 17.519759745233614, 15.810494282122214, 78.99863830780873, 38.606298354491344, 67.72459782963382, 61.00402290315448, 16.49308847900565, 77.51602445737167, 14.105011033732266, 75.16335475605031, 85.78639692547063, 49.83765925810302, -13.840870830096582, 11.63711835517373, 49.364736262449235, 19.98272154886117, 34.2732336719357, 42.11424120683082, 107.36723962947342, 16.25420577200986, 16.381261468482837, 26.315975367450473, 55.37904338912159, 132.87954862395338, 12.151421336807253, 25.61650863677152, 14.326659363092414, 18.75839431321049, 112.7682087779823, 105.72663830269539, 77.4356942088211, 13.859655513583986, 110.37021287896086, 75.57542784210351, 83.87042336583424, 17.660328913451007, 74.9241282132264, 81.77886619158822, 10.4752550914235, 69.5623223367578, 97.50969915130929, 90.64650407655702, 18.919503591396523, 50.04247436302876, 13.444553912281208, -7.287226450356079, 18.106689507315238, 39.422233965449784, 45.90732835813121, 22.913318773747847], "episode_lengths": [295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2991012830096853, "mean_inference_ms": 7.370747652919156, "mean_action_processing_ms": 0.5051695788218811, "mean_env_wait_ms": 21.748272566007824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025939464569091797, "StateBufferConnector_ms": 0.01800680160522461, "ViewRequirementAgentConnector_ms": 0.8174633979797363}}, "episode_reward_max": 132.87954862395338, "episode_reward_min": -13.840870830096582, "episode_reward_mean": 42.349861641314746, "episode_len_mean": 853.96, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.270007510173308, 28.296333202981494, 71.23782221597152, 70.27678959652877, 31.309545939708258, 44.82101338329735, 13.89083287446727, 30.241391859183455, 21.09955883562739, 121.62733499721345, 19.507200124447277, 29.54689048689749, 14.925377652843409, 112.47868687605767, 18.122631418105403, -5.616044599802387, 15.830373983566982, 96.48703400323079, 50.116728346095, 18.16590751885936, 7.151267165975617, 67.87996692973157, 100.708255342965, 15.254565110033635, 4.7926038033124465, 15.710476376135677, 108.75343973019218, 27.76081663659646, 34.50616636032212, 41.587148438154664, 4.2214410191778455, 35.845886902760405, 5.922092653354798, -1.4511790907300033, 71.6385047383837, 19.219280161857974, 17.27823102866951, 18.916247804958072, 12.717431717620867, 85.56384210344116, 13.770194588005962, 41.32544932984607, 17.555433810097025, 82.40656885828923, 8.719695795679648, 19.57051798565345, 18.86462764381186, 72.65759848771123, 13.937020995948542, 39.40813014507018, 17.519759745233614, 15.810494282122214, 78.99863830780873, 38.606298354491344, 67.72459782963382, 61.00402290315448, 16.49308847900565, 77.51602445737167, 14.105011033732266, 75.16335475605031, 85.78639692547063, 49.83765925810302, -13.840870830096582, 11.63711835517373, 49.364736262449235, 19.98272154886117, 34.2732336719357, 42.11424120683082, 107.36723962947342, 16.25420577200986, 16.381261468482837, 26.315975367450473, 55.37904338912159, 132.87954862395338, 12.151421336807253, 25.61650863677152, 14.326659363092414, 18.75839431321049, 112.7682087779823, 105.72663830269539, 77.4356942088211, 13.859655513583986, 110.37021287896086, 75.57542784210351, 83.87042336583424, 17.660328913451007, 74.9241282132264, 81.77886619158822, 10.4752550914235, 69.5623223367578, 97.50969915130929, 90.64650407655702, 18.919503591396523, 50.04247436302876, 13.444553912281208, -7.287226450356079, 18.106689507315238, 39.422233965449784, 45.90732835813121, 22.913318773747847], "episode_lengths": [295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2991012830096853, "mean_inference_ms": 7.370747652919156, "mean_action_processing_ms": 0.5051695788218811, "mean_env_wait_ms": 21.748272566007824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025939464569091797, "StateBufferConnector_ms": 0.01800680160522461, "ViewRequirementAgentConnector_ms": 0.8174633979797363}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 571090, "num_agent_steps_trained": 571090, "num_env_steps_sampled": 571090, "num_env_steps_trained": 571090, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 224.73476451001156, "num_env_steps_trained_throughput_per_sec": 224.73476451001156, "timesteps_total": 571090, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 571090, "timers": {"training_iteration_time_ms": 54796.788, "sample_time_ms": 37277.895, "load_time_ms": 1682.699, "load_throughput": 7241.698, "learn_time_ms": 15245.31, "learn_throughput": 799.302, "synch_weights_time_ms": 488.326}, "counters": {"num_env_steps_sampled": 571090, "num_env_steps_trained": 571090, "num_agent_steps_sampled": 571090, "num_agent_steps_trained": 571090}, "done": false, "episodes_total": 745, "training_iteration": 53, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-19-59", "timestamp": 1749302399, "time_this_iter_s": 51.319040060043335, "time_total_s": 2674.167970895767, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2674.167970895767, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 65.35166666666666, "ram_util_percent": 87.21166666666669, "gpu_util_percent0": 0.15483333333333332, "vram_util_percent0": 0.9627278645833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.428910000000003e-05, "total_loss": -0.060075206021512194, "policy_loss": 0.027658867605995122, "vf_loss": 0.07117386942596308, "vf_explained_var": 0.9157069906166622, "kl": 0.013177290079100722, "entropy": 15.32609211240496, "entropy_coeff": 0.007144550000000002}, "model": {}, "num_grad_updates_lifetime": 20345.5, "diff_num_grad_updates_vs_sampler_policy": 174.5}}, "num_env_steps_sampled": 580974, "num_env_steps_trained": 580974, "num_agent_steps_sampled": 580974, "num_agent_steps_trained": 580974}, "sampler_results": {"episode_reward_max": 132.87954862395338, "episode_reward_min": -31.309464821990726, "episode_reward_mean": 40.648470443912785, "episode_len_mean": 837.52, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.122631418105403, -5.616044599802387, 15.830373983566982, 96.48703400323079, 50.116728346095, 18.16590751885936, 7.151267165975617, 67.87996692973157, 100.708255342965, 15.254565110033635, 4.7926038033124465, 15.710476376135677, 108.75343973019218, 27.76081663659646, 34.50616636032212, 41.587148438154664, 4.2214410191778455, 35.845886902760405, 5.922092653354798, -1.4511790907300033, 71.6385047383837, 19.219280161857974, 17.27823102866951, 18.916247804958072, 12.717431717620867, 85.56384210344116, 13.770194588005962, 41.32544932984607, 17.555433810097025, 82.40656885828923, 8.719695795679648, 19.57051798565345, 18.86462764381186, 72.65759848771123, 13.937020995948542, 39.40813014507018, 17.519759745233614, 15.810494282122214, 78.99863830780873, 38.606298354491344, 67.72459782963382, 61.00402290315448, 16.49308847900565, 77.51602445737167, 14.105011033732266, 75.16335475605031, 85.78639692547063, 49.83765925810302, -13.840870830096582, 11.63711835517373, 49.364736262449235, 19.98272154886117, 34.2732336719357, 42.11424120683082, 107.36723962947342, 16.25420577200986, 16.381261468482837, 26.315975367450473, 55.37904338912159, 132.87954862395338, 12.151421336807253, 25.61650863677152, 14.326659363092414, 18.75839431321049, 112.7682087779823, 105.72663830269539, 77.4356942088211, 13.859655513583986, 110.37021287896086, 75.57542784210351, 83.87042336583424, 17.660328913451007, 74.9241282132264, 81.77886619158822, 10.4752550914235, 69.5623223367578, 97.50969915130929, 90.64650407655702, 18.919503591396523, 50.04247436302876, 13.444553912281208, -7.287226450356079, 18.106689507315238, 39.422233965449784, 45.90732835813121, 22.913318773747847, 4.077996520270179, 113.33130883234467, 10.475106772363844, 18.35945447851859, 17.624689844980473, 69.8426679586787, 17.005898693278322, 25.91285172404399, 16.48415677776046, 100.10379891484548, 15.598178296681013, 59.92273930407305, -31.309464821990726, 20.960282519354806], "episode_lengths": [295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.301571194098808, "mean_inference_ms": 7.372763150189298, "mean_action_processing_ms": 0.5053437078331146, "mean_env_wait_ms": 21.755158659991142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02396416664123535, "StateBufferConnector_ms": 0.024280309677124023, "ViewRequirementAgentConnector_ms": 0.7863106727600098}}, "episode_reward_max": 132.87954862395338, "episode_reward_min": -31.309464821990726, "episode_reward_mean": 40.648470443912785, "episode_len_mean": 837.52, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.122631418105403, -5.616044599802387, 15.830373983566982, 96.48703400323079, 50.116728346095, 18.16590751885936, 7.151267165975617, 67.87996692973157, 100.708255342965, 15.254565110033635, 4.7926038033124465, 15.710476376135677, 108.75343973019218, 27.76081663659646, 34.50616636032212, 41.587148438154664, 4.2214410191778455, 35.845886902760405, 5.922092653354798, -1.4511790907300033, 71.6385047383837, 19.219280161857974, 17.27823102866951, 18.916247804958072, 12.717431717620867, 85.56384210344116, 13.770194588005962, 41.32544932984607, 17.555433810097025, 82.40656885828923, 8.719695795679648, 19.57051798565345, 18.86462764381186, 72.65759848771123, 13.937020995948542, 39.40813014507018, 17.519759745233614, 15.810494282122214, 78.99863830780873, 38.606298354491344, 67.72459782963382, 61.00402290315448, 16.49308847900565, 77.51602445737167, 14.105011033732266, 75.16335475605031, 85.78639692547063, 49.83765925810302, -13.840870830096582, 11.63711835517373, 49.364736262449235, 19.98272154886117, 34.2732336719357, 42.11424120683082, 107.36723962947342, 16.25420577200986, 16.381261468482837, 26.315975367450473, 55.37904338912159, 132.87954862395338, 12.151421336807253, 25.61650863677152, 14.326659363092414, 18.75839431321049, 112.7682087779823, 105.72663830269539, 77.4356942088211, 13.859655513583986, 110.37021287896086, 75.57542784210351, 83.87042336583424, 17.660328913451007, 74.9241282132264, 81.77886619158822, 10.4752550914235, 69.5623223367578, 97.50969915130929, 90.64650407655702, 18.919503591396523, 50.04247436302876, 13.444553912281208, -7.287226450356079, 18.106689507315238, 39.422233965449784, 45.90732835813121, 22.913318773747847, 4.077996520270179, 113.33130883234467, 10.475106772363844, 18.35945447851859, 17.624689844980473, 69.8426679586787, 17.005898693278322, 25.91285172404399, 16.48415677776046, 100.10379891484548, 15.598178296681013, 59.92273930407305, -31.309464821990726, 20.960282519354806], "episode_lengths": [295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.301571194098808, "mean_inference_ms": 7.372763150189298, "mean_action_processing_ms": 0.5053437078331146, "mean_env_wait_ms": 21.755158659991142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02396416664123535, "StateBufferConnector_ms": 0.024280309677124023, "ViewRequirementAgentConnector_ms": 0.7863106727600098}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580974, "num_agent_steps_trained": 580974, "num_env_steps_sampled": 580974, "num_env_steps_trained": 580974, "num_env_steps_sampled_this_iter": 9884, "num_env_steps_trained_this_iter": 9884, "num_env_steps_sampled_throughput_per_sec": 201.9358885555713, "num_env_steps_trained_throughput_per_sec": 201.9358885555713, "timesteps_total": 580974, "num_steps_trained_this_iter": 9884, "agent_timesteps_total": 580974, "timers": {"training_iteration_time_ms": 53708.406, "sample_time_ms": 36682.08, "load_time_ms": 1608.758, "load_throughput": 7319.061, "learn_time_ms": 14826.662, "learn_throughput": 794.15, "synch_weights_time_ms": 491.173}, "counters": {"num_env_steps_sampled": 580974, "num_env_steps_trained": 580974, "num_agent_steps_sampled": 580974, "num_agent_steps_trained": 580974}, "done": false, "episodes_total": 759, "training_iteration": 54, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-20-48", "timestamp": 1749302448, "time_this_iter_s": 48.96145462989807, "time_total_s": 2723.1294255256653, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2723.1294255256653, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 58.69322033898306, "ram_util_percent": 86.05593220338983, "gpu_util_percent0": 0.15491525423728814, "vram_util_percent0": 0.9627278645833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.419026e-05, "total_loss": -0.10974090347894658, "policy_loss": -0.020815421075200322, "vf_loss": 0.06594958050197668, "vf_explained_var": 0.8644426409493793, "kl": 0.014584120385321015, "entropy": 15.386061755093662, "entropy_coeff": 0.007095130000000001}, "model": {}, "num_grad_updates_lifetime": 20740.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 593324, "num_env_steps_trained": 593324, "num_agent_steps_sampled": 593324, "num_agent_steps_trained": 593324}, "sampler_results": {"episode_reward_max": 132.87954862395338, "episode_reward_min": -31.309464821990726, "episode_reward_mean": 40.594236515723125, "episode_len_mean": 837.52, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.50616636032212, 41.587148438154664, 4.2214410191778455, 35.845886902760405, 5.922092653354798, -1.4511790907300033, 71.6385047383837, 19.219280161857974, 17.27823102866951, 18.916247804958072, 12.717431717620867, 85.56384210344116, 13.770194588005962, 41.32544932984607, 17.555433810097025, 82.40656885828923, 8.719695795679648, 19.57051798565345, 18.86462764381186, 72.65759848771123, 13.937020995948542, 39.40813014507018, 17.519759745233614, 15.810494282122214, 78.99863830780873, 38.606298354491344, 67.72459782963382, 61.00402290315448, 16.49308847900565, 77.51602445737167, 14.105011033732266, 75.16335475605031, 85.78639692547063, 49.83765925810302, -13.840870830096582, 11.63711835517373, 49.364736262449235, 19.98272154886117, 34.2732336719357, 42.11424120683082, 107.36723962947342, 16.25420577200986, 16.381261468482837, 26.315975367450473, 55.37904338912159, 132.87954862395338, 12.151421336807253, 25.61650863677152, 14.326659363092414, 18.75839431321049, 112.7682087779823, 105.72663830269539, 77.4356942088211, 13.859655513583986, 110.37021287896086, 75.57542784210351, 83.87042336583424, 17.660328913451007, 74.9241282132264, 81.77886619158822, 10.4752550914235, 69.5623223367578, 97.50969915130929, 90.64650407655702, 18.919503591396523, 50.04247436302876, 13.444553912281208, -7.287226450356079, 18.106689507315238, 39.422233965449784, 45.90732835813121, 22.913318773747847, 4.077996520270179, 113.33130883234467, 10.475106772363844, 18.35945447851859, 17.624689844980473, 69.8426679586787, 17.005898693278322, 25.91285172404399, 16.48415677776046, 100.10379891484548, 15.598178296681013, 59.92273930407305, -31.309464821990726, 20.960282519354806, 25.4829074036084, 36.38153888485625, 20.392497275233136, 99.39156471546681, 16.894847524249613, 19.973613241217546, 38.25372265288988, 37.32851702162848, 19.211171573714388, 14.62874668189282, 113.60190818086757, 20.199283022240625, 20.053514372531883, 53.90079639563384], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3037577062689314, "mean_inference_ms": 7.374751590374859, "mean_action_processing_ms": 0.5055383363024587, "mean_env_wait_ms": 21.762706888384983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03333687782287598, "StateBufferConnector_ms": 0.02634453773498535, "ViewRequirementAgentConnector_ms": 0.776137113571167}}, "episode_reward_max": 132.87954862395338, "episode_reward_min": -31.309464821990726, "episode_reward_mean": 40.594236515723125, "episode_len_mean": 837.52, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.50616636032212, 41.587148438154664, 4.2214410191778455, 35.845886902760405, 5.922092653354798, -1.4511790907300033, 71.6385047383837, 19.219280161857974, 17.27823102866951, 18.916247804958072, 12.717431717620867, 85.56384210344116, 13.770194588005962, 41.32544932984607, 17.555433810097025, 82.40656885828923, 8.719695795679648, 19.57051798565345, 18.86462764381186, 72.65759848771123, 13.937020995948542, 39.40813014507018, 17.519759745233614, 15.810494282122214, 78.99863830780873, 38.606298354491344, 67.72459782963382, 61.00402290315448, 16.49308847900565, 77.51602445737167, 14.105011033732266, 75.16335475605031, 85.78639692547063, 49.83765925810302, -13.840870830096582, 11.63711835517373, 49.364736262449235, 19.98272154886117, 34.2732336719357, 42.11424120683082, 107.36723962947342, 16.25420577200986, 16.381261468482837, 26.315975367450473, 55.37904338912159, 132.87954862395338, 12.151421336807253, 25.61650863677152, 14.326659363092414, 18.75839431321049, 112.7682087779823, 105.72663830269539, 77.4356942088211, 13.859655513583986, 110.37021287896086, 75.57542784210351, 83.87042336583424, 17.660328913451007, 74.9241282132264, 81.77886619158822, 10.4752550914235, 69.5623223367578, 97.50969915130929, 90.64650407655702, 18.919503591396523, 50.04247436302876, 13.444553912281208, -7.287226450356079, 18.106689507315238, 39.422233965449784, 45.90732835813121, 22.913318773747847, 4.077996520270179, 113.33130883234467, 10.475106772363844, 18.35945447851859, 17.624689844980473, 69.8426679586787, 17.005898693278322, 25.91285172404399, 16.48415677776046, 100.10379891484548, 15.598178296681013, 59.92273930407305, -31.309464821990726, 20.960282519354806, 25.4829074036084, 36.38153888485625, 20.392497275233136, 99.39156471546681, 16.894847524249613, 19.973613241217546, 38.25372265288988, 37.32851702162848, 19.211171573714388, 14.62874668189282, 113.60190818086757, 20.199283022240625, 20.053514372531883, 53.90079639563384], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3037577062689314, "mean_inference_ms": 7.374751590374859, "mean_action_processing_ms": 0.5055383363024587, "mean_env_wait_ms": 21.762706888384983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03333687782287598, "StateBufferConnector_ms": 0.02634453773498535, "ViewRequirementAgentConnector_ms": 0.776137113571167}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 593324, "num_agent_steps_trained": 593324, "num_env_steps_sampled": 593324, "num_env_steps_trained": 593324, "num_env_steps_sampled_this_iter": 12350, "num_env_steps_trained_this_iter": 12350, "num_env_steps_sampled_throughput_per_sec": 219.2714891525057, "num_env_steps_trained_throughput_per_sec": 219.2714891525057, "timesteps_total": 593324, "num_steps_trained_this_iter": 12350, "agent_timesteps_total": 593324, "timers": {"training_iteration_time_ms": 53926.373, "sample_time_ms": 36874.344, "load_time_ms": 1618.314, "load_throughput": 7275.842, "learn_time_ms": 14838.122, "learn_throughput": 793.537, "synch_weights_time_ms": 496.001}, "counters": {"num_env_steps_sampled": 593324, "num_env_steps_trained": 593324, "num_agent_steps_sampled": 593324, "num_agent_steps_trained": 593324}, "done": false, "episodes_total": 773, "training_iteration": 55, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-21-44", "timestamp": 1749302504, "time_this_iter_s": 56.33986020088196, "time_total_s": 2779.4692857265472, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2779.4692857265472, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 67.53787878787878, "ram_util_percent": 88.8212121212121, "gpu_util_percent0": 0.15212121212121213, "vram_util_percent0": 0.9627278645833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.406675999999999e-05, "total_loss": -0.11264712558164852, "policy_loss": -0.022607199303847, "vf_loss": 0.06061985014778812, "vf_explained_var": 0.9035702892919866, "kl": 0.012764112929185627, "entropy": 15.444175469003072, "entropy_coeff": 0.0070333800000000005}, "model": {}, "num_grad_updates_lifetime": 21165.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 604852, "num_env_steps_trained": 604852, "num_agent_steps_sampled": 604852, "num_agent_steps_trained": 604852}, "sampler_results": {"episode_reward_max": 132.87954862395338, "episode_reward_min": -31.309464821990726, "episode_reward_mean": 42.3800197234946, "episode_len_mean": 829.3, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.555433810097025, 82.40656885828923, 8.719695795679648, 19.57051798565345, 18.86462764381186, 72.65759848771123, 13.937020995948542, 39.40813014507018, 17.519759745233614, 15.810494282122214, 78.99863830780873, 38.606298354491344, 67.72459782963382, 61.00402290315448, 16.49308847900565, 77.51602445737167, 14.105011033732266, 75.16335475605031, 85.78639692547063, 49.83765925810302, -13.840870830096582, 11.63711835517373, 49.364736262449235, 19.98272154886117, 34.2732336719357, 42.11424120683082, 107.36723962947342, 16.25420577200986, 16.381261468482837, 26.315975367450473, 55.37904338912159, 132.87954862395338, 12.151421336807253, 25.61650863677152, 14.326659363092414, 18.75839431321049, 112.7682087779823, 105.72663830269539, 77.4356942088211, 13.859655513583986, 110.37021287896086, 75.57542784210351, 83.87042336583424, 17.660328913451007, 74.9241282132264, 81.77886619158822, 10.4752550914235, 69.5623223367578, 97.50969915130929, 90.64650407655702, 18.919503591396523, 50.04247436302876, 13.444553912281208, -7.287226450356079, 18.106689507315238, 39.422233965449784, 45.90732835813121, 22.913318773747847, 4.077996520270179, 113.33130883234467, 10.475106772363844, 18.35945447851859, 17.624689844980473, 69.8426679586787, 17.005898693278322, 25.91285172404399, 16.48415677776046, 100.10379891484548, 15.598178296681013, 59.92273930407305, -31.309464821990726, 20.960282519354806, 25.4829074036084, 36.38153888485625, 20.392497275233136, 99.39156471546681, 16.894847524249613, 19.973613241217546, 38.25372265288988, 37.32851702162848, 19.211171573714388, 14.62874668189282, 113.60190818086757, 20.199283022240625, 20.053514372531883, 53.90079639563384, 16.4181557123323, 100.97845000964215, 89.24709022988038, 51.56381841834362, -21.19949809560292, 12.357118324653863, 75.30196637339057, 12.43109042417404, 41.32925680141283, 18.945474499119094, 66.5969492342703, 65.6859523905973, 44.7610390094889, 5.2221952012687645], "episode_lengths": [295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.305576942797681, "mean_inference_ms": 7.376126056367823, "mean_action_processing_ms": 0.5056818697742624, "mean_env_wait_ms": 21.76914346838437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028809785842895508, "StateBufferConnector_ms": 0.037471771240234375, "ViewRequirementAgentConnector_ms": 0.7634029388427734}}, "episode_reward_max": 132.87954862395338, "episode_reward_min": -31.309464821990726, "episode_reward_mean": 42.3800197234946, "episode_len_mean": 829.3, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.555433810097025, 82.40656885828923, 8.719695795679648, 19.57051798565345, 18.86462764381186, 72.65759848771123, 13.937020995948542, 39.40813014507018, 17.519759745233614, 15.810494282122214, 78.99863830780873, 38.606298354491344, 67.72459782963382, 61.00402290315448, 16.49308847900565, 77.51602445737167, 14.105011033732266, 75.16335475605031, 85.78639692547063, 49.83765925810302, -13.840870830096582, 11.63711835517373, 49.364736262449235, 19.98272154886117, 34.2732336719357, 42.11424120683082, 107.36723962947342, 16.25420577200986, 16.381261468482837, 26.315975367450473, 55.37904338912159, 132.87954862395338, 12.151421336807253, 25.61650863677152, 14.326659363092414, 18.75839431321049, 112.7682087779823, 105.72663830269539, 77.4356942088211, 13.859655513583986, 110.37021287896086, 75.57542784210351, 83.87042336583424, 17.660328913451007, 74.9241282132264, 81.77886619158822, 10.4752550914235, 69.5623223367578, 97.50969915130929, 90.64650407655702, 18.919503591396523, 50.04247436302876, 13.444553912281208, -7.287226450356079, 18.106689507315238, 39.422233965449784, 45.90732835813121, 22.913318773747847, 4.077996520270179, 113.33130883234467, 10.475106772363844, 18.35945447851859, 17.624689844980473, 69.8426679586787, 17.005898693278322, 25.91285172404399, 16.48415677776046, 100.10379891484548, 15.598178296681013, 59.92273930407305, -31.309464821990726, 20.960282519354806, 25.4829074036084, 36.38153888485625, 20.392497275233136, 99.39156471546681, 16.894847524249613, 19.973613241217546, 38.25372265288988, 37.32851702162848, 19.211171573714388, 14.62874668189282, 113.60190818086757, 20.199283022240625, 20.053514372531883, 53.90079639563384, 16.4181557123323, 100.97845000964215, 89.24709022988038, 51.56381841834362, -21.19949809560292, 12.357118324653863, 75.30196637339057, 12.43109042417404, 41.32925680141283, 18.945474499119094, 66.5969492342703, 65.6859523905973, 44.7610390094889, 5.2221952012687645], "episode_lengths": [295, 1117, 295, 295, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.305576942797681, "mean_inference_ms": 7.376126056367823, "mean_action_processing_ms": 0.5056818697742624, "mean_env_wait_ms": 21.76914346838437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028809785842895508, "StateBufferConnector_ms": 0.037471771240234375, "ViewRequirementAgentConnector_ms": 0.7634029388427734}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 604852, "num_agent_steps_trained": 604852, "num_env_steps_sampled": 604852, "num_env_steps_trained": 604852, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 222.41904847955482, "num_env_steps_trained_throughput_per_sec": 222.41904847955482, "timesteps_total": 604852, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 604852, "timers": {"training_iteration_time_ms": 53789.955, "sample_time_ms": 36800.473, "load_time_ms": 1642.269, "load_throughput": 7169.713, "learn_time_ms": 14750.521, "learn_throughput": 798.25, "synch_weights_time_ms": 497.329}, "counters": {"num_env_steps_sampled": 604852, "num_env_steps_trained": 604852, "num_agent_steps_sampled": 604852, "num_agent_steps_trained": 604852}, "done": false, "episodes_total": 787, "training_iteration": 56, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-22-36", "timestamp": 1749302556, "time_this_iter_s": 51.85012245178223, "time_total_s": 2831.3194081783295, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2831.3194081783295, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 62.6016393442623, "ram_util_percent": 88.13770491803278, "gpu_util_percent0": 0.1640983606557377, "vram_util_percent0": 0.9627278645833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.395148e-05, "total_loss": -0.09756510880145404, "policy_loss": -0.008443597498599712, "vf_loss": 0.058431208122339914, "vf_explained_var": 0.9013524424739, "kl": 0.01358560191374414, "entropy": 15.349686808702423, "entropy_coeff": 0.0069757399999999985}, "model": {}, "num_grad_updates_lifetime": 21575.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 616380, "num_env_steps_trained": 616380, "num_agent_steps_sampled": 616380, "num_agent_steps_trained": 616380}, "sampler_results": {"episode_reward_max": 132.87954862395338, "episode_reward_min": -31.309464821990726, "episode_reward_mean": 44.1461118633458, "episode_len_mean": 829.3, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.49308847900565, 77.51602445737167, 14.105011033732266, 75.16335475605031, 85.78639692547063, 49.83765925810302, -13.840870830096582, 11.63711835517373, 49.364736262449235, 19.98272154886117, 34.2732336719357, 42.11424120683082, 107.36723962947342, 16.25420577200986, 16.381261468482837, 26.315975367450473, 55.37904338912159, 132.87954862395338, 12.151421336807253, 25.61650863677152, 14.326659363092414, 18.75839431321049, 112.7682087779823, 105.72663830269539, 77.4356942088211, 13.859655513583986, 110.37021287896086, 75.57542784210351, 83.87042336583424, 17.660328913451007, 74.9241282132264, 81.77886619158822, 10.4752550914235, 69.5623223367578, 97.50969915130929, 90.64650407655702, 18.919503591396523, 50.04247436302876, 13.444553912281208, -7.287226450356079, 18.106689507315238, 39.422233965449784, 45.90732835813121, 22.913318773747847, 4.077996520270179, 113.33130883234467, 10.475106772363844, 18.35945447851859, 17.624689844980473, 69.8426679586787, 17.005898693278322, 25.91285172404399, 16.48415677776046, 100.10379891484548, 15.598178296681013, 59.92273930407305, -31.309464821990726, 20.960282519354806, 25.4829074036084, 36.38153888485625, 20.392497275233136, 99.39156471546681, 16.894847524249613, 19.973613241217546, 38.25372265288988, 37.32851702162848, 19.211171573714388, 14.62874668189282, 113.60190818086757, 20.199283022240625, 20.053514372531883, 53.90079639563384, 16.4181557123323, 100.97845000964215, 89.24709022988038, 51.56381841834362, -21.19949809560292, 12.357118324653863, 75.30196637339057, 12.43109042417404, 41.32925680141283, 18.945474499119094, 66.5969492342703, 65.6859523905973, 44.7610390094889, 5.2221952012687645, 32.428597821726946, 75.50938389497705, 17.696952000764384, 7.102223877210291, 94.06230734828961, 12.950300128024978, 100.44582000681984, 22.436302999059883, 15.65011033318413, 47.07748725922015, 92.41563514927385, 18.57917471693931, 64.53551603783053, 128.5028075565039], "episode_lengths": [295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3069941561171374, "mean_inference_ms": 7.377284235128683, "mean_action_processing_ms": 0.5058081190330116, "mean_env_wait_ms": 21.77515828385058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030790090560913086, "StateBufferConnector_ms": 0.056520700454711914, "ViewRequirementAgentConnector_ms": 0.7956116199493408}}, "episode_reward_max": 132.87954862395338, "episode_reward_min": -31.309464821990726, "episode_reward_mean": 44.1461118633458, "episode_len_mean": 829.3, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.49308847900565, 77.51602445737167, 14.105011033732266, 75.16335475605031, 85.78639692547063, 49.83765925810302, -13.840870830096582, 11.63711835517373, 49.364736262449235, 19.98272154886117, 34.2732336719357, 42.11424120683082, 107.36723962947342, 16.25420577200986, 16.381261468482837, 26.315975367450473, 55.37904338912159, 132.87954862395338, 12.151421336807253, 25.61650863677152, 14.326659363092414, 18.75839431321049, 112.7682087779823, 105.72663830269539, 77.4356942088211, 13.859655513583986, 110.37021287896086, 75.57542784210351, 83.87042336583424, 17.660328913451007, 74.9241282132264, 81.77886619158822, 10.4752550914235, 69.5623223367578, 97.50969915130929, 90.64650407655702, 18.919503591396523, 50.04247436302876, 13.444553912281208, -7.287226450356079, 18.106689507315238, 39.422233965449784, 45.90732835813121, 22.913318773747847, 4.077996520270179, 113.33130883234467, 10.475106772363844, 18.35945447851859, 17.624689844980473, 69.8426679586787, 17.005898693278322, 25.91285172404399, 16.48415677776046, 100.10379891484548, 15.598178296681013, 59.92273930407305, -31.309464821990726, 20.960282519354806, 25.4829074036084, 36.38153888485625, 20.392497275233136, 99.39156471546681, 16.894847524249613, 19.973613241217546, 38.25372265288988, 37.32851702162848, 19.211171573714388, 14.62874668189282, 113.60190818086757, 20.199283022240625, 20.053514372531883, 53.90079639563384, 16.4181557123323, 100.97845000964215, 89.24709022988038, 51.56381841834362, -21.19949809560292, 12.357118324653863, 75.30196637339057, 12.43109042417404, 41.32925680141283, 18.945474499119094, 66.5969492342703, 65.6859523905973, 44.7610390094889, 5.2221952012687645, 32.428597821726946, 75.50938389497705, 17.696952000764384, 7.102223877210291, 94.06230734828961, 12.950300128024978, 100.44582000681984, 22.436302999059883, 15.65011033318413, 47.07748725922015, 92.41563514927385, 18.57917471693931, 64.53551603783053, 128.5028075565039], "episode_lengths": [295, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3069941561171374, "mean_inference_ms": 7.377284235128683, "mean_action_processing_ms": 0.5058081190330116, "mean_env_wait_ms": 21.77515828385058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030790090560913086, "StateBufferConnector_ms": 0.056520700454711914, "ViewRequirementAgentConnector_ms": 0.7956116199493408}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616380, "num_agent_steps_trained": 616380, "num_env_steps_sampled": 616380, "num_env_steps_trained": 616380, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 225.32594696461848, "num_env_steps_trained_throughput_per_sec": 225.32594696461848, "timesteps_total": 616380, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 616380, "timers": {"training_iteration_time_ms": 53728.296, "sample_time_ms": 36740.17, "load_time_ms": 1650.119, "load_throughput": 7135.605, "learn_time_ms": 14743.801, "learn_throughput": 798.614, "synch_weights_time_ms": 495.797}, "counters": {"num_env_steps_sampled": 616380, "num_env_steps_trained": 616380, "num_agent_steps_sampled": 616380, "num_agent_steps_trained": 616380}, "done": false, "episodes_total": 801, "training_iteration": 57, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-23-27", "timestamp": 1749302607, "time_this_iter_s": 51.18244743347168, "time_total_s": 2882.501855611801, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2882.501855611801, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 62.21967213114755, "ram_util_percent": 86.7, "gpu_util_percent0": 0.16475409836065572, "vram_util_percent0": 0.9627278645833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.38362e-05, "total_loss": -0.11005389411716764, "policy_loss": -0.020693475065953947, "vf_loss": 0.06175311611520804, "vf_explained_var": 0.9391924580389803, "kl": 0.013712523320549591, "entropy": 15.656736224347895, "entropy_coeff": 0.006918099999999997}, "model": {}, "num_grad_updates_lifetime": 22000.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 628730, "num_env_steps_trained": 628730, "num_agent_steps_sampled": 628730, "num_agent_steps_trained": 628730}, "sampler_results": {"episode_reward_max": 132.87954862395338, "episode_reward_min": -59.78544354909285, "episode_reward_mean": 43.87109926914906, "episode_len_mean": 829.3, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.381261468482837, 26.315975367450473, 55.37904338912159, 132.87954862395338, 12.151421336807253, 25.61650863677152, 14.326659363092414, 18.75839431321049, 112.7682087779823, 105.72663830269539, 77.4356942088211, 13.859655513583986, 110.37021287896086, 75.57542784210351, 83.87042336583424, 17.660328913451007, 74.9241282132264, 81.77886619158822, 10.4752550914235, 69.5623223367578, 97.50969915130929, 90.64650407655702, 18.919503591396523, 50.04247436302876, 13.444553912281208, -7.287226450356079, 18.106689507315238, 39.422233965449784, 45.90732835813121, 22.913318773747847, 4.077996520270179, 113.33130883234467, 10.475106772363844, 18.35945447851859, 17.624689844980473, 69.8426679586787, 17.005898693278322, 25.91285172404399, 16.48415677776046, 100.10379891484548, 15.598178296681013, 59.92273930407305, -31.309464821990726, 20.960282519354806, 25.4829074036084, 36.38153888485625, 20.392497275233136, 99.39156471546681, 16.894847524249613, 19.973613241217546, 38.25372265288988, 37.32851702162848, 19.211171573714388, 14.62874668189282, 113.60190818086757, 20.199283022240625, 20.053514372531883, 53.90079639563384, 16.4181557123323, 100.97845000964215, 89.24709022988038, 51.56381841834362, -21.19949809560292, 12.357118324653863, 75.30196637339057, 12.43109042417404, 41.32925680141283, 18.945474499119094, 66.5969492342703, 65.6859523905973, 44.7610390094889, 5.2221952012687645, 32.428597821726946, 75.50938389497705, 17.696952000764384, 7.102223877210291, 94.06230734828961, 12.950300128024978, 100.44582000681984, 22.436302999059883, 15.65011033318413, 47.07748725922015, 92.41563514927385, 18.57917471693931, 64.53551603783053, 128.5028075565039, 58.05124452489237, 49.34029919376594, 56.97434413034511, 10.70803377701271, 88.62705538476912, 19.254504251613962, -59.78544354909285, 109.7201421600549, 17.404647517128264, 119.72047410823913, 22.01915561736754, 18.327829960074077, 31.032761582289936, 17.157852448236277], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3075520282388227, "mean_inference_ms": 7.376111459242059, "mean_action_processing_ms": 0.5057598838406259, "mean_env_wait_ms": 21.7738266022658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03578782081604004, "StateBufferConnector_ms": 0.05756354331970215, "ViewRequirementAgentConnector_ms": 0.7952098846435547}}, "episode_reward_max": 132.87954862395338, "episode_reward_min": -59.78544354909285, "episode_reward_mean": 43.87109926914906, "episode_len_mean": 829.3, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.381261468482837, 26.315975367450473, 55.37904338912159, 132.87954862395338, 12.151421336807253, 25.61650863677152, 14.326659363092414, 18.75839431321049, 112.7682087779823, 105.72663830269539, 77.4356942088211, 13.859655513583986, 110.37021287896086, 75.57542784210351, 83.87042336583424, 17.660328913451007, 74.9241282132264, 81.77886619158822, 10.4752550914235, 69.5623223367578, 97.50969915130929, 90.64650407655702, 18.919503591396523, 50.04247436302876, 13.444553912281208, -7.287226450356079, 18.106689507315238, 39.422233965449784, 45.90732835813121, 22.913318773747847, 4.077996520270179, 113.33130883234467, 10.475106772363844, 18.35945447851859, 17.624689844980473, 69.8426679586787, 17.005898693278322, 25.91285172404399, 16.48415677776046, 100.10379891484548, 15.598178296681013, 59.92273930407305, -31.309464821990726, 20.960282519354806, 25.4829074036084, 36.38153888485625, 20.392497275233136, 99.39156471546681, 16.894847524249613, 19.973613241217546, 38.25372265288988, 37.32851702162848, 19.211171573714388, 14.62874668189282, 113.60190818086757, 20.199283022240625, 20.053514372531883, 53.90079639563384, 16.4181557123323, 100.97845000964215, 89.24709022988038, 51.56381841834362, -21.19949809560292, 12.357118324653863, 75.30196637339057, 12.43109042417404, 41.32925680141283, 18.945474499119094, 66.5969492342703, 65.6859523905973, 44.7610390094889, 5.2221952012687645, 32.428597821726946, 75.50938389497705, 17.696952000764384, 7.102223877210291, 94.06230734828961, 12.950300128024978, 100.44582000681984, 22.436302999059883, 15.65011033318413, 47.07748725922015, 92.41563514927385, 18.57917471693931, 64.53551603783053, 128.5028075565039, 58.05124452489237, 49.34029919376594, 56.97434413034511, 10.70803377701271, 88.62705538476912, 19.254504251613962, -59.78544354909285, 109.7201421600549, 17.404647517128264, 119.72047410823913, 22.01915561736754, 18.327829960074077, 31.032761582289936, 17.157852448236277], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 295, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3075520282388227, "mean_inference_ms": 7.376111459242059, "mean_action_processing_ms": 0.5057598838406259, "mean_env_wait_ms": 21.7738266022658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03578782081604004, "StateBufferConnector_ms": 0.05756354331970215, "ViewRequirementAgentConnector_ms": 0.7952098846435547}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 628730, "num_agent_steps_trained": 628730, "num_env_steps_sampled": 628730, "num_env_steps_trained": 628730, "num_env_steps_sampled_this_iter": 12350, "num_env_steps_trained_this_iter": 12350, "num_env_steps_sampled_throughput_per_sec": 222.17500357122967, "num_env_steps_trained_throughput_per_sec": 222.17500357122967, "timesteps_total": 628730, "num_steps_trained_this_iter": 12350, "agent_timesteps_total": 628730, "timers": {"training_iteration_time_ms": 53347.712, "sample_time_ms": 36494.281, "load_time_ms": 1635.634, "load_throughput": 7148.544, "learn_time_ms": 14628.839, "learn_throughput": 799.271, "synch_weights_time_ms": 496.296}, "counters": {"num_env_steps_sampled": 628730, "num_env_steps_trained": 628730, "num_agent_steps_sampled": 628730, "num_agent_steps_trained": 628730}, "done": false, "episodes_total": 815, "training_iteration": 58, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-24-23", "timestamp": 1749302663, "time_this_iter_s": 55.62120199203491, "time_total_s": 2938.123057603836, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2938.123057603836, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 62.887878787878776, "ram_util_percent": 87.29848484848485, "gpu_util_percent0": 0.1865151515151515, "vram_util_percent0": 0.9627278645833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.371270000000001e-05, "total_loss": -0.12203521188942992, "policy_loss": -0.034790896646866694, "vf_loss": 0.0616552515728201, "vf_explained_var": 0.8365954135326629, "kl": 0.014563330697168161, "entropy": 15.488706560337796, "entropy_coeff": 0.006856349999999997}, "model": {}, "num_grad_updates_lifetime": 22455.5, "diff_num_grad_updates_vs_sampler_policy": 234.5}}, "num_env_steps_sampled": 641902, "num_env_steps_trained": 641902, "num_agent_steps_sampled": 641902, "num_agent_steps_trained": 641902}, "sampler_results": {"episode_reward_max": 128.5028075565039, "episode_reward_min": -59.78544354909285, "episode_reward_mean": 43.14151597897214, "episode_len_mean": 837.52, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.87042336583424, 17.660328913451007, 74.9241282132264, 81.77886619158822, 10.4752550914235, 69.5623223367578, 97.50969915130929, 90.64650407655702, 18.919503591396523, 50.04247436302876, 13.444553912281208, -7.287226450356079, 18.106689507315238, 39.422233965449784, 45.90732835813121, 22.913318773747847, 4.077996520270179, 113.33130883234467, 10.475106772363844, 18.35945447851859, 17.624689844980473, 69.8426679586787, 17.005898693278322, 25.91285172404399, 16.48415677776046, 100.10379891484548, 15.598178296681013, 59.92273930407305, -31.309464821990726, 20.960282519354806, 25.4829074036084, 36.38153888485625, 20.392497275233136, 99.39156471546681, 16.894847524249613, 19.973613241217546, 38.25372265288988, 37.32851702162848, 19.211171573714388, 14.62874668189282, 113.60190818086757, 20.199283022240625, 20.053514372531883, 53.90079639563384, 16.4181557123323, 100.97845000964215, 89.24709022988038, 51.56381841834362, -21.19949809560292, 12.357118324653863, 75.30196637339057, 12.43109042417404, 41.32925680141283, 18.945474499119094, 66.5969492342703, 65.6859523905973, 44.7610390094889, 5.2221952012687645, 32.428597821726946, 75.50938389497705, 17.696952000764384, 7.102223877210291, 94.06230734828961, 12.950300128024978, 100.44582000681984, 22.436302999059883, 15.65011033318413, 47.07748725922015, 92.41563514927385, 18.57917471693931, 64.53551603783053, 128.5028075565039, 58.05124452489237, 49.34029919376594, 56.97434413034511, 10.70803377701271, 88.62705538476912, 19.254504251613962, -59.78544354909285, 109.7201421600549, 17.404647517128264, 119.72047410823913, 22.01915561736754, 18.327829960074077, 31.032761582289936, 17.157852448236277, -21.026090748589713, 20.903525404932573, 21.70669976178854, 55.526890597321135, 120.34349000721163, 110.2793784593733, 19.52364042052781, 12.38121571803481, 111.54677900227101, -9.53687505472803, -3.151130831978371, 123.1124092215737, 86.88967866054433, 76.08671038706149], "episode_lengths": [1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.30857565526631, "mean_inference_ms": 7.375062789746272, "mean_action_processing_ms": 0.5057383538737141, "mean_env_wait_ms": 21.772479017510975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03488755226135254, "StateBufferConnector_ms": 0.06261539459228516, "ViewRequirementAgentConnector_ms": 0.8289482593536377}}, "episode_reward_max": 128.5028075565039, "episode_reward_min": -59.78544354909285, "episode_reward_mean": 43.14151597897214, "episode_len_mean": 837.52, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [83.87042336583424, 17.660328913451007, 74.9241282132264, 81.77886619158822, 10.4752550914235, 69.5623223367578, 97.50969915130929, 90.64650407655702, 18.919503591396523, 50.04247436302876, 13.444553912281208, -7.287226450356079, 18.106689507315238, 39.422233965449784, 45.90732835813121, 22.913318773747847, 4.077996520270179, 113.33130883234467, 10.475106772363844, 18.35945447851859, 17.624689844980473, 69.8426679586787, 17.005898693278322, 25.91285172404399, 16.48415677776046, 100.10379891484548, 15.598178296681013, 59.92273930407305, -31.309464821990726, 20.960282519354806, 25.4829074036084, 36.38153888485625, 20.392497275233136, 99.39156471546681, 16.894847524249613, 19.973613241217546, 38.25372265288988, 37.32851702162848, 19.211171573714388, 14.62874668189282, 113.60190818086757, 20.199283022240625, 20.053514372531883, 53.90079639563384, 16.4181557123323, 100.97845000964215, 89.24709022988038, 51.56381841834362, -21.19949809560292, 12.357118324653863, 75.30196637339057, 12.43109042417404, 41.32925680141283, 18.945474499119094, 66.5969492342703, 65.6859523905973, 44.7610390094889, 5.2221952012687645, 32.428597821726946, 75.50938389497705, 17.696952000764384, 7.102223877210291, 94.06230734828961, 12.950300128024978, 100.44582000681984, 22.436302999059883, 15.65011033318413, 47.07748725922015, 92.41563514927385, 18.57917471693931, 64.53551603783053, 128.5028075565039, 58.05124452489237, 49.34029919376594, 56.97434413034511, 10.70803377701271, 88.62705538476912, 19.254504251613962, -59.78544354909285, 109.7201421600549, 17.404647517128264, 119.72047410823913, 22.01915561736754, 18.327829960074077, 31.032761582289936, 17.157852448236277, -21.026090748589713, 20.903525404932573, 21.70669976178854, 55.526890597321135, 120.34349000721163, 110.2793784593733, 19.52364042052781, 12.38121571803481, 111.54677900227101, -9.53687505472803, -3.151130831978371, 123.1124092215737, 86.88967866054433, 76.08671038706149], "episode_lengths": [1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.30857565526631, "mean_inference_ms": 7.375062789746272, "mean_action_processing_ms": 0.5057383538737141, "mean_env_wait_ms": 21.772479017510975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03488755226135254, "StateBufferConnector_ms": 0.06261539459228516, "ViewRequirementAgentConnector_ms": 0.8289482593536377}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 641902, "num_agent_steps_trained": 641902, "num_env_steps_sampled": 641902, "num_env_steps_trained": 641902, "num_env_steps_sampled_this_iter": 13172, "num_env_steps_trained_this_iter": 13172, "num_env_steps_sampled_throughput_per_sec": 233.68158079772036, "num_env_steps_trained_throughput_per_sec": 233.68158079772036, "timesteps_total": 641902, "num_steps_trained_this_iter": 13172, "agent_timesteps_total": 641902, "timers": {"training_iteration_time_ms": 53652.99, "sample_time_ms": 36676.207, "load_time_ms": 1667.422, "load_throughput": 7110.858, "learn_time_ms": 14752.43, "learn_throughput": 803.718, "synch_weights_time_ms": 463.254}, "counters": {"num_env_steps_sampled": 641902, "num_env_steps_trained": 641902, "num_agent_steps_sampled": 641902, "num_agent_steps_trained": 641902}, "done": false, "episodes_total": 829, "training_iteration": 59, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-25-19", "timestamp": 1749302719, "time_this_iter_s": 56.42831778526306, "time_total_s": 2994.551375389099, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 2994.551375389099, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 66.75223880597015, "ram_util_percent": 86.63731343283584, "gpu_util_percent0": 0.1744776119402985, "vram_util_percent0": 0.9627278645833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": -33.8198246710352, "episode_reward_min": -44.29455731154079, "episode_reward_mean": -39.24029762494202, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.29455731154079, -42.161987197850046, -39.34327370234044, -36.58184524194365, -33.8198246710352], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7240023271822882, "mean_inference_ms": 3.733413803730726, "mean_action_processing_ms": 0.311663176265883, "mean_env_wait_ms": 12.498966746303486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020117759704589844, "ViewRequirementAgentConnector_ms": 0.3404664993286133}}, "episode_reward_max": -33.8198246710352, "episode_reward_min": -44.29455731154079, "episode_reward_mean": -39.24029762494202, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.29455731154079, -42.161987197850046, -39.34327370234044, -36.58184524194365, -33.8198246710352], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7240023271822882, "mean_inference_ms": 3.733413803730726, "mean_action_processing_ms": 0.311663176265883, "mean_env_wait_ms": 12.498966746303486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020117759704589844, "ViewRequirementAgentConnector_ms": 0.3404664993286133}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.358098000000002e-05, "total_loss": -0.10499107596115209, "policy_loss": -0.01736787605981723, "vf_loss": 0.05444569970117655, "vf_explained_var": 0.8848258508414757, "kl": 0.013143220273126387, "entropy": 15.369676980739687, "entropy_coeff": 0.006790489999999997}, "model": {}, "num_grad_updates_lifetime": 22895.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 653430, "num_env_steps_trained": 653430, "num_agent_steps_sampled": 653430, "num_agent_steps_trained": 653430}, "sampler_results": {"episode_reward_max": 128.5028075565039, "episode_reward_min": -59.78544354909285, "episode_reward_mean": 43.601027204594274, "episode_len_mean": 837.52, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.90732835813121, 22.913318773747847, 4.077996520270179, 113.33130883234467, 10.475106772363844, 18.35945447851859, 17.624689844980473, 69.8426679586787, 17.005898693278322, 25.91285172404399, 16.48415677776046, 100.10379891484548, 15.598178296681013, 59.92273930407305, -31.309464821990726, 20.960282519354806, 25.4829074036084, 36.38153888485625, 20.392497275233136, 99.39156471546681, 16.894847524249613, 19.973613241217546, 38.25372265288988, 37.32851702162848, 19.211171573714388, 14.62874668189282, 113.60190818086757, 20.199283022240625, 20.053514372531883, 53.90079639563384, 16.4181557123323, 100.97845000964215, 89.24709022988038, 51.56381841834362, -21.19949809560292, 12.357118324653863, 75.30196637339057, 12.43109042417404, 41.32925680141283, 18.945474499119094, 66.5969492342703, 65.6859523905973, 44.7610390094889, 5.2221952012687645, 32.428597821726946, 75.50938389497705, 17.696952000764384, 7.102223877210291, 94.06230734828961, 12.950300128024978, 100.44582000681984, 22.436302999059883, 15.65011033318413, 47.07748725922015, 92.41563514927385, 18.57917471693931, 64.53551603783053, 128.5028075565039, 58.05124452489237, 49.34029919376594, 56.97434413034511, 10.70803377701271, 88.62705538476912, 19.254504251613962, -59.78544354909285, 109.7201421600549, 17.404647517128264, 119.72047410823913, 22.01915561736754, 18.327829960074077, 31.032761582289936, 17.157852448236277, -21.026090748589713, 20.903525404932573, 21.70669976178854, 55.526890597321135, 120.34349000721163, 110.2793784593733, 19.52364042052781, 12.38121571803481, 111.54677900227101, -9.53687505472803, -3.151130831978371, 123.1124092215737, 86.88967866054433, 76.08671038706149, 11.121709768951636, 75.1069077915433, 30.0120073785965, 28.387050062725063, 86.0514607778492, 116.84805248067606, 111.82289467813247, 18.58787375390021, 12.115594697820839, 92.17861188700616, 15.015282851426164, 81.0678790118835, 1.5399412845603118, 25.171612366406464], "episode_lengths": [1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.309670956504409, "mean_inference_ms": 7.3745363079319155, "mean_action_processing_ms": 0.5056989962749426, "mean_env_wait_ms": 21.77230655511328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03138566017150879, "StateBufferConnector_ms": 0.05962324142456055, "ViewRequirementAgentConnector_ms": 0.803276777267456}}, "episode_reward_max": 128.5028075565039, "episode_reward_min": -59.78544354909285, "episode_reward_mean": 43.601027204594274, "episode_len_mean": 837.52, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.90732835813121, 22.913318773747847, 4.077996520270179, 113.33130883234467, 10.475106772363844, 18.35945447851859, 17.624689844980473, 69.8426679586787, 17.005898693278322, 25.91285172404399, 16.48415677776046, 100.10379891484548, 15.598178296681013, 59.92273930407305, -31.309464821990726, 20.960282519354806, 25.4829074036084, 36.38153888485625, 20.392497275233136, 99.39156471546681, 16.894847524249613, 19.973613241217546, 38.25372265288988, 37.32851702162848, 19.211171573714388, 14.62874668189282, 113.60190818086757, 20.199283022240625, 20.053514372531883, 53.90079639563384, 16.4181557123323, 100.97845000964215, 89.24709022988038, 51.56381841834362, -21.19949809560292, 12.357118324653863, 75.30196637339057, 12.43109042417404, 41.32925680141283, 18.945474499119094, 66.5969492342703, 65.6859523905973, 44.7610390094889, 5.2221952012687645, 32.428597821726946, 75.50938389497705, 17.696952000764384, 7.102223877210291, 94.06230734828961, 12.950300128024978, 100.44582000681984, 22.436302999059883, 15.65011033318413, 47.07748725922015, 92.41563514927385, 18.57917471693931, 64.53551603783053, 128.5028075565039, 58.05124452489237, 49.34029919376594, 56.97434413034511, 10.70803377701271, 88.62705538476912, 19.254504251613962, -59.78544354909285, 109.7201421600549, 17.404647517128264, 119.72047410823913, 22.01915561736754, 18.327829960074077, 31.032761582289936, 17.157852448236277, -21.026090748589713, 20.903525404932573, 21.70669976178854, 55.526890597321135, 120.34349000721163, 110.2793784593733, 19.52364042052781, 12.38121571803481, 111.54677900227101, -9.53687505472803, -3.151130831978371, 123.1124092215737, 86.88967866054433, 76.08671038706149, 11.121709768951636, 75.1069077915433, 30.0120073785965, 28.387050062725063, 86.0514607778492, 116.84805248067606, 111.82289467813247, 18.58787375390021, 12.115594697820839, 92.17861188700616, 15.015282851426164, 81.0678790118835, 1.5399412845603118, 25.171612366406464], "episode_lengths": [1117, 295, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.309670956504409, "mean_inference_ms": 7.3745363079319155, "mean_action_processing_ms": 0.5056989962749426, "mean_env_wait_ms": 21.77230655511328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03138566017150879, "StateBufferConnector_ms": 0.05962324142456055, "ViewRequirementAgentConnector_ms": 0.803276777267456}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 653430, "num_agent_steps_trained": 653430, "num_env_steps_sampled": 653430, "num_env_steps_trained": 653430, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 222.52132749056997, "num_env_steps_trained_throughput_per_sec": 222.52132749056997, "timesteps_total": 653430, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 653430, "timers": {"training_iteration_time_ms": 53664.568, "sample_time_ms": 36667.479, "load_time_ms": 1676.146, "load_throughput": 7073.846, "learn_time_ms": 14762.797, "learn_throughput": 803.154, "synch_weights_time_ms": 465.021}, "counters": {"num_env_steps_sampled": 653430, "num_env_steps_trained": 653430, "num_agent_steps_sampled": 653430, "num_agent_steps_trained": 653430}, "done": false, "episodes_total": 843, "training_iteration": 60, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-26-29", "timestamp": 1749302789, "time_this_iter_s": 69.0797472000122, "time_total_s": 3063.6311225891113, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3063.6311225891113, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 50.93536585365853, "ram_util_percent": 86.05487804878047, "gpu_util_percent0": 0.1274390243902439, "vram_util_percent0": 0.9627278645833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.346570000000004e-05, "total_loss": -0.10422754465352471, "policy_loss": -0.019611781566026165, "vf_loss": 0.06575264349784248, "vf_explained_var": 0.9182949888996962, "kl": 0.013182309201903676, "entropy": 15.558568447392162, "entropy_coeff": 0.00673285}, "model": {}, "num_grad_updates_lifetime": 23305.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 665036, "num_env_steps_trained": 665036, "num_agent_steps_sampled": 665036, "num_agent_steps_trained": 665036}, "sampler_results": {"episode_reward_max": 128.5028075565039, "episode_reward_min": -59.78544354909285, "episode_reward_mean": 43.627967960466115, "episode_len_mean": 854.74, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.309464821990726, 20.960282519354806, 25.4829074036084, 36.38153888485625, 20.392497275233136, 99.39156471546681, 16.894847524249613, 19.973613241217546, 38.25372265288988, 37.32851702162848, 19.211171573714388, 14.62874668189282, 113.60190818086757, 20.199283022240625, 20.053514372531883, 53.90079639563384, 16.4181557123323, 100.97845000964215, 89.24709022988038, 51.56381841834362, -21.19949809560292, 12.357118324653863, 75.30196637339057, 12.43109042417404, 41.32925680141283, 18.945474499119094, 66.5969492342703, 65.6859523905973, 44.7610390094889, 5.2221952012687645, 32.428597821726946, 75.50938389497705, 17.696952000764384, 7.102223877210291, 94.06230734828961, 12.950300128024978, 100.44582000681984, 22.436302999059883, 15.65011033318413, 47.07748725922015, 92.41563514927385, 18.57917471693931, 64.53551603783053, 128.5028075565039, 58.05124452489237, 49.34029919376594, 56.97434413034511, 10.70803377701271, 88.62705538476912, 19.254504251613962, -59.78544354909285, 109.7201421600549, 17.404647517128264, 119.72047410823913, 22.01915561736754, 18.327829960074077, 31.032761582289936, 17.157852448236277, -21.026090748589713, 20.903525404932573, 21.70669976178854, 55.526890597321135, 120.34349000721163, 110.2793784593733, 19.52364042052781, 12.38121571803481, 111.54677900227101, -9.53687505472803, -3.151130831978371, 123.1124092215737, 86.88967866054433, 76.08671038706149, 11.121709768951636, 75.1069077915433, 30.0120073785965, 28.387050062725063, 86.0514607778492, 116.84805248067606, 111.82289467813247, 18.58787375390021, 12.115594697820839, 92.17861188700616, 15.015282851426164, 81.0678790118835, 1.5399412845603118, 25.171612366406464, 7.048666247996831, -25.11197287813123, 2.3055475285563736, 43.96372216063578, 81.68924416053947, 9.834382050179062, -3.610998120276543, 103.89488842541908, 18.357244762246346, 14.759337855998869, 79.72498250920445, 115.50859728153014, 85.06782482880108, 6.822104024200385], "episode_lengths": [1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 373, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3109481303265746, "mean_inference_ms": 7.37419986037895, "mean_action_processing_ms": 0.5056614402932106, "mean_env_wait_ms": 21.77263745669703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0303957462310791, "StateBufferConnector_ms": 0.05944705009460449, "ViewRequirementAgentConnector_ms": 0.8025386333465576}}, "episode_reward_max": 128.5028075565039, "episode_reward_min": -59.78544354909285, "episode_reward_mean": 43.627967960466115, "episode_len_mean": 854.74, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-31.309464821990726, 20.960282519354806, 25.4829074036084, 36.38153888485625, 20.392497275233136, 99.39156471546681, 16.894847524249613, 19.973613241217546, 38.25372265288988, 37.32851702162848, 19.211171573714388, 14.62874668189282, 113.60190818086757, 20.199283022240625, 20.053514372531883, 53.90079639563384, 16.4181557123323, 100.97845000964215, 89.24709022988038, 51.56381841834362, -21.19949809560292, 12.357118324653863, 75.30196637339057, 12.43109042417404, 41.32925680141283, 18.945474499119094, 66.5969492342703, 65.6859523905973, 44.7610390094889, 5.2221952012687645, 32.428597821726946, 75.50938389497705, 17.696952000764384, 7.102223877210291, 94.06230734828961, 12.950300128024978, 100.44582000681984, 22.436302999059883, 15.65011033318413, 47.07748725922015, 92.41563514927385, 18.57917471693931, 64.53551603783053, 128.5028075565039, 58.05124452489237, 49.34029919376594, 56.97434413034511, 10.70803377701271, 88.62705538476912, 19.254504251613962, -59.78544354909285, 109.7201421600549, 17.404647517128264, 119.72047410823913, 22.01915561736754, 18.327829960074077, 31.032761582289936, 17.157852448236277, -21.026090748589713, 20.903525404932573, 21.70669976178854, 55.526890597321135, 120.34349000721163, 110.2793784593733, 19.52364042052781, 12.38121571803481, 111.54677900227101, -9.53687505472803, -3.151130831978371, 123.1124092215737, 86.88967866054433, 76.08671038706149, 11.121709768951636, 75.1069077915433, 30.0120073785965, 28.387050062725063, 86.0514607778492, 116.84805248067606, 111.82289467813247, 18.58787375390021, 12.115594697820839, 92.17861188700616, 15.015282851426164, 81.0678790118835, 1.5399412845603118, 25.171612366406464, 7.048666247996831, -25.11197287813123, 2.3055475285563736, 43.96372216063578, 81.68924416053947, 9.834382050179062, -3.610998120276543, 103.89488842541908, 18.357244762246346, 14.759337855998869, 79.72498250920445, 115.50859728153014, 85.06782482880108, 6.822104024200385], "episode_lengths": [1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 373, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3109481303265746, "mean_inference_ms": 7.37419986037895, "mean_action_processing_ms": 0.5056614402932106, "mean_env_wait_ms": 21.77263745669703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0303957462310791, "StateBufferConnector_ms": 0.05944705009460449, "ViewRequirementAgentConnector_ms": 0.8025386333465576}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 665036, "num_agent_steps_trained": 665036, "num_env_steps_sampled": 665036, "num_env_steps_trained": 665036, "num_env_steps_sampled_this_iter": 11606, "num_env_steps_trained_this_iter": 11606, "num_env_steps_sampled_throughput_per_sec": 225.94775303580022, "num_env_steps_trained_throughput_per_sec": 225.94775303580022, "timesteps_total": 665036, "num_steps_trained_this_iter": 11606, "agent_timesteps_total": 665036, "timers": {"training_iteration_time_ms": 52811.637, "sample_time_ms": 36138.926, "load_time_ms": 1622.95, "load_throughput": 7209.218, "learn_time_ms": 14496.908, "learn_throughput": 807.082, "synch_weights_time_ms": 462.158}, "counters": {"num_env_steps_sampled": 665036, "num_env_steps_trained": 665036, "num_agent_steps_sampled": 665036, "num_agent_steps_trained": 665036}, "done": false, "episodes_total": 857, "training_iteration": 61, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-27-20", "timestamp": 1749302840, "time_this_iter_s": 51.385921239852905, "time_total_s": 3115.0170438289642, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3115.0170438289642, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 63.131147540983605, "ram_util_percent": 86.77704918032788, "gpu_util_percent0": 0.1419672131147541, "vram_util_percent0": 0.9627278645833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.334964000000001e-05, "total_loss": -0.11631941979842637, "policy_loss": -0.03004624933608748, "vf_loss": 0.05539459283959041, "vf_explained_var": 0.9499639323417176, "kl": 0.014905368937275426, "entropy": 15.484662800646843, "entropy_coeff": 0.006674819999999999}, "model": {}, "num_grad_updates_lifetime": 23745.5, "diff_num_grad_updates_vs_sampler_policy": 234.5}}, "num_env_steps_sampled": 678208, "num_env_steps_trained": 678208, "num_agent_steps_sampled": 678208, "num_agent_steps_trained": 678208}, "sampler_results": {"episode_reward_max": 128.5028075565039, "episode_reward_min": -59.78544354909285, "episode_reward_mean": 46.79988236857179, "episode_len_mean": 871.18, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.053514372531883, 53.90079639563384, 16.4181557123323, 100.97845000964215, 89.24709022988038, 51.56381841834362, -21.19949809560292, 12.357118324653863, 75.30196637339057, 12.43109042417404, 41.32925680141283, 18.945474499119094, 66.5969492342703, 65.6859523905973, 44.7610390094889, 5.2221952012687645, 32.428597821726946, 75.50938389497705, 17.696952000764384, 7.102223877210291, 94.06230734828961, 12.950300128024978, 100.44582000681984, 22.436302999059883, 15.65011033318413, 47.07748725922015, 92.41563514927385, 18.57917471693931, 64.53551603783053, 128.5028075565039, 58.05124452489237, 49.34029919376594, 56.97434413034511, 10.70803377701271, 88.62705538476912, 19.254504251613962, -59.78544354909285, 109.7201421600549, 17.404647517128264, 119.72047410823913, 22.01915561736754, 18.327829960074077, 31.032761582289936, 17.157852448236277, -21.026090748589713, 20.903525404932573, 21.70669976178854, 55.526890597321135, 120.34349000721163, 110.2793784593733, 19.52364042052781, 12.38121571803481, 111.54677900227101, -9.53687505472803, -3.151130831978371, 123.1124092215737, 86.88967866054433, 76.08671038706149, 11.121709768951636, 75.1069077915433, 30.0120073785965, 28.387050062725063, 86.0514607778492, 116.84805248067606, 111.82289467813247, 18.58787375390021, 12.115594697820839, 92.17861188700616, 15.015282851426164, 81.0678790118835, 1.5399412845603118, 25.171612366406464, 7.048666247996831, -25.11197287813123, 2.3055475285563736, 43.96372216063578, 81.68924416053947, 9.834382050179062, -3.610998120276543, 103.89488842541908, 18.357244762246346, 14.759337855998869, 79.72498250920445, 115.50859728153014, 85.06782482880108, 6.822104024200385, 85.23455923159554, 17.84344993593546, 86.03286330333823, 59.1552562384133, 109.03327374013216, 88.9707718787679, 18.050243522137084, -4.8173852517095685, 60.92706582747908, 66.94698067880978, 90.08699563356967, 22.50962304501444, 16.648526289946908, 51.96035261236846], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 373, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3122185823914276, "mean_inference_ms": 7.3744300172597805, "mean_action_processing_ms": 0.5056722567724411, "mean_env_wait_ms": 21.77384060433163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023006677627563477, "StateBufferConnector_ms": 0.058425188064575195, "ViewRequirementAgentConnector_ms": 0.8135471343994141}}, "episode_reward_max": 128.5028075565039, "episode_reward_min": -59.78544354909285, "episode_reward_mean": 46.79988236857179, "episode_len_mean": 871.18, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.053514372531883, 53.90079639563384, 16.4181557123323, 100.97845000964215, 89.24709022988038, 51.56381841834362, -21.19949809560292, 12.357118324653863, 75.30196637339057, 12.43109042417404, 41.32925680141283, 18.945474499119094, 66.5969492342703, 65.6859523905973, 44.7610390094889, 5.2221952012687645, 32.428597821726946, 75.50938389497705, 17.696952000764384, 7.102223877210291, 94.06230734828961, 12.950300128024978, 100.44582000681984, 22.436302999059883, 15.65011033318413, 47.07748725922015, 92.41563514927385, 18.57917471693931, 64.53551603783053, 128.5028075565039, 58.05124452489237, 49.34029919376594, 56.97434413034511, 10.70803377701271, 88.62705538476912, 19.254504251613962, -59.78544354909285, 109.7201421600549, 17.404647517128264, 119.72047410823913, 22.01915561736754, 18.327829960074077, 31.032761582289936, 17.157852448236277, -21.026090748589713, 20.903525404932573, 21.70669976178854, 55.526890597321135, 120.34349000721163, 110.2793784593733, 19.52364042052781, 12.38121571803481, 111.54677900227101, -9.53687505472803, -3.151130831978371, 123.1124092215737, 86.88967866054433, 76.08671038706149, 11.121709768951636, 75.1069077915433, 30.0120073785965, 28.387050062725063, 86.0514607778492, 116.84805248067606, 111.82289467813247, 18.58787375390021, 12.115594697820839, 92.17861188700616, 15.015282851426164, 81.0678790118835, 1.5399412845603118, 25.171612366406464, 7.048666247996831, -25.11197287813123, 2.3055475285563736, 43.96372216063578, 81.68924416053947, 9.834382050179062, -3.610998120276543, 103.89488842541908, 18.357244762246346, 14.759337855998869, 79.72498250920445, 115.50859728153014, 85.06782482880108, 6.822104024200385, 85.23455923159554, 17.84344993593546, 86.03286330333823, 59.1552562384133, 109.03327374013216, 88.9707718787679, 18.050243522137084, -4.8173852517095685, 60.92706582747908, 66.94698067880978, 90.08699563356967, 22.50962304501444, 16.648526289946908, 51.96035261236846], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 373, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3122185823914276, "mean_inference_ms": 7.3744300172597805, "mean_action_processing_ms": 0.5056722567724411, "mean_env_wait_ms": 21.77384060433163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023006677627563477, "StateBufferConnector_ms": 0.058425188064575195, "ViewRequirementAgentConnector_ms": 0.8135471343994141}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 678208, "num_agent_steps_trained": 678208, "num_env_steps_sampled": 678208, "num_env_steps_trained": 678208, "num_env_steps_sampled_this_iter": 13172, "num_env_steps_trained_this_iter": 13172, "num_env_steps_sampled_throughput_per_sec": 226.83156328417144, "num_env_steps_trained_throughput_per_sec": 226.83156328417144, "timesteps_total": 678208, "num_steps_trained_this_iter": 13172, "agent_timesteps_total": 678208, "timers": {"training_iteration_time_ms": 53275.043, "sample_time_ms": 36436.53, "load_time_ms": 1627.303, "load_throughput": 7290.958, "learn_time_ms": 14662.287, "learn_throughput": 809.192, "synch_weights_time_ms": 460.971}, "counters": {"num_env_steps_sampled": 678208, "num_env_steps_trained": 678208, "num_agent_steps_sampled": 678208, "num_agent_steps_trained": 678208}, "done": false, "episodes_total": 871, "training_iteration": 62, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-28-18", "timestamp": 1749302898, "time_this_iter_s": 58.10164976119995, "time_total_s": 3173.118693590164, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3173.118693590164, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 66.1764705882353, "ram_util_percent": 87.13970588235294, "gpu_util_percent0": 0.17838235294117646, "vram_util_percent0": 0.9627278645833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.321792000000002e-05, "total_loss": -0.1123636311410289, "policy_loss": -0.027646965151162523, "vf_loss": 0.05320123941147406, "vf_explained_var": 0.8453106916264483, "kl": 0.01393758891445989, "entropy": 15.29931906398974, "entropy_coeff": 0.006608959999999998}, "model": {}, "num_grad_updates_lifetime": 24170.5, "diff_num_grad_updates_vs_sampler_policy": 189.5}}, "num_env_steps_sampled": 688914, "num_env_steps_trained": 688914, "num_agent_steps_sampled": 688914, "num_agent_steps_trained": 688914}, "sampler_results": {"episode_reward_max": 128.5028075565039, "episode_reward_min": -59.78544354909285, "episode_reward_mean": 47.634127796029354, "episode_len_mean": 854.74, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7610390094889, 5.2221952012687645, 32.428597821726946, 75.50938389497705, 17.696952000764384, 7.102223877210291, 94.06230734828961, 12.950300128024978, 100.44582000681984, 22.436302999059883, 15.65011033318413, 47.07748725922015, 92.41563514927385, 18.57917471693931, 64.53551603783053, 128.5028075565039, 58.05124452489237, 49.34029919376594, 56.97434413034511, 10.70803377701271, 88.62705538476912, 19.254504251613962, -59.78544354909285, 109.7201421600549, 17.404647517128264, 119.72047410823913, 22.01915561736754, 18.327829960074077, 31.032761582289936, 17.157852448236277, -21.026090748589713, 20.903525404932573, 21.70669976178854, 55.526890597321135, 120.34349000721163, 110.2793784593733, 19.52364042052781, 12.38121571803481, 111.54677900227101, -9.53687505472803, -3.151130831978371, 123.1124092215737, 86.88967866054433, 76.08671038706149, 11.121709768951636, 75.1069077915433, 30.0120073785965, 28.387050062725063, 86.0514607778492, 116.84805248067606, 111.82289467813247, 18.58787375390021, 12.115594697820839, 92.17861188700616, 15.015282851426164, 81.0678790118835, 1.5399412845603118, 25.171612366406464, 7.048666247996831, -25.11197287813123, 2.3055475285563736, 43.96372216063578, 81.68924416053947, 9.834382050179062, -3.610998120276543, 103.89488842541908, 18.357244762246346, 14.759337855998869, 79.72498250920445, 115.50859728153014, 85.06782482880108, 6.822104024200385, 85.23455923159554, 17.84344993593546, 86.03286330333823, 59.1552562384133, 109.03327374013216, 88.9707718787679, 18.050243522137084, -4.8173852517095685, 60.92706582747908, 66.94698067880978, 90.08699563356967, 22.50962304501444, 16.648526289946908, 51.96035261236846, 73.79167758104757, 84.36361651330633, 15.115234639266792, 16.86176604997143, 79.79226221027741, 17.497327557530394, -31.204519246803738, 79.77735785963874, 108.49617966878517, 78.39459224948826, 108.95907407597572, 20.8719191251295, 13.489715272290884, 20.82847428023155], "episode_lengths": [1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 373, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.313032521529199, "mean_inference_ms": 7.374492264002743, "mean_action_processing_ms": 0.5056801940236378, "mean_env_wait_ms": 21.77348218892714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02501058578491211, "StateBufferConnector_ms": 0.04927659034729004, "ViewRequirementAgentConnector_ms": 0.8077046871185303}}, "episode_reward_max": 128.5028075565039, "episode_reward_min": -59.78544354909285, "episode_reward_mean": 47.634127796029354, "episode_len_mean": 854.74, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7610390094889, 5.2221952012687645, 32.428597821726946, 75.50938389497705, 17.696952000764384, 7.102223877210291, 94.06230734828961, 12.950300128024978, 100.44582000681984, 22.436302999059883, 15.65011033318413, 47.07748725922015, 92.41563514927385, 18.57917471693931, 64.53551603783053, 128.5028075565039, 58.05124452489237, 49.34029919376594, 56.97434413034511, 10.70803377701271, 88.62705538476912, 19.254504251613962, -59.78544354909285, 109.7201421600549, 17.404647517128264, 119.72047410823913, 22.01915561736754, 18.327829960074077, 31.032761582289936, 17.157852448236277, -21.026090748589713, 20.903525404932573, 21.70669976178854, 55.526890597321135, 120.34349000721163, 110.2793784593733, 19.52364042052781, 12.38121571803481, 111.54677900227101, -9.53687505472803, -3.151130831978371, 123.1124092215737, 86.88967866054433, 76.08671038706149, 11.121709768951636, 75.1069077915433, 30.0120073785965, 28.387050062725063, 86.0514607778492, 116.84805248067606, 111.82289467813247, 18.58787375390021, 12.115594697820839, 92.17861188700616, 15.015282851426164, 81.0678790118835, 1.5399412845603118, 25.171612366406464, 7.048666247996831, -25.11197287813123, 2.3055475285563736, 43.96372216063578, 81.68924416053947, 9.834382050179062, -3.610998120276543, 103.89488842541908, 18.357244762246346, 14.759337855998869, 79.72498250920445, 115.50859728153014, 85.06782482880108, 6.822104024200385, 85.23455923159554, 17.84344993593546, 86.03286330333823, 59.1552562384133, 109.03327374013216, 88.9707718787679, 18.050243522137084, -4.8173852517095685, 60.92706582747908, 66.94698067880978, 90.08699563356967, 22.50962304501444, 16.648526289946908, 51.96035261236846, 73.79167758104757, 84.36361651330633, 15.115234639266792, 16.86176604997143, 79.79226221027741, 17.497327557530394, -31.204519246803738, 79.77735785963874, 108.49617966878517, 78.39459224948826, 108.95907407597572, 20.8719191251295, 13.489715272290884, 20.82847428023155], "episode_lengths": [1117, 295, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 373, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.313032521529199, "mean_inference_ms": 7.374492264002743, "mean_action_processing_ms": 0.5056801940236378, "mean_env_wait_ms": 21.77348218892714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02501058578491211, "StateBufferConnector_ms": 0.04927659034729004, "ViewRequirementAgentConnector_ms": 0.8077046871185303}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688914, "num_agent_steps_trained": 688914, "num_env_steps_sampled": 688914, "num_env_steps_trained": 688914, "num_env_steps_sampled_this_iter": 10706, "num_env_steps_trained_this_iter": 10706, "num_env_steps_sampled_throughput_per_sec": 209.6328712228003, "num_env_steps_trained_throughput_per_sec": 209.6328712228003, "timesteps_total": 688914, "num_steps_trained_this_iter": 10706, "agent_timesteps_total": 688914, "timers": {"training_iteration_time_ms": 53252.562, "sample_time_ms": 36368.536, "load_time_ms": 1604.429, "load_throughput": 7343.674, "learn_time_ms": 14740.592, "learn_throughput": 799.317, "synch_weights_time_ms": 453.742}, "counters": {"num_env_steps_sampled": 688914, "num_env_steps_trained": 688914, "num_agent_steps_sampled": 688914, "num_agent_steps_trained": 688914}, "done": false, "episodes_total": 885, "training_iteration": 63, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-29-10", "timestamp": 1749302950, "time_this_iter_s": 51.10005474090576, "time_total_s": 3224.21874833107, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3224.21874833107, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 58.17540983606556, "ram_util_percent": 86.25901639344261, "gpu_util_percent0": 0.1839344262295082, "vram_util_percent0": 0.9627278645833335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.311086e-05, "total_loss": -0.07457326843740213, "policy_loss": 0.011718189701339445, "vf_loss": 0.04608697263040365, "vf_explained_var": 0.9582942003240952, "kl": 0.01656690663109746, "entropy": 15.35143609046936, "entropy_coeff": 0.00655543}, "model": {}, "num_grad_updates_lifetime": 24620.5, "diff_num_grad_updates_vs_sampler_policy": 259.5}}, "num_env_steps_sampled": 703730, "num_env_steps_trained": 703730, "num_agent_steps_sampled": 703730, "num_agent_steps_trained": 703730}, "sampler_results": {"episode_reward_max": 128.5028075565039, "episode_reward_min": -59.78544354909285, "episode_reward_mean": 53.51113067759279, "episode_len_mean": 895.84, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.53551603783053, 128.5028075565039, 58.05124452489237, 49.34029919376594, 56.97434413034511, 10.70803377701271, 88.62705538476912, 19.254504251613962, -59.78544354909285, 109.7201421600549, 17.404647517128264, 119.72047410823913, 22.01915561736754, 18.327829960074077, 31.032761582289936, 17.157852448236277, -21.026090748589713, 20.903525404932573, 21.70669976178854, 55.526890597321135, 120.34349000721163, 110.2793784593733, 19.52364042052781, 12.38121571803481, 111.54677900227101, -9.53687505472803, -3.151130831978371, 123.1124092215737, 86.88967866054433, 76.08671038706149, 11.121709768951636, 75.1069077915433, 30.0120073785965, 28.387050062725063, 86.0514607778492, 116.84805248067606, 111.82289467813247, 18.58787375390021, 12.115594697820839, 92.17861188700616, 15.015282851426164, 81.0678790118835, 1.5399412845603118, 25.171612366406464, 7.048666247996831, -25.11197287813123, 2.3055475285563736, 43.96372216063578, 81.68924416053947, 9.834382050179062, -3.610998120276543, 103.89488842541908, 18.357244762246346, 14.759337855998869, 79.72498250920445, 115.50859728153014, 85.06782482880108, 6.822104024200385, 85.23455923159554, 17.84344993593546, 86.03286330333823, 59.1552562384133, 109.03327374013216, 88.9707718787679, 18.050243522137084, -4.8173852517095685, 60.92706582747908, 66.94698067880978, 90.08699563356967, 22.50962304501444, 16.648526289946908, 51.96035261236846, 73.79167758104757, 84.36361651330633, 15.115234639266792, 16.86176604997143, 79.79226221027741, 17.497327557530394, -31.204519246803738, 79.77735785963874, 108.49617966878517, 78.39459224948826, 108.95907407597572, 20.8719191251295, 13.489715272290884, 20.82847428023155, 65.40049448569059, 100.47044597619983, 100.98496480398819, 100.1050546484851, 83.23908287176415, 126.65472191097564, 92.90653772989803, 61.64034873048662, 111.0565770798143, 13.569986787211512, 80.48486759712276, 56.307302569990036, 91.78045104204602, 89.4369816689193], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 373, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.315687527243038, "mean_inference_ms": 7.377177050689936, "mean_action_processing_ms": 0.5058951929980257, "mean_env_wait_ms": 21.77980644120061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024007320404052734, "StateBufferConnector_ms": 0.031264305114746094, "ViewRequirementAgentConnector_ms": 0.7961130142211914}}, "episode_reward_max": 128.5028075565039, "episode_reward_min": -59.78544354909285, "episode_reward_mean": 53.51113067759279, "episode_len_mean": 895.84, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [64.53551603783053, 128.5028075565039, 58.05124452489237, 49.34029919376594, 56.97434413034511, 10.70803377701271, 88.62705538476912, 19.254504251613962, -59.78544354909285, 109.7201421600549, 17.404647517128264, 119.72047410823913, 22.01915561736754, 18.327829960074077, 31.032761582289936, 17.157852448236277, -21.026090748589713, 20.903525404932573, 21.70669976178854, 55.526890597321135, 120.34349000721163, 110.2793784593733, 19.52364042052781, 12.38121571803481, 111.54677900227101, -9.53687505472803, -3.151130831978371, 123.1124092215737, 86.88967866054433, 76.08671038706149, 11.121709768951636, 75.1069077915433, 30.0120073785965, 28.387050062725063, 86.0514607778492, 116.84805248067606, 111.82289467813247, 18.58787375390021, 12.115594697820839, 92.17861188700616, 15.015282851426164, 81.0678790118835, 1.5399412845603118, 25.171612366406464, 7.048666247996831, -25.11197287813123, 2.3055475285563736, 43.96372216063578, 81.68924416053947, 9.834382050179062, -3.610998120276543, 103.89488842541908, 18.357244762246346, 14.759337855998869, 79.72498250920445, 115.50859728153014, 85.06782482880108, 6.822104024200385, 85.23455923159554, 17.84344993593546, 86.03286330333823, 59.1552562384133, 109.03327374013216, 88.9707718787679, 18.050243522137084, -4.8173852517095685, 60.92706582747908, 66.94698067880978, 90.08699563356967, 22.50962304501444, 16.648526289946908, 51.96035261236846, 73.79167758104757, 84.36361651330633, 15.115234639266792, 16.86176604997143, 79.79226221027741, 17.497327557530394, -31.204519246803738, 79.77735785963874, 108.49617966878517, 78.39459224948826, 108.95907407597572, 20.8719191251295, 13.489715272290884, 20.82847428023155, 65.40049448569059, 100.47044597619983, 100.98496480398819, 100.1050546484851, 83.23908287176415, 126.65472191097564, 92.90653772989803, 61.64034873048662, 111.0565770798143, 13.569986787211512, 80.48486759712276, 56.307302569990036, 91.78045104204602, 89.4369816689193], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 295, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 373, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.315687527243038, "mean_inference_ms": 7.377177050689936, "mean_action_processing_ms": 0.5058951929980257, "mean_env_wait_ms": 21.77980644120061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024007320404052734, "StateBufferConnector_ms": 0.031264305114746094, "ViewRequirementAgentConnector_ms": 0.7961130142211914}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 703730, "num_agent_steps_trained": 703730, "num_env_steps_sampled": 703730, "num_env_steps_trained": 703730, "num_env_steps_sampled_this_iter": 14816, "num_env_steps_trained_this_iter": 14816, "num_env_steps_sampled_throughput_per_sec": 234.54177452024769, "num_env_steps_trained_throughput_per_sec": 234.54177452024769, "timesteps_total": 703730, "num_steps_trained_this_iter": 14816, "agent_timesteps_total": 703730, "timers": {"training_iteration_time_ms": 54674.938, "sample_time_ms": 37082.267, "load_time_ms": 1698.024, "load_throughput": 7229.344, "learn_time_ms": 15356.958, "learn_throughput": 799.351, "synch_weights_time_ms": 447.737}, "counters": {"num_env_steps_sampled": 703730, "num_env_steps_trained": 703730, "num_agent_steps_sampled": 703730, "num_agent_steps_trained": 703730}, "done": false, "episodes_total": 899, "training_iteration": 64, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-30-13", "timestamp": 1749303013, "time_this_iter_s": 63.19115447998047, "time_total_s": 3287.4099028110504, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3287.4099028110504, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 69.02837837837838, "ram_util_percent": 87.53378378378379, "gpu_util_percent0": 0.18364864864864866, "vram_util_percent0": 0.9627278645833333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.296270000000003e-05, "total_loss": -0.09841530788519488, "policy_loss": -0.013578619857932009, "vf_loss": 0.053642026467316944, "vf_explained_var": 0.9136518000102625, "kl": 0.015195517193332548, "entropy": 15.645530395973019, "entropy_coeff": 0.006481349999999999}, "model": {}, "num_grad_updates_lifetime": 25085.5, "diff_num_grad_updates_vs_sampler_policy": 204.5}}, "num_env_steps_sampled": 715258, "num_env_steps_trained": 715258, "num_agent_steps_sampled": 715258, "num_agent_steps_trained": 715258}, "sampler_results": {"episode_reward_max": 126.65472191097564, "episode_reward_min": -31.204519246803738, "episode_reward_mean": 53.30090595760314, "episode_len_mean": 879.4, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.032761582289936, 17.157852448236277, -21.026090748589713, 20.903525404932573, 21.70669976178854, 55.526890597321135, 120.34349000721163, 110.2793784593733, 19.52364042052781, 12.38121571803481, 111.54677900227101, -9.53687505472803, -3.151130831978371, 123.1124092215737, 86.88967866054433, 76.08671038706149, 11.121709768951636, 75.1069077915433, 30.0120073785965, 28.387050062725063, 86.0514607778492, 116.84805248067606, 111.82289467813247, 18.58787375390021, 12.115594697820839, 92.17861188700616, 15.015282851426164, 81.0678790118835, 1.5399412845603118, 25.171612366406464, 7.048666247996831, -25.11197287813123, 2.3055475285563736, 43.96372216063578, 81.68924416053947, 9.834382050179062, -3.610998120276543, 103.89488842541908, 18.357244762246346, 14.759337855998869, 79.72498250920445, 115.50859728153014, 85.06782482880108, 6.822104024200385, 85.23455923159554, 17.84344993593546, 86.03286330333823, 59.1552562384133, 109.03327374013216, 88.9707718787679, 18.050243522137084, -4.8173852517095685, 60.92706582747908, 66.94698067880978, 90.08699563356967, 22.50962304501444, 16.648526289946908, 51.96035261236846, 73.79167758104757, 84.36361651330633, 15.115234639266792, 16.86176604997143, 79.79226221027741, 17.497327557530394, -31.204519246803738, 79.77735785963874, 108.49617966878517, 78.39459224948826, 108.95907407597572, 20.8719191251295, 13.489715272290884, 20.82847428023155, 65.40049448569059, 100.47044597619983, 100.98496480398819, 100.1050546484851, 83.23908287176415, 126.65472191097564, 92.90653772989803, 61.64034873048662, 111.0565770798143, 13.569986787211512, 80.48486759712276, 56.307302569990036, 91.78045104204602, 89.4369816689193, 35.05075423377656, 105.50346364663811, 1.3248120693427807, 72.40545024895837, 11.143546862049662, 3.555993125469552, 110.4173000102436, 9.911881288177938, 69.47134631735155, 84.21429105390517, 100.90596395274963, 17.61305914332613, 39.60536436464506, 21.254912354907262], "episode_lengths": [1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 373, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.318320621603111, "mean_inference_ms": 7.380044710888185, "mean_action_processing_ms": 0.5061629320603689, "mean_env_wait_ms": 21.786454360715503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029313087463378906, "StateBufferConnector_ms": 0.02822089195251465, "ViewRequirementAgentConnector_ms": 0.8089227676391602}}, "episode_reward_max": 126.65472191097564, "episode_reward_min": -31.204519246803738, "episode_reward_mean": 53.30090595760314, "episode_len_mean": 879.4, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.032761582289936, 17.157852448236277, -21.026090748589713, 20.903525404932573, 21.70669976178854, 55.526890597321135, 120.34349000721163, 110.2793784593733, 19.52364042052781, 12.38121571803481, 111.54677900227101, -9.53687505472803, -3.151130831978371, 123.1124092215737, 86.88967866054433, 76.08671038706149, 11.121709768951636, 75.1069077915433, 30.0120073785965, 28.387050062725063, 86.0514607778492, 116.84805248067606, 111.82289467813247, 18.58787375390021, 12.115594697820839, 92.17861188700616, 15.015282851426164, 81.0678790118835, 1.5399412845603118, 25.171612366406464, 7.048666247996831, -25.11197287813123, 2.3055475285563736, 43.96372216063578, 81.68924416053947, 9.834382050179062, -3.610998120276543, 103.89488842541908, 18.357244762246346, 14.759337855998869, 79.72498250920445, 115.50859728153014, 85.06782482880108, 6.822104024200385, 85.23455923159554, 17.84344993593546, 86.03286330333823, 59.1552562384133, 109.03327374013216, 88.9707718787679, 18.050243522137084, -4.8173852517095685, 60.92706582747908, 66.94698067880978, 90.08699563356967, 22.50962304501444, 16.648526289946908, 51.96035261236846, 73.79167758104757, 84.36361651330633, 15.115234639266792, 16.86176604997143, 79.79226221027741, 17.497327557530394, -31.204519246803738, 79.77735785963874, 108.49617966878517, 78.39459224948826, 108.95907407597572, 20.8719191251295, 13.489715272290884, 20.82847428023155, 65.40049448569059, 100.47044597619983, 100.98496480398819, 100.1050546484851, 83.23908287176415, 126.65472191097564, 92.90653772989803, 61.64034873048662, 111.0565770798143, 13.569986787211512, 80.48486759712276, 56.307302569990036, 91.78045104204602, 89.4369816689193, 35.05075423377656, 105.50346364663811, 1.3248120693427807, 72.40545024895837, 11.143546862049662, 3.555993125469552, 110.4173000102436, 9.911881288177938, 69.47134631735155, 84.21429105390517, 100.90596395274963, 17.61305914332613, 39.60536436464506, 21.254912354907262], "episode_lengths": [1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 373, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.318320621603111, "mean_inference_ms": 7.380044710888185, "mean_action_processing_ms": 0.5061629320603689, "mean_env_wait_ms": 21.786454360715503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029313087463378906, "StateBufferConnector_ms": 0.02822089195251465, "ViewRequirementAgentConnector_ms": 0.8089227676391602}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 715258, "num_agent_steps_trained": 715258, "num_env_steps_sampled": 715258, "num_env_steps_trained": 715258, "num_env_steps_sampled_this_iter": 11528, "num_env_steps_trained_this_iter": 11528, "num_env_steps_sampled_throughput_per_sec": 217.67437927459514, "num_env_steps_trained_throughput_per_sec": 217.67437927459514, "timesteps_total": 715258, "num_steps_trained_this_iter": 11528, "agent_timesteps_total": 715258, "timers": {"training_iteration_time_ms": 54338.635, "sample_time_ms": 36807.934, "load_time_ms": 1649.968, "load_throughput": 7390.082, "learn_time_ms": 15343.474, "learn_throughput": 794.696, "synch_weights_time_ms": 447.442}, "counters": {"num_env_steps_sampled": 715258, "num_env_steps_trained": 715258, "num_agent_steps_sampled": 715258, "num_agent_steps_trained": 715258}, "done": false, "episodes_total": 913, "training_iteration": 65, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-31-06", "timestamp": 1749303066, "time_this_iter_s": 52.97745943069458, "time_total_s": 3340.387362241745, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3340.387362241745, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 62.1968253968254, "ram_util_percent": 86.58095238095235, "gpu_util_percent0": 0.17460317460317462, "vram_util_percent0": 0.9627278645833336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.284742e-05, "total_loss": -0.08448030396195298, "policy_loss": -0.00030399625676430086, "vf_loss": 0.048473294757899237, "vf_explained_var": 0.9537620934573087, "kl": 0.01665769603294082, "entropy": 15.448837731101296, "entropy_coeff": 0.006423710000000001}, "model": {}, "num_grad_updates_lifetime": 25565.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 730896, "num_env_steps_trained": 730896, "num_agent_steps_sampled": 730896, "num_agent_steps_trained": 730896}, "sampler_results": {"episode_reward_max": 126.65472191097564, "episode_reward_min": -31.204519246803738, "episode_reward_mean": 59.36601675666162, "episode_len_mean": 912.28, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.88967866054433, 76.08671038706149, 11.121709768951636, 75.1069077915433, 30.0120073785965, 28.387050062725063, 86.0514607778492, 116.84805248067606, 111.82289467813247, 18.58787375390021, 12.115594697820839, 92.17861188700616, 15.015282851426164, 81.0678790118835, 1.5399412845603118, 25.171612366406464, 7.048666247996831, -25.11197287813123, 2.3055475285563736, 43.96372216063578, 81.68924416053947, 9.834382050179062, -3.610998120276543, 103.89488842541908, 18.357244762246346, 14.759337855998869, 79.72498250920445, 115.50859728153014, 85.06782482880108, 6.822104024200385, 85.23455923159554, 17.84344993593546, 86.03286330333823, 59.1552562384133, 109.03327374013216, 88.9707718787679, 18.050243522137084, -4.8173852517095685, 60.92706582747908, 66.94698067880978, 90.08699563356967, 22.50962304501444, 16.648526289946908, 51.96035261236846, 73.79167758104757, 84.36361651330633, 15.115234639266792, 16.86176604997143, 79.79226221027741, 17.497327557530394, -31.204519246803738, 79.77735785963874, 108.49617966878517, 78.39459224948826, 108.95907407597572, 20.8719191251295, 13.489715272290884, 20.82847428023155, 65.40049448569059, 100.47044597619983, 100.98496480398819, 100.1050546484851, 83.23908287176415, 126.65472191097564, 92.90653772989803, 61.64034873048662, 111.0565770798143, 13.569986787211512, 80.48486759712276, 56.307302569990036, 91.78045104204602, 89.4369816689193, 35.05075423377656, 105.50346364663811, 1.3248120693427807, 72.40545024895837, 11.143546862049662, 3.555993125469552, 110.4173000102436, 9.911881288177938, 69.47134631735155, 84.21429105390517, 100.90596395274963, 17.61305914332613, 39.60536436464506, 21.254912354907262, 99.31493053348042, 97.76243718342893, 82.51955827739843, 76.03011701960094, 115.95783596950042, 120.10097982241842, 116.49586124746857, 52.40008665699897, 89.49414653245843, 48.509385526111664, 107.82186517699431, 113.02024458282303, 101.87027090623542, -4.986093540806537], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 373, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3220808746471526, "mean_inference_ms": 7.3870288648555675, "mean_action_processing_ms": 0.5066616455556946, "mean_env_wait_ms": 21.8031908750652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03070998191833496, "StateBufferConnector_ms": 0.02807331085205078, "ViewRequirementAgentConnector_ms": 0.832073450088501}}, "episode_reward_max": 126.65472191097564, "episode_reward_min": -31.204519246803738, "episode_reward_mean": 59.36601675666162, "episode_len_mean": 912.28, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [86.88967866054433, 76.08671038706149, 11.121709768951636, 75.1069077915433, 30.0120073785965, 28.387050062725063, 86.0514607778492, 116.84805248067606, 111.82289467813247, 18.58787375390021, 12.115594697820839, 92.17861188700616, 15.015282851426164, 81.0678790118835, 1.5399412845603118, 25.171612366406464, 7.048666247996831, -25.11197287813123, 2.3055475285563736, 43.96372216063578, 81.68924416053947, 9.834382050179062, -3.610998120276543, 103.89488842541908, 18.357244762246346, 14.759337855998869, 79.72498250920445, 115.50859728153014, 85.06782482880108, 6.822104024200385, 85.23455923159554, 17.84344993593546, 86.03286330333823, 59.1552562384133, 109.03327374013216, 88.9707718787679, 18.050243522137084, -4.8173852517095685, 60.92706582747908, 66.94698067880978, 90.08699563356967, 22.50962304501444, 16.648526289946908, 51.96035261236846, 73.79167758104757, 84.36361651330633, 15.115234639266792, 16.86176604997143, 79.79226221027741, 17.497327557530394, -31.204519246803738, 79.77735785963874, 108.49617966878517, 78.39459224948826, 108.95907407597572, 20.8719191251295, 13.489715272290884, 20.82847428023155, 65.40049448569059, 100.47044597619983, 100.98496480398819, 100.1050546484851, 83.23908287176415, 126.65472191097564, 92.90653772989803, 61.64034873048662, 111.0565770798143, 13.569986787211512, 80.48486759712276, 56.307302569990036, 91.78045104204602, 89.4369816689193, 35.05075423377656, 105.50346364663811, 1.3248120693427807, 72.40545024895837, 11.143546862049662, 3.555993125469552, 110.4173000102436, 9.911881288177938, 69.47134631735155, 84.21429105390517, 100.90596395274963, 17.61305914332613, 39.60536436464506, 21.254912354907262, 99.31493053348042, 97.76243718342893, 82.51955827739843, 76.03011701960094, 115.95783596950042, 120.10097982241842, 116.49586124746857, 52.40008665699897, 89.49414653245843, 48.509385526111664, 107.82186517699431, 113.02024458282303, 101.87027090623542, -4.986093540806537], "episode_lengths": [1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 295, 295, 1117, 373, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3220808746471526, "mean_inference_ms": 7.3870288648555675, "mean_action_processing_ms": 0.5066616455556946, "mean_env_wait_ms": 21.8031908750652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03070998191833496, "StateBufferConnector_ms": 0.02807331085205078, "ViewRequirementAgentConnector_ms": 0.832073450088501}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 730896, "num_agent_steps_trained": 730896, "num_env_steps_sampled": 730896, "num_env_steps_trained": 730896, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 214.1076901861431, "num_env_steps_trained_throughput_per_sec": 214.1076901861431, "timesteps_total": 730896, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 730896, "timers": {"training_iteration_time_ms": 56459.326, "sample_time_ms": 37754.117, "load_time_ms": 2184.73, "load_throughput": 5769.317, "learn_time_ms": 15960.696, "learn_throughput": 789.715, "synch_weights_time_ms": 446.708}, "counters": {"num_env_steps_sampled": 730896, "num_env_steps_trained": 730896, "num_agent_steps_sampled": 730896, "num_agent_steps_trained": 730896}, "done": false, "episodes_total": 927, "training_iteration": 66, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-32-19", "timestamp": 1749303139, "time_this_iter_s": 73.05554914474487, "time_total_s": 3413.44291138649, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3413.44291138649, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 69.17142857142856, "ram_util_percent": 88.66666666666666, "gpu_util_percent0": 0.17476190476190476, "vram_util_percent0": 0.9627278645833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.269104000000004e-05, "total_loss": -0.09958970442790775, "policy_loss": -0.014520530003009046, "vf_loss": 0.03622719577211451, "vf_explained_var": 0.9075678276254776, "kl": 0.014462497249926697, "entropy": 15.19013248605931, "entropy_coeff": 0.0063455199999999995}, "model": {}, "num_grad_updates_lifetime": 26075.5, "diff_num_grad_updates_vs_sampler_policy": 234.5}}, "num_env_steps_sampled": 744068, "num_env_steps_trained": 744068, "num_agent_steps_sampled": 744068, "num_agent_steps_trained": 744068}, "sampler_results": {"episode_reward_max": 126.65472191097564, "episode_reward_min": -31.204519246803738, "episode_reward_mean": 61.75446013445444, "episode_len_mean": 920.5, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.5399412845603118, 25.171612366406464, 7.048666247996831, -25.11197287813123, 2.3055475285563736, 43.96372216063578, 81.68924416053947, 9.834382050179062, -3.610998120276543, 103.89488842541908, 18.357244762246346, 14.759337855998869, 79.72498250920445, 115.50859728153014, 85.06782482880108, 6.822104024200385, 85.23455923159554, 17.84344993593546, 86.03286330333823, 59.1552562384133, 109.03327374013216, 88.9707718787679, 18.050243522137084, -4.8173852517095685, 60.92706582747908, 66.94698067880978, 90.08699563356967, 22.50962304501444, 16.648526289946908, 51.96035261236846, 73.79167758104757, 84.36361651330633, 15.115234639266792, 16.86176604997143, 79.79226221027741, 17.497327557530394, -31.204519246803738, 79.77735785963874, 108.49617966878517, 78.39459224948826, 108.95907407597572, 20.8719191251295, 13.489715272290884, 20.82847428023155, 65.40049448569059, 100.47044597619983, 100.98496480398819, 100.1050546484851, 83.23908287176415, 126.65472191097564, 92.90653772989803, 61.64034873048662, 111.0565770798143, 13.569986787211512, 80.48486759712276, 56.307302569990036, 91.78045104204602, 89.4369816689193, 35.05075423377656, 105.50346364663811, 1.3248120693427807, 72.40545024895837, 11.143546862049662, 3.555993125469552, 110.4173000102436, 9.911881288177938, 69.47134631735155, 84.21429105390517, 100.90596395274963, 17.61305914332613, 39.60536436464506, 21.254912354907262, 99.31493053348042, 97.76243718342893, 82.51955827739843, 76.03011701960094, 115.95783596950042, 120.10097982241842, 116.49586124746857, 52.40008665699897, 89.49414653245843, 48.509385526111664, 107.82186517699431, 113.02024458282303, 101.87027090623542, -4.986093540806537, 11.652519136454206, 102.1255622229622, 12.781343659370442, 104.57028256619645, 91.32486952542692, 114.23462050351364, 12.58348369184257, 85.94649348315718, 106.41389953173015, 113.31922139545173, 91.10700868584391, 109.33957368558525, 35.78750236779625, 88.94967151206636], "episode_lengths": [1117, 295, 295, 1117, 373, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.326442362485656, "mean_inference_ms": 7.394484575064298, "mean_action_processing_ms": 0.5072158685798874, "mean_env_wait_ms": 21.821468309476792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03471827507019043, "StateBufferConnector_ms": 0.025101184844970703, "ViewRequirementAgentConnector_ms": 0.8462095260620117}}, "episode_reward_max": 126.65472191097564, "episode_reward_min": -31.204519246803738, "episode_reward_mean": 61.75446013445444, "episode_len_mean": 920.5, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.5399412845603118, 25.171612366406464, 7.048666247996831, -25.11197287813123, 2.3055475285563736, 43.96372216063578, 81.68924416053947, 9.834382050179062, -3.610998120276543, 103.89488842541908, 18.357244762246346, 14.759337855998869, 79.72498250920445, 115.50859728153014, 85.06782482880108, 6.822104024200385, 85.23455923159554, 17.84344993593546, 86.03286330333823, 59.1552562384133, 109.03327374013216, 88.9707718787679, 18.050243522137084, -4.8173852517095685, 60.92706582747908, 66.94698067880978, 90.08699563356967, 22.50962304501444, 16.648526289946908, 51.96035261236846, 73.79167758104757, 84.36361651330633, 15.115234639266792, 16.86176604997143, 79.79226221027741, 17.497327557530394, -31.204519246803738, 79.77735785963874, 108.49617966878517, 78.39459224948826, 108.95907407597572, 20.8719191251295, 13.489715272290884, 20.82847428023155, 65.40049448569059, 100.47044597619983, 100.98496480398819, 100.1050546484851, 83.23908287176415, 126.65472191097564, 92.90653772989803, 61.64034873048662, 111.0565770798143, 13.569986787211512, 80.48486759712276, 56.307302569990036, 91.78045104204602, 89.4369816689193, 35.05075423377656, 105.50346364663811, 1.3248120693427807, 72.40545024895837, 11.143546862049662, 3.555993125469552, 110.4173000102436, 9.911881288177938, 69.47134631735155, 84.21429105390517, 100.90596395274963, 17.61305914332613, 39.60536436464506, 21.254912354907262, 99.31493053348042, 97.76243718342893, 82.51955827739843, 76.03011701960094, 115.95783596950042, 120.10097982241842, 116.49586124746857, 52.40008665699897, 89.49414653245843, 48.509385526111664, 107.82186517699431, 113.02024458282303, 101.87027090623542, -4.986093540806537, 11.652519136454206, 102.1255622229622, 12.781343659370442, 104.57028256619645, 91.32486952542692, 114.23462050351364, 12.58348369184257, 85.94649348315718, 106.41389953173015, 113.31922139545173, 91.10700868584391, 109.33957368558525, 35.78750236779625, 88.94967151206636], "episode_lengths": [1117, 295, 295, 1117, 373, 1117, 1117, 295, 1117, 1117, 295, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.326442362485656, "mean_inference_ms": 7.394484575064298, "mean_action_processing_ms": 0.5072158685798874, "mean_env_wait_ms": 21.821468309476792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03471827507019043, "StateBufferConnector_ms": 0.025101184844970703, "ViewRequirementAgentConnector_ms": 0.8462095260620117}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744068, "num_agent_steps_trained": 744068, "num_env_steps_sampled": 744068, "num_env_steps_trained": 744068, "num_env_steps_sampled_this_iter": 13172, "num_env_steps_trained_this_iter": 13172, "num_env_steps_sampled_throughput_per_sec": 226.02873654522966, "num_env_steps_trained_throughput_per_sec": 226.02873654522966, "timesteps_total": 744068, "num_steps_trained_this_iter": 13172, "agent_timesteps_total": 744068, "timers": {"training_iteration_time_ms": 57170.76, "sample_time_ms": 38065.83, "load_time_ms": 2213.821, "load_throughput": 5767.766, "learn_time_ms": 16328.191, "learn_throughput": 782.009, "synch_weights_time_ms": 447.076}, "counters": {"num_env_steps_sampled": 744068, "num_env_steps_trained": 744068, "num_agent_steps_sampled": 744068, "num_agent_steps_trained": 744068}, "done": false, "episodes_total": 941, "training_iteration": 67, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-33-18", "timestamp": 1749303198, "time_this_iter_s": 58.30090641975403, "time_total_s": 3471.743817806244, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3471.743817806244, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 65.60735294117649, "ram_util_percent": 89.77205882352943, "gpu_util_percent0": 0.17926470588235294, "vram_util_percent0": 0.9627278645833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.255931999999997e-05, "total_loss": -0.10733095965288739, "policy_loss": -0.024552139324294602, "vf_loss": 0.046539525159614833, "vf_explained_var": 0.9585757459731812, "kl": 0.015060939887576326, "entropy": 15.480349976965721, "entropy_coeff": 0.006279660000000003}, "model": {}, "num_grad_updates_lifetime": 26545.5, "diff_num_grad_updates_vs_sampler_policy": 234.5}}, "num_env_steps_sampled": 757240, "num_env_steps_trained": 757240, "num_agent_steps_sampled": 757240, "num_agent_steps_trained": 757240}, "sampler_results": {"episode_reward_max": 126.65472191097564, "episode_reward_min": -31.204519246803738, "episode_reward_mean": 66.70385750354436, "episode_len_mean": 944.38, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.06782482880108, 6.822104024200385, 85.23455923159554, 17.84344993593546, 86.03286330333823, 59.1552562384133, 109.03327374013216, 88.9707718787679, 18.050243522137084, -4.8173852517095685, 60.92706582747908, 66.94698067880978, 90.08699563356967, 22.50962304501444, 16.648526289946908, 51.96035261236846, 73.79167758104757, 84.36361651330633, 15.115234639266792, 16.86176604997143, 79.79226221027741, 17.497327557530394, -31.204519246803738, 79.77735785963874, 108.49617966878517, 78.39459224948826, 108.95907407597572, 20.8719191251295, 13.489715272290884, 20.82847428023155, 65.40049448569059, 100.47044597619983, 100.98496480398819, 100.1050546484851, 83.23908287176415, 126.65472191097564, 92.90653772989803, 61.64034873048662, 111.0565770798143, 13.569986787211512, 80.48486759712276, 56.307302569990036, 91.78045104204602, 89.4369816689193, 35.05075423377656, 105.50346364663811, 1.3248120693427807, 72.40545024895837, 11.143546862049662, 3.555993125469552, 110.4173000102436, 9.911881288177938, 69.47134631735155, 84.21429105390517, 100.90596395274963, 17.61305914332613, 39.60536436464506, 21.254912354907262, 99.31493053348042, 97.76243718342893, 82.51955827739843, 76.03011701960094, 115.95783596950042, 120.10097982241842, 116.49586124746857, 52.40008665699897, 89.49414653245843, 48.509385526111664, 107.82186517699431, 113.02024458282303, 101.87027090623542, -4.986093540806537, 11.652519136454206, 102.1255622229622, 12.781343659370442, 104.57028256619645, 91.32486952542692, 114.23462050351364, 12.58348369184257, 85.94649348315718, 106.41389953173015, 113.31922139545173, 91.10700868584391, 109.33957368558525, 35.78750236779625, 88.94967151206636, 95.25799746409297, 60.08576315815308, 8.865987187666617, 82.30648605482743, 97.6752797668434, 104.02836569555328, 40.19484689375345, 62.26710682257678, 17.428957572383357, 116.20490770248513, 68.15304733270732, 16.78995990143662, 118.95553127933474, 81.80069571204234], "episode_lengths": [1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.331321763459835, "mean_inference_ms": 7.402051452055508, "mean_action_processing_ms": 0.507773822599032, "mean_env_wait_ms": 21.840989511293774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0647590160369873, "StateBufferConnector_ms": 0.02102208137512207, "ViewRequirementAgentConnector_ms": 0.8621087074279785}}, "episode_reward_max": 126.65472191097564, "episode_reward_min": -31.204519246803738, "episode_reward_mean": 66.70385750354436, "episode_len_mean": 944.38, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [85.06782482880108, 6.822104024200385, 85.23455923159554, 17.84344993593546, 86.03286330333823, 59.1552562384133, 109.03327374013216, 88.9707718787679, 18.050243522137084, -4.8173852517095685, 60.92706582747908, 66.94698067880978, 90.08699563356967, 22.50962304501444, 16.648526289946908, 51.96035261236846, 73.79167758104757, 84.36361651330633, 15.115234639266792, 16.86176604997143, 79.79226221027741, 17.497327557530394, -31.204519246803738, 79.77735785963874, 108.49617966878517, 78.39459224948826, 108.95907407597572, 20.8719191251295, 13.489715272290884, 20.82847428023155, 65.40049448569059, 100.47044597619983, 100.98496480398819, 100.1050546484851, 83.23908287176415, 126.65472191097564, 92.90653772989803, 61.64034873048662, 111.0565770798143, 13.569986787211512, 80.48486759712276, 56.307302569990036, 91.78045104204602, 89.4369816689193, 35.05075423377656, 105.50346364663811, 1.3248120693427807, 72.40545024895837, 11.143546862049662, 3.555993125469552, 110.4173000102436, 9.911881288177938, 69.47134631735155, 84.21429105390517, 100.90596395274963, 17.61305914332613, 39.60536436464506, 21.254912354907262, 99.31493053348042, 97.76243718342893, 82.51955827739843, 76.03011701960094, 115.95783596950042, 120.10097982241842, 116.49586124746857, 52.40008665699897, 89.49414653245843, 48.509385526111664, 107.82186517699431, 113.02024458282303, 101.87027090623542, -4.986093540806537, 11.652519136454206, 102.1255622229622, 12.781343659370442, 104.57028256619645, 91.32486952542692, 114.23462050351364, 12.58348369184257, 85.94649348315718, 106.41389953173015, 113.31922139545173, 91.10700868584391, 109.33957368558525, 35.78750236779625, 88.94967151206636, 95.25799746409297, 60.08576315815308, 8.865987187666617, 82.30648605482743, 97.6752797668434, 104.02836569555328, 40.19484689375345, 62.26710682257678, 17.428957572383357, 116.20490770248513, 68.15304733270732, 16.78995990143662, 118.95553127933474, 81.80069571204234], "episode_lengths": [1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.331321763459835, "mean_inference_ms": 7.402051452055508, "mean_action_processing_ms": 0.507773822599032, "mean_env_wait_ms": 21.840989511293774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0647590160369873, "StateBufferConnector_ms": 0.02102208137512207, "ViewRequirementAgentConnector_ms": 0.8621087074279785}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 757240, "num_agent_steps_trained": 757240, "num_env_steps_sampled": 757240, "num_env_steps_trained": 757240, "num_env_steps_sampled_this_iter": 13172, "num_env_steps_trained_this_iter": 13172, "num_env_steps_sampled_throughput_per_sec": 228.11453157605413, "num_env_steps_trained_throughput_per_sec": 228.11453157605413, "timesteps_total": 757240, "num_steps_trained_this_iter": 13172, "agent_timesteps_total": 757240, "timers": {"training_iteration_time_ms": 57386.472, "sample_time_ms": 38224.443, "load_time_ms": 2253.32, "load_throughput": 5703.14, "learn_time_ms": 16344.484, "learn_throughput": 786.259, "synch_weights_time_ms": 447.249}, "counters": {"num_env_steps_sampled": 757240, "num_env_steps_trained": 757240, "num_agent_steps_sampled": 757240, "num_agent_steps_trained": 757240}, "done": false, "episodes_total": 955, "training_iteration": 68, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-34-15", "timestamp": 1749303255, "time_this_iter_s": 57.762452125549316, "time_total_s": 3529.506269931793, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3529.506269931793, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 65.76764705882354, "ram_util_percent": 89.67500000000001, "gpu_util_percent0": 0.18808823529411767, "vram_util_percent0": 0.9627278645833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.242759999999998e-05, "total_loss": -0.0926625090588529, "policy_loss": -0.010335719949888208, "vf_loss": 0.04552640422972707, "vf_explained_var": 0.9594073311640666, "kl": 0.015863844865372387, "entropy": 15.52680415373582, "entropy_coeff": 0.006213800000000001}, "model": {}, "num_grad_updates_lifetime": 27040.5, "diff_num_grad_updates_vs_sampler_policy": 259.5}}, "num_env_steps_sampled": 772056, "num_env_steps_trained": 772056, "num_agent_steps_sampled": 772056, "num_agent_steps_trained": 772056}, "sampler_results": {"episode_reward_max": 126.65472191097564, "episode_reward_min": -31.204519246803738, "episode_reward_mean": 69.95894679461254, "episode_len_mean": 952.6, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.648526289946908, 51.96035261236846, 73.79167758104757, 84.36361651330633, 15.115234639266792, 16.86176604997143, 79.79226221027741, 17.497327557530394, -31.204519246803738, 79.77735785963874, 108.49617966878517, 78.39459224948826, 108.95907407597572, 20.8719191251295, 13.489715272290884, 20.82847428023155, 65.40049448569059, 100.47044597619983, 100.98496480398819, 100.1050546484851, 83.23908287176415, 126.65472191097564, 92.90653772989803, 61.64034873048662, 111.0565770798143, 13.569986787211512, 80.48486759712276, 56.307302569990036, 91.78045104204602, 89.4369816689193, 35.05075423377656, 105.50346364663811, 1.3248120693427807, 72.40545024895837, 11.143546862049662, 3.555993125469552, 110.4173000102436, 9.911881288177938, 69.47134631735155, 84.21429105390517, 100.90596395274963, 17.61305914332613, 39.60536436464506, 21.254912354907262, 99.31493053348042, 97.76243718342893, 82.51955827739843, 76.03011701960094, 115.95783596950042, 120.10097982241842, 116.49586124746857, 52.40008665699897, 89.49414653245843, 48.509385526111664, 107.82186517699431, 113.02024458282303, 101.87027090623542, -4.986093540806537, 11.652519136454206, 102.1255622229622, 12.781343659370442, 104.57028256619645, 91.32486952542692, 114.23462050351364, 12.58348369184257, 85.94649348315718, 106.41389953173015, 113.31922139545173, 91.10700868584391, 109.33957368558525, 35.78750236779625, 88.94967151206636, 95.25799746409297, 60.08576315815308, 8.865987187666617, 82.30648605482743, 97.6752797668434, 104.02836569555328, 40.19484689375345, 62.26710682257678, 17.428957572383357, 116.20490770248513, 68.15304733270732, 16.78995990143662, 118.95553127933474, 81.80069571204234, 82.62344174806996, 113.19190049551803, 44.939295820352285, 93.70067554190733, 11.566621294883232, 103.26368177131812, 123.93780827871421, 21.388337130647237, 120.47837003761764, 113.98214061719985, 96.45174869120908, 50.83479503467209, 57.052609761035, 83.9611295201583], "episode_lengths": [295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.337268922841899, "mean_inference_ms": 7.410647781216283, "mean_action_processing_ms": 0.5084011381780545, "mean_env_wait_ms": 21.862922049052486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06377553939819336, "StateBufferConnector_ms": 0.018892288208007812, "ViewRequirementAgentConnector_ms": 0.894111156463623}}, "episode_reward_max": 126.65472191097564, "episode_reward_min": -31.204519246803738, "episode_reward_mean": 69.95894679461254, "episode_len_mean": 952.6, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.648526289946908, 51.96035261236846, 73.79167758104757, 84.36361651330633, 15.115234639266792, 16.86176604997143, 79.79226221027741, 17.497327557530394, -31.204519246803738, 79.77735785963874, 108.49617966878517, 78.39459224948826, 108.95907407597572, 20.8719191251295, 13.489715272290884, 20.82847428023155, 65.40049448569059, 100.47044597619983, 100.98496480398819, 100.1050546484851, 83.23908287176415, 126.65472191097564, 92.90653772989803, 61.64034873048662, 111.0565770798143, 13.569986787211512, 80.48486759712276, 56.307302569990036, 91.78045104204602, 89.4369816689193, 35.05075423377656, 105.50346364663811, 1.3248120693427807, 72.40545024895837, 11.143546862049662, 3.555993125469552, 110.4173000102436, 9.911881288177938, 69.47134631735155, 84.21429105390517, 100.90596395274963, 17.61305914332613, 39.60536436464506, 21.254912354907262, 99.31493053348042, 97.76243718342893, 82.51955827739843, 76.03011701960094, 115.95783596950042, 120.10097982241842, 116.49586124746857, 52.40008665699897, 89.49414653245843, 48.509385526111664, 107.82186517699431, 113.02024458282303, 101.87027090623542, -4.986093540806537, 11.652519136454206, 102.1255622229622, 12.781343659370442, 104.57028256619645, 91.32486952542692, 114.23462050351364, 12.58348369184257, 85.94649348315718, 106.41389953173015, 113.31922139545173, 91.10700868584391, 109.33957368558525, 35.78750236779625, 88.94967151206636, 95.25799746409297, 60.08576315815308, 8.865987187666617, 82.30648605482743, 97.6752797668434, 104.02836569555328, 40.19484689375345, 62.26710682257678, 17.428957572383357, 116.20490770248513, 68.15304733270732, 16.78995990143662, 118.95553127933474, 81.80069571204234, 82.62344174806996, 113.19190049551803, 44.939295820352285, 93.70067554190733, 11.566621294883232, 103.26368177131812, 123.93780827871421, 21.388337130647237, 120.47837003761764, 113.98214061719985, 96.45174869120908, 50.83479503467209, 57.052609761035, 83.9611295201583], "episode_lengths": [295, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.337268922841899, "mean_inference_ms": 7.410647781216283, "mean_action_processing_ms": 0.5084011381780545, "mean_env_wait_ms": 21.862922049052486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06377553939819336, "StateBufferConnector_ms": 0.018892288208007812, "ViewRequirementAgentConnector_ms": 0.894111156463623}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 772056, "num_agent_steps_trained": 772056, "num_env_steps_sampled": 772056, "num_env_steps_trained": 772056, "num_env_steps_sampled_this_iter": 14816, "num_env_steps_trained_this_iter": 14816, "num_env_steps_sampled_throughput_per_sec": 233.3884561791361, "num_env_steps_trained_throughput_per_sec": 233.3884561791361, "timesteps_total": 772056, "num_steps_trained_this_iter": 14816, "agent_timesteps_total": 772056, "timers": {"training_iteration_time_ms": 58097.956, "sample_time_ms": 38579.664, "load_time_ms": 2295.001, "load_throughput": 5671.195, "learn_time_ms": 16653.797, "learn_throughput": 781.527, "synch_weights_time_ms": 450.982}, "counters": {"num_env_steps_sampled": 772056, "num_env_steps_trained": 772056, "num_agent_steps_sampled": 772056, "num_agent_steps_trained": 772056}, "done": false, "episodes_total": 969, "training_iteration": 69, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-35-19", "timestamp": 1749303319, "time_this_iter_s": 63.50016665458679, "time_total_s": 3593.00643658638, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3593.00643658638, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 68.52567567567567, "ram_util_percent": 90.14189189189189, "gpu_util_percent0": 0.1831081081081081, "vram_util_percent0": 0.9627278645833333}}
{"evaluation": {"sampler_results": {"episode_reward_max": -25.930779022110872, "episode_reward_min": -33.300599272812704, "episode_reward_mean": -29.455943676186923, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.300599272812704, -31.07199658536598, -30.05828699281746, -26.9180565078276, -25.930779022110872], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7518008130989613, "mean_inference_ms": 3.74958249023845, "mean_action_processing_ms": 0.3145553184358845, "mean_env_wait_ms": 12.550677040537181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020012855529785156, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.36032676696777344}}, "episode_reward_max": -25.930779022110872, "episode_reward_min": -33.300599272812704, "episode_reward_mean": -29.455943676186923, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.300599272812704, -31.07199658536598, -30.05828699281746, -26.9180565078276, -25.930779022110872], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7518008130989613, "mean_inference_ms": 3.74958249023845, "mean_action_processing_ms": 0.3145553184358845, "mean_env_wait_ms": 12.550677040537181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020012855529785156, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.36032676696777344}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.227944e-05, "total_loss": -0.09494904463724445, "policy_loss": -0.015374321938659043, "vf_loss": 0.049517901348669756, "vf_explained_var": 0.9323293349959634, "kl": 0.014881363605278596, "entropy": 15.455939223549583, "entropy_coeff": 0.00613972}, "model": {}, "num_grad_updates_lifetime": 27520.5, "diff_num_grad_updates_vs_sampler_policy": 219.5}}, "num_env_steps_sampled": 784406, "num_env_steps_trained": 784406, "num_agent_steps_sampled": 784406, "num_agent_steps_trained": 784406}, "sampler_results": {"episode_reward_max": 126.65472191097564, "episode_reward_min": -4.986093540806537, "episode_reward_mean": 71.93466144803597, "episode_len_mean": 960.82, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.489715272290884, 20.82847428023155, 65.40049448569059, 100.47044597619983, 100.98496480398819, 100.1050546484851, 83.23908287176415, 126.65472191097564, 92.90653772989803, 61.64034873048662, 111.0565770798143, 13.569986787211512, 80.48486759712276, 56.307302569990036, 91.78045104204602, 89.4369816689193, 35.05075423377656, 105.50346364663811, 1.3248120693427807, 72.40545024895837, 11.143546862049662, 3.555993125469552, 110.4173000102436, 9.911881288177938, 69.47134631735155, 84.21429105390517, 100.90596395274963, 17.61305914332613, 39.60536436464506, 21.254912354907262, 99.31493053348042, 97.76243718342893, 82.51955827739843, 76.03011701960094, 115.95783596950042, 120.10097982241842, 116.49586124746857, 52.40008665699897, 89.49414653245843, 48.509385526111664, 107.82186517699431, 113.02024458282303, 101.87027090623542, -4.986093540806537, 11.652519136454206, 102.1255622229622, 12.781343659370442, 104.57028256619645, 91.32486952542692, 114.23462050351364, 12.58348369184257, 85.94649348315718, 106.41389953173015, 113.31922139545173, 91.10700868584391, 109.33957368558525, 35.78750236779625, 88.94967151206636, 95.25799746409297, 60.08576315815308, 8.865987187666617, 82.30648605482743, 97.6752797668434, 104.02836569555328, 40.19484689375345, 62.26710682257678, 17.428957572383357, 116.20490770248513, 68.15304733270732, 16.78995990143662, 118.95553127933474, 81.80069571204234, 82.62344174806996, 113.19190049551803, 44.939295820352285, 93.70067554190733, 11.566621294883232, 103.26368177131812, 123.93780827871421, 21.388337130647237, 120.47837003761764, 113.98214061719985, 96.45174869120908, 50.83479503467209, 57.052609761035, 83.9611295201583, 24.229336832787226, 106.08343362229394, 71.51120013081083, 97.49033804069776, 10.860854784964525, 13.51593357238548, 118.83207940526715, 93.40243813895364, 89.26417665911863, 18.72246567118052, 10.824273780703734, 117.92140305212565, 124.75258751113793, 21.48631132584591], "episode_lengths": [295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3435720769676767, "mean_inference_ms": 7.41944702383003, "mean_action_processing_ms": 0.509012704097575, "mean_env_wait_ms": 21.88515962092812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06506752967834473, "StateBufferConnector_ms": 0.016940832138061523, "ViewRequirementAgentConnector_ms": 0.9050016403198242}}, "episode_reward_max": 126.65472191097564, "episode_reward_min": -4.986093540806537, "episode_reward_mean": 71.93466144803597, "episode_len_mean": 960.82, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.489715272290884, 20.82847428023155, 65.40049448569059, 100.47044597619983, 100.98496480398819, 100.1050546484851, 83.23908287176415, 126.65472191097564, 92.90653772989803, 61.64034873048662, 111.0565770798143, 13.569986787211512, 80.48486759712276, 56.307302569990036, 91.78045104204602, 89.4369816689193, 35.05075423377656, 105.50346364663811, 1.3248120693427807, 72.40545024895837, 11.143546862049662, 3.555993125469552, 110.4173000102436, 9.911881288177938, 69.47134631735155, 84.21429105390517, 100.90596395274963, 17.61305914332613, 39.60536436464506, 21.254912354907262, 99.31493053348042, 97.76243718342893, 82.51955827739843, 76.03011701960094, 115.95783596950042, 120.10097982241842, 116.49586124746857, 52.40008665699897, 89.49414653245843, 48.509385526111664, 107.82186517699431, 113.02024458282303, 101.87027090623542, -4.986093540806537, 11.652519136454206, 102.1255622229622, 12.781343659370442, 104.57028256619645, 91.32486952542692, 114.23462050351364, 12.58348369184257, 85.94649348315718, 106.41389953173015, 113.31922139545173, 91.10700868584391, 109.33957368558525, 35.78750236779625, 88.94967151206636, 95.25799746409297, 60.08576315815308, 8.865987187666617, 82.30648605482743, 97.6752797668434, 104.02836569555328, 40.19484689375345, 62.26710682257678, 17.428957572383357, 116.20490770248513, 68.15304733270732, 16.78995990143662, 118.95553127933474, 81.80069571204234, 82.62344174806996, 113.19190049551803, 44.939295820352285, 93.70067554190733, 11.566621294883232, 103.26368177131812, 123.93780827871421, 21.388337130647237, 120.47837003761764, 113.98214061719985, 96.45174869120908, 50.83479503467209, 57.052609761035, 83.9611295201583, 24.229336832787226, 106.08343362229394, 71.51120013081083, 97.49033804069776, 10.860854784964525, 13.51593357238548, 118.83207940526715, 93.40243813895364, 89.26417665911863, 18.72246567118052, 10.824273780703734, 117.92140305212565, 124.75258751113793, 21.48631132584591], "episode_lengths": [295, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3435720769676767, "mean_inference_ms": 7.41944702383003, "mean_action_processing_ms": 0.509012704097575, "mean_env_wait_ms": 21.88515962092812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06506752967834473, "StateBufferConnector_ms": 0.016940832138061523, "ViewRequirementAgentConnector_ms": 0.9050016403198242}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784406, "num_agent_steps_trained": 784406, "num_env_steps_sampled": 784406, "num_env_steps_trained": 784406, "num_env_steps_sampled_this_iter": 12350, "num_env_steps_trained_this_iter": 12350, "num_env_steps_sampled_throughput_per_sec": 224.38790415850437, "num_env_steps_trained_throughput_per_sec": 224.38790415850437, "timesteps_total": 784406, "num_steps_trained_this_iter": 12350, "agent_timesteps_total": 784406, "timers": {"training_iteration_time_ms": 58421.191, "sample_time_ms": 38687.416, "load_time_ms": 2323.962, "load_throughput": 5635.893, "learn_time_ms": 16832.885, "learn_throughput": 778.096, "synch_weights_time_ms": 457.012}, "counters": {"num_env_steps_sampled": 784406, "num_env_steps_trained": 784406, "num_agent_steps_sampled": 784406, "num_agent_steps_trained": 784406}, "done": false, "episodes_total": 983, "training_iteration": 70, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-36-32", "timestamp": 1749303392, "time_this_iter_s": 72.76770758628845, "time_total_s": 3665.7741441726685, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3665.7741441726685, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 53.30689655172412, "ram_util_percent": 89.28850574712642, "gpu_util_percent0": 0.13344827586206895, "vram_util_percent0": 0.962727864583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.215593999999999e-05, "total_loss": -0.09489262257523548, "policy_loss": -0.01287435830924481, "vf_loss": 0.03730829277819094, "vf_explained_var": 0.9626372801569792, "kl": 0.016261688777292595, "entropy": 15.419446594898517, "entropy_coeff": 0.006077970000000002}, "model": {}, "num_grad_updates_lifetime": 28000.5, "diff_num_grad_updates_vs_sampler_policy": 259.5}}, "num_env_steps_sampled": 799222, "num_env_steps_trained": 799222, "num_agent_steps_sampled": 799222, "num_agent_steps_trained": 799222}, "sampler_results": {"episode_reward_max": 146.10118888109002, "episode_reward_min": -4.986093540806537, "episode_reward_mean": 74.24031688370587, "episode_len_mean": 977.26, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.78045104204602, 89.4369816689193, 35.05075423377656, 105.50346364663811, 1.3248120693427807, 72.40545024895837, 11.143546862049662, 3.555993125469552, 110.4173000102436, 9.911881288177938, 69.47134631735155, 84.21429105390517, 100.90596395274963, 17.61305914332613, 39.60536436464506, 21.254912354907262, 99.31493053348042, 97.76243718342893, 82.51955827739843, 76.03011701960094, 115.95783596950042, 120.10097982241842, 116.49586124746857, 52.40008665699897, 89.49414653245843, 48.509385526111664, 107.82186517699431, 113.02024458282303, 101.87027090623542, -4.986093540806537, 11.652519136454206, 102.1255622229622, 12.781343659370442, 104.57028256619645, 91.32486952542692, 114.23462050351364, 12.58348369184257, 85.94649348315718, 106.41389953173015, 113.31922139545173, 91.10700868584391, 109.33957368558525, 35.78750236779625, 88.94967151206636, 95.25799746409297, 60.08576315815308, 8.865987187666617, 82.30648605482743, 97.6752797668434, 104.02836569555328, 40.19484689375345, 62.26710682257678, 17.428957572383357, 116.20490770248513, 68.15304733270732, 16.78995990143662, 118.95553127933474, 81.80069571204234, 82.62344174806996, 113.19190049551803, 44.939295820352285, 93.70067554190733, 11.566621294883232, 103.26368177131812, 123.93780827871421, 21.388337130647237, 120.47837003761764, 113.98214061719985, 96.45174869120908, 50.83479503467209, 57.052609761035, 83.9611295201583, 24.229336832787226, 106.08343362229394, 71.51120013081083, 97.49033804069776, 10.860854784964525, 13.51593357238548, 118.83207940526715, 93.40243813895364, 89.26417665911863, 18.72246567118052, 10.824273780703734, 117.92140305212565, 124.75258751113793, 21.48631132584591, 39.8826646827361, 84.59428701070047, 73.82303033157548, 82.24761379485564, 116.284386765098, 103.06060021556594, 119.48252338786101, 130.3483012652867, 70.41990751953378, 81.48436688638226, 77.82734017796015, 115.86513222623987, 16.282775166254925, 146.10118888109002], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3496835056392116, "mean_inference_ms": 7.428453890827057, "mean_action_processing_ms": 0.5095674909779678, "mean_env_wait_ms": 21.907620172352416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06607484817504883, "StateBufferConnector_ms": 0.014926433563232422, "ViewRequirementAgentConnector_ms": 0.9024360179901123}}, "episode_reward_max": 146.10118888109002, "episode_reward_min": -4.986093540806537, "episode_reward_mean": 74.24031688370587, "episode_len_mean": 977.26, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [91.78045104204602, 89.4369816689193, 35.05075423377656, 105.50346364663811, 1.3248120693427807, 72.40545024895837, 11.143546862049662, 3.555993125469552, 110.4173000102436, 9.911881288177938, 69.47134631735155, 84.21429105390517, 100.90596395274963, 17.61305914332613, 39.60536436464506, 21.254912354907262, 99.31493053348042, 97.76243718342893, 82.51955827739843, 76.03011701960094, 115.95783596950042, 120.10097982241842, 116.49586124746857, 52.40008665699897, 89.49414653245843, 48.509385526111664, 107.82186517699431, 113.02024458282303, 101.87027090623542, -4.986093540806537, 11.652519136454206, 102.1255622229622, 12.781343659370442, 104.57028256619645, 91.32486952542692, 114.23462050351364, 12.58348369184257, 85.94649348315718, 106.41389953173015, 113.31922139545173, 91.10700868584391, 109.33957368558525, 35.78750236779625, 88.94967151206636, 95.25799746409297, 60.08576315815308, 8.865987187666617, 82.30648605482743, 97.6752797668434, 104.02836569555328, 40.19484689375345, 62.26710682257678, 17.428957572383357, 116.20490770248513, 68.15304733270732, 16.78995990143662, 118.95553127933474, 81.80069571204234, 82.62344174806996, 113.19190049551803, 44.939295820352285, 93.70067554190733, 11.566621294883232, 103.26368177131812, 123.93780827871421, 21.388337130647237, 120.47837003761764, 113.98214061719985, 96.45174869120908, 50.83479503467209, 57.052609761035, 83.9611295201583, 24.229336832787226, 106.08343362229394, 71.51120013081083, 97.49033804069776, 10.860854784964525, 13.51593357238548, 118.83207940526715, 93.40243813895364, 89.26417665911863, 18.72246567118052, 10.824273780703734, 117.92140305212565, 124.75258751113793, 21.48631132584591, 39.8826646827361, 84.59428701070047, 73.82303033157548, 82.24761379485564, 116.284386765098, 103.06060021556594, 119.48252338786101, 130.3483012652867, 70.41990751953378, 81.48436688638226, 77.82734017796015, 115.86513222623987, 16.282775166254925, 146.10118888109002], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 295, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3496835056392116, "mean_inference_ms": 7.428453890827057, "mean_action_processing_ms": 0.5095674909779678, "mean_env_wait_ms": 21.907620172352416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06607484817504883, "StateBufferConnector_ms": 0.014926433563232422, "ViewRequirementAgentConnector_ms": 0.9024360179901123}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 799222, "num_agent_steps_trained": 799222, "num_env_steps_sampled": 799222, "num_env_steps_trained": 799222, "num_env_steps_sampled_this_iter": 14816, "num_env_steps_trained_this_iter": 14816, "num_env_steps_sampled_throughput_per_sec": 231.00624805747822, "num_env_steps_trained_throughput_per_sec": 231.00624805747822, "timesteps_total": 799222, "num_steps_trained_this_iter": 14816, "agent_timesteps_total": 799222, "timers": {"training_iteration_time_ms": 59698.284, "sample_time_ms": 39272.138, "load_time_ms": 2396.322, "load_throughput": 5599.664, "learn_time_ms": 17446.689, "learn_throughput": 769.12, "synch_weights_time_ms": 456.352}, "counters": {"num_env_steps_sampled": 799222, "num_env_steps_trained": 799222, "num_agent_steps_sampled": 799222, "num_agent_steps_trained": 799222}, "done": false, "episodes_total": 997, "training_iteration": 71, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-37-36", "timestamp": 1749303456, "time_this_iter_s": 64.15279293060303, "time_total_s": 3729.9269371032715, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3729.9269371032715, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 68.91333333333333, "ram_util_percent": 90.47333333333334, "gpu_util_percent0": 0.17813333333333334, "vram_util_percent0": 0.9627278645833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.200778e-05, "total_loss": -0.08788444179167249, "policy_loss": -0.0074569188358917906, "vf_loss": 0.035558268742407764, "vf_explained_var": 0.9658303887260203, "kl": 0.015501723348695253, "entropy": 15.253348961654975, "entropy_coeff": 0.00600389}, "model": {}, "num_grad_updates_lifetime": 28505.5, "diff_num_grad_updates_vs_sampler_policy": 244.5}}, "num_env_steps_sampled": 813216, "num_env_steps_trained": 813216, "num_agent_steps_sampled": 813216, "num_agent_steps_trained": 813216}, "sampler_results": {"episode_reward_max": 146.10118888109002, "episode_reward_min": -4.986093540806537, "episode_reward_mean": 78.75598019886853, "episode_len_mean": 993.7, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.60536436464506, 21.254912354907262, 99.31493053348042, 97.76243718342893, 82.51955827739843, 76.03011701960094, 115.95783596950042, 120.10097982241842, 116.49586124746857, 52.40008665699897, 89.49414653245843, 48.509385526111664, 107.82186517699431, 113.02024458282303, 101.87027090623542, -4.986093540806537, 11.652519136454206, 102.1255622229622, 12.781343659370442, 104.57028256619645, 91.32486952542692, 114.23462050351364, 12.58348369184257, 85.94649348315718, 106.41389953173015, 113.31922139545173, 91.10700868584391, 109.33957368558525, 35.78750236779625, 88.94967151206636, 95.25799746409297, 60.08576315815308, 8.865987187666617, 82.30648605482743, 97.6752797668434, 104.02836569555328, 40.19484689375345, 62.26710682257678, 17.428957572383357, 116.20490770248513, 68.15304733270732, 16.78995990143662, 118.95553127933474, 81.80069571204234, 82.62344174806996, 113.19190049551803, 44.939295820352285, 93.70067554190733, 11.566621294883232, 103.26368177131812, 123.93780827871421, 21.388337130647237, 120.47837003761764, 113.98214061719985, 96.45174869120908, 50.83479503467209, 57.052609761035, 83.9611295201583, 24.229336832787226, 106.08343362229394, 71.51120013081083, 97.49033804069776, 10.860854784964525, 13.51593357238548, 118.83207940526715, 93.40243813895364, 89.26417665911863, 18.72246567118052, 10.824273780703734, 117.92140305212565, 124.75258751113793, 21.48631132584591, 39.8826646827361, 84.59428701070047, 73.82303033157548, 82.24761379485564, 116.284386765098, 103.06060021556594, 119.48252338786101, 130.3483012652867, 70.41990751953378, 81.48436688638226, 77.82734017796015, 115.86513222623987, 16.282775166254925, 146.10118888109002, 91.13192235896001, 17.655668257489875, 91.75320555274504, 107.4577983427815, 96.24863907978744, 14.354675744452516, 103.02503137410936, 119.52301069239473, 91.68490962178787, 88.52992219459041, 112.81426877631924, 117.12017108957899, 87.68987040998012, 115.31253268424184], "episode_lengths": [1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.356429705516346, "mean_inference_ms": 7.438500139587445, "mean_action_processing_ms": 0.5101613739998663, "mean_env_wait_ms": 21.93222406048682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058756351470947266, "StateBufferConnector_ms": 0.019904613494873047, "ViewRequirementAgentConnector_ms": 0.9374780654907227}}, "episode_reward_max": 146.10118888109002, "episode_reward_min": -4.986093540806537, "episode_reward_mean": 78.75598019886853, "episode_len_mean": 993.7, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.60536436464506, 21.254912354907262, 99.31493053348042, 97.76243718342893, 82.51955827739843, 76.03011701960094, 115.95783596950042, 120.10097982241842, 116.49586124746857, 52.40008665699897, 89.49414653245843, 48.509385526111664, 107.82186517699431, 113.02024458282303, 101.87027090623542, -4.986093540806537, 11.652519136454206, 102.1255622229622, 12.781343659370442, 104.57028256619645, 91.32486952542692, 114.23462050351364, 12.58348369184257, 85.94649348315718, 106.41389953173015, 113.31922139545173, 91.10700868584391, 109.33957368558525, 35.78750236779625, 88.94967151206636, 95.25799746409297, 60.08576315815308, 8.865987187666617, 82.30648605482743, 97.6752797668434, 104.02836569555328, 40.19484689375345, 62.26710682257678, 17.428957572383357, 116.20490770248513, 68.15304733270732, 16.78995990143662, 118.95553127933474, 81.80069571204234, 82.62344174806996, 113.19190049551803, 44.939295820352285, 93.70067554190733, 11.566621294883232, 103.26368177131812, 123.93780827871421, 21.388337130647237, 120.47837003761764, 113.98214061719985, 96.45174869120908, 50.83479503467209, 57.052609761035, 83.9611295201583, 24.229336832787226, 106.08343362229394, 71.51120013081083, 97.49033804069776, 10.860854784964525, 13.51593357238548, 118.83207940526715, 93.40243813895364, 89.26417665911863, 18.72246567118052, 10.824273780703734, 117.92140305212565, 124.75258751113793, 21.48631132584591, 39.8826646827361, 84.59428701070047, 73.82303033157548, 82.24761379485564, 116.284386765098, 103.06060021556594, 119.48252338786101, 130.3483012652867, 70.41990751953378, 81.48436688638226, 77.82734017796015, 115.86513222623987, 16.282775166254925, 146.10118888109002, 91.13192235896001, 17.655668257489875, 91.75320555274504, 107.4577983427815, 96.24863907978744, 14.354675744452516, 103.02503137410936, 119.52301069239473, 91.68490962178787, 88.52992219459041, 112.81426877631924, 117.12017108957899, 87.68987040998012, 115.31253268424184], "episode_lengths": [1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.356429705516346, "mean_inference_ms": 7.438500139587445, "mean_action_processing_ms": 0.5101613739998663, "mean_env_wait_ms": 21.93222406048682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058756351470947266, "StateBufferConnector_ms": 0.019904613494873047, "ViewRequirementAgentConnector_ms": 0.9374780654907227}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 813216, "num_agent_steps_trained": 813216, "num_env_steps_sampled": 813216, "num_env_steps_trained": 813216, "num_env_steps_sampled_this_iter": 13994, "num_env_steps_trained_this_iter": 13994, "num_env_steps_sampled_throughput_per_sec": 238.89438868326357, "num_env_steps_trained_throughput_per_sec": 238.89438868326357, "timesteps_total": 813216, "num_steps_trained_this_iter": 13994, "agent_timesteps_total": 813216, "timers": {"training_iteration_time_ms": 59749.151, "sample_time_ms": 39343.489, "load_time_ms": 2446.516, "load_throughput": 5518.378, "learn_time_ms": 17374.342, "learn_throughput": 777.054, "synch_weights_time_ms": 456.099}, "counters": {"num_env_steps_sampled": 813216, "num_env_steps_trained": 813216, "num_agent_steps_sampled": 813216, "num_agent_steps_trained": 813216}, "done": false, "episodes_total": 1011, "training_iteration": 72, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-38-35", "timestamp": 1749303515, "time_this_iter_s": 58.60474419593811, "time_total_s": 3788.5316812992096, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3788.5316812992096, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 69.32463768115943, "ram_util_percent": 90.48695652173916, "gpu_util_percent0": 0.15043478260869567, "vram_util_percent0": 0.9627278645833331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.186784000000001e-05, "total_loss": -0.0892793479459883, "policy_loss": -0.010568024365442843, "vf_loss": 0.042041587463713115, "vf_explained_var": 0.9532490691360163, "kl": 0.015232250405082299, "entropy": 15.470348873916937, "entropy_coeff": 0.00593392}, "model": {}, "num_grad_updates_lifetime": 28995.5, "diff_num_grad_updates_vs_sampler_policy": 244.5}}, "num_env_steps_sampled": 827210, "num_env_steps_trained": 827210, "num_agent_steps_sampled": 827210, "num_agent_steps_trained": 827210}, "sampler_results": {"episode_reward_max": 146.10118888109002, "episode_reward_min": -37.16308141162999, "episode_reward_mean": 76.83816320911683, "episode_len_mean": 985.48, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.87027090623542, -4.986093540806537, 11.652519136454206, 102.1255622229622, 12.781343659370442, 104.57028256619645, 91.32486952542692, 114.23462050351364, 12.58348369184257, 85.94649348315718, 106.41389953173015, 113.31922139545173, 91.10700868584391, 109.33957368558525, 35.78750236779625, 88.94967151206636, 95.25799746409297, 60.08576315815308, 8.865987187666617, 82.30648605482743, 97.6752797668434, 104.02836569555328, 40.19484689375345, 62.26710682257678, 17.428957572383357, 116.20490770248513, 68.15304733270732, 16.78995990143662, 118.95553127933474, 81.80069571204234, 82.62344174806996, 113.19190049551803, 44.939295820352285, 93.70067554190733, 11.566621294883232, 103.26368177131812, 123.93780827871421, 21.388337130647237, 120.47837003761764, 113.98214061719985, 96.45174869120908, 50.83479503467209, 57.052609761035, 83.9611295201583, 24.229336832787226, 106.08343362229394, 71.51120013081083, 97.49033804069776, 10.860854784964525, 13.51593357238548, 118.83207940526715, 93.40243813895364, 89.26417665911863, 18.72246567118052, 10.824273780703734, 117.92140305212565, 124.75258751113793, 21.48631132584591, 39.8826646827361, 84.59428701070047, 73.82303033157548, 82.24761379485564, 116.284386765098, 103.06060021556594, 119.48252338786101, 130.3483012652867, 70.41990751953378, 81.48436688638226, 77.82734017796015, 115.86513222623987, 16.282775166254925, 146.10118888109002, 91.13192235896001, 17.655668257489875, 91.75320555274504, 107.4577983427815, 96.24863907978744, 14.354675744452516, 103.02503137410936, 119.52301069239473, 91.68490962178787, 88.52992219459041, 112.81426877631924, 117.12017108957899, 87.68987040998012, 115.31253268424184, 93.66093544536875, 99.65921096990344, 88.08469548613333, 4.3298184289820565, 110.5828114174125, 12.212670505232737, 121.326160724036, -37.16308141162999, 103.01555284843042, 14.398992393033957, 86.94725539883291, 98.64548478604762, 94.47951772619899, 98.3260015550837], "episode_lengths": [1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3626454646857056, "mean_inference_ms": 7.446435230129133, "mean_action_processing_ms": 0.5106113425856245, "mean_env_wait_ms": 21.950811528955033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05731701850891113, "StateBufferConnector_ms": 0.022752046585083008, "ViewRequirementAgentConnector_ms": 0.9133055210113525}}, "episode_reward_max": 146.10118888109002, "episode_reward_min": -37.16308141162999, "episode_reward_mean": 76.83816320911683, "episode_len_mean": 985.48, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [101.87027090623542, -4.986093540806537, 11.652519136454206, 102.1255622229622, 12.781343659370442, 104.57028256619645, 91.32486952542692, 114.23462050351364, 12.58348369184257, 85.94649348315718, 106.41389953173015, 113.31922139545173, 91.10700868584391, 109.33957368558525, 35.78750236779625, 88.94967151206636, 95.25799746409297, 60.08576315815308, 8.865987187666617, 82.30648605482743, 97.6752797668434, 104.02836569555328, 40.19484689375345, 62.26710682257678, 17.428957572383357, 116.20490770248513, 68.15304733270732, 16.78995990143662, 118.95553127933474, 81.80069571204234, 82.62344174806996, 113.19190049551803, 44.939295820352285, 93.70067554190733, 11.566621294883232, 103.26368177131812, 123.93780827871421, 21.388337130647237, 120.47837003761764, 113.98214061719985, 96.45174869120908, 50.83479503467209, 57.052609761035, 83.9611295201583, 24.229336832787226, 106.08343362229394, 71.51120013081083, 97.49033804069776, 10.860854784964525, 13.51593357238548, 118.83207940526715, 93.40243813895364, 89.26417665911863, 18.72246567118052, 10.824273780703734, 117.92140305212565, 124.75258751113793, 21.48631132584591, 39.8826646827361, 84.59428701070047, 73.82303033157548, 82.24761379485564, 116.284386765098, 103.06060021556594, 119.48252338786101, 130.3483012652867, 70.41990751953378, 81.48436688638226, 77.82734017796015, 115.86513222623987, 16.282775166254925, 146.10118888109002, 91.13192235896001, 17.655668257489875, 91.75320555274504, 107.4577983427815, 96.24863907978744, 14.354675744452516, 103.02503137410936, 119.52301069239473, 91.68490962178787, 88.52992219459041, 112.81426877631924, 117.12017108957899, 87.68987040998012, 115.31253268424184, 93.66093544536875, 99.65921096990344, 88.08469548613333, 4.3298184289820565, 110.5828114174125, 12.212670505232737, 121.326160724036, -37.16308141162999, 103.01555284843042, 14.398992393033957, 86.94725539883291, 98.64548478604762, 94.47951772619899, 98.3260015550837], "episode_lengths": [1117, 1117, 295, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3626454646857056, "mean_inference_ms": 7.446435230129133, "mean_action_processing_ms": 0.5106113425856245, "mean_env_wait_ms": 21.950811528955033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05731701850891113, "StateBufferConnector_ms": 0.022752046585083008, "ViewRequirementAgentConnector_ms": 0.9133055210113525}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 827210, "num_agent_steps_trained": 827210, "num_env_steps_sampled": 827210, "num_env_steps_trained": 827210, "num_env_steps_sampled_this_iter": 13994, "num_env_steps_trained_this_iter": 13994, "num_env_steps_sampled_throughput_per_sec": 228.7132763046419, "num_env_steps_trained_throughput_per_sec": 228.7132763046419, "timesteps_total": 827210, "num_steps_trained_this_iter": 13994, "agent_timesteps_total": 827210, "timers": {"training_iteration_time_ms": 60760.705, "sample_time_ms": 40015.133, "load_time_ms": 2518.176, "load_throughput": 5491.913, "learn_time_ms": 17639.311, "learn_throughput": 784.022, "synch_weights_time_ms": 451.845}, "counters": {"num_env_steps_sampled": 827210, "num_env_steps_trained": 827210, "num_agent_steps_sampled": 827210, "num_agent_steps_trained": 827210}, "done": false, "episodes_total": 1025, "training_iteration": 73, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-39-36", "timestamp": 1749303576, "time_this_iter_s": 61.20377540588379, "time_total_s": 3849.7354567050934, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3849.7354567050934, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 68.53472222222223, "ram_util_percent": 89.99305555555556, "gpu_util_percent0": 0.17597222222222222, "vram_util_percent0": 0.9627278645833334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.17279e-05, "total_loss": -0.08624725562829273, "policy_loss": -0.007005222331253418, "vf_loss": 0.034903637142717624, "vf_explained_var": 0.9661532366505036, "kl": 0.015195662527160607, "entropy": 15.380074224105249, "entropy_coeff": 0.005863950000000001}, "model": {}, "num_grad_updates_lifetime": 29500.5, "diff_num_grad_updates_vs_sampler_policy": 259.5}}, "num_env_steps_sampled": 842026, "num_env_steps_trained": 842026, "num_agent_steps_sampled": 842026, "num_agent_steps_trained": 842026}, "sampler_results": {"episode_reward_max": 146.10118888109002, "episode_reward_min": -37.16308141162999, "episode_reward_mean": 79.07239450669299, "episode_len_mean": 1001.92, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.78750236779625, 88.94967151206636, 95.25799746409297, 60.08576315815308, 8.865987187666617, 82.30648605482743, 97.6752797668434, 104.02836569555328, 40.19484689375345, 62.26710682257678, 17.428957572383357, 116.20490770248513, 68.15304733270732, 16.78995990143662, 118.95553127933474, 81.80069571204234, 82.62344174806996, 113.19190049551803, 44.939295820352285, 93.70067554190733, 11.566621294883232, 103.26368177131812, 123.93780827871421, 21.388337130647237, 120.47837003761764, 113.98214061719985, 96.45174869120908, 50.83479503467209, 57.052609761035, 83.9611295201583, 24.229336832787226, 106.08343362229394, 71.51120013081083, 97.49033804069776, 10.860854784964525, 13.51593357238548, 118.83207940526715, 93.40243813895364, 89.26417665911863, 18.72246567118052, 10.824273780703734, 117.92140305212565, 124.75258751113793, 21.48631132584591, 39.8826646827361, 84.59428701070047, 73.82303033157548, 82.24761379485564, 116.284386765098, 103.06060021556594, 119.48252338786101, 130.3483012652867, 70.41990751953378, 81.48436688638226, 77.82734017796015, 115.86513222623987, 16.282775166254925, 146.10118888109002, 91.13192235896001, 17.655668257489875, 91.75320555274504, 107.4577983427815, 96.24863907978744, 14.354675744452516, 103.02503137410936, 119.52301069239473, 91.68490962178787, 88.52992219459041, 112.81426877631924, 117.12017108957899, 87.68987040998012, 115.31253268424184, 93.66093544536875, 99.65921096990344, 88.08469548613333, 4.3298184289820565, 110.5828114174125, 12.212670505232737, 121.326160724036, -37.16308141162999, 103.01555284843042, 14.398992393033957, 86.94725539883291, 98.64548478604762, 94.47951772619899, 98.3260015550837, 90.78023262740182, 106.23862942014152, 15.453344547767127, 84.39654922493882, 109.78674187898476, 100.19614864482725, 117.46359583994263, 120.03410133903583, 108.31988506224175, 100.2977554458121, 9.442135638699755, 126.36437875409837, 95.31239247318985, 91.62029431349457], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3698227655656696, "mean_inference_ms": 7.456479062325116, "mean_action_processing_ms": 0.5112293956427441, "mean_env_wait_ms": 21.974238588588058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05434274673461914, "StateBufferConnector_ms": 0.02679586410522461, "ViewRequirementAgentConnector_ms": 0.9294717311859131}}, "episode_reward_max": 146.10118888109002, "episode_reward_min": -37.16308141162999, "episode_reward_mean": 79.07239450669299, "episode_len_mean": 1001.92, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.78750236779625, 88.94967151206636, 95.25799746409297, 60.08576315815308, 8.865987187666617, 82.30648605482743, 97.6752797668434, 104.02836569555328, 40.19484689375345, 62.26710682257678, 17.428957572383357, 116.20490770248513, 68.15304733270732, 16.78995990143662, 118.95553127933474, 81.80069571204234, 82.62344174806996, 113.19190049551803, 44.939295820352285, 93.70067554190733, 11.566621294883232, 103.26368177131812, 123.93780827871421, 21.388337130647237, 120.47837003761764, 113.98214061719985, 96.45174869120908, 50.83479503467209, 57.052609761035, 83.9611295201583, 24.229336832787226, 106.08343362229394, 71.51120013081083, 97.49033804069776, 10.860854784964525, 13.51593357238548, 118.83207940526715, 93.40243813895364, 89.26417665911863, 18.72246567118052, 10.824273780703734, 117.92140305212565, 124.75258751113793, 21.48631132584591, 39.8826646827361, 84.59428701070047, 73.82303033157548, 82.24761379485564, 116.284386765098, 103.06060021556594, 119.48252338786101, 130.3483012652867, 70.41990751953378, 81.48436688638226, 77.82734017796015, 115.86513222623987, 16.282775166254925, 146.10118888109002, 91.13192235896001, 17.655668257489875, 91.75320555274504, 107.4577983427815, 96.24863907978744, 14.354675744452516, 103.02503137410936, 119.52301069239473, 91.68490962178787, 88.52992219459041, 112.81426877631924, 117.12017108957899, 87.68987040998012, 115.31253268424184, 93.66093544536875, 99.65921096990344, 88.08469548613333, 4.3298184289820565, 110.5828114174125, 12.212670505232737, 121.326160724036, -37.16308141162999, 103.01555284843042, 14.398992393033957, 86.94725539883291, 98.64548478604762, 94.47951772619899, 98.3260015550837, 90.78023262740182, 106.23862942014152, 15.453344547767127, 84.39654922493882, 109.78674187898476, 100.19614864482725, 117.46359583994263, 120.03410133903583, 108.31988506224175, 100.2977554458121, 9.442135638699755, 126.36437875409837, 95.31239247318985, 91.62029431349457], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3698227655656696, "mean_inference_ms": 7.456479062325116, "mean_action_processing_ms": 0.5112293956427441, "mean_env_wait_ms": 21.974238588588058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05434274673461914, "StateBufferConnector_ms": 0.02679586410522461, "ViewRequirementAgentConnector_ms": 0.9294717311859131}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 842026, "num_agent_steps_trained": 842026, "num_env_steps_sampled": 842026, "num_env_steps_trained": 842026, "num_env_steps_sampled_this_iter": 14816, "num_env_steps_trained_this_iter": 14816, "num_env_steps_sampled_throughput_per_sec": 218.5235485512276, "num_env_steps_trained_throughput_per_sec": 218.5235485512276, "timesteps_total": 842026, "num_steps_trained_this_iter": 14816, "agent_timesteps_total": 842026, "timers": {"training_iteration_time_ms": 61223.654, "sample_time_ms": 40261.062, "load_time_ms": 2601.086, "load_throughput": 5316.855, "learn_time_ms": 17752.164, "learn_throughput": 779.037, "synch_weights_time_ms": 466.988}, "counters": {"num_env_steps_sampled": 842026, "num_env_steps_trained": 842026, "num_agent_steps_sampled": 842026, "num_agent_steps_trained": 842026}, "done": false, "episodes_total": 1039, "training_iteration": 74, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-40-44", "timestamp": 1749303644, "time_this_iter_s": 67.82150292396545, "time_total_s": 3917.556959629059, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3917.556959629059, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 70.58051948051948, "ram_util_percent": 89.40519480519478, "gpu_util_percent0": 0.16402597402597396, "vram_util_percent0": 0.962727864583333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.157974000000001e-05, "total_loss": -0.09446908399674364, "policy_loss": -0.016314309141175314, "vf_loss": 0.03222165479578755, "vf_explained_var": 0.9762423261729154, "kl": 0.016154842568265104, "entropy": 15.255284018083053, "entropy_coeff": 0.00578987}, "model": {}, "num_grad_updates_lifetime": 30035.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 857664, "num_env_steps_trained": 857664, "num_agent_steps_sampled": 857664, "num_agent_steps_trained": 857664}, "sampler_results": {"episode_reward_max": 146.10118888109002, "episode_reward_min": -37.16308141162999, "episode_reward_mean": 84.83039509374656, "episode_len_mean": 1026.58, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.95553127933474, 81.80069571204234, 82.62344174806996, 113.19190049551803, 44.939295820352285, 93.70067554190733, 11.566621294883232, 103.26368177131812, 123.93780827871421, 21.388337130647237, 120.47837003761764, 113.98214061719985, 96.45174869120908, 50.83479503467209, 57.052609761035, 83.9611295201583, 24.229336832787226, 106.08343362229394, 71.51120013081083, 97.49033804069776, 10.860854784964525, 13.51593357238548, 118.83207940526715, 93.40243813895364, 89.26417665911863, 18.72246567118052, 10.824273780703734, 117.92140305212565, 124.75258751113793, 21.48631132584591, 39.8826646827361, 84.59428701070047, 73.82303033157548, 82.24761379485564, 116.284386765098, 103.06060021556594, 119.48252338786101, 130.3483012652867, 70.41990751953378, 81.48436688638226, 77.82734017796015, 115.86513222623987, 16.282775166254925, 146.10118888109002, 91.13192235896001, 17.655668257489875, 91.75320555274504, 107.4577983427815, 96.24863907978744, 14.354675744452516, 103.02503137410936, 119.52301069239473, 91.68490962178787, 88.52992219459041, 112.81426877631924, 117.12017108957899, 87.68987040998012, 115.31253268424184, 93.66093544536875, 99.65921096990344, 88.08469548613333, 4.3298184289820565, 110.5828114174125, 12.212670505232737, 121.326160724036, -37.16308141162999, 103.01555284843042, 14.398992393033957, 86.94725539883291, 98.64548478604762, 94.47951772619899, 98.3260015550837, 90.78023262740182, 106.23862942014152, 15.453344547767127, 84.39654922493882, 109.78674187898476, 100.19614864482725, 117.46359583994263, 120.03410133903583, 108.31988506224175, 100.2977554458121, 9.442135638699755, 126.36437875409837, 95.31239247318985, 91.62029431349457, 96.78830158710517, 122.31104519667939, 96.0553001171948, 104.16360949171464, 93.12281247721286, 95.77610152821948, 84.40926308553952, 125.87416767124381, 99.86505934152807, 91.54837205296435, 110.71872077296891, 118.43400126759127, 98.0047741473021, 132.72440940043714], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.377837860410697, "mean_inference_ms": 7.471074122722834, "mean_action_processing_ms": 0.5121660956113191, "mean_env_wait_ms": 22.00706969651237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04040098190307617, "StateBufferConnector_ms": 0.028843164443969727, "ViewRequirementAgentConnector_ms": 0.9585704803466797}}, "episode_reward_max": 146.10118888109002, "episode_reward_min": -37.16308141162999, "episode_reward_mean": 84.83039509374656, "episode_len_mean": 1026.58, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [118.95553127933474, 81.80069571204234, 82.62344174806996, 113.19190049551803, 44.939295820352285, 93.70067554190733, 11.566621294883232, 103.26368177131812, 123.93780827871421, 21.388337130647237, 120.47837003761764, 113.98214061719985, 96.45174869120908, 50.83479503467209, 57.052609761035, 83.9611295201583, 24.229336832787226, 106.08343362229394, 71.51120013081083, 97.49033804069776, 10.860854784964525, 13.51593357238548, 118.83207940526715, 93.40243813895364, 89.26417665911863, 18.72246567118052, 10.824273780703734, 117.92140305212565, 124.75258751113793, 21.48631132584591, 39.8826646827361, 84.59428701070047, 73.82303033157548, 82.24761379485564, 116.284386765098, 103.06060021556594, 119.48252338786101, 130.3483012652867, 70.41990751953378, 81.48436688638226, 77.82734017796015, 115.86513222623987, 16.282775166254925, 146.10118888109002, 91.13192235896001, 17.655668257489875, 91.75320555274504, 107.4577983427815, 96.24863907978744, 14.354675744452516, 103.02503137410936, 119.52301069239473, 91.68490962178787, 88.52992219459041, 112.81426877631924, 117.12017108957899, 87.68987040998012, 115.31253268424184, 93.66093544536875, 99.65921096990344, 88.08469548613333, 4.3298184289820565, 110.5828114174125, 12.212670505232737, 121.326160724036, -37.16308141162999, 103.01555284843042, 14.398992393033957, 86.94725539883291, 98.64548478604762, 94.47951772619899, 98.3260015550837, 90.78023262740182, 106.23862942014152, 15.453344547767127, 84.39654922493882, 109.78674187898476, 100.19614864482725, 117.46359583994263, 120.03410133903583, 108.31988506224175, 100.2977554458121, 9.442135638699755, 126.36437875409837, 95.31239247318985, 91.62029431349457, 96.78830158710517, 122.31104519667939, 96.0553001171948, 104.16360949171464, 93.12281247721286, 95.77610152821948, 84.40926308553952, 125.87416767124381, 99.86505934152807, 91.54837205296435, 110.71872077296891, 118.43400126759127, 98.0047741473021, 132.72440940043714], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.377837860410697, "mean_inference_ms": 7.471074122722834, "mean_action_processing_ms": 0.5121660956113191, "mean_env_wait_ms": 22.00706969651237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04040098190307617, "StateBufferConnector_ms": 0.028843164443969727, "ViewRequirementAgentConnector_ms": 0.9585704803466797}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 857664, "num_agent_steps_trained": 857664, "num_env_steps_sampled": 857664, "num_env_steps_trained": 857664, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 190.8812504639579, "num_env_steps_trained_throughput_per_sec": 190.8812504639579, "timesteps_total": 857664, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 857664, "timers": {"training_iteration_time_ms": 64120.199, "sample_time_ms": 41306.458, "load_time_ms": 3882.664, "load_throughput": 3667.74, "learn_time_ms": 18292.977, "learn_throughput": 778.474, "synch_weights_time_ms": 471.352}, "counters": {"num_env_steps_sampled": 857664, "num_env_steps_trained": 857664, "num_agent_steps_sampled": 857664, "num_agent_steps_trained": 857664}, "done": false, "episodes_total": 1053, "training_iteration": 75, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-42-06", "timestamp": 1749303726, "time_this_iter_s": 81.93983507156372, "time_total_s": 3999.4967947006226, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 3999.4967947006226, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 68.33076923076922, "ram_util_percent": 77.65384615384615, "gpu_util_percent0": 0.1235164835164835, "vram_util_percent0": 0.8202284369276557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.142336000000003e-05, "total_loss": -0.06452629799560572, "policy_loss": 0.012750653022353967, "vf_loss": 0.03235051505975067, "vf_explained_var": 0.9647197632835461, "kl": 0.01649361102099958, "entropy": 15.319053926834693, "entropy_coeff": 0.0057116799999999985}, "model": {}, "num_grad_updates_lifetime": 30570.5, "diff_num_grad_updates_vs_sampler_policy": 259.5}}, "num_env_steps_sampled": 872480, "num_env_steps_trained": 872480, "num_agent_steps_sampled": 872480, "num_agent_steps_trained": 872480}, "sampler_results": {"episode_reward_max": 146.10118888109002, "episode_reward_min": -37.16308141162999, "episode_reward_mean": 85.90811243074425, "episode_len_mean": 1026.58, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.052609761035, 83.9611295201583, 24.229336832787226, 106.08343362229394, 71.51120013081083, 97.49033804069776, 10.860854784964525, 13.51593357238548, 118.83207940526715, 93.40243813895364, 89.26417665911863, 18.72246567118052, 10.824273780703734, 117.92140305212565, 124.75258751113793, 21.48631132584591, 39.8826646827361, 84.59428701070047, 73.82303033157548, 82.24761379485564, 116.284386765098, 103.06060021556594, 119.48252338786101, 130.3483012652867, 70.41990751953378, 81.48436688638226, 77.82734017796015, 115.86513222623987, 16.282775166254925, 146.10118888109002, 91.13192235896001, 17.655668257489875, 91.75320555274504, 107.4577983427815, 96.24863907978744, 14.354675744452516, 103.02503137410936, 119.52301069239473, 91.68490962178787, 88.52992219459041, 112.81426877631924, 117.12017108957899, 87.68987040998012, 115.31253268424184, 93.66093544536875, 99.65921096990344, 88.08469548613333, 4.3298184289820565, 110.5828114174125, 12.212670505232737, 121.326160724036, -37.16308141162999, 103.01555284843042, 14.398992393033957, 86.94725539883291, 98.64548478604762, 94.47951772619899, 98.3260015550837, 90.78023262740182, 106.23862942014152, 15.453344547767127, 84.39654922493882, 109.78674187898476, 100.19614864482725, 117.46359583994263, 120.03410133903583, 108.31988506224175, 100.2977554458121, 9.442135638699755, 126.36437875409837, 95.31239247318985, 91.62029431349457, 96.78830158710517, 122.31104519667939, 96.0553001171948, 104.16360949171464, 93.12281247721286, 95.77610152821948, 84.40926308553952, 125.87416767124381, 99.86505934152807, 91.54837205296435, 110.71872077296891, 118.43400126759127, 98.0047741473021, 132.72440940043714, 97.74608296831592, 102.17934185910468, 92.06429055080608, 98.18869126253385, 94.30333143375357, 92.32248862207226, 17.113374517478963, 102.96251334200718, 67.5329946060639, 90.61749218193458, 109.18033275127976, 124.33297399805039, 102.76027812053002, 93.58259093932587], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.384961413689358, "mean_inference_ms": 7.4867492259372845, "mean_action_processing_ms": 0.5131462440622274, "mean_env_wait_ms": 22.042123971837484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03736472129821777, "StateBufferConnector_ms": 0.029947757720947266, "ViewRequirementAgentConnector_ms": 0.9821121692657471}}, "episode_reward_max": 146.10118888109002, "episode_reward_min": -37.16308141162999, "episode_reward_mean": 85.90811243074425, "episode_len_mean": 1026.58, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [57.052609761035, 83.9611295201583, 24.229336832787226, 106.08343362229394, 71.51120013081083, 97.49033804069776, 10.860854784964525, 13.51593357238548, 118.83207940526715, 93.40243813895364, 89.26417665911863, 18.72246567118052, 10.824273780703734, 117.92140305212565, 124.75258751113793, 21.48631132584591, 39.8826646827361, 84.59428701070047, 73.82303033157548, 82.24761379485564, 116.284386765098, 103.06060021556594, 119.48252338786101, 130.3483012652867, 70.41990751953378, 81.48436688638226, 77.82734017796015, 115.86513222623987, 16.282775166254925, 146.10118888109002, 91.13192235896001, 17.655668257489875, 91.75320555274504, 107.4577983427815, 96.24863907978744, 14.354675744452516, 103.02503137410936, 119.52301069239473, 91.68490962178787, 88.52992219459041, 112.81426877631924, 117.12017108957899, 87.68987040998012, 115.31253268424184, 93.66093544536875, 99.65921096990344, 88.08469548613333, 4.3298184289820565, 110.5828114174125, 12.212670505232737, 121.326160724036, -37.16308141162999, 103.01555284843042, 14.398992393033957, 86.94725539883291, 98.64548478604762, 94.47951772619899, 98.3260015550837, 90.78023262740182, 106.23862942014152, 15.453344547767127, 84.39654922493882, 109.78674187898476, 100.19614864482725, 117.46359583994263, 120.03410133903583, 108.31988506224175, 100.2977554458121, 9.442135638699755, 126.36437875409837, 95.31239247318985, 91.62029431349457, 96.78830158710517, 122.31104519667939, 96.0553001171948, 104.16360949171464, 93.12281247721286, 95.77610152821948, 84.40926308553952, 125.87416767124381, 99.86505934152807, 91.54837205296435, 110.71872077296891, 118.43400126759127, 98.0047741473021, 132.72440940043714, 97.74608296831592, 102.17934185910468, 92.06429055080608, 98.18869126253385, 94.30333143375357, 92.32248862207226, 17.113374517478963, 102.96251334200718, 67.5329946060639, 90.61749218193458, 109.18033275127976, 124.33297399805039, 102.76027812053002, 93.58259093932587], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 295, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.384961413689358, "mean_inference_ms": 7.4867492259372845, "mean_action_processing_ms": 0.5131462440622274, "mean_env_wait_ms": 22.042123971837484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03736472129821777, "StateBufferConnector_ms": 0.029947757720947266, "ViewRequirementAgentConnector_ms": 0.9821121692657471}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 872480, "num_agent_steps_trained": 872480, "num_env_steps_sampled": 872480, "num_env_steps_trained": 872480, "num_env_steps_sampled_this_iter": 14816, "num_env_steps_trained_this_iter": 14816, "num_env_steps_sampled_throughput_per_sec": 258.5790320480995, "num_env_steps_trained_throughput_per_sec": 258.5790320480995, "timesteps_total": 872480, "num_steps_trained_this_iter": 14816, "agent_timesteps_total": 872480, "timers": {"training_iteration_time_ms": 62546.274, "sample_time_ms": 41157.499, "load_time_ms": 3347.2, "load_throughput": 4229.923, "learn_time_ms": 17417.855, "learn_throughput": 812.867, "synch_weights_time_ms": 477.135}, "counters": {"num_env_steps_sampled": 872480, "num_env_steps_trained": 872480, "num_agent_steps_sampled": 872480, "num_agent_steps_trained": 872480}, "done": false, "episodes_total": 1067, "training_iteration": 76, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-43-04", "timestamp": 1749303784, "time_this_iter_s": 57.317763805389404, "time_total_s": 4056.814558506012, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4056.814558506012, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 76.67424242424241, "ram_util_percent": 46.521212121212116, "gpu_util_percent0": 0.07560606060606062, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.127520000000001e-05, "total_loss": -0.07809506530186865, "policy_loss": -0.0030041447757477207, "vf_loss": 0.03720950330037395, "vf_explained_var": 0.9639090691293989, "kl": 0.016732272971424482, "entropy": 15.392481967381068, "entropy_coeff": 0.005637599999999999}, "model": {}, "num_grad_updates_lifetime": 31075.5, "diff_num_grad_updates_vs_sampler_policy": 244.5}}, "num_env_steps_sampled": 886474, "num_env_steps_trained": 886474, "num_agent_steps_sampled": 886474, "num_agent_steps_trained": 886474}, "sampler_results": {"episode_reward_max": 146.10118888109002, "episode_reward_min": -37.16308141162999, "episode_reward_mean": 88.48053450861232, "episode_len_mean": 1034.8, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.75258751113793, 21.48631132584591, 39.8826646827361, 84.59428701070047, 73.82303033157548, 82.24761379485564, 116.284386765098, 103.06060021556594, 119.48252338786101, 130.3483012652867, 70.41990751953378, 81.48436688638226, 77.82734017796015, 115.86513222623987, 16.282775166254925, 146.10118888109002, 91.13192235896001, 17.655668257489875, 91.75320555274504, 107.4577983427815, 96.24863907978744, 14.354675744452516, 103.02503137410936, 119.52301069239473, 91.68490962178787, 88.52992219459041, 112.81426877631924, 117.12017108957899, 87.68987040998012, 115.31253268424184, 93.66093544536875, 99.65921096990344, 88.08469548613333, 4.3298184289820565, 110.5828114174125, 12.212670505232737, 121.326160724036, -37.16308141162999, 103.01555284843042, 14.398992393033957, 86.94725539883291, 98.64548478604762, 94.47951772619899, 98.3260015550837, 90.78023262740182, 106.23862942014152, 15.453344547767127, 84.39654922493882, 109.78674187898476, 100.19614864482725, 117.46359583994263, 120.03410133903583, 108.31988506224175, 100.2977554458121, 9.442135638699755, 126.36437875409837, 95.31239247318985, 91.62029431349457, 96.78830158710517, 122.31104519667939, 96.0553001171948, 104.16360949171464, 93.12281247721286, 95.77610152821948, 84.40926308553952, 125.87416767124381, 99.86505934152807, 91.54837205296435, 110.71872077296891, 118.43400126759127, 98.0047741473021, 132.72440940043714, 97.74608296831592, 102.17934185910468, 92.06429055080608, 98.18869126253385, 94.30333143375357, 92.32248862207226, 17.113374517478963, 102.96251334200718, 67.5329946060639, 90.61749218193458, 109.18033275127976, 124.33297399805039, 102.76027812053002, 93.58259093932587, 99.12007137292741, 119.21414541152033, 92.80025131364495, 1.544108687954276, 79.07219925241317, 65.65222226447928, 15.120357532661274, 118.7327703485935, 92.61166549400086, 94.42851038955254, 109.38237183726027, 16.857431607582026, 125.7012862625473, 140.67648898415135], "episode_lengths": [1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3919624847668315, "mean_inference_ms": 7.5034387917381995, "mean_action_processing_ms": 0.5141890008638514, "mean_env_wait_ms": 22.07989122650765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03809928894042969, "StateBufferConnector_ms": 0.03190135955810547, "ViewRequirementAgentConnector_ms": 0.9722657203674316}}, "episode_reward_max": 146.10118888109002, "episode_reward_min": -37.16308141162999, "episode_reward_mean": 88.48053450861232, "episode_len_mean": 1034.8, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [124.75258751113793, 21.48631132584591, 39.8826646827361, 84.59428701070047, 73.82303033157548, 82.24761379485564, 116.284386765098, 103.06060021556594, 119.48252338786101, 130.3483012652867, 70.41990751953378, 81.48436688638226, 77.82734017796015, 115.86513222623987, 16.282775166254925, 146.10118888109002, 91.13192235896001, 17.655668257489875, 91.75320555274504, 107.4577983427815, 96.24863907978744, 14.354675744452516, 103.02503137410936, 119.52301069239473, 91.68490962178787, 88.52992219459041, 112.81426877631924, 117.12017108957899, 87.68987040998012, 115.31253268424184, 93.66093544536875, 99.65921096990344, 88.08469548613333, 4.3298184289820565, 110.5828114174125, 12.212670505232737, 121.326160724036, -37.16308141162999, 103.01555284843042, 14.398992393033957, 86.94725539883291, 98.64548478604762, 94.47951772619899, 98.3260015550837, 90.78023262740182, 106.23862942014152, 15.453344547767127, 84.39654922493882, 109.78674187898476, 100.19614864482725, 117.46359583994263, 120.03410133903583, 108.31988506224175, 100.2977554458121, 9.442135638699755, 126.36437875409837, 95.31239247318985, 91.62029431349457, 96.78830158710517, 122.31104519667939, 96.0553001171948, 104.16360949171464, 93.12281247721286, 95.77610152821948, 84.40926308553952, 125.87416767124381, 99.86505934152807, 91.54837205296435, 110.71872077296891, 118.43400126759127, 98.0047741473021, 132.72440940043714, 97.74608296831592, 102.17934185910468, 92.06429055080608, 98.18869126253385, 94.30333143375357, 92.32248862207226, 17.113374517478963, 102.96251334200718, 67.5329946060639, 90.61749218193458, 109.18033275127976, 124.33297399805039, 102.76027812053002, 93.58259093932587, 99.12007137292741, 119.21414541152033, 92.80025131364495, 1.544108687954276, 79.07219925241317, 65.65222226447928, 15.120357532661274, 118.7327703485935, 92.61166549400086, 94.42851038955254, 109.38237183726027, 16.857431607582026, 125.7012862625473, 140.67648898415135], "episode_lengths": [1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3919624847668315, "mean_inference_ms": 7.5034387917381995, "mean_action_processing_ms": 0.5141890008638514, "mean_env_wait_ms": 22.07989122650765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03809928894042969, "StateBufferConnector_ms": 0.03190135955810547, "ViewRequirementAgentConnector_ms": 0.9722657203674316}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 886474, "num_agent_steps_trained": 886474, "num_env_steps_sampled": 886474, "num_env_steps_trained": 886474, "num_env_steps_sampled_this_iter": 13994, "num_env_steps_trained_this_iter": 13994, "num_env_steps_sampled_throughput_per_sec": 262.0404800601006, "num_env_steps_trained_throughput_per_sec": 262.0404800601006, "timesteps_total": 886474, "num_steps_trained_this_iter": 13994, "agent_timesteps_total": 886474, "timers": {"training_iteration_time_ms": 62059.092, "sample_time_ms": 41376.021, "load_time_ms": 3316.426, "load_throughput": 4293.959, "learn_time_ms": 16744.909, "learn_throughput": 850.444, "synch_weights_time_ms": 474.109}, "counters": {"num_env_steps_sampled": 886474, "num_env_steps_trained": 886474, "num_agent_steps_sampled": 886474, "num_agent_steps_trained": 886474}, "done": false, "episodes_total": 1081, "training_iteration": 77, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-43-57", "timestamp": 1749303837, "time_this_iter_s": 53.424776554107666, "time_total_s": 4110.23933506012, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4110.23933506012, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 74.75967741935484, "ram_util_percent": 46.130645161290325, "gpu_util_percent0": 0.07661290322580644, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.113526000000002e-05, "total_loss": -0.09410124337476379, "policy_loss": -0.01816566014082505, "vf_loss": 0.027089037940802297, "vf_explained_var": 0.9349973782053533, "kl": 0.015315913098684101, "entropy": 15.184363933779158, "entropy_coeff": 0.005567630000000001}, "model": {}, "num_grad_updates_lifetime": 31585.5, "diff_num_grad_updates_vs_sampler_policy": 264.5}}, "num_env_steps_sampled": 901368, "num_env_steps_trained": 901368, "num_agent_steps_sampled": 901368, "num_agent_steps_trained": 901368}, "sampler_results": {"episode_reward_max": 146.10118888109002, "episode_reward_min": -37.16308141162999, "episode_reward_mean": 90.45777358122069, "episode_len_mean": 1035.58, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.282775166254925, 146.10118888109002, 91.13192235896001, 17.655668257489875, 91.75320555274504, 107.4577983427815, 96.24863907978744, 14.354675744452516, 103.02503137410936, 119.52301069239473, 91.68490962178787, 88.52992219459041, 112.81426877631924, 117.12017108957899, 87.68987040998012, 115.31253268424184, 93.66093544536875, 99.65921096990344, 88.08469548613333, 4.3298184289820565, 110.5828114174125, 12.212670505232737, 121.326160724036, -37.16308141162999, 103.01555284843042, 14.398992393033957, 86.94725539883291, 98.64548478604762, 94.47951772619899, 98.3260015550837, 90.78023262740182, 106.23862942014152, 15.453344547767127, 84.39654922493882, 109.78674187898476, 100.19614864482725, 117.46359583994263, 120.03410133903583, 108.31988506224175, 100.2977554458121, 9.442135638699755, 126.36437875409837, 95.31239247318985, 91.62029431349457, 96.78830158710517, 122.31104519667939, 96.0553001171948, 104.16360949171464, 93.12281247721286, 95.77610152821948, 84.40926308553952, 125.87416767124381, 99.86505934152807, 91.54837205296435, 110.71872077296891, 118.43400126759127, 98.0047741473021, 132.72440940043714, 97.74608296831592, 102.17934185910468, 92.06429055080608, 98.18869126253385, 94.30333143375357, 92.32248862207226, 17.113374517478963, 102.96251334200718, 67.5329946060639, 90.61749218193458, 109.18033275127976, 124.33297399805039, 102.76027812053002, 93.58259093932587, 99.12007137292741, 119.21414541152033, 92.80025131364495, 1.544108687954276, 79.07219925241317, 65.65222226447928, 15.120357532661274, 118.7327703485935, 92.61166549400086, 94.42851038955254, 109.38237183726027, 16.857431607582026, 125.7012862625473, 140.67648898415135, 94.4032123637195, 113.96705132397342, 91.38424748564532, 96.6985641088819, 9.784229137890044, 97.9670957165777, 124.9364884616968, 113.54455752083926, 112.60039996300385, 96.00951458881502, 116.34637638966609, 118.16842716476562, 120.81111350493039, 132.6616826312104], "episode_lengths": [295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3984103519090443, "mean_inference_ms": 7.520005134231883, "mean_action_processing_ms": 0.5153065797792832, "mean_env_wait_ms": 22.116813145541084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038092613220214844, "StateBufferConnector_ms": 0.03089594841003418, "ViewRequirementAgentConnector_ms": 0.9960317611694336}}, "episode_reward_max": 146.10118888109002, "episode_reward_min": -37.16308141162999, "episode_reward_mean": 90.45777358122069, "episode_len_mean": 1035.58, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.282775166254925, 146.10118888109002, 91.13192235896001, 17.655668257489875, 91.75320555274504, 107.4577983427815, 96.24863907978744, 14.354675744452516, 103.02503137410936, 119.52301069239473, 91.68490962178787, 88.52992219459041, 112.81426877631924, 117.12017108957899, 87.68987040998012, 115.31253268424184, 93.66093544536875, 99.65921096990344, 88.08469548613333, 4.3298184289820565, 110.5828114174125, 12.212670505232737, 121.326160724036, -37.16308141162999, 103.01555284843042, 14.398992393033957, 86.94725539883291, 98.64548478604762, 94.47951772619899, 98.3260015550837, 90.78023262740182, 106.23862942014152, 15.453344547767127, 84.39654922493882, 109.78674187898476, 100.19614864482725, 117.46359583994263, 120.03410133903583, 108.31988506224175, 100.2977554458121, 9.442135638699755, 126.36437875409837, 95.31239247318985, 91.62029431349457, 96.78830158710517, 122.31104519667939, 96.0553001171948, 104.16360949171464, 93.12281247721286, 95.77610152821948, 84.40926308553952, 125.87416767124381, 99.86505934152807, 91.54837205296435, 110.71872077296891, 118.43400126759127, 98.0047741473021, 132.72440940043714, 97.74608296831592, 102.17934185910468, 92.06429055080608, 98.18869126253385, 94.30333143375357, 92.32248862207226, 17.113374517478963, 102.96251334200718, 67.5329946060639, 90.61749218193458, 109.18033275127976, 124.33297399805039, 102.76027812053002, 93.58259093932587, 99.12007137292741, 119.21414541152033, 92.80025131364495, 1.544108687954276, 79.07219925241317, 65.65222226447928, 15.120357532661274, 118.7327703485935, 92.61166549400086, 94.42851038955254, 109.38237183726027, 16.857431607582026, 125.7012862625473, 140.67648898415135, 94.4032123637195, 113.96705132397342, 91.38424748564532, 96.6985641088819, 9.784229137890044, 97.9670957165777, 124.9364884616968, 113.54455752083926, 112.60039996300385, 96.00951458881502, 116.34637638966609, 118.16842716476562, 120.81111350493039, 132.6616826312104], "episode_lengths": [295, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3984103519090443, "mean_inference_ms": 7.520005134231883, "mean_action_processing_ms": 0.5153065797792832, "mean_env_wait_ms": 22.116813145541084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038092613220214844, "StateBufferConnector_ms": 0.03089594841003418, "ViewRequirementAgentConnector_ms": 0.9960317611694336}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 901368, "num_agent_steps_trained": 901368, "num_env_steps_sampled": 901368, "num_env_steps_trained": 901368, "num_env_steps_sampled_this_iter": 14894, "num_env_steps_trained_this_iter": 14894, "num_env_steps_sampled_throughput_per_sec": 265.0245966301664, "num_env_steps_trained_throughput_per_sec": 265.0245966301664, "timesteps_total": 901368, "num_steps_trained_this_iter": 14894, "agent_timesteps_total": 901368, "timers": {"training_iteration_time_ms": 61904.656, "sample_time_ms": 41726.518, "load_time_ms": 3282.231, "load_throughput": 4391.16, "learn_time_ms": 16241.813, "learn_throughput": 887.389, "synch_weights_time_ms": 505.547}, "counters": {"num_env_steps_sampled": 901368, "num_env_steps_trained": 901368, "num_agent_steps_sampled": 901368, "num_agent_steps_trained": 901368}, "done": false, "episodes_total": 1095, "training_iteration": 78, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-44-53", "timestamp": 1749303893, "time_this_iter_s": 56.216257095336914, "time_total_s": 4166.4555921554565, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4166.4555921554565, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 75.43384615384616, "ram_util_percent": 47.381538461538454, "gpu_util_percent0": 0.0873846153846154, "vram_util_percent0": 0.8409830729166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.098632000000001e-05, "total_loss": -0.09088122365953909, "policy_loss": -0.01645753825310914, "vf_loss": 0.028448070995086297, "vf_explained_var": 0.9787006002122706, "kl": 0.01613712674012355, "entropy": 15.193876656618984, "entropy_coeff": 0.00549316}, "model": {}, "num_grad_updates_lifetime": 32125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 917006, "num_env_steps_trained": 917006, "num_agent_steps_sampled": 917006, "num_agent_steps_trained": 917006}, "sampler_results": {"episode_reward_max": 140.67648898415135, "episode_reward_min": -37.16308141162999, "episode_reward_mean": 93.24440857715521, "episode_len_mean": 1060.24, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [87.68987040998012, 115.31253268424184, 93.66093544536875, 99.65921096990344, 88.08469548613333, 4.3298184289820565, 110.5828114174125, 12.212670505232737, 121.326160724036, -37.16308141162999, 103.01555284843042, 14.398992393033957, 86.94725539883291, 98.64548478604762, 94.47951772619899, 98.3260015550837, 90.78023262740182, 106.23862942014152, 15.453344547767127, 84.39654922493882, 109.78674187898476, 100.19614864482725, 117.46359583994263, 120.03410133903583, 108.31988506224175, 100.2977554458121, 9.442135638699755, 126.36437875409837, 95.31239247318985, 91.62029431349457, 96.78830158710517, 122.31104519667939, 96.0553001171948, 104.16360949171464, 93.12281247721286, 95.77610152821948, 84.40926308553952, 125.87416767124381, 99.86505934152807, 91.54837205296435, 110.71872077296891, 118.43400126759127, 98.0047741473021, 132.72440940043714, 97.74608296831592, 102.17934185910468, 92.06429055080608, 98.18869126253385, 94.30333143375357, 92.32248862207226, 17.113374517478963, 102.96251334200718, 67.5329946060639, 90.61749218193458, 109.18033275127976, 124.33297399805039, 102.76027812053002, 93.58259093932587, 99.12007137292741, 119.21414541152033, 92.80025131364495, 1.544108687954276, 79.07219925241317, 65.65222226447928, 15.120357532661274, 118.7327703485935, 92.61166549400086, 94.42851038955254, 109.38237183726027, 16.857431607582026, 125.7012862625473, 140.67648898415135, 94.4032123637195, 113.96705132397342, 91.38424748564532, 96.6985641088819, 9.784229137890044, 97.9670957165777, 124.9364884616968, 113.54455752083926, 112.60039996300385, 96.00951458881502, 116.34637638966609, 118.16842716476562, 120.81111350493039, 132.6616826312104, 89.95497950237294, 107.45661526892154, 101.09290980085036, 102.49525336596453, 102.62507213860322, 96.74446615942759, 104.1338510171411, 116.49621146990559, 97.27034442591511, 100.52866665330377, 111.62642446245823, 109.2876789213775, 125.82760165737439, 126.80661188217704], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.404859413440901, "mean_inference_ms": 7.537912706215645, "mean_action_processing_ms": 0.5165265440059329, "mean_env_wait_ms": 22.157127585876232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04304385185241699, "StateBufferConnector_ms": 0.03201580047607422, "ViewRequirementAgentConnector_ms": 0.9922778606414795}}, "episode_reward_max": 140.67648898415135, "episode_reward_min": -37.16308141162999, "episode_reward_mean": 93.24440857715521, "episode_len_mean": 1060.24, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [87.68987040998012, 115.31253268424184, 93.66093544536875, 99.65921096990344, 88.08469548613333, 4.3298184289820565, 110.5828114174125, 12.212670505232737, 121.326160724036, -37.16308141162999, 103.01555284843042, 14.398992393033957, 86.94725539883291, 98.64548478604762, 94.47951772619899, 98.3260015550837, 90.78023262740182, 106.23862942014152, 15.453344547767127, 84.39654922493882, 109.78674187898476, 100.19614864482725, 117.46359583994263, 120.03410133903583, 108.31988506224175, 100.2977554458121, 9.442135638699755, 126.36437875409837, 95.31239247318985, 91.62029431349457, 96.78830158710517, 122.31104519667939, 96.0553001171948, 104.16360949171464, 93.12281247721286, 95.77610152821948, 84.40926308553952, 125.87416767124381, 99.86505934152807, 91.54837205296435, 110.71872077296891, 118.43400126759127, 98.0047741473021, 132.72440940043714, 97.74608296831592, 102.17934185910468, 92.06429055080608, 98.18869126253385, 94.30333143375357, 92.32248862207226, 17.113374517478963, 102.96251334200718, 67.5329946060639, 90.61749218193458, 109.18033275127976, 124.33297399805039, 102.76027812053002, 93.58259093932587, 99.12007137292741, 119.21414541152033, 92.80025131364495, 1.544108687954276, 79.07219925241317, 65.65222226447928, 15.120357532661274, 118.7327703485935, 92.61166549400086, 94.42851038955254, 109.38237183726027, 16.857431607582026, 125.7012862625473, 140.67648898415135, 94.4032123637195, 113.96705132397342, 91.38424748564532, 96.6985641088819, 9.784229137890044, 97.9670957165777, 124.9364884616968, 113.54455752083926, 112.60039996300385, 96.00951458881502, 116.34637638966609, 118.16842716476562, 120.81111350493039, 132.6616826312104, 89.95497950237294, 107.45661526892154, 101.09290980085036, 102.49525336596453, 102.62507213860322, 96.74446615942759, 104.1338510171411, 116.49621146990559, 97.27034442591511, 100.52866665330377, 111.62642446245823, 109.2876789213775, 125.82760165737439, 126.80661188217704], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.404859413440901, "mean_inference_ms": 7.537912706215645, "mean_action_processing_ms": 0.5165265440059329, "mean_env_wait_ms": 22.157127585876232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04304385185241699, "StateBufferConnector_ms": 0.03201580047607422, "ViewRequirementAgentConnector_ms": 0.9922778606414795}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 917006, "num_agent_steps_trained": 917006, "num_env_steps_sampled": 917006, "num_env_steps_trained": 917006, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 263.8440854299461, "num_env_steps_trained_throughput_per_sec": 263.8440854299461, "timesteps_total": 917006, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 917006, "timers": {"training_iteration_time_ms": 61483.426, "sample_time_ms": 41907.641, "load_time_ms": 3216.805, "load_throughput": 4506.024, "learn_time_ms": 15698.926, "learn_throughput": 923.312, "synch_weights_time_ms": 512.408}, "counters": {"num_env_steps_sampled": 917006, "num_env_steps_trained": 917006, "num_agent_steps_sampled": 917006, "num_agent_steps_trained": 917006}, "done": false, "episodes_total": 1109, "training_iteration": 79, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-45-53", "timestamp": 1749303953, "time_this_iter_s": 59.32240676879883, "time_total_s": 4225.777998924255, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4225.777998924255, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 76.5840579710145, "ram_util_percent": 48.60434782608695, "gpu_util_percent0": 0.09231884057971015, "vram_util_percent0": 0.8409830729166665}}
{"evaluation": {"sampler_results": {"episode_reward_max": -17.02905878644502, "episode_reward_min": -21.49067489171946, "episode_reward_mean": -18.791398790984243, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.49067489171946, -18.66270728726861, -18.468321687359815, -18.30623130212831, -17.02905878644502], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7779725933347024, "mean_inference_ms": 3.8153554511902654, "mean_action_processing_ms": 0.31235447689139834, "mean_env_wait_ms": 12.555416892556584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.6848621368408203}}, "episode_reward_max": -17.02905878644502, "episode_reward_min": -21.49067489171946, "episode_reward_mean": -18.791398790984243, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.49067489171946, -18.66270728726861, -18.468321687359815, -18.30623130212831, -17.02905878644502], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7779725933347024, "mean_inference_ms": 3.8153554511902654, "mean_action_processing_ms": 0.31235447689139834, "mean_env_wait_ms": 12.555416892556584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.6848621368408203}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.082994e-05, "total_loss": -0.08445009499068626, "policy_loss": -0.0136111301175234, "vf_loss": 0.0397192266900939, "vf_explained_var": 0.9707802281596444, "kl": 0.016603481945983895, "entropy": 15.37840310010043, "entropy_coeff": 0.00541497}, "model": {}, "num_grad_updates_lifetime": 32675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 932644, "num_env_steps_trained": 932644, "num_agent_steps_sampled": 932644, "num_agent_steps_trained": 932644}, "sampler_results": {"episode_reward_max": 140.67648898415135, "episode_reward_min": -14.071013792929918, "episode_reward_mean": 96.60360857791983, "episode_len_mean": 1076.68, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.47951772619899, 98.3260015550837, 90.78023262740182, 106.23862942014152, 15.453344547767127, 84.39654922493882, 109.78674187898476, 100.19614864482725, 117.46359583994263, 120.03410133903583, 108.31988506224175, 100.2977554458121, 9.442135638699755, 126.36437875409837, 95.31239247318985, 91.62029431349457, 96.78830158710517, 122.31104519667939, 96.0553001171948, 104.16360949171464, 93.12281247721286, 95.77610152821948, 84.40926308553952, 125.87416767124381, 99.86505934152807, 91.54837205296435, 110.71872077296891, 118.43400126759127, 98.0047741473021, 132.72440940043714, 97.74608296831592, 102.17934185910468, 92.06429055080608, 98.18869126253385, 94.30333143375357, 92.32248862207226, 17.113374517478963, 102.96251334200718, 67.5329946060639, 90.61749218193458, 109.18033275127976, 124.33297399805039, 102.76027812053002, 93.58259093932587, 99.12007137292741, 119.21414541152033, 92.80025131364495, 1.544108687954276, 79.07219925241317, 65.65222226447928, 15.120357532661274, 118.7327703485935, 92.61166549400086, 94.42851038955254, 109.38237183726027, 16.857431607582026, 125.7012862625473, 140.67648898415135, 94.4032123637195, 113.96705132397342, 91.38424748564532, 96.6985641088819, 9.784229137890044, 97.9670957165777, 124.9364884616968, 113.54455752083926, 112.60039996300385, 96.00951458881502, 116.34637638966609, 118.16842716476562, 120.81111350493039, 132.6616826312104, 89.95497950237294, 107.45661526892154, 101.09290980085036, 102.49525336596453, 102.62507213860322, 96.74446615942759, 104.1338510171411, 116.49621146990559, 97.27034442591511, 100.52866665330377, 111.62642446245823, 109.2876789213775, 125.82760165737439, 126.80661188217704, 99.08149689987309, 96.35932361062025, 101.0051064134326, 97.22835335697722, 94.15481919768743, 86.11520725023776, -14.071013792929918, 107.49048986471198, 107.57428168363886, 108.15880584926491, 96.15191888815556, 111.37397965012966, 112.11683615791472, 131.8833051327523], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4114434614767912, "mean_inference_ms": 7.558919193023062, "mean_action_processing_ms": 0.5179539864620288, "mean_env_wait_ms": 22.20287828622605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045085906982421875, "StateBufferConnector_ms": 0.02726268768310547, "ViewRequirementAgentConnector_ms": 0.9999563694000244}}, "episode_reward_max": 140.67648898415135, "episode_reward_min": -14.071013792929918, "episode_reward_mean": 96.60360857791983, "episode_len_mean": 1076.68, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [94.47951772619899, 98.3260015550837, 90.78023262740182, 106.23862942014152, 15.453344547767127, 84.39654922493882, 109.78674187898476, 100.19614864482725, 117.46359583994263, 120.03410133903583, 108.31988506224175, 100.2977554458121, 9.442135638699755, 126.36437875409837, 95.31239247318985, 91.62029431349457, 96.78830158710517, 122.31104519667939, 96.0553001171948, 104.16360949171464, 93.12281247721286, 95.77610152821948, 84.40926308553952, 125.87416767124381, 99.86505934152807, 91.54837205296435, 110.71872077296891, 118.43400126759127, 98.0047741473021, 132.72440940043714, 97.74608296831592, 102.17934185910468, 92.06429055080608, 98.18869126253385, 94.30333143375357, 92.32248862207226, 17.113374517478963, 102.96251334200718, 67.5329946060639, 90.61749218193458, 109.18033275127976, 124.33297399805039, 102.76027812053002, 93.58259093932587, 99.12007137292741, 119.21414541152033, 92.80025131364495, 1.544108687954276, 79.07219925241317, 65.65222226447928, 15.120357532661274, 118.7327703485935, 92.61166549400086, 94.42851038955254, 109.38237183726027, 16.857431607582026, 125.7012862625473, 140.67648898415135, 94.4032123637195, 113.96705132397342, 91.38424748564532, 96.6985641088819, 9.784229137890044, 97.9670957165777, 124.9364884616968, 113.54455752083926, 112.60039996300385, 96.00951458881502, 116.34637638966609, 118.16842716476562, 120.81111350493039, 132.6616826312104, 89.95497950237294, 107.45661526892154, 101.09290980085036, 102.49525336596453, 102.62507213860322, 96.74446615942759, 104.1338510171411, 116.49621146990559, 97.27034442591511, 100.52866665330377, 111.62642446245823, 109.2876789213775, 125.82760165737439, 126.80661188217704, 99.08149689987309, 96.35932361062025, 101.0051064134326, 97.22835335697722, 94.15481919768743, 86.11520725023776, -14.071013792929918, 107.49048986471198, 107.57428168363886, 108.15880584926491, 96.15191888815556, 111.37397965012966, 112.11683615791472, 131.8833051327523], "episode_lengths": [1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4114434614767912, "mean_inference_ms": 7.558919193023062, "mean_action_processing_ms": 0.5179539864620288, "mean_env_wait_ms": 22.20287828622605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045085906982421875, "StateBufferConnector_ms": 0.02726268768310547, "ViewRequirementAgentConnector_ms": 0.9999563694000244}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 932644, "num_agent_steps_trained": 932644, "num_env_steps_sampled": 932644, "num_env_steps_trained": 932644, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 252.75405570957605, "num_env_steps_trained_throughput_per_sec": 252.75405570957605, "timesteps_total": 932644, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 932644, "timers": {"training_iteration_time_ms": 62166.607, "sample_time_ms": 42883.88, "load_time_ms": 3225.086, "load_throughput": 4596.404, "learn_time_ms": 15402.922, "learn_throughput": 962.402, "synch_weights_time_ms": 507.374}, "counters": {"num_env_steps_sampled": 932644, "num_env_steps_trained": 932644, "num_agent_steps_sampled": 932644, "num_agent_steps_trained": 932644}, "done": false, "episodes_total": 1123, "training_iteration": 80, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-47-13", "timestamp": 1749304033, "time_this_iter_s": 79.68142867088318, "time_total_s": 4305.459427595139, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4305.459427595139, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 64.86989247311827, "ram_util_percent": 48.573118279569876, "gpu_util_percent0": 0.06666666666666667, "vram_util_percent0": 0.840983072916667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.067356000000002e-05, "total_loss": -0.06229669627458365, "policy_loss": 0.009847049048932438, "vf_loss": 0.02818288654745133, "vf_explained_var": 0.9758806561339985, "kl": 0.017005692467927408, "entropy": 15.202057762145996, "entropy_coeff": 0.00533678}, "model": {}, "num_grad_updates_lifetime": 33225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 948282, "num_env_steps_trained": 948282, "num_agent_steps_sampled": 948282, "num_agent_steps_trained": 948282}, "sampler_results": {"episode_reward_max": 140.67648898415135, "episode_reward_min": -14.071013792929918, "episode_reward_mean": 98.67695150161822, "episode_len_mean": 1084.9, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.31239247318985, 91.62029431349457, 96.78830158710517, 122.31104519667939, 96.0553001171948, 104.16360949171464, 93.12281247721286, 95.77610152821948, 84.40926308553952, 125.87416767124381, 99.86505934152807, 91.54837205296435, 110.71872077296891, 118.43400126759127, 98.0047741473021, 132.72440940043714, 97.74608296831592, 102.17934185910468, 92.06429055080608, 98.18869126253385, 94.30333143375357, 92.32248862207226, 17.113374517478963, 102.96251334200718, 67.5329946060639, 90.61749218193458, 109.18033275127976, 124.33297399805039, 102.76027812053002, 93.58259093932587, 99.12007137292741, 119.21414541152033, 92.80025131364495, 1.544108687954276, 79.07219925241317, 65.65222226447928, 15.120357532661274, 118.7327703485935, 92.61166549400086, 94.42851038955254, 109.38237183726027, 16.857431607582026, 125.7012862625473, 140.67648898415135, 94.4032123637195, 113.96705132397342, 91.38424748564532, 96.6985641088819, 9.784229137890044, 97.9670957165777, 124.9364884616968, 113.54455752083926, 112.60039996300385, 96.00951458881502, 116.34637638966609, 118.16842716476562, 120.81111350493039, 132.6616826312104, 89.95497950237294, 107.45661526892154, 101.09290980085036, 102.49525336596453, 102.62507213860322, 96.74446615942759, 104.1338510171411, 116.49621146990559, 97.27034442591511, 100.52866665330377, 111.62642446245823, 109.2876789213775, 125.82760165737439, 126.80661188217704, 99.08149689987309, 96.35932361062025, 101.0051064134326, 97.22835335697722, 94.15481919768743, 86.11520725023776, -14.071013792929918, 107.49048986471198, 107.57428168363886, 108.15880584926491, 96.15191888815556, 111.37397965012966, 112.11683615791472, 131.8833051327523, 88.68382728025405, 115.05706353759497, 102.9364229854523, 102.4374568546716, 104.03131145098357, 85.37840150205123, 123.77891925086567, 113.88107056284095, 106.88138926507445, 99.11771895860616, 100.01616443158902, 125.98375794144495, 104.23778610796717, 116.49201994562169], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.417419274667564, "mean_inference_ms": 7.579591341924581, "mean_action_processing_ms": 0.5193331150062918, "mean_env_wait_ms": 22.247326325794084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04602646827697754, "StateBufferConnector_ms": 0.02318882942199707, "ViewRequirementAgentConnector_ms": 0.9923768043518066}}, "episode_reward_max": 140.67648898415135, "episode_reward_min": -14.071013792929918, "episode_reward_mean": 98.67695150161822, "episode_len_mean": 1084.9, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [95.31239247318985, 91.62029431349457, 96.78830158710517, 122.31104519667939, 96.0553001171948, 104.16360949171464, 93.12281247721286, 95.77610152821948, 84.40926308553952, 125.87416767124381, 99.86505934152807, 91.54837205296435, 110.71872077296891, 118.43400126759127, 98.0047741473021, 132.72440940043714, 97.74608296831592, 102.17934185910468, 92.06429055080608, 98.18869126253385, 94.30333143375357, 92.32248862207226, 17.113374517478963, 102.96251334200718, 67.5329946060639, 90.61749218193458, 109.18033275127976, 124.33297399805039, 102.76027812053002, 93.58259093932587, 99.12007137292741, 119.21414541152033, 92.80025131364495, 1.544108687954276, 79.07219925241317, 65.65222226447928, 15.120357532661274, 118.7327703485935, 92.61166549400086, 94.42851038955254, 109.38237183726027, 16.857431607582026, 125.7012862625473, 140.67648898415135, 94.4032123637195, 113.96705132397342, 91.38424748564532, 96.6985641088819, 9.784229137890044, 97.9670957165777, 124.9364884616968, 113.54455752083926, 112.60039996300385, 96.00951458881502, 116.34637638966609, 118.16842716476562, 120.81111350493039, 132.6616826312104, 89.95497950237294, 107.45661526892154, 101.09290980085036, 102.49525336596453, 102.62507213860322, 96.74446615942759, 104.1338510171411, 116.49621146990559, 97.27034442591511, 100.52866665330377, 111.62642446245823, 109.2876789213775, 125.82760165737439, 126.80661188217704, 99.08149689987309, 96.35932361062025, 101.0051064134326, 97.22835335697722, 94.15481919768743, 86.11520725023776, -14.071013792929918, 107.49048986471198, 107.57428168363886, 108.15880584926491, 96.15191888815556, 111.37397965012966, 112.11683615791472, 131.8833051327523, 88.68382728025405, 115.05706353759497, 102.9364229854523, 102.4374568546716, 104.03131145098357, 85.37840150205123, 123.77891925086567, 113.88107056284095, 106.88138926507445, 99.11771895860616, 100.01616443158902, 125.98375794144495, 104.23778610796717, 116.49201994562169], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.417419274667564, "mean_inference_ms": 7.579591341924581, "mean_action_processing_ms": 0.5193331150062918, "mean_env_wait_ms": 22.247326325794084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04602646827697754, "StateBufferConnector_ms": 0.02318882942199707, "ViewRequirementAgentConnector_ms": 0.9923768043518066}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948282, "num_agent_steps_trained": 948282, "num_env_steps_sampled": 948282, "num_env_steps_trained": 948282, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 267.25164584785296, "num_env_steps_trained_throughput_per_sec": 267.25164584785296, "timesteps_total": 948282, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 948282, "timers": {"training_iteration_time_ms": 61604.341, "sample_time_ms": 43022.657, "load_time_ms": 3167.097, "load_throughput": 4706.518, "learn_time_ms": 14732.026, "learn_throughput": 1011.809, "synch_weights_time_ms": 540.661}, "counters": {"num_env_steps_sampled": 948282, "num_env_steps_trained": 948282, "num_agent_steps_sampled": 948282, "num_agent_steps_trained": 948282}, "done": false, "episodes_total": 1137, "training_iteration": 81, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-48-11", "timestamp": 1749304091, "time_this_iter_s": 58.52815270423889, "time_total_s": 4363.987580299377, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4363.987580299377, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 76.62499999999999, "ram_util_percent": 49.597058823529416, "gpu_util_percent0": 0.08073529411764704, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.051717999999999e-05, "total_loss": -0.08458525177641688, "policy_loss": -0.012448699993547052, "vf_loss": 0.02404199866747314, "vf_explained_var": 0.9775278090346943, "kl": 0.01474471778681618, "entropy": 15.177058391571045, "entropy_coeff": 0.0052585900000000005}, "model": {}, "num_grad_updates_lifetime": 33775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 963920, "num_env_steps_trained": 963920, "num_agent_steps_sampled": 963920, "num_agent_steps_trained": 963920}, "sampler_results": {"episode_reward_max": 140.67648898415135, "episode_reward_min": -14.071013792929918, "episode_reward_mean": 99.25891329824778, "episode_len_mean": 1084.9, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.0047741473021, 132.72440940043714, 97.74608296831592, 102.17934185910468, 92.06429055080608, 98.18869126253385, 94.30333143375357, 92.32248862207226, 17.113374517478963, 102.96251334200718, 67.5329946060639, 90.61749218193458, 109.18033275127976, 124.33297399805039, 102.76027812053002, 93.58259093932587, 99.12007137292741, 119.21414541152033, 92.80025131364495, 1.544108687954276, 79.07219925241317, 65.65222226447928, 15.120357532661274, 118.7327703485935, 92.61166549400086, 94.42851038955254, 109.38237183726027, 16.857431607582026, 125.7012862625473, 140.67648898415135, 94.4032123637195, 113.96705132397342, 91.38424748564532, 96.6985641088819, 9.784229137890044, 97.9670957165777, 124.9364884616968, 113.54455752083926, 112.60039996300385, 96.00951458881502, 116.34637638966609, 118.16842716476562, 120.81111350493039, 132.6616826312104, 89.95497950237294, 107.45661526892154, 101.09290980085036, 102.49525336596453, 102.62507213860322, 96.74446615942759, 104.1338510171411, 116.49621146990559, 97.27034442591511, 100.52866665330377, 111.62642446245823, 109.2876789213775, 125.82760165737439, 126.80661188217704, 99.08149689987309, 96.35932361062025, 101.0051064134326, 97.22835335697722, 94.15481919768743, 86.11520725023776, -14.071013792929918, 107.49048986471198, 107.57428168363886, 108.15880584926491, 96.15191888815556, 111.37397965012966, 112.11683615791472, 131.8833051327523, 88.68382728025405, 115.05706353759497, 102.9364229854523, 102.4374568546716, 104.03131145098357, 85.37840150205123, 123.77891925086567, 113.88107056284095, 106.88138926507445, 99.11771895860616, 100.01616443158902, 125.98375794144495, 104.23778610796717, 116.49201994562169, 95.84560229988926, 111.62829005593653, 95.00587275486903, 98.05451564926383, 102.92276436318984, 80.10869179968554, 122.67440864823371, 116.84541230180301, 120.15464860911453, 92.89303146322872, 111.41031793235136, 125.04362042542498, 114.49662548106548, 97.11181925554175], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4231170425519513, "mean_inference_ms": 7.598805421282775, "mean_action_processing_ms": 0.5206031902312825, "mean_env_wait_ms": 22.288497006010715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03597903251647949, "StateBufferConnector_ms": 0.022144794464111328, "ViewRequirementAgentConnector_ms": 0.9757344722747803}}, "episode_reward_max": 140.67648898415135, "episode_reward_min": -14.071013792929918, "episode_reward_mean": 99.25891329824778, "episode_len_mean": 1084.9, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [98.0047741473021, 132.72440940043714, 97.74608296831592, 102.17934185910468, 92.06429055080608, 98.18869126253385, 94.30333143375357, 92.32248862207226, 17.113374517478963, 102.96251334200718, 67.5329946060639, 90.61749218193458, 109.18033275127976, 124.33297399805039, 102.76027812053002, 93.58259093932587, 99.12007137292741, 119.21414541152033, 92.80025131364495, 1.544108687954276, 79.07219925241317, 65.65222226447928, 15.120357532661274, 118.7327703485935, 92.61166549400086, 94.42851038955254, 109.38237183726027, 16.857431607582026, 125.7012862625473, 140.67648898415135, 94.4032123637195, 113.96705132397342, 91.38424748564532, 96.6985641088819, 9.784229137890044, 97.9670957165777, 124.9364884616968, 113.54455752083926, 112.60039996300385, 96.00951458881502, 116.34637638966609, 118.16842716476562, 120.81111350493039, 132.6616826312104, 89.95497950237294, 107.45661526892154, 101.09290980085036, 102.49525336596453, 102.62507213860322, 96.74446615942759, 104.1338510171411, 116.49621146990559, 97.27034442591511, 100.52866665330377, 111.62642446245823, 109.2876789213775, 125.82760165737439, 126.80661188217704, 99.08149689987309, 96.35932361062025, 101.0051064134326, 97.22835335697722, 94.15481919768743, 86.11520725023776, -14.071013792929918, 107.49048986471198, 107.57428168363886, 108.15880584926491, 96.15191888815556, 111.37397965012966, 112.11683615791472, 131.8833051327523, 88.68382728025405, 115.05706353759497, 102.9364229854523, 102.4374568546716, 104.03131145098357, 85.37840150205123, 123.77891925086567, 113.88107056284095, 106.88138926507445, 99.11771895860616, 100.01616443158902, 125.98375794144495, 104.23778610796717, 116.49201994562169, 95.84560229988926, 111.62829005593653, 95.00587275486903, 98.05451564926383, 102.92276436318984, 80.10869179968554, 122.67440864823371, 116.84541230180301, 120.15464860911453, 92.89303146322872, 111.41031793235136, 125.04362042542498, 114.49662548106548, 97.11181925554175], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4231170425519513, "mean_inference_ms": 7.598805421282775, "mean_action_processing_ms": 0.5206031902312825, "mean_env_wait_ms": 22.288497006010715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03597903251647949, "StateBufferConnector_ms": 0.022144794464111328, "ViewRequirementAgentConnector_ms": 0.9757344722747803}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 963920, "num_agent_steps_trained": 963920, "num_env_steps_sampled": 963920, "num_env_steps_trained": 963920, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 260.5614004480992, "num_env_steps_trained_throughput_per_sec": 260.5614004480992, "timesteps_total": 963920, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 963920, "timers": {"training_iteration_time_ms": 61748.179, "sample_time_ms": 43512.929, "load_time_ms": 3124.338, "load_throughput": 4823.55, "learn_time_ms": 14424.367, "learn_throughput": 1044.788, "synch_weights_time_ms": 544.926}, "counters": {"num_env_steps_sampled": 963920, "num_env_steps_trained": 963920, "num_agent_steps_sampled": 963920, "num_agent_steps_trained": 963920}, "done": false, "episodes_total": 1151, "training_iteration": 82, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-49-11", "timestamp": 1749304151, "time_this_iter_s": 60.03158688545227, "time_total_s": 4424.01916718483, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4424.01916718483, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 78.49411764705883, "ram_util_percent": 49.985294117647065, "gpu_util_percent0": 0.07926470588235292, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.03608e-05, "total_loss": -0.057436539008790116, "policy_loss": 0.012151031607592648, "vf_loss": 0.029558937275274234, "vf_explained_var": 0.9709456033056433, "kl": 0.015825836572545656, "entropy": 15.240100324804132, "entropy_coeff": 0.005180400000000001}, "model": {}, "num_grad_updates_lifetime": 34325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 979558, "num_env_steps_trained": 979558, "num_agent_steps_sampled": 979558, "num_agent_steps_trained": 979558}, "sampler_results": {"episode_reward_max": 140.67648898415135, "episode_reward_min": -14.071013792929918, "episode_reward_mean": 100.78546301187797, "episode_len_mean": 1093.12, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.76027812053002, 93.58259093932587, 99.12007137292741, 119.21414541152033, 92.80025131364495, 1.544108687954276, 79.07219925241317, 65.65222226447928, 15.120357532661274, 118.7327703485935, 92.61166549400086, 94.42851038955254, 109.38237183726027, 16.857431607582026, 125.7012862625473, 140.67648898415135, 94.4032123637195, 113.96705132397342, 91.38424748564532, 96.6985641088819, 9.784229137890044, 97.9670957165777, 124.9364884616968, 113.54455752083926, 112.60039996300385, 96.00951458881502, 116.34637638966609, 118.16842716476562, 120.81111350493039, 132.6616826312104, 89.95497950237294, 107.45661526892154, 101.09290980085036, 102.49525336596453, 102.62507213860322, 96.74446615942759, 104.1338510171411, 116.49621146990559, 97.27034442591511, 100.52866665330377, 111.62642446245823, 109.2876789213775, 125.82760165737439, 126.80661188217704, 99.08149689987309, 96.35932361062025, 101.0051064134326, 97.22835335697722, 94.15481919768743, 86.11520725023776, -14.071013792929918, 107.49048986471198, 107.57428168363886, 108.15880584926491, 96.15191888815556, 111.37397965012966, 112.11683615791472, 131.8833051327523, 88.68382728025405, 115.05706353759497, 102.9364229854523, 102.4374568546716, 104.03131145098357, 85.37840150205123, 123.77891925086567, 113.88107056284095, 106.88138926507445, 99.11771895860616, 100.01616443158902, 125.98375794144495, 104.23778610796717, 116.49201994562169, 95.84560229988926, 111.62829005593653, 95.00587275486903, 98.05451564926383, 102.92276436318984, 80.10869179968554, 122.67440864823371, 116.84541230180301, 120.15464860911453, 92.89303146322872, 111.41031793235136, 125.04362042542498, 114.49662548106548, 97.11181925554175, 91.52132951487009, 107.45835151027498, 97.52527814611132, 98.32914075382723, 105.91839499131478, 87.49023405654792, 116.5306805442103, 120.2712147070308, 101.5279705894805, 105.49390350789447, 98.60342916302935, 112.07608137035146, 97.72567380364677, 131.4563803455714], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4290359601004967, "mean_inference_ms": 7.616992475585938, "mean_action_processing_ms": 0.5218298155598721, "mean_env_wait_ms": 22.32775646960545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033013343811035156, "StateBufferConnector_ms": 0.019121170043945312, "ViewRequirementAgentConnector_ms": 0.9660556316375732}}, "episode_reward_max": 140.67648898415135, "episode_reward_min": -14.071013792929918, "episode_reward_mean": 100.78546301187797, "episode_len_mean": 1093.12, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [102.76027812053002, 93.58259093932587, 99.12007137292741, 119.21414541152033, 92.80025131364495, 1.544108687954276, 79.07219925241317, 65.65222226447928, 15.120357532661274, 118.7327703485935, 92.61166549400086, 94.42851038955254, 109.38237183726027, 16.857431607582026, 125.7012862625473, 140.67648898415135, 94.4032123637195, 113.96705132397342, 91.38424748564532, 96.6985641088819, 9.784229137890044, 97.9670957165777, 124.9364884616968, 113.54455752083926, 112.60039996300385, 96.00951458881502, 116.34637638966609, 118.16842716476562, 120.81111350493039, 132.6616826312104, 89.95497950237294, 107.45661526892154, 101.09290980085036, 102.49525336596453, 102.62507213860322, 96.74446615942759, 104.1338510171411, 116.49621146990559, 97.27034442591511, 100.52866665330377, 111.62642446245823, 109.2876789213775, 125.82760165737439, 126.80661188217704, 99.08149689987309, 96.35932361062025, 101.0051064134326, 97.22835335697722, 94.15481919768743, 86.11520725023776, -14.071013792929918, 107.49048986471198, 107.57428168363886, 108.15880584926491, 96.15191888815556, 111.37397965012966, 112.11683615791472, 131.8833051327523, 88.68382728025405, 115.05706353759497, 102.9364229854523, 102.4374568546716, 104.03131145098357, 85.37840150205123, 123.77891925086567, 113.88107056284095, 106.88138926507445, 99.11771895860616, 100.01616443158902, 125.98375794144495, 104.23778610796717, 116.49201994562169, 95.84560229988926, 111.62829005593653, 95.00587275486903, 98.05451564926383, 102.92276436318984, 80.10869179968554, 122.67440864823371, 116.84541230180301, 120.15464860911453, 92.89303146322872, 111.41031793235136, 125.04362042542498, 114.49662548106548, 97.11181925554175, 91.52132951487009, 107.45835151027498, 97.52527814611132, 98.32914075382723, 105.91839499131478, 87.49023405654792, 116.5306805442103, 120.2712147070308, 101.5279705894805, 105.49390350789447, 98.60342916302935, 112.07608137035146, 97.72567380364677, 131.4563803455714], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 295, 1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4290359601004967, "mean_inference_ms": 7.616992475585938, "mean_action_processing_ms": 0.5218298155598721, "mean_env_wait_ms": 22.32775646960545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033013343811035156, "StateBufferConnector_ms": 0.019121170043945312, "ViewRequirementAgentConnector_ms": 0.9660556316375732}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 979558, "num_agent_steps_trained": 979558, "num_env_steps_sampled": 979558, "num_env_steps_trained": 979558, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 267.96640245475686, "num_env_steps_trained_throughput_per_sec": 267.96640245475686, "timesteps_total": 979558, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 979558, "timers": {"training_iteration_time_ms": 61465.408, "sample_time_ms": 43697.224, "load_time_ms": 3083.778, "load_throughput": 4940.304, "learn_time_ms": 13997.002, "learn_throughput": 1088.433, "synch_weights_time_ms": 550.234}, "counters": {"num_env_steps_sampled": 979558, "num_env_steps_trained": 979558, "num_agent_steps_sampled": 979558, "num_agent_steps_trained": 979558}, "done": false, "episodes_total": 1165, "training_iteration": 83, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-50-10", "timestamp": 1749304210, "time_this_iter_s": 58.372066259384155, "time_total_s": 4482.391233444214, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4482.391233444214, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 75.91470588235295, "ram_util_percent": 50.20294117647058, "gpu_util_percent0": 0.09558823529411763, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.020442000000002e-05, "total_loss": -0.05693628297526051, "policy_loss": 0.012169621400958435, "vf_loss": 0.0279966511558318, "vf_explained_var": 0.9665247905254364, "kl": 0.017101805269804964, "entropy": 15.2952009825273, "entropy_coeff": 0.005102210000000001}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 995196, "num_env_steps_trained": 995196, "num_agent_steps_sampled": 995196, "num_agent_steps_trained": 995196}, "sampler_results": {"episode_reward_max": 140.67648898415135, "episode_reward_min": -14.071013792929918, "episode_reward_mean": 103.8739188395503, "episode_len_mean": 1109.56, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.7012862625473, 140.67648898415135, 94.4032123637195, 113.96705132397342, 91.38424748564532, 96.6985641088819, 9.784229137890044, 97.9670957165777, 124.9364884616968, 113.54455752083926, 112.60039996300385, 96.00951458881502, 116.34637638966609, 118.16842716476562, 120.81111350493039, 132.6616826312104, 89.95497950237294, 107.45661526892154, 101.09290980085036, 102.49525336596453, 102.62507213860322, 96.74446615942759, 104.1338510171411, 116.49621146990559, 97.27034442591511, 100.52866665330377, 111.62642446245823, 109.2876789213775, 125.82760165737439, 126.80661188217704, 99.08149689987309, 96.35932361062025, 101.0051064134326, 97.22835335697722, 94.15481919768743, 86.11520725023776, -14.071013792929918, 107.49048986471198, 107.57428168363886, 108.15880584926491, 96.15191888815556, 111.37397965012966, 112.11683615791472, 131.8833051327523, 88.68382728025405, 115.05706353759497, 102.9364229854523, 102.4374568546716, 104.03131145098357, 85.37840150205123, 123.77891925086567, 113.88107056284095, 106.88138926507445, 99.11771895860616, 100.01616443158902, 125.98375794144495, 104.23778610796717, 116.49201994562169, 95.84560229988926, 111.62829005593653, 95.00587275486903, 98.05451564926383, 102.92276436318984, 80.10869179968554, 122.67440864823371, 116.84541230180301, 120.15464860911453, 92.89303146322872, 111.41031793235136, 125.04362042542498, 114.49662548106548, 97.11181925554175, 91.52132951487009, 107.45835151027498, 97.52527814611132, 98.32914075382723, 105.91839499131478, 87.49023405654792, 116.5306805442103, 120.2712147070308, 101.5279705894805, 105.49390350789447, 98.60342916302935, 112.07608137035146, 97.72567380364677, 131.4563803455714, 90.91896319458054, 109.50047190665053, 72.3012414372086, 94.55609710634629, 106.95508795265944, 95.86111325902478, 106.10097120650337, 100.10179187658092, 99.4564473341405, 98.33415871904711, 107.28075770580615, 114.81886414588668, 93.94652155484057, 119.59206994040434], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.43576164220496, "mean_inference_ms": 7.636915970635553, "mean_action_processing_ms": 0.523157522920602, "mean_env_wait_ms": 22.370795697628374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03497600555419922, "StateBufferConnector_ms": 0.017128467559814453, "ViewRequirementAgentConnector_ms": 0.9908299446105957}}, "episode_reward_max": 140.67648898415135, "episode_reward_min": -14.071013792929918, "episode_reward_mean": 103.8739188395503, "episode_len_mean": 1109.56, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [125.7012862625473, 140.67648898415135, 94.4032123637195, 113.96705132397342, 91.38424748564532, 96.6985641088819, 9.784229137890044, 97.9670957165777, 124.9364884616968, 113.54455752083926, 112.60039996300385, 96.00951458881502, 116.34637638966609, 118.16842716476562, 120.81111350493039, 132.6616826312104, 89.95497950237294, 107.45661526892154, 101.09290980085036, 102.49525336596453, 102.62507213860322, 96.74446615942759, 104.1338510171411, 116.49621146990559, 97.27034442591511, 100.52866665330377, 111.62642446245823, 109.2876789213775, 125.82760165737439, 126.80661188217704, 99.08149689987309, 96.35932361062025, 101.0051064134326, 97.22835335697722, 94.15481919768743, 86.11520725023776, -14.071013792929918, 107.49048986471198, 107.57428168363886, 108.15880584926491, 96.15191888815556, 111.37397965012966, 112.11683615791472, 131.8833051327523, 88.68382728025405, 115.05706353759497, 102.9364229854523, 102.4374568546716, 104.03131145098357, 85.37840150205123, 123.77891925086567, 113.88107056284095, 106.88138926507445, 99.11771895860616, 100.01616443158902, 125.98375794144495, 104.23778610796717, 116.49201994562169, 95.84560229988926, 111.62829005593653, 95.00587275486903, 98.05451564926383, 102.92276436318984, 80.10869179968554, 122.67440864823371, 116.84541230180301, 120.15464860911453, 92.89303146322872, 111.41031793235136, 125.04362042542498, 114.49662548106548, 97.11181925554175, 91.52132951487009, 107.45835151027498, 97.52527814611132, 98.32914075382723, 105.91839499131478, 87.49023405654792, 116.5306805442103, 120.2712147070308, 101.5279705894805, 105.49390350789447, 98.60342916302935, 112.07608137035146, 97.72567380364677, 131.4563803455714, 90.91896319458054, 109.50047190665053, 72.3012414372086, 94.55609710634629, 106.95508795265944, 95.86111325902478, 106.10097120650337, 100.10179187658092, 99.4564473341405, 98.33415871904711, 107.28075770580615, 114.81886414588668, 93.94652155484057, 119.59206994040434], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 373, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.43576164220496, "mean_inference_ms": 7.636915970635553, "mean_action_processing_ms": 0.523157522920602, "mean_env_wait_ms": 22.370795697628374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03497600555419922, "StateBufferConnector_ms": 0.017128467559814453, "ViewRequirementAgentConnector_ms": 0.9908299446105957}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 995196, "num_agent_steps_trained": 995196, "num_env_steps_sampled": 995196, "num_env_steps_trained": 995196, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 263.37706948559384, "num_env_steps_trained_throughput_per_sec": 263.37706948559384, "timesteps_total": 995196, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 995196, "timers": {"training_iteration_time_ms": 60622.955, "sample_time_ms": 43795.803, "load_time_ms": 2948.386, "load_throughput": 5195.046, "learn_time_ms": 13210.563, "learn_throughput": 1159.451, "synch_weights_time_ms": 539.627}, "counters": {"num_env_steps_sampled": 995196, "num_env_steps_trained": 995196, "num_agent_steps_sampled": 995196, "num_agent_steps_trained": 995196}, "done": false, "episodes_total": 1179, "training_iteration": 84, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-51-09", "timestamp": 1749304269, "time_this_iter_s": 59.388933420181274, "time_total_s": 4541.780166864395, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4541.780166864395, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 77.61323529411763, "ram_util_percent": 50.736764705882344, "gpu_util_percent0": 0.07985294117647058, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 9.004804e-05, "total_loss": -0.07457619993354786, "policy_loss": -0.006670081056006231, "vf_loss": 0.026055708292617715, "vf_explained_var": 0.9693236447464336, "kl": 0.0169436575159646, "entropy": 15.177551598982378, "entropy_coeff": 0.005024020000000001}, "model": {}, "num_grad_updates_lifetime": 35425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1010834, "num_env_steps_trained": 1010834, "num_agent_steps_sampled": 1010834, "num_agent_steps_trained": 1010834}, "sampler_results": {"episode_reward_max": 132.6616826312104, "episode_reward_min": -14.071013792929918, "episode_reward_mean": 103.80075950606097, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.81111350493039, 132.6616826312104, 89.95497950237294, 107.45661526892154, 101.09290980085036, 102.49525336596453, 102.62507213860322, 96.74446615942759, 104.1338510171411, 116.49621146990559, 97.27034442591511, 100.52866665330377, 111.62642446245823, 109.2876789213775, 125.82760165737439, 126.80661188217704, 99.08149689987309, 96.35932361062025, 101.0051064134326, 97.22835335697722, 94.15481919768743, 86.11520725023776, -14.071013792929918, 107.49048986471198, 107.57428168363886, 108.15880584926491, 96.15191888815556, 111.37397965012966, 112.11683615791472, 131.8833051327523, 88.68382728025405, 115.05706353759497, 102.9364229854523, 102.4374568546716, 104.03131145098357, 85.37840150205123, 123.77891925086567, 113.88107056284095, 106.88138926507445, 99.11771895860616, 100.01616443158902, 125.98375794144495, 104.23778610796717, 116.49201994562169, 95.84560229988926, 111.62829005593653, 95.00587275486903, 98.05451564926383, 102.92276436318984, 80.10869179968554, 122.67440864823371, 116.84541230180301, 120.15464860911453, 92.89303146322872, 111.41031793235136, 125.04362042542498, 114.49662548106548, 97.11181925554175, 91.52132951487009, 107.45835151027498, 97.52527814611132, 98.32914075382723, 105.91839499131478, 87.49023405654792, 116.5306805442103, 120.2712147070308, 101.5279705894805, 105.49390350789447, 98.60342916302935, 112.07608137035146, 97.72567380364677, 131.4563803455714, 90.91896319458054, 109.50047190665053, 72.3012414372086, 94.55609710634629, 106.95508795265944, 95.86111325902478, 106.10097120650337, 100.10179187658092, 99.4564473341405, 98.33415871904711, 107.28075770580615, 114.81886414588668, 93.94652155484057, 119.59206994040434, 95.5746718689159, 89.29823524601143, 99.6137272658846, 105.92649553910998, 101.1934520866465, 94.89470771270369, 121.6712391949106, 98.33102922902359, 107.97699541692388, 89.12870248014583, 110.17732754939803, 126.47787337641886, 88.96226938736541, 115.64527976978293], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.442963733632131, "mean_inference_ms": 7.658000989831055, "mean_action_processing_ms": 0.5245314257616357, "mean_env_wait_ms": 22.416027475924754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043022871017456055, "StateBufferConnector_ms": 0.020128250122070312, "ViewRequirementAgentConnector_ms": 1.00343656539917}}, "episode_reward_max": 132.6616826312104, "episode_reward_min": -14.071013792929918, "episode_reward_mean": 103.80075950606097, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [120.81111350493039, 132.6616826312104, 89.95497950237294, 107.45661526892154, 101.09290980085036, 102.49525336596453, 102.62507213860322, 96.74446615942759, 104.1338510171411, 116.49621146990559, 97.27034442591511, 100.52866665330377, 111.62642446245823, 109.2876789213775, 125.82760165737439, 126.80661188217704, 99.08149689987309, 96.35932361062025, 101.0051064134326, 97.22835335697722, 94.15481919768743, 86.11520725023776, -14.071013792929918, 107.49048986471198, 107.57428168363886, 108.15880584926491, 96.15191888815556, 111.37397965012966, 112.11683615791472, 131.8833051327523, 88.68382728025405, 115.05706353759497, 102.9364229854523, 102.4374568546716, 104.03131145098357, 85.37840150205123, 123.77891925086567, 113.88107056284095, 106.88138926507445, 99.11771895860616, 100.01616443158902, 125.98375794144495, 104.23778610796717, 116.49201994562169, 95.84560229988926, 111.62829005593653, 95.00587275486903, 98.05451564926383, 102.92276436318984, 80.10869179968554, 122.67440864823371, 116.84541230180301, 120.15464860911453, 92.89303146322872, 111.41031793235136, 125.04362042542498, 114.49662548106548, 97.11181925554175, 91.52132951487009, 107.45835151027498, 97.52527814611132, 98.32914075382723, 105.91839499131478, 87.49023405654792, 116.5306805442103, 120.2712147070308, 101.5279705894805, 105.49390350789447, 98.60342916302935, 112.07608137035146, 97.72567380364677, 131.4563803455714, 90.91896319458054, 109.50047190665053, 72.3012414372086, 94.55609710634629, 106.95508795265944, 95.86111325902478, 106.10097120650337, 100.10179187658092, 99.4564473341405, 98.33415871904711, 107.28075770580615, 114.81886414588668, 93.94652155484057, 119.59206994040434, 95.5746718689159, 89.29823524601143, 99.6137272658846, 105.92649553910998, 101.1934520866465, 94.89470771270369, 121.6712391949106, 98.33102922902359, 107.97699541692388, 89.12870248014583, 110.17732754939803, 126.47787337641886, 88.96226938736541, 115.64527976978293], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.442963733632131, "mean_inference_ms": 7.658000989831055, "mean_action_processing_ms": 0.5245314257616357, "mean_env_wait_ms": 22.416027475924754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.043022871017456055, "StateBufferConnector_ms": 0.020128250122070312, "ViewRequirementAgentConnector_ms": 1.00343656539917}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1010834, "num_agent_steps_trained": 1010834, "num_env_steps_sampled": 1010834, "num_env_steps_trained": 1010834, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 260.70529869274134, "num_env_steps_trained_throughput_per_sec": 260.70529869274134, "timesteps_total": 1010834, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1010834, "timers": {"training_iteration_time_ms": 58428.771, "sample_time_ms": 43647.936, "load_time_ms": 1696.592, "load_throughput": 9028.098, "learn_time_ms": 12447.277, "learn_throughput": 1230.55, "synch_weights_time_ms": 534.007}, "counters": {"num_env_steps_sampled": 1010834, "num_env_steps_trained": 1010834, "num_agent_steps_sampled": 1010834, "num_agent_steps_trained": 1010834}, "done": false, "episodes_total": 1193, "training_iteration": 85, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-52-09", "timestamp": 1749304329, "time_this_iter_s": 59.996970891952515, "time_total_s": 4601.777137756348, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4601.777137756348, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 76.14492753623188, "ram_util_percent": 50.786956521739135, "gpu_util_percent0": 0.08695652173913042, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.989166e-05, "total_loss": -0.07632159569046715, "policy_loss": -0.008081269475038755, "vf_loss": 0.022801520767706362, "vf_explained_var": 0.9770295675234361, "kl": 0.016809555779171093, "entropy": 15.170524265982888, "entropy_coeff": 0.004983748999999999}, "model": {}, "num_grad_updates_lifetime": 35975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1026472, "num_env_steps_trained": 1026472, "num_agent_steps_sampled": 1026472, "num_agent_steps_trained": 1026472}, "sampler_results": {"episode_reward_max": 131.8833051327523, "episode_reward_min": -14.071013792929918, "episode_reward_mean": 103.83854882378441, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.82760165737439, 126.80661188217704, 99.08149689987309, 96.35932361062025, 101.0051064134326, 97.22835335697722, 94.15481919768743, 86.11520725023776, -14.071013792929918, 107.49048986471198, 107.57428168363886, 108.15880584926491, 96.15191888815556, 111.37397965012966, 112.11683615791472, 131.8833051327523, 88.68382728025405, 115.05706353759497, 102.9364229854523, 102.4374568546716, 104.03131145098357, 85.37840150205123, 123.77891925086567, 113.88107056284095, 106.88138926507445, 99.11771895860616, 100.01616443158902, 125.98375794144495, 104.23778610796717, 116.49201994562169, 95.84560229988926, 111.62829005593653, 95.00587275486903, 98.05451564926383, 102.92276436318984, 80.10869179968554, 122.67440864823371, 116.84541230180301, 120.15464860911453, 92.89303146322872, 111.41031793235136, 125.04362042542498, 114.49662548106548, 97.11181925554175, 91.52132951487009, 107.45835151027498, 97.52527814611132, 98.32914075382723, 105.91839499131478, 87.49023405654792, 116.5306805442103, 120.2712147070308, 101.5279705894805, 105.49390350789447, 98.60342916302935, 112.07608137035146, 97.72567380364677, 131.4563803455714, 90.91896319458054, 109.50047190665053, 72.3012414372086, 94.55609710634629, 106.95508795265944, 95.86111325902478, 106.10097120650337, 100.10179187658092, 99.4564473341405, 98.33415871904711, 107.28075770580615, 114.81886414588668, 93.94652155484057, 119.59206994040434, 95.5746718689159, 89.29823524601143, 99.6137272658846, 105.92649553910998, 101.1934520866465, 94.89470771270369, 121.6712391949106, 98.33102922902359, 107.97699541692388, 89.12870248014583, 110.17732754939803, 126.47787337641886, 88.96226938736541, 115.64527976978293, 89.77056614068078, 111.06472778794891, 100.43515289395152, 105.03367003261442, 100.78452267977859, 93.21360343279927, 107.86556152123251, 116.19264497000056, 100.98238775422016, 97.53710758974314, 100.4600278224697, 126.76208285749848, 118.10330970045905, 128.75883591132745], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4499182685145495, "mean_inference_ms": 7.678898319422668, "mean_action_processing_ms": 0.5258946408016864, "mean_env_wait_ms": 22.46089285393162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042055606842041016, "StateBufferConnector_ms": 0.022089242935180664, "ViewRequirementAgentConnector_ms": 1.0023913383483887}}, "episode_reward_max": 131.8833051327523, "episode_reward_min": -14.071013792929918, "episode_reward_mean": 103.83854882378441, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [125.82760165737439, 126.80661188217704, 99.08149689987309, 96.35932361062025, 101.0051064134326, 97.22835335697722, 94.15481919768743, 86.11520725023776, -14.071013792929918, 107.49048986471198, 107.57428168363886, 108.15880584926491, 96.15191888815556, 111.37397965012966, 112.11683615791472, 131.8833051327523, 88.68382728025405, 115.05706353759497, 102.9364229854523, 102.4374568546716, 104.03131145098357, 85.37840150205123, 123.77891925086567, 113.88107056284095, 106.88138926507445, 99.11771895860616, 100.01616443158902, 125.98375794144495, 104.23778610796717, 116.49201994562169, 95.84560229988926, 111.62829005593653, 95.00587275486903, 98.05451564926383, 102.92276436318984, 80.10869179968554, 122.67440864823371, 116.84541230180301, 120.15464860911453, 92.89303146322872, 111.41031793235136, 125.04362042542498, 114.49662548106548, 97.11181925554175, 91.52132951487009, 107.45835151027498, 97.52527814611132, 98.32914075382723, 105.91839499131478, 87.49023405654792, 116.5306805442103, 120.2712147070308, 101.5279705894805, 105.49390350789447, 98.60342916302935, 112.07608137035146, 97.72567380364677, 131.4563803455714, 90.91896319458054, 109.50047190665053, 72.3012414372086, 94.55609710634629, 106.95508795265944, 95.86111325902478, 106.10097120650337, 100.10179187658092, 99.4564473341405, 98.33415871904711, 107.28075770580615, 114.81886414588668, 93.94652155484057, 119.59206994040434, 95.5746718689159, 89.29823524601143, 99.6137272658846, 105.92649553910998, 101.1934520866465, 94.89470771270369, 121.6712391949106, 98.33102922902359, 107.97699541692388, 89.12870248014583, 110.17732754939803, 126.47787337641886, 88.96226938736541, 115.64527976978293, 89.77056614068078, 111.06472778794891, 100.43515289395152, 105.03367003261442, 100.78452267977859, 93.21360343279927, 107.86556152123251, 116.19264497000056, 100.98238775422016, 97.53710758974314, 100.4600278224697, 126.76208285749848, 118.10330970045905, 128.75883591132745], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4499182685145495, "mean_inference_ms": 7.678898319422668, "mean_action_processing_ms": 0.5258946408016864, "mean_env_wait_ms": 22.46089285393162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042055606842041016, "StateBufferConnector_ms": 0.022089242935180664, "ViewRequirementAgentConnector_ms": 1.0023913383483887}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1026472, "num_agent_steps_trained": 1026472, "num_env_steps_sampled": 1026472, "num_env_steps_trained": 1026472, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 271.48315148260895, "num_env_steps_trained_throughput_per_sec": 271.48315148260895, "timesteps_total": 1026472, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1026472, "timers": {"training_iteration_time_ms": 58459.205, "sample_time_ms": 43642.189, "load_time_ms": 1698.077, "load_throughput": 9068.614, "learn_time_ms": 12488.2, "learn_throughput": 1233.1, "synch_weights_time_ms": 527.419}, "counters": {"num_env_steps_sampled": 1026472, "num_env_steps_trained": 1026472, "num_agent_steps_sampled": 1026472, "num_agent_steps_trained": 1026472}, "done": false, "episodes_total": 1207, "training_iteration": 86, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-53-07", "timestamp": 1749304387, "time_this_iter_s": 57.61611366271973, "time_total_s": 4659.393251419067, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4659.393251419067, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 76.80151515151516, "ram_util_percent": 50.76060606060606, "gpu_util_percent0": 0.07818181818181817, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.973528000000001e-05, "total_loss": -0.0576579931860959, "policy_loss": 0.008586061601950364, "vf_loss": 0.0294228679578836, "vf_explained_var": 0.970496867461638, "kl": 0.01608251410594916, "entropy": 15.235694965015758, "entropy_coeff": 0.004960291999999998}, "model": {}, "num_grad_updates_lifetime": 36525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1042110, "num_env_steps_trained": 1042110, "num_agent_steps_sampled": 1042110, "num_agent_steps_trained": 1042110}, "sampler_results": {"episode_reward_max": 131.8833051327523, "episode_reward_min": 46.717934683233345, "episode_reward_mean": 104.22108938028947, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.11683615791472, 131.8833051327523, 88.68382728025405, 115.05706353759497, 102.9364229854523, 102.4374568546716, 104.03131145098357, 85.37840150205123, 123.77891925086567, 113.88107056284095, 106.88138926507445, 99.11771895860616, 100.01616443158902, 125.98375794144495, 104.23778610796717, 116.49201994562169, 95.84560229988926, 111.62829005593653, 95.00587275486903, 98.05451564926383, 102.92276436318984, 80.10869179968554, 122.67440864823371, 116.84541230180301, 120.15464860911453, 92.89303146322872, 111.41031793235136, 125.04362042542498, 114.49662548106548, 97.11181925554175, 91.52132951487009, 107.45835151027498, 97.52527814611132, 98.32914075382723, 105.91839499131478, 87.49023405654792, 116.5306805442103, 120.2712147070308, 101.5279705894805, 105.49390350789447, 98.60342916302935, 112.07608137035146, 97.72567380364677, 131.4563803455714, 90.91896319458054, 109.50047190665053, 72.3012414372086, 94.55609710634629, 106.95508795265944, 95.86111325902478, 106.10097120650337, 100.10179187658092, 99.4564473341405, 98.33415871904711, 107.28075770580615, 114.81886414588668, 93.94652155484057, 119.59206994040434, 95.5746718689159, 89.29823524601143, 99.6137272658846, 105.92649553910998, 101.1934520866465, 94.89470771270369, 121.6712391949106, 98.33102922902359, 107.97699541692388, 89.12870248014583, 110.17732754939803, 126.47787337641886, 88.96226938736541, 115.64527976978293, 89.77056614068078, 111.06472778794891, 100.43515289395152, 105.03367003261442, 100.78452267977859, 93.21360343279927, 107.86556152123251, 116.19264497000056, 100.98238775422016, 97.53710758974314, 100.4600278224697, 126.76208285749848, 118.10330970045905, 128.75883591132745, 87.4294398129918, 102.1360905257024, 98.38037075659344, 101.39335070149336, 71.17936113914404, 46.717934683233345, 118.0296136453728, 97.4955864737119, 109.86510019224094, 93.95539892478203, 110.56100976810967, 119.6786796774071, 109.46073159787201, 115.2283701632015], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4564245579256756, "mean_inference_ms": 7.697707295767795, "mean_action_processing_ms": 0.5270890056940988, "mean_env_wait_ms": 22.502276114170673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04107165336608887, "StateBufferConnector_ms": 0.019037961959838867, "ViewRequirementAgentConnector_ms": 1.0003232955932617}}, "episode_reward_max": 131.8833051327523, "episode_reward_min": 46.717934683233345, "episode_reward_mean": 104.22108938028947, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [112.11683615791472, 131.8833051327523, 88.68382728025405, 115.05706353759497, 102.9364229854523, 102.4374568546716, 104.03131145098357, 85.37840150205123, 123.77891925086567, 113.88107056284095, 106.88138926507445, 99.11771895860616, 100.01616443158902, 125.98375794144495, 104.23778610796717, 116.49201994562169, 95.84560229988926, 111.62829005593653, 95.00587275486903, 98.05451564926383, 102.92276436318984, 80.10869179968554, 122.67440864823371, 116.84541230180301, 120.15464860911453, 92.89303146322872, 111.41031793235136, 125.04362042542498, 114.49662548106548, 97.11181925554175, 91.52132951487009, 107.45835151027498, 97.52527814611132, 98.32914075382723, 105.91839499131478, 87.49023405654792, 116.5306805442103, 120.2712147070308, 101.5279705894805, 105.49390350789447, 98.60342916302935, 112.07608137035146, 97.72567380364677, 131.4563803455714, 90.91896319458054, 109.50047190665053, 72.3012414372086, 94.55609710634629, 106.95508795265944, 95.86111325902478, 106.10097120650337, 100.10179187658092, 99.4564473341405, 98.33415871904711, 107.28075770580615, 114.81886414588668, 93.94652155484057, 119.59206994040434, 95.5746718689159, 89.29823524601143, 99.6137272658846, 105.92649553910998, 101.1934520866465, 94.89470771270369, 121.6712391949106, 98.33102922902359, 107.97699541692388, 89.12870248014583, 110.17732754939803, 126.47787337641886, 88.96226938736541, 115.64527976978293, 89.77056614068078, 111.06472778794891, 100.43515289395152, 105.03367003261442, 100.78452267977859, 93.21360343279927, 107.86556152123251, 116.19264497000056, 100.98238775422016, 97.53710758974314, 100.4600278224697, 126.76208285749848, 118.10330970045905, 128.75883591132745, 87.4294398129918, 102.1360905257024, 98.38037075659344, 101.39335070149336, 71.17936113914404, 46.717934683233345, 118.0296136453728, 97.4955864737119, 109.86510019224094, 93.95539892478203, 110.56100976810967, 119.6786796774071, 109.46073159787201, 115.2283701632015], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4564245579256756, "mean_inference_ms": 7.697707295767795, "mean_action_processing_ms": 0.5270890056940988, "mean_env_wait_ms": 22.502276114170673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04107165336608887, "StateBufferConnector_ms": 0.019037961959838867, "ViewRequirementAgentConnector_ms": 1.0003232955932617}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1042110, "num_agent_steps_trained": 1042110, "num_env_steps_sampled": 1042110, "num_env_steps_trained": 1042110, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 267.52553497091526, "num_env_steps_trained_throughput_per_sec": 267.52553497091526, "timesteps_total": 1042110, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1042110, "timers": {"training_iteration_time_ms": 58964.232, "sample_time_ms": 43960.072, "load_time_ms": 1714.509, "load_throughput": 9077.584, "learn_time_ms": 12660.999, "learn_throughput": 1229.255, "synch_weights_time_ms": 523.73}, "counters": {"num_env_steps_sampled": 1042110, "num_env_steps_trained": 1042110, "num_agent_steps_sampled": 1042110, "num_agent_steps_trained": 1042110}, "done": false, "episodes_total": 1221, "training_iteration": 87, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-54-06", "timestamp": 1749304446, "time_this_iter_s": 58.47109127044678, "time_total_s": 4717.864342689514, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4717.864342689514, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 76.31911764705883, "ram_util_percent": 50.9970588235294, "gpu_util_percent0": 0.08676470588235294, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.957889999999998e-05, "total_loss": -0.06774796794422648, "policy_loss": -0.00010968439302153208, "vf_loss": 0.02330868138444864, "vf_explained_var": 0.9765430059216239, "kl": 0.01563474506018361, "entropy": 15.216120836084539, "entropy_coeff": 0.004936835}, "model": {}, "num_grad_updates_lifetime": 37075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1057748, "num_env_steps_trained": 1057748, "num_agent_steps_sampled": 1057748, "num_agent_steps_trained": 1057748}, "sampler_results": {"episode_reward_max": 131.4563803455714, "episode_reward_min": 46.717934683233345, "episode_reward_mean": 103.96659517451279, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.23778610796717, 116.49201994562169, 95.84560229988926, 111.62829005593653, 95.00587275486903, 98.05451564926383, 102.92276436318984, 80.10869179968554, 122.67440864823371, 116.84541230180301, 120.15464860911453, 92.89303146322872, 111.41031793235136, 125.04362042542498, 114.49662548106548, 97.11181925554175, 91.52132951487009, 107.45835151027498, 97.52527814611132, 98.32914075382723, 105.91839499131478, 87.49023405654792, 116.5306805442103, 120.2712147070308, 101.5279705894805, 105.49390350789447, 98.60342916302935, 112.07608137035146, 97.72567380364677, 131.4563803455714, 90.91896319458054, 109.50047190665053, 72.3012414372086, 94.55609710634629, 106.95508795265944, 95.86111325902478, 106.10097120650337, 100.10179187658092, 99.4564473341405, 98.33415871904711, 107.28075770580615, 114.81886414588668, 93.94652155484057, 119.59206994040434, 95.5746718689159, 89.29823524601143, 99.6137272658846, 105.92649553910998, 101.1934520866465, 94.89470771270369, 121.6712391949106, 98.33102922902359, 107.97699541692388, 89.12870248014583, 110.17732754939803, 126.47787337641886, 88.96226938736541, 115.64527976978293, 89.77056614068078, 111.06472778794891, 100.43515289395152, 105.03367003261442, 100.78452267977859, 93.21360343279927, 107.86556152123251, 116.19264497000056, 100.98238775422016, 97.53710758974314, 100.4600278224697, 126.76208285749848, 118.10330970045905, 128.75883591132745, 87.4294398129918, 102.1360905257024, 98.38037075659344, 101.39335070149336, 71.17936113914404, 46.717934683233345, 118.0296136453728, 97.4955864737119, 109.86510019224094, 93.95539892478203, 110.56100976810967, 119.6786796774071, 109.46073159787201, 115.2283701632015, 72.3671570464756, 114.72778597449931, 89.67037399218896, 104.47642887372236, 104.11137039670629, 96.74406945294976, 120.9747318119329, 103.59845570778751, 114.83776597671667, 86.43129939989255, 113.21332648113767, 121.91758986759272, 120.13664356078253, 123.52722619204287], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.46261001706977, "mean_inference_ms": 7.716525711580909, "mean_action_processing_ms": 0.5282845352775672, "mean_env_wait_ms": 22.543565555283326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04069638252258301, "StateBufferConnector_ms": 0.025063753128051758, "ViewRequirementAgentConnector_ms": 0.98555588722229}}, "episode_reward_max": 131.4563803455714, "episode_reward_min": 46.717934683233345, "episode_reward_mean": 103.96659517451279, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [104.23778610796717, 116.49201994562169, 95.84560229988926, 111.62829005593653, 95.00587275486903, 98.05451564926383, 102.92276436318984, 80.10869179968554, 122.67440864823371, 116.84541230180301, 120.15464860911453, 92.89303146322872, 111.41031793235136, 125.04362042542498, 114.49662548106548, 97.11181925554175, 91.52132951487009, 107.45835151027498, 97.52527814611132, 98.32914075382723, 105.91839499131478, 87.49023405654792, 116.5306805442103, 120.2712147070308, 101.5279705894805, 105.49390350789447, 98.60342916302935, 112.07608137035146, 97.72567380364677, 131.4563803455714, 90.91896319458054, 109.50047190665053, 72.3012414372086, 94.55609710634629, 106.95508795265944, 95.86111325902478, 106.10097120650337, 100.10179187658092, 99.4564473341405, 98.33415871904711, 107.28075770580615, 114.81886414588668, 93.94652155484057, 119.59206994040434, 95.5746718689159, 89.29823524601143, 99.6137272658846, 105.92649553910998, 101.1934520866465, 94.89470771270369, 121.6712391949106, 98.33102922902359, 107.97699541692388, 89.12870248014583, 110.17732754939803, 126.47787337641886, 88.96226938736541, 115.64527976978293, 89.77056614068078, 111.06472778794891, 100.43515289395152, 105.03367003261442, 100.78452267977859, 93.21360343279927, 107.86556152123251, 116.19264497000056, 100.98238775422016, 97.53710758974314, 100.4600278224697, 126.76208285749848, 118.10330970045905, 128.75883591132745, 87.4294398129918, 102.1360905257024, 98.38037075659344, 101.39335070149336, 71.17936113914404, 46.717934683233345, 118.0296136453728, 97.4955864737119, 109.86510019224094, 93.95539892478203, 110.56100976810967, 119.6786796774071, 109.46073159787201, 115.2283701632015, 72.3671570464756, 114.72778597449931, 89.67037399218896, 104.47642887372236, 104.11137039670629, 96.74406945294976, 120.9747318119329, 103.59845570778751, 114.83776597671667, 86.43129939989255, 113.21332648113767, 121.91758986759272, 120.13664356078253, 123.52722619204287], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.46261001706977, "mean_inference_ms": 7.716525711580909, "mean_action_processing_ms": 0.5282845352775672, "mean_env_wait_ms": 22.543565555283326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04069638252258301, "StateBufferConnector_ms": 0.025063753128051758, "ViewRequirementAgentConnector_ms": 0.98555588722229}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1057748, "num_agent_steps_trained": 1057748, "num_env_steps_sampled": 1057748, "num_env_steps_trained": 1057748, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 266.1227169200136, "num_env_steps_trained_throughput_per_sec": 266.1227169200136, "timesteps_total": 1057748, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1057748, "timers": {"training_iteration_time_ms": 59220.612, "sample_time_ms": 44207.084, "load_time_ms": 1702.48, "load_throughput": 9185.421, "learn_time_ms": 12712.91, "learn_throughput": 1230.088, "synch_weights_time_ms": 491.129}, "counters": {"num_env_steps_sampled": 1057748, "num_env_steps_trained": 1057748, "num_agent_steps_sampled": 1057748, "num_agent_steps_trained": 1057748}, "done": false, "episodes_total": 1235, "training_iteration": 88, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-55-04", "timestamp": 1749304504, "time_this_iter_s": 58.77735638618469, "time_total_s": 4776.641699075699, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4776.641699075699, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 76.53134328358209, "ram_util_percent": 52.57910447761194, "gpu_util_percent0": 0.08149253731343284, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.942252000000002e-05, "total_loss": -0.06440952280112966, "policy_loss": 0.003275372466411103, "vf_loss": 0.021174934936941347, "vf_explained_var": 0.9736348777467554, "kl": 0.016614914826935605, "entropy": 15.174201977469705, "entropy_coeff": 0.004913378000000001}, "model": {}, "num_grad_updates_lifetime": 37625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1073386, "num_env_steps_trained": 1073386, "num_agent_steps_sampled": 1073386, "num_agent_steps_trained": 1073386}, "sampler_results": {"episode_reward_max": 131.4563803455714, "episode_reward_min": 46.717934683233345, "episode_reward_mean": 103.98777548934652, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.49662548106548, 97.11181925554175, 91.52132951487009, 107.45835151027498, 97.52527814611132, 98.32914075382723, 105.91839499131478, 87.49023405654792, 116.5306805442103, 120.2712147070308, 101.5279705894805, 105.49390350789447, 98.60342916302935, 112.07608137035146, 97.72567380364677, 131.4563803455714, 90.91896319458054, 109.50047190665053, 72.3012414372086, 94.55609710634629, 106.95508795265944, 95.86111325902478, 106.10097120650337, 100.10179187658092, 99.4564473341405, 98.33415871904711, 107.28075770580615, 114.81886414588668, 93.94652155484057, 119.59206994040434, 95.5746718689159, 89.29823524601143, 99.6137272658846, 105.92649553910998, 101.1934520866465, 94.89470771270369, 121.6712391949106, 98.33102922902359, 107.97699541692388, 89.12870248014583, 110.17732754939803, 126.47787337641886, 88.96226938736541, 115.64527976978293, 89.77056614068078, 111.06472778794891, 100.43515289395152, 105.03367003261442, 100.78452267977859, 93.21360343279927, 107.86556152123251, 116.19264497000056, 100.98238775422016, 97.53710758974314, 100.4600278224697, 126.76208285749848, 118.10330970045905, 128.75883591132745, 87.4294398129918, 102.1360905257024, 98.38037075659344, 101.39335070149336, 71.17936113914404, 46.717934683233345, 118.0296136453728, 97.4955864737119, 109.86510019224094, 93.95539892478203, 110.56100976810967, 119.6786796774071, 109.46073159787201, 115.2283701632015, 72.3671570464756, 114.72778597449931, 89.67037399218896, 104.47642887372236, 104.11137039670629, 96.74406945294976, 120.9747318119329, 103.59845570778751, 114.83776597671667, 86.43129939989255, 113.21332648113767, 121.91758986759272, 120.13664356078253, 123.52722619204287, 94.6035070076531, 99.99558976225956, 93.92055096294213, 101.09293046620827, 111.92550049638069, 99.36862318036513, 114.67444131822933, 100.59248332763913, 113.24121311294047, 92.83667695493875, 107.51217305254241, 128.77742433550034, 114.50485634028665, 122.38904352206877], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4680701720812284, "mean_inference_ms": 7.733484007474927, "mean_action_processing_ms": 0.5293540637422232, "mean_env_wait_ms": 22.580466030910493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044814109802246094, "StateBufferConnector_ms": 0.02971029281616211, "ViewRequirementAgentConnector_ms": 0.9802556037902832}}, "episode_reward_max": 131.4563803455714, "episode_reward_min": 46.717934683233345, "episode_reward_mean": 103.98777548934652, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [114.49662548106548, 97.11181925554175, 91.52132951487009, 107.45835151027498, 97.52527814611132, 98.32914075382723, 105.91839499131478, 87.49023405654792, 116.5306805442103, 120.2712147070308, 101.5279705894805, 105.49390350789447, 98.60342916302935, 112.07608137035146, 97.72567380364677, 131.4563803455714, 90.91896319458054, 109.50047190665053, 72.3012414372086, 94.55609710634629, 106.95508795265944, 95.86111325902478, 106.10097120650337, 100.10179187658092, 99.4564473341405, 98.33415871904711, 107.28075770580615, 114.81886414588668, 93.94652155484057, 119.59206994040434, 95.5746718689159, 89.29823524601143, 99.6137272658846, 105.92649553910998, 101.1934520866465, 94.89470771270369, 121.6712391949106, 98.33102922902359, 107.97699541692388, 89.12870248014583, 110.17732754939803, 126.47787337641886, 88.96226938736541, 115.64527976978293, 89.77056614068078, 111.06472778794891, 100.43515289395152, 105.03367003261442, 100.78452267977859, 93.21360343279927, 107.86556152123251, 116.19264497000056, 100.98238775422016, 97.53710758974314, 100.4600278224697, 126.76208285749848, 118.10330970045905, 128.75883591132745, 87.4294398129918, 102.1360905257024, 98.38037075659344, 101.39335070149336, 71.17936113914404, 46.717934683233345, 118.0296136453728, 97.4955864737119, 109.86510019224094, 93.95539892478203, 110.56100976810967, 119.6786796774071, 109.46073159787201, 115.2283701632015, 72.3671570464756, 114.72778597449931, 89.67037399218896, 104.47642887372236, 104.11137039670629, 96.74406945294976, 120.9747318119329, 103.59845570778751, 114.83776597671667, 86.43129939989255, 113.21332648113767, 121.91758986759272, 120.13664356078253, 123.52722619204287, 94.6035070076531, 99.99558976225956, 93.92055096294213, 101.09293046620827, 111.92550049638069, 99.36862318036513, 114.67444131822933, 100.59248332763913, 113.24121311294047, 92.83667695493875, 107.51217305254241, 128.77742433550034, 114.50485634028665, 122.38904352206877], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4680701720812284, "mean_inference_ms": 7.733484007474927, "mean_action_processing_ms": 0.5293540637422232, "mean_env_wait_ms": 22.580466030910493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044814109802246094, "StateBufferConnector_ms": 0.02971029281616211, "ViewRequirementAgentConnector_ms": 0.9802556037902832}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1073386, "num_agent_steps_trained": 1073386, "num_env_steps_sampled": 1073386, "num_env_steps_trained": 1073386, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 279.5644812948119, "num_env_steps_trained_throughput_per_sec": 279.5644812948119, "timesteps_total": 1073386, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1073386, "timers": {"training_iteration_time_ms": 58887.328, "sample_time_ms": 44038.717, "load_time_ms": 1692.57, "load_throughput": 9239.204, "learn_time_ms": 12568.005, "learn_throughput": 1244.271, "synch_weights_time_ms": 478.887}, "counters": {"num_env_steps_sampled": 1073386, "num_env_steps_trained": 1073386, "num_agent_steps_sampled": 1073386, "num_agent_steps_trained": 1073386}, "done": false, "episodes_total": 1249, "training_iteration": 89, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-56-01", "timestamp": 1749304561, "time_this_iter_s": 55.956008195877075, "time_total_s": 4832.597707271576, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4832.597707271576, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 75.96923076923076, "ram_util_percent": 52.381538461538454, "gpu_util_percent0": 0.08184615384615385, "vram_util_percent0": 0.8409830729166667}}
{"evaluation": {"sampler_results": {"episode_reward_max": -9.473151397084784, "episode_reward_min": -10.476509395687495, "episode_reward_mean": -9.855655158395546, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.476509395687495, -9.551180726367015, -9.473151397084784, -9.965212886637289, -9.812221386201148], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7455403837312926, "mean_inference_ms": 3.813751019396193, "mean_action_processing_ms": 0.3035425232913871, "mean_env_wait_ms": 12.580924528748673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013265609741210938, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.18673419952392578}}, "episode_reward_max": -9.473151397084784, "episode_reward_min": -10.476509395687495, "episode_reward_mean": -9.855655158395546, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.476509395687495, -9.551180726367015, -9.473151397084784, -9.965212886637289, -9.812221386201148], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7455403837312926, "mean_inference_ms": 3.813751019396193, "mean_action_processing_ms": 0.3035425232913871, "mean_env_wait_ms": 12.580924528748673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013265609741210938, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.18673419952392578}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.926614000000002e-05, "total_loss": -0.024546156814745205, "policy_loss": 0.041210633782585236, "vf_loss": 0.025794738883745266, "vf_explained_var": 0.9718326784263958, "kl": 0.016497619055023654, "entropy": 15.135370745225385, "entropy_coeff": 0.004889921}, "model": {}, "num_grad_updates_lifetime": 38175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1089024, "num_env_steps_trained": 1089024, "num_agent_steps_sampled": 1089024, "num_agent_steps_trained": 1089024}, "sampler_results": {"episode_reward_max": 131.4563803455714, "episode_reward_min": 46.717934683233345, "episode_reward_mean": 103.70638794164715, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.72567380364677, 131.4563803455714, 90.91896319458054, 109.50047190665053, 72.3012414372086, 94.55609710634629, 106.95508795265944, 95.86111325902478, 106.10097120650337, 100.10179187658092, 99.4564473341405, 98.33415871904711, 107.28075770580615, 114.81886414588668, 93.94652155484057, 119.59206994040434, 95.5746718689159, 89.29823524601143, 99.6137272658846, 105.92649553910998, 101.1934520866465, 94.89470771270369, 121.6712391949106, 98.33102922902359, 107.97699541692388, 89.12870248014583, 110.17732754939803, 126.47787337641886, 88.96226938736541, 115.64527976978293, 89.77056614068078, 111.06472778794891, 100.43515289395152, 105.03367003261442, 100.78452267977859, 93.21360343279927, 107.86556152123251, 116.19264497000056, 100.98238775422016, 97.53710758974314, 100.4600278224697, 126.76208285749848, 118.10330970045905, 128.75883591132745, 87.4294398129918, 102.1360905257024, 98.38037075659344, 101.39335070149336, 71.17936113914404, 46.717934683233345, 118.0296136453728, 97.4955864737119, 109.86510019224094, 93.95539892478203, 110.56100976810967, 119.6786796774071, 109.46073159787201, 115.2283701632015, 72.3671570464756, 114.72778597449931, 89.67037399218896, 104.47642887372236, 104.11137039670629, 96.74406945294976, 120.9747318119329, 103.59845570778751, 114.83776597671667, 86.43129939989255, 113.21332648113767, 121.91758986759272, 120.13664356078253, 123.52722619204287, 94.6035070076531, 99.99558976225956, 93.92055096294213, 101.09293046620827, 111.92550049638069, 99.36862318036513, 114.67444131822933, 100.59248332763913, 113.24121311294047, 92.83667695493875, 107.51217305254241, 128.77742433550034, 114.50485634028665, 122.38904352206877, 94.46604994738924, 107.39972038899656, 96.3369744311303, 105.48018749040114, 103.74787982901533, 87.0153067996696, 120.06968683522079, 107.83874528995246, 96.54604943072107, 93.58466067892043, 110.18060257669535, 122.09510728545531, 102.90053104061796, 78.55419679742695], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.47309912882161, "mean_inference_ms": 7.749619515706894, "mean_action_processing_ms": 0.5303650800666793, "mean_env_wait_ms": 22.615009163737678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050759077072143555, "StateBufferConnector_ms": 0.036460161209106445, "ViewRequirementAgentConnector_ms": 0.9854874610900879}}, "episode_reward_max": 131.4563803455714, "episode_reward_min": 46.717934683233345, "episode_reward_mean": 103.70638794164715, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [97.72567380364677, 131.4563803455714, 90.91896319458054, 109.50047190665053, 72.3012414372086, 94.55609710634629, 106.95508795265944, 95.86111325902478, 106.10097120650337, 100.10179187658092, 99.4564473341405, 98.33415871904711, 107.28075770580615, 114.81886414588668, 93.94652155484057, 119.59206994040434, 95.5746718689159, 89.29823524601143, 99.6137272658846, 105.92649553910998, 101.1934520866465, 94.89470771270369, 121.6712391949106, 98.33102922902359, 107.97699541692388, 89.12870248014583, 110.17732754939803, 126.47787337641886, 88.96226938736541, 115.64527976978293, 89.77056614068078, 111.06472778794891, 100.43515289395152, 105.03367003261442, 100.78452267977859, 93.21360343279927, 107.86556152123251, 116.19264497000056, 100.98238775422016, 97.53710758974314, 100.4600278224697, 126.76208285749848, 118.10330970045905, 128.75883591132745, 87.4294398129918, 102.1360905257024, 98.38037075659344, 101.39335070149336, 71.17936113914404, 46.717934683233345, 118.0296136453728, 97.4955864737119, 109.86510019224094, 93.95539892478203, 110.56100976810967, 119.6786796774071, 109.46073159787201, 115.2283701632015, 72.3671570464756, 114.72778597449931, 89.67037399218896, 104.47642887372236, 104.11137039670629, 96.74406945294976, 120.9747318119329, 103.59845570778751, 114.83776597671667, 86.43129939989255, 113.21332648113767, 121.91758986759272, 120.13664356078253, 123.52722619204287, 94.6035070076531, 99.99558976225956, 93.92055096294213, 101.09293046620827, 111.92550049638069, 99.36862318036513, 114.67444131822933, 100.59248332763913, 113.24121311294047, 92.83667695493875, 107.51217305254241, 128.77742433550034, 114.50485634028665, 122.38904352206877, 94.46604994738924, 107.39972038899656, 96.3369744311303, 105.48018749040114, 103.74787982901533, 87.0153067996696, 120.06968683522079, 107.83874528995246, 96.54604943072107, 93.58466067892043, 110.18060257669535, 122.09510728545531, 102.90053104061796, 78.55419679742695], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.47309912882161, "mean_inference_ms": 7.749619515706894, "mean_action_processing_ms": 0.5303650800666793, "mean_env_wait_ms": 22.615009163737678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050759077072143555, "StateBufferConnector_ms": 0.036460161209106445, "ViewRequirementAgentConnector_ms": 0.9854874610900879}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1089024, "num_agent_steps_trained": 1089024, "num_env_steps_sampled": 1089024, "num_env_steps_trained": 1089024, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 277.25503665411964, "num_env_steps_trained_throughput_per_sec": 277.25503665411964, "timesteps_total": 1089024, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1089024, "timers": {"training_iteration_time_ms": 58340.58, "sample_time_ms": 43625.818, "load_time_ms": 1673.064, "load_throughput": 9346.925, "learn_time_ms": 12450.295, "learn_throughput": 1256.034, "synch_weights_time_ms": 481.99}, "counters": {"num_env_steps_sampled": 1089024, "num_env_steps_trained": 1089024, "num_agent_steps_sampled": 1089024, "num_agent_steps_trained": 1089024}, "done": false, "episodes_total": 1263, "training_iteration": 90, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-57-14", "timestamp": 1749304634, "time_this_iter_s": 73.40965485572815, "time_total_s": 4906.007362127304, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4906.007362127304, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 62.623255813953485, "ram_util_percent": 51.90465116279069, "gpu_util_percent0": 0.07127906976744187, "vram_util_percent0": 0.8409830729166671}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.910976e-05, "total_loss": -0.05536543880419975, "policy_loss": 0.01122069290860302, "vf_loss": 0.021621619673784485, "vf_explained_var": 0.976686339486729, "kl": 0.016054558181841167, "entropy": 15.118640833767978, "entropy_coeff": 0.004866464}, "model": {}, "num_grad_updates_lifetime": 38725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1104662, "num_env_steps_trained": 1104662, "num_agent_steps_sampled": 1104662, "num_agent_steps_trained": 1104662}, "sampler_results": {"episode_reward_max": 128.77742433550034, "episode_reward_min": 46.717934683233345, "episode_reward_mean": 104.24824035139007, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.94652155484057, 119.59206994040434, 95.5746718689159, 89.29823524601143, 99.6137272658846, 105.92649553910998, 101.1934520866465, 94.89470771270369, 121.6712391949106, 98.33102922902359, 107.97699541692388, 89.12870248014583, 110.17732754939803, 126.47787337641886, 88.96226938736541, 115.64527976978293, 89.77056614068078, 111.06472778794891, 100.43515289395152, 105.03367003261442, 100.78452267977859, 93.21360343279927, 107.86556152123251, 116.19264497000056, 100.98238775422016, 97.53710758974314, 100.4600278224697, 126.76208285749848, 118.10330970045905, 128.75883591132745, 87.4294398129918, 102.1360905257024, 98.38037075659344, 101.39335070149336, 71.17936113914404, 46.717934683233345, 118.0296136453728, 97.4955864737119, 109.86510019224094, 93.95539892478203, 110.56100976810967, 119.6786796774071, 109.46073159787201, 115.2283701632015, 72.3671570464756, 114.72778597449931, 89.67037399218896, 104.47642887372236, 104.11137039670629, 96.74406945294976, 120.9747318119329, 103.59845570778751, 114.83776597671667, 86.43129939989255, 113.21332648113767, 121.91758986759272, 120.13664356078253, 123.52722619204287, 94.6035070076531, 99.99558976225956, 93.92055096294213, 101.09293046620827, 111.92550049638069, 99.36862318036513, 114.67444131822933, 100.59248332763913, 113.24121311294047, 92.83667695493875, 107.51217305254241, 128.77742433550034, 114.50485634028665, 122.38904352206877, 94.46604994738924, 107.39972038899656, 96.3369744311303, 105.48018749040114, 103.74787982901533, 87.0153067996696, 120.06968683522079, 107.83874528995246, 96.54604943072107, 93.58466067892043, 110.18060257669535, 122.09510728545531, 102.90053104061796, 78.55419679742695, 87.07879659961472, 108.09591597924975, 93.22642376978808, 98.451484852385, 108.99031756476833, 90.1014210771653, 117.7504984343726, 105.85206883267887, 112.19757068410665, 97.19102506105564, 108.47233454748336, 113.63862339233319, 115.00924592117542, 123.49753425176965], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.477967278367496, "mean_inference_ms": 7.763873885275584, "mean_action_processing_ms": 0.5312322871581171, "mean_env_wait_ms": 22.64529471171891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047334909439086914, "StateBufferConnector_ms": 0.039489030838012695, "ViewRequirementAgentConnector_ms": 0.9554400444030762}}, "episode_reward_max": 128.77742433550034, "episode_reward_min": 46.717934683233345, "episode_reward_mean": 104.24824035139007, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [93.94652155484057, 119.59206994040434, 95.5746718689159, 89.29823524601143, 99.6137272658846, 105.92649553910998, 101.1934520866465, 94.89470771270369, 121.6712391949106, 98.33102922902359, 107.97699541692388, 89.12870248014583, 110.17732754939803, 126.47787337641886, 88.96226938736541, 115.64527976978293, 89.77056614068078, 111.06472778794891, 100.43515289395152, 105.03367003261442, 100.78452267977859, 93.21360343279927, 107.86556152123251, 116.19264497000056, 100.98238775422016, 97.53710758974314, 100.4600278224697, 126.76208285749848, 118.10330970045905, 128.75883591132745, 87.4294398129918, 102.1360905257024, 98.38037075659344, 101.39335070149336, 71.17936113914404, 46.717934683233345, 118.0296136453728, 97.4955864737119, 109.86510019224094, 93.95539892478203, 110.56100976810967, 119.6786796774071, 109.46073159787201, 115.2283701632015, 72.3671570464756, 114.72778597449931, 89.67037399218896, 104.47642887372236, 104.11137039670629, 96.74406945294976, 120.9747318119329, 103.59845570778751, 114.83776597671667, 86.43129939989255, 113.21332648113767, 121.91758986759272, 120.13664356078253, 123.52722619204287, 94.6035070076531, 99.99558976225956, 93.92055096294213, 101.09293046620827, 111.92550049638069, 99.36862318036513, 114.67444131822933, 100.59248332763913, 113.24121311294047, 92.83667695493875, 107.51217305254241, 128.77742433550034, 114.50485634028665, 122.38904352206877, 94.46604994738924, 107.39972038899656, 96.3369744311303, 105.48018749040114, 103.74787982901533, 87.0153067996696, 120.06968683522079, 107.83874528995246, 96.54604943072107, 93.58466067892043, 110.18060257669535, 122.09510728545531, 102.90053104061796, 78.55419679742695, 87.07879659961472, 108.09591597924975, 93.22642376978808, 98.451484852385, 108.99031756476833, 90.1014210771653, 117.7504984343726, 105.85206883267887, 112.19757068410665, 97.19102506105564, 108.47233454748336, 113.63862339233319, 115.00924592117542, 123.49753425176965], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.477967278367496, "mean_inference_ms": 7.763873885275584, "mean_action_processing_ms": 0.5312322871581171, "mean_env_wait_ms": 22.64529471171891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047334909439086914, "StateBufferConnector_ms": 0.039489030838012695, "ViewRequirementAgentConnector_ms": 0.9554400444030762}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104662, "num_agent_steps_trained": 1104662, "num_env_steps_sampled": 1104662, "num_env_steps_trained": 1104662, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 276.064937006666, "num_env_steps_trained_throughput_per_sec": 276.064937006666, "timesteps_total": 1104662, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1104662, "timers": {"training_iteration_time_ms": 58153.775, "sample_time_ms": 43506.868, "load_time_ms": 1660.025, "load_throughput": 9420.341, "learn_time_ms": 12430.111, "learn_throughput": 1258.074, "synch_weights_time_ms": 447.72}, "counters": {"num_env_steps_sampled": 1104662, "num_env_steps_trained": 1104662, "num_agent_steps_sampled": 1104662, "num_agent_steps_trained": 1104662}, "done": false, "episodes_total": 1277, "training_iteration": 91, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-58-11", "timestamp": 1749304691, "time_this_iter_s": 56.65808320045471, "time_total_s": 4962.665445327759, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 4962.665445327759, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 75.74242424242425, "ram_util_percent": 52.675757575757565, "gpu_util_percent0": 0.08121212121212121, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.895338e-05, "total_loss": -0.06867109652185305, "policy_loss": -0.0014860662280327893, "vf_loss": 0.019331073839937082, "vf_explained_var": 0.9792200083082373, "kl": 0.01594249190538065, "entropy": 15.172920868613502, "entropy_coeff": 0.004843007000000001}, "model": {}, "num_grad_updates_lifetime": 39275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1120300, "num_env_steps_trained": 1120300, "num_agent_steps_sampled": 1120300, "num_agent_steps_trained": 1120300}, "sampler_results": {"episode_reward_max": 128.77742433550034, "episode_reward_min": 46.717934683233345, "episode_reward_mean": 104.70009801521597, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.96226938736541, 115.64527976978293, 89.77056614068078, 111.06472778794891, 100.43515289395152, 105.03367003261442, 100.78452267977859, 93.21360343279927, 107.86556152123251, 116.19264497000056, 100.98238775422016, 97.53710758974314, 100.4600278224697, 126.76208285749848, 118.10330970045905, 128.75883591132745, 87.4294398129918, 102.1360905257024, 98.38037075659344, 101.39335070149336, 71.17936113914404, 46.717934683233345, 118.0296136453728, 97.4955864737119, 109.86510019224094, 93.95539892478203, 110.56100976810967, 119.6786796774071, 109.46073159787201, 115.2283701632015, 72.3671570464756, 114.72778597449931, 89.67037399218896, 104.47642887372236, 104.11137039670629, 96.74406945294976, 120.9747318119329, 103.59845570778751, 114.83776597671667, 86.43129939989255, 113.21332648113767, 121.91758986759272, 120.13664356078253, 123.52722619204287, 94.6035070076531, 99.99558976225956, 93.92055096294213, 101.09293046620827, 111.92550049638069, 99.36862318036513, 114.67444131822933, 100.59248332763913, 113.24121311294047, 92.83667695493875, 107.51217305254241, 128.77742433550034, 114.50485634028665, 122.38904352206877, 94.46604994738924, 107.39972038899656, 96.3369744311303, 105.48018749040114, 103.74787982901533, 87.0153067996696, 120.06968683522079, 107.83874528995246, 96.54604943072107, 93.58466067892043, 110.18060257669535, 122.09510728545531, 102.90053104061796, 78.55419679742695, 87.07879659961472, 108.09591597924975, 93.22642376978808, 98.451484852385, 108.99031756476833, 90.1014210771653, 117.7504984343726, 105.85206883267887, 112.19757068410665, 97.19102506105564, 108.47233454748336, 113.63862339233319, 115.00924592117542, 123.49753425176965, 90.01265307048114, 112.91624299236925, 95.36580448612625, 106.81140396806391, 105.22164475849053, 88.26647953810462, 121.92707740926993, 106.42691038339339, 114.94741448814577, 98.40363985755116, 102.26408822567895, 125.03949009054382, 107.54415102481069, 123.84181455089711], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.48242001373024, "mean_inference_ms": 7.776537996478124, "mean_action_processing_ms": 0.5320299455051688, "mean_env_wait_ms": 22.671794462747375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039339303970336914, "StateBufferConnector_ms": 0.04360699653625488, "ViewRequirementAgentConnector_ms": 0.9388132095336914}}, "episode_reward_max": 128.77742433550034, "episode_reward_min": 46.717934683233345, "episode_reward_mean": 104.70009801521597, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [88.96226938736541, 115.64527976978293, 89.77056614068078, 111.06472778794891, 100.43515289395152, 105.03367003261442, 100.78452267977859, 93.21360343279927, 107.86556152123251, 116.19264497000056, 100.98238775422016, 97.53710758974314, 100.4600278224697, 126.76208285749848, 118.10330970045905, 128.75883591132745, 87.4294398129918, 102.1360905257024, 98.38037075659344, 101.39335070149336, 71.17936113914404, 46.717934683233345, 118.0296136453728, 97.4955864737119, 109.86510019224094, 93.95539892478203, 110.56100976810967, 119.6786796774071, 109.46073159787201, 115.2283701632015, 72.3671570464756, 114.72778597449931, 89.67037399218896, 104.47642887372236, 104.11137039670629, 96.74406945294976, 120.9747318119329, 103.59845570778751, 114.83776597671667, 86.43129939989255, 113.21332648113767, 121.91758986759272, 120.13664356078253, 123.52722619204287, 94.6035070076531, 99.99558976225956, 93.92055096294213, 101.09293046620827, 111.92550049638069, 99.36862318036513, 114.67444131822933, 100.59248332763913, 113.24121311294047, 92.83667695493875, 107.51217305254241, 128.77742433550034, 114.50485634028665, 122.38904352206877, 94.46604994738924, 107.39972038899656, 96.3369744311303, 105.48018749040114, 103.74787982901533, 87.0153067996696, 120.06968683522079, 107.83874528995246, 96.54604943072107, 93.58466067892043, 110.18060257669535, 122.09510728545531, 102.90053104061796, 78.55419679742695, 87.07879659961472, 108.09591597924975, 93.22642376978808, 98.451484852385, 108.99031756476833, 90.1014210771653, 117.7504984343726, 105.85206883267887, 112.19757068410665, 97.19102506105564, 108.47233454748336, 113.63862339233319, 115.00924592117542, 123.49753425176965, 90.01265307048114, 112.91624299236925, 95.36580448612625, 106.81140396806391, 105.22164475849053, 88.26647953810462, 121.92707740926993, 106.42691038339339, 114.94741448814577, 98.40363985755116, 102.26408822567895, 125.03949009054382, 107.54415102481069, 123.84181455089711], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.48242001373024, "mean_inference_ms": 7.776537996478124, "mean_action_processing_ms": 0.5320299455051688, "mean_env_wait_ms": 22.671794462747375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039339303970336914, "StateBufferConnector_ms": 0.04360699653625488, "ViewRequirementAgentConnector_ms": 0.9388132095336914}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120300, "num_agent_steps_trained": 1120300, "num_env_steps_sampled": 1120300, "num_env_steps_trained": 1120300, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 277.52624789328314, "num_env_steps_trained_throughput_per_sec": 277.52624789328314, "timesteps_total": 1120300, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1120300, "timers": {"training_iteration_time_ms": 57786.901, "sample_time_ms": 43257.33, "load_time_ms": 1642.956, "load_throughput": 9518.207, "learn_time_ms": 12334.318, "learn_throughput": 1267.845, "synch_weights_time_ms": 443.773}, "counters": {"num_env_steps_sampled": 1120300, "num_env_steps_trained": 1120300, "num_agent_steps_sampled": 1120300, "num_agent_steps_trained": 1120300}, "done": false, "episodes_total": 1291, "training_iteration": 92, "trial_id": "b7a4b_00000", "date": "2025-06-07_15-59-07", "timestamp": 1749304747, "time_this_iter_s": 56.36081385612488, "time_total_s": 5019.026259183884, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5019.026259183884, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 75.88461538461539, "ram_util_percent": 53.410769230769226, "gpu_util_percent0": 0.0893846153846154, "vram_util_percent0": 0.8409830729166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.879700000000001e-05, "total_loss": -0.03930194104852324, "policy_loss": 0.025893545384857466, "vf_loss": 0.026209571829954672, "vf_explained_var": 0.9748656338995153, "kl": 0.01688788654965306, "entropy": 15.268251587260853, "entropy_coeff": 0.004819549999999999}, "model": {}, "num_grad_updates_lifetime": 39825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1135938, "num_env_steps_trained": 1135938, "num_agent_steps_sampled": 1135938, "num_agent_steps_trained": 1135938}, "sampler_results": {"episode_reward_max": 128.77742433550034, "episode_reward_min": 46.717934683233345, "episode_reward_mean": 104.7798810840855, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.10330970045905, 128.75883591132745, 87.4294398129918, 102.1360905257024, 98.38037075659344, 101.39335070149336, 71.17936113914404, 46.717934683233345, 118.0296136453728, 97.4955864737119, 109.86510019224094, 93.95539892478203, 110.56100976810967, 119.6786796774071, 109.46073159787201, 115.2283701632015, 72.3671570464756, 114.72778597449931, 89.67037399218896, 104.47642887372236, 104.11137039670629, 96.74406945294976, 120.9747318119329, 103.59845570778751, 114.83776597671667, 86.43129939989255, 113.21332648113767, 121.91758986759272, 120.13664356078253, 123.52722619204287, 94.6035070076531, 99.99558976225956, 93.92055096294213, 101.09293046620827, 111.92550049638069, 99.36862318036513, 114.67444131822933, 100.59248332763913, 113.24121311294047, 92.83667695493875, 107.51217305254241, 128.77742433550034, 114.50485634028665, 122.38904352206877, 94.46604994738924, 107.39972038899656, 96.3369744311303, 105.48018749040114, 103.74787982901533, 87.0153067996696, 120.06968683522079, 107.83874528995246, 96.54604943072107, 93.58466067892043, 110.18060257669535, 122.09510728545531, 102.90053104061796, 78.55419679742695, 87.07879659961472, 108.09591597924975, 93.22642376978808, 98.451484852385, 108.99031756476833, 90.1014210771653, 117.7504984343726, 105.85206883267887, 112.19757068410665, 97.19102506105564, 108.47233454748336, 113.63862339233319, 115.00924592117542, 123.49753425176965, 90.01265307048114, 112.91624299236925, 95.36580448612625, 106.81140396806391, 105.22164475849053, 88.26647953810462, 121.92707740926993, 106.42691038339339, 114.94741448814577, 98.40363985755116, 102.26408822567895, 125.03949009054382, 107.54415102481069, 123.84181455089711, 89.63355278582418, 85.28427210025559, 96.693355490128, 107.76330047300779, 108.18186312164396, 86.35908855888333, 120.31057186135418, 110.65585625047541, 94.56527290742324, 100.09227230517818, 112.20876388362225, 120.41526506799346, 112.55517597969342, 117.96930074155975], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4865519974336063, "mean_inference_ms": 7.787851828688955, "mean_action_processing_ms": 0.5327331363699345, "mean_env_wait_ms": 22.695739654504212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04330039024353027, "StateBufferConnector_ms": 0.04769611358642578, "ViewRequirementAgentConnector_ms": 0.9561631679534912}}, "episode_reward_max": 128.77742433550034, "episode_reward_min": 46.717934683233345, "episode_reward_mean": 104.7798810840855, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [118.10330970045905, 128.75883591132745, 87.4294398129918, 102.1360905257024, 98.38037075659344, 101.39335070149336, 71.17936113914404, 46.717934683233345, 118.0296136453728, 97.4955864737119, 109.86510019224094, 93.95539892478203, 110.56100976810967, 119.6786796774071, 109.46073159787201, 115.2283701632015, 72.3671570464756, 114.72778597449931, 89.67037399218896, 104.47642887372236, 104.11137039670629, 96.74406945294976, 120.9747318119329, 103.59845570778751, 114.83776597671667, 86.43129939989255, 113.21332648113767, 121.91758986759272, 120.13664356078253, 123.52722619204287, 94.6035070076531, 99.99558976225956, 93.92055096294213, 101.09293046620827, 111.92550049638069, 99.36862318036513, 114.67444131822933, 100.59248332763913, 113.24121311294047, 92.83667695493875, 107.51217305254241, 128.77742433550034, 114.50485634028665, 122.38904352206877, 94.46604994738924, 107.39972038899656, 96.3369744311303, 105.48018749040114, 103.74787982901533, 87.0153067996696, 120.06968683522079, 107.83874528995246, 96.54604943072107, 93.58466067892043, 110.18060257669535, 122.09510728545531, 102.90053104061796, 78.55419679742695, 87.07879659961472, 108.09591597924975, 93.22642376978808, 98.451484852385, 108.99031756476833, 90.1014210771653, 117.7504984343726, 105.85206883267887, 112.19757068410665, 97.19102506105564, 108.47233454748336, 113.63862339233319, 115.00924592117542, 123.49753425176965, 90.01265307048114, 112.91624299236925, 95.36580448612625, 106.81140396806391, 105.22164475849053, 88.26647953810462, 121.92707740926993, 106.42691038339339, 114.94741448814577, 98.40363985755116, 102.26408822567895, 125.03949009054382, 107.54415102481069, 123.84181455089711, 89.63355278582418, 85.28427210025559, 96.693355490128, 107.76330047300779, 108.18186312164396, 86.35908855888333, 120.31057186135418, 110.65585625047541, 94.56527290742324, 100.09227230517818, 112.20876388362225, 120.41526506799346, 112.55517597969342, 117.96930074155975], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4865519974336063, "mean_inference_ms": 7.787851828688955, "mean_action_processing_ms": 0.5327331363699345, "mean_env_wait_ms": 22.695739654504212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04330039024353027, "StateBufferConnector_ms": 0.04769611358642578, "ViewRequirementAgentConnector_ms": 0.9561631679534912}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1135938, "num_agent_steps_trained": 1135938, "num_env_steps_sampled": 1135938, "num_env_steps_trained": 1135938, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 276.51740121561454, "num_env_steps_trained_throughput_per_sec": 276.51740121561454, "timesteps_total": 1135938, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1135938, "timers": {"training_iteration_time_ms": 57606.435, "sample_time_ms": 43142.401, "load_time_ms": 1633.408, "load_throughput": 9573.845, "learn_time_ms": 12276.144, "learn_throughput": 1273.853, "synch_weights_time_ms": 446.456}, "counters": {"num_env_steps_sampled": 1135938, "num_env_steps_trained": 1135938, "num_agent_steps_sampled": 1135938, "num_agent_steps_trained": 1135938}, "done": false, "episodes_total": 1305, "training_iteration": 93, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-00-04", "timestamp": 1749304804, "time_this_iter_s": 56.56452226638794, "time_total_s": 5075.590781450272, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5075.590781450272, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 76.02461538461537, "ram_util_percent": 53.68615384615385, "gpu_util_percent0": 0.08953846153846154, "vram_util_percent0": 0.8409830729166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.864062e-05, "total_loss": -0.041665518167005346, "policy_loss": 0.024421742894602094, "vf_loss": 0.021554593381217936, "vf_explained_var": 0.976960751360113, "kl": 0.01649106074241194, "entropy": 15.23510690689087, "entropy_coeff": 0.004796093}, "model": {}, "num_grad_updates_lifetime": 40375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1151576, "num_env_steps_trained": 1151576, "num_agent_steps_sampled": 1151576, "num_agent_steps_trained": 1151576}, "sampler_results": {"episode_reward_max": 128.77742433550034, "episode_reward_min": 72.3671570464756, "episode_reward_mean": 105.21809283199887, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.46073159787201, 115.2283701632015, 72.3671570464756, 114.72778597449931, 89.67037399218896, 104.47642887372236, 104.11137039670629, 96.74406945294976, 120.9747318119329, 103.59845570778751, 114.83776597671667, 86.43129939989255, 113.21332648113767, 121.91758986759272, 120.13664356078253, 123.52722619204287, 94.6035070076531, 99.99558976225956, 93.92055096294213, 101.09293046620827, 111.92550049638069, 99.36862318036513, 114.67444131822933, 100.59248332763913, 113.24121311294047, 92.83667695493875, 107.51217305254241, 128.77742433550034, 114.50485634028665, 122.38904352206877, 94.46604994738924, 107.39972038899656, 96.3369744311303, 105.48018749040114, 103.74787982901533, 87.0153067996696, 120.06968683522079, 107.83874528995246, 96.54604943072107, 93.58466067892043, 110.18060257669535, 122.09510728545531, 102.90053104061796, 78.55419679742695, 87.07879659961472, 108.09591597924975, 93.22642376978808, 98.451484852385, 108.99031756476833, 90.1014210771653, 117.7504984343726, 105.85206883267887, 112.19757068410665, 97.19102506105564, 108.47233454748336, 113.63862339233319, 115.00924592117542, 123.49753425176965, 90.01265307048114, 112.91624299236925, 95.36580448612625, 106.81140396806391, 105.22164475849053, 88.26647953810462, 121.92707740926993, 106.42691038339339, 114.94741448814577, 98.40363985755116, 102.26408822567895, 125.03949009054382, 107.54415102481069, 123.84181455089711, 89.63355278582418, 85.28427210025559, 96.693355490128, 107.76330047300779, 108.18186312164396, 86.35908855888333, 120.31057186135418, 110.65585625047541, 94.56527290742324, 100.09227230517818, 112.20876388362225, 120.41526506799346, 112.55517597969342, 117.96930074155975, 73.7728809487073, 103.55777506172218, 89.18927504292068, 102.6254997676, 110.11170608724949, 89.32596554213585, 115.26816930546832, 107.54092215419084, 110.48105706264921, 94.11458829996097, 106.44632098867388, 107.39245176521239, 111.19462511367394, 126.48401956373809], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4906134073477393, "mean_inference_ms": 7.798042757252392, "mean_action_processing_ms": 0.5333773998383755, "mean_env_wait_ms": 22.71679895764524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04228329658508301, "StateBufferConnector_ms": 0.05058717727661133, "ViewRequirementAgentConnector_ms": 0.9636788368225098}}, "episode_reward_max": 128.77742433550034, "episode_reward_min": 72.3671570464756, "episode_reward_mean": 105.21809283199887, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [109.46073159787201, 115.2283701632015, 72.3671570464756, 114.72778597449931, 89.67037399218896, 104.47642887372236, 104.11137039670629, 96.74406945294976, 120.9747318119329, 103.59845570778751, 114.83776597671667, 86.43129939989255, 113.21332648113767, 121.91758986759272, 120.13664356078253, 123.52722619204287, 94.6035070076531, 99.99558976225956, 93.92055096294213, 101.09293046620827, 111.92550049638069, 99.36862318036513, 114.67444131822933, 100.59248332763913, 113.24121311294047, 92.83667695493875, 107.51217305254241, 128.77742433550034, 114.50485634028665, 122.38904352206877, 94.46604994738924, 107.39972038899656, 96.3369744311303, 105.48018749040114, 103.74787982901533, 87.0153067996696, 120.06968683522079, 107.83874528995246, 96.54604943072107, 93.58466067892043, 110.18060257669535, 122.09510728545531, 102.90053104061796, 78.55419679742695, 87.07879659961472, 108.09591597924975, 93.22642376978808, 98.451484852385, 108.99031756476833, 90.1014210771653, 117.7504984343726, 105.85206883267887, 112.19757068410665, 97.19102506105564, 108.47233454748336, 113.63862339233319, 115.00924592117542, 123.49753425176965, 90.01265307048114, 112.91624299236925, 95.36580448612625, 106.81140396806391, 105.22164475849053, 88.26647953810462, 121.92707740926993, 106.42691038339339, 114.94741448814577, 98.40363985755116, 102.26408822567895, 125.03949009054382, 107.54415102481069, 123.84181455089711, 89.63355278582418, 85.28427210025559, 96.693355490128, 107.76330047300779, 108.18186312164396, 86.35908855888333, 120.31057186135418, 110.65585625047541, 94.56527290742324, 100.09227230517818, 112.20876388362225, 120.41526506799346, 112.55517597969342, 117.96930074155975, 73.7728809487073, 103.55777506172218, 89.18927504292068, 102.6254997676, 110.11170608724949, 89.32596554213585, 115.26816930546832, 107.54092215419084, 110.48105706264921, 94.11458829996097, 106.44632098867388, 107.39245176521239, 111.19462511367394, 126.48401956373809], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4906134073477393, "mean_inference_ms": 7.798042757252392, "mean_action_processing_ms": 0.5333773998383755, "mean_env_wait_ms": 22.71679895764524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04228329658508301, "StateBufferConnector_ms": 0.05058717727661133, "ViewRequirementAgentConnector_ms": 0.9636788368225098}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1151576, "num_agent_steps_trained": 1151576, "num_env_steps_sampled": 1151576, "num_env_steps_trained": 1151576, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 278.8919184913503, "num_env_steps_trained_throughput_per_sec": 278.8919184913503, "timesteps_total": 1151576, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1151576, "timers": {"training_iteration_time_ms": 57276.13, "sample_time_ms": 42855.774, "load_time_ms": 1637.094, "load_throughput": 9552.29, "learn_time_ms": 12228.923, "learn_throughput": 1278.772, "synch_weights_time_ms": 444.77}, "counters": {"num_env_steps_sampled": 1151576, "num_env_steps_trained": 1151576, "num_agent_steps_sampled": 1151576, "num_agent_steps_trained": 1151576}, "done": false, "episodes_total": 1319, "training_iteration": 94, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-01-00", "timestamp": 1749304860, "time_this_iter_s": 56.08779764175415, "time_total_s": 5131.678579092026, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5131.678579092026, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 76.50307692307692, "ram_util_percent": 53.690769230769234, "gpu_util_percent0": 0.08446153846153845, "vram_util_percent0": 0.8409830729166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.848424e-05, "total_loss": -0.06150959765199911, "policy_loss": 0.0030219977925034155, "vf_loss": 0.02550606362204152, "vf_explained_var": 0.9745766971328041, "kl": 0.015634551269787703, "entropy": 15.226804051832719, "entropy_coeff": 0.004772636}, "model": {}, "num_grad_updates_lifetime": 40925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1167214, "num_env_steps_trained": 1167214, "num_agent_steps_sampled": 1167214, "num_agent_steps_trained": 1167214}, "sampler_results": {"episode_reward_max": 128.77742433550034, "episode_reward_min": 73.7728809487073, "episode_reward_mean": 104.9979385796164, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.13664356078253, 123.52722619204287, 94.6035070076531, 99.99558976225956, 93.92055096294213, 101.09293046620827, 111.92550049638069, 99.36862318036513, 114.67444131822933, 100.59248332763913, 113.24121311294047, 92.83667695493875, 107.51217305254241, 128.77742433550034, 114.50485634028665, 122.38904352206877, 94.46604994738924, 107.39972038899656, 96.3369744311303, 105.48018749040114, 103.74787982901533, 87.0153067996696, 120.06968683522079, 107.83874528995246, 96.54604943072107, 93.58466067892043, 110.18060257669535, 122.09510728545531, 102.90053104061796, 78.55419679742695, 87.07879659961472, 108.09591597924975, 93.22642376978808, 98.451484852385, 108.99031756476833, 90.1014210771653, 117.7504984343726, 105.85206883267887, 112.19757068410665, 97.19102506105564, 108.47233454748336, 113.63862339233319, 115.00924592117542, 123.49753425176965, 90.01265307048114, 112.91624299236925, 95.36580448612625, 106.81140396806391, 105.22164475849053, 88.26647953810462, 121.92707740926993, 106.42691038339339, 114.94741448814577, 98.40363985755116, 102.26408822567895, 125.03949009054382, 107.54415102481069, 123.84181455089711, 89.63355278582418, 85.28427210025559, 96.693355490128, 107.76330047300779, 108.18186312164396, 86.35908855888333, 120.31057186135418, 110.65585625047541, 94.56527290742324, 100.09227230517818, 112.20876388362225, 120.41526506799346, 112.55517597969342, 117.96930074155975, 73.7728809487073, 103.55777506172218, 89.18927504292068, 102.6254997676, 110.11170608724949, 89.32596554213585, 115.26816930546832, 107.54092215419084, 110.48105706264921, 94.11458829996097, 106.44632098867388, 107.39245176521239, 111.19462511367394, 126.48401956373809, 84.76169440459883, 107.43351341989376, 96.8050612211555, 108.34192383996707, 94.90819730269969, 87.40139325247087, 114.286487780084, 118.69018111196779, 109.46732422862394, 90.90441201108294, 108.72466307934202, 105.42380199916876, 94.4869971450578, 124.10838070831753], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.494377516845986, "mean_inference_ms": 7.806845008995884, "mean_action_processing_ms": 0.5339384272112973, "mean_env_wait_ms": 22.734784568826527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045545101165771484, "StateBufferConnector_ms": 0.048128604888916016, "ViewRequirementAgentConnector_ms": 0.970731258392334}}, "episode_reward_max": 128.77742433550034, "episode_reward_min": 73.7728809487073, "episode_reward_mean": 104.9979385796164, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [120.13664356078253, 123.52722619204287, 94.6035070076531, 99.99558976225956, 93.92055096294213, 101.09293046620827, 111.92550049638069, 99.36862318036513, 114.67444131822933, 100.59248332763913, 113.24121311294047, 92.83667695493875, 107.51217305254241, 128.77742433550034, 114.50485634028665, 122.38904352206877, 94.46604994738924, 107.39972038899656, 96.3369744311303, 105.48018749040114, 103.74787982901533, 87.0153067996696, 120.06968683522079, 107.83874528995246, 96.54604943072107, 93.58466067892043, 110.18060257669535, 122.09510728545531, 102.90053104061796, 78.55419679742695, 87.07879659961472, 108.09591597924975, 93.22642376978808, 98.451484852385, 108.99031756476833, 90.1014210771653, 117.7504984343726, 105.85206883267887, 112.19757068410665, 97.19102506105564, 108.47233454748336, 113.63862339233319, 115.00924592117542, 123.49753425176965, 90.01265307048114, 112.91624299236925, 95.36580448612625, 106.81140396806391, 105.22164475849053, 88.26647953810462, 121.92707740926993, 106.42691038339339, 114.94741448814577, 98.40363985755116, 102.26408822567895, 125.03949009054382, 107.54415102481069, 123.84181455089711, 89.63355278582418, 85.28427210025559, 96.693355490128, 107.76330047300779, 108.18186312164396, 86.35908855888333, 120.31057186135418, 110.65585625047541, 94.56527290742324, 100.09227230517818, 112.20876388362225, 120.41526506799346, 112.55517597969342, 117.96930074155975, 73.7728809487073, 103.55777506172218, 89.18927504292068, 102.6254997676, 110.11170608724949, 89.32596554213585, 115.26816930546832, 107.54092215419084, 110.48105706264921, 94.11458829996097, 106.44632098867388, 107.39245176521239, 111.19462511367394, 126.48401956373809, 84.76169440459883, 107.43351341989376, 96.8050612211555, 108.34192383996707, 94.90819730269969, 87.40139325247087, 114.286487780084, 118.69018111196779, 109.46732422862394, 90.90441201108294, 108.72466307934202, 105.42380199916876, 94.4869971450578, 124.10838070831753], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.494377516845986, "mean_inference_ms": 7.806845008995884, "mean_action_processing_ms": 0.5339384272112973, "mean_env_wait_ms": 22.734784568826527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045545101165771484, "StateBufferConnector_ms": 0.048128604888916016, "ViewRequirementAgentConnector_ms": 0.970731258392334}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1167214, "num_agent_steps_trained": 1167214, "num_env_steps_sampled": 1167214, "num_env_steps_trained": 1167214, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 275.62262585515657, "num_env_steps_trained_throughput_per_sec": 275.62262585515657, "timesteps_total": 1167214, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1167214, "timers": {"training_iteration_time_ms": 56951.486, "sample_time_ms": 42603.142, "load_time_ms": 1621.484, "load_throughput": 9644.254, "learn_time_ms": 12173.726, "learn_throughput": 1284.57, "synch_weights_time_ms": 443.405}, "counters": {"num_env_steps_sampled": 1167214, "num_env_steps_trained": 1167214, "num_agent_steps_sampled": 1167214, "num_agent_steps_trained": 1167214}, "done": false, "episodes_total": 1333, "training_iteration": 95, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-01-57", "timestamp": 1749304917, "time_this_iter_s": 56.75025963783264, "time_total_s": 5188.428838729858, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5188.428838729858, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 75.99538461538461, "ram_util_percent": 53.66615384615385, "gpu_util_percent0": 0.08430769230769232, "vram_util_percent0": 0.8409830729166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.832786e-05, "total_loss": -0.054841795317109, "policy_loss": 0.010315517623358491, "vf_loss": 0.021430798825723203, "vf_explained_var": 0.9762870340997523, "kl": 0.015728288525014334, "entropy": 15.176952084628018, "entropy_coeff": 0.004749179}, "model": {}, "num_grad_updates_lifetime": 41475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1182852, "num_env_steps_trained": 1182852, "num_agent_steps_sampled": 1182852, "num_agent_steps_trained": 1182852}, "sampler_results": {"episode_reward_max": 126.48401956373809, "episode_reward_min": 73.7728809487073, "episode_reward_mean": 104.6964383554393, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.50485634028665, 122.38904352206877, 94.46604994738924, 107.39972038899656, 96.3369744311303, 105.48018749040114, 103.74787982901533, 87.0153067996696, 120.06968683522079, 107.83874528995246, 96.54604943072107, 93.58466067892043, 110.18060257669535, 122.09510728545531, 102.90053104061796, 78.55419679742695, 87.07879659961472, 108.09591597924975, 93.22642376978808, 98.451484852385, 108.99031756476833, 90.1014210771653, 117.7504984343726, 105.85206883267887, 112.19757068410665, 97.19102506105564, 108.47233454748336, 113.63862339233319, 115.00924592117542, 123.49753425176965, 90.01265307048114, 112.91624299236925, 95.36580448612625, 106.81140396806391, 105.22164475849053, 88.26647953810462, 121.92707740926993, 106.42691038339339, 114.94741448814577, 98.40363985755116, 102.26408822567895, 125.03949009054382, 107.54415102481069, 123.84181455089711, 89.63355278582418, 85.28427210025559, 96.693355490128, 107.76330047300779, 108.18186312164396, 86.35908855888333, 120.31057186135418, 110.65585625047541, 94.56527290742324, 100.09227230517818, 112.20876388362225, 120.41526506799346, 112.55517597969342, 117.96930074155975, 73.7728809487073, 103.55777506172218, 89.18927504292068, 102.6254997676, 110.11170608724949, 89.32596554213585, 115.26816930546832, 107.54092215419084, 110.48105706264921, 94.11458829996097, 106.44632098867388, 107.39245176521239, 111.19462511367394, 126.48401956373809, 84.76169440459883, 107.43351341989376, 96.8050612211555, 108.34192383996707, 94.90819730269969, 87.40139325247087, 114.286487780084, 118.69018111196779, 109.46732422862394, 90.90441201108294, 108.72466307934202, 105.42380199916876, 94.4869971450578, 124.10838070831753, 87.37445725738328, 109.04254408151938, 98.77974782810556, 103.45442426374093, 106.31610348509322, 85.01917896987177, 115.69213909334692, 108.61587728676811, 103.98996220413109, 104.39723904698548, 106.38293626284418, 119.98465727613238, 111.2770484427231, 111.7286458140672], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4981225318841296, "mean_inference_ms": 7.816535764845636, "mean_action_processing_ms": 0.5345675191903915, "mean_env_wait_ms": 22.75470814793749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03841257095336914, "StateBufferConnector_ms": 0.04855942726135254, "ViewRequirementAgentConnector_ms": 0.9533982276916504}}, "episode_reward_max": 126.48401956373809, "episode_reward_min": 73.7728809487073, "episode_reward_mean": 104.6964383554393, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [114.50485634028665, 122.38904352206877, 94.46604994738924, 107.39972038899656, 96.3369744311303, 105.48018749040114, 103.74787982901533, 87.0153067996696, 120.06968683522079, 107.83874528995246, 96.54604943072107, 93.58466067892043, 110.18060257669535, 122.09510728545531, 102.90053104061796, 78.55419679742695, 87.07879659961472, 108.09591597924975, 93.22642376978808, 98.451484852385, 108.99031756476833, 90.1014210771653, 117.7504984343726, 105.85206883267887, 112.19757068410665, 97.19102506105564, 108.47233454748336, 113.63862339233319, 115.00924592117542, 123.49753425176965, 90.01265307048114, 112.91624299236925, 95.36580448612625, 106.81140396806391, 105.22164475849053, 88.26647953810462, 121.92707740926993, 106.42691038339339, 114.94741448814577, 98.40363985755116, 102.26408822567895, 125.03949009054382, 107.54415102481069, 123.84181455089711, 89.63355278582418, 85.28427210025559, 96.693355490128, 107.76330047300779, 108.18186312164396, 86.35908855888333, 120.31057186135418, 110.65585625047541, 94.56527290742324, 100.09227230517818, 112.20876388362225, 120.41526506799346, 112.55517597969342, 117.96930074155975, 73.7728809487073, 103.55777506172218, 89.18927504292068, 102.6254997676, 110.11170608724949, 89.32596554213585, 115.26816930546832, 107.54092215419084, 110.48105706264921, 94.11458829996097, 106.44632098867388, 107.39245176521239, 111.19462511367394, 126.48401956373809, 84.76169440459883, 107.43351341989376, 96.8050612211555, 108.34192383996707, 94.90819730269969, 87.40139325247087, 114.286487780084, 118.69018111196779, 109.46732422862394, 90.90441201108294, 108.72466307934202, 105.42380199916876, 94.4869971450578, 124.10838070831753, 87.37445725738328, 109.04254408151938, 98.77974782810556, 103.45442426374093, 106.31610348509322, 85.01917896987177, 115.69213909334692, 108.61587728676811, 103.98996220413109, 104.39723904698548, 106.38293626284418, 119.98465727613238, 111.2770484427231, 111.7286458140672], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4981225318841296, "mean_inference_ms": 7.816535764845636, "mean_action_processing_ms": 0.5345675191903915, "mean_env_wait_ms": 22.75470814793749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03841257095336914, "StateBufferConnector_ms": 0.04855942726135254, "ViewRequirementAgentConnector_ms": 0.9533982276916504}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1182852, "num_agent_steps_trained": 1182852, "num_env_steps_sampled": 1182852, "num_env_steps_trained": 1182852, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 263.84807293614597, "num_env_steps_trained_throughput_per_sec": 263.84807293614597, "timesteps_total": 1182852, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1182852, "timers": {"training_iteration_time_ms": 57118.172, "sample_time_ms": 42692.232, "load_time_ms": 1626.288, "load_throughput": 9615.761, "learn_time_ms": 12243.336, "learn_throughput": 1277.266, "synch_weights_time_ms": 446.846}, "counters": {"num_env_steps_sampled": 1182852, "num_env_steps_trained": 1182852, "num_agent_steps_sampled": 1182852, "num_agent_steps_trained": 1182852}, "done": false, "episodes_total": 1347, "training_iteration": 96, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-02-56", "timestamp": 1749304976, "time_this_iter_s": 59.29297590255737, "time_total_s": 5247.721814632416, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5247.721814632416, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 77.32499999999999, "ram_util_percent": 53.94264705882353, "gpu_util_percent0": 0.08764705882352941, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.817148e-05, "total_loss": -0.06507818458771164, "policy_loss": 0.00025348844366486777, "vf_loss": 0.01934395228808915, "vf_explained_var": 0.9766614392670718, "kl": 0.016665788943249604, "entropy": 15.162903059179133, "entropy_coeff": 0.004725722000000001}, "model": {}, "num_grad_updates_lifetime": 42025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1198490, "num_env_steps_trained": 1198490, "num_agent_steps_sampled": 1198490, "num_agent_steps_trained": 1198490}, "sampler_results": {"episode_reward_max": 126.48401956373809, "episode_reward_min": 73.7728809487073, "episode_reward_mean": 104.55047084116148, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.90053104061796, 78.55419679742695, 87.07879659961472, 108.09591597924975, 93.22642376978808, 98.451484852385, 108.99031756476833, 90.1014210771653, 117.7504984343726, 105.85206883267887, 112.19757068410665, 97.19102506105564, 108.47233454748336, 113.63862339233319, 115.00924592117542, 123.49753425176965, 90.01265307048114, 112.91624299236925, 95.36580448612625, 106.81140396806391, 105.22164475849053, 88.26647953810462, 121.92707740926993, 106.42691038339339, 114.94741448814577, 98.40363985755116, 102.26408822567895, 125.03949009054382, 107.54415102481069, 123.84181455089711, 89.63355278582418, 85.28427210025559, 96.693355490128, 107.76330047300779, 108.18186312164396, 86.35908855888333, 120.31057186135418, 110.65585625047541, 94.56527290742324, 100.09227230517818, 112.20876388362225, 120.41526506799346, 112.55517597969342, 117.96930074155975, 73.7728809487073, 103.55777506172218, 89.18927504292068, 102.6254997676, 110.11170608724949, 89.32596554213585, 115.26816930546832, 107.54092215419084, 110.48105706264921, 94.11458829996097, 106.44632098867388, 107.39245176521239, 111.19462511367394, 126.48401956373809, 84.76169440459883, 107.43351341989376, 96.8050612211555, 108.34192383996707, 94.90819730269969, 87.40139325247087, 114.286487780084, 118.69018111196779, 109.46732422862394, 90.90441201108294, 108.72466307934202, 105.42380199916876, 94.4869971450578, 124.10838070831753, 87.37445725738328, 109.04254408151938, 98.77974782810556, 103.45442426374093, 106.31610348509322, 85.01917896987177, 115.69213909334692, 108.61587728676811, 103.98996220413109, 104.39723904698548, 106.38293626284418, 119.98465727613238, 111.2770484427231, 111.7286458140672, 95.20238224120253, 111.1918715845939, 92.3802675883441, 101.77754893716708, 105.85537147861707, 90.86723915350593, 117.7098008264294, 105.93298112758136, 105.58581113311098, 100.03522226827317, 98.34284201649339, 112.94257547494031, 109.88850516380893, 119.34570042407371], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5020771425136217, "mean_inference_ms": 7.826761380763547, "mean_action_processing_ms": 0.5352128878933804, "mean_env_wait_ms": 22.776134379157234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038483381271362305, "StateBufferConnector_ms": 0.047882795333862305, "ViewRequirementAgentConnector_ms": 0.9710495471954346}}, "episode_reward_max": 126.48401956373809, "episode_reward_min": 73.7728809487073, "episode_reward_mean": 104.55047084116148, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [102.90053104061796, 78.55419679742695, 87.07879659961472, 108.09591597924975, 93.22642376978808, 98.451484852385, 108.99031756476833, 90.1014210771653, 117.7504984343726, 105.85206883267887, 112.19757068410665, 97.19102506105564, 108.47233454748336, 113.63862339233319, 115.00924592117542, 123.49753425176965, 90.01265307048114, 112.91624299236925, 95.36580448612625, 106.81140396806391, 105.22164475849053, 88.26647953810462, 121.92707740926993, 106.42691038339339, 114.94741448814577, 98.40363985755116, 102.26408822567895, 125.03949009054382, 107.54415102481069, 123.84181455089711, 89.63355278582418, 85.28427210025559, 96.693355490128, 107.76330047300779, 108.18186312164396, 86.35908855888333, 120.31057186135418, 110.65585625047541, 94.56527290742324, 100.09227230517818, 112.20876388362225, 120.41526506799346, 112.55517597969342, 117.96930074155975, 73.7728809487073, 103.55777506172218, 89.18927504292068, 102.6254997676, 110.11170608724949, 89.32596554213585, 115.26816930546832, 107.54092215419084, 110.48105706264921, 94.11458829996097, 106.44632098867388, 107.39245176521239, 111.19462511367394, 126.48401956373809, 84.76169440459883, 107.43351341989376, 96.8050612211555, 108.34192383996707, 94.90819730269969, 87.40139325247087, 114.286487780084, 118.69018111196779, 109.46732422862394, 90.90441201108294, 108.72466307934202, 105.42380199916876, 94.4869971450578, 124.10838070831753, 87.37445725738328, 109.04254408151938, 98.77974782810556, 103.45442426374093, 106.31610348509322, 85.01917896987177, 115.69213909334692, 108.61587728676811, 103.98996220413109, 104.39723904698548, 106.38293626284418, 119.98465727613238, 111.2770484427231, 111.7286458140672, 95.20238224120253, 111.1918715845939, 92.3802675883441, 101.77754893716708, 105.85537147861707, 90.86723915350593, 117.7098008264294, 105.93298112758136, 105.58581113311098, 100.03522226827317, 98.34284201649339, 112.94257547494031, 109.88850516380893, 119.34570042407371], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5020771425136217, "mean_inference_ms": 7.826761380763547, "mean_action_processing_ms": 0.5352128878933804, "mean_env_wait_ms": 22.776134379157234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038483381271362305, "StateBufferConnector_ms": 0.047882795333862305, "ViewRequirementAgentConnector_ms": 0.9710495471954346}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1198490, "num_agent_steps_trained": 1198490, "num_env_steps_sampled": 1198490, "num_env_steps_trained": 1198490, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 267.4463160444085, "num_env_steps_trained_throughput_per_sec": 267.4463160444085, "timesteps_total": 1198490, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1198490, "timers": {"training_iteration_time_ms": 57119.903, "sample_time_ms": 42714.753, "load_time_ms": 1619.396, "load_throughput": 9656.685, "learn_time_ms": 12223.341, "learn_throughput": 1279.356, "synch_weights_time_ms": 456.262}, "counters": {"num_env_steps_sampled": 1198490, "num_env_steps_trained": 1198490, "num_agent_steps_sampled": 1198490, "num_agent_steps_trained": 1198490}, "done": false, "episodes_total": 1361, "training_iteration": 97, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-03-55", "timestamp": 1749305035, "time_this_iter_s": 58.48454403877258, "time_total_s": 5306.206358671188, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5306.206358671188, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 76.36029411764707, "ram_util_percent": 54.51764705882351, "gpu_util_percent0": 0.09132352941176469, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.801510000000002e-05, "total_loss": -0.07356001763816246, "policy_loss": -0.010584839064633178, "vf_loss": 0.026857546948065813, "vf_explained_var": 0.9685391007770191, "kl": 0.01749066781686785, "entropy": 15.222244574806908, "entropy_coeff": 0.004702265}, "model": {}, "num_grad_updates_lifetime": 42575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1214128, "num_env_steps_trained": 1214128, "num_agent_steps_sampled": 1214128, "num_agent_steps_trained": 1214128}, "sampler_results": {"episode_reward_max": 126.48401956373809, "episode_reward_min": 73.7728809487073, "episode_reward_mean": 104.45571391524759, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [115.00924592117542, 123.49753425176965, 90.01265307048114, 112.91624299236925, 95.36580448612625, 106.81140396806391, 105.22164475849053, 88.26647953810462, 121.92707740926993, 106.42691038339339, 114.94741448814577, 98.40363985755116, 102.26408822567895, 125.03949009054382, 107.54415102481069, 123.84181455089711, 89.63355278582418, 85.28427210025559, 96.693355490128, 107.76330047300779, 108.18186312164396, 86.35908855888333, 120.31057186135418, 110.65585625047541, 94.56527290742324, 100.09227230517818, 112.20876388362225, 120.41526506799346, 112.55517597969342, 117.96930074155975, 73.7728809487073, 103.55777506172218, 89.18927504292068, 102.6254997676, 110.11170608724949, 89.32596554213585, 115.26816930546832, 107.54092215419084, 110.48105706264921, 94.11458829996097, 106.44632098867388, 107.39245176521239, 111.19462511367394, 126.48401956373809, 84.76169440459883, 107.43351341989376, 96.8050612211555, 108.34192383996707, 94.90819730269969, 87.40139325247087, 114.286487780084, 118.69018111196779, 109.46732422862394, 90.90441201108294, 108.72466307934202, 105.42380199916876, 94.4869971450578, 124.10838070831753, 87.37445725738328, 109.04254408151938, 98.77974782810556, 103.45442426374093, 106.31610348509322, 85.01917896987177, 115.69213909334692, 108.61587728676811, 103.98996220413109, 104.39723904698548, 106.38293626284418, 119.98465727613238, 111.2770484427231, 111.7286458140672, 95.20238224120253, 111.1918715845939, 92.3802675883441, 101.77754893716708, 105.85537147861707, 90.86723915350593, 117.7098008264294, 105.93298112758136, 105.58581113311098, 100.03522226827317, 98.34284201649339, 112.94257547494031, 109.88850516380893, 119.34570042407371, 87.62122843218312, 96.11245219022604, 92.01837420153389, 102.33484096690762, 100.43854304086955, 88.2833469830706, 114.04550715518144, 113.3102815956993, 102.76038967025823, 90.2121251751814, 109.88427149803103, 91.14292678111804, 111.01092807932056, 113.85030027207388], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5059959076652074, "mean_inference_ms": 7.837164536694703, "mean_action_processing_ms": 0.5358756282227082, "mean_env_wait_ms": 22.79801823054428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04298901557922363, "StateBufferConnector_ms": 0.04789137840270996, "ViewRequirementAgentConnector_ms": 0.9778761863708496}}, "episode_reward_max": 126.48401956373809, "episode_reward_min": 73.7728809487073, "episode_reward_mean": 104.45571391524759, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [115.00924592117542, 123.49753425176965, 90.01265307048114, 112.91624299236925, 95.36580448612625, 106.81140396806391, 105.22164475849053, 88.26647953810462, 121.92707740926993, 106.42691038339339, 114.94741448814577, 98.40363985755116, 102.26408822567895, 125.03949009054382, 107.54415102481069, 123.84181455089711, 89.63355278582418, 85.28427210025559, 96.693355490128, 107.76330047300779, 108.18186312164396, 86.35908855888333, 120.31057186135418, 110.65585625047541, 94.56527290742324, 100.09227230517818, 112.20876388362225, 120.41526506799346, 112.55517597969342, 117.96930074155975, 73.7728809487073, 103.55777506172218, 89.18927504292068, 102.6254997676, 110.11170608724949, 89.32596554213585, 115.26816930546832, 107.54092215419084, 110.48105706264921, 94.11458829996097, 106.44632098867388, 107.39245176521239, 111.19462511367394, 126.48401956373809, 84.76169440459883, 107.43351341989376, 96.8050612211555, 108.34192383996707, 94.90819730269969, 87.40139325247087, 114.286487780084, 118.69018111196779, 109.46732422862394, 90.90441201108294, 108.72466307934202, 105.42380199916876, 94.4869971450578, 124.10838070831753, 87.37445725738328, 109.04254408151938, 98.77974782810556, 103.45442426374093, 106.31610348509322, 85.01917896987177, 115.69213909334692, 108.61587728676811, 103.98996220413109, 104.39723904698548, 106.38293626284418, 119.98465727613238, 111.2770484427231, 111.7286458140672, 95.20238224120253, 111.1918715845939, 92.3802675883441, 101.77754893716708, 105.85537147861707, 90.86723915350593, 117.7098008264294, 105.93298112758136, 105.58581113311098, 100.03522226827317, 98.34284201649339, 112.94257547494031, 109.88850516380893, 119.34570042407371, 87.62122843218312, 96.11245219022604, 92.01837420153389, 102.33484096690762, 100.43854304086955, 88.2833469830706, 114.04550715518144, 113.3102815956993, 102.76038967025823, 90.2121251751814, 109.88427149803103, 91.14292678111804, 111.01092807932056, 113.85030027207388], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5059959076652074, "mean_inference_ms": 7.837164536694703, "mean_action_processing_ms": 0.5358756282227082, "mean_env_wait_ms": 22.79801823054428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04298901557922363, "StateBufferConnector_ms": 0.04789137840270996, "ViewRequirementAgentConnector_ms": 0.9778761863708496}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1214128, "num_agent_steps_trained": 1214128, "num_env_steps_sampled": 1214128, "num_env_steps_trained": 1214128, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 271.8066172632368, "num_env_steps_trained_throughput_per_sec": 271.8066172632368, "timesteps_total": 1214128, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1214128, "timers": {"training_iteration_time_ms": 56997.022, "sample_time_ms": 42564.916, "load_time_ms": 1632.174, "load_throughput": 9581.089, "learn_time_ms": 12234.864, "learn_throughput": 1278.151, "synch_weights_time_ms": 461.216}, "counters": {"num_env_steps_sampled": 1214128, "num_env_steps_trained": 1214128, "num_agent_steps_sampled": 1214128, "num_agent_steps_trained": 1214128}, "done": false, "episodes_total": 1375, "training_iteration": 98, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-04-52", "timestamp": 1749305092, "time_this_iter_s": 57.548748254776, "time_total_s": 5363.755106925964, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5363.755106925964, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 77.05757575757575, "ram_util_percent": 54.766666666666666, "gpu_util_percent0": 0.08545454545454546, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.785872000000001e-05, "total_loss": -0.06263955933465198, "policy_loss": 0.0021686578541994096, "vf_loss": 0.02168760851808739, "vf_explained_var": 0.9766955061392351, "kl": 0.016960351515394458, "entropy": 15.35530201478438, "entropy_coeff": 0.004678808}, "model": {}, "num_grad_updates_lifetime": 43125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1229766, "num_env_steps_trained": 1229766, "num_agent_steps_sampled": 1229766, "num_agent_steps_trained": 1229766}, "sampler_results": {"episode_reward_max": 126.48401956373809, "episode_reward_min": 73.7728809487073, "episode_reward_mean": 103.70522478083514, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [107.54415102481069, 123.84181455089711, 89.63355278582418, 85.28427210025559, 96.693355490128, 107.76330047300779, 108.18186312164396, 86.35908855888333, 120.31057186135418, 110.65585625047541, 94.56527290742324, 100.09227230517818, 112.20876388362225, 120.41526506799346, 112.55517597969342, 117.96930074155975, 73.7728809487073, 103.55777506172218, 89.18927504292068, 102.6254997676, 110.11170608724949, 89.32596554213585, 115.26816930546832, 107.54092215419084, 110.48105706264921, 94.11458829996097, 106.44632098867388, 107.39245176521239, 111.19462511367394, 126.48401956373809, 84.76169440459883, 107.43351341989376, 96.8050612211555, 108.34192383996707, 94.90819730269969, 87.40139325247087, 114.286487780084, 118.69018111196779, 109.46732422862394, 90.90441201108294, 108.72466307934202, 105.42380199916876, 94.4869971450578, 124.10838070831753, 87.37445725738328, 109.04254408151938, 98.77974782810556, 103.45442426374093, 106.31610348509322, 85.01917896987177, 115.69213909334692, 108.61587728676811, 103.98996220413109, 104.39723904698548, 106.38293626284418, 119.98465727613238, 111.2770484427231, 111.7286458140672, 95.20238224120253, 111.1918715845939, 92.3802675883441, 101.77754893716708, 105.85537147861707, 90.86723915350593, 117.7098008264294, 105.93298112758136, 105.58581113311098, 100.03522226827317, 98.34284201649339, 112.94257547494031, 109.88850516380893, 119.34570042407371, 87.62122843218312, 96.11245219022604, 92.01837420153389, 102.33484096690762, 100.43854304086955, 88.2833469830706, 114.04550715518144, 113.3102815956993, 102.76038967025823, 90.2121251751814, 109.88427149803103, 91.14292678111804, 111.01092807932056, 113.85030027207388, 90.54238968853112, 102.16038532814535, 90.6316790643483, 96.94652386081584, 104.52469565946268, 85.55760681566049, 115.87665965303833, 104.63180581529198, 96.40458926000932, 93.4036305767182, 108.22490244481888, 115.9856063057156, 109.4844181591551, 116.68582336821002], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.510126947714523, "mean_inference_ms": 7.848405100588484, "mean_action_processing_ms": 0.536588278753628, "mean_env_wait_ms": 22.821961531166508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04497861862182617, "StateBufferConnector_ms": 0.0467836856842041, "ViewRequirementAgentConnector_ms": 0.9810025691986084}}, "episode_reward_max": 126.48401956373809, "episode_reward_min": 73.7728809487073, "episode_reward_mean": 103.70522478083514, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [107.54415102481069, 123.84181455089711, 89.63355278582418, 85.28427210025559, 96.693355490128, 107.76330047300779, 108.18186312164396, 86.35908855888333, 120.31057186135418, 110.65585625047541, 94.56527290742324, 100.09227230517818, 112.20876388362225, 120.41526506799346, 112.55517597969342, 117.96930074155975, 73.7728809487073, 103.55777506172218, 89.18927504292068, 102.6254997676, 110.11170608724949, 89.32596554213585, 115.26816930546832, 107.54092215419084, 110.48105706264921, 94.11458829996097, 106.44632098867388, 107.39245176521239, 111.19462511367394, 126.48401956373809, 84.76169440459883, 107.43351341989376, 96.8050612211555, 108.34192383996707, 94.90819730269969, 87.40139325247087, 114.286487780084, 118.69018111196779, 109.46732422862394, 90.90441201108294, 108.72466307934202, 105.42380199916876, 94.4869971450578, 124.10838070831753, 87.37445725738328, 109.04254408151938, 98.77974782810556, 103.45442426374093, 106.31610348509322, 85.01917896987177, 115.69213909334692, 108.61587728676811, 103.98996220413109, 104.39723904698548, 106.38293626284418, 119.98465727613238, 111.2770484427231, 111.7286458140672, 95.20238224120253, 111.1918715845939, 92.3802675883441, 101.77754893716708, 105.85537147861707, 90.86723915350593, 117.7098008264294, 105.93298112758136, 105.58581113311098, 100.03522226827317, 98.34284201649339, 112.94257547494031, 109.88850516380893, 119.34570042407371, 87.62122843218312, 96.11245219022604, 92.01837420153389, 102.33484096690762, 100.43854304086955, 88.2833469830706, 114.04550715518144, 113.3102815956993, 102.76038967025823, 90.2121251751814, 109.88427149803103, 91.14292678111804, 111.01092807932056, 113.85030027207388, 90.54238968853112, 102.16038532814535, 90.6316790643483, 96.94652386081584, 104.52469565946268, 85.55760681566049, 115.87665965303833, 104.63180581529198, 96.40458926000932, 93.4036305767182, 108.22490244481888, 115.9856063057156, 109.4844181591551, 116.68582336821002], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.510126947714523, "mean_inference_ms": 7.848405100588484, "mean_action_processing_ms": 0.536588278753628, "mean_env_wait_ms": 22.821961531166508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04497861862182617, "StateBufferConnector_ms": 0.0467836856842041, "ViewRequirementAgentConnector_ms": 0.9810025691986084}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1229766, "num_agent_steps_trained": 1229766, "num_env_steps_sampled": 1229766, "num_env_steps_trained": 1229766, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 263.3011409972526, "num_env_steps_trained_throughput_per_sec": 263.3011409972526, "timesteps_total": 1229766, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1229766, "timers": {"training_iteration_time_ms": 57342.529, "sample_time_ms": 42877.446, "load_time_ms": 1644.681, "load_throughput": 9508.228, "learn_time_ms": 12253.656, "learn_throughput": 1276.191, "synch_weights_time_ms": 465.831}, "counters": {"num_env_steps_sampled": 1229766, "num_env_steps_trained": 1229766, "num_agent_steps_sampled": 1229766, "num_agent_steps_trained": 1229766}, "done": false, "episodes_total": 1389, "training_iteration": 99, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-05-52", "timestamp": 1749305152, "time_this_iter_s": 59.40405774116516, "time_total_s": 5423.1591646671295, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5423.1591646671295, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 78.11470588235295, "ram_util_percent": 54.58529411764706, "gpu_util_percent0": 0.07852941176470589, "vram_util_percent0": 0.8409830729166666}}
{"evaluation": {"sampler_results": {"episode_reward_max": -26.028439337875987, "episode_reward_min": -29.02255694112251, "episode_reward_mean": -27.717243646015948, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.02255694112251, -28.50696703253629, -28.6847801987515, -26.343474719793452, -26.028439337875987], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7334200379485971, "mean_inference_ms": 3.856247785933289, "mean_action_processing_ms": 0.3019687779868845, "mean_env_wait_ms": 12.552733059072478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020151138305664062, "ViewRequirementAgentConnector_ms": 0.263519287109375}}, "episode_reward_max": -26.028439337875987, "episode_reward_min": -29.02255694112251, "episode_reward_mean": -27.717243646015948, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.02255694112251, -28.50696703253629, -28.6847801987515, -26.343474719793452, -26.028439337875987], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7334200379485971, "mean_inference_ms": 3.856247785933289, "mean_action_processing_ms": 0.3019687779868845, "mean_env_wait_ms": 12.552733059072478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.020151138305664062, "ViewRequirementAgentConnector_ms": 0.263519287109375}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.770234e-05, "total_loss": -0.06493314764536494, "policy_loss": 0.000555906406437068, "vf_loss": 0.01742343647384339, "vf_explained_var": 0.9789207178896123, "kl": 0.01608590667180992, "entropy": 15.298260035081343, "entropy_coeff": 0.004655351000000001}, "model": {}, "num_grad_updates_lifetime": 43675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1245404, "num_env_steps_trained": 1245404, "num_agent_steps_sampled": 1245404, "num_agent_steps_trained": 1245404}, "sampler_results": {"episode_reward_max": 126.48401956373809, "episode_reward_min": 73.7728809487073, "episode_reward_mean": 103.62371358011187, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.55517597969342, 117.96930074155975, 73.7728809487073, 103.55777506172218, 89.18927504292068, 102.6254997676, 110.11170608724949, 89.32596554213585, 115.26816930546832, 107.54092215419084, 110.48105706264921, 94.11458829996097, 106.44632098867388, 107.39245176521239, 111.19462511367394, 126.48401956373809, 84.76169440459883, 107.43351341989376, 96.8050612211555, 108.34192383996707, 94.90819730269969, 87.40139325247087, 114.286487780084, 118.69018111196779, 109.46732422862394, 90.90441201108294, 108.72466307934202, 105.42380199916876, 94.4869971450578, 124.10838070831753, 87.37445725738328, 109.04254408151938, 98.77974782810556, 103.45442426374093, 106.31610348509322, 85.01917896987177, 115.69213909334692, 108.61587728676811, 103.98996220413109, 104.39723904698548, 106.38293626284418, 119.98465727613238, 111.2770484427231, 111.7286458140672, 95.20238224120253, 111.1918715845939, 92.3802675883441, 101.77754893716708, 105.85537147861707, 90.86723915350593, 117.7098008264294, 105.93298112758136, 105.58581113311098, 100.03522226827317, 98.34284201649339, 112.94257547494031, 109.88850516380893, 119.34570042407371, 87.62122843218312, 96.11245219022604, 92.01837420153389, 102.33484096690762, 100.43854304086955, 88.2833469830706, 114.04550715518144, 113.3102815956993, 102.76038967025823, 90.2121251751814, 109.88427149803103, 91.14292678111804, 111.01092807932056, 113.85030027207388, 90.54238968853112, 102.16038532814535, 90.6316790643483, 96.94652386081584, 104.52469565946268, 85.55760681566049, 115.87665965303833, 104.63180581529198, 96.40458926000932, 93.4036305767182, 108.22490244481888, 115.9856063057156, 109.4844181591551, 116.68582336821002, 95.7318927221579, 110.10416740953593, 93.50824957213192, 101.45251150731858, 99.5814207121535, 88.85705308143977, 102.28265035368244, 109.07427779070903, 105.85782286471702, 92.19413897482157, 110.2436261837729, 119.3313523937272, 114.03145360587574, 113.14766313712867], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.514463371168377, "mean_inference_ms": 7.860999965889183, "mean_action_processing_ms": 0.537392148870877, "mean_env_wait_ms": 22.848294434121293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03896188735961914, "StateBufferConnector_ms": 0.04274916648864746, "ViewRequirementAgentConnector_ms": 0.9992005825042725}}, "episode_reward_max": 126.48401956373809, "episode_reward_min": 73.7728809487073, "episode_reward_mean": 103.62371358011187, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [112.55517597969342, 117.96930074155975, 73.7728809487073, 103.55777506172218, 89.18927504292068, 102.6254997676, 110.11170608724949, 89.32596554213585, 115.26816930546832, 107.54092215419084, 110.48105706264921, 94.11458829996097, 106.44632098867388, 107.39245176521239, 111.19462511367394, 126.48401956373809, 84.76169440459883, 107.43351341989376, 96.8050612211555, 108.34192383996707, 94.90819730269969, 87.40139325247087, 114.286487780084, 118.69018111196779, 109.46732422862394, 90.90441201108294, 108.72466307934202, 105.42380199916876, 94.4869971450578, 124.10838070831753, 87.37445725738328, 109.04254408151938, 98.77974782810556, 103.45442426374093, 106.31610348509322, 85.01917896987177, 115.69213909334692, 108.61587728676811, 103.98996220413109, 104.39723904698548, 106.38293626284418, 119.98465727613238, 111.2770484427231, 111.7286458140672, 95.20238224120253, 111.1918715845939, 92.3802675883441, 101.77754893716708, 105.85537147861707, 90.86723915350593, 117.7098008264294, 105.93298112758136, 105.58581113311098, 100.03522226827317, 98.34284201649339, 112.94257547494031, 109.88850516380893, 119.34570042407371, 87.62122843218312, 96.11245219022604, 92.01837420153389, 102.33484096690762, 100.43854304086955, 88.2833469830706, 114.04550715518144, 113.3102815956993, 102.76038967025823, 90.2121251751814, 109.88427149803103, 91.14292678111804, 111.01092807932056, 113.85030027207388, 90.54238968853112, 102.16038532814535, 90.6316790643483, 96.94652386081584, 104.52469565946268, 85.55760681566049, 115.87665965303833, 104.63180581529198, 96.40458926000932, 93.4036305767182, 108.22490244481888, 115.9856063057156, 109.4844181591551, 116.68582336821002, 95.7318927221579, 110.10416740953593, 93.50824957213192, 101.45251150731858, 99.5814207121535, 88.85705308143977, 102.28265035368244, 109.07427779070903, 105.85782286471702, 92.19413897482157, 110.2436261837729, 119.3313523937272, 114.03145360587574, 113.14766313712867], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.514463371168377, "mean_inference_ms": 7.860999965889183, "mean_action_processing_ms": 0.537392148870877, "mean_env_wait_ms": 22.848294434121293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03896188735961914, "StateBufferConnector_ms": 0.04274916648864746, "ViewRequirementAgentConnector_ms": 0.9992005825042725}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1245404, "num_agent_steps_trained": 1245404, "num_env_steps_sampled": 1245404, "num_env_steps_trained": 1245404, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 263.5520783389915, "num_env_steps_trained_throughput_per_sec": 263.5520783389915, "timesteps_total": 1245404, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1245404, "timers": {"training_iteration_time_ms": 57635.786, "sample_time_ms": 43190.87, "load_time_ms": 1646.797, "load_throughput": 9496.009, "learn_time_ms": 12235.298, "learn_throughput": 1278.105, "synch_weights_time_ms": 459.239}, "counters": {"num_env_steps_sampled": 1245404, "num_env_steps_trained": 1245404, "num_agent_steps_sampled": 1245404, "num_agent_steps_trained": 1245404}, "done": false, "episodes_total": 1403, "training_iteration": 100, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-07-09", "timestamp": 1749305229, "time_this_iter_s": 76.47430610656738, "time_total_s": 5499.633470773697, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5499.633470773697, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 64.28888888888888, "ram_util_percent": 54.59, "gpu_util_percent0": 0.064, "vram_util_percent0": 0.8409830729166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.754596e-05, "total_loss": -0.09545990598515015, "policy_loss": -0.030972556699575347, "vf_loss": 0.01965916118330576, "vf_explained_var": 0.9762522330067375, "kl": 0.015581716992497977, "entropy": 15.300873744271017, "entropy_coeff": 0.004631894}, "model": {}, "num_grad_updates_lifetime": 44225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1261042, "num_env_steps_trained": 1261042, "num_agent_steps_sampled": 1261042, "num_agent_steps_trained": 1261042}, "sampler_results": {"episode_reward_max": 126.48401956373809, "episode_reward_min": 84.76169440459883, "episode_reward_mean": 103.9614709768913, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.19462511367394, 126.48401956373809, 84.76169440459883, 107.43351341989376, 96.8050612211555, 108.34192383996707, 94.90819730269969, 87.40139325247087, 114.286487780084, 118.69018111196779, 109.46732422862394, 90.90441201108294, 108.72466307934202, 105.42380199916876, 94.4869971450578, 124.10838070831753, 87.37445725738328, 109.04254408151938, 98.77974782810556, 103.45442426374093, 106.31610348509322, 85.01917896987177, 115.69213909334692, 108.61587728676811, 103.98996220413109, 104.39723904698548, 106.38293626284418, 119.98465727613238, 111.2770484427231, 111.7286458140672, 95.20238224120253, 111.1918715845939, 92.3802675883441, 101.77754893716708, 105.85537147861707, 90.86723915350593, 117.7098008264294, 105.93298112758136, 105.58581113311098, 100.03522226827317, 98.34284201649339, 112.94257547494031, 109.88850516380893, 119.34570042407371, 87.62122843218312, 96.11245219022604, 92.01837420153389, 102.33484096690762, 100.43854304086955, 88.2833469830706, 114.04550715518144, 113.3102815956993, 102.76038967025823, 90.2121251751814, 109.88427149803103, 91.14292678111804, 111.01092807932056, 113.85030027207388, 90.54238968853112, 102.16038532814535, 90.6316790643483, 96.94652386081584, 104.52469565946268, 85.55760681566049, 115.87665965303833, 104.63180581529198, 96.40458926000932, 93.4036305767182, 108.22490244481888, 115.9856063057156, 109.4844181591551, 116.68582336821002, 95.7318927221579, 110.10416740953593, 93.50824957213192, 101.45251150731858, 99.5814207121535, 88.85705308143977, 102.28265035368244, 109.07427779070903, 105.85782286471702, 92.19413897482157, 110.2436261837729, 119.3313523937272, 114.03145360587574, 113.14766313712867, 91.57844524607161, 110.86140074122646, 89.19776841525, 101.28431362466718, 110.42990516322836, 92.51907173316678, 96.78371641590748, 109.15831583785237, 105.61319363355572, 96.051739469961, 112.17278304370079, 119.06483613803286, 116.68754932248319, 122.72378964058056], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.518951212138535, "mean_inference_ms": 7.873360578745023, "mean_action_processing_ms": 0.5381978020759247, "mean_env_wait_ms": 22.875152379452505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034996986389160156, "StateBufferConnector_ms": 0.03979086875915527, "ViewRequirementAgentConnector_ms": 1.0052404403686523}}, "episode_reward_max": 126.48401956373809, "episode_reward_min": 84.76169440459883, "episode_reward_mean": 103.9614709768913, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [111.19462511367394, 126.48401956373809, 84.76169440459883, 107.43351341989376, 96.8050612211555, 108.34192383996707, 94.90819730269969, 87.40139325247087, 114.286487780084, 118.69018111196779, 109.46732422862394, 90.90441201108294, 108.72466307934202, 105.42380199916876, 94.4869971450578, 124.10838070831753, 87.37445725738328, 109.04254408151938, 98.77974782810556, 103.45442426374093, 106.31610348509322, 85.01917896987177, 115.69213909334692, 108.61587728676811, 103.98996220413109, 104.39723904698548, 106.38293626284418, 119.98465727613238, 111.2770484427231, 111.7286458140672, 95.20238224120253, 111.1918715845939, 92.3802675883441, 101.77754893716708, 105.85537147861707, 90.86723915350593, 117.7098008264294, 105.93298112758136, 105.58581113311098, 100.03522226827317, 98.34284201649339, 112.94257547494031, 109.88850516380893, 119.34570042407371, 87.62122843218312, 96.11245219022604, 92.01837420153389, 102.33484096690762, 100.43854304086955, 88.2833469830706, 114.04550715518144, 113.3102815956993, 102.76038967025823, 90.2121251751814, 109.88427149803103, 91.14292678111804, 111.01092807932056, 113.85030027207388, 90.54238968853112, 102.16038532814535, 90.6316790643483, 96.94652386081584, 104.52469565946268, 85.55760681566049, 115.87665965303833, 104.63180581529198, 96.40458926000932, 93.4036305767182, 108.22490244481888, 115.9856063057156, 109.4844181591551, 116.68582336821002, 95.7318927221579, 110.10416740953593, 93.50824957213192, 101.45251150731858, 99.5814207121535, 88.85705308143977, 102.28265035368244, 109.07427779070903, 105.85782286471702, 92.19413897482157, 110.2436261837729, 119.3313523937272, 114.03145360587574, 113.14766313712867, 91.57844524607161, 110.86140074122646, 89.19776841525, 101.28431362466718, 110.42990516322836, 92.51907173316678, 96.78371641590748, 109.15831583785237, 105.61319363355572, 96.051739469961, 112.17278304370079, 119.06483613803286, 116.68754932248319, 122.72378964058056], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.518951212138535, "mean_inference_ms": 7.873360578745023, "mean_action_processing_ms": 0.5381978020759247, "mean_env_wait_ms": 22.875152379452505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034996986389160156, "StateBufferConnector_ms": 0.03979086875915527, "ViewRequirementAgentConnector_ms": 1.0052404403686523}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1261042, "num_agent_steps_trained": 1261042, "num_env_steps_sampled": 1261042, "num_env_steps_trained": 1261042, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 272.9582968510994, "num_env_steps_trained_throughput_per_sec": 272.9582968510994, "timesteps_total": 1261042, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1261042, "timers": {"training_iteration_time_ms": 57700.257, "sample_time_ms": 43247.185, "load_time_ms": 1662.95, "load_throughput": 9403.771, "learn_time_ms": 12221.076, "learn_throughput": 1279.593, "synch_weights_time_ms": 464.869}, "counters": {"num_env_steps_sampled": 1261042, "num_env_steps_trained": 1261042, "num_agent_steps_sampled": 1261042, "num_agent_steps_trained": 1261042}, "done": false, "episodes_total": 1417, "training_iteration": 101, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-08-06", "timestamp": 1749305286, "time_this_iter_s": 57.30381536483765, "time_total_s": 5556.937286138535, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5556.937286138535, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 76.37727272727273, "ram_util_percent": 55.37727272727273, "gpu_util_percent0": 0.08242424242424243, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.738957999999999e-05, "total_loss": -0.06305429949509826, "policy_loss": 0.0016040821339596402, "vf_loss": 0.018857936481945215, "vf_explained_var": 0.9777027709917588, "kl": 0.017377759011687154, "entropy": 15.375888912894508, "entropy_coeff": 0.004608437}, "model": {}, "num_grad_updates_lifetime": 44775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1276680, "num_env_steps_trained": 1276680, "num_agent_steps_sampled": 1276680, "num_agent_steps_trained": 1276680}, "sampler_results": {"episode_reward_max": 124.10838070831753, "episode_reward_min": 85.01917896987177, "episode_reward_mean": 103.56979842355904, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.4869971450578, 124.10838070831753, 87.37445725738328, 109.04254408151938, 98.77974782810556, 103.45442426374093, 106.31610348509322, 85.01917896987177, 115.69213909334692, 108.61587728676811, 103.98996220413109, 104.39723904698548, 106.38293626284418, 119.98465727613238, 111.2770484427231, 111.7286458140672, 95.20238224120253, 111.1918715845939, 92.3802675883441, 101.77754893716708, 105.85537147861707, 90.86723915350593, 117.7098008264294, 105.93298112758136, 105.58581113311098, 100.03522226827317, 98.34284201649339, 112.94257547494031, 109.88850516380893, 119.34570042407371, 87.62122843218312, 96.11245219022604, 92.01837420153389, 102.33484096690762, 100.43854304086955, 88.2833469830706, 114.04550715518144, 113.3102815956993, 102.76038967025823, 90.2121251751814, 109.88427149803103, 91.14292678111804, 111.01092807932056, 113.85030027207388, 90.54238968853112, 102.16038532814535, 90.6316790643483, 96.94652386081584, 104.52469565946268, 85.55760681566049, 115.87665965303833, 104.63180581529198, 96.40458926000932, 93.4036305767182, 108.22490244481888, 115.9856063057156, 109.4844181591551, 116.68582336821002, 95.7318927221579, 110.10416740953593, 93.50824957213192, 101.45251150731858, 99.5814207121535, 88.85705308143977, 102.28265035368244, 109.07427779070903, 105.85782286471702, 92.19413897482157, 110.2436261837729, 119.3313523937272, 114.03145360587574, 113.14766313712867, 91.57844524607161, 110.86140074122646, 89.19776841525, 101.28431362466718, 110.42990516322836, 92.51907173316678, 96.78371641590748, 109.15831583785237, 105.61319363355572, 96.051739469961, 112.17278304370079, 119.06483613803286, 116.68754932248319, 122.72378964058056, 88.75898198524295, 106.18882192605608, 91.10074710150809, 96.56830202543102, 93.57562642367537, 85.32853908919242, 115.77966628257413, 108.58270761180506, 102.43829616390676, 96.83047750660961, 104.76436052708108, 117.51229800965078, 101.8984463973936, 116.33277194511484], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5238377156887504, "mean_inference_ms": 7.88609749869397, "mean_action_processing_ms": 0.5390525103347982, "mean_env_wait_ms": 22.902372012057423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027111053466796875, "StateBufferConnector_ms": 0.03880167007446289, "ViewRequirementAgentConnector_ms": 1.0067131519317627}}, "episode_reward_max": 124.10838070831753, "episode_reward_min": 85.01917896987177, "episode_reward_mean": 103.56979842355904, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [94.4869971450578, 124.10838070831753, 87.37445725738328, 109.04254408151938, 98.77974782810556, 103.45442426374093, 106.31610348509322, 85.01917896987177, 115.69213909334692, 108.61587728676811, 103.98996220413109, 104.39723904698548, 106.38293626284418, 119.98465727613238, 111.2770484427231, 111.7286458140672, 95.20238224120253, 111.1918715845939, 92.3802675883441, 101.77754893716708, 105.85537147861707, 90.86723915350593, 117.7098008264294, 105.93298112758136, 105.58581113311098, 100.03522226827317, 98.34284201649339, 112.94257547494031, 109.88850516380893, 119.34570042407371, 87.62122843218312, 96.11245219022604, 92.01837420153389, 102.33484096690762, 100.43854304086955, 88.2833469830706, 114.04550715518144, 113.3102815956993, 102.76038967025823, 90.2121251751814, 109.88427149803103, 91.14292678111804, 111.01092807932056, 113.85030027207388, 90.54238968853112, 102.16038532814535, 90.6316790643483, 96.94652386081584, 104.52469565946268, 85.55760681566049, 115.87665965303833, 104.63180581529198, 96.40458926000932, 93.4036305767182, 108.22490244481888, 115.9856063057156, 109.4844181591551, 116.68582336821002, 95.7318927221579, 110.10416740953593, 93.50824957213192, 101.45251150731858, 99.5814207121535, 88.85705308143977, 102.28265035368244, 109.07427779070903, 105.85782286471702, 92.19413897482157, 110.2436261837729, 119.3313523937272, 114.03145360587574, 113.14766313712867, 91.57844524607161, 110.86140074122646, 89.19776841525, 101.28431362466718, 110.42990516322836, 92.51907173316678, 96.78371641590748, 109.15831583785237, 105.61319363355572, 96.051739469961, 112.17278304370079, 119.06483613803286, 116.68754932248319, 122.72378964058056, 88.75898198524295, 106.18882192605608, 91.10074710150809, 96.56830202543102, 93.57562642367537, 85.32853908919242, 115.77966628257413, 108.58270761180506, 102.43829616390676, 96.83047750660961, 104.76436052708108, 117.51229800965078, 101.8984463973936, 116.33277194511484], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5238377156887504, "mean_inference_ms": 7.88609749869397, "mean_action_processing_ms": 0.5390525103347982, "mean_env_wait_ms": 22.902372012057423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027111053466796875, "StateBufferConnector_ms": 0.03880167007446289, "ViewRequirementAgentConnector_ms": 1.0067131519317627}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1276680, "num_agent_steps_trained": 1276680, "num_env_steps_sampled": 1276680, "num_env_steps_trained": 1276680, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 268.9043806689598, "num_env_steps_trained_throughput_per_sec": 268.9043806689598, "timesteps_total": 1276680, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1276680, "timers": {"training_iteration_time_ms": 57880.925, "sample_time_ms": 43388.555, "load_time_ms": 1673.409, "load_throughput": 9344.995, "learn_time_ms": 12251.958, "learn_throughput": 1276.367, "synch_weights_time_ms": 462.878}, "counters": {"num_env_steps_sampled": 1276680, "num_env_steps_trained": 1276680, "num_agent_steps_sampled": 1276680, "num_agent_steps_trained": 1276680}, "done": false, "episodes_total": 1431, "training_iteration": 102, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-09-04", "timestamp": 1749305344, "time_this_iter_s": 58.166499614715576, "time_total_s": 5615.10378575325, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5615.10378575325, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 76.96567164179103, "ram_util_percent": 55.09701492537313, "gpu_util_percent0": 0.0882089552238806, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.72332e-05, "total_loss": -0.07911834384314716, "policy_loss": -0.014171260550872169, "vf_loss": 0.01706978609552607, "vf_explained_var": 0.9793485696749253, "kl": 0.016689340035456145, "entropy": 15.395826495777477, "entropy_coeff": 0.004584980000000001}, "model": {}, "num_grad_updates_lifetime": 45325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1292318, "num_env_steps_trained": 1292318, "num_agent_steps_sampled": 1292318, "num_agent_steps_trained": 1292318}, "sampler_results": {"episode_reward_max": 122.72378964058056, "episode_reward_min": 85.32853908919242, "episode_reward_mean": 103.34257898073264, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.2770484427231, 111.7286458140672, 95.20238224120253, 111.1918715845939, 92.3802675883441, 101.77754893716708, 105.85537147861707, 90.86723915350593, 117.7098008264294, 105.93298112758136, 105.58581113311098, 100.03522226827317, 98.34284201649339, 112.94257547494031, 109.88850516380893, 119.34570042407371, 87.62122843218312, 96.11245219022604, 92.01837420153389, 102.33484096690762, 100.43854304086955, 88.2833469830706, 114.04550715518144, 113.3102815956993, 102.76038967025823, 90.2121251751814, 109.88427149803103, 91.14292678111804, 111.01092807932056, 113.85030027207388, 90.54238968853112, 102.16038532814535, 90.6316790643483, 96.94652386081584, 104.52469565946268, 85.55760681566049, 115.87665965303833, 104.63180581529198, 96.40458926000932, 93.4036305767182, 108.22490244481888, 115.9856063057156, 109.4844181591551, 116.68582336821002, 95.7318927221579, 110.10416740953593, 93.50824957213192, 101.45251150731858, 99.5814207121535, 88.85705308143977, 102.28265035368244, 109.07427779070903, 105.85782286471702, 92.19413897482157, 110.2436261837729, 119.3313523937272, 114.03145360587574, 113.14766313712867, 91.57844524607161, 110.86140074122646, 89.19776841525, 101.28431362466718, 110.42990516322836, 92.51907173316678, 96.78371641590748, 109.15831583785237, 105.61319363355572, 96.051739469961, 112.17278304370079, 119.06483613803286, 116.68754932248319, 122.72378964058056, 88.75898198524295, 106.18882192605608, 91.10074710150809, 96.56830202543102, 93.57562642367537, 85.32853908919242, 115.77966628257413, 108.58270761180506, 102.43829616390676, 96.83047750660961, 104.76436052708108, 117.51229800965078, 101.8984463973936, 116.33277194511484, 90.0939655904237, 109.17112403567303, 96.14809487755014, 100.19626843108027, 97.7686522179567, 90.67209250684877, 108.63072657778756, 107.34801843434063, 109.33063370025712, 98.1706683711425, 102.13268807466714, 112.9612973424995, 104.86060148424443, 117.43786898218524], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5288910686838197, "mean_inference_ms": 7.899139715848996, "mean_action_processing_ms": 0.5399212708690552, "mean_env_wait_ms": 22.92958192695228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03205466270446777, "StateBufferConnector_ms": 0.03980898857116699, "ViewRequirementAgentConnector_ms": 1.009106159210205}}, "episode_reward_max": 122.72378964058056, "episode_reward_min": 85.32853908919242, "episode_reward_mean": 103.34257898073264, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [111.2770484427231, 111.7286458140672, 95.20238224120253, 111.1918715845939, 92.3802675883441, 101.77754893716708, 105.85537147861707, 90.86723915350593, 117.7098008264294, 105.93298112758136, 105.58581113311098, 100.03522226827317, 98.34284201649339, 112.94257547494031, 109.88850516380893, 119.34570042407371, 87.62122843218312, 96.11245219022604, 92.01837420153389, 102.33484096690762, 100.43854304086955, 88.2833469830706, 114.04550715518144, 113.3102815956993, 102.76038967025823, 90.2121251751814, 109.88427149803103, 91.14292678111804, 111.01092807932056, 113.85030027207388, 90.54238968853112, 102.16038532814535, 90.6316790643483, 96.94652386081584, 104.52469565946268, 85.55760681566049, 115.87665965303833, 104.63180581529198, 96.40458926000932, 93.4036305767182, 108.22490244481888, 115.9856063057156, 109.4844181591551, 116.68582336821002, 95.7318927221579, 110.10416740953593, 93.50824957213192, 101.45251150731858, 99.5814207121535, 88.85705308143977, 102.28265035368244, 109.07427779070903, 105.85782286471702, 92.19413897482157, 110.2436261837729, 119.3313523937272, 114.03145360587574, 113.14766313712867, 91.57844524607161, 110.86140074122646, 89.19776841525, 101.28431362466718, 110.42990516322836, 92.51907173316678, 96.78371641590748, 109.15831583785237, 105.61319363355572, 96.051739469961, 112.17278304370079, 119.06483613803286, 116.68754932248319, 122.72378964058056, 88.75898198524295, 106.18882192605608, 91.10074710150809, 96.56830202543102, 93.57562642367537, 85.32853908919242, 115.77966628257413, 108.58270761180506, 102.43829616390676, 96.83047750660961, 104.76436052708108, 117.51229800965078, 101.8984463973936, 116.33277194511484, 90.0939655904237, 109.17112403567303, 96.14809487755014, 100.19626843108027, 97.7686522179567, 90.67209250684877, 108.63072657778756, 107.34801843434063, 109.33063370025712, 98.1706683711425, 102.13268807466714, 112.9612973424995, 104.86060148424443, 117.43786898218524], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5288910686838197, "mean_inference_ms": 7.899139715848996, "mean_action_processing_ms": 0.5399212708690552, "mean_env_wait_ms": 22.92958192695228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03205466270446777, "StateBufferConnector_ms": 0.03980898857116699, "ViewRequirementAgentConnector_ms": 1.009106159210205}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1292318, "num_agent_steps_trained": 1292318, "num_env_steps_sampled": 1292318, "num_env_steps_trained": 1292318, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 260.664757090412, "num_env_steps_trained_throughput_per_sec": 260.664757090412, "timesteps_total": 1292318, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1292318, "timers": {"training_iteration_time_ms": 58224.862, "sample_time_ms": 43714.67, "load_time_ms": 1682.929, "load_throughput": 9292.131, "learn_time_ms": 12264.676, "learn_throughput": 1275.044, "synch_weights_time_ms": 458.508}, "counters": {"num_env_steps_sampled": 1292318, "num_env_steps_trained": 1292318, "num_agent_steps_sampled": 1292318, "num_agent_steps_trained": 1292318}, "done": false, "episodes_total": 1445, "training_iteration": 103, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-10-04", "timestamp": 1749305404, "time_this_iter_s": 60.00676727294922, "time_total_s": 5675.110553026199, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5675.110553026199, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 78.06617647058823, "ram_util_percent": 54.96617647058824, "gpu_util_percent0": 0.07911764705882354, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.707682000000003e-05, "total_loss": -0.08063231264198707, "policy_loss": -0.016755272747356106, "vf_loss": 0.01921317126326771, "vf_explained_var": 0.9785133093053644, "kl": 0.017120770097231303, "entropy": 15.384339445287532, "entropy_coeff": 0.004561522999999999}, "model": {}, "num_grad_updates_lifetime": 45875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1307956, "num_env_steps_trained": 1307956, "num_agent_steps_sampled": 1307956, "num_agent_steps_trained": 1307956}, "sampler_results": {"episode_reward_max": 122.72378964058056, "episode_reward_min": 85.32853908919242, "episode_reward_mean": 102.93414241792115, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.88850516380893, 119.34570042407371, 87.62122843218312, 96.11245219022604, 92.01837420153389, 102.33484096690762, 100.43854304086955, 88.2833469830706, 114.04550715518144, 113.3102815956993, 102.76038967025823, 90.2121251751814, 109.88427149803103, 91.14292678111804, 111.01092807932056, 113.85030027207388, 90.54238968853112, 102.16038532814535, 90.6316790643483, 96.94652386081584, 104.52469565946268, 85.55760681566049, 115.87665965303833, 104.63180581529198, 96.40458926000932, 93.4036305767182, 108.22490244481888, 115.9856063057156, 109.4844181591551, 116.68582336821002, 95.7318927221579, 110.10416740953593, 93.50824957213192, 101.45251150731858, 99.5814207121535, 88.85705308143977, 102.28265035368244, 109.07427779070903, 105.85782286471702, 92.19413897482157, 110.2436261837729, 119.3313523937272, 114.03145360587574, 113.14766313712867, 91.57844524607161, 110.86140074122646, 89.19776841525, 101.28431362466718, 110.42990516322836, 92.51907173316678, 96.78371641590748, 109.15831583785237, 105.61319363355572, 96.051739469961, 112.17278304370079, 119.06483613803286, 116.68754932248319, 122.72378964058056, 88.75898198524295, 106.18882192605608, 91.10074710150809, 96.56830202543102, 93.57562642367537, 85.32853908919242, 115.77966628257413, 108.58270761180506, 102.43829616390676, 96.83047750660961, 104.76436052708108, 117.51229800965078, 101.8984463973936, 116.33277194511484, 90.0939655904237, 109.17112403567303, 96.14809487755014, 100.19626843108027, 97.7686522179567, 90.67209250684877, 108.63072657778756, 107.34801843434063, 109.33063370025712, 98.1706683711425, 102.13268807466714, 112.9612973424995, 104.86060148424443, 117.43786898218524, 90.78610254325079, 104.57413825512809, 88.36767376128938, 102.65516869276138, 97.97530191064875, 91.05578737165278, 101.30692285441795, 105.94636718143572, 103.68196494562672, 95.92961079055749, 100.4995639334452, 106.89942873023108, 108.58311029785064, 121.724810537608], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5341833600645667, "mean_inference_ms": 7.912159811980014, "mean_action_processing_ms": 0.5408043025524246, "mean_env_wait_ms": 22.957008646032524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199362754821777, "StateBufferConnector_ms": 0.034613609313964844, "ViewRequirementAgentConnector_ms": 0.9883029460906982}}, "episode_reward_max": 122.72378964058056, "episode_reward_min": 85.32853908919242, "episode_reward_mean": 102.93414241792115, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [109.88850516380893, 119.34570042407371, 87.62122843218312, 96.11245219022604, 92.01837420153389, 102.33484096690762, 100.43854304086955, 88.2833469830706, 114.04550715518144, 113.3102815956993, 102.76038967025823, 90.2121251751814, 109.88427149803103, 91.14292678111804, 111.01092807932056, 113.85030027207388, 90.54238968853112, 102.16038532814535, 90.6316790643483, 96.94652386081584, 104.52469565946268, 85.55760681566049, 115.87665965303833, 104.63180581529198, 96.40458926000932, 93.4036305767182, 108.22490244481888, 115.9856063057156, 109.4844181591551, 116.68582336821002, 95.7318927221579, 110.10416740953593, 93.50824957213192, 101.45251150731858, 99.5814207121535, 88.85705308143977, 102.28265035368244, 109.07427779070903, 105.85782286471702, 92.19413897482157, 110.2436261837729, 119.3313523937272, 114.03145360587574, 113.14766313712867, 91.57844524607161, 110.86140074122646, 89.19776841525, 101.28431362466718, 110.42990516322836, 92.51907173316678, 96.78371641590748, 109.15831583785237, 105.61319363355572, 96.051739469961, 112.17278304370079, 119.06483613803286, 116.68754932248319, 122.72378964058056, 88.75898198524295, 106.18882192605608, 91.10074710150809, 96.56830202543102, 93.57562642367537, 85.32853908919242, 115.77966628257413, 108.58270761180506, 102.43829616390676, 96.83047750660961, 104.76436052708108, 117.51229800965078, 101.8984463973936, 116.33277194511484, 90.0939655904237, 109.17112403567303, 96.14809487755014, 100.19626843108027, 97.7686522179567, 90.67209250684877, 108.63072657778756, 107.34801843434063, 109.33063370025712, 98.1706683711425, 102.13268807466714, 112.9612973424995, 104.86060148424443, 117.43786898218524, 90.78610254325079, 104.57413825512809, 88.36767376128938, 102.65516869276138, 97.97530191064875, 91.05578737165278, 101.30692285441795, 105.94636718143572, 103.68196494562672, 95.92961079055749, 100.4995639334452, 106.89942873023108, 108.58311029785064, 121.724810537608], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5341833600645667, "mean_inference_ms": 7.912159811980014, "mean_action_processing_ms": 0.5408043025524246, "mean_env_wait_ms": 22.957008646032524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199362754821777, "StateBufferConnector_ms": 0.034613609313964844, "ViewRequirementAgentConnector_ms": 0.9883029460906982}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1307956, "num_agent_steps_trained": 1307956, "num_env_steps_sampled": 1307956, "num_env_steps_trained": 1307956, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 263.0693035462284, "num_env_steps_trained_throughput_per_sec": 263.0693035462284, "timesteps_total": 1307956, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1307956, "timers": {"training_iteration_time_ms": 58562.113, "sample_time_ms": 44049.576, "load_time_ms": 1683.202, "load_throughput": 9290.625, "learn_time_ms": 12276.13, "learn_throughput": 1273.854, "synch_weights_time_ms": 450.462}, "counters": {"num_env_steps_sampled": 1307956, "num_env_steps_trained": 1307956, "num_agent_steps_sampled": 1307956, "num_agent_steps_trained": 1307956}, "done": false, "episodes_total": 1459, "training_iteration": 104, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-11-04", "timestamp": 1749305464, "time_this_iter_s": 59.586639642715454, "time_total_s": 5734.697192668915, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5734.697192668915, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 77.70882352941175, "ram_util_percent": 54.6970588235294, "gpu_util_percent0": 0.07720588235294118, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.692043999999999e-05, "total_loss": -0.0899318713072518, "policy_loss": -0.02582098592009226, "vf_loss": 0.017536227100063115, "vf_explained_var": 0.9799247271364385, "kl": 0.01651270444233991, "entropy": 15.400342559814453, "entropy_coeff": 0.004538066}, "model": {}, "num_grad_updates_lifetime": 46425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1323594, "num_env_steps_trained": 1323594, "num_agent_steps_sampled": 1323594, "num_agent_steps_trained": 1323594}, "sampler_results": {"episode_reward_max": 122.72378964058056, "episode_reward_min": 85.32853908919242, "episode_reward_mean": 103.1019532337014, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.01092807932056, 113.85030027207388, 90.54238968853112, 102.16038532814535, 90.6316790643483, 96.94652386081584, 104.52469565946268, 85.55760681566049, 115.87665965303833, 104.63180581529198, 96.40458926000932, 93.4036305767182, 108.22490244481888, 115.9856063057156, 109.4844181591551, 116.68582336821002, 95.7318927221579, 110.10416740953593, 93.50824957213192, 101.45251150731858, 99.5814207121535, 88.85705308143977, 102.28265035368244, 109.07427779070903, 105.85782286471702, 92.19413897482157, 110.2436261837729, 119.3313523937272, 114.03145360587574, 113.14766313712867, 91.57844524607161, 110.86140074122646, 89.19776841525, 101.28431362466718, 110.42990516322836, 92.51907173316678, 96.78371641590748, 109.15831583785237, 105.61319363355572, 96.051739469961, 112.17278304370079, 119.06483613803286, 116.68754932248319, 122.72378964058056, 88.75898198524295, 106.18882192605608, 91.10074710150809, 96.56830202543102, 93.57562642367537, 85.32853908919242, 115.77966628257413, 108.58270761180506, 102.43829616390676, 96.83047750660961, 104.76436052708108, 117.51229800965078, 101.8984463973936, 116.33277194511484, 90.0939655904237, 109.17112403567303, 96.14809487755014, 100.19626843108027, 97.7686522179567, 90.67209250684877, 108.63072657778756, 107.34801843434063, 109.33063370025712, 98.1706683711425, 102.13268807466714, 112.9612973424995, 104.86060148424443, 117.43786898218524, 90.78610254325079, 104.57413825512809, 88.36767376128938, 102.65516869276138, 97.97530191064875, 91.05578737165278, 101.30692285441795, 105.94636718143572, 103.68196494562672, 95.92961079055749, 100.4995639334452, 106.89942873023108, 108.58311029785064, 121.724810537608, 88.70985114510154, 108.85954713196575, 92.70430608545212, 95.54292323783004, 95.71346045192594, 89.33866228012783, 115.80779780014329, 103.76001417187769, 101.2254620764848, 98.43114406092525, 106.9918881949245, 110.70031256317927, 109.91810027692026, 116.47610537930444], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5394075625134054, "mean_inference_ms": 7.925393393695632, "mean_action_processing_ms": 0.5417261161651526, "mean_env_wait_ms": 22.984613782466376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03811979293823242, "StateBufferConnector_ms": 0.032651424407958984, "ViewRequirementAgentConnector_ms": 0.9765031337738037}}, "episode_reward_max": 122.72378964058056, "episode_reward_min": 85.32853908919242, "episode_reward_mean": 103.1019532337014, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [111.01092807932056, 113.85030027207388, 90.54238968853112, 102.16038532814535, 90.6316790643483, 96.94652386081584, 104.52469565946268, 85.55760681566049, 115.87665965303833, 104.63180581529198, 96.40458926000932, 93.4036305767182, 108.22490244481888, 115.9856063057156, 109.4844181591551, 116.68582336821002, 95.7318927221579, 110.10416740953593, 93.50824957213192, 101.45251150731858, 99.5814207121535, 88.85705308143977, 102.28265035368244, 109.07427779070903, 105.85782286471702, 92.19413897482157, 110.2436261837729, 119.3313523937272, 114.03145360587574, 113.14766313712867, 91.57844524607161, 110.86140074122646, 89.19776841525, 101.28431362466718, 110.42990516322836, 92.51907173316678, 96.78371641590748, 109.15831583785237, 105.61319363355572, 96.051739469961, 112.17278304370079, 119.06483613803286, 116.68754932248319, 122.72378964058056, 88.75898198524295, 106.18882192605608, 91.10074710150809, 96.56830202543102, 93.57562642367537, 85.32853908919242, 115.77966628257413, 108.58270761180506, 102.43829616390676, 96.83047750660961, 104.76436052708108, 117.51229800965078, 101.8984463973936, 116.33277194511484, 90.0939655904237, 109.17112403567303, 96.14809487755014, 100.19626843108027, 97.7686522179567, 90.67209250684877, 108.63072657778756, 107.34801843434063, 109.33063370025712, 98.1706683711425, 102.13268807466714, 112.9612973424995, 104.86060148424443, 117.43786898218524, 90.78610254325079, 104.57413825512809, 88.36767376128938, 102.65516869276138, 97.97530191064875, 91.05578737165278, 101.30692285441795, 105.94636718143572, 103.68196494562672, 95.92961079055749, 100.4995639334452, 106.89942873023108, 108.58311029785064, 121.724810537608, 88.70985114510154, 108.85954713196575, 92.70430608545212, 95.54292323783004, 95.71346045192594, 89.33866228012783, 115.80779780014329, 103.76001417187769, 101.2254620764848, 98.43114406092525, 106.9918881949245, 110.70031256317927, 109.91810027692026, 116.47610537930444], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5394075625134054, "mean_inference_ms": 7.925393393695632, "mean_action_processing_ms": 0.5417261161651526, "mean_env_wait_ms": 22.984613782466376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03811979293823242, "StateBufferConnector_ms": 0.032651424407958984, "ViewRequirementAgentConnector_ms": 0.9765031337738037}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1323594, "num_agent_steps_trained": 1323594, "num_env_steps_sampled": 1323594, "num_env_steps_trained": 1323594, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 268.1137124127793, "num_env_steps_trained_throughput_per_sec": 268.1137124127793, "timesteps_total": 1323594, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1323594, "timers": {"training_iteration_time_ms": 58721.013, "sample_time_ms": 44193.973, "load_time_ms": 1693.274, "load_throughput": 9235.361, "learn_time_ms": 12278.27, "learn_throughput": 1273.632, "synch_weights_time_ms": 450.956}, "counters": {"num_env_steps_sampled": 1323594, "num_env_steps_trained": 1323594, "num_agent_steps_sampled": 1323594, "num_agent_steps_trained": 1323594}, "done": false, "episodes_total": 1473, "training_iteration": 105, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-12-02", "timestamp": 1749305522, "time_this_iter_s": 58.34021472930908, "time_total_s": 5793.037407398224, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5793.037407398224, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 76.90746268656717, "ram_util_percent": 55.09850746268657, "gpu_util_percent0": 0.0853731343283582, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.676406e-05, "total_loss": -0.0590736686945787, "policy_loss": 0.003153593849221414, "vf_loss": 0.023717487332495776, "vf_explained_var": 0.9747878112576225, "kl": 0.01643027682577279, "entropy": 15.473312204534357, "entropy_coeff": 0.004514609000000001}, "model": {}, "num_grad_updates_lifetime": 46975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1339232, "num_env_steps_trained": 1339232, "num_agent_steps_sampled": 1339232, "num_agent_steps_trained": 1339232}, "sampler_results": {"episode_reward_max": 122.72378964058056, "episode_reward_min": 69.18646390093461, "episode_reward_mean": 102.62380968359719, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.4844181591551, 116.68582336821002, 95.7318927221579, 110.10416740953593, 93.50824957213192, 101.45251150731858, 99.5814207121535, 88.85705308143977, 102.28265035368244, 109.07427779070903, 105.85782286471702, 92.19413897482157, 110.2436261837729, 119.3313523937272, 114.03145360587574, 113.14766313712867, 91.57844524607161, 110.86140074122646, 89.19776841525, 101.28431362466718, 110.42990516322836, 92.51907173316678, 96.78371641590748, 109.15831583785237, 105.61319363355572, 96.051739469961, 112.17278304370079, 119.06483613803286, 116.68754932248319, 122.72378964058056, 88.75898198524295, 106.18882192605608, 91.10074710150809, 96.56830202543102, 93.57562642367537, 85.32853908919242, 115.77966628257413, 108.58270761180506, 102.43829616390676, 96.83047750660961, 104.76436052708108, 117.51229800965078, 101.8984463973936, 116.33277194511484, 90.0939655904237, 109.17112403567303, 96.14809487755014, 100.19626843108027, 97.7686522179567, 90.67209250684877, 108.63072657778756, 107.34801843434063, 109.33063370025712, 98.1706683711425, 102.13268807466714, 112.9612973424995, 104.86060148424443, 117.43786898218524, 90.78610254325079, 104.57413825512809, 88.36767376128938, 102.65516869276138, 97.97530191064875, 91.05578737165278, 101.30692285441795, 105.94636718143572, 103.68196494562672, 95.92961079055749, 100.4995639334452, 106.89942873023108, 108.58311029785064, 121.724810537608, 88.70985114510154, 108.85954713196575, 92.70430608545212, 95.54292323783004, 95.71346045192594, 89.33866228012783, 115.80779780014329, 103.76001417187769, 101.2254620764848, 98.43114406092525, 106.9918881949245, 110.70031256317927, 109.91810027692026, 116.47610537930444, 89.35605058532799, 105.96698831128569, 89.48709269247996, 98.02836561200893, 102.71613061264344, 87.0863591302736, 111.66186476941093, 69.18646390093461, 102.98695061460893, 95.65339537307953, 98.20654331100883, 105.8888107222942, 103.9634036139471, 121.74892856422824], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.544372308286064, "mean_inference_ms": 7.937382982325983, "mean_action_processing_ms": 0.5425581277309266, "mean_env_wait_ms": 23.009450463351286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041109561920166016, "StateBufferConnector_ms": 0.03162240982055664, "ViewRequirementAgentConnector_ms": 0.9886281490325928}}, "episode_reward_max": 122.72378964058056, "episode_reward_min": 69.18646390093461, "episode_reward_mean": 102.62380968359719, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [109.4844181591551, 116.68582336821002, 95.7318927221579, 110.10416740953593, 93.50824957213192, 101.45251150731858, 99.5814207121535, 88.85705308143977, 102.28265035368244, 109.07427779070903, 105.85782286471702, 92.19413897482157, 110.2436261837729, 119.3313523937272, 114.03145360587574, 113.14766313712867, 91.57844524607161, 110.86140074122646, 89.19776841525, 101.28431362466718, 110.42990516322836, 92.51907173316678, 96.78371641590748, 109.15831583785237, 105.61319363355572, 96.051739469961, 112.17278304370079, 119.06483613803286, 116.68754932248319, 122.72378964058056, 88.75898198524295, 106.18882192605608, 91.10074710150809, 96.56830202543102, 93.57562642367537, 85.32853908919242, 115.77966628257413, 108.58270761180506, 102.43829616390676, 96.83047750660961, 104.76436052708108, 117.51229800965078, 101.8984463973936, 116.33277194511484, 90.0939655904237, 109.17112403567303, 96.14809487755014, 100.19626843108027, 97.7686522179567, 90.67209250684877, 108.63072657778756, 107.34801843434063, 109.33063370025712, 98.1706683711425, 102.13268807466714, 112.9612973424995, 104.86060148424443, 117.43786898218524, 90.78610254325079, 104.57413825512809, 88.36767376128938, 102.65516869276138, 97.97530191064875, 91.05578737165278, 101.30692285441795, 105.94636718143572, 103.68196494562672, 95.92961079055749, 100.4995639334452, 106.89942873023108, 108.58311029785064, 121.724810537608, 88.70985114510154, 108.85954713196575, 92.70430608545212, 95.54292323783004, 95.71346045192594, 89.33866228012783, 115.80779780014329, 103.76001417187769, 101.2254620764848, 98.43114406092525, 106.9918881949245, 110.70031256317927, 109.91810027692026, 116.47610537930444, 89.35605058532799, 105.96698831128569, 89.48709269247996, 98.02836561200893, 102.71613061264344, 87.0863591302736, 111.66186476941093, 69.18646390093461, 102.98695061460893, 95.65339537307953, 98.20654331100883, 105.8888107222942, 103.9634036139471, 121.74892856422824], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.544372308286064, "mean_inference_ms": 7.937382982325983, "mean_action_processing_ms": 0.5425581277309266, "mean_env_wait_ms": 23.009450463351286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041109561920166016, "StateBufferConnector_ms": 0.03162240982055664, "ViewRequirementAgentConnector_ms": 0.9886281490325928}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1339232, "num_agent_steps_trained": 1339232, "num_env_steps_sampled": 1339232, "num_env_steps_trained": 1339232, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 277.1573402251136, "num_env_steps_trained_throughput_per_sec": 277.1573402251136, "timesteps_total": 1339232, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1339232, "timers": {"training_iteration_time_ms": 58436.4, "sample_time_ms": 43957.684, "load_time_ms": 1676.675, "load_throughput": 9326.79, "learn_time_ms": 12249.675, "learn_throughput": 1276.605, "synch_weights_time_ms": 448.921}, "counters": {"num_env_steps_sampled": 1339232, "num_env_steps_trained": 1339232, "num_agent_steps_sampled": 1339232, "num_agent_steps_trained": 1339232}, "done": false, "episodes_total": 1487, "training_iteration": 106, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-12-59", "timestamp": 1749305579, "time_this_iter_s": 56.434823513031006, "time_total_s": 5849.472230911255, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5849.472230911255, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 76.09846153846154, "ram_util_percent": 55.476923076923086, "gpu_util_percent0": 0.08323076923076923, "vram_util_percent0": 0.8409830729166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.660768000000001e-05, "total_loss": -0.06794226747815793, "policy_loss": -0.004256568591888274, "vf_loss": 0.017684744775125927, "vf_explained_var": 0.9783252103762193, "kl": 0.017696167394835087, "entropy": 15.484697067954324, "entropy_coeff": 0.004491151999999999}, "model": {}, "num_grad_updates_lifetime": 47525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1354870, "num_env_steps_trained": 1354870, "num_agent_steps_sampled": 1354870, "num_agent_steps_trained": 1354870}, "sampler_results": {"episode_reward_max": 122.72378964058056, "episode_reward_min": 69.18646390093461, "episode_reward_mean": 102.31437606270747, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.03145360587574, 113.14766313712867, 91.57844524607161, 110.86140074122646, 89.19776841525, 101.28431362466718, 110.42990516322836, 92.51907173316678, 96.78371641590748, 109.15831583785237, 105.61319363355572, 96.051739469961, 112.17278304370079, 119.06483613803286, 116.68754932248319, 122.72378964058056, 88.75898198524295, 106.18882192605608, 91.10074710150809, 96.56830202543102, 93.57562642367537, 85.32853908919242, 115.77966628257413, 108.58270761180506, 102.43829616390676, 96.83047750660961, 104.76436052708108, 117.51229800965078, 101.8984463973936, 116.33277194511484, 90.0939655904237, 109.17112403567303, 96.14809487755014, 100.19626843108027, 97.7686522179567, 90.67209250684877, 108.63072657778756, 107.34801843434063, 109.33063370025712, 98.1706683711425, 102.13268807466714, 112.9612973424995, 104.86060148424443, 117.43786898218524, 90.78610254325079, 104.57413825512809, 88.36767376128938, 102.65516869276138, 97.97530191064875, 91.05578737165278, 101.30692285441795, 105.94636718143572, 103.68196494562672, 95.92961079055749, 100.4995639334452, 106.89942873023108, 108.58311029785064, 121.724810537608, 88.70985114510154, 108.85954713196575, 92.70430608545212, 95.54292323783004, 95.71346045192594, 89.33866228012783, 115.80779780014329, 103.76001417187769, 101.2254620764848, 98.43114406092525, 106.9918881949245, 110.70031256317927, 109.91810027692026, 116.47610537930444, 89.35605058532799, 105.96698831128569, 89.48709269247996, 98.02836561200893, 102.71613061264344, 87.0863591302736, 111.66186476941093, 69.18646390093461, 102.98695061460893, 95.65339537307953, 98.20654331100883, 105.8888107222942, 103.9634036139471, 121.74892856422824, 88.61172275471799, 109.43689929247873, 93.68146541760912, 94.26166801977608, 90.79845866326394, 89.10519267568435, 112.19310672259634, 99.62508082616114, 106.9886341823054, 95.71915175484854, 103.54249962341787, 113.51805111025809, 106.35286034849209, 119.61125161295256], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5493321195908125, "mean_inference_ms": 7.947685995317756, "mean_action_processing_ms": 0.5432746897773196, "mean_env_wait_ms": 23.03158038532182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047133684158325195, "StateBufferConnector_ms": 0.03459334373474121, "ViewRequirementAgentConnector_ms": 0.9693288803100586}}, "episode_reward_max": 122.72378964058056, "episode_reward_min": 69.18646390093461, "episode_reward_mean": 102.31437606270747, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [114.03145360587574, 113.14766313712867, 91.57844524607161, 110.86140074122646, 89.19776841525, 101.28431362466718, 110.42990516322836, 92.51907173316678, 96.78371641590748, 109.15831583785237, 105.61319363355572, 96.051739469961, 112.17278304370079, 119.06483613803286, 116.68754932248319, 122.72378964058056, 88.75898198524295, 106.18882192605608, 91.10074710150809, 96.56830202543102, 93.57562642367537, 85.32853908919242, 115.77966628257413, 108.58270761180506, 102.43829616390676, 96.83047750660961, 104.76436052708108, 117.51229800965078, 101.8984463973936, 116.33277194511484, 90.0939655904237, 109.17112403567303, 96.14809487755014, 100.19626843108027, 97.7686522179567, 90.67209250684877, 108.63072657778756, 107.34801843434063, 109.33063370025712, 98.1706683711425, 102.13268807466714, 112.9612973424995, 104.86060148424443, 117.43786898218524, 90.78610254325079, 104.57413825512809, 88.36767376128938, 102.65516869276138, 97.97530191064875, 91.05578737165278, 101.30692285441795, 105.94636718143572, 103.68196494562672, 95.92961079055749, 100.4995639334452, 106.89942873023108, 108.58311029785064, 121.724810537608, 88.70985114510154, 108.85954713196575, 92.70430608545212, 95.54292323783004, 95.71346045192594, 89.33866228012783, 115.80779780014329, 103.76001417187769, 101.2254620764848, 98.43114406092525, 106.9918881949245, 110.70031256317927, 109.91810027692026, 116.47610537930444, 89.35605058532799, 105.96698831128569, 89.48709269247996, 98.02836561200893, 102.71613061264344, 87.0863591302736, 111.66186476941093, 69.18646390093461, 102.98695061460893, 95.65339537307953, 98.20654331100883, 105.8888107222942, 103.9634036139471, 121.74892856422824, 88.61172275471799, 109.43689929247873, 93.68146541760912, 94.26166801977608, 90.79845866326394, 89.10519267568435, 112.19310672259634, 99.62508082616114, 106.9886341823054, 95.71915175484854, 103.54249962341787, 113.51805111025809, 106.35286034849209, 119.61125161295256], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5493321195908125, "mean_inference_ms": 7.947685995317756, "mean_action_processing_ms": 0.5432746897773196, "mean_env_wait_ms": 23.03158038532182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047133684158325195, "StateBufferConnector_ms": 0.03459334373474121, "ViewRequirementAgentConnector_ms": 0.9693288803100586}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1354870, "num_agent_steps_trained": 1354870, "num_env_steps_sampled": 1354870, "num_env_steps_trained": 1354870, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 272.93246711640586, "num_env_steps_trained_throughput_per_sec": 272.93246711640586, "timesteps_total": 1354870, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1354870, "timers": {"training_iteration_time_ms": 58318.867, "sample_time_ms": 43844.051, "load_time_ms": 1675.01, "load_throughput": 9336.063, "learn_time_ms": 12254.567, "learn_throughput": 1276.096, "synch_weights_time_ms": 442.973}, "counters": {"num_env_steps_sampled": 1354870, "num_env_steps_trained": 1354870, "num_agent_steps_sampled": 1354870, "num_agent_steps_trained": 1354870}, "done": false, "episodes_total": 1501, "training_iteration": 107, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-13-56", "timestamp": 1749305636, "time_this_iter_s": 57.3014931678772, "time_total_s": 5906.773724079132, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5906.773724079132, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 76.43030303030301, "ram_util_percent": 55.15909090909091, "gpu_util_percent0": 0.08348484848484848, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.645130000000001e-05, "total_loss": -0.043075727636142716, "policy_loss": 0.020040869918276173, "vf_loss": 0.018201911169188945, "vf_explained_var": 0.977592744177038, "kl": 0.018244811265930447, "entropy": 15.477180782664906, "entropy_coeff": 0.004467695}, "model": {}, "num_grad_updates_lifetime": 48075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1370508, "num_env_steps_trained": 1370508, "num_agent_steps_sampled": 1370508, "num_agent_steps_trained": 1370508}, "sampler_results": {"episode_reward_max": 122.72378964058056, "episode_reward_min": 69.18646390093461, "episode_reward_mean": 101.70186695223609, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.68754932248319, 122.72378964058056, 88.75898198524295, 106.18882192605608, 91.10074710150809, 96.56830202543102, 93.57562642367537, 85.32853908919242, 115.77966628257413, 108.58270761180506, 102.43829616390676, 96.83047750660961, 104.76436052708108, 117.51229800965078, 101.8984463973936, 116.33277194511484, 90.0939655904237, 109.17112403567303, 96.14809487755014, 100.19626843108027, 97.7686522179567, 90.67209250684877, 108.63072657778756, 107.34801843434063, 109.33063370025712, 98.1706683711425, 102.13268807466714, 112.9612973424995, 104.86060148424443, 117.43786898218524, 90.78610254325079, 104.57413825512809, 88.36767376128938, 102.65516869276138, 97.97530191064875, 91.05578737165278, 101.30692285441795, 105.94636718143572, 103.68196494562672, 95.92961079055749, 100.4995639334452, 106.89942873023108, 108.58311029785064, 121.724810537608, 88.70985114510154, 108.85954713196575, 92.70430608545212, 95.54292323783004, 95.71346045192594, 89.33866228012783, 115.80779780014329, 103.76001417187769, 101.2254620764848, 98.43114406092525, 106.9918881949245, 110.70031256317927, 109.91810027692026, 116.47610537930444, 89.35605058532799, 105.96698831128569, 89.48709269247996, 98.02836561200893, 102.71613061264344, 87.0863591302736, 111.66186476941093, 69.18646390093461, 102.98695061460893, 95.65339537307953, 98.20654331100883, 105.8888107222942, 103.9634036139471, 121.74892856422824, 88.61172275471799, 109.43689929247873, 93.68146541760912, 94.26166801977608, 90.79845866326394, 89.10519267568435, 112.19310672259634, 99.62508082616114, 106.9886341823054, 95.71915175484854, 103.54249962341787, 113.51805111025809, 106.35286034849209, 119.61125161295256, 89.03662389727494, 103.7321258457159, 92.28334332983478, 97.93930014124462, 99.6133673914544, 81.20967330584074, 113.85366592934035, 103.33287764390444, 94.61259184599831, 94.88108024889883, 104.6328409318322, 105.10538091398995, 109.45308512937794, 110.95773860377851], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5544551811396143, "mean_inference_ms": 7.957853691858378, "mean_action_processing_ms": 0.5439769791893616, "mean_env_wait_ms": 23.052606603549044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05115175247192383, "StateBufferConnector_ms": 0.03654050827026367, "ViewRequirementAgentConnector_ms": 0.9549808502197266}}, "episode_reward_max": 122.72378964058056, "episode_reward_min": 69.18646390093461, "episode_reward_mean": 101.70186695223609, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [116.68754932248319, 122.72378964058056, 88.75898198524295, 106.18882192605608, 91.10074710150809, 96.56830202543102, 93.57562642367537, 85.32853908919242, 115.77966628257413, 108.58270761180506, 102.43829616390676, 96.83047750660961, 104.76436052708108, 117.51229800965078, 101.8984463973936, 116.33277194511484, 90.0939655904237, 109.17112403567303, 96.14809487755014, 100.19626843108027, 97.7686522179567, 90.67209250684877, 108.63072657778756, 107.34801843434063, 109.33063370025712, 98.1706683711425, 102.13268807466714, 112.9612973424995, 104.86060148424443, 117.43786898218524, 90.78610254325079, 104.57413825512809, 88.36767376128938, 102.65516869276138, 97.97530191064875, 91.05578737165278, 101.30692285441795, 105.94636718143572, 103.68196494562672, 95.92961079055749, 100.4995639334452, 106.89942873023108, 108.58311029785064, 121.724810537608, 88.70985114510154, 108.85954713196575, 92.70430608545212, 95.54292323783004, 95.71346045192594, 89.33866228012783, 115.80779780014329, 103.76001417187769, 101.2254620764848, 98.43114406092525, 106.9918881949245, 110.70031256317927, 109.91810027692026, 116.47610537930444, 89.35605058532799, 105.96698831128569, 89.48709269247996, 98.02836561200893, 102.71613061264344, 87.0863591302736, 111.66186476941093, 69.18646390093461, 102.98695061460893, 95.65339537307953, 98.20654331100883, 105.8888107222942, 103.9634036139471, 121.74892856422824, 88.61172275471799, 109.43689929247873, 93.68146541760912, 94.26166801977608, 90.79845866326394, 89.10519267568435, 112.19310672259634, 99.62508082616114, 106.9886341823054, 95.71915175484854, 103.54249962341787, 113.51805111025809, 106.35286034849209, 119.61125161295256, 89.03662389727494, 103.7321258457159, 92.28334332983478, 97.93930014124462, 99.6133673914544, 81.20967330584074, 113.85366592934035, 103.33287764390444, 94.61259184599831, 94.88108024889883, 104.6328409318322, 105.10538091398995, 109.45308512937794, 110.95773860377851], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5544551811396143, "mean_inference_ms": 7.957853691858378, "mean_action_processing_ms": 0.5439769791893616, "mean_env_wait_ms": 23.052606603549044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05115175247192383, "StateBufferConnector_ms": 0.03654050827026367, "ViewRequirementAgentConnector_ms": 0.9549808502197266}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1370508, "num_agent_steps_trained": 1370508, "num_env_steps_sampled": 1370508, "num_env_steps_trained": 1370508, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 271.82560458882034, "num_env_steps_trained_throughput_per_sec": 271.82560458882034, "timesteps_total": 1370508, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1370508, "timers": {"training_iteration_time_ms": 58318.466, "sample_time_ms": 43858.149, "load_time_ms": 1674.564, "load_throughput": 9338.549, "learn_time_ms": 12246.391, "learn_throughput": 1276.948, "synch_weights_time_ms": 434.16}, "counters": {"num_env_steps_sampled": 1370508, "num_env_steps_trained": 1370508, "num_agent_steps_sampled": 1370508, "num_agent_steps_trained": 1370508}, "done": false, "episodes_total": 1515, "training_iteration": 108, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-14-54", "timestamp": 1749305694, "time_this_iter_s": 57.62685775756836, "time_total_s": 5964.4005818367, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 5964.4005818367, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 76.75373134328358, "ram_util_percent": 55.005970149253734, "gpu_util_percent0": 0.08388059701492538, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.629492000000001e-05, "total_loss": -0.040966930489733135, "policy_loss": 0.021787297000939197, "vf_loss": 0.018035736774856394, "vf_explained_var": 0.9794348247484728, "kl": 0.01838072838229974, "entropy": 15.467072493813255, "entropy_coeff": 0.004444238}, "model": {}, "num_grad_updates_lifetime": 48625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1386146, "num_env_steps_trained": 1386146, "num_agent_steps_sampled": 1386146, "num_agent_steps_trained": 1386146}, "sampler_results": {"episode_reward_max": 121.74892856422824, "episode_reward_min": 69.18646390093461, "episode_reward_mean": 101.17747050912983, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.8984463973936, 116.33277194511484, 90.0939655904237, 109.17112403567303, 96.14809487755014, 100.19626843108027, 97.7686522179567, 90.67209250684877, 108.63072657778756, 107.34801843434063, 109.33063370025712, 98.1706683711425, 102.13268807466714, 112.9612973424995, 104.86060148424443, 117.43786898218524, 90.78610254325079, 104.57413825512809, 88.36767376128938, 102.65516869276138, 97.97530191064875, 91.05578737165278, 101.30692285441795, 105.94636718143572, 103.68196494562672, 95.92961079055749, 100.4995639334452, 106.89942873023108, 108.58311029785064, 121.724810537608, 88.70985114510154, 108.85954713196575, 92.70430608545212, 95.54292323783004, 95.71346045192594, 89.33866228012783, 115.80779780014329, 103.76001417187769, 101.2254620764848, 98.43114406092525, 106.9918881949245, 110.70031256317927, 109.91810027692026, 116.47610537930444, 89.35605058532799, 105.96698831128569, 89.48709269247996, 98.02836561200893, 102.71613061264344, 87.0863591302736, 111.66186476941093, 69.18646390093461, 102.98695061460893, 95.65339537307953, 98.20654331100883, 105.8888107222942, 103.9634036139471, 121.74892856422824, 88.61172275471799, 109.43689929247873, 93.68146541760912, 94.26166801977608, 90.79845866326394, 89.10519267568435, 112.19310672259634, 99.62508082616114, 106.9886341823054, 95.71915175484854, 103.54249962341787, 113.51805111025809, 106.35286034849209, 119.61125161295256, 89.03662389727494, 103.7321258457159, 92.28334332983478, 97.93930014124462, 99.6133673914544, 81.20967330584074, 113.85366592934035, 103.33287764390444, 94.61259184599831, 94.88108024889883, 104.6328409318322, 105.10538091398995, 109.45308512937794, 110.95773860377851, 86.67838512590237, 102.95571282365755, 91.49049273700686, 99.97532853626863, 104.25514777746723, 85.79946827587624, 114.68327395228174, 102.07728280529483, 90.60201347683989, 89.95375158700686, 98.38145768650789, 113.73416616800941, 102.00582310257954, 111.80821525047138], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.559090016742953, "mean_inference_ms": 7.9675656252998435, "mean_action_processing_ms": 0.5446101640321994, "mean_env_wait_ms": 23.072837711246475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05014514923095703, "StateBufferConnector_ms": 0.03294181823730469, "ViewRequirementAgentConnector_ms": 0.9620363712310791}}, "episode_reward_max": 121.74892856422824, "episode_reward_min": 69.18646390093461, "episode_reward_mean": 101.17747050912983, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [101.8984463973936, 116.33277194511484, 90.0939655904237, 109.17112403567303, 96.14809487755014, 100.19626843108027, 97.7686522179567, 90.67209250684877, 108.63072657778756, 107.34801843434063, 109.33063370025712, 98.1706683711425, 102.13268807466714, 112.9612973424995, 104.86060148424443, 117.43786898218524, 90.78610254325079, 104.57413825512809, 88.36767376128938, 102.65516869276138, 97.97530191064875, 91.05578737165278, 101.30692285441795, 105.94636718143572, 103.68196494562672, 95.92961079055749, 100.4995639334452, 106.89942873023108, 108.58311029785064, 121.724810537608, 88.70985114510154, 108.85954713196575, 92.70430608545212, 95.54292323783004, 95.71346045192594, 89.33866228012783, 115.80779780014329, 103.76001417187769, 101.2254620764848, 98.43114406092525, 106.9918881949245, 110.70031256317927, 109.91810027692026, 116.47610537930444, 89.35605058532799, 105.96698831128569, 89.48709269247996, 98.02836561200893, 102.71613061264344, 87.0863591302736, 111.66186476941093, 69.18646390093461, 102.98695061460893, 95.65339537307953, 98.20654331100883, 105.8888107222942, 103.9634036139471, 121.74892856422824, 88.61172275471799, 109.43689929247873, 93.68146541760912, 94.26166801977608, 90.79845866326394, 89.10519267568435, 112.19310672259634, 99.62508082616114, 106.9886341823054, 95.71915175484854, 103.54249962341787, 113.51805111025809, 106.35286034849209, 119.61125161295256, 89.03662389727494, 103.7321258457159, 92.28334332983478, 97.93930014124462, 99.6133673914544, 81.20967330584074, 113.85366592934035, 103.33287764390444, 94.61259184599831, 94.88108024889883, 104.6328409318322, 105.10538091398995, 109.45308512937794, 110.95773860377851, 86.67838512590237, 102.95571282365755, 91.49049273700686, 99.97532853626863, 104.25514777746723, 85.79946827587624, 114.68327395228174, 102.07728280529483, 90.60201347683989, 89.95375158700686, 98.38145768650789, 113.73416616800941, 102.00582310257954, 111.80821525047138], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.559090016742953, "mean_inference_ms": 7.9675656252998435, "mean_action_processing_ms": 0.5446101640321994, "mean_env_wait_ms": 23.072837711246475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05014514923095703, "StateBufferConnector_ms": 0.03294181823730469, "ViewRequirementAgentConnector_ms": 0.9620363712310791}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1386146, "num_agent_steps_trained": 1386146, "num_env_steps_sampled": 1386146, "num_env_steps_trained": 1386146, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 271.49610032445116, "num_env_steps_trained_throughput_per_sec": 271.49610032445116, "timesteps_total": 1386146, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1386146, "timers": {"training_iteration_time_ms": 58139.194, "sample_time_ms": 43669.14, "load_time_ms": 1668.165, "load_throughput": 9374.374, "learn_time_ms": 12266.526, "learn_throughput": 1274.852, "synch_weights_time_ms": 430.215}, "counters": {"num_env_steps_sampled": 1386146, "num_env_steps_trained": 1386146, "num_agent_steps_sampled": 1386146, "num_agent_steps_trained": 1386146}, "done": false, "episodes_total": 1529, "training_iteration": 109, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-15-52", "timestamp": 1749305752, "time_this_iter_s": 57.61739420890808, "time_total_s": 6022.0179760456085, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6022.0179760456085, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 77.08333333333331, "ram_util_percent": 55.26060606060606, "gpu_util_percent0": 0.08090909090909092, "vram_util_percent0": 0.8409830729166666}}
{"evaluation": {"sampler_results": {"episode_reward_max": -17.255104074671017, "episode_reward_min": -18.886071148975887, "episode_reward_mean": -17.72519168853516, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.886071148975887, -17.575653267902652, -17.27034958728777, -17.63878036383846, -17.255104074671017], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7386670758537879, "mean_inference_ms": 3.8724707680815187, "mean_action_processing_ms": 0.2998628937648038, "mean_env_wait_ms": 12.528941984905012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.631251335144043}}, "episode_reward_max": -17.255104074671017, "episode_reward_min": -18.886071148975887, "episode_reward_mean": -17.72519168853516, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.886071148975887, -17.575653267902652, -17.27034958728777, -17.63878036383846, -17.255104074671017], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7386670758537879, "mean_inference_ms": 3.8724707680815187, "mean_action_processing_ms": 0.2998628937648038, "mean_env_wait_ms": 12.528941984905012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.631251335144043}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.613854000000002e-05, "total_loss": -0.048820100494829766, "policy_loss": 0.014460582925186661, "vf_loss": 0.015718372120225633, "vf_explained_var": 0.9804838366941973, "kl": 0.017470016419409894, "entropy": 15.504530011957343, "entropy_coeff": 0.0044207809999999995}, "model": {}, "num_grad_updates_lifetime": 49175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1401784, "num_env_steps_trained": 1401784, "num_agent_steps_sampled": 1401784, "num_agent_steps_trained": 1401784}, "sampler_results": {"episode_reward_max": 121.74892856422824, "episode_reward_min": 69.18646390093461, "episode_reward_mean": 100.89668135848243, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.86060148424443, 117.43786898218524, 90.78610254325079, 104.57413825512809, 88.36767376128938, 102.65516869276138, 97.97530191064875, 91.05578737165278, 101.30692285441795, 105.94636718143572, 103.68196494562672, 95.92961079055749, 100.4995639334452, 106.89942873023108, 108.58311029785064, 121.724810537608, 88.70985114510154, 108.85954713196575, 92.70430608545212, 95.54292323783004, 95.71346045192594, 89.33866228012783, 115.80779780014329, 103.76001417187769, 101.2254620764848, 98.43114406092525, 106.9918881949245, 110.70031256317927, 109.91810027692026, 116.47610537930444, 89.35605058532799, 105.96698831128569, 89.48709269247996, 98.02836561200893, 102.71613061264344, 87.0863591302736, 111.66186476941093, 69.18646390093461, 102.98695061460893, 95.65339537307953, 98.20654331100883, 105.8888107222942, 103.9634036139471, 121.74892856422824, 88.61172275471799, 109.43689929247873, 93.68146541760912, 94.26166801977608, 90.79845866326394, 89.10519267568435, 112.19310672259634, 99.62508082616114, 106.9886341823054, 95.71915175484854, 103.54249962341787, 113.51805111025809, 106.35286034849209, 119.61125161295256, 89.03662389727494, 103.7321258457159, 92.28334332983478, 97.93930014124462, 99.6133673914544, 81.20967330584074, 113.85366592934035, 103.33287764390444, 94.61259184599831, 94.88108024889883, 104.6328409318322, 105.10538091398995, 109.45308512937794, 110.95773860377851, 86.67838512590237, 102.95571282365755, 91.49049273700686, 99.97532853626863, 104.25514777746723, 85.79946827587624, 114.68327395228174, 102.07728280529483, 90.60201347683989, 89.95375158700686, 98.38145768650789, 113.73416616800941, 102.00582310257954, 111.80821525047138, 83.96401288874372, 102.45217008671227, 92.45610069845432, 96.51171452900043, 97.79726703696443, 85.58335197890855, 111.42842594819741, 107.61269521693033, 105.55064841860593, 95.95651089584618, 103.00310364785601, 104.11558950399906, 108.9480235491581, 117.39691903861707], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5633609519949268, "mean_inference_ms": 7.976135232662883, "mean_action_processing_ms": 0.545161767996973, "mean_env_wait_ms": 23.09174375851411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049829959869384766, "StateBufferConnector_ms": 0.03503108024597168, "ViewRequirementAgentConnector_ms": 0.9614300727844238}}, "episode_reward_max": 121.74892856422824, "episode_reward_min": 69.18646390093461, "episode_reward_mean": 100.89668135848243, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [104.86060148424443, 117.43786898218524, 90.78610254325079, 104.57413825512809, 88.36767376128938, 102.65516869276138, 97.97530191064875, 91.05578737165278, 101.30692285441795, 105.94636718143572, 103.68196494562672, 95.92961079055749, 100.4995639334452, 106.89942873023108, 108.58311029785064, 121.724810537608, 88.70985114510154, 108.85954713196575, 92.70430608545212, 95.54292323783004, 95.71346045192594, 89.33866228012783, 115.80779780014329, 103.76001417187769, 101.2254620764848, 98.43114406092525, 106.9918881949245, 110.70031256317927, 109.91810027692026, 116.47610537930444, 89.35605058532799, 105.96698831128569, 89.48709269247996, 98.02836561200893, 102.71613061264344, 87.0863591302736, 111.66186476941093, 69.18646390093461, 102.98695061460893, 95.65339537307953, 98.20654331100883, 105.8888107222942, 103.9634036139471, 121.74892856422824, 88.61172275471799, 109.43689929247873, 93.68146541760912, 94.26166801977608, 90.79845866326394, 89.10519267568435, 112.19310672259634, 99.62508082616114, 106.9886341823054, 95.71915175484854, 103.54249962341787, 113.51805111025809, 106.35286034849209, 119.61125161295256, 89.03662389727494, 103.7321258457159, 92.28334332983478, 97.93930014124462, 99.6133673914544, 81.20967330584074, 113.85366592934035, 103.33287764390444, 94.61259184599831, 94.88108024889883, 104.6328409318322, 105.10538091398995, 109.45308512937794, 110.95773860377851, 86.67838512590237, 102.95571282365755, 91.49049273700686, 99.97532853626863, 104.25514777746723, 85.79946827587624, 114.68327395228174, 102.07728280529483, 90.60201347683989, 89.95375158700686, 98.38145768650789, 113.73416616800941, 102.00582310257954, 111.80821525047138, 83.96401288874372, 102.45217008671227, 92.45610069845432, 96.51171452900043, 97.79726703696443, 85.58335197890855, 111.42842594819741, 107.61269521693033, 105.55064841860593, 95.95651089584618, 103.00310364785601, 104.11558950399906, 108.9480235491581, 117.39691903861707], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5633609519949268, "mean_inference_ms": 7.976135232662883, "mean_action_processing_ms": 0.545161767996973, "mean_env_wait_ms": 23.09174375851411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049829959869384766, "StateBufferConnector_ms": 0.03503108024597168, "ViewRequirementAgentConnector_ms": 0.9614300727844238}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1401784, "num_agent_steps_trained": 1401784, "num_env_steps_sampled": 1401784, "num_env_steps_trained": 1401784, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 269.1136341979397, "num_env_steps_trained_throughput_per_sec": 269.1136341979397, "timesteps_total": 1401784, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1401784, "timers": {"training_iteration_time_ms": 58016.57, "sample_time_ms": 43498.739, "load_time_ms": 1677.238, "load_throughput": 9323.661, "learn_time_ms": 12304.801, "learn_throughput": 1270.886, "synch_weights_time_ms": 432.583}, "counters": {"num_env_steps_sampled": 1401784, "num_env_steps_trained": 1401784, "num_agent_steps_sampled": 1401784, "num_agent_steps_trained": 1401784}, "done": false, "episodes_total": 1543, "training_iteration": 110, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-17-07", "timestamp": 1749305827, "time_this_iter_s": 75.17206811904907, "time_total_s": 6097.190044164658, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6097.190044164658, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 62.992045454545455, "ram_util_percent": 55.025, "gpu_util_percent0": 0.07227272727272727, "vram_util_percent0": 0.8409830729166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.598215999999999e-05, "total_loss": -0.047935089595742865, "policy_loss": 0.014499043310061098, "vf_loss": 0.016907622738191012, "vf_explained_var": 0.9783677009018985, "kl": 0.017349665108806263, "entropy": 15.475002443140204, "entropy_coeff": 0.004397324}, "model": {}, "num_grad_updates_lifetime": 49725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1417422, "num_env_steps_trained": 1417422, "num_agent_steps_sampled": 1417422, "num_agent_steps_trained": 1417422}, "sampler_results": {"episode_reward_max": 121.74892856422824, "episode_reward_min": 69.18646390093461, "episode_reward_mean": 100.7137395646346, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.58311029785064, 121.724810537608, 88.70985114510154, 108.85954713196575, 92.70430608545212, 95.54292323783004, 95.71346045192594, 89.33866228012783, 115.80779780014329, 103.76001417187769, 101.2254620764848, 98.43114406092525, 106.9918881949245, 110.70031256317927, 109.91810027692026, 116.47610537930444, 89.35605058532799, 105.96698831128569, 89.48709269247996, 98.02836561200893, 102.71613061264344, 87.0863591302736, 111.66186476941093, 69.18646390093461, 102.98695061460893, 95.65339537307953, 98.20654331100883, 105.8888107222942, 103.9634036139471, 121.74892856422824, 88.61172275471799, 109.43689929247873, 93.68146541760912, 94.26166801977608, 90.79845866326394, 89.10519267568435, 112.19310672259634, 99.62508082616114, 106.9886341823054, 95.71915175484854, 103.54249962341787, 113.51805111025809, 106.35286034849209, 119.61125161295256, 89.03662389727494, 103.7321258457159, 92.28334332983478, 97.93930014124462, 99.6133673914544, 81.20967330584074, 113.85366592934035, 103.33287764390444, 94.61259184599831, 94.88108024889883, 104.6328409318322, 105.10538091398995, 109.45308512937794, 110.95773860377851, 86.67838512590237, 102.95571282365755, 91.49049273700686, 99.97532853626863, 104.25514777746723, 85.79946827587624, 114.68327395228174, 102.07728280529483, 90.60201347683989, 89.95375158700686, 98.38145768650789, 113.73416616800941, 102.00582310257954, 111.80821525047138, 83.96401288874372, 102.45217008671227, 92.45610069845432, 96.51171452900043, 97.79726703696443, 85.58335197890855, 111.42842594819741, 107.61269521693033, 105.55064841860593, 95.95651089584618, 103.00310364785601, 104.11558950399906, 108.9480235491581, 117.39691903861707, 79.84085526801641, 95.93088428966914, 93.84720479176269, 91.83016434759332, 97.96121247506218, 83.26515500617491, 114.45946040835015, 104.93265583461016, 102.58398444365822, 94.74073282856922, 106.87147519765331, 110.3856526384442, 104.41242303088553, 112.62046149164338], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.567236592163066, "mean_inference_ms": 7.983761048732731, "mean_action_processing_ms": 0.5456607407305472, "mean_env_wait_ms": 23.10790355067981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04681801795959473, "StateBufferConnector_ms": 0.034046173095703125, "ViewRequirementAgentConnector_ms": 0.9606473445892334}}, "episode_reward_max": 121.74892856422824, "episode_reward_min": 69.18646390093461, "episode_reward_mean": 100.7137395646346, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [108.58311029785064, 121.724810537608, 88.70985114510154, 108.85954713196575, 92.70430608545212, 95.54292323783004, 95.71346045192594, 89.33866228012783, 115.80779780014329, 103.76001417187769, 101.2254620764848, 98.43114406092525, 106.9918881949245, 110.70031256317927, 109.91810027692026, 116.47610537930444, 89.35605058532799, 105.96698831128569, 89.48709269247996, 98.02836561200893, 102.71613061264344, 87.0863591302736, 111.66186476941093, 69.18646390093461, 102.98695061460893, 95.65339537307953, 98.20654331100883, 105.8888107222942, 103.9634036139471, 121.74892856422824, 88.61172275471799, 109.43689929247873, 93.68146541760912, 94.26166801977608, 90.79845866326394, 89.10519267568435, 112.19310672259634, 99.62508082616114, 106.9886341823054, 95.71915175484854, 103.54249962341787, 113.51805111025809, 106.35286034849209, 119.61125161295256, 89.03662389727494, 103.7321258457159, 92.28334332983478, 97.93930014124462, 99.6133673914544, 81.20967330584074, 113.85366592934035, 103.33287764390444, 94.61259184599831, 94.88108024889883, 104.6328409318322, 105.10538091398995, 109.45308512937794, 110.95773860377851, 86.67838512590237, 102.95571282365755, 91.49049273700686, 99.97532853626863, 104.25514777746723, 85.79946827587624, 114.68327395228174, 102.07728280529483, 90.60201347683989, 89.95375158700686, 98.38145768650789, 113.73416616800941, 102.00582310257954, 111.80821525047138, 83.96401288874372, 102.45217008671227, 92.45610069845432, 96.51171452900043, 97.79726703696443, 85.58335197890855, 111.42842594819741, 107.61269521693033, 105.55064841860593, 95.95651089584618, 103.00310364785601, 104.11558950399906, 108.9480235491581, 117.39691903861707, 79.84085526801641, 95.93088428966914, 93.84720479176269, 91.83016434759332, 97.96121247506218, 83.26515500617491, 114.45946040835015, 104.93265583461016, 102.58398444365822, 94.74073282856922, 106.87147519765331, 110.3856526384442, 104.41242303088553, 112.62046149164338], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.567236592163066, "mean_inference_ms": 7.983761048732731, "mean_action_processing_ms": 0.5456607407305472, "mean_env_wait_ms": 23.10790355067981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04681801795959473, "StateBufferConnector_ms": 0.034046173095703125, "ViewRequirementAgentConnector_ms": 0.9606473445892334}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1417422, "num_agent_steps_trained": 1417422, "num_env_steps_sampled": 1417422, "num_env_steps_trained": 1417422, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 272.11983339479593, "num_env_steps_trained_throughput_per_sec": 272.11983339479593, "timesteps_total": 1417422, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1417422, "timers": {"training_iteration_time_ms": 58034.222, "sample_time_ms": 43508.489, "load_time_ms": 1681.64, "load_throughput": 9299.254, "learn_time_ms": 12312.523, "learn_throughput": 1270.089, "synch_weights_time_ms": 428.788}, "counters": {"num_env_steps_sampled": 1417422, "num_env_steps_trained": 1417422, "num_agent_steps_sampled": 1417422, "num_agent_steps_trained": 1417422}, "done": false, "episodes_total": 1557, "training_iteration": 111, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-18-04", "timestamp": 1749305884, "time_this_iter_s": 57.48143029212952, "time_total_s": 6154.671474456787, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6154.671474456787, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 77.11194029850748, "ram_util_percent": 55.52985074626865, "gpu_util_percent0": 0.08253731343283582, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.582578e-05, "total_loss": -0.0568232641664376, "policy_loss": 0.005216618091905151, "vf_loss": 0.017077676458495922, "vf_explained_var": 0.9764086179299788, "kl": 0.017822209924187017, "entropy": 15.48289641640403, "entropy_coeff": 0.004373867}, "model": {}, "num_grad_updates_lifetime": 50275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1433060, "num_env_steps_trained": 1433060, "num_agent_steps_sampled": 1433060, "num_agent_steps_trained": 1433060}, "sampler_results": {"episode_reward_max": 121.74892856422824, "episode_reward_min": 69.18646390093461, "episode_reward_mean": 100.27767418062112, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.91810027692026, 116.47610537930444, 89.35605058532799, 105.96698831128569, 89.48709269247996, 98.02836561200893, 102.71613061264344, 87.0863591302736, 111.66186476941093, 69.18646390093461, 102.98695061460893, 95.65339537307953, 98.20654331100883, 105.8888107222942, 103.9634036139471, 121.74892856422824, 88.61172275471799, 109.43689929247873, 93.68146541760912, 94.26166801977608, 90.79845866326394, 89.10519267568435, 112.19310672259634, 99.62508082616114, 106.9886341823054, 95.71915175484854, 103.54249962341787, 113.51805111025809, 106.35286034849209, 119.61125161295256, 89.03662389727494, 103.7321258457159, 92.28334332983478, 97.93930014124462, 99.6133673914544, 81.20967330584074, 113.85366592934035, 103.33287764390444, 94.61259184599831, 94.88108024889883, 104.6328409318322, 105.10538091398995, 109.45308512937794, 110.95773860377851, 86.67838512590237, 102.95571282365755, 91.49049273700686, 99.97532853626863, 104.25514777746723, 85.79946827587624, 114.68327395228174, 102.07728280529483, 90.60201347683989, 89.95375158700686, 98.38145768650789, 113.73416616800941, 102.00582310257954, 111.80821525047138, 83.96401288874372, 102.45217008671227, 92.45610069845432, 96.51171452900043, 97.79726703696443, 85.58335197890855, 111.42842594819741, 107.61269521693033, 105.55064841860593, 95.95651089584618, 103.00310364785601, 104.11558950399906, 108.9480235491581, 117.39691903861707, 79.84085526801641, 95.93088428966914, 93.84720479176269, 91.83016434759332, 97.96121247506218, 83.26515500617491, 114.45946040835015, 104.93265583461016, 102.58398444365822, 94.74073282856922, 106.87147519765331, 110.3856526384442, 104.41242303088553, 112.62046149164338, 78.95255162995079, 105.49347650910522, 88.73355391685357, 96.26092283001502, 93.0880932946162, 87.64175630761137, 108.62948575153366, 109.10939750883331, 102.40090897680928, 92.707021719402, 103.01897526170617, 107.57893721313107, 104.46320155356364, 116.40846916091901], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.571025173312125, "mean_inference_ms": 7.990641328810553, "mean_action_processing_ms": 0.5460982202983523, "mean_env_wait_ms": 23.122701912750752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034682512283325195, "StateBufferConnector_ms": 0.034967899322509766, "ViewRequirementAgentConnector_ms": 1.0056767463684082}}, "episode_reward_max": 121.74892856422824, "episode_reward_min": 69.18646390093461, "episode_reward_mean": 100.27767418062112, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [109.91810027692026, 116.47610537930444, 89.35605058532799, 105.96698831128569, 89.48709269247996, 98.02836561200893, 102.71613061264344, 87.0863591302736, 111.66186476941093, 69.18646390093461, 102.98695061460893, 95.65339537307953, 98.20654331100883, 105.8888107222942, 103.9634036139471, 121.74892856422824, 88.61172275471799, 109.43689929247873, 93.68146541760912, 94.26166801977608, 90.79845866326394, 89.10519267568435, 112.19310672259634, 99.62508082616114, 106.9886341823054, 95.71915175484854, 103.54249962341787, 113.51805111025809, 106.35286034849209, 119.61125161295256, 89.03662389727494, 103.7321258457159, 92.28334332983478, 97.93930014124462, 99.6133673914544, 81.20967330584074, 113.85366592934035, 103.33287764390444, 94.61259184599831, 94.88108024889883, 104.6328409318322, 105.10538091398995, 109.45308512937794, 110.95773860377851, 86.67838512590237, 102.95571282365755, 91.49049273700686, 99.97532853626863, 104.25514777746723, 85.79946827587624, 114.68327395228174, 102.07728280529483, 90.60201347683989, 89.95375158700686, 98.38145768650789, 113.73416616800941, 102.00582310257954, 111.80821525047138, 83.96401288874372, 102.45217008671227, 92.45610069845432, 96.51171452900043, 97.79726703696443, 85.58335197890855, 111.42842594819741, 107.61269521693033, 105.55064841860593, 95.95651089584618, 103.00310364785601, 104.11558950399906, 108.9480235491581, 117.39691903861707, 79.84085526801641, 95.93088428966914, 93.84720479176269, 91.83016434759332, 97.96121247506218, 83.26515500617491, 114.45946040835015, 104.93265583461016, 102.58398444365822, 94.74073282856922, 106.87147519765331, 110.3856526384442, 104.41242303088553, 112.62046149164338, 78.95255162995079, 105.49347650910522, 88.73355391685357, 96.26092283001502, 93.0880932946162, 87.64175630761137, 108.62948575153366, 109.10939750883331, 102.40090897680928, 92.707021719402, 103.01897526170617, 107.57893721313107, 104.46320155356364, 116.40846916091901], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.571025173312125, "mean_inference_ms": 7.990641328810553, "mean_action_processing_ms": 0.5460982202983523, "mean_env_wait_ms": 23.122701912750752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034682512283325195, "StateBufferConnector_ms": 0.034967899322509766, "ViewRequirementAgentConnector_ms": 1.0056767463684082}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1433060, "num_agent_steps_trained": 1433060, "num_env_steps_sampled": 1433060, "num_env_steps_trained": 1433060, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 270.7578476235598, "num_env_steps_trained_throughput_per_sec": 270.7578476235598, "timesteps_total": 1433060, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1433060, "timers": {"training_iteration_time_ms": 57994.413, "sample_time_ms": 43450.844, "load_time_ms": 1674.749, "load_throughput": 9337.516, "learn_time_ms": 12332.4, "learn_throughput": 1268.042, "synch_weights_time_ms": 433.57}, "counters": {"num_env_steps_sampled": 1433060, "num_env_steps_trained": 1433060, "num_agent_steps_sampled": 1433060, "num_agent_steps_trained": 1433060}, "done": false, "episodes_total": 1571, "training_iteration": 112, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-19-02", "timestamp": 1749305942, "time_this_iter_s": 57.77398204803467, "time_total_s": 6212.445456504822, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6212.445456504822, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 76.83134328358207, "ram_util_percent": 55.43283582089552, "gpu_util_percent0": 0.09298507462686566, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.566940000000002e-05, "total_loss": -0.033039764302613385, "policy_loss": 0.027818550353615797, "vf_loss": 0.01991815788946538, "vf_explained_var": 0.9751002124222842, "kl": 0.017930780440699932, "entropy": 15.491436715559527, "entropy_coeff": 0.00435041}, "model": {}, "num_grad_updates_lifetime": 50825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1448698, "num_env_steps_trained": 1448698, "num_agent_steps_sampled": 1448698, "num_agent_steps_trained": 1448698}, "sampler_results": {"episode_reward_max": 121.74892856422824, "episode_reward_min": 78.95255162995079, "episode_reward_mean": 100.17768406193872, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.9634036139471, 121.74892856422824, 88.61172275471799, 109.43689929247873, 93.68146541760912, 94.26166801977608, 90.79845866326394, 89.10519267568435, 112.19310672259634, 99.62508082616114, 106.9886341823054, 95.71915175484854, 103.54249962341787, 113.51805111025809, 106.35286034849209, 119.61125161295256, 89.03662389727494, 103.7321258457159, 92.28334332983478, 97.93930014124462, 99.6133673914544, 81.20967330584074, 113.85366592934035, 103.33287764390444, 94.61259184599831, 94.88108024889883, 104.6328409318322, 105.10538091398995, 109.45308512937794, 110.95773860377851, 86.67838512590237, 102.95571282365755, 91.49049273700686, 99.97532853626863, 104.25514777746723, 85.79946827587624, 114.68327395228174, 102.07728280529483, 90.60201347683989, 89.95375158700686, 98.38145768650789, 113.73416616800941, 102.00582310257954, 111.80821525047138, 83.96401288874372, 102.45217008671227, 92.45610069845432, 96.51171452900043, 97.79726703696443, 85.58335197890855, 111.42842594819741, 107.61269521693033, 105.55064841860593, 95.95651089584618, 103.00310364785601, 104.11558950399906, 108.9480235491581, 117.39691903861707, 79.84085526801641, 95.93088428966914, 93.84720479176269, 91.83016434759332, 97.96121247506218, 83.26515500617491, 114.45946040835015, 104.93265583461016, 102.58398444365822, 94.74073282856922, 106.87147519765331, 110.3856526384442, 104.41242303088553, 112.62046149164338, 78.95255162995079, 105.49347650910522, 88.73355391685357, 96.26092283001502, 93.0880932946162, 87.64175630761137, 108.62948575153366, 109.10939750883331, 102.40090897680928, 92.707021719402, 103.01897526170617, 107.57893721313107, 104.46320155356364, 116.40846916091901, 85.49511987364305, 107.96368489893939, 90.15415531735758, 87.85282802773231, 92.89572179156609, 85.72417029941495, 111.74568573790596, 99.29163840570276, 95.59830827702127, 92.83499488945748, 102.28108421696732, 97.53869992164826, 106.55094936522134, 116.69316840076561], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5745121886231503, "mean_inference_ms": 7.998110356544364, "mean_action_processing_ms": 0.5465741978326291, "mean_env_wait_ms": 23.13876229601369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03484368324279785, "StateBufferConnector_ms": 0.03400778770446777, "ViewRequirementAgentConnector_ms": 1.0010323524475098}}, "episode_reward_max": 121.74892856422824, "episode_reward_min": 78.95255162995079, "episode_reward_mean": 100.17768406193872, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [103.9634036139471, 121.74892856422824, 88.61172275471799, 109.43689929247873, 93.68146541760912, 94.26166801977608, 90.79845866326394, 89.10519267568435, 112.19310672259634, 99.62508082616114, 106.9886341823054, 95.71915175484854, 103.54249962341787, 113.51805111025809, 106.35286034849209, 119.61125161295256, 89.03662389727494, 103.7321258457159, 92.28334332983478, 97.93930014124462, 99.6133673914544, 81.20967330584074, 113.85366592934035, 103.33287764390444, 94.61259184599831, 94.88108024889883, 104.6328409318322, 105.10538091398995, 109.45308512937794, 110.95773860377851, 86.67838512590237, 102.95571282365755, 91.49049273700686, 99.97532853626863, 104.25514777746723, 85.79946827587624, 114.68327395228174, 102.07728280529483, 90.60201347683989, 89.95375158700686, 98.38145768650789, 113.73416616800941, 102.00582310257954, 111.80821525047138, 83.96401288874372, 102.45217008671227, 92.45610069845432, 96.51171452900043, 97.79726703696443, 85.58335197890855, 111.42842594819741, 107.61269521693033, 105.55064841860593, 95.95651089584618, 103.00310364785601, 104.11558950399906, 108.9480235491581, 117.39691903861707, 79.84085526801641, 95.93088428966914, 93.84720479176269, 91.83016434759332, 97.96121247506218, 83.26515500617491, 114.45946040835015, 104.93265583461016, 102.58398444365822, 94.74073282856922, 106.87147519765331, 110.3856526384442, 104.41242303088553, 112.62046149164338, 78.95255162995079, 105.49347650910522, 88.73355391685357, 96.26092283001502, 93.0880932946162, 87.64175630761137, 108.62948575153366, 109.10939750883331, 102.40090897680928, 92.707021719402, 103.01897526170617, 107.57893721313107, 104.46320155356364, 116.40846916091901, 85.49511987364305, 107.96368489893939, 90.15415531735758, 87.85282802773231, 92.89572179156609, 85.72417029941495, 111.74568573790596, 99.29163840570276, 95.59830827702127, 92.83499488945748, 102.28108421696732, 97.53869992164826, 106.55094936522134, 116.69316840076561], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5745121886231503, "mean_inference_ms": 7.998110356544364, "mean_action_processing_ms": 0.5465741978326291, "mean_env_wait_ms": 23.13876229601369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03484368324279785, "StateBufferConnector_ms": 0.03400778770446777, "ViewRequirementAgentConnector_ms": 1.0010323524475098}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1448698, "num_agent_steps_trained": 1448698, "num_env_steps_sampled": 1448698, "num_env_steps_trained": 1448698, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 263.0953473840151, "num_env_steps_trained_throughput_per_sec": 263.0953473840151, "timesteps_total": 1448698, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1448698, "timers": {"training_iteration_time_ms": 57938.989, "sample_time_ms": 43334.761, "load_time_ms": 1685.33, "load_throughput": 9278.895, "learn_time_ms": 12380.93, "learn_throughput": 1263.071, "synch_weights_time_ms": 434.557}, "counters": {"num_env_steps_sampled": 1448698, "num_env_steps_trained": 1448698, "num_agent_steps_sampled": 1448698, "num_agent_steps_trained": 1448698}, "done": false, "episodes_total": 1585, "training_iteration": 113, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-20-02", "timestamp": 1749306002, "time_this_iter_s": 59.45453715324402, "time_total_s": 6271.899993658066, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6271.899993658066, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 78.52941176470588, "ram_util_percent": 55.686764705882354, "gpu_util_percent0": 0.08720588235294119, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.551301999999998e-05, "total_loss": -0.024670250709168614, "policy_loss": 0.03681302115321159, "vf_loss": 0.01692472259619866, "vf_explained_var": 0.979310393225063, "kl": 0.018764373885512938, "entropy": 15.518327510140159, "entropy_coeff": 0.0043269530000000014}, "model": {}, "num_grad_updates_lifetime": 51375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1464336, "num_env_steps_trained": 1464336, "num_agent_steps_sampled": 1464336, "num_agent_steps_trained": 1464336}, "sampler_results": {"episode_reward_max": 119.61125161295256, "episode_reward_min": 78.13555551053847, "episode_reward_mean": 99.60594082218533, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.35286034849209, 119.61125161295256, 89.03662389727494, 103.7321258457159, 92.28334332983478, 97.93930014124462, 99.6133673914544, 81.20967330584074, 113.85366592934035, 103.33287764390444, 94.61259184599831, 94.88108024889883, 104.6328409318322, 105.10538091398995, 109.45308512937794, 110.95773860377851, 86.67838512590237, 102.95571282365755, 91.49049273700686, 99.97532853626863, 104.25514777746723, 85.79946827587624, 114.68327395228174, 102.07728280529483, 90.60201347683989, 89.95375158700686, 98.38145768650789, 113.73416616800941, 102.00582310257954, 111.80821525047138, 83.96401288874372, 102.45217008671227, 92.45610069845432, 96.51171452900043, 97.79726703696443, 85.58335197890855, 111.42842594819741, 107.61269521693033, 105.55064841860593, 95.95651089584618, 103.00310364785601, 104.11558950399906, 108.9480235491581, 117.39691903861707, 79.84085526801641, 95.93088428966914, 93.84720479176269, 91.83016434759332, 97.96121247506218, 83.26515500617491, 114.45946040835015, 104.93265583461016, 102.58398444365822, 94.74073282856922, 106.87147519765331, 110.3856526384442, 104.41242303088553, 112.62046149164338, 78.95255162995079, 105.49347650910522, 88.73355391685357, 96.26092283001502, 93.0880932946162, 87.64175630761137, 108.62948575153366, 109.10939750883331, 102.40090897680928, 92.707021719402, 103.01897526170617, 107.57893721313107, 104.46320155356364, 116.40846916091901, 85.49511987364305, 107.96368489893939, 90.15415531735758, 87.85282802773231, 92.89572179156609, 85.72417029941495, 111.74568573790596, 99.29163840570276, 95.59830827702127, 92.83499488945748, 102.28108421696732, 97.53869992164826, 106.55094936522134, 116.69316840076561, 82.50985198655714, 104.19703359959753, 90.24071806591114, 96.0891253131859, 99.13331279837746, 78.13555551053847, 103.71904218303571, 103.61213601477792, 94.23508992892127, 92.68930389314453, 98.57287284077826, 107.26095475421798, 102.08703578161118, 113.53790657529667], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5780388325234087, "mean_inference_ms": 8.006556328102572, "mean_action_processing_ms": 0.5471221590133574, "mean_env_wait_ms": 23.15681312645123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036899566650390625, "StateBufferConnector_ms": 0.04159116744995117, "ViewRequirementAgentConnector_ms": 0.9804480075836182}}, "episode_reward_max": 119.61125161295256, "episode_reward_min": 78.13555551053847, "episode_reward_mean": 99.60594082218533, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [106.35286034849209, 119.61125161295256, 89.03662389727494, 103.7321258457159, 92.28334332983478, 97.93930014124462, 99.6133673914544, 81.20967330584074, 113.85366592934035, 103.33287764390444, 94.61259184599831, 94.88108024889883, 104.6328409318322, 105.10538091398995, 109.45308512937794, 110.95773860377851, 86.67838512590237, 102.95571282365755, 91.49049273700686, 99.97532853626863, 104.25514777746723, 85.79946827587624, 114.68327395228174, 102.07728280529483, 90.60201347683989, 89.95375158700686, 98.38145768650789, 113.73416616800941, 102.00582310257954, 111.80821525047138, 83.96401288874372, 102.45217008671227, 92.45610069845432, 96.51171452900043, 97.79726703696443, 85.58335197890855, 111.42842594819741, 107.61269521693033, 105.55064841860593, 95.95651089584618, 103.00310364785601, 104.11558950399906, 108.9480235491581, 117.39691903861707, 79.84085526801641, 95.93088428966914, 93.84720479176269, 91.83016434759332, 97.96121247506218, 83.26515500617491, 114.45946040835015, 104.93265583461016, 102.58398444365822, 94.74073282856922, 106.87147519765331, 110.3856526384442, 104.41242303088553, 112.62046149164338, 78.95255162995079, 105.49347650910522, 88.73355391685357, 96.26092283001502, 93.0880932946162, 87.64175630761137, 108.62948575153366, 109.10939750883331, 102.40090897680928, 92.707021719402, 103.01897526170617, 107.57893721313107, 104.46320155356364, 116.40846916091901, 85.49511987364305, 107.96368489893939, 90.15415531735758, 87.85282802773231, 92.89572179156609, 85.72417029941495, 111.74568573790596, 99.29163840570276, 95.59830827702127, 92.83499488945748, 102.28108421696732, 97.53869992164826, 106.55094936522134, 116.69316840076561, 82.50985198655714, 104.19703359959753, 90.24071806591114, 96.0891253131859, 99.13331279837746, 78.13555551053847, 103.71904218303571, 103.61213601477792, 94.23508992892127, 92.68930389314453, 98.57287284077826, 107.26095475421798, 102.08703578161118, 113.53790657529667], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5780388325234087, "mean_inference_ms": 8.006556328102572, "mean_action_processing_ms": 0.5471221590133574, "mean_env_wait_ms": 23.15681312645123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036899566650390625, "StateBufferConnector_ms": 0.04159116744995117, "ViewRequirementAgentConnector_ms": 0.9804480075836182}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464336, "num_agent_steps_trained": 1464336, "num_env_steps_sampled": 1464336, "num_env_steps_trained": 1464336, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 256.56700736606615, "num_env_steps_trained_throughput_per_sec": 256.56700736606615, "timesteps_total": 1464336, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1464336, "timers": {"training_iteration_time_ms": 58089.642, "sample_time_ms": 43344.127, "load_time_ms": 1694.287, "load_throughput": 9229.839, "learn_time_ms": 12496.277, "learn_throughput": 1251.413, "synch_weights_time_ms": 450.901}, "counters": {"num_env_steps_sampled": 1464336, "num_env_steps_trained": 1464336, "num_agent_steps_sampled": 1464336, "num_agent_steps_trained": 1464336}, "done": false, "episodes_total": 1599, "training_iteration": 114, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-21-03", "timestamp": 1749306063, "time_this_iter_s": 60.96644639968872, "time_total_s": 6332.8664400577545, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6332.8664400577545, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 78.09577464788732, "ram_util_percent": 56.701408450704236, "gpu_util_percent0": 0.08746478873239437, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.535664e-05, "total_loss": -0.04249903448095376, "policy_loss": 0.01851541370743441, "vf_loss": 0.01865643042986366, "vf_explained_var": 0.9775806128978729, "kl": 0.0177957712712368, "entropy": 15.607659131830388, "entropy_coeff": 0.004303496}, "model": {}, "num_grad_updates_lifetime": 51925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1479974, "num_env_steps_trained": 1479974, "num_agent_steps_sampled": 1479974, "num_agent_steps_trained": 1479974}, "sampler_results": {"episode_reward_max": 117.39691903861707, "episode_reward_min": 76.54840301060126, "episode_reward_mean": 99.16162043091708, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [109.45308512937794, 110.95773860377851, 86.67838512590237, 102.95571282365755, 91.49049273700686, 99.97532853626863, 104.25514777746723, 85.79946827587624, 114.68327395228174, 102.07728280529483, 90.60201347683989, 89.95375158700686, 98.38145768650789, 113.73416616800941, 102.00582310257954, 111.80821525047138, 83.96401288874372, 102.45217008671227, 92.45610069845432, 96.51171452900043, 97.79726703696443, 85.58335197890855, 111.42842594819741, 107.61269521693033, 105.55064841860593, 95.95651089584618, 103.00310364785601, 104.11558950399906, 108.9480235491581, 117.39691903861707, 79.84085526801641, 95.93088428966914, 93.84720479176269, 91.83016434759332, 97.96121247506218, 83.26515500617491, 114.45946040835015, 104.93265583461016, 102.58398444365822, 94.74073282856922, 106.87147519765331, 110.3856526384442, 104.41242303088553, 112.62046149164338, 78.95255162995079, 105.49347650910522, 88.73355391685357, 96.26092283001502, 93.0880932946162, 87.64175630761137, 108.62948575153366, 109.10939750883331, 102.40090897680928, 92.707021719402, 103.01897526170617, 107.57893721313107, 104.46320155356364, 116.40846916091901, 85.49511987364305, 107.96368489893939, 90.15415531735758, 87.85282802773231, 92.89572179156609, 85.72417029941495, 111.74568573790596, 99.29163840570276, 95.59830827702127, 92.83499488945748, 102.28108421696732, 97.53869992164826, 106.55094936522134, 116.69316840076561, 82.50985198655714, 104.19703359959753, 90.24071806591114, 96.0891253131859, 99.13331279837746, 78.13555551053847, 103.71904218303571, 103.61213601477792, 94.23508992892127, 92.68930389314453, 98.57287284077826, 107.26095475421798, 102.08703578161118, 113.53790657529667, 76.54840301060126, 102.28277124111239, 95.37596442223011, 95.24162776607754, 97.04047465763533, 86.09968929401423, 110.43215776628031, 104.26809288286417, 93.00984764262921, 82.10929845769903, 107.35479574094957, 103.01719383109875, 98.27079042830682, 110.71383711844997], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5819598408265505, "mean_inference_ms": 8.01774198999699, "mean_action_processing_ms": 0.5478379199606423, "mean_env_wait_ms": 23.179649657258988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039910316467285156, "StateBufferConnector_ms": 0.0401158332824707, "ViewRequirementAgentConnector_ms": 1.0346386432647705}}, "episode_reward_max": 117.39691903861707, "episode_reward_min": 76.54840301060126, "episode_reward_mean": 99.16162043091708, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [109.45308512937794, 110.95773860377851, 86.67838512590237, 102.95571282365755, 91.49049273700686, 99.97532853626863, 104.25514777746723, 85.79946827587624, 114.68327395228174, 102.07728280529483, 90.60201347683989, 89.95375158700686, 98.38145768650789, 113.73416616800941, 102.00582310257954, 111.80821525047138, 83.96401288874372, 102.45217008671227, 92.45610069845432, 96.51171452900043, 97.79726703696443, 85.58335197890855, 111.42842594819741, 107.61269521693033, 105.55064841860593, 95.95651089584618, 103.00310364785601, 104.11558950399906, 108.9480235491581, 117.39691903861707, 79.84085526801641, 95.93088428966914, 93.84720479176269, 91.83016434759332, 97.96121247506218, 83.26515500617491, 114.45946040835015, 104.93265583461016, 102.58398444365822, 94.74073282856922, 106.87147519765331, 110.3856526384442, 104.41242303088553, 112.62046149164338, 78.95255162995079, 105.49347650910522, 88.73355391685357, 96.26092283001502, 93.0880932946162, 87.64175630761137, 108.62948575153366, 109.10939750883331, 102.40090897680928, 92.707021719402, 103.01897526170617, 107.57893721313107, 104.46320155356364, 116.40846916091901, 85.49511987364305, 107.96368489893939, 90.15415531735758, 87.85282802773231, 92.89572179156609, 85.72417029941495, 111.74568573790596, 99.29163840570276, 95.59830827702127, 92.83499488945748, 102.28108421696732, 97.53869992164826, 106.55094936522134, 116.69316840076561, 82.50985198655714, 104.19703359959753, 90.24071806591114, 96.0891253131859, 99.13331279837746, 78.13555551053847, 103.71904218303571, 103.61213601477792, 94.23508992892127, 92.68930389314453, 98.57287284077826, 107.26095475421798, 102.08703578161118, 113.53790657529667, 76.54840301060126, 102.28277124111239, 95.37596442223011, 95.24162776607754, 97.04047465763533, 86.09968929401423, 110.43215776628031, 104.26809288286417, 93.00984764262921, 82.10929845769903, 107.35479574094957, 103.01719383109875, 98.27079042830682, 110.71383711844997], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5819598408265505, "mean_inference_ms": 8.01774198999699, "mean_action_processing_ms": 0.5478379199606423, "mean_env_wait_ms": 23.179649657258988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039910316467285156, "StateBufferConnector_ms": 0.0401158332824707, "ViewRequirementAgentConnector_ms": 1.0346386432647705}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1479974, "num_agent_steps_trained": 1479974, "num_env_steps_sampled": 1479974, "num_env_steps_trained": 1479974, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 240.60952625453677, "num_env_steps_trained_throughput_per_sec": 240.60952625453677, "timesteps_total": 1479974, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1479974, "timers": {"training_iteration_time_ms": 58756.369, "sample_time_ms": 43951.492, "load_time_ms": 1699.69, "load_throughput": 9200.501, "learn_time_ms": 12547.839, "learn_throughput": 1246.27, "synch_weights_time_ms": 453.729}, "counters": {"num_env_steps_sampled": 1479974, "num_env_steps_trained": 1479974, "num_agent_steps_sampled": 1479974, "num_agent_steps_trained": 1479974}, "done": false, "episodes_total": 1613, "training_iteration": 115, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-22-08", "timestamp": 1749306128, "time_this_iter_s": 65.01713490486145, "time_total_s": 6397.883574962616, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6397.883574962616, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 79.85890410958905, "ram_util_percent": 58.11917808219178, "gpu_util_percent0": 0.0741095890410959, "vram_util_percent0": 0.8409830729166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.520026e-05, "total_loss": -0.06581095407378267, "policy_loss": -0.0052510224960067055, "vf_loss": 0.01893600611354817, "vf_explained_var": 0.9779489575732838, "kl": 0.017260988298357476, "entropy": 15.602693483179266, "entropy_coeff": 0.004280039}, "model": {}, "num_grad_updates_lifetime": 52475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1495612, "num_env_steps_trained": 1495612, "num_agent_steps_sampled": 1495612, "num_agent_steps_trained": 1495612}, "sampler_results": {"episode_reward_max": 117.39691903861707, "episode_reward_min": 76.54840301060126, "episode_reward_mean": 98.90109573339458, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.00582310257954, 111.80821525047138, 83.96401288874372, 102.45217008671227, 92.45610069845432, 96.51171452900043, 97.79726703696443, 85.58335197890855, 111.42842594819741, 107.61269521693033, 105.55064841860593, 95.95651089584618, 103.00310364785601, 104.11558950399906, 108.9480235491581, 117.39691903861707, 79.84085526801641, 95.93088428966914, 93.84720479176269, 91.83016434759332, 97.96121247506218, 83.26515500617491, 114.45946040835015, 104.93265583461016, 102.58398444365822, 94.74073282856922, 106.87147519765331, 110.3856526384442, 104.41242303088553, 112.62046149164338, 78.95255162995079, 105.49347650910522, 88.73355391685357, 96.26092283001502, 93.0880932946162, 87.64175630761137, 108.62948575153366, 109.10939750883331, 102.40090897680928, 92.707021719402, 103.01897526170617, 107.57893721313107, 104.46320155356364, 116.40846916091901, 85.49511987364305, 107.96368489893939, 90.15415531735758, 87.85282802773231, 92.89572179156609, 85.72417029941495, 111.74568573790596, 99.29163840570276, 95.59830827702127, 92.83499488945748, 102.28108421696732, 97.53869992164826, 106.55094936522134, 116.69316840076561, 82.50985198655714, 104.19703359959753, 90.24071806591114, 96.0891253131859, 99.13331279837746, 78.13555551053847, 103.71904218303571, 103.61213601477792, 94.23508992892127, 92.68930389314453, 98.57287284077826, 107.26095475421798, 102.08703578161118, 113.53790657529667, 76.54840301060126, 102.28277124111239, 95.37596442223011, 95.24162776607754, 97.04047465763533, 86.09968929401423, 110.43215776628031, 104.26809288286417, 93.00984764262921, 82.10929845769903, 107.35479574094957, 103.01719383109875, 98.27079042830682, 110.71383711844997, 84.75354132823118, 87.32691834614164, 88.46259442590093, 101.17424934779794, 90.68661383714142, 83.35683049949998, 111.58175599668655, 105.43457197675346, 103.39644902189607, 96.55686316438438, 94.90522394373868, 108.7233877993138, 101.21447572576199, 117.37135951977996], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.58622899150527, "mean_inference_ms": 8.029156447955248, "mean_action_processing_ms": 0.5485818203261803, "mean_env_wait_ms": 23.203015596228852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04116320610046387, "StateBufferConnector_ms": 0.03918194770812988, "ViewRequirementAgentConnector_ms": 1.0275297164916992}}, "episode_reward_max": 117.39691903861707, "episode_reward_min": 76.54840301060126, "episode_reward_mean": 98.90109573339458, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [102.00582310257954, 111.80821525047138, 83.96401288874372, 102.45217008671227, 92.45610069845432, 96.51171452900043, 97.79726703696443, 85.58335197890855, 111.42842594819741, 107.61269521693033, 105.55064841860593, 95.95651089584618, 103.00310364785601, 104.11558950399906, 108.9480235491581, 117.39691903861707, 79.84085526801641, 95.93088428966914, 93.84720479176269, 91.83016434759332, 97.96121247506218, 83.26515500617491, 114.45946040835015, 104.93265583461016, 102.58398444365822, 94.74073282856922, 106.87147519765331, 110.3856526384442, 104.41242303088553, 112.62046149164338, 78.95255162995079, 105.49347650910522, 88.73355391685357, 96.26092283001502, 93.0880932946162, 87.64175630761137, 108.62948575153366, 109.10939750883331, 102.40090897680928, 92.707021719402, 103.01897526170617, 107.57893721313107, 104.46320155356364, 116.40846916091901, 85.49511987364305, 107.96368489893939, 90.15415531735758, 87.85282802773231, 92.89572179156609, 85.72417029941495, 111.74568573790596, 99.29163840570276, 95.59830827702127, 92.83499488945748, 102.28108421696732, 97.53869992164826, 106.55094936522134, 116.69316840076561, 82.50985198655714, 104.19703359959753, 90.24071806591114, 96.0891253131859, 99.13331279837746, 78.13555551053847, 103.71904218303571, 103.61213601477792, 94.23508992892127, 92.68930389314453, 98.57287284077826, 107.26095475421798, 102.08703578161118, 113.53790657529667, 76.54840301060126, 102.28277124111239, 95.37596442223011, 95.24162776607754, 97.04047465763533, 86.09968929401423, 110.43215776628031, 104.26809288286417, 93.00984764262921, 82.10929845769903, 107.35479574094957, 103.01719383109875, 98.27079042830682, 110.71383711844997, 84.75354132823118, 87.32691834614164, 88.46259442590093, 101.17424934779794, 90.68661383714142, 83.35683049949998, 111.58175599668655, 105.43457197675346, 103.39644902189607, 96.55686316438438, 94.90522394373868, 108.7233877993138, 101.21447572576199, 117.37135951977996], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.58622899150527, "mean_inference_ms": 8.029156447955248, "mean_action_processing_ms": 0.5485818203261803, "mean_env_wait_ms": 23.203015596228852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04116320610046387, "StateBufferConnector_ms": 0.03918194770812988, "ViewRequirementAgentConnector_ms": 1.0275297164916992}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1495612, "num_agent_steps_trained": 1495612, "num_env_steps_sampled": 1495612, "num_env_steps_trained": 1495612, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 264.8533247749663, "num_env_steps_trained_throughput_per_sec": 264.8533247749663, "timesteps_total": 1495612, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1495612, "timers": {"training_iteration_time_ms": 59018.487, "sample_time_ms": 44147.49, "load_time_ms": 1738.67, "load_throughput": 8994.232, "learn_time_ms": 12568.47, "learn_throughput": 1244.225, "synch_weights_time_ms": 457.739}, "counters": {"num_env_steps_sampled": 1495612, "num_env_steps_trained": 1495612, "num_agent_steps_sampled": 1495612, "num_agent_steps_trained": 1495612}, "done": false, "episodes_total": 1627, "training_iteration": 116, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-23-07", "timestamp": 1749306187, "time_this_iter_s": 59.06719660758972, "time_total_s": 6456.950771570206, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6456.950771570206, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 77.03235294117647, "ram_util_percent": 57.82941176470588, "gpu_util_percent0": 0.08220588235294118, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.504388e-05, "total_loss": -0.06774799126793038, "policy_loss": -0.007444663809146732, "vf_loss": 0.017394513951572165, "vf_explained_var": 0.977357579794797, "kl": 0.018387158349139378, "entropy": 15.528018106980758, "entropy_coeff": 0.004256582000000001}, "model": {}, "num_grad_updates_lifetime": 53025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1511250, "num_env_steps_trained": 1511250, "num_agent_steps_sampled": 1511250, "num_agent_steps_trained": 1511250}, "sampler_results": {"episode_reward_max": 117.39691903861707, "episode_reward_min": 76.54840301060126, "episode_reward_mean": 98.5062083097003, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.9480235491581, 117.39691903861707, 79.84085526801641, 95.93088428966914, 93.84720479176269, 91.83016434759332, 97.96121247506218, 83.26515500617491, 114.45946040835015, 104.93265583461016, 102.58398444365822, 94.74073282856922, 106.87147519765331, 110.3856526384442, 104.41242303088553, 112.62046149164338, 78.95255162995079, 105.49347650910522, 88.73355391685357, 96.26092283001502, 93.0880932946162, 87.64175630761137, 108.62948575153366, 109.10939750883331, 102.40090897680928, 92.707021719402, 103.01897526170617, 107.57893721313107, 104.46320155356364, 116.40846916091901, 85.49511987364305, 107.96368489893939, 90.15415531735758, 87.85282802773231, 92.89572179156609, 85.72417029941495, 111.74568573790596, 99.29163840570276, 95.59830827702127, 92.83499488945748, 102.28108421696732, 97.53869992164826, 106.55094936522134, 116.69316840076561, 82.50985198655714, 104.19703359959753, 90.24071806591114, 96.0891253131859, 99.13331279837746, 78.13555551053847, 103.71904218303571, 103.61213601477792, 94.23508992892127, 92.68930389314453, 98.57287284077826, 107.26095475421798, 102.08703578161118, 113.53790657529667, 76.54840301060126, 102.28277124111239, 95.37596442223011, 95.24162776607754, 97.04047465763533, 86.09968929401423, 110.43215776628031, 104.26809288286417, 93.00984764262921, 82.10929845769903, 107.35479574094957, 103.01719383109875, 98.27079042830682, 110.71383711844997, 84.75354132823118, 87.32691834614164, 88.46259442590093, 101.17424934779794, 90.68661383714142, 83.35683049949998, 111.58175599668655, 105.43457197675346, 103.39644902189607, 96.55686316438438, 94.90522394373868, 108.7233877993138, 101.21447572576199, 117.37135951977996, 76.9609623466973, 99.7762485521057, 88.16043733733098, 93.83390201528006, 99.40369695446292, 77.07712376941437, 109.35228284671607, 98.54562564775694, 99.16244376182993, 90.82963431736832, 108.21409947175464, 106.98775295953396, 101.34804108009422, 111.104635773495], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.590547662106008, "mean_inference_ms": 8.040593373002578, "mean_action_processing_ms": 0.5493324384380246, "mean_env_wait_ms": 23.22657538792193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041595458984375, "StateBufferConnector_ms": 0.03711962699890137, "ViewRequirementAgentConnector_ms": 1.0247523784637451}}, "episode_reward_max": 117.39691903861707, "episode_reward_min": 76.54840301060126, "episode_reward_mean": 98.5062083097003, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [108.9480235491581, 117.39691903861707, 79.84085526801641, 95.93088428966914, 93.84720479176269, 91.83016434759332, 97.96121247506218, 83.26515500617491, 114.45946040835015, 104.93265583461016, 102.58398444365822, 94.74073282856922, 106.87147519765331, 110.3856526384442, 104.41242303088553, 112.62046149164338, 78.95255162995079, 105.49347650910522, 88.73355391685357, 96.26092283001502, 93.0880932946162, 87.64175630761137, 108.62948575153366, 109.10939750883331, 102.40090897680928, 92.707021719402, 103.01897526170617, 107.57893721313107, 104.46320155356364, 116.40846916091901, 85.49511987364305, 107.96368489893939, 90.15415531735758, 87.85282802773231, 92.89572179156609, 85.72417029941495, 111.74568573790596, 99.29163840570276, 95.59830827702127, 92.83499488945748, 102.28108421696732, 97.53869992164826, 106.55094936522134, 116.69316840076561, 82.50985198655714, 104.19703359959753, 90.24071806591114, 96.0891253131859, 99.13331279837746, 78.13555551053847, 103.71904218303571, 103.61213601477792, 94.23508992892127, 92.68930389314453, 98.57287284077826, 107.26095475421798, 102.08703578161118, 113.53790657529667, 76.54840301060126, 102.28277124111239, 95.37596442223011, 95.24162776607754, 97.04047465763533, 86.09968929401423, 110.43215776628031, 104.26809288286417, 93.00984764262921, 82.10929845769903, 107.35479574094957, 103.01719383109875, 98.27079042830682, 110.71383711844997, 84.75354132823118, 87.32691834614164, 88.46259442590093, 101.17424934779794, 90.68661383714142, 83.35683049949998, 111.58175599668655, 105.43457197675346, 103.39644902189607, 96.55686316438438, 94.90522394373868, 108.7233877993138, 101.21447572576199, 117.37135951977996, 76.9609623466973, 99.7762485521057, 88.16043733733098, 93.83390201528006, 99.40369695446292, 77.07712376941437, 109.35228284671607, 98.54562564775694, 99.16244376182993, 90.82963431736832, 108.21409947175464, 106.98775295953396, 101.34804108009422, 111.104635773495], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.590547662106008, "mean_inference_ms": 8.040593373002578, "mean_action_processing_ms": 0.5493324384380246, "mean_env_wait_ms": 23.22657538792193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041595458984375, "StateBufferConnector_ms": 0.03711962699890137, "ViewRequirementAgentConnector_ms": 1.0247523784637451}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1511250, "num_agent_steps_trained": 1511250, "num_env_steps_sampled": 1511250, "num_env_steps_trained": 1511250, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 265.8419375526935, "num_env_steps_trained_throughput_per_sec": 265.8419375526935, "timesteps_total": 1511250, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1511250, "timers": {"training_iteration_time_ms": 59171.307, "sample_time_ms": 44293.468, "load_time_ms": 1753.438, "load_throughput": 8918.478, "learn_time_ms": 12553.901, "learn_throughput": 1245.669, "synch_weights_time_ms": 461.798}, "counters": {"num_env_steps_sampled": 1511250, "num_env_steps_trained": 1511250, "num_agent_steps_sampled": 1511250, "num_agent_steps_trained": 1511250}, "done": false, "episodes_total": 1641, "training_iteration": 117, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-24-06", "timestamp": 1749306246, "time_this_iter_s": 58.844430685043335, "time_total_s": 6515.795202255249, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6515.795202255249, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 77.11343283582089, "ram_util_percent": 57.52835820895523, "gpu_util_percent0": 0.08686567164179104, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.488750000000002e-05, "total_loss": -0.039642478982833296, "policy_loss": 0.02052000123076141, "vf_loss": 0.015807864799968558, "vf_explained_var": 0.9774606620181691, "kl": 0.01823521055662457, "entropy": 15.467222284837202, "entropy_coeff": 0.004233124999999999}, "model": {}, "num_grad_updates_lifetime": 53575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1526888, "num_env_steps_trained": 1526888, "num_agent_steps_sampled": 1526888, "num_agent_steps_trained": 1526888}, "sampler_results": {"episode_reward_max": 117.37135951977996, "episode_reward_min": 76.54840301060126, "episode_reward_mean": 98.23011972026967, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.41242303088553, 112.62046149164338, 78.95255162995079, 105.49347650910522, 88.73355391685357, 96.26092283001502, 93.0880932946162, 87.64175630761137, 108.62948575153366, 109.10939750883331, 102.40090897680928, 92.707021719402, 103.01897526170617, 107.57893721313107, 104.46320155356364, 116.40846916091901, 85.49511987364305, 107.96368489893939, 90.15415531735758, 87.85282802773231, 92.89572179156609, 85.72417029941495, 111.74568573790596, 99.29163840570276, 95.59830827702127, 92.83499488945748, 102.28108421696732, 97.53869992164826, 106.55094936522134, 116.69316840076561, 82.50985198655714, 104.19703359959753, 90.24071806591114, 96.0891253131859, 99.13331279837746, 78.13555551053847, 103.71904218303571, 103.61213601477792, 94.23508992892127, 92.68930389314453, 98.57287284077826, 107.26095475421798, 102.08703578161118, 113.53790657529667, 76.54840301060126, 102.28277124111239, 95.37596442223011, 95.24162776607754, 97.04047465763533, 86.09968929401423, 110.43215776628031, 104.26809288286417, 93.00984764262921, 82.10929845769903, 107.35479574094957, 103.01719383109875, 98.27079042830682, 110.71383711844997, 84.75354132823118, 87.32691834614164, 88.46259442590093, 101.17424934779794, 90.68661383714142, 83.35683049949998, 111.58175599668655, 105.43457197675346, 103.39644902189607, 96.55686316438438, 94.90522394373868, 108.7233877993138, 101.21447572576199, 117.37135951977996, 76.9609623466973, 99.7762485521057, 88.16043733733098, 93.83390201528006, 99.40369695446292, 77.07712376941437, 109.35228284671607, 98.54562564775694, 99.16244376182993, 90.82963431736832, 108.21409947175464, 106.98775295953396, 101.34804108009422, 111.104635773495, 81.80532025849547, 100.28310694117766, 81.95029272010167, 97.3220007980824, 94.3061113964812, 85.75499596581106, 104.40841361171876, 106.57721367666454, 104.22500984470001, 92.88587878526842, 100.93269623163103, 109.71517732153828, 100.65261279436675, 114.56669082823697], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.595030970954461, "mean_inference_ms": 8.0523317331682, "mean_action_processing_ms": 0.5501002082449749, "mean_env_wait_ms": 23.250963303908524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03856611251831055, "StateBufferConnector_ms": 0.03808426856994629, "ViewRequirementAgentConnector_ms": 1.034299373626709}}, "episode_reward_max": 117.37135951977996, "episode_reward_min": 76.54840301060126, "episode_reward_mean": 98.23011972026967, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [104.41242303088553, 112.62046149164338, 78.95255162995079, 105.49347650910522, 88.73355391685357, 96.26092283001502, 93.0880932946162, 87.64175630761137, 108.62948575153366, 109.10939750883331, 102.40090897680928, 92.707021719402, 103.01897526170617, 107.57893721313107, 104.46320155356364, 116.40846916091901, 85.49511987364305, 107.96368489893939, 90.15415531735758, 87.85282802773231, 92.89572179156609, 85.72417029941495, 111.74568573790596, 99.29163840570276, 95.59830827702127, 92.83499488945748, 102.28108421696732, 97.53869992164826, 106.55094936522134, 116.69316840076561, 82.50985198655714, 104.19703359959753, 90.24071806591114, 96.0891253131859, 99.13331279837746, 78.13555551053847, 103.71904218303571, 103.61213601477792, 94.23508992892127, 92.68930389314453, 98.57287284077826, 107.26095475421798, 102.08703578161118, 113.53790657529667, 76.54840301060126, 102.28277124111239, 95.37596442223011, 95.24162776607754, 97.04047465763533, 86.09968929401423, 110.43215776628031, 104.26809288286417, 93.00984764262921, 82.10929845769903, 107.35479574094957, 103.01719383109875, 98.27079042830682, 110.71383711844997, 84.75354132823118, 87.32691834614164, 88.46259442590093, 101.17424934779794, 90.68661383714142, 83.35683049949998, 111.58175599668655, 105.43457197675346, 103.39644902189607, 96.55686316438438, 94.90522394373868, 108.7233877993138, 101.21447572576199, 117.37135951977996, 76.9609623466973, 99.7762485521057, 88.16043733733098, 93.83390201528006, 99.40369695446292, 77.07712376941437, 109.35228284671607, 98.54562564775694, 99.16244376182993, 90.82963431736832, 108.21409947175464, 106.98775295953396, 101.34804108009422, 111.104635773495, 81.80532025849547, 100.28310694117766, 81.95029272010167, 97.3220007980824, 94.3061113964812, 85.75499596581106, 104.40841361171876, 106.57721367666454, 104.22500984470001, 92.88587878526842, 100.93269623163103, 109.71517732153828, 100.65261279436675, 114.56669082823697], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.595030970954461, "mean_inference_ms": 8.0523317331682, "mean_action_processing_ms": 0.5501002082449749, "mean_env_wait_ms": 23.250963303908524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03856611251831055, "StateBufferConnector_ms": 0.03808426856994629, "ViewRequirementAgentConnector_ms": 1.034299373626709}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1526888, "num_agent_steps_trained": 1526888, "num_env_steps_sampled": 1526888, "num_env_steps_trained": 1526888, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 263.32005056587644, "num_env_steps_trained_throughput_per_sec": 263.32005056587644, "timesteps_total": 1526888, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1526888, "timers": {"training_iteration_time_ms": 59357.134, "sample_time_ms": 44444.897, "load_time_ms": 1759.025, "load_throughput": 8890.154, "learn_time_ms": 12561.632, "learn_throughput": 1244.902, "synch_weights_time_ms": 476.253}, "counters": {"num_env_steps_sampled": 1526888, "num_env_steps_trained": 1526888, "num_agent_steps_sampled": 1526888, "num_agent_steps_trained": 1526888}, "done": false, "episodes_total": 1655, "training_iteration": 118, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-25-06", "timestamp": 1749306306, "time_this_iter_s": 59.407817363739014, "time_total_s": 6575.203019618988, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6575.203019618988, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 76.47101449275361, "ram_util_percent": 58.06956521739129, "gpu_util_percent0": 0.08217391304347828, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.473112e-05, "total_loss": -0.04252286591397768, "policy_loss": 0.016671941677896856, "vf_loss": 0.01712065669813786, "vf_explained_var": 0.9776753434267911, "kl": 0.01789256974914908, "entropy": 15.414552914012562, "entropy_coeff": 0.004209668}, "model": {}, "num_grad_updates_lifetime": 54125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1542526, "num_env_steps_trained": 1542526, "num_agent_steps_sampled": 1542526, "num_agent_steps_trained": 1542526}, "sampler_results": {"episode_reward_max": 117.37135951977996, "episode_reward_min": 76.54840301060126, "episode_reward_mean": 97.8067427522774, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.46320155356364, 116.40846916091901, 85.49511987364305, 107.96368489893939, 90.15415531735758, 87.85282802773231, 92.89572179156609, 85.72417029941495, 111.74568573790596, 99.29163840570276, 95.59830827702127, 92.83499488945748, 102.28108421696732, 97.53869992164826, 106.55094936522134, 116.69316840076561, 82.50985198655714, 104.19703359959753, 90.24071806591114, 96.0891253131859, 99.13331279837746, 78.13555551053847, 103.71904218303571, 103.61213601477792, 94.23508992892127, 92.68930389314453, 98.57287284077826, 107.26095475421798, 102.08703578161118, 113.53790657529667, 76.54840301060126, 102.28277124111239, 95.37596442223011, 95.24162776607754, 97.04047465763533, 86.09968929401423, 110.43215776628031, 104.26809288286417, 93.00984764262921, 82.10929845769903, 107.35479574094957, 103.01719383109875, 98.27079042830682, 110.71383711844997, 84.75354132823118, 87.32691834614164, 88.46259442590093, 101.17424934779794, 90.68661383714142, 83.35683049949998, 111.58175599668655, 105.43457197675346, 103.39644902189607, 96.55686316438438, 94.90522394373868, 108.7233877993138, 101.21447572576199, 117.37135951977996, 76.9609623466973, 99.7762485521057, 88.16043733733098, 93.83390201528006, 99.40369695446292, 77.07712376941437, 109.35228284671607, 98.54562564775694, 99.16244376182993, 90.82963431736832, 108.21409947175464, 106.98775295953396, 101.34804108009422, 111.104635773495, 81.80532025849547, 100.28310694117766, 81.95029272010167, 97.3220007980824, 94.3061113964812, 85.75499596581106, 104.40841361171876, 106.57721367666454, 104.22500984470001, 92.88587878526842, 100.93269623163103, 109.71517732153828, 100.65261279436675, 114.56669082823697, 80.19620455485115, 103.69329432432855, 86.6012492424723, 90.04334438260003, 98.16120929098724, 80.77155420812609, 108.43454677837967, 99.77833950201365, 98.07645049306295, 88.22939836346526, 98.39044264232916, 110.10723108370443, 95.67150961043582, 110.15549416611563], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5993324452609254, "mean_inference_ms": 8.064457529869914, "mean_action_processing_ms": 0.550878581769507, "mean_env_wait_ms": 23.275941495763547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04654431343078613, "StateBufferConnector_ms": 0.037090301513671875, "ViewRequirementAgentConnector_ms": 1.0205974578857422}}, "episode_reward_max": 117.37135951977996, "episode_reward_min": 76.54840301060126, "episode_reward_mean": 97.8067427522774, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [104.46320155356364, 116.40846916091901, 85.49511987364305, 107.96368489893939, 90.15415531735758, 87.85282802773231, 92.89572179156609, 85.72417029941495, 111.74568573790596, 99.29163840570276, 95.59830827702127, 92.83499488945748, 102.28108421696732, 97.53869992164826, 106.55094936522134, 116.69316840076561, 82.50985198655714, 104.19703359959753, 90.24071806591114, 96.0891253131859, 99.13331279837746, 78.13555551053847, 103.71904218303571, 103.61213601477792, 94.23508992892127, 92.68930389314453, 98.57287284077826, 107.26095475421798, 102.08703578161118, 113.53790657529667, 76.54840301060126, 102.28277124111239, 95.37596442223011, 95.24162776607754, 97.04047465763533, 86.09968929401423, 110.43215776628031, 104.26809288286417, 93.00984764262921, 82.10929845769903, 107.35479574094957, 103.01719383109875, 98.27079042830682, 110.71383711844997, 84.75354132823118, 87.32691834614164, 88.46259442590093, 101.17424934779794, 90.68661383714142, 83.35683049949998, 111.58175599668655, 105.43457197675346, 103.39644902189607, 96.55686316438438, 94.90522394373868, 108.7233877993138, 101.21447572576199, 117.37135951977996, 76.9609623466973, 99.7762485521057, 88.16043733733098, 93.83390201528006, 99.40369695446292, 77.07712376941437, 109.35228284671607, 98.54562564775694, 99.16244376182993, 90.82963431736832, 108.21409947175464, 106.98775295953396, 101.34804108009422, 111.104635773495, 81.80532025849547, 100.28310694117766, 81.95029272010167, 97.3220007980824, 94.3061113964812, 85.75499596581106, 104.40841361171876, 106.57721367666454, 104.22500984470001, 92.88587878526842, 100.93269623163103, 109.71517732153828, 100.65261279436675, 114.56669082823697, 80.19620455485115, 103.69329432432855, 86.6012492424723, 90.04334438260003, 98.16120929098724, 80.77155420812609, 108.43454677837967, 99.77833950201365, 98.07645049306295, 88.22939836346526, 98.39044264232916, 110.10723108370443, 95.67150961043582, 110.15549416611563], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5993324452609254, "mean_inference_ms": 8.064457529869914, "mean_action_processing_ms": 0.550878581769507, "mean_env_wait_ms": 23.275941495763547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04654431343078613, "StateBufferConnector_ms": 0.037090301513671875, "ViewRequirementAgentConnector_ms": 1.0205974578857422}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1542526, "num_agent_steps_trained": 1542526, "num_env_steps_sampled": 1542526, "num_env_steps_trained": 1542526, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 266.36686462410853, "num_env_steps_trained_throughput_per_sec": 266.36686462410853, "timesteps_total": 1542526, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1542526, "timers": {"training_iteration_time_ms": 59468.049, "sample_time_ms": 44537.979, "load_time_ms": 1760.645, "load_throughput": 8881.973, "learn_time_ms": 12576.345, "learn_throughput": 1243.446, "synch_weights_time_ms": 476.395}, "counters": {"num_env_steps_sampled": 1542526, "num_env_steps_trained": 1542526, "num_agent_steps_sampled": 1542526, "num_agent_steps_trained": 1542526}, "done": false, "episodes_total": 1669, "training_iteration": 119, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-26-04", "timestamp": 1749306364, "time_this_iter_s": 58.7284996509552, "time_total_s": 6633.931519269943, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6633.931519269943, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 77.32985074626866, "ram_util_percent": 58.05074626865672, "gpu_util_percent0": 0.0853731343283582, "vram_util_percent0": 0.8409830729166666}}
{"evaluation": {"sampler_results": {"episode_reward_max": -0.8809948313401222, "episode_reward_min": -1.92482614325736, "episode_reward_mean": -1.1949028382350424, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.92482614325736, -1.1692081850347968, -1.0792169212938207, -0.8809948313401222, -0.9202681102491118], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7258432742618866, "mean_inference_ms": 3.877978384921262, "mean_action_processing_ms": 0.3012195357744293, "mean_env_wait_ms": 12.52486016717729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019998550415039062, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2602577209472656}}, "episode_reward_max": -0.8809948313401222, "episode_reward_min": -1.92482614325736, "episode_reward_mean": -1.1949028382350424, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.92482614325736, -1.1692081850347968, -1.0792169212938207, -0.8809948313401222, -0.9202681102491118], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7258432742618866, "mean_inference_ms": 3.877978384921262, "mean_action_processing_ms": 0.3012195357744293, "mean_env_wait_ms": 12.52486016717729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019998550415039062, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2602577209472656}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.457474e-05, "total_loss": -0.05507297542348335, "policy_loss": 0.0039986634864048526, "vf_loss": 0.015436512508895248, "vf_explained_var": 0.9782648064873435, "kl": 0.01779760915865712, "entropy": 15.3501018298756, "entropy_coeff": 0.004186211000000001}, "model": {}, "num_grad_updates_lifetime": 54675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1558164, "num_env_steps_trained": 1558164, "num_agent_steps_sampled": 1558164, "num_agent_steps_trained": 1558164}, "sampler_results": {"episode_reward_max": 117.37135951977996, "episode_reward_min": 76.54840301060126, "episode_reward_mean": 97.861805382868, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [106.55094936522134, 116.69316840076561, 82.50985198655714, 104.19703359959753, 90.24071806591114, 96.0891253131859, 99.13331279837746, 78.13555551053847, 103.71904218303571, 103.61213601477792, 94.23508992892127, 92.68930389314453, 98.57287284077826, 107.26095475421798, 102.08703578161118, 113.53790657529667, 76.54840301060126, 102.28277124111239, 95.37596442223011, 95.24162776607754, 97.04047465763533, 86.09968929401423, 110.43215776628031, 104.26809288286417, 93.00984764262921, 82.10929845769903, 107.35479574094957, 103.01719383109875, 98.27079042830682, 110.71383711844997, 84.75354132823118, 87.32691834614164, 88.46259442590093, 101.17424934779794, 90.68661383714142, 83.35683049949998, 111.58175599668655, 105.43457197675346, 103.39644902189607, 96.55686316438438, 94.90522394373868, 108.7233877993138, 101.21447572576199, 117.37135951977996, 76.9609623466973, 99.7762485521057, 88.16043733733098, 93.83390201528006, 99.40369695446292, 77.07712376941437, 109.35228284671607, 98.54562564775694, 99.16244376182993, 90.82963431736832, 108.21409947175464, 106.98775295953396, 101.34804108009422, 111.104635773495, 81.80532025849547, 100.28310694117766, 81.95029272010167, 97.3220007980824, 94.3061113964812, 85.75499596581106, 104.40841361171876, 106.57721367666454, 104.22500984470001, 92.88587878526842, 100.93269623163103, 109.71517732153828, 100.65261279436675, 114.56669082823697, 80.19620455485115, 103.69329432432855, 86.6012492424723, 90.04334438260003, 98.16120929098724, 80.77155420812609, 108.43454677837967, 99.77833950201365, 98.07645049306295, 88.22939836346526, 98.39044264232916, 110.10723108370443, 95.67150961043582, 110.15549416611563, 86.8925209544158, 104.75233563445515, 88.99563825066055, 96.70484575955594, 96.2925676396389, 86.75440719606884, 110.39050102143052, 100.57457485614717, 102.51610066361812, 90.3187677362889, 97.33488133144857, 99.66499173633741, 97.97621693684778, 116.58567571398692], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6038902121643033, "mean_inference_ms": 8.076248629865278, "mean_action_processing_ms": 0.5516305728776415, "mean_env_wait_ms": 23.300607542792328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04244494438171387, "StateBufferConnector_ms": 0.03713655471801758, "ViewRequirementAgentConnector_ms": 0.9919688701629639}}, "episode_reward_max": 117.37135951977996, "episode_reward_min": 76.54840301060126, "episode_reward_mean": 97.861805382868, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [106.55094936522134, 116.69316840076561, 82.50985198655714, 104.19703359959753, 90.24071806591114, 96.0891253131859, 99.13331279837746, 78.13555551053847, 103.71904218303571, 103.61213601477792, 94.23508992892127, 92.68930389314453, 98.57287284077826, 107.26095475421798, 102.08703578161118, 113.53790657529667, 76.54840301060126, 102.28277124111239, 95.37596442223011, 95.24162776607754, 97.04047465763533, 86.09968929401423, 110.43215776628031, 104.26809288286417, 93.00984764262921, 82.10929845769903, 107.35479574094957, 103.01719383109875, 98.27079042830682, 110.71383711844997, 84.75354132823118, 87.32691834614164, 88.46259442590093, 101.17424934779794, 90.68661383714142, 83.35683049949998, 111.58175599668655, 105.43457197675346, 103.39644902189607, 96.55686316438438, 94.90522394373868, 108.7233877993138, 101.21447572576199, 117.37135951977996, 76.9609623466973, 99.7762485521057, 88.16043733733098, 93.83390201528006, 99.40369695446292, 77.07712376941437, 109.35228284671607, 98.54562564775694, 99.16244376182993, 90.82963431736832, 108.21409947175464, 106.98775295953396, 101.34804108009422, 111.104635773495, 81.80532025849547, 100.28310694117766, 81.95029272010167, 97.3220007980824, 94.3061113964812, 85.75499596581106, 104.40841361171876, 106.57721367666454, 104.22500984470001, 92.88587878526842, 100.93269623163103, 109.71517732153828, 100.65261279436675, 114.56669082823697, 80.19620455485115, 103.69329432432855, 86.6012492424723, 90.04334438260003, 98.16120929098724, 80.77155420812609, 108.43454677837967, 99.77833950201365, 98.07645049306295, 88.22939836346526, 98.39044264232916, 110.10723108370443, 95.67150961043582, 110.15549416611563, 86.8925209544158, 104.75233563445515, 88.99563825066055, 96.70484575955594, 96.2925676396389, 86.75440719606884, 110.39050102143052, 100.57457485614717, 102.51610066361812, 90.3187677362889, 97.33488133144857, 99.66499173633741, 97.97621693684778, 116.58567571398692], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6038902121643033, "mean_inference_ms": 8.076248629865278, "mean_action_processing_ms": 0.5516305728776415, "mean_env_wait_ms": 23.300607542792328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04244494438171387, "StateBufferConnector_ms": 0.03713655471801758, "ViewRequirementAgentConnector_ms": 0.9919688701629639}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1558164, "num_agent_steps_trained": 1558164, "num_env_steps_sampled": 1558164, "num_env_steps_trained": 1558164, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 265.8187868569595, "num_env_steps_trained_throughput_per_sec": 265.8187868569595, "timesteps_total": 1558164, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1558164, "timers": {"training_iteration_time_ms": 59540.076, "sample_time_ms": 44581.308, "load_time_ms": 1746.68, "load_throughput": 8952.983, "learn_time_ms": 12610.255, "learn_throughput": 1240.102, "synch_weights_time_ms": 483.181}, "counters": {"num_env_steps_sampled": 1558164, "num_env_steps_trained": 1558164, "num_agent_steps_sampled": 1558164, "num_agent_steps_trained": 1558164}, "done": false, "episodes_total": 1683, "training_iteration": 120, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-27-20", "timestamp": 1749306440, "time_this_iter_s": 75.8327853679657, "time_total_s": 6709.764304637909, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6709.764304637909, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 63.61685393258428, "ram_util_percent": 57.216853932584264, "gpu_util_percent0": 0.07247191011235954, "vram_util_percent0": 0.8409830729166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.441836e-05, "total_loss": -0.059689411788501526, "policy_loss": -0.0007255486940795725, "vf_loss": 0.014737291411623698, "vf_explained_var": 0.9792112896659158, "kl": 0.018390696102581545, "entropy": 15.364771078283136, "entropy_coeff": 0.004162754}, "model": {}, "num_grad_updates_lifetime": 55225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1573802, "num_env_steps_trained": 1573802, "num_agent_steps_sampled": 1573802, "num_agent_steps_trained": 1573802}, "sampler_results": {"episode_reward_max": 117.37135951977996, "episode_reward_min": 76.54840301060126, "episode_reward_mean": 97.87300437482348, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.08703578161118, 113.53790657529667, 76.54840301060126, 102.28277124111239, 95.37596442223011, 95.24162776607754, 97.04047465763533, 86.09968929401423, 110.43215776628031, 104.26809288286417, 93.00984764262921, 82.10929845769903, 107.35479574094957, 103.01719383109875, 98.27079042830682, 110.71383711844997, 84.75354132823118, 87.32691834614164, 88.46259442590093, 101.17424934779794, 90.68661383714142, 83.35683049949998, 111.58175599668655, 105.43457197675346, 103.39644902189607, 96.55686316438438, 94.90522394373868, 108.7233877993138, 101.21447572576199, 117.37135951977996, 76.9609623466973, 99.7762485521057, 88.16043733733098, 93.83390201528006, 99.40369695446292, 77.07712376941437, 109.35228284671607, 98.54562564775694, 99.16244376182993, 90.82963431736832, 108.21409947175464, 106.98775295953396, 101.34804108009422, 111.104635773495, 81.80532025849547, 100.28310694117766, 81.95029272010167, 97.3220007980824, 94.3061113964812, 85.75499596581106, 104.40841361171876, 106.57721367666454, 104.22500984470001, 92.88587878526842, 100.93269623163103, 109.71517732153828, 100.65261279436675, 114.56669082823697, 80.19620455485115, 103.69329432432855, 86.6012492424723, 90.04334438260003, 98.16120929098724, 80.77155420812609, 108.43454677837967, 99.77833950201365, 98.07645049306295, 88.22939836346526, 98.39044264232916, 110.10723108370443, 95.67150961043582, 110.15549416611563, 86.8925209544158, 104.75233563445515, 88.99563825066055, 96.70484575955594, 96.2925676396389, 86.75440719606884, 110.39050102143052, 100.57457485614717, 102.51610066361812, 90.3187677362889, 97.33488133144857, 99.66499173633741, 97.97621693684778, 116.58567571398692, 88.91814824091283, 102.7257482560374, 86.87961871165433, 95.16028877015773, 99.03475647399942, 84.10049994721389, 110.93936580581077, 103.68849176887656, 99.4702350502728, 90.15035993876116, 96.58027319999012, 107.24944986215338, 99.4453309254463, 110.4164468992921], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.608448319657586, "mean_inference_ms": 8.087441718938312, "mean_action_processing_ms": 0.5523395123524806, "mean_env_wait_ms": 23.3230644470233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03939676284790039, "StateBufferConnector_ms": 0.027633190155029297, "ViewRequirementAgentConnector_ms": 0.9901337623596191}}, "episode_reward_max": 117.37135951977996, "episode_reward_min": 76.54840301060126, "episode_reward_mean": 97.87300437482348, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [102.08703578161118, 113.53790657529667, 76.54840301060126, 102.28277124111239, 95.37596442223011, 95.24162776607754, 97.04047465763533, 86.09968929401423, 110.43215776628031, 104.26809288286417, 93.00984764262921, 82.10929845769903, 107.35479574094957, 103.01719383109875, 98.27079042830682, 110.71383711844997, 84.75354132823118, 87.32691834614164, 88.46259442590093, 101.17424934779794, 90.68661383714142, 83.35683049949998, 111.58175599668655, 105.43457197675346, 103.39644902189607, 96.55686316438438, 94.90522394373868, 108.7233877993138, 101.21447572576199, 117.37135951977996, 76.9609623466973, 99.7762485521057, 88.16043733733098, 93.83390201528006, 99.40369695446292, 77.07712376941437, 109.35228284671607, 98.54562564775694, 99.16244376182993, 90.82963431736832, 108.21409947175464, 106.98775295953396, 101.34804108009422, 111.104635773495, 81.80532025849547, 100.28310694117766, 81.95029272010167, 97.3220007980824, 94.3061113964812, 85.75499596581106, 104.40841361171876, 106.57721367666454, 104.22500984470001, 92.88587878526842, 100.93269623163103, 109.71517732153828, 100.65261279436675, 114.56669082823697, 80.19620455485115, 103.69329432432855, 86.6012492424723, 90.04334438260003, 98.16120929098724, 80.77155420812609, 108.43454677837967, 99.77833950201365, 98.07645049306295, 88.22939836346526, 98.39044264232916, 110.10723108370443, 95.67150961043582, 110.15549416611563, 86.8925209544158, 104.75233563445515, 88.99563825066055, 96.70484575955594, 96.2925676396389, 86.75440719606884, 110.39050102143052, 100.57457485614717, 102.51610066361812, 90.3187677362889, 97.33488133144857, 99.66499173633741, 97.97621693684778, 116.58567571398692, 88.91814824091283, 102.7257482560374, 86.87961871165433, 95.16028877015773, 99.03475647399942, 84.10049994721389, 110.93936580581077, 103.68849176887656, 99.4702350502728, 90.15035993876116, 96.58027319999012, 107.24944986215338, 99.4453309254463, 110.4164468992921], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.608448319657586, "mean_inference_ms": 8.087441718938312, "mean_action_processing_ms": 0.5523395123524806, "mean_env_wait_ms": 23.3230644470233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03939676284790039, "StateBufferConnector_ms": 0.027633190155029297, "ViewRequirementAgentConnector_ms": 0.9901337623596191}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1573802, "num_agent_steps_trained": 1573802, "num_env_steps_sampled": 1573802, "num_env_steps_trained": 1573802, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 267.6567024059292, "num_env_steps_trained_throughput_per_sec": 267.6567024059292, "timesteps_total": 1573802, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1573802, "timers": {"training_iteration_time_ms": 59635.902, "sample_time_ms": 44661.182, "load_time_ms": 1745.6, "load_throughput": 8958.526, "learn_time_ms": 12617.527, "learn_throughput": 1239.387, "synch_weights_time_ms": 490.818}, "counters": {"num_env_steps_sampled": 1573802, "num_env_steps_trained": 1573802, "num_agent_steps_sampled": 1573802, "num_agent_steps_trained": 1573802}, "done": false, "episodes_total": 1697, "training_iteration": 121, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-28-19", "timestamp": 1749306499, "time_this_iter_s": 58.44660806655884, "time_total_s": 6768.210912704468, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6768.210912704468, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 76.71492537313432, "ram_util_percent": 57.71492537313433, "gpu_util_percent0": 0.08149253731343284, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.426197999999999e-05, "total_loss": -0.05159412313930013, "policy_loss": 0.007070470200004903, "vf_loss": 0.01580519676208496, "vf_explained_var": 0.9775039707530628, "kl": 0.017803769578620406, "entropy": 15.452507433457807, "entropy_coeff": 0.004139297}, "model": {}, "num_grad_updates_lifetime": 55775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1589440, "num_env_steps_trained": 1589440, "num_agent_steps_sampled": 1589440, "num_agent_steps_trained": 1589440}, "sampler_results": {"episode_reward_max": 117.37135951977996, "episode_reward_min": 76.9609623466973, "episode_reward_mean": 97.6738056265045, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.27079042830682, 110.71383711844997, 84.75354132823118, 87.32691834614164, 88.46259442590093, 101.17424934779794, 90.68661383714142, 83.35683049949998, 111.58175599668655, 105.43457197675346, 103.39644902189607, 96.55686316438438, 94.90522394373868, 108.7233877993138, 101.21447572576199, 117.37135951977996, 76.9609623466973, 99.7762485521057, 88.16043733733098, 93.83390201528006, 99.40369695446292, 77.07712376941437, 109.35228284671607, 98.54562564775694, 99.16244376182993, 90.82963431736832, 108.21409947175464, 106.98775295953396, 101.34804108009422, 111.104635773495, 81.80532025849547, 100.28310694117766, 81.95029272010167, 97.3220007980824, 94.3061113964812, 85.75499596581106, 104.40841361171876, 106.57721367666454, 104.22500984470001, 92.88587878526842, 100.93269623163103, 109.71517732153828, 100.65261279436675, 114.56669082823697, 80.19620455485115, 103.69329432432855, 86.6012492424723, 90.04334438260003, 98.16120929098724, 80.77155420812609, 108.43454677837967, 99.77833950201365, 98.07645049306295, 88.22939836346526, 98.39044264232916, 110.10723108370443, 95.67150961043582, 110.15549416611563, 86.8925209544158, 104.75233563445515, 88.99563825066055, 96.70484575955594, 96.2925676396389, 86.75440719606884, 110.39050102143052, 100.57457485614717, 102.51610066361812, 90.3187677362889, 97.33488133144857, 99.66499173633741, 97.97621693684778, 116.58567571398692, 88.91814824091283, 102.7257482560374, 86.87961871165433, 95.16028877015773, 99.03475647399942, 84.10049994721389, 110.93936580581077, 103.68849176887656, 99.4702350502728, 90.15035993876116, 96.58027319999012, 107.24944986215338, 99.4453309254463, 110.4164468992921, 83.26070094024303, 104.35019182818735, 82.19200941742767, 98.0513196548287, 91.67312461348664, 79.29025145380122, 111.01052491847645, 94.47978928944379, 97.39592765667234, 89.66840932794346, 99.96674244661904, 109.39215874020282, 98.60919608369225, 109.14503786717663], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.612409497644577, "mean_inference_ms": 8.096298110005089, "mean_action_processing_ms": 0.5529181171857, "mean_env_wait_ms": 23.341175265373348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03812980651855469, "StateBufferConnector_ms": 0.03145909309387207, "ViewRequirementAgentConnector_ms": 0.9739336967468262}}, "episode_reward_max": 117.37135951977996, "episode_reward_min": 76.9609623466973, "episode_reward_mean": 97.6738056265045, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [98.27079042830682, 110.71383711844997, 84.75354132823118, 87.32691834614164, 88.46259442590093, 101.17424934779794, 90.68661383714142, 83.35683049949998, 111.58175599668655, 105.43457197675346, 103.39644902189607, 96.55686316438438, 94.90522394373868, 108.7233877993138, 101.21447572576199, 117.37135951977996, 76.9609623466973, 99.7762485521057, 88.16043733733098, 93.83390201528006, 99.40369695446292, 77.07712376941437, 109.35228284671607, 98.54562564775694, 99.16244376182993, 90.82963431736832, 108.21409947175464, 106.98775295953396, 101.34804108009422, 111.104635773495, 81.80532025849547, 100.28310694117766, 81.95029272010167, 97.3220007980824, 94.3061113964812, 85.75499596581106, 104.40841361171876, 106.57721367666454, 104.22500984470001, 92.88587878526842, 100.93269623163103, 109.71517732153828, 100.65261279436675, 114.56669082823697, 80.19620455485115, 103.69329432432855, 86.6012492424723, 90.04334438260003, 98.16120929098724, 80.77155420812609, 108.43454677837967, 99.77833950201365, 98.07645049306295, 88.22939836346526, 98.39044264232916, 110.10723108370443, 95.67150961043582, 110.15549416611563, 86.8925209544158, 104.75233563445515, 88.99563825066055, 96.70484575955594, 96.2925676396389, 86.75440719606884, 110.39050102143052, 100.57457485614717, 102.51610066361812, 90.3187677362889, 97.33488133144857, 99.66499173633741, 97.97621693684778, 116.58567571398692, 88.91814824091283, 102.7257482560374, 86.87961871165433, 95.16028877015773, 99.03475647399942, 84.10049994721389, 110.93936580581077, 103.68849176887656, 99.4702350502728, 90.15035993876116, 96.58027319999012, 107.24944986215338, 99.4453309254463, 110.4164468992921, 83.26070094024303, 104.35019182818735, 82.19200941742767, 98.0513196548287, 91.67312461348664, 79.29025145380122, 111.01052491847645, 94.47978928944379, 97.39592765667234, 89.66840932794346, 99.96674244661904, 109.39215874020282, 98.60919608369225, 109.14503786717663], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.612409497644577, "mean_inference_ms": 8.096298110005089, "mean_action_processing_ms": 0.5529181171857, "mean_env_wait_ms": 23.341175265373348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03812980651855469, "StateBufferConnector_ms": 0.03145909309387207, "ViewRequirementAgentConnector_ms": 0.9739336967468262}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1589440, "num_agent_steps_trained": 1589440, "num_env_steps_sampled": 1589440, "num_env_steps_trained": 1589440, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 268.4407172869987, "num_env_steps_trained_throughput_per_sec": 268.4407172869987, "timesteps_total": 1589440, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1589440, "timers": {"training_iteration_time_ms": 59685.756, "sample_time_ms": 44729.425, "load_time_ms": 1751.331, "load_throughput": 8929.208, "learn_time_ms": 12593.887, "learn_throughput": 1241.714, "synch_weights_time_ms": 488.785}, "counters": {"num_env_steps_sampled": 1589440, "num_env_steps_trained": 1589440, "num_agent_steps_sampled": 1589440, "num_agent_steps_trained": 1589440}, "done": false, "episodes_total": 1711, "training_iteration": 122, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-29-17", "timestamp": 1749306557, "time_this_iter_s": 58.25976514816284, "time_total_s": 6826.470677852631, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6826.470677852631, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 76.9089552238806, "ram_util_percent": 57.80597014925372, "gpu_util_percent0": 0.08477611940298509, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.410559999999998e-05, "total_loss": -0.053031327891248196, "policy_loss": 0.005041144299744205, "vf_loss": 0.01645593704528768, "vf_explained_var": 0.9773747725920243, "kl": 0.017836737181671943, "entropy": 15.444394097761675, "entropy_coeff": 0.00411584}, "model": {}, "num_grad_updates_lifetime": 56325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1605078, "num_env_steps_trained": 1605078, "num_agent_steps_sampled": 1605078, "num_agent_steps_trained": 1605078}, "sampler_results": {"episode_reward_max": 117.37135951977996, "episode_reward_min": 76.9609623466973, "episode_reward_mean": 97.52880800421124, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.21447572576199, 117.37135951977996, 76.9609623466973, 99.7762485521057, 88.16043733733098, 93.83390201528006, 99.40369695446292, 77.07712376941437, 109.35228284671607, 98.54562564775694, 99.16244376182993, 90.82963431736832, 108.21409947175464, 106.98775295953396, 101.34804108009422, 111.104635773495, 81.80532025849547, 100.28310694117766, 81.95029272010167, 97.3220007980824, 94.3061113964812, 85.75499596581106, 104.40841361171876, 106.57721367666454, 104.22500984470001, 92.88587878526842, 100.93269623163103, 109.71517732153828, 100.65261279436675, 114.56669082823697, 80.19620455485115, 103.69329432432855, 86.6012492424723, 90.04334438260003, 98.16120929098724, 80.77155420812609, 108.43454677837967, 99.77833950201365, 98.07645049306295, 88.22939836346526, 98.39044264232916, 110.10723108370443, 95.67150961043582, 110.15549416611563, 86.8925209544158, 104.75233563445515, 88.99563825066055, 96.70484575955594, 96.2925676396389, 86.75440719606884, 110.39050102143052, 100.57457485614717, 102.51610066361812, 90.3187677362889, 97.33488133144857, 99.66499173633741, 97.97621693684778, 116.58567571398692, 88.91814824091283, 102.7257482560374, 86.87961871165433, 95.16028877015773, 99.03475647399942, 84.10049994721389, 110.93936580581077, 103.68849176887656, 99.4702350502728, 90.15035993876116, 96.58027319999012, 107.24944986215338, 99.4453309254463, 110.4164468992921, 83.26070094024303, 104.35019182818735, 82.19200941742767, 98.0513196548287, 91.67312461348664, 79.29025145380122, 111.01052491847645, 94.47978928944379, 97.39592765667234, 89.66840932794346, 99.96674244661904, 109.39215874020282, 98.60919608369225, 109.14503786717663, 80.28107926431163, 101.22129793799648, 90.73484840186188, 95.97090381615111, 95.59560853388872, 81.12544046352745, 102.19034569224898, 97.96799114322455, 104.41733960393385, 88.21476265899223, 103.35243477138766, 108.50875210581495, 94.817072822405, 106.44598778916999], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6161163580401365, "mean_inference_ms": 8.10441457988883, "mean_action_processing_ms": 0.5534580293900704, "mean_env_wait_ms": 23.35845522421789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0358424186706543, "StateBufferConnector_ms": 0.032918691635131836, "ViewRequirementAgentConnector_ms": 0.9798412322998047}}, "episode_reward_max": 117.37135951977996, "episode_reward_min": 76.9609623466973, "episode_reward_mean": 97.52880800421124, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [101.21447572576199, 117.37135951977996, 76.9609623466973, 99.7762485521057, 88.16043733733098, 93.83390201528006, 99.40369695446292, 77.07712376941437, 109.35228284671607, 98.54562564775694, 99.16244376182993, 90.82963431736832, 108.21409947175464, 106.98775295953396, 101.34804108009422, 111.104635773495, 81.80532025849547, 100.28310694117766, 81.95029272010167, 97.3220007980824, 94.3061113964812, 85.75499596581106, 104.40841361171876, 106.57721367666454, 104.22500984470001, 92.88587878526842, 100.93269623163103, 109.71517732153828, 100.65261279436675, 114.56669082823697, 80.19620455485115, 103.69329432432855, 86.6012492424723, 90.04334438260003, 98.16120929098724, 80.77155420812609, 108.43454677837967, 99.77833950201365, 98.07645049306295, 88.22939836346526, 98.39044264232916, 110.10723108370443, 95.67150961043582, 110.15549416611563, 86.8925209544158, 104.75233563445515, 88.99563825066055, 96.70484575955594, 96.2925676396389, 86.75440719606884, 110.39050102143052, 100.57457485614717, 102.51610066361812, 90.3187677362889, 97.33488133144857, 99.66499173633741, 97.97621693684778, 116.58567571398692, 88.91814824091283, 102.7257482560374, 86.87961871165433, 95.16028877015773, 99.03475647399942, 84.10049994721389, 110.93936580581077, 103.68849176887656, 99.4702350502728, 90.15035993876116, 96.58027319999012, 107.24944986215338, 99.4453309254463, 110.4164468992921, 83.26070094024303, 104.35019182818735, 82.19200941742767, 98.0513196548287, 91.67312461348664, 79.29025145380122, 111.01052491847645, 94.47978928944379, 97.39592765667234, 89.66840932794346, 99.96674244661904, 109.39215874020282, 98.60919608369225, 109.14503786717663, 80.28107926431163, 101.22129793799648, 90.73484840186188, 95.97090381615111, 95.59560853388872, 81.12544046352745, 102.19034569224898, 97.96799114322455, 104.41733960393385, 88.21476265899223, 103.35243477138766, 108.50875210581495, 94.817072822405, 106.44598778916999], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6161163580401365, "mean_inference_ms": 8.10441457988883, "mean_action_processing_ms": 0.5534580293900704, "mean_env_wait_ms": 23.35845522421789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0358424186706543, "StateBufferConnector_ms": 0.032918691635131836, "ViewRequirementAgentConnector_ms": 0.9798412322998047}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1605078, "num_agent_steps_trained": 1605078, "num_env_steps_sampled": 1605078, "num_env_steps_trained": 1605078, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 265.3650898019173, "num_env_steps_trained_throughput_per_sec": 265.3650898019173, "timesteps_total": 1605078, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1605078, "timers": {"training_iteration_time_ms": 59634.917, "sample_time_ms": 44744.286, "load_time_ms": 1764.983, "load_throughput": 8860.14, "learn_time_ms": 12516.414, "learn_throughput": 1249.399, "synch_weights_time_ms": 484.966}, "counters": {"num_env_steps_sampled": 1605078, "num_env_steps_trained": 1605078, "num_agent_steps_sampled": 1605078, "num_agent_steps_trained": 1605078}, "done": false, "episodes_total": 1725, "training_iteration": 123, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-30-16", "timestamp": 1749306616, "time_this_iter_s": 58.94711470603943, "time_total_s": 6885.41779255867, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6885.41779255867, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 77.74328358208956, "ram_util_percent": 58.19402985074626, "gpu_util_percent0": 0.07731343283582087, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.394922000000002e-05, "total_loss": -0.05085254023846408, "policy_loss": 0.007290252155878327, "vf_loss": 0.014676281889392571, "vf_explained_var": 0.9772362352501263, "kl": 0.017243053735005016, "entropy": 15.415106723091819, "entropy_coeff": 0.004092382999999998}, "model": {}, "num_grad_updates_lifetime": 56875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1620716, "num_env_steps_trained": 1620716, "num_agent_steps_sampled": 1620716, "num_agent_steps_trained": 1620716}, "sampler_results": {"episode_reward_max": 116.58567571398692, "episode_reward_min": 73.92965679242205, "episode_reward_mean": 97.32142885586327, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.34804108009422, 111.104635773495, 81.80532025849547, 100.28310694117766, 81.95029272010167, 97.3220007980824, 94.3061113964812, 85.75499596581106, 104.40841361171876, 106.57721367666454, 104.22500984470001, 92.88587878526842, 100.93269623163103, 109.71517732153828, 100.65261279436675, 114.56669082823697, 80.19620455485115, 103.69329432432855, 86.6012492424723, 90.04334438260003, 98.16120929098724, 80.77155420812609, 108.43454677837967, 99.77833950201365, 98.07645049306295, 88.22939836346526, 98.39044264232916, 110.10723108370443, 95.67150961043582, 110.15549416611563, 86.8925209544158, 104.75233563445515, 88.99563825066055, 96.70484575955594, 96.2925676396389, 86.75440719606884, 110.39050102143052, 100.57457485614717, 102.51610066361812, 90.3187677362889, 97.33488133144857, 99.66499173633741, 97.97621693684778, 116.58567571398692, 88.91814824091283, 102.7257482560374, 86.87961871165433, 95.16028877015773, 99.03475647399942, 84.10049994721389, 110.93936580581077, 103.68849176887656, 99.4702350502728, 90.15035993876116, 96.58027319999012, 107.24944986215338, 99.4453309254463, 110.4164468992921, 83.26070094024303, 104.35019182818735, 82.19200941742767, 98.0513196548287, 91.67312461348664, 79.29025145380122, 111.01052491847645, 94.47978928944379, 97.39592765667234, 89.66840932794346, 99.96674244661904, 109.39215874020282, 98.60919608369225, 109.14503786717663, 80.28107926431163, 101.22129793799648, 90.73484840186188, 95.97090381615111, 95.59560853388872, 81.12544046352745, 102.19034569224898, 97.96799114322455, 104.41733960393385, 88.21476265899223, 103.35243477138766, 108.50875210581495, 94.817072822405, 106.44598778916999, 81.07842991437712, 97.95434967307597, 89.65716105771345, 96.39538610086805, 94.75280180781003, 73.92965679242205, 106.93910621677153, 101.78840086036779, 88.97849762974097, 89.49936751474974, 103.04338536811497, 112.112139480694, 103.25423198414676, 106.76921599014244], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.619926257533897, "mean_inference_ms": 8.112325009657098, "mean_action_processing_ms": 0.5539957876383892, "mean_env_wait_ms": 23.374599567457384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03884577751159668, "StateBufferConnector_ms": 0.027806758880615234, "ViewRequirementAgentConnector_ms": 0.983475923538208}}, "episode_reward_max": 116.58567571398692, "episode_reward_min": 73.92965679242205, "episode_reward_mean": 97.32142885586327, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [101.34804108009422, 111.104635773495, 81.80532025849547, 100.28310694117766, 81.95029272010167, 97.3220007980824, 94.3061113964812, 85.75499596581106, 104.40841361171876, 106.57721367666454, 104.22500984470001, 92.88587878526842, 100.93269623163103, 109.71517732153828, 100.65261279436675, 114.56669082823697, 80.19620455485115, 103.69329432432855, 86.6012492424723, 90.04334438260003, 98.16120929098724, 80.77155420812609, 108.43454677837967, 99.77833950201365, 98.07645049306295, 88.22939836346526, 98.39044264232916, 110.10723108370443, 95.67150961043582, 110.15549416611563, 86.8925209544158, 104.75233563445515, 88.99563825066055, 96.70484575955594, 96.2925676396389, 86.75440719606884, 110.39050102143052, 100.57457485614717, 102.51610066361812, 90.3187677362889, 97.33488133144857, 99.66499173633741, 97.97621693684778, 116.58567571398692, 88.91814824091283, 102.7257482560374, 86.87961871165433, 95.16028877015773, 99.03475647399942, 84.10049994721389, 110.93936580581077, 103.68849176887656, 99.4702350502728, 90.15035993876116, 96.58027319999012, 107.24944986215338, 99.4453309254463, 110.4164468992921, 83.26070094024303, 104.35019182818735, 82.19200941742767, 98.0513196548287, 91.67312461348664, 79.29025145380122, 111.01052491847645, 94.47978928944379, 97.39592765667234, 89.66840932794346, 99.96674244661904, 109.39215874020282, 98.60919608369225, 109.14503786717663, 80.28107926431163, 101.22129793799648, 90.73484840186188, 95.97090381615111, 95.59560853388872, 81.12544046352745, 102.19034569224898, 97.96799114322455, 104.41733960393385, 88.21476265899223, 103.35243477138766, 108.50875210581495, 94.817072822405, 106.44598778916999, 81.07842991437712, 97.95434967307597, 89.65716105771345, 96.39538610086805, 94.75280180781003, 73.92965679242205, 106.93910621677153, 101.78840086036779, 88.97849762974097, 89.49936751474974, 103.04338536811497, 112.112139480694, 103.25423198414676, 106.76921599014244], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.619926257533897, "mean_inference_ms": 8.112325009657098, "mean_action_processing_ms": 0.5539957876383892, "mean_env_wait_ms": 23.374599567457384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03884577751159668, "StateBufferConnector_ms": 0.027806758880615234, "ViewRequirementAgentConnector_ms": 0.983475923538208}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1620716, "num_agent_steps_trained": 1620716, "num_env_steps_sampled": 1620716, "num_env_steps_trained": 1620716, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 267.8663698376604, "num_env_steps_trained_throughput_per_sec": 267.8663698376604, "timesteps_total": 1620716, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1620716, "timers": {"training_iteration_time_ms": 59377.808, "sample_time_ms": 44572.902, "load_time_ms": 1764.063, "load_throughput": 8864.765, "learn_time_ms": 12438.811, "learn_throughput": 1257.194, "synch_weights_time_ms": 476.958}, "counters": {"num_env_steps_sampled": 1620716, "num_env_steps_trained": 1620716, "num_agent_steps_sampled": 1620716, "num_agent_steps_trained": 1620716}, "done": false, "episodes_total": 1739, "training_iteration": 124, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-31-15", "timestamp": 1749306675, "time_this_iter_s": 58.398847818374634, "time_total_s": 6943.816640377045, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 6943.816640377045, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 76.82089552238806, "ram_util_percent": 58.1641791044776, "gpu_util_percent0": 0.08910447761194029, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.379283999999999e-05, "total_loss": -0.020735075084111567, "policy_loss": 0.03343497335148806, "vf_loss": 0.028557651108342477, "vf_explained_var": 0.9637892918153242, "kl": 0.016994596588699378, "entropy": 15.54917105588046, "entropy_coeff": 0.0040689260000000005}, "model": {}, "num_grad_updates_lifetime": 57425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1636354, "num_env_steps_trained": 1636354, "num_agent_steps_sampled": 1636354, "num_agent_steps_trained": 1636354}, "sampler_results": {"episode_reward_max": 116.58567571398692, "episode_reward_min": 37.9058660910708, "episode_reward_mean": 96.54334989101119, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.65261279436675, 114.56669082823697, 80.19620455485115, 103.69329432432855, 86.6012492424723, 90.04334438260003, 98.16120929098724, 80.77155420812609, 108.43454677837967, 99.77833950201365, 98.07645049306295, 88.22939836346526, 98.39044264232916, 110.10723108370443, 95.67150961043582, 110.15549416611563, 86.8925209544158, 104.75233563445515, 88.99563825066055, 96.70484575955594, 96.2925676396389, 86.75440719606884, 110.39050102143052, 100.57457485614717, 102.51610066361812, 90.3187677362889, 97.33488133144857, 99.66499173633741, 97.97621693684778, 116.58567571398692, 88.91814824091283, 102.7257482560374, 86.87961871165433, 95.16028877015773, 99.03475647399942, 84.10049994721389, 110.93936580581077, 103.68849176887656, 99.4702350502728, 90.15035993876116, 96.58027319999012, 107.24944986215338, 99.4453309254463, 110.4164468992921, 83.26070094024303, 104.35019182818735, 82.19200941742767, 98.0513196548287, 91.67312461348664, 79.29025145380122, 111.01052491847645, 94.47978928944379, 97.39592765667234, 89.66840932794346, 99.96674244661904, 109.39215874020282, 98.60919608369225, 109.14503786717663, 80.28107926431163, 101.22129793799648, 90.73484840186188, 95.97090381615111, 95.59560853388872, 81.12544046352745, 102.19034569224898, 97.96799114322455, 104.41733960393385, 88.21476265899223, 103.35243477138766, 108.50875210581495, 94.817072822405, 106.44598778916999, 81.07842991437712, 97.95434967307597, 89.65716105771345, 96.39538610086805, 94.75280180781003, 73.92965679242205, 106.93910621677153, 101.78840086036779, 88.97849762974097, 89.49936751474974, 103.04338536811497, 112.112139480694, 103.25423198414676, 106.76921599014244, 86.39175897278487, 100.21073860194912, 86.22177222795092, 93.17307085175423, 37.9058660910708, 82.04452641350382, 110.56339296878392, 98.51419927695754, 96.8445864530787, 89.02476963686699, 95.51481457529832, 108.41027135962825, 100.72887518059117, 109.26235530983382], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.623878183903049, "mean_inference_ms": 8.119562957612564, "mean_action_processing_ms": 0.5544745171597012, "mean_env_wait_ms": 23.389633809968068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03883051872253418, "StateBufferConnector_ms": 0.024822711944580078, "ViewRequirementAgentConnector_ms": 0.9859862327575684}}, "episode_reward_max": 116.58567571398692, "episode_reward_min": 37.9058660910708, "episode_reward_mean": 96.54334989101119, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [100.65261279436675, 114.56669082823697, 80.19620455485115, 103.69329432432855, 86.6012492424723, 90.04334438260003, 98.16120929098724, 80.77155420812609, 108.43454677837967, 99.77833950201365, 98.07645049306295, 88.22939836346526, 98.39044264232916, 110.10723108370443, 95.67150961043582, 110.15549416611563, 86.8925209544158, 104.75233563445515, 88.99563825066055, 96.70484575955594, 96.2925676396389, 86.75440719606884, 110.39050102143052, 100.57457485614717, 102.51610066361812, 90.3187677362889, 97.33488133144857, 99.66499173633741, 97.97621693684778, 116.58567571398692, 88.91814824091283, 102.7257482560374, 86.87961871165433, 95.16028877015773, 99.03475647399942, 84.10049994721389, 110.93936580581077, 103.68849176887656, 99.4702350502728, 90.15035993876116, 96.58027319999012, 107.24944986215338, 99.4453309254463, 110.4164468992921, 83.26070094024303, 104.35019182818735, 82.19200941742767, 98.0513196548287, 91.67312461348664, 79.29025145380122, 111.01052491847645, 94.47978928944379, 97.39592765667234, 89.66840932794346, 99.96674244661904, 109.39215874020282, 98.60919608369225, 109.14503786717663, 80.28107926431163, 101.22129793799648, 90.73484840186188, 95.97090381615111, 95.59560853388872, 81.12544046352745, 102.19034569224898, 97.96799114322455, 104.41733960393385, 88.21476265899223, 103.35243477138766, 108.50875210581495, 94.817072822405, 106.44598778916999, 81.07842991437712, 97.95434967307597, 89.65716105771345, 96.39538610086805, 94.75280180781003, 73.92965679242205, 106.93910621677153, 101.78840086036779, 88.97849762974097, 89.49936751474974, 103.04338536811497, 112.112139480694, 103.25423198414676, 106.76921599014244, 86.39175897278487, 100.21073860194912, 86.22177222795092, 93.17307085175423, 37.9058660910708, 82.04452641350382, 110.56339296878392, 98.51419927695754, 96.8445864530787, 89.02476963686699, 95.51481457529832, 108.41027135962825, 100.72887518059117, 109.26235530983382], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.623878183903049, "mean_inference_ms": 8.119562957612564, "mean_action_processing_ms": 0.5544745171597012, "mean_env_wait_ms": 23.389633809968068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03883051872253418, "StateBufferConnector_ms": 0.024822711944580078, "ViewRequirementAgentConnector_ms": 0.9859862327575684}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1636354, "num_agent_steps_trained": 1636354, "num_env_steps_sampled": 1636354, "num_env_steps_trained": 1636354, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 267.9166646239836, "num_env_steps_trained_throughput_per_sec": 267.9166646239836, "timesteps_total": 1636354, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1636354, "timers": {"training_iteration_time_ms": 58715.371, "sample_time_ms": 43933.874, "load_time_ms": 1763.371, "load_throughput": 8868.24, "learn_time_ms": 12415.513, "learn_throughput": 1259.553, "synch_weights_time_ms": 476.948}, "counters": {"num_env_steps_sampled": 1636354, "num_env_steps_trained": 1636354, "num_agent_steps_sampled": 1636354, "num_agent_steps_trained": 1636354}, "done": false, "episodes_total": 1753, "training_iteration": 125, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-32-13", "timestamp": 1749306733, "time_this_iter_s": 58.392881870269775, "time_total_s": 7002.209522247314, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7002.209522247314, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 77.01044776119404, "ram_util_percent": 57.89402985074627, "gpu_util_percent0": 0.08567164179104479, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.363646e-05, "total_loss": -0.028234040839174253, "policy_loss": 0.02935344190752155, "vf_loss": 0.015773257316852158, "vf_explained_var": 0.9776671170104634, "kl": 0.018801770705351883, "entropy": 15.549992257898504, "entropy_coeff": 0.004045469000000001}, "model": {}, "num_grad_updates_lifetime": 57975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1651992, "num_env_steps_trained": 1651992, "num_agent_steps_sampled": 1651992, "num_agent_steps_trained": 1651992}, "sampler_results": {"episode_reward_max": 116.58567571398692, "episode_reward_min": 37.9058660910708, "episode_reward_mean": 96.22573228197928, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.67150961043582, 110.15549416611563, 86.8925209544158, 104.75233563445515, 88.99563825066055, 96.70484575955594, 96.2925676396389, 86.75440719606884, 110.39050102143052, 100.57457485614717, 102.51610066361812, 90.3187677362889, 97.33488133144857, 99.66499173633741, 97.97621693684778, 116.58567571398692, 88.91814824091283, 102.7257482560374, 86.87961871165433, 95.16028877015773, 99.03475647399942, 84.10049994721389, 110.93936580581077, 103.68849176887656, 99.4702350502728, 90.15035993876116, 96.58027319999012, 107.24944986215338, 99.4453309254463, 110.4164468992921, 83.26070094024303, 104.35019182818735, 82.19200941742767, 98.0513196548287, 91.67312461348664, 79.29025145380122, 111.01052491847645, 94.47978928944379, 97.39592765667234, 89.66840932794346, 99.96674244661904, 109.39215874020282, 98.60919608369225, 109.14503786717663, 80.28107926431163, 101.22129793799648, 90.73484840186188, 95.97090381615111, 95.59560853388872, 81.12544046352745, 102.19034569224898, 97.96799114322455, 104.41733960393385, 88.21476265899223, 103.35243477138766, 108.50875210581495, 94.817072822405, 106.44598778916999, 81.07842991437712, 97.95434967307597, 89.65716105771345, 96.39538610086805, 94.75280180781003, 73.92965679242205, 106.93910621677153, 101.78840086036779, 88.97849762974097, 89.49936751474974, 103.04338536811497, 112.112139480694, 103.25423198414676, 106.76921599014244, 86.39175897278487, 100.21073860194912, 86.22177222795092, 93.17307085175423, 37.9058660910708, 82.04452641350382, 110.56339296878392, 98.51419927695754, 96.8445864530787, 89.02476963686699, 95.51481457529832, 108.41027135962825, 100.72887518059117, 109.26235530983382, 79.89517401401397, 102.94082593265983, 87.3271637637735, 93.71897895552375, 84.61693363106373, 85.09446039233639, 105.51915948712168, 97.66553454251576, 98.6148256903647, 85.60796937290048, 98.12970226068003, 100.15061698284633, 101.82653557880252, 104.83292698113026], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.628100502109952, "mean_inference_ms": 8.126639651635365, "mean_action_processing_ms": 0.5549535391412188, "mean_env_wait_ms": 23.404614501700568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03485989570617676, "StateBufferConnector_ms": 0.029860258102416992, "ViewRequirementAgentConnector_ms": 0.9861669540405273}}, "episode_reward_max": 116.58567571398692, "episode_reward_min": 37.9058660910708, "episode_reward_mean": 96.22573228197928, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [95.67150961043582, 110.15549416611563, 86.8925209544158, 104.75233563445515, 88.99563825066055, 96.70484575955594, 96.2925676396389, 86.75440719606884, 110.39050102143052, 100.57457485614717, 102.51610066361812, 90.3187677362889, 97.33488133144857, 99.66499173633741, 97.97621693684778, 116.58567571398692, 88.91814824091283, 102.7257482560374, 86.87961871165433, 95.16028877015773, 99.03475647399942, 84.10049994721389, 110.93936580581077, 103.68849176887656, 99.4702350502728, 90.15035993876116, 96.58027319999012, 107.24944986215338, 99.4453309254463, 110.4164468992921, 83.26070094024303, 104.35019182818735, 82.19200941742767, 98.0513196548287, 91.67312461348664, 79.29025145380122, 111.01052491847645, 94.47978928944379, 97.39592765667234, 89.66840932794346, 99.96674244661904, 109.39215874020282, 98.60919608369225, 109.14503786717663, 80.28107926431163, 101.22129793799648, 90.73484840186188, 95.97090381615111, 95.59560853388872, 81.12544046352745, 102.19034569224898, 97.96799114322455, 104.41733960393385, 88.21476265899223, 103.35243477138766, 108.50875210581495, 94.817072822405, 106.44598778916999, 81.07842991437712, 97.95434967307597, 89.65716105771345, 96.39538610086805, 94.75280180781003, 73.92965679242205, 106.93910621677153, 101.78840086036779, 88.97849762974097, 89.49936751474974, 103.04338536811497, 112.112139480694, 103.25423198414676, 106.76921599014244, 86.39175897278487, 100.21073860194912, 86.22177222795092, 93.17307085175423, 37.9058660910708, 82.04452641350382, 110.56339296878392, 98.51419927695754, 96.8445864530787, 89.02476963686699, 95.51481457529832, 108.41027135962825, 100.72887518059117, 109.26235530983382, 79.89517401401397, 102.94082593265983, 87.3271637637735, 93.71897895552375, 84.61693363106373, 85.09446039233639, 105.51915948712168, 97.66553454251576, 98.6148256903647, 85.60796937290048, 98.12970226068003, 100.15061698284633, 101.82653557880252, 104.83292698113026], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.628100502109952, "mean_inference_ms": 8.126639651635365, "mean_action_processing_ms": 0.5549535391412188, "mean_env_wait_ms": 23.404614501700568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03485989570617676, "StateBufferConnector_ms": 0.029860258102416992, "ViewRequirementAgentConnector_ms": 0.9861669540405273}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1651992, "num_agent_steps_trained": 1651992, "num_env_steps_sampled": 1651992, "num_env_steps_trained": 1651992, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 263.92479937801966, "num_env_steps_trained_throughput_per_sec": 263.92479937801966, "timesteps_total": 1651992, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1651992, "timers": {"training_iteration_time_ms": 58736.144, "sample_time_ms": 44004.968, "load_time_ms": 1751.161, "load_throughput": 8930.075, "learn_time_ms": 12384.952, "learn_throughput": 1262.661, "synch_weights_time_ms": 471.096}, "counters": {"num_env_steps_sampled": 1651992, "num_env_steps_trained": 1651992, "num_agent_steps_sampled": 1651992, "num_agent_steps_trained": 1651992}, "done": false, "episodes_total": 1767, "training_iteration": 126, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-33-13", "timestamp": 1749306793, "time_this_iter_s": 59.27375769615173, "time_total_s": 7061.483279943466, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7061.483279943466, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 77.73134328358209, "ram_util_percent": 57.64776119402985, "gpu_util_percent0": 0.07805970149253733, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.348008000000003e-05, "total_loss": -0.02378483224554326, "policy_loss": 0.03401111896742474, "vf_loss": 0.015438909759237007, "vf_explained_var": 0.9796761630881916, "kl": 0.019872394643395887, "entropy": 15.675895000804553, "entropy_coeff": 0.004022011999999999}, "model": {}, "num_grad_updates_lifetime": 58525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1667630, "num_env_steps_trained": 1667630, "num_agent_steps_sampled": 1667630, "num_agent_steps_trained": 1667630}, "sampler_results": {"episode_reward_max": 116.58567571398692, "episode_reward_min": 37.9058660910708, "episode_reward_mean": 95.74936724943527, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.97621693684778, 116.58567571398692, 88.91814824091283, 102.7257482560374, 86.87961871165433, 95.16028877015773, 99.03475647399942, 84.10049994721389, 110.93936580581077, 103.68849176887656, 99.4702350502728, 90.15035993876116, 96.58027319999012, 107.24944986215338, 99.4453309254463, 110.4164468992921, 83.26070094024303, 104.35019182818735, 82.19200941742767, 98.0513196548287, 91.67312461348664, 79.29025145380122, 111.01052491847645, 94.47978928944379, 97.39592765667234, 89.66840932794346, 99.96674244661904, 109.39215874020282, 98.60919608369225, 109.14503786717663, 80.28107926431163, 101.22129793799648, 90.73484840186188, 95.97090381615111, 95.59560853388872, 81.12544046352745, 102.19034569224898, 97.96799114322455, 104.41733960393385, 88.21476265899223, 103.35243477138766, 108.50875210581495, 94.817072822405, 106.44598778916999, 81.07842991437712, 97.95434967307597, 89.65716105771345, 96.39538610086805, 94.75280180781003, 73.92965679242205, 106.93910621677153, 101.78840086036779, 88.97849762974097, 89.49936751474974, 103.04338536811497, 112.112139480694, 103.25423198414676, 106.76921599014244, 86.39175897278487, 100.21073860194912, 86.22177222795092, 93.17307085175423, 37.9058660910708, 82.04452641350382, 110.56339296878392, 98.51419927695754, 96.8445864530787, 89.02476963686699, 95.51481457529832, 108.41027135962825, 100.72887518059117, 109.26235530983382, 79.89517401401397, 102.94082593265983, 87.3271637637735, 93.71897895552375, 84.61693363106373, 85.09446039233639, 105.51915948712168, 97.66553454251576, 98.6148256903647, 85.60796937290048, 98.12970226068003, 100.15061698284633, 101.82653557880252, 104.83292698113026, 82.20618633172296, 100.1285808666207, 87.73669991404125, 94.10575456585643, 90.61180896195812, 76.13603296744095, 98.19399442112588, 98.27418296272836, 100.2961770655656, 86.90819176923426, 92.99866892019477, 105.94235399188, 92.87750401612578, 112.96649654772484], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6324688617034218, "mean_inference_ms": 8.133532161213845, "mean_action_processing_ms": 0.5554170687728505, "mean_env_wait_ms": 23.418618090257784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03557300567626953, "StateBufferConnector_ms": 0.0339045524597168, "ViewRequirementAgentConnector_ms": 1.0018582344055176}}, "episode_reward_max": 116.58567571398692, "episode_reward_min": 37.9058660910708, "episode_reward_mean": 95.74936724943527, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [97.97621693684778, 116.58567571398692, 88.91814824091283, 102.7257482560374, 86.87961871165433, 95.16028877015773, 99.03475647399942, 84.10049994721389, 110.93936580581077, 103.68849176887656, 99.4702350502728, 90.15035993876116, 96.58027319999012, 107.24944986215338, 99.4453309254463, 110.4164468992921, 83.26070094024303, 104.35019182818735, 82.19200941742767, 98.0513196548287, 91.67312461348664, 79.29025145380122, 111.01052491847645, 94.47978928944379, 97.39592765667234, 89.66840932794346, 99.96674244661904, 109.39215874020282, 98.60919608369225, 109.14503786717663, 80.28107926431163, 101.22129793799648, 90.73484840186188, 95.97090381615111, 95.59560853388872, 81.12544046352745, 102.19034569224898, 97.96799114322455, 104.41733960393385, 88.21476265899223, 103.35243477138766, 108.50875210581495, 94.817072822405, 106.44598778916999, 81.07842991437712, 97.95434967307597, 89.65716105771345, 96.39538610086805, 94.75280180781003, 73.92965679242205, 106.93910621677153, 101.78840086036779, 88.97849762974097, 89.49936751474974, 103.04338536811497, 112.112139480694, 103.25423198414676, 106.76921599014244, 86.39175897278487, 100.21073860194912, 86.22177222795092, 93.17307085175423, 37.9058660910708, 82.04452641350382, 110.56339296878392, 98.51419927695754, 96.8445864530787, 89.02476963686699, 95.51481457529832, 108.41027135962825, 100.72887518059117, 109.26235530983382, 79.89517401401397, 102.94082593265983, 87.3271637637735, 93.71897895552375, 84.61693363106373, 85.09446039233639, 105.51915948712168, 97.66553454251576, 98.6148256903647, 85.60796937290048, 98.12970226068003, 100.15061698284633, 101.82653557880252, 104.83292698113026, 82.20618633172296, 100.1285808666207, 87.73669991404125, 94.10575456585643, 90.61180896195812, 76.13603296744095, 98.19399442112588, 98.27418296272836, 100.2961770655656, 86.90819176923426, 92.99866892019477, 105.94235399188, 92.87750401612578, 112.96649654772484], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6324688617034218, "mean_inference_ms": 8.133532161213845, "mean_action_processing_ms": 0.5554170687728505, "mean_env_wait_ms": 23.418618090257784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03557300567626953, "StateBufferConnector_ms": 0.0339045524597168, "ViewRequirementAgentConnector_ms": 1.0018582344055176}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1667630, "num_agent_steps_trained": 1667630, "num_env_steps_sampled": 1667630, "num_env_steps_trained": 1667630, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 266.4321446964111, "num_env_steps_trained_throughput_per_sec": 266.4321446964111, "timesteps_total": 1667630, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1667630, "timers": {"training_iteration_time_ms": 58723.113, "sample_time_ms": 43951.151, "load_time_ms": 1752.466, "load_throughput": 8923.427, "learn_time_ms": 12418.46, "learn_throughput": 1259.254, "synch_weights_time_ms": 476.016}, "counters": {"num_env_steps_sampled": 1667630, "num_env_steps_trained": 1667630, "num_agent_steps_sampled": 1667630, "num_agent_steps_trained": 1667630}, "done": false, "episodes_total": 1781, "training_iteration": 127, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-34-11", "timestamp": 1749306851, "time_this_iter_s": 58.71513032913208, "time_total_s": 7120.198410272598, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7120.198410272598, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 76.39117647058822, "ram_util_percent": 58.5, "gpu_util_percent0": 0.08426470588235295, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.332369999999998e-05, "total_loss": -0.049066260755697096, "policy_loss": 0.00883214276114648, "vf_loss": 0.015154493583196944, "vf_explained_var": 0.9774569627371701, "kl": 0.01797567267556019, "entropy": 15.757316282445734, "entropy_coeff": 0.003998555000000001}, "model": {}, "num_grad_updates_lifetime": 59075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1683268, "num_env_steps_trained": 1683268, "num_agent_steps_sampled": 1683268, "num_agent_steps_trained": 1683268}, "sampler_results": {"episode_reward_max": 112.96649654772484, "episode_reward_min": 37.9058660910708, "episode_reward_mean": 95.14822220785601, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [99.4453309254463, 110.4164468992921, 83.26070094024303, 104.35019182818735, 82.19200941742767, 98.0513196548287, 91.67312461348664, 79.29025145380122, 111.01052491847645, 94.47978928944379, 97.39592765667234, 89.66840932794346, 99.96674244661904, 109.39215874020282, 98.60919608369225, 109.14503786717663, 80.28107926431163, 101.22129793799648, 90.73484840186188, 95.97090381615111, 95.59560853388872, 81.12544046352745, 102.19034569224898, 97.96799114322455, 104.41733960393385, 88.21476265899223, 103.35243477138766, 108.50875210581495, 94.817072822405, 106.44598778916999, 81.07842991437712, 97.95434967307597, 89.65716105771345, 96.39538610086805, 94.75280180781003, 73.92965679242205, 106.93910621677153, 101.78840086036779, 88.97849762974097, 89.49936751474974, 103.04338536811497, 112.112139480694, 103.25423198414676, 106.76921599014244, 86.39175897278487, 100.21073860194912, 86.22177222795092, 93.17307085175423, 37.9058660910708, 82.04452641350382, 110.56339296878392, 98.51419927695754, 96.8445864530787, 89.02476963686699, 95.51481457529832, 108.41027135962825, 100.72887518059117, 109.26235530983382, 79.89517401401397, 102.94082593265983, 87.3271637637735, 93.71897895552375, 84.61693363106373, 85.09446039233639, 105.51915948712168, 97.66553454251576, 98.6148256903647, 85.60796937290048, 98.12970226068003, 100.15061698284633, 101.82653557880252, 104.83292698113026, 82.20618633172296, 100.1285808666207, 87.73669991404125, 94.10575456585643, 90.61180896195812, 76.13603296744095, 98.19399442112588, 98.27418296272836, 100.2961770655656, 86.90819176923426, 92.99866892019477, 105.94235399188, 92.87750401612578, 112.96649654772484, 84.11128280568204, 97.74441250675756, 84.66916629623152, 89.28889214337207, 91.37574039021783, 79.71114562812956, 103.11564323945088, 98.8437942125299, 96.93572162008866, 80.95277265239766, 100.53371895464447, 106.936208506864, 96.12471734500288, 109.00140821737624], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.636870115606584, "mean_inference_ms": 8.140382879592552, "mean_action_processing_ms": 0.5558786808281462, "mean_env_wait_ms": 23.432886483629918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037560462951660156, "StateBufferConnector_ms": 0.03790116310119629, "ViewRequirementAgentConnector_ms": 1.0087101459503174}}, "episode_reward_max": 112.96649654772484, "episode_reward_min": 37.9058660910708, "episode_reward_mean": 95.14822220785601, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [99.4453309254463, 110.4164468992921, 83.26070094024303, 104.35019182818735, 82.19200941742767, 98.0513196548287, 91.67312461348664, 79.29025145380122, 111.01052491847645, 94.47978928944379, 97.39592765667234, 89.66840932794346, 99.96674244661904, 109.39215874020282, 98.60919608369225, 109.14503786717663, 80.28107926431163, 101.22129793799648, 90.73484840186188, 95.97090381615111, 95.59560853388872, 81.12544046352745, 102.19034569224898, 97.96799114322455, 104.41733960393385, 88.21476265899223, 103.35243477138766, 108.50875210581495, 94.817072822405, 106.44598778916999, 81.07842991437712, 97.95434967307597, 89.65716105771345, 96.39538610086805, 94.75280180781003, 73.92965679242205, 106.93910621677153, 101.78840086036779, 88.97849762974097, 89.49936751474974, 103.04338536811497, 112.112139480694, 103.25423198414676, 106.76921599014244, 86.39175897278487, 100.21073860194912, 86.22177222795092, 93.17307085175423, 37.9058660910708, 82.04452641350382, 110.56339296878392, 98.51419927695754, 96.8445864530787, 89.02476963686699, 95.51481457529832, 108.41027135962825, 100.72887518059117, 109.26235530983382, 79.89517401401397, 102.94082593265983, 87.3271637637735, 93.71897895552375, 84.61693363106373, 85.09446039233639, 105.51915948712168, 97.66553454251576, 98.6148256903647, 85.60796937290048, 98.12970226068003, 100.15061698284633, 101.82653557880252, 104.83292698113026, 82.20618633172296, 100.1285808666207, 87.73669991404125, 94.10575456585643, 90.61180896195812, 76.13603296744095, 98.19399442112588, 98.27418296272836, 100.2961770655656, 86.90819176923426, 92.99866892019477, 105.94235399188, 92.87750401612578, 112.96649654772484, 84.11128280568204, 97.74441250675756, 84.66916629623152, 89.28889214337207, 91.37574039021783, 79.71114562812956, 103.11564323945088, 98.8437942125299, 96.93572162008866, 80.95277265239766, 100.53371895464447, 106.936208506864, 96.12471734500288, 109.00140821737624], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.636870115606584, "mean_inference_ms": 8.140382879592552, "mean_action_processing_ms": 0.5558786808281462, "mean_env_wait_ms": 23.432886483629918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037560462951660156, "StateBufferConnector_ms": 0.03790116310119629, "ViewRequirementAgentConnector_ms": 1.0087101459503174}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1683268, "num_agent_steps_trained": 1683268, "num_env_steps_sampled": 1683268, "num_env_steps_trained": 1683268, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 265.4174579367083, "num_env_steps_trained_throughput_per_sec": 265.4174579367083, "timesteps_total": 1683268, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1683268, "timers": {"training_iteration_time_ms": 58676.183, "sample_time_ms": 43940.653, "load_time_ms": 1761.07, "load_throughput": 8879.83, "learn_time_ms": 12391.245, "learn_throughput": 1262.02, "synch_weights_time_ms": 466.511}, "counters": {"num_env_steps_sampled": 1683268, "num_env_steps_trained": 1683268, "num_agent_steps_sampled": 1683268, "num_agent_steps_trained": 1683268}, "done": false, "episodes_total": 1795, "training_iteration": 128, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-35-10", "timestamp": 1749306910, "time_this_iter_s": 58.93418574333191, "time_total_s": 7179.13259601593, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7179.13259601593, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 77.0, "ram_util_percent": 58.38955223880597, "gpu_util_percent0": 0.08074626865671643, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.316732000000001e-05, "total_loss": -0.05785537033077245, "policy_loss": -0.0006289920401336117, "vf_loss": 0.016288436944808134, "vf_explained_var": 0.9735575686801564, "kl": 0.017559926320634845, "entropy": 15.763550316203725, "entropy_coeff": 0.003975097999999999}, "model": {}, "num_grad_updates_lifetime": 59625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1698906, "num_env_steps_trained": 1698906, "num_agent_steps_sampled": 1698906, "num_agent_steps_trained": 1698906}, "sampler_results": {"episode_reward_max": 112.96649654772484, "episode_reward_min": 37.9058660910708, "episode_reward_mean": 94.67287974111697, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.60919608369225, 109.14503786717663, 80.28107926431163, 101.22129793799648, 90.73484840186188, 95.97090381615111, 95.59560853388872, 81.12544046352745, 102.19034569224898, 97.96799114322455, 104.41733960393385, 88.21476265899223, 103.35243477138766, 108.50875210581495, 94.817072822405, 106.44598778916999, 81.07842991437712, 97.95434967307597, 89.65716105771345, 96.39538610086805, 94.75280180781003, 73.92965679242205, 106.93910621677153, 101.78840086036779, 88.97849762974097, 89.49936751474974, 103.04338536811497, 112.112139480694, 103.25423198414676, 106.76921599014244, 86.39175897278487, 100.21073860194912, 86.22177222795092, 93.17307085175423, 37.9058660910708, 82.04452641350382, 110.56339296878392, 98.51419927695754, 96.8445864530787, 89.02476963686699, 95.51481457529832, 108.41027135962825, 100.72887518059117, 109.26235530983382, 79.89517401401397, 102.94082593265983, 87.3271637637735, 93.71897895552375, 84.61693363106373, 85.09446039233639, 105.51915948712168, 97.66553454251576, 98.6148256903647, 85.60796937290048, 98.12970226068003, 100.15061698284633, 101.82653557880252, 104.83292698113026, 82.20618633172296, 100.1285808666207, 87.73669991404125, 94.10575456585643, 90.61180896195812, 76.13603296744095, 98.19399442112588, 98.27418296272836, 100.2961770655656, 86.90819176923426, 92.99866892019477, 105.94235399188, 92.87750401612578, 112.96649654772484, 84.11128280568204, 97.74441250675756, 84.66916629623152, 89.28889214337207, 91.37574039021783, 79.71114562812956, 103.11564323945088, 98.8437942125299, 96.93572162008866, 80.95277265239766, 100.53371895464447, 106.936208506864, 96.12471734500288, 109.00140821737624, 78.778529761538, 100.4952793278885, 80.65328661175178, 92.78406307269849, 89.86529501462006, 80.20654292688701, 99.62970681361182, 94.49729525620691, 93.8196552759009, 89.96082957834419, 100.39306925108654, 105.643335801844, 95.29975286919442, 101.03203987659852], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6414227531779595, "mean_inference_ms": 8.147860213954834, "mean_action_processing_ms": 0.5563484147485228, "mean_env_wait_ms": 23.448475779389195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03769040107727051, "StateBufferConnector_ms": 0.03707528114318848, "ViewRequirementAgentConnector_ms": 0.9844920635223389}}, "episode_reward_max": 112.96649654772484, "episode_reward_min": 37.9058660910708, "episode_reward_mean": 94.67287974111697, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [98.60919608369225, 109.14503786717663, 80.28107926431163, 101.22129793799648, 90.73484840186188, 95.97090381615111, 95.59560853388872, 81.12544046352745, 102.19034569224898, 97.96799114322455, 104.41733960393385, 88.21476265899223, 103.35243477138766, 108.50875210581495, 94.817072822405, 106.44598778916999, 81.07842991437712, 97.95434967307597, 89.65716105771345, 96.39538610086805, 94.75280180781003, 73.92965679242205, 106.93910621677153, 101.78840086036779, 88.97849762974097, 89.49936751474974, 103.04338536811497, 112.112139480694, 103.25423198414676, 106.76921599014244, 86.39175897278487, 100.21073860194912, 86.22177222795092, 93.17307085175423, 37.9058660910708, 82.04452641350382, 110.56339296878392, 98.51419927695754, 96.8445864530787, 89.02476963686699, 95.51481457529832, 108.41027135962825, 100.72887518059117, 109.26235530983382, 79.89517401401397, 102.94082593265983, 87.3271637637735, 93.71897895552375, 84.61693363106373, 85.09446039233639, 105.51915948712168, 97.66553454251576, 98.6148256903647, 85.60796937290048, 98.12970226068003, 100.15061698284633, 101.82653557880252, 104.83292698113026, 82.20618633172296, 100.1285808666207, 87.73669991404125, 94.10575456585643, 90.61180896195812, 76.13603296744095, 98.19399442112588, 98.27418296272836, 100.2961770655656, 86.90819176923426, 92.99866892019477, 105.94235399188, 92.87750401612578, 112.96649654772484, 84.11128280568204, 97.74441250675756, 84.66916629623152, 89.28889214337207, 91.37574039021783, 79.71114562812956, 103.11564323945088, 98.8437942125299, 96.93572162008866, 80.95277265239766, 100.53371895464447, 106.936208506864, 96.12471734500288, 109.00140821737624, 78.778529761538, 100.4952793278885, 80.65328661175178, 92.78406307269849, 89.86529501462006, 80.20654292688701, 99.62970681361182, 94.49729525620691, 93.8196552759009, 89.96082957834419, 100.39306925108654, 105.643335801844, 95.29975286919442, 101.03203987659852], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6414227531779595, "mean_inference_ms": 8.147860213954834, "mean_action_processing_ms": 0.5563484147485228, "mean_env_wait_ms": 23.448475779389195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03769040107727051, "StateBufferConnector_ms": 0.03707528114318848, "ViewRequirementAgentConnector_ms": 0.9844920635223389}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1698906, "num_agent_steps_trained": 1698906, "num_env_steps_sampled": 1698906, "num_env_steps_trained": 1698906, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 253.57463802916615, "num_env_steps_trained_throughput_per_sec": 253.57463802916615, "timesteps_total": 1698906, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1698906, "timers": {"training_iteration_time_ms": 58972.353, "sample_time_ms": 44157.681, "load_time_ms": 1780.567, "load_throughput": 8782.596, "learn_time_ms": 12442.199, "learn_throughput": 1256.852, "synch_weights_time_ms": 474.382}, "counters": {"num_env_steps_sampled": 1698906, "num_env_steps_trained": 1698906, "num_agent_steps_sampled": 1698906, "num_agent_steps_trained": 1698906}, "done": false, "episodes_total": 1809, "training_iteration": 129, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-36-12", "timestamp": 1749306972, "time_this_iter_s": 61.68932747840881, "time_total_s": 7240.821923494339, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7240.821923494339, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 78.5267605633803, "ram_util_percent": 57.88873239436619, "gpu_util_percent0": 0.08042253521126759, "vram_util_percent0": 0.8409830729166665}}
{"evaluation": {"sampler_results": {"episode_reward_max": -6.7749942646922054, "episode_reward_min": -9.568214258038285, "episode_reward_mean": -8.063341787535736, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.568214258038285, -9.408487260560985, -6.999368505544401, -7.565644648842801, -6.7749942646922054], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7257557197534443, "mean_inference_ms": 3.9286059127704283, "mean_action_processing_ms": 0.3001317961161556, "mean_env_wait_ms": 12.530959496658769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.04012107849121094, "ViewRequirementAgentConnector_ms": 0.3466463088989258}}, "episode_reward_max": -6.7749942646922054, "episode_reward_min": -9.568214258038285, "episode_reward_mean": -8.063341787535736, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.568214258038285, -9.408487260560985, -6.999368505544401, -7.565644648842801, -6.7749942646922054], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7257557197534443, "mean_inference_ms": 3.9286059127704283, "mean_action_processing_ms": 0.3001317961161556, "mean_env_wait_ms": 12.530959496658769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.04012107849121094, "ViewRequirementAgentConnector_ms": 0.3466463088989258}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.301094000000002e-05, "total_loss": -0.05877928217809478, "policy_loss": -0.0010495233624665575, "vf_loss": 0.014462701095776125, "vf_explained_var": 0.9789436863769184, "kl": 0.017722183358807726, "entropy": 15.847186326113615, "entropy_coeff": 0.003951641}, "model": {}, "num_grad_updates_lifetime": 60175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1714544, "num_env_steps_trained": 1714544, "num_agent_steps_sampled": 1714544, "num_agent_steps_trained": 1714544}, "sampler_results": {"episode_reward_max": 112.96649654772484, "episode_reward_min": 37.9058660910708, "episode_reward_mean": 94.30566263120201, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.817072822405, 106.44598778916999, 81.07842991437712, 97.95434967307597, 89.65716105771345, 96.39538610086805, 94.75280180781003, 73.92965679242205, 106.93910621677153, 101.78840086036779, 88.97849762974097, 89.49936751474974, 103.04338536811497, 112.112139480694, 103.25423198414676, 106.76921599014244, 86.39175897278487, 100.21073860194912, 86.22177222795092, 93.17307085175423, 37.9058660910708, 82.04452641350382, 110.56339296878392, 98.51419927695754, 96.8445864530787, 89.02476963686699, 95.51481457529832, 108.41027135962825, 100.72887518059117, 109.26235530983382, 79.89517401401397, 102.94082593265983, 87.3271637637735, 93.71897895552375, 84.61693363106373, 85.09446039233639, 105.51915948712168, 97.66553454251576, 98.6148256903647, 85.60796937290048, 98.12970226068003, 100.15061698284633, 101.82653557880252, 104.83292698113026, 82.20618633172296, 100.1285808666207, 87.73669991404125, 94.10575456585643, 90.61180896195812, 76.13603296744095, 98.19399442112588, 98.27418296272836, 100.2961770655656, 86.90819176923426, 92.99866892019477, 105.94235399188, 92.87750401612578, 112.96649654772484, 84.11128280568204, 97.74441250675756, 84.66916629623152, 89.28889214337207, 91.37574039021783, 79.71114562812956, 103.11564323945088, 98.8437942125299, 96.93572162008866, 80.95277265239766, 100.53371895464447, 106.936208506864, 96.12471734500288, 109.00140821737624, 78.778529761538, 100.4952793278885, 80.65328661175178, 92.78406307269849, 89.86529501462006, 80.20654292688701, 99.62970681361182, 94.49729525620691, 93.8196552759009, 89.96082957834419, 100.39306925108654, 105.643335801844, 95.29975286919442, 101.03203987659852, 77.16055138926055, 98.42148047190071, 83.60550306158764, 95.58143587806175, 90.50412964734237, 87.21106519514014, 103.85150933923833, 98.44894289899382, 92.72796649546761, 86.25417062002596, 100.5780510841524, 94.98280061342159, 98.91367127975934, 112.37204937835925], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6459124738664737, "mean_inference_ms": 8.155194672147058, "mean_action_processing_ms": 0.5568119716797195, "mean_env_wait_ms": 23.463581538293393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03971982002258301, "StateBufferConnector_ms": 0.04357099533081055, "ViewRequirementAgentConnector_ms": 0.9970371723175049}}, "episode_reward_max": 112.96649654772484, "episode_reward_min": 37.9058660910708, "episode_reward_mean": 94.30566263120201, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [94.817072822405, 106.44598778916999, 81.07842991437712, 97.95434967307597, 89.65716105771345, 96.39538610086805, 94.75280180781003, 73.92965679242205, 106.93910621677153, 101.78840086036779, 88.97849762974097, 89.49936751474974, 103.04338536811497, 112.112139480694, 103.25423198414676, 106.76921599014244, 86.39175897278487, 100.21073860194912, 86.22177222795092, 93.17307085175423, 37.9058660910708, 82.04452641350382, 110.56339296878392, 98.51419927695754, 96.8445864530787, 89.02476963686699, 95.51481457529832, 108.41027135962825, 100.72887518059117, 109.26235530983382, 79.89517401401397, 102.94082593265983, 87.3271637637735, 93.71897895552375, 84.61693363106373, 85.09446039233639, 105.51915948712168, 97.66553454251576, 98.6148256903647, 85.60796937290048, 98.12970226068003, 100.15061698284633, 101.82653557880252, 104.83292698113026, 82.20618633172296, 100.1285808666207, 87.73669991404125, 94.10575456585643, 90.61180896195812, 76.13603296744095, 98.19399442112588, 98.27418296272836, 100.2961770655656, 86.90819176923426, 92.99866892019477, 105.94235399188, 92.87750401612578, 112.96649654772484, 84.11128280568204, 97.74441250675756, 84.66916629623152, 89.28889214337207, 91.37574039021783, 79.71114562812956, 103.11564323945088, 98.8437942125299, 96.93572162008866, 80.95277265239766, 100.53371895464447, 106.936208506864, 96.12471734500288, 109.00140821737624, 78.778529761538, 100.4952793278885, 80.65328661175178, 92.78406307269849, 89.86529501462006, 80.20654292688701, 99.62970681361182, 94.49729525620691, 93.8196552759009, 89.96082957834419, 100.39306925108654, 105.643335801844, 95.29975286919442, 101.03203987659852, 77.16055138926055, 98.42148047190071, 83.60550306158764, 95.58143587806175, 90.50412964734237, 87.21106519514014, 103.85150933923833, 98.44894289899382, 92.72796649546761, 86.25417062002596, 100.5780510841524, 94.98280061342159, 98.91367127975934, 112.37204937835925], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6459124738664737, "mean_inference_ms": 8.155194672147058, "mean_action_processing_ms": 0.5568119716797195, "mean_env_wait_ms": 23.463581538293393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03971982002258301, "StateBufferConnector_ms": 0.04357099533081055, "ViewRequirementAgentConnector_ms": 0.9970371723175049}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1714544, "num_agent_steps_trained": 1714544, "num_env_steps_sampled": 1714544, "num_env_steps_trained": 1714544, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 264.6965548395309, "num_env_steps_trained_throughput_per_sec": 264.6965548395309, "timesteps_total": 1714544, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1714544, "timers": {"training_iteration_time_ms": 58997.295, "sample_time_ms": 44139.54, "load_time_ms": 1814.288, "load_throughput": 8619.359, "learn_time_ms": 12453.103, "learn_throughput": 1255.751, "synch_weights_time_ms": 474.111}, "counters": {"num_env_steps_sampled": 1714544, "num_env_steps_trained": 1714544, "num_agent_steps_sampled": 1714544, "num_agent_steps_trained": 1714544}, "done": false, "episodes_total": 1823, "training_iteration": 130, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-37-29", "timestamp": 1749307049, "time_this_iter_s": 76.88583898544312, "time_total_s": 7317.707762479782, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7317.707762479782, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 64.30222222222223, "ram_util_percent": 56.587777777777774, "gpu_util_percent0": 0.06588888888888889, "vram_util_percent0": 0.8409830729166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.285455999999999e-05, "total_loss": -0.059476940699599, "policy_loss": -0.002637745446567847, "vf_loss": 0.015725055191115563, "vf_explained_var": 0.9788651360164989, "kl": 0.017984786935113302, "entropy": 15.813601516376842, "entropy_coeff": 0.003928184000000001}, "model": {}, "num_grad_updates_lifetime": 60725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1730182, "num_env_steps_trained": 1730182, "num_agent_steps_sampled": 1730182, "num_agent_steps_trained": 1730182}, "sampler_results": {"episode_reward_max": 112.96649654772484, "episode_reward_min": 37.9058660910708, "episode_reward_mean": 94.29002094411238, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.25423198414676, 106.76921599014244, 86.39175897278487, 100.21073860194912, 86.22177222795092, 93.17307085175423, 37.9058660910708, 82.04452641350382, 110.56339296878392, 98.51419927695754, 96.8445864530787, 89.02476963686699, 95.51481457529832, 108.41027135962825, 100.72887518059117, 109.26235530983382, 79.89517401401397, 102.94082593265983, 87.3271637637735, 93.71897895552375, 84.61693363106373, 85.09446039233639, 105.51915948712168, 97.66553454251576, 98.6148256903647, 85.60796937290048, 98.12970226068003, 100.15061698284633, 101.82653557880252, 104.83292698113026, 82.20618633172296, 100.1285808666207, 87.73669991404125, 94.10575456585643, 90.61180896195812, 76.13603296744095, 98.19399442112588, 98.27418296272836, 100.2961770655656, 86.90819176923426, 92.99866892019477, 105.94235399188, 92.87750401612578, 112.96649654772484, 84.11128280568204, 97.74441250675756, 84.66916629623152, 89.28889214337207, 91.37574039021783, 79.71114562812956, 103.11564323945088, 98.8437942125299, 96.93572162008866, 80.95277265239766, 100.53371895464447, 106.936208506864, 96.12471734500288, 109.00140821737624, 78.778529761538, 100.4952793278885, 80.65328661175178, 92.78406307269849, 89.86529501462006, 80.20654292688701, 99.62970681361182, 94.49729525620691, 93.8196552759009, 89.96082957834419, 100.39306925108654, 105.643335801844, 95.29975286919442, 101.03203987659852, 77.16055138926055, 98.42148047190071, 83.60550306158764, 95.58143587806175, 90.50412964734237, 87.21106519514014, 103.85150933923833, 98.44894289899382, 92.72796649546761, 86.25417062002596, 100.5780510841524, 94.98280061342159, 98.91367127975934, 112.37204937835925, 79.59952972723957, 98.92298719504502, 83.14417518159762, 97.22131912204036, 94.85805109196255, 79.32322675661372, 95.8489781934901, 97.4210953709272, 99.39839266891278, 90.22625066176985, 104.37025269870463, 109.4663955226867, 97.89442715066436, 108.1324929776612], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.650269462135915, "mean_inference_ms": 8.162677646330541, "mean_action_processing_ms": 0.5572626020602516, "mean_env_wait_ms": 23.479226245192162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029686450958251953, "StateBufferConnector_ms": 0.04672813415527344, "ViewRequirementAgentConnector_ms": 0.966832160949707}}, "episode_reward_max": 112.96649654772484, "episode_reward_min": 37.9058660910708, "episode_reward_mean": 94.29002094411238, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [103.25423198414676, 106.76921599014244, 86.39175897278487, 100.21073860194912, 86.22177222795092, 93.17307085175423, 37.9058660910708, 82.04452641350382, 110.56339296878392, 98.51419927695754, 96.8445864530787, 89.02476963686699, 95.51481457529832, 108.41027135962825, 100.72887518059117, 109.26235530983382, 79.89517401401397, 102.94082593265983, 87.3271637637735, 93.71897895552375, 84.61693363106373, 85.09446039233639, 105.51915948712168, 97.66553454251576, 98.6148256903647, 85.60796937290048, 98.12970226068003, 100.15061698284633, 101.82653557880252, 104.83292698113026, 82.20618633172296, 100.1285808666207, 87.73669991404125, 94.10575456585643, 90.61180896195812, 76.13603296744095, 98.19399442112588, 98.27418296272836, 100.2961770655656, 86.90819176923426, 92.99866892019477, 105.94235399188, 92.87750401612578, 112.96649654772484, 84.11128280568204, 97.74441250675756, 84.66916629623152, 89.28889214337207, 91.37574039021783, 79.71114562812956, 103.11564323945088, 98.8437942125299, 96.93572162008866, 80.95277265239766, 100.53371895464447, 106.936208506864, 96.12471734500288, 109.00140821737624, 78.778529761538, 100.4952793278885, 80.65328661175178, 92.78406307269849, 89.86529501462006, 80.20654292688701, 99.62970681361182, 94.49729525620691, 93.8196552759009, 89.96082957834419, 100.39306925108654, 105.643335801844, 95.29975286919442, 101.03203987659852, 77.16055138926055, 98.42148047190071, 83.60550306158764, 95.58143587806175, 90.50412964734237, 87.21106519514014, 103.85150933923833, 98.44894289899382, 92.72796649546761, 86.25417062002596, 100.5780510841524, 94.98280061342159, 98.91367127975934, 112.37204937835925, 79.59952972723957, 98.92298719504502, 83.14417518159762, 97.22131912204036, 94.85805109196255, 79.32322675661372, 95.8489781934901, 97.4210953709272, 99.39839266891278, 90.22625066176985, 104.37025269870463, 109.4663955226867, 97.89442715066436, 108.1324929776612], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.650269462135915, "mean_inference_ms": 8.162677646330541, "mean_action_processing_ms": 0.5572626020602516, "mean_env_wait_ms": 23.479226245192162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029686450958251953, "StateBufferConnector_ms": 0.04672813415527344, "ViewRequirementAgentConnector_ms": 0.966832160949707}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1730182, "num_agent_steps_trained": 1730182, "num_env_steps_sampled": 1730182, "num_env_steps_trained": 1730182, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 263.7460638035175, "num_env_steps_trained_throughput_per_sec": 263.7460638035175, "timesteps_total": 1730182, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1730182, "timers": {"training_iteration_time_ms": 59083.924, "sample_time_ms": 44223.758, "load_time_ms": 1825.055, "load_throughput": 8568.507, "learn_time_ms": 12450.593, "learn_throughput": 1256.004, "synch_weights_time_ms": 461.909}, "counters": {"num_env_steps_sampled": 1730182, "num_env_steps_trained": 1730182, "num_agent_steps_sampled": 1730182, "num_agent_steps_trained": 1730182}, "done": false, "episodes_total": 1837, "training_iteration": 131, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-38-29", "timestamp": 1749307109, "time_this_iter_s": 59.30165457725525, "time_total_s": 7377.009417057037, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7377.009417057037, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 76.2376811594203, "ram_util_percent": 57.25072463768116, "gpu_util_percent0": 0.07999999999999999, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.269818e-05, "total_loss": -0.052611057459884744, "policy_loss": 0.0044901393447071315, "vf_loss": 0.014475530847822401, "vf_explained_var": 0.9795332617109472, "kl": 0.017629924716685622, "entropy": 15.876857388236306, "entropy_coeff": 0.0039047269999999998}, "model": {}, "num_grad_updates_lifetime": 61275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1745820, "num_env_steps_trained": 1745820, "num_agent_steps_sampled": 1745820, "num_agent_steps_trained": 1745820}, "sampler_results": {"episode_reward_max": 112.96649654772484, "episode_reward_min": 76.13603296744095, "episode_reward_mean": 94.50007415946406, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.72887518059117, 109.26235530983382, 79.89517401401397, 102.94082593265983, 87.3271637637735, 93.71897895552375, 84.61693363106373, 85.09446039233639, 105.51915948712168, 97.66553454251576, 98.6148256903647, 85.60796937290048, 98.12970226068003, 100.15061698284633, 101.82653557880252, 104.83292698113026, 82.20618633172296, 100.1285808666207, 87.73669991404125, 94.10575456585643, 90.61180896195812, 76.13603296744095, 98.19399442112588, 98.27418296272836, 100.2961770655656, 86.90819176923426, 92.99866892019477, 105.94235399188, 92.87750401612578, 112.96649654772484, 84.11128280568204, 97.74441250675756, 84.66916629623152, 89.28889214337207, 91.37574039021783, 79.71114562812956, 103.11564323945088, 98.8437942125299, 96.93572162008866, 80.95277265239766, 100.53371895464447, 106.936208506864, 96.12471734500288, 109.00140821737624, 78.778529761538, 100.4952793278885, 80.65328661175178, 92.78406307269849, 89.86529501462006, 80.20654292688701, 99.62970681361182, 94.49729525620691, 93.8196552759009, 89.96082957834419, 100.39306925108654, 105.643335801844, 95.29975286919442, 101.03203987659852, 77.16055138926055, 98.42148047190071, 83.60550306158764, 95.58143587806175, 90.50412964734237, 87.21106519514014, 103.85150933923833, 98.44894289899382, 92.72796649546761, 86.25417062002596, 100.5780510841524, 94.98280061342159, 98.91367127975934, 112.37204937835925, 79.59952972723957, 98.92298719504502, 83.14417518159762, 97.22131912204036, 94.85805109196255, 79.32322675661372, 95.8489781934901, 97.4210953709272, 99.39839266891278, 90.22625066176985, 104.37025269870463, 109.4663955226867, 97.89442715066436, 108.1324929776612, 78.39862030673962, 98.1785015387027, 87.40095199543342, 90.43674529580136, 90.55007055265001, 83.59145243767463, 103.59899178488159, 90.87970181337894, 90.41090294732616, 91.7366486988102, 99.65579353398378, 102.59931482599185, 98.2172962073414, 110.19354500036901], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.654470835184996, "mean_inference_ms": 8.170063307521005, "mean_action_processing_ms": 0.5577113357442776, "mean_env_wait_ms": 23.49444974829716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03115677833557129, "StateBufferConnector_ms": 0.045827388763427734, "ViewRequirementAgentConnector_ms": 0.9691510200500488}}, "episode_reward_max": 112.96649654772484, "episode_reward_min": 76.13603296744095, "episode_reward_mean": 94.50007415946406, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [100.72887518059117, 109.26235530983382, 79.89517401401397, 102.94082593265983, 87.3271637637735, 93.71897895552375, 84.61693363106373, 85.09446039233639, 105.51915948712168, 97.66553454251576, 98.6148256903647, 85.60796937290048, 98.12970226068003, 100.15061698284633, 101.82653557880252, 104.83292698113026, 82.20618633172296, 100.1285808666207, 87.73669991404125, 94.10575456585643, 90.61180896195812, 76.13603296744095, 98.19399442112588, 98.27418296272836, 100.2961770655656, 86.90819176923426, 92.99866892019477, 105.94235399188, 92.87750401612578, 112.96649654772484, 84.11128280568204, 97.74441250675756, 84.66916629623152, 89.28889214337207, 91.37574039021783, 79.71114562812956, 103.11564323945088, 98.8437942125299, 96.93572162008866, 80.95277265239766, 100.53371895464447, 106.936208506864, 96.12471734500288, 109.00140821737624, 78.778529761538, 100.4952793278885, 80.65328661175178, 92.78406307269849, 89.86529501462006, 80.20654292688701, 99.62970681361182, 94.49729525620691, 93.8196552759009, 89.96082957834419, 100.39306925108654, 105.643335801844, 95.29975286919442, 101.03203987659852, 77.16055138926055, 98.42148047190071, 83.60550306158764, 95.58143587806175, 90.50412964734237, 87.21106519514014, 103.85150933923833, 98.44894289899382, 92.72796649546761, 86.25417062002596, 100.5780510841524, 94.98280061342159, 98.91367127975934, 112.37204937835925, 79.59952972723957, 98.92298719504502, 83.14417518159762, 97.22131912204036, 94.85805109196255, 79.32322675661372, 95.8489781934901, 97.4210953709272, 99.39839266891278, 90.22625066176985, 104.37025269870463, 109.4663955226867, 97.89442715066436, 108.1324929776612, 78.39862030673962, 98.1785015387027, 87.40095199543342, 90.43674529580136, 90.55007055265001, 83.59145243767463, 103.59899178488159, 90.87970181337894, 90.41090294732616, 91.7366486988102, 99.65579353398378, 102.59931482599185, 98.2172962073414, 110.19354500036901], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.654470835184996, "mean_inference_ms": 8.170063307521005, "mean_action_processing_ms": 0.5577113357442776, "mean_env_wait_ms": 23.49444974829716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03115677833557129, "StateBufferConnector_ms": 0.045827388763427734, "ViewRequirementAgentConnector_ms": 0.9691510200500488}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1745820, "num_agent_steps_trained": 1745820, "num_env_steps_sampled": 1745820, "num_env_steps_trained": 1745820, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 268.95609831883405, "num_env_steps_trained_throughput_per_sec": 268.95609831883405, "timesteps_total": 1745820, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1745820, "timers": {"training_iteration_time_ms": 59072.761, "sample_time_ms": 44159.024, "load_time_ms": 1828.216, "load_throughput": 8553.695, "learn_time_ms": 12490.458, "learn_throughput": 1251.996, "synch_weights_time_ms": 466.797}, "counters": {"num_env_steps_sampled": 1745820, "num_env_steps_trained": 1745820, "num_agent_steps_sampled": 1745820, "num_agent_steps_trained": 1745820}, "done": false, "episodes_total": 1851, "training_iteration": 132, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-39-27", "timestamp": 1749307167, "time_this_iter_s": 58.16709065437317, "time_total_s": 7435.1765077114105, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7435.1765077114105, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 76.70151515151515, "ram_util_percent": 57.715151515151504, "gpu_util_percent0": 0.08454545454545455, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.254180000000002e-05, "total_loss": -0.06966005397113886, "policy_loss": -0.012696518260358558, "vf_loss": 0.014193306739272719, "vf_explained_var": 0.9792019904743542, "kl": 0.01726322306969616, "entropy": 15.912574742057107, "entropy_coeff": 0.0038812699999999996}, "model": {}, "num_grad_updates_lifetime": 61825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1761458, "num_env_steps_trained": 1761458, "num_agent_steps_sampled": 1761458, "num_agent_steps_trained": 1761458}, "sampler_results": {"episode_reward_max": 112.96649654772484, "episode_reward_min": 76.13603296744095, "episode_reward_mean": 94.36864356787997, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.82653557880252, 104.83292698113026, 82.20618633172296, 100.1285808666207, 87.73669991404125, 94.10575456585643, 90.61180896195812, 76.13603296744095, 98.19399442112588, 98.27418296272836, 100.2961770655656, 86.90819176923426, 92.99866892019477, 105.94235399188, 92.87750401612578, 112.96649654772484, 84.11128280568204, 97.74441250675756, 84.66916629623152, 89.28889214337207, 91.37574039021783, 79.71114562812956, 103.11564323945088, 98.8437942125299, 96.93572162008866, 80.95277265239766, 100.53371895464447, 106.936208506864, 96.12471734500288, 109.00140821737624, 78.778529761538, 100.4952793278885, 80.65328661175178, 92.78406307269849, 89.86529501462006, 80.20654292688701, 99.62970681361182, 94.49729525620691, 93.8196552759009, 89.96082957834419, 100.39306925108654, 105.643335801844, 95.29975286919442, 101.03203987659852, 77.16055138926055, 98.42148047190071, 83.60550306158764, 95.58143587806175, 90.50412964734237, 87.21106519514014, 103.85150933923833, 98.44894289899382, 92.72796649546761, 86.25417062002596, 100.5780510841524, 94.98280061342159, 98.91367127975934, 112.37204937835925, 79.59952972723957, 98.92298719504502, 83.14417518159762, 97.22131912204036, 94.85805109196255, 79.32322675661372, 95.8489781934901, 97.4210953709272, 99.39839266891278, 90.22625066176985, 104.37025269870463, 109.4663955226867, 97.89442715066436, 108.1324929776612, 78.39862030673962, 98.1785015387027, 87.40095199543342, 90.43674529580136, 90.55007055265001, 83.59145243767463, 103.59899178488159, 90.87970181337894, 90.41090294732616, 91.7366486988102, 99.65579353398378, 102.59931482599185, 98.2172962073414, 110.19354500036901, 78.49563259963011, 106.00464599129415, 84.3959622598258, 90.90124068587784, 93.45007194286435, 81.85836034692764, 102.98641509013683, 95.33300127705856, 97.94148995633589, 89.0943288547681, 94.33404036726283, 100.69646383739519, 101.77853609387104, 98.85932705456804], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6584696235282514, "mean_inference_ms": 8.177520555215493, "mean_action_processing_ms": 0.5581600519327076, "mean_env_wait_ms": 23.510066881422674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03527021408081055, "StateBufferConnector_ms": 0.04082679748535156, "ViewRequirementAgentConnector_ms": 0.9955663681030273}}, "episode_reward_max": 112.96649654772484, "episode_reward_min": 76.13603296744095, "episode_reward_mean": 94.36864356787997, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [101.82653557880252, 104.83292698113026, 82.20618633172296, 100.1285808666207, 87.73669991404125, 94.10575456585643, 90.61180896195812, 76.13603296744095, 98.19399442112588, 98.27418296272836, 100.2961770655656, 86.90819176923426, 92.99866892019477, 105.94235399188, 92.87750401612578, 112.96649654772484, 84.11128280568204, 97.74441250675756, 84.66916629623152, 89.28889214337207, 91.37574039021783, 79.71114562812956, 103.11564323945088, 98.8437942125299, 96.93572162008866, 80.95277265239766, 100.53371895464447, 106.936208506864, 96.12471734500288, 109.00140821737624, 78.778529761538, 100.4952793278885, 80.65328661175178, 92.78406307269849, 89.86529501462006, 80.20654292688701, 99.62970681361182, 94.49729525620691, 93.8196552759009, 89.96082957834419, 100.39306925108654, 105.643335801844, 95.29975286919442, 101.03203987659852, 77.16055138926055, 98.42148047190071, 83.60550306158764, 95.58143587806175, 90.50412964734237, 87.21106519514014, 103.85150933923833, 98.44894289899382, 92.72796649546761, 86.25417062002596, 100.5780510841524, 94.98280061342159, 98.91367127975934, 112.37204937835925, 79.59952972723957, 98.92298719504502, 83.14417518159762, 97.22131912204036, 94.85805109196255, 79.32322675661372, 95.8489781934901, 97.4210953709272, 99.39839266891278, 90.22625066176985, 104.37025269870463, 109.4663955226867, 97.89442715066436, 108.1324929776612, 78.39862030673962, 98.1785015387027, 87.40095199543342, 90.43674529580136, 90.55007055265001, 83.59145243767463, 103.59899178488159, 90.87970181337894, 90.41090294732616, 91.7366486988102, 99.65579353398378, 102.59931482599185, 98.2172962073414, 110.19354500036901, 78.49563259963011, 106.00464599129415, 84.3959622598258, 90.90124068587784, 93.45007194286435, 81.85836034692764, 102.98641509013683, 95.33300127705856, 97.94148995633589, 89.0943288547681, 94.33404036726283, 100.69646383739519, 101.77853609387104, 98.85932705456804], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6584696235282514, "mean_inference_ms": 8.177520555215493, "mean_action_processing_ms": 0.5581600519327076, "mean_env_wait_ms": 23.510066881422674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03527021408081055, "StateBufferConnector_ms": 0.04082679748535156, "ViewRequirementAgentConnector_ms": 0.9955663681030273}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1761458, "num_agent_steps_trained": 1761458, "num_env_steps_sampled": 1761458, "num_env_steps_trained": 1761458, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 257.7351202474014, "num_env_steps_trained_throughput_per_sec": 257.7351202474014, "timesteps_total": 1761458, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1761458, "timers": {"training_iteration_time_ms": 59247.217, "sample_time_ms": 44267.764, "load_time_ms": 1823.52, "load_throughput": 8575.721, "learn_time_ms": 12554.597, "learn_throughput": 1245.6, "synch_weights_time_ms": 469.666}, "counters": {"num_env_steps_sampled": 1761458, "num_env_steps_trained": 1761458, "num_agent_steps_sampled": 1761458, "num_agent_steps_trained": 1761458}, "done": false, "episodes_total": 1865, "training_iteration": 133, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-40-28", "timestamp": 1749307228, "time_this_iter_s": 60.696686029434204, "time_total_s": 7495.873193740845, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7495.873193740845, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 77.37857142857143, "ram_util_percent": 57.64428571428572, "gpu_util_percent0": 0.07857142857142857, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.238542000000001e-05, "total_loss": -0.061127240663309663, "policy_loss": -0.004633464831012217, "vf_loss": 0.014927684321830219, "vf_explained_var": 0.9787957080927762, "kl": 0.018422820834755178, "entropy": 15.954063446738504, "entropy_coeff": 0.0038578130000000007}, "model": {}, "num_grad_updates_lifetime": 62375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1777096, "num_env_steps_trained": 1777096, "num_agent_steps_sampled": 1777096, "num_agent_steps_trained": 1777096}, "sampler_results": {"episode_reward_max": 112.96649654772484, "episode_reward_min": 77.16055138926055, "episode_reward_mean": 94.23851119386102, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.87750401612578, 112.96649654772484, 84.11128280568204, 97.74441250675756, 84.66916629623152, 89.28889214337207, 91.37574039021783, 79.71114562812956, 103.11564323945088, 98.8437942125299, 96.93572162008866, 80.95277265239766, 100.53371895464447, 106.936208506864, 96.12471734500288, 109.00140821737624, 78.778529761538, 100.4952793278885, 80.65328661175178, 92.78406307269849, 89.86529501462006, 80.20654292688701, 99.62970681361182, 94.49729525620691, 93.8196552759009, 89.96082957834419, 100.39306925108654, 105.643335801844, 95.29975286919442, 101.03203987659852, 77.16055138926055, 98.42148047190071, 83.60550306158764, 95.58143587806175, 90.50412964734237, 87.21106519514014, 103.85150933923833, 98.44894289899382, 92.72796649546761, 86.25417062002596, 100.5780510841524, 94.98280061342159, 98.91367127975934, 112.37204937835925, 79.59952972723957, 98.92298719504502, 83.14417518159762, 97.22131912204036, 94.85805109196255, 79.32322675661372, 95.8489781934901, 97.4210953709272, 99.39839266891278, 90.22625066176985, 104.37025269870463, 109.4663955226867, 97.89442715066436, 108.1324929776612, 78.39862030673962, 98.1785015387027, 87.40095199543342, 90.43674529580136, 90.55007055265001, 83.59145243767463, 103.59899178488159, 90.87970181337894, 90.41090294732616, 91.7366486988102, 99.65579353398378, 102.59931482599185, 98.2172962073414, 110.19354500036901, 78.49563259963011, 106.00464599129415, 84.3959622598258, 90.90124068587784, 93.45007194286435, 81.85836034692764, 102.98641509013683, 95.33300127705856, 97.94148995633589, 89.0943288547681, 94.33404036726283, 100.69646383739519, 101.77853609387104, 98.85932705456804, 79.28972164421869, 96.90213376558451, 86.11689308496618, 91.20106586640055, 94.69506419350114, 79.15740088902808, 99.10931055791158, 91.08994911674742, 96.95439854164991, 84.70528175581751, 106.16921979910717, 103.94624381041865, 99.06365696556327, 98.78451790549369], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6622362260311734, "mean_inference_ms": 8.184972643329743, "mean_action_processing_ms": 0.5586069778121326, "mean_env_wait_ms": 23.52585764429226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031475067138671875, "StateBufferConnector_ms": 0.035735368728637695, "ViewRequirementAgentConnector_ms": 0.9740409851074219}}, "episode_reward_max": 112.96649654772484, "episode_reward_min": 77.16055138926055, "episode_reward_mean": 94.23851119386102, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [92.87750401612578, 112.96649654772484, 84.11128280568204, 97.74441250675756, 84.66916629623152, 89.28889214337207, 91.37574039021783, 79.71114562812956, 103.11564323945088, 98.8437942125299, 96.93572162008866, 80.95277265239766, 100.53371895464447, 106.936208506864, 96.12471734500288, 109.00140821737624, 78.778529761538, 100.4952793278885, 80.65328661175178, 92.78406307269849, 89.86529501462006, 80.20654292688701, 99.62970681361182, 94.49729525620691, 93.8196552759009, 89.96082957834419, 100.39306925108654, 105.643335801844, 95.29975286919442, 101.03203987659852, 77.16055138926055, 98.42148047190071, 83.60550306158764, 95.58143587806175, 90.50412964734237, 87.21106519514014, 103.85150933923833, 98.44894289899382, 92.72796649546761, 86.25417062002596, 100.5780510841524, 94.98280061342159, 98.91367127975934, 112.37204937835925, 79.59952972723957, 98.92298719504502, 83.14417518159762, 97.22131912204036, 94.85805109196255, 79.32322675661372, 95.8489781934901, 97.4210953709272, 99.39839266891278, 90.22625066176985, 104.37025269870463, 109.4663955226867, 97.89442715066436, 108.1324929776612, 78.39862030673962, 98.1785015387027, 87.40095199543342, 90.43674529580136, 90.55007055265001, 83.59145243767463, 103.59899178488159, 90.87970181337894, 90.41090294732616, 91.7366486988102, 99.65579353398378, 102.59931482599185, 98.2172962073414, 110.19354500036901, 78.49563259963011, 106.00464599129415, 84.3959622598258, 90.90124068587784, 93.45007194286435, 81.85836034692764, 102.98641509013683, 95.33300127705856, 97.94148995633589, 89.0943288547681, 94.33404036726283, 100.69646383739519, 101.77853609387104, 98.85932705456804, 79.28972164421869, 96.90213376558451, 86.11689308496618, 91.20106586640055, 94.69506419350114, 79.15740088902808, 99.10931055791158, 91.08994911674742, 96.95439854164991, 84.70528175581751, 106.16921979910717, 103.94624381041865, 99.06365696556327, 98.78451790549369], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6622362260311734, "mean_inference_ms": 8.184972643329743, "mean_action_processing_ms": 0.5586069778121326, "mean_env_wait_ms": 23.52585764429226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031475067138671875, "StateBufferConnector_ms": 0.035735368728637695, "ViewRequirementAgentConnector_ms": 0.9740409851074219}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1777096, "num_agent_steps_trained": 1777096, "num_env_steps_sampled": 1777096, "num_env_steps_trained": 1777096, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 266.84255576162224, "num_env_steps_trained_throughput_per_sec": 266.84255576162224, "timesteps_total": 1777096, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1777096, "timers": {"training_iteration_time_ms": 59269.616, "sample_time_ms": 44302.794, "load_time_ms": 1819.132, "load_throughput": 8596.41, "learn_time_ms": 12537.319, "learn_throughput": 1247.316, "synch_weights_time_ms": 477.905}, "counters": {"num_env_steps_sampled": 1777096, "num_env_steps_trained": 1777096, "num_agent_steps_sampled": 1777096, "num_agent_steps_trained": 1777096}, "done": false, "episodes_total": 1879, "training_iteration": 134, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-41-26", "timestamp": 1749307286, "time_this_iter_s": 58.623387575149536, "time_total_s": 7554.496581315994, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7554.496581315994, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 77.53283582089553, "ram_util_percent": 57.07462686567165, "gpu_util_percent0": 0.08044776119402985, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.222904e-05, "total_loss": -0.058265170999061824, "policy_loss": -0.0018760127548805691, "vf_loss": 0.014573901795189489, "vf_explained_var": 0.9772926113822243, "kl": 0.01791544048814629, "entropy": 15.992564536007968, "entropy_coeff": 0.003834356}, "model": {}, "num_grad_updates_lifetime": 62925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1792734, "num_env_steps_trained": 1792734, "num_agent_steps_sampled": 1792734, "num_agent_steps_trained": 1792734}, "sampler_results": {"episode_reward_max": 112.37204937835925, "episode_reward_min": 77.16055138926055, "episode_reward_mean": 94.08330303115922, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.12471734500288, 109.00140821737624, 78.778529761538, 100.4952793278885, 80.65328661175178, 92.78406307269849, 89.86529501462006, 80.20654292688701, 99.62970681361182, 94.49729525620691, 93.8196552759009, 89.96082957834419, 100.39306925108654, 105.643335801844, 95.29975286919442, 101.03203987659852, 77.16055138926055, 98.42148047190071, 83.60550306158764, 95.58143587806175, 90.50412964734237, 87.21106519514014, 103.85150933923833, 98.44894289899382, 92.72796649546761, 86.25417062002596, 100.5780510841524, 94.98280061342159, 98.91367127975934, 112.37204937835925, 79.59952972723957, 98.92298719504502, 83.14417518159762, 97.22131912204036, 94.85805109196255, 79.32322675661372, 95.8489781934901, 97.4210953709272, 99.39839266891278, 90.22625066176985, 104.37025269870463, 109.4663955226867, 97.89442715066436, 108.1324929776612, 78.39862030673962, 98.1785015387027, 87.40095199543342, 90.43674529580136, 90.55007055265001, 83.59145243767463, 103.59899178488159, 90.87970181337894, 90.41090294732616, 91.7366486988102, 99.65579353398378, 102.59931482599185, 98.2172962073414, 110.19354500036901, 78.49563259963011, 106.00464599129415, 84.3959622598258, 90.90124068587784, 93.45007194286435, 81.85836034692764, 102.98641509013683, 95.33300127705856, 97.94148995633589, 89.0943288547681, 94.33404036726283, 100.69646383739519, 101.77853609387104, 98.85932705456804, 79.28972164421869, 96.90213376558451, 86.11689308496618, 91.20106586640055, 94.69506419350114, 79.15740088902808, 99.10931055791158, 91.08994911674742, 96.95439854164991, 84.70528175581751, 106.16921979910717, 103.94624381041865, 99.06365696556327, 98.78451790549369, 80.11186253663936, 98.08058317962191, 82.0915897313469, 87.68140184933054, 90.94197241498235, 82.34150239563984, 102.48303531756493, 91.1799355535605, 92.33831335122906, 83.65911311854853, 99.55816514653715, 106.14429324393211, 101.20869894421845, 106.72121646688652], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.665936797505657, "mean_inference_ms": 8.192460579014545, "mean_action_processing_ms": 0.559056990768424, "mean_env_wait_ms": 23.541671079202782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030496835708618164, "StateBufferConnector_ms": 0.03771471977233887, "ViewRequirementAgentConnector_ms": 0.9798104763031006}}, "episode_reward_max": 112.37204937835925, "episode_reward_min": 77.16055138926055, "episode_reward_mean": 94.08330303115922, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [96.12471734500288, 109.00140821737624, 78.778529761538, 100.4952793278885, 80.65328661175178, 92.78406307269849, 89.86529501462006, 80.20654292688701, 99.62970681361182, 94.49729525620691, 93.8196552759009, 89.96082957834419, 100.39306925108654, 105.643335801844, 95.29975286919442, 101.03203987659852, 77.16055138926055, 98.42148047190071, 83.60550306158764, 95.58143587806175, 90.50412964734237, 87.21106519514014, 103.85150933923833, 98.44894289899382, 92.72796649546761, 86.25417062002596, 100.5780510841524, 94.98280061342159, 98.91367127975934, 112.37204937835925, 79.59952972723957, 98.92298719504502, 83.14417518159762, 97.22131912204036, 94.85805109196255, 79.32322675661372, 95.8489781934901, 97.4210953709272, 99.39839266891278, 90.22625066176985, 104.37025269870463, 109.4663955226867, 97.89442715066436, 108.1324929776612, 78.39862030673962, 98.1785015387027, 87.40095199543342, 90.43674529580136, 90.55007055265001, 83.59145243767463, 103.59899178488159, 90.87970181337894, 90.41090294732616, 91.7366486988102, 99.65579353398378, 102.59931482599185, 98.2172962073414, 110.19354500036901, 78.49563259963011, 106.00464599129415, 84.3959622598258, 90.90124068587784, 93.45007194286435, 81.85836034692764, 102.98641509013683, 95.33300127705856, 97.94148995633589, 89.0943288547681, 94.33404036726283, 100.69646383739519, 101.77853609387104, 98.85932705456804, 79.28972164421869, 96.90213376558451, 86.11689308496618, 91.20106586640055, 94.69506419350114, 79.15740088902808, 99.10931055791158, 91.08994911674742, 96.95439854164991, 84.70528175581751, 106.16921979910717, 103.94624381041865, 99.06365696556327, 98.78451790549369, 80.11186253663936, 98.08058317962191, 82.0915897313469, 87.68140184933054, 90.94197241498235, 82.34150239563984, 102.48303531756493, 91.1799355535605, 92.33831335122906, 83.65911311854853, 99.55816514653715, 106.14429324393211, 101.20869894421845, 106.72121646688652], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.665936797505657, "mean_inference_ms": 8.192460579014545, "mean_action_processing_ms": 0.559056990768424, "mean_env_wait_ms": 23.541671079202782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030496835708618164, "StateBufferConnector_ms": 0.03771471977233887, "ViewRequirementAgentConnector_ms": 0.9798104763031006}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1792734, "num_agent_steps_trained": 1792734, "num_env_steps_sampled": 1792734, "num_env_steps_trained": 1792734, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 263.8223520844723, "num_env_steps_trained_throughput_per_sec": 263.8223520844723, "timesteps_total": 1792734, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1792734, "timers": {"training_iteration_time_ms": 59360.2, "sample_time_ms": 44408.002, "load_time_ms": 1815.863, "load_throughput": 8611.882, "learn_time_ms": 12530.279, "learn_throughput": 1248.017, "synch_weights_time_ms": 473.443}, "counters": {"num_env_steps_sampled": 1792734, "num_env_steps_trained": 1792734, "num_agent_steps_sampled": 1792734, "num_agent_steps_trained": 1792734}, "done": false, "episodes_total": 1893, "training_iteration": 135, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-42-26", "timestamp": 1749307346, "time_this_iter_s": 59.29773449897766, "time_total_s": 7613.794315814972, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7613.794315814972, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 77.67462686567166, "ram_util_percent": 57.29552238805971, "gpu_util_percent0": 0.08208955223880596, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.207266000000002e-05, "total_loss": -0.06701052549422126, "policy_loss": -0.0109429246885702, "vf_loss": 0.014876505999868228, "vf_explained_var": 0.978962353034453, "kl": 0.017855975711669164, "entropy": 16.029957391565496, "entropy_coeff": 0.003810899}, "model": {}, "num_grad_updates_lifetime": 63475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1808372, "num_env_steps_trained": 1808372, "num_agent_steps_sampled": 1808372, "num_agent_steps_trained": 1808372}, "sampler_results": {"episode_reward_max": 112.37204937835925, "episode_reward_min": 76.77641147176922, "episode_reward_mean": 93.81347504734983, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.29975286919442, 101.03203987659852, 77.16055138926055, 98.42148047190071, 83.60550306158764, 95.58143587806175, 90.50412964734237, 87.21106519514014, 103.85150933923833, 98.44894289899382, 92.72796649546761, 86.25417062002596, 100.5780510841524, 94.98280061342159, 98.91367127975934, 112.37204937835925, 79.59952972723957, 98.92298719504502, 83.14417518159762, 97.22131912204036, 94.85805109196255, 79.32322675661372, 95.8489781934901, 97.4210953709272, 99.39839266891278, 90.22625066176985, 104.37025269870463, 109.4663955226867, 97.89442715066436, 108.1324929776612, 78.39862030673962, 98.1785015387027, 87.40095199543342, 90.43674529580136, 90.55007055265001, 83.59145243767463, 103.59899178488159, 90.87970181337894, 90.41090294732616, 91.7366486988102, 99.65579353398378, 102.59931482599185, 98.2172962073414, 110.19354500036901, 78.49563259963011, 106.00464599129415, 84.3959622598258, 90.90124068587784, 93.45007194286435, 81.85836034692764, 102.98641509013683, 95.33300127705856, 97.94148995633589, 89.0943288547681, 94.33404036726283, 100.69646383739519, 101.77853609387104, 98.85932705456804, 79.28972164421869, 96.90213376558451, 86.11689308496618, 91.20106586640055, 94.69506419350114, 79.15740088902808, 99.10931055791158, 91.08994911674742, 96.95439854164991, 84.70528175581751, 106.16921979910717, 103.94624381041865, 99.06365696556327, 98.78451790549369, 80.11186253663936, 98.08058317962191, 82.0915897313469, 87.68140184933054, 90.94197241498235, 82.34150239563984, 102.48303531756493, 91.1799355535605, 92.33831335122906, 83.65911311854853, 99.55816514653715, 106.14429324393211, 101.20869894421845, 106.72121646688652, 76.77641147176922, 101.29668477694018, 81.23541099627542, 90.99292722140594, 90.23636645465878, 81.5322069171643, 102.69790559899296, 95.4955075629537, 91.59896498991489, 82.42606164833327, 97.3602808527797, 100.6133560111575, 91.67427454759931, 100.93385682387122], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6696773926859496, "mean_inference_ms": 8.19954608473483, "mean_action_processing_ms": 0.5594982287029017, "mean_env_wait_ms": 23.557335614540058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03252053260803223, "StateBufferConnector_ms": 0.036650896072387695, "ViewRequirementAgentConnector_ms": 0.9928970336914062}}, "episode_reward_max": 112.37204937835925, "episode_reward_min": 76.77641147176922, "episode_reward_mean": 93.81347504734983, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [95.29975286919442, 101.03203987659852, 77.16055138926055, 98.42148047190071, 83.60550306158764, 95.58143587806175, 90.50412964734237, 87.21106519514014, 103.85150933923833, 98.44894289899382, 92.72796649546761, 86.25417062002596, 100.5780510841524, 94.98280061342159, 98.91367127975934, 112.37204937835925, 79.59952972723957, 98.92298719504502, 83.14417518159762, 97.22131912204036, 94.85805109196255, 79.32322675661372, 95.8489781934901, 97.4210953709272, 99.39839266891278, 90.22625066176985, 104.37025269870463, 109.4663955226867, 97.89442715066436, 108.1324929776612, 78.39862030673962, 98.1785015387027, 87.40095199543342, 90.43674529580136, 90.55007055265001, 83.59145243767463, 103.59899178488159, 90.87970181337894, 90.41090294732616, 91.7366486988102, 99.65579353398378, 102.59931482599185, 98.2172962073414, 110.19354500036901, 78.49563259963011, 106.00464599129415, 84.3959622598258, 90.90124068587784, 93.45007194286435, 81.85836034692764, 102.98641509013683, 95.33300127705856, 97.94148995633589, 89.0943288547681, 94.33404036726283, 100.69646383739519, 101.77853609387104, 98.85932705456804, 79.28972164421869, 96.90213376558451, 86.11689308496618, 91.20106586640055, 94.69506419350114, 79.15740088902808, 99.10931055791158, 91.08994911674742, 96.95439854164991, 84.70528175581751, 106.16921979910717, 103.94624381041865, 99.06365696556327, 98.78451790549369, 80.11186253663936, 98.08058317962191, 82.0915897313469, 87.68140184933054, 90.94197241498235, 82.34150239563984, 102.48303531756493, 91.1799355535605, 92.33831335122906, 83.65911311854853, 99.55816514653715, 106.14429324393211, 101.20869894421845, 106.72121646688652, 76.77641147176922, 101.29668477694018, 81.23541099627542, 90.99292722140594, 90.23636645465878, 81.5322069171643, 102.69790559899296, 95.4955075629537, 91.59896498991489, 82.42606164833327, 97.3602808527797, 100.6133560111575, 91.67427454759931, 100.93385682387122], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6696773926859496, "mean_inference_ms": 8.19954608473483, "mean_action_processing_ms": 0.5594982287029017, "mean_env_wait_ms": 23.557335614540058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03252053260803223, "StateBufferConnector_ms": 0.036650896072387695, "ViewRequirementAgentConnector_ms": 0.9928970336914062}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1808372, "num_agent_steps_trained": 1808372, "num_env_steps_sampled": 1808372, "num_env_steps_trained": 1808372, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 255.83458466736926, "num_env_steps_trained_throughput_per_sec": 255.83458466736926, "timesteps_total": 1808372, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1808372, "timers": {"training_iteration_time_ms": 59547.571, "sample_time_ms": 44502.158, "load_time_ms": 1828.329, "load_throughput": 8553.165, "learn_time_ms": 12599.129, "learn_throughput": 1241.197, "synch_weights_time_ms": 484.339}, "counters": {"num_env_steps_sampled": 1808372, "num_env_steps_trained": 1808372, "num_agent_steps_sampled": 1808372, "num_agent_steps_trained": 1808372}, "done": false, "episodes_total": 1907, "training_iteration": 136, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-43-27", "timestamp": 1749307407, "time_this_iter_s": 61.14056897163391, "time_total_s": 7674.934884786606, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7674.934884786606, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 77.78142857142856, "ram_util_percent": 58.041428571428575, "gpu_util_percent0": 0.0812857142857143, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.191628e-05, "total_loss": -0.07806293516282246, "policy_loss": -0.022550830942663278, "vf_loss": 0.01595189090521837, "vf_explained_var": 0.9778730641711842, "kl": 0.017876406237435083, "entropy": 16.067917749231512, "entropy_coeff": 0.0037874420000000002}, "model": {}, "num_grad_updates_lifetime": 64025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1824010, "num_env_steps_trained": 1824010, "num_agent_steps_sampled": 1824010, "num_agent_steps_trained": 1824010}, "sampler_results": {"episode_reward_max": 112.37204937835925, "episode_reward_min": 76.77641147176922, "episode_reward_mean": 93.71341116172358, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.91367127975934, 112.37204937835925, 79.59952972723957, 98.92298719504502, 83.14417518159762, 97.22131912204036, 94.85805109196255, 79.32322675661372, 95.8489781934901, 97.4210953709272, 99.39839266891278, 90.22625066176985, 104.37025269870463, 109.4663955226867, 97.89442715066436, 108.1324929776612, 78.39862030673962, 98.1785015387027, 87.40095199543342, 90.43674529580136, 90.55007055265001, 83.59145243767463, 103.59899178488159, 90.87970181337894, 90.41090294732616, 91.7366486988102, 99.65579353398378, 102.59931482599185, 98.2172962073414, 110.19354500036901, 78.49563259963011, 106.00464599129415, 84.3959622598258, 90.90124068587784, 93.45007194286435, 81.85836034692764, 102.98641509013683, 95.33300127705856, 97.94148995633589, 89.0943288547681, 94.33404036726283, 100.69646383739519, 101.77853609387104, 98.85932705456804, 79.28972164421869, 96.90213376558451, 86.11689308496618, 91.20106586640055, 94.69506419350114, 79.15740088902808, 99.10931055791158, 91.08994911674742, 96.95439854164991, 84.70528175581751, 106.16921979910717, 103.94624381041865, 99.06365696556327, 98.78451790549369, 80.11186253663936, 98.08058317962191, 82.0915897313469, 87.68140184933054, 90.94197241498235, 82.34150239563984, 102.48303531756493, 91.1799355535605, 92.33831335122906, 83.65911311854853, 99.55816514653715, 106.14429324393211, 101.20869894421845, 106.72121646688652, 76.77641147176922, 101.29668477694018, 81.23541099627542, 90.99292722140594, 90.23636645465878, 81.5322069171643, 102.69790559899296, 95.4955075629537, 91.59896498991489, 82.42606164833327, 97.3602808527797, 100.6133560111575, 91.67427454759931, 100.93385682387122, 80.4430508222797, 101.27818869861123, 80.46221120645801, 93.64214043000081, 86.36896012002678, 79.21372832788315, 98.24250163593942, 92.51532221057947, 89.8136278726442, 87.19740000745267, 94.13378785767394, 110.46728609798205, 96.00770662604886, 105.86709896417929], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6733005222926947, "mean_inference_ms": 8.206422071214938, "mean_action_processing_ms": 0.559919013902154, "mean_env_wait_ms": 23.572180518400728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03455185890197754, "StateBufferConnector_ms": 0.029233932495117188, "ViewRequirementAgentConnector_ms": 0.9814205169677734}}, "episode_reward_max": 112.37204937835925, "episode_reward_min": 76.77641147176922, "episode_reward_mean": 93.71341116172358, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [98.91367127975934, 112.37204937835925, 79.59952972723957, 98.92298719504502, 83.14417518159762, 97.22131912204036, 94.85805109196255, 79.32322675661372, 95.8489781934901, 97.4210953709272, 99.39839266891278, 90.22625066176985, 104.37025269870463, 109.4663955226867, 97.89442715066436, 108.1324929776612, 78.39862030673962, 98.1785015387027, 87.40095199543342, 90.43674529580136, 90.55007055265001, 83.59145243767463, 103.59899178488159, 90.87970181337894, 90.41090294732616, 91.7366486988102, 99.65579353398378, 102.59931482599185, 98.2172962073414, 110.19354500036901, 78.49563259963011, 106.00464599129415, 84.3959622598258, 90.90124068587784, 93.45007194286435, 81.85836034692764, 102.98641509013683, 95.33300127705856, 97.94148995633589, 89.0943288547681, 94.33404036726283, 100.69646383739519, 101.77853609387104, 98.85932705456804, 79.28972164421869, 96.90213376558451, 86.11689308496618, 91.20106586640055, 94.69506419350114, 79.15740088902808, 99.10931055791158, 91.08994911674742, 96.95439854164991, 84.70528175581751, 106.16921979910717, 103.94624381041865, 99.06365696556327, 98.78451790549369, 80.11186253663936, 98.08058317962191, 82.0915897313469, 87.68140184933054, 90.94197241498235, 82.34150239563984, 102.48303531756493, 91.1799355535605, 92.33831335122906, 83.65911311854853, 99.55816514653715, 106.14429324393211, 101.20869894421845, 106.72121646688652, 76.77641147176922, 101.29668477694018, 81.23541099627542, 90.99292722140594, 90.23636645465878, 81.5322069171643, 102.69790559899296, 95.4955075629537, 91.59896498991489, 82.42606164833327, 97.3602808527797, 100.6133560111575, 91.67427454759931, 100.93385682387122, 80.4430508222797, 101.27818869861123, 80.46221120645801, 93.64214043000081, 86.36896012002678, 79.21372832788315, 98.24250163593942, 92.51532221057947, 89.8136278726442, 87.19740000745267, 94.13378785767394, 110.46728609798205, 96.00770662604886, 105.86709896417929], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6733005222926947, "mean_inference_ms": 8.206422071214938, "mean_action_processing_ms": 0.559919013902154, "mean_env_wait_ms": 23.572180518400728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03455185890197754, "StateBufferConnector_ms": 0.029233932495117188, "ViewRequirementAgentConnector_ms": 0.9814205169677734}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824010, "num_agent_steps_trained": 1824010, "num_env_steps_sampled": 1824010, "num_env_steps_trained": 1824010, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 264.05180935955235, "num_env_steps_trained_throughput_per_sec": 264.05180935955235, "timesteps_total": 1824010, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1824010, "timers": {"training_iteration_time_ms": 59600.482, "sample_time_ms": 44488.838, "load_time_ms": 1849.095, "load_throughput": 8457.11, "learn_time_ms": 12650.886, "learn_throughput": 1236.119, "synch_weights_time_ms": 479.233}, "counters": {"num_env_steps_sampled": 1824010, "num_env_steps_trained": 1824010, "num_agent_steps_sampled": 1824010, "num_agent_steps_trained": 1824010}, "done": false, "episodes_total": 1921, "training_iteration": 137, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-44-26", "timestamp": 1749307466, "time_this_iter_s": 59.243221282958984, "time_total_s": 7734.178106069565, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7734.178106069565, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 77.45441176470588, "ram_util_percent": 57.73088235294118, "gpu_util_percent0": 0.09308823529411767, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.175990000000001e-05, "total_loss": -0.05984786035958677, "policy_loss": -0.004349284217989241, "vf_loss": 0.014205755780620331, "vf_explained_var": 0.9796575513753024, "kl": 0.01788202136273849, "entropy": 16.025334047837692, "entropy_coeff": 0.0037639850000000014}, "model": {}, "num_grad_updates_lifetime": 64575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1839648, "num_env_steps_trained": 1839648, "num_agent_steps_sampled": 1839648, "num_agent_steps_trained": 1839648}, "sampler_results": {"episode_reward_max": 110.46728609798205, "episode_reward_min": 76.77641147176922, "episode_reward_mean": 93.1821181464567, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.89442715066436, 108.1324929776612, 78.39862030673962, 98.1785015387027, 87.40095199543342, 90.43674529580136, 90.55007055265001, 83.59145243767463, 103.59899178488159, 90.87970181337894, 90.41090294732616, 91.7366486988102, 99.65579353398378, 102.59931482599185, 98.2172962073414, 110.19354500036901, 78.49563259963011, 106.00464599129415, 84.3959622598258, 90.90124068587784, 93.45007194286435, 81.85836034692764, 102.98641509013683, 95.33300127705856, 97.94148995633589, 89.0943288547681, 94.33404036726283, 100.69646383739519, 101.77853609387104, 98.85932705456804, 79.28972164421869, 96.90213376558451, 86.11689308496618, 91.20106586640055, 94.69506419350114, 79.15740088902808, 99.10931055791158, 91.08994911674742, 96.95439854164991, 84.70528175581751, 106.16921979910717, 103.94624381041865, 99.06365696556327, 98.78451790549369, 80.11186253663936, 98.08058317962191, 82.0915897313469, 87.68140184933054, 90.94197241498235, 82.34150239563984, 102.48303531756493, 91.1799355535605, 92.33831335122906, 83.65911311854853, 99.55816514653715, 106.14429324393211, 101.20869894421845, 106.72121646688652, 76.77641147176922, 101.29668477694018, 81.23541099627542, 90.99292722140594, 90.23636645465878, 81.5322069171643, 102.69790559899296, 95.4955075629537, 91.59896498991489, 82.42606164833327, 97.3602808527797, 100.6133560111575, 91.67427454759931, 100.93385682387122, 80.4430508222797, 101.27818869861123, 80.46221120645801, 93.64214043000081, 86.36896012002678, 79.21372832788315, 98.24250163593942, 92.51532221057947, 89.8136278726442, 87.19740000745267, 94.13378785767394, 110.46728609798205, 96.00770662604886, 105.86709896417929, 81.38847723812094, 97.95602750729262, 79.25416092218892, 85.72805300288483, 93.2779523821215, 78.10912533768837, 100.3642103302183, 92.7205883151107, 96.159642765871, 81.25860413141194, 94.4745745521771, 100.5541721970902, 99.50887039628526, 107.20261424396266], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6770399383751284, "mean_inference_ms": 8.213384378000589, "mean_action_processing_ms": 0.5603360515622338, "mean_env_wait_ms": 23.58674822288469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034578800201416016, "StateBufferConnector_ms": 0.03411126136779785, "ViewRequirementAgentConnector_ms": 0.9951534271240234}}, "episode_reward_max": 110.46728609798205, "episode_reward_min": 76.77641147176922, "episode_reward_mean": 93.1821181464567, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [97.89442715066436, 108.1324929776612, 78.39862030673962, 98.1785015387027, 87.40095199543342, 90.43674529580136, 90.55007055265001, 83.59145243767463, 103.59899178488159, 90.87970181337894, 90.41090294732616, 91.7366486988102, 99.65579353398378, 102.59931482599185, 98.2172962073414, 110.19354500036901, 78.49563259963011, 106.00464599129415, 84.3959622598258, 90.90124068587784, 93.45007194286435, 81.85836034692764, 102.98641509013683, 95.33300127705856, 97.94148995633589, 89.0943288547681, 94.33404036726283, 100.69646383739519, 101.77853609387104, 98.85932705456804, 79.28972164421869, 96.90213376558451, 86.11689308496618, 91.20106586640055, 94.69506419350114, 79.15740088902808, 99.10931055791158, 91.08994911674742, 96.95439854164991, 84.70528175581751, 106.16921979910717, 103.94624381041865, 99.06365696556327, 98.78451790549369, 80.11186253663936, 98.08058317962191, 82.0915897313469, 87.68140184933054, 90.94197241498235, 82.34150239563984, 102.48303531756493, 91.1799355535605, 92.33831335122906, 83.65911311854853, 99.55816514653715, 106.14429324393211, 101.20869894421845, 106.72121646688652, 76.77641147176922, 101.29668477694018, 81.23541099627542, 90.99292722140594, 90.23636645465878, 81.5322069171643, 102.69790559899296, 95.4955075629537, 91.59896498991489, 82.42606164833327, 97.3602808527797, 100.6133560111575, 91.67427454759931, 100.93385682387122, 80.4430508222797, 101.27818869861123, 80.46221120645801, 93.64214043000081, 86.36896012002678, 79.21372832788315, 98.24250163593942, 92.51532221057947, 89.8136278726442, 87.19740000745267, 94.13378785767394, 110.46728609798205, 96.00770662604886, 105.86709896417929, 81.38847723812094, 97.95602750729262, 79.25416092218892, 85.72805300288483, 93.2779523821215, 78.10912533768837, 100.3642103302183, 92.7205883151107, 96.159642765871, 81.25860413141194, 94.4745745521771, 100.5541721970902, 99.50887039628526, 107.20261424396266], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6770399383751284, "mean_inference_ms": 8.213384378000589, "mean_action_processing_ms": 0.5603360515622338, "mean_env_wait_ms": 23.58674822288469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034578800201416016, "StateBufferConnector_ms": 0.03411126136779785, "ViewRequirementAgentConnector_ms": 0.9951534271240234}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1839648, "num_agent_steps_trained": 1839648, "num_env_steps_sampled": 1839648, "num_env_steps_trained": 1839648, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 260.9306123754471, "num_env_steps_trained_throughput_per_sec": 260.9306123754471, "timesteps_total": 1839648, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1839648, "timers": {"training_iteration_time_ms": 59701.795, "sample_time_ms": 44523.548, "load_time_ms": 1844.972, "load_throughput": 8476.009, "learn_time_ms": 12721.353, "learn_throughput": 1229.272, "synch_weights_time_ms": 478.282}, "counters": {"num_env_steps_sampled": 1839648, "num_env_steps_trained": 1839648, "num_agent_steps_sampled": 1839648, "num_agent_steps_trained": 1839648}, "done": false, "episodes_total": 1935, "training_iteration": 138, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-45-26", "timestamp": 1749307526, "time_this_iter_s": 59.951663970947266, "time_total_s": 7794.129770040512, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7794.129770040512, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 78.19264705882351, "ram_util_percent": 57.05147058823529, "gpu_util_percent0": 0.0863235294117647, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.160352000000001e-05, "total_loss": -0.06184513587165963, "policy_loss": -0.00737105302803684, "vf_loss": 0.016378515748815103, "vf_explained_var": 0.9773674622449008, "kl": 0.0181430500625165, "entropy": 16.02838154706088, "entropy_coeff": 0.003740528}, "model": {}, "num_grad_updates_lifetime": 65125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1855286, "num_env_steps_trained": 1855286, "num_agent_steps_sampled": 1855286, "num_agent_steps_trained": 1855286}, "sampler_results": {"episode_reward_max": 110.46728609798205, "episode_reward_min": 76.77641147176922, "episode_reward_mean": 92.92300456677532, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.2172962073414, 110.19354500036901, 78.49563259963011, 106.00464599129415, 84.3959622598258, 90.90124068587784, 93.45007194286435, 81.85836034692764, 102.98641509013683, 95.33300127705856, 97.94148995633589, 89.0943288547681, 94.33404036726283, 100.69646383739519, 101.77853609387104, 98.85932705456804, 79.28972164421869, 96.90213376558451, 86.11689308496618, 91.20106586640055, 94.69506419350114, 79.15740088902808, 99.10931055791158, 91.08994911674742, 96.95439854164991, 84.70528175581751, 106.16921979910717, 103.94624381041865, 99.06365696556327, 98.78451790549369, 80.11186253663936, 98.08058317962191, 82.0915897313469, 87.68140184933054, 90.94197241498235, 82.34150239563984, 102.48303531756493, 91.1799355535605, 92.33831335122906, 83.65911311854853, 99.55816514653715, 106.14429324393211, 101.20869894421845, 106.72121646688652, 76.77641147176922, 101.29668477694018, 81.23541099627542, 90.99292722140594, 90.23636645465878, 81.5322069171643, 102.69790559899296, 95.4955075629537, 91.59896498991489, 82.42606164833327, 97.3602808527797, 100.6133560111575, 91.67427454759931, 100.93385682387122, 80.4430508222797, 101.27818869861123, 80.46221120645801, 93.64214043000081, 86.36896012002678, 79.21372832788315, 98.24250163593942, 92.51532221057947, 89.8136278726442, 87.19740000745267, 94.13378785767394, 110.46728609798205, 96.00770662604886, 105.86709896417929, 81.38847723812094, 97.95602750729262, 79.25416092218892, 85.72805300288483, 93.2779523821215, 78.10912533768837, 100.3642103302183, 92.7205883151107, 96.159642765871, 81.25860413141194, 94.4745745521771, 100.5541721970902, 99.50887039628526, 107.20261424396266, 79.41568689568079, 93.12927463747104, 82.22857794113048, 87.51914093369346, 90.0490840030532, 78.96625277020658, 102.97690333674663, 100.65739487478356, 93.22671599856135, 80.82424895124186, 93.71293406994705, 105.35210432554801, 97.96288839472258, 101.53205075877239], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6807700336500306, "mean_inference_ms": 8.220669606177465, "mean_action_processing_ms": 0.5607784493108079, "mean_env_wait_ms": 23.60205037600128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03909754753112793, "StateBufferConnector_ms": 0.06708431243896484, "ViewRequirementAgentConnector_ms": 1.0288710594177246}}, "episode_reward_max": 110.46728609798205, "episode_reward_min": 76.77641147176922, "episode_reward_mean": 92.92300456677532, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [98.2172962073414, 110.19354500036901, 78.49563259963011, 106.00464599129415, 84.3959622598258, 90.90124068587784, 93.45007194286435, 81.85836034692764, 102.98641509013683, 95.33300127705856, 97.94148995633589, 89.0943288547681, 94.33404036726283, 100.69646383739519, 101.77853609387104, 98.85932705456804, 79.28972164421869, 96.90213376558451, 86.11689308496618, 91.20106586640055, 94.69506419350114, 79.15740088902808, 99.10931055791158, 91.08994911674742, 96.95439854164991, 84.70528175581751, 106.16921979910717, 103.94624381041865, 99.06365696556327, 98.78451790549369, 80.11186253663936, 98.08058317962191, 82.0915897313469, 87.68140184933054, 90.94197241498235, 82.34150239563984, 102.48303531756493, 91.1799355535605, 92.33831335122906, 83.65911311854853, 99.55816514653715, 106.14429324393211, 101.20869894421845, 106.72121646688652, 76.77641147176922, 101.29668477694018, 81.23541099627542, 90.99292722140594, 90.23636645465878, 81.5322069171643, 102.69790559899296, 95.4955075629537, 91.59896498991489, 82.42606164833327, 97.3602808527797, 100.6133560111575, 91.67427454759931, 100.93385682387122, 80.4430508222797, 101.27818869861123, 80.46221120645801, 93.64214043000081, 86.36896012002678, 79.21372832788315, 98.24250163593942, 92.51532221057947, 89.8136278726442, 87.19740000745267, 94.13378785767394, 110.46728609798205, 96.00770662604886, 105.86709896417929, 81.38847723812094, 97.95602750729262, 79.25416092218892, 85.72805300288483, 93.2779523821215, 78.10912533768837, 100.3642103302183, 92.7205883151107, 96.159642765871, 81.25860413141194, 94.4745745521771, 100.5541721970902, 99.50887039628526, 107.20261424396266, 79.41568689568079, 93.12927463747104, 82.22857794113048, 87.51914093369346, 90.0490840030532, 78.96625277020658, 102.97690333674663, 100.65739487478356, 93.22671599856135, 80.82424895124186, 93.71293406994705, 105.35210432554801, 97.96288839472258, 101.53205075877239], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6807700336500306, "mean_inference_ms": 8.220669606177465, "mean_action_processing_ms": 0.5607784493108079, "mean_env_wait_ms": 23.60205037600128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03909754753112793, "StateBufferConnector_ms": 0.06708431243896484, "ViewRequirementAgentConnector_ms": 1.0288710594177246}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1855286, "num_agent_steps_trained": 1855286, "num_env_steps_sampled": 1855286, "num_env_steps_trained": 1855286, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 258.27399934600777, "num_env_steps_trained_throughput_per_sec": 258.27399934600777, "timesteps_total": 1855286, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1855286, "timers": {"training_iteration_time_ms": 59589.585, "sample_time_ms": 44390.795, "load_time_ms": 1850.547, "load_throughput": 8450.477, "learn_time_ms": 12742.995, "learn_throughput": 1227.184, "synch_weights_time_ms": 471.9}, "counters": {"num_env_steps_sampled": 1855286, "num_env_steps_trained": 1855286, "num_agent_steps_sampled": 1855286, "num_agent_steps_trained": 1855286}, "done": false, "episodes_total": 1949, "training_iteration": 139, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-46-27", "timestamp": 1749307587, "time_this_iter_s": 60.565510272979736, "time_total_s": 7854.695280313492, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7854.695280313492, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 76.78571428571429, "ram_util_percent": 57.15714285714284, "gpu_util_percent0": 0.08742857142857141, "vram_util_percent0": 0.8409830729166665}}
{"evaluation": {"sampler_results": {"episode_reward_max": -1.460288043514141, "episode_reward_min": -3.232545665851649, "episode_reward_mean": -2.3597601853725325, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.981228084351313, -3.232545665851649, -2.2776784272475323, -1.460288043514141, -1.8470607058980286], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7211333758230765, "mean_inference_ms": 3.945841847364877, "mean_action_processing_ms": 0.2960532952258236, "mean_env_wait_ms": 12.559392068911928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008187294006347656, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2999401092529297}}, "episode_reward_max": -1.460288043514141, "episode_reward_min": -3.232545665851649, "episode_reward_mean": -2.3597601853725325, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.981228084351313, -3.232545665851649, -2.2776784272475323, -1.460288043514141, -1.8470607058980286], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7211333758230765, "mean_inference_ms": 3.945841847364877, "mean_action_processing_ms": 0.2960532952258236, "mean_env_wait_ms": 12.559392068911928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008187294006347656, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2999401092529297}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.144714e-05, "total_loss": -0.06397648649290204, "policy_loss": -0.008812625554961744, "vf_loss": 0.012988542737439275, "vf_explained_var": 0.9798471559177745, "kl": 0.01839692302006334, "entropy": 16.04363542209972, "entropy_coeff": 0.0037170709999999997}, "model": {}, "num_grad_updates_lifetime": 65675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1870924, "num_env_steps_trained": 1870924, "num_agent_steps_sampled": 1870924, "num_agent_steps_trained": 1870924}, "sampler_results": {"episode_reward_max": 110.46728609798205, "episode_reward_min": 76.77641147176922, "episode_reward_mean": 92.6434122115201, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.77853609387104, 98.85932705456804, 79.28972164421869, 96.90213376558451, 86.11689308496618, 91.20106586640055, 94.69506419350114, 79.15740088902808, 99.10931055791158, 91.08994911674742, 96.95439854164991, 84.70528175581751, 106.16921979910717, 103.94624381041865, 99.06365696556327, 98.78451790549369, 80.11186253663936, 98.08058317962191, 82.0915897313469, 87.68140184933054, 90.94197241498235, 82.34150239563984, 102.48303531756493, 91.1799355535605, 92.33831335122906, 83.65911311854853, 99.55816514653715, 106.14429324393211, 101.20869894421845, 106.72121646688652, 76.77641147176922, 101.29668477694018, 81.23541099627542, 90.99292722140594, 90.23636645465878, 81.5322069171643, 102.69790559899296, 95.4955075629537, 91.59896498991489, 82.42606164833327, 97.3602808527797, 100.6133560111575, 91.67427454759931, 100.93385682387122, 80.4430508222797, 101.27818869861123, 80.46221120645801, 93.64214043000081, 86.36896012002678, 79.21372832788315, 98.24250163593942, 92.51532221057947, 89.8136278726442, 87.19740000745267, 94.13378785767394, 110.46728609798205, 96.00770662604886, 105.86709896417929, 81.38847723812094, 97.95602750729262, 79.25416092218892, 85.72805300288483, 93.2779523821215, 78.10912533768837, 100.3642103302183, 92.7205883151107, 96.159642765871, 81.25860413141194, 94.4745745521771, 100.5541721970902, 99.50887039628526, 107.20261424396266, 79.41568689568079, 93.12927463747104, 82.22857794113048, 87.51914093369346, 90.0490840030532, 78.96625277020658, 102.97690333674663, 100.65739487478356, 93.22671599856135, 80.82424895124186, 93.71293406994705, 105.35210432554801, 97.96288839472258, 101.53205075877239, 82.92464940803056, 88.15994531744052, 83.90493649521407, 94.49320154793381, 89.01770715914314, 81.74604526812276, 97.40296784228283, 94.71589219622842, 92.75359720790803, 85.14195338657039, 102.06857292160336, 101.25332128732273, 98.3378694595407, 104.02259939422238], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6843485944792174, "mean_inference_ms": 8.227805718244243, "mean_action_processing_ms": 0.5612109297577517, "mean_env_wait_ms": 23.616786456632163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041124820709228516, "StateBufferConnector_ms": 0.0690755844116211, "ViewRequirementAgentConnector_ms": 1.0271384716033936}}, "episode_reward_max": 110.46728609798205, "episode_reward_min": 76.77641147176922, "episode_reward_mean": 92.6434122115201, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [101.77853609387104, 98.85932705456804, 79.28972164421869, 96.90213376558451, 86.11689308496618, 91.20106586640055, 94.69506419350114, 79.15740088902808, 99.10931055791158, 91.08994911674742, 96.95439854164991, 84.70528175581751, 106.16921979910717, 103.94624381041865, 99.06365696556327, 98.78451790549369, 80.11186253663936, 98.08058317962191, 82.0915897313469, 87.68140184933054, 90.94197241498235, 82.34150239563984, 102.48303531756493, 91.1799355535605, 92.33831335122906, 83.65911311854853, 99.55816514653715, 106.14429324393211, 101.20869894421845, 106.72121646688652, 76.77641147176922, 101.29668477694018, 81.23541099627542, 90.99292722140594, 90.23636645465878, 81.5322069171643, 102.69790559899296, 95.4955075629537, 91.59896498991489, 82.42606164833327, 97.3602808527797, 100.6133560111575, 91.67427454759931, 100.93385682387122, 80.4430508222797, 101.27818869861123, 80.46221120645801, 93.64214043000081, 86.36896012002678, 79.21372832788315, 98.24250163593942, 92.51532221057947, 89.8136278726442, 87.19740000745267, 94.13378785767394, 110.46728609798205, 96.00770662604886, 105.86709896417929, 81.38847723812094, 97.95602750729262, 79.25416092218892, 85.72805300288483, 93.2779523821215, 78.10912533768837, 100.3642103302183, 92.7205883151107, 96.159642765871, 81.25860413141194, 94.4745745521771, 100.5541721970902, 99.50887039628526, 107.20261424396266, 79.41568689568079, 93.12927463747104, 82.22857794113048, 87.51914093369346, 90.0490840030532, 78.96625277020658, 102.97690333674663, 100.65739487478356, 93.22671599856135, 80.82424895124186, 93.71293406994705, 105.35210432554801, 97.96288839472258, 101.53205075877239, 82.92464940803056, 88.15994531744052, 83.90493649521407, 94.49320154793381, 89.01770715914314, 81.74604526812276, 97.40296784228283, 94.71589219622842, 92.75359720790803, 85.14195338657039, 102.06857292160336, 101.25332128732273, 98.3378694595407, 104.02259939422238], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6843485944792174, "mean_inference_ms": 8.227805718244243, "mean_action_processing_ms": 0.5612109297577517, "mean_env_wait_ms": 23.616786456632163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041124820709228516, "StateBufferConnector_ms": 0.0690755844116211, "ViewRequirementAgentConnector_ms": 1.0271384716033936}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1870924, "num_agent_steps_trained": 1870924, "num_env_steps_sampled": 1870924, "num_env_steps_trained": 1870924, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 262.77800044708357, "num_env_steps_trained_throughput_per_sec": 262.77800044708357, "timesteps_total": 1870924, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1870924, "timers": {"training_iteration_time_ms": 59632.719, "sample_time_ms": 44462.17, "load_time_ms": 1847.339, "load_throughput": 8465.15, "learn_time_ms": 12724.116, "learn_throughput": 1229.005, "synch_weights_time_ms": 464.816}, "counters": {"num_env_steps_sampled": 1870924, "num_env_steps_trained": 1870924, "num_agent_steps_sampled": 1870924, "num_agent_steps_trained": 1870924}, "done": false, "episodes_total": 1963, "training_iteration": 140, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-47-44", "timestamp": 1749307664, "time_this_iter_s": 77.14260387420654, "time_total_s": 7931.837884187698, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7931.837884187698, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 64.49222222222221, "ram_util_percent": 56.9088888888889, "gpu_util_percent0": 0.06377777777777778, "vram_util_percent0": 0.8409830729166669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.129076000000003e-05, "total_loss": -0.07238624471112746, "policy_loss": -0.017529735229697755, "vf_loss": 0.01332283098123629, "vf_explained_var": 0.9790893536264246, "kl": 0.018282453803800638, "entropy": 16.088494458632034, "entropy_coeff": 0.003693614000000001}, "model": {}, "num_grad_updates_lifetime": 66225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1886562, "num_env_steps_trained": 1886562, "num_agent_steps_sampled": 1886562, "num_agent_steps_trained": 1886562}, "sampler_results": {"episode_reward_max": 110.46728609798205, "episode_reward_min": 76.77641147176922, "episode_reward_mean": 92.42623010332714, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [99.06365696556327, 98.78451790549369, 80.11186253663936, 98.08058317962191, 82.0915897313469, 87.68140184933054, 90.94197241498235, 82.34150239563984, 102.48303531756493, 91.1799355535605, 92.33831335122906, 83.65911311854853, 99.55816514653715, 106.14429324393211, 101.20869894421845, 106.72121646688652, 76.77641147176922, 101.29668477694018, 81.23541099627542, 90.99292722140594, 90.23636645465878, 81.5322069171643, 102.69790559899296, 95.4955075629537, 91.59896498991489, 82.42606164833327, 97.3602808527797, 100.6133560111575, 91.67427454759931, 100.93385682387122, 80.4430508222797, 101.27818869861123, 80.46221120645801, 93.64214043000081, 86.36896012002678, 79.21372832788315, 98.24250163593942, 92.51532221057947, 89.8136278726442, 87.19740000745267, 94.13378785767394, 110.46728609798205, 96.00770662604886, 105.86709896417929, 81.38847723812094, 97.95602750729262, 79.25416092218892, 85.72805300288483, 93.2779523821215, 78.10912533768837, 100.3642103302183, 92.7205883151107, 96.159642765871, 81.25860413141194, 94.4745745521771, 100.5541721970902, 99.50887039628526, 107.20261424396266, 79.41568689568079, 93.12927463747104, 82.22857794113048, 87.51914093369346, 90.0490840030532, 78.96625277020658, 102.97690333674663, 100.65739487478356, 93.22671599856135, 80.82424895124186, 93.71293406994705, 105.35210432554801, 97.96288839472258, 101.53205075877239, 82.92464940803056, 88.15994531744052, 83.90493649521407, 94.49320154793381, 89.01770715914314, 81.74604526812276, 97.40296784228283, 94.71589219622842, 92.75359720790803, 85.14195338657039, 102.06857292160336, 101.25332128732273, 98.3378694595407, 104.02259939422238, 78.50939399419126, 91.77913362304538, 86.31021684081999, 90.04335472483442, 93.27727073217117, 82.66660453349041, 97.65911595373223, 93.06692885994562, 88.78962794328584, 88.75073781473657, 91.48510398179286, 104.54114276610991, 100.8015218802863, 100.57618170605382], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6876808285319185, "mean_inference_ms": 8.23502097843696, "mean_action_processing_ms": 0.5616607172457835, "mean_env_wait_ms": 23.63139475127038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037017822265625, "StateBufferConnector_ms": 0.07006597518920898, "ViewRequirementAgentConnector_ms": 1.0343201160430908}}, "episode_reward_max": 110.46728609798205, "episode_reward_min": 76.77641147176922, "episode_reward_mean": 92.42623010332714, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [99.06365696556327, 98.78451790549369, 80.11186253663936, 98.08058317962191, 82.0915897313469, 87.68140184933054, 90.94197241498235, 82.34150239563984, 102.48303531756493, 91.1799355535605, 92.33831335122906, 83.65911311854853, 99.55816514653715, 106.14429324393211, 101.20869894421845, 106.72121646688652, 76.77641147176922, 101.29668477694018, 81.23541099627542, 90.99292722140594, 90.23636645465878, 81.5322069171643, 102.69790559899296, 95.4955075629537, 91.59896498991489, 82.42606164833327, 97.3602808527797, 100.6133560111575, 91.67427454759931, 100.93385682387122, 80.4430508222797, 101.27818869861123, 80.46221120645801, 93.64214043000081, 86.36896012002678, 79.21372832788315, 98.24250163593942, 92.51532221057947, 89.8136278726442, 87.19740000745267, 94.13378785767394, 110.46728609798205, 96.00770662604886, 105.86709896417929, 81.38847723812094, 97.95602750729262, 79.25416092218892, 85.72805300288483, 93.2779523821215, 78.10912533768837, 100.3642103302183, 92.7205883151107, 96.159642765871, 81.25860413141194, 94.4745745521771, 100.5541721970902, 99.50887039628526, 107.20261424396266, 79.41568689568079, 93.12927463747104, 82.22857794113048, 87.51914093369346, 90.0490840030532, 78.96625277020658, 102.97690333674663, 100.65739487478356, 93.22671599856135, 80.82424895124186, 93.71293406994705, 105.35210432554801, 97.96288839472258, 101.53205075877239, 82.92464940803056, 88.15994531744052, 83.90493649521407, 94.49320154793381, 89.01770715914314, 81.74604526812276, 97.40296784228283, 94.71589219622842, 92.75359720790803, 85.14195338657039, 102.06857292160336, 101.25332128732273, 98.3378694595407, 104.02259939422238, 78.50939399419126, 91.77913362304538, 86.31021684081999, 90.04335472483442, 93.27727073217117, 82.66660453349041, 97.65911595373223, 93.06692885994562, 88.78962794328584, 88.75073781473657, 91.48510398179286, 104.54114276610991, 100.8015218802863, 100.57618170605382], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6876808285319185, "mean_inference_ms": 8.23502097843696, "mean_action_processing_ms": 0.5616607172457835, "mean_env_wait_ms": 23.63139475127038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037017822265625, "StateBufferConnector_ms": 0.07006597518920898, "ViewRequirementAgentConnector_ms": 1.0343201160430908}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1886562, "num_agent_steps_trained": 1886562, "num_env_steps_sampled": 1886562, "num_env_steps_trained": 1886562, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 261.2286806288287, "num_env_steps_trained_throughput_per_sec": 261.2286806288287, "timesteps_total": 1886562, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1886562, "timers": {"training_iteration_time_ms": 59689.856, "sample_time_ms": 44430.139, "load_time_ms": 1866.479, "load_throughput": 8378.34, "learn_time_ms": 12791.862, "learn_throughput": 1222.496, "synch_weights_time_ms": 473.245}, "counters": {"num_env_steps_sampled": 1886562, "num_env_steps_trained": 1886562, "num_agent_steps_sampled": 1886562, "num_agent_steps_trained": 1886562}, "done": false, "episodes_total": 1977, "training_iteration": 141, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-48-44", "timestamp": 1749307724, "time_this_iter_s": 59.89082431793213, "time_total_s": 7991.7287085056305, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 7991.7287085056305, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 76.79852941176469, "ram_util_percent": 57.438235294117646, "gpu_util_percent0": 0.08514705882352942, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.113438000000001e-05, "total_loss": -0.07235471340742979, "policy_loss": -0.018619432837109675, "vf_loss": 0.01515632928560742, "vf_explained_var": 0.976984921802174, "kl": 0.017890830297229432, "entropy": 16.03235685348511, "entropy_coeff": 0.0036701570000000003}, "model": {}, "num_grad_updates_lifetime": 66775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1902200, "num_env_steps_trained": 1902200, "num_agent_steps_sampled": 1902200, "num_agent_steps_trained": 1902200}, "sampler_results": {"episode_reward_max": 110.46728609798205, "episode_reward_min": 63.938341199281076, "episode_reward_mean": 92.14002044225715, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.20869894421845, 106.72121646688652, 76.77641147176922, 101.29668477694018, 81.23541099627542, 90.99292722140594, 90.23636645465878, 81.5322069171643, 102.69790559899296, 95.4955075629537, 91.59896498991489, 82.42606164833327, 97.3602808527797, 100.6133560111575, 91.67427454759931, 100.93385682387122, 80.4430508222797, 101.27818869861123, 80.46221120645801, 93.64214043000081, 86.36896012002678, 79.21372832788315, 98.24250163593942, 92.51532221057947, 89.8136278726442, 87.19740000745267, 94.13378785767394, 110.46728609798205, 96.00770662604886, 105.86709896417929, 81.38847723812094, 97.95602750729262, 79.25416092218892, 85.72805300288483, 93.2779523821215, 78.10912533768837, 100.3642103302183, 92.7205883151107, 96.159642765871, 81.25860413141194, 94.4745745521771, 100.5541721970902, 99.50887039628526, 107.20261424396266, 79.41568689568079, 93.12927463747104, 82.22857794113048, 87.51914093369346, 90.0490840030532, 78.96625277020658, 102.97690333674663, 100.65739487478356, 93.22671599856135, 80.82424895124186, 93.71293406994705, 105.35210432554801, 97.96288839472258, 101.53205075877239, 82.92464940803056, 88.15994531744052, 83.90493649521407, 94.49320154793381, 89.01770715914314, 81.74604526812276, 97.40296784228283, 94.71589219622842, 92.75359720790803, 85.14195338657039, 102.06857292160336, 101.25332128732273, 98.3378694595407, 104.02259939422238, 78.50939399419126, 91.77913362304538, 86.31021684081999, 90.04335472483442, 93.27727073217117, 82.66660453349041, 97.65911595373223, 93.06692885994562, 88.78962794328584, 88.75073781473657, 91.48510398179286, 104.54114276610991, 100.8015218802863, 100.57618170605382, 79.97727113555455, 95.6082693280068, 63.938341199281076, 89.10469917451506, 93.36957692628418, 80.98051211972322, 99.94508650502185, 94.93702673690399, 85.59247377304341, 83.4261523645341, 92.56024068647561, 106.84414253248467, 97.87652007466326, 101.67866404649834], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6906708224516067, "mean_inference_ms": 8.242199931094758, "mean_action_processing_ms": 0.5621087085461717, "mean_env_wait_ms": 23.645803307998808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03708386421203613, "StateBufferConnector_ms": 0.06789016723632812, "ViewRequirementAgentConnector_ms": 1.0295767784118652}}, "episode_reward_max": 110.46728609798205, "episode_reward_min": 63.938341199281076, "episode_reward_mean": 92.14002044225715, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [101.20869894421845, 106.72121646688652, 76.77641147176922, 101.29668477694018, 81.23541099627542, 90.99292722140594, 90.23636645465878, 81.5322069171643, 102.69790559899296, 95.4955075629537, 91.59896498991489, 82.42606164833327, 97.3602808527797, 100.6133560111575, 91.67427454759931, 100.93385682387122, 80.4430508222797, 101.27818869861123, 80.46221120645801, 93.64214043000081, 86.36896012002678, 79.21372832788315, 98.24250163593942, 92.51532221057947, 89.8136278726442, 87.19740000745267, 94.13378785767394, 110.46728609798205, 96.00770662604886, 105.86709896417929, 81.38847723812094, 97.95602750729262, 79.25416092218892, 85.72805300288483, 93.2779523821215, 78.10912533768837, 100.3642103302183, 92.7205883151107, 96.159642765871, 81.25860413141194, 94.4745745521771, 100.5541721970902, 99.50887039628526, 107.20261424396266, 79.41568689568079, 93.12927463747104, 82.22857794113048, 87.51914093369346, 90.0490840030532, 78.96625277020658, 102.97690333674663, 100.65739487478356, 93.22671599856135, 80.82424895124186, 93.71293406994705, 105.35210432554801, 97.96288839472258, 101.53205075877239, 82.92464940803056, 88.15994531744052, 83.90493649521407, 94.49320154793381, 89.01770715914314, 81.74604526812276, 97.40296784228283, 94.71589219622842, 92.75359720790803, 85.14195338657039, 102.06857292160336, 101.25332128732273, 98.3378694595407, 104.02259939422238, 78.50939399419126, 91.77913362304538, 86.31021684081999, 90.04335472483442, 93.27727073217117, 82.66660453349041, 97.65911595373223, 93.06692885994562, 88.78962794328584, 88.75073781473657, 91.48510398179286, 104.54114276610991, 100.8015218802863, 100.57618170605382, 79.97727113555455, 95.6082693280068, 63.938341199281076, 89.10469917451506, 93.36957692628418, 80.98051211972322, 99.94508650502185, 94.93702673690399, 85.59247377304341, 83.4261523645341, 92.56024068647561, 106.84414253248467, 97.87652007466326, 101.67866404649834], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6906708224516067, "mean_inference_ms": 8.242199931094758, "mean_action_processing_ms": 0.5621087085461717, "mean_env_wait_ms": 23.645803307998808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03708386421203613, "StateBufferConnector_ms": 0.06789016723632812, "ViewRequirementAgentConnector_ms": 1.0295767784118652}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1902200, "num_agent_steps_trained": 1902200, "num_env_steps_sampled": 1902200, "num_env_steps_trained": 1902200, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 260.1537037631913, "num_env_steps_trained_throughput_per_sec": 260.1537037631913, "timesteps_total": 1902200, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1902200, "timers": {"training_iteration_time_ms": 59886.487, "sample_time_ms": 44547.057, "load_time_ms": 1891.326, "load_throughput": 8268.274, "learn_time_ms": 12858.61, "learn_throughput": 1216.15, "synch_weights_time_ms": 466.079}, "counters": {"num_env_steps_sampled": 1902200, "num_env_steps_trained": 1902200, "num_agent_steps_sampled": 1902200, "num_agent_steps_trained": 1902200}, "done": false, "episodes_total": 1991, "training_iteration": 142, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-49-44", "timestamp": 1749307784, "time_this_iter_s": 60.12914752960205, "time_total_s": 8051.8578560352325, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8051.8578560352325, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 77.3014492753623, "ram_util_percent": 57.29130434782608, "gpu_util_percent0": 0.08478260869565218, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.097799999999998e-05, "total_loss": -0.07425284408032894, "policy_loss": -0.01967852515126155, "vf_loss": 0.011394359028093855, "vf_explained_var": 0.9827667500756003, "kl": 0.018031450311064803, "entropy": 16.057287347966973, "entropy_coeff": 0.0036466999999999997}, "model": {}, "num_grad_updates_lifetime": 67325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1917838, "num_env_steps_trained": 1917838, "num_agent_steps_sampled": 1917838, "num_agent_steps_trained": 1917838}, "sampler_results": {"episode_reward_max": 110.46728609798205, "episode_reward_min": 63.938341199281076, "episode_reward_mean": 92.12179969542984, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.67427454759931, 100.93385682387122, 80.4430508222797, 101.27818869861123, 80.46221120645801, 93.64214043000081, 86.36896012002678, 79.21372832788315, 98.24250163593942, 92.51532221057947, 89.8136278726442, 87.19740000745267, 94.13378785767394, 110.46728609798205, 96.00770662604886, 105.86709896417929, 81.38847723812094, 97.95602750729262, 79.25416092218892, 85.72805300288483, 93.2779523821215, 78.10912533768837, 100.3642103302183, 92.7205883151107, 96.159642765871, 81.25860413141194, 94.4745745521771, 100.5541721970902, 99.50887039628526, 107.20261424396266, 79.41568689568079, 93.12927463747104, 82.22857794113048, 87.51914093369346, 90.0490840030532, 78.96625277020658, 102.97690333674663, 100.65739487478356, 93.22671599856135, 80.82424895124186, 93.71293406994705, 105.35210432554801, 97.96288839472258, 101.53205075877239, 82.92464940803056, 88.15994531744052, 83.90493649521407, 94.49320154793381, 89.01770715914314, 81.74604526812276, 97.40296784228283, 94.71589219622842, 92.75359720790803, 85.14195338657039, 102.06857292160336, 101.25332128732273, 98.3378694595407, 104.02259939422238, 78.50939399419126, 91.77913362304538, 86.31021684081999, 90.04335472483442, 93.27727073217117, 82.66660453349041, 97.65911595373223, 93.06692885994562, 88.78962794328584, 88.75073781473657, 91.48510398179286, 104.54114276610991, 100.8015218802863, 100.57618170605382, 79.97727113555455, 95.6082693280068, 63.938341199281076, 89.10469917451506, 93.36957692628418, 80.98051211972322, 99.94508650502185, 94.93702673690399, 85.59247377304341, 83.4261523645341, 92.56024068647561, 106.84414253248467, 97.87652007466326, 101.67866404649834, 80.25447481028071, 99.10939940518416, 82.67681718232174, 88.13884482834486, 94.64841827805462, 79.03379150280074, 100.96111946212523, 96.16585704020204, 94.150711043625, 83.69854882361513, 97.53407990120782, 103.68651403477361, 93.18756674782581, 105.1237821703607], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6932588892279195, "mean_inference_ms": 8.249027162368222, "mean_action_processing_ms": 0.562529817845422, "mean_env_wait_ms": 23.65889601283017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03610348701477051, "StateBufferConnector_ms": 0.06884765625, "ViewRequirementAgentConnector_ms": 1.0176000595092773}}, "episode_reward_max": 110.46728609798205, "episode_reward_min": 63.938341199281076, "episode_reward_mean": 92.12179969542984, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [91.67427454759931, 100.93385682387122, 80.4430508222797, 101.27818869861123, 80.46221120645801, 93.64214043000081, 86.36896012002678, 79.21372832788315, 98.24250163593942, 92.51532221057947, 89.8136278726442, 87.19740000745267, 94.13378785767394, 110.46728609798205, 96.00770662604886, 105.86709896417929, 81.38847723812094, 97.95602750729262, 79.25416092218892, 85.72805300288483, 93.2779523821215, 78.10912533768837, 100.3642103302183, 92.7205883151107, 96.159642765871, 81.25860413141194, 94.4745745521771, 100.5541721970902, 99.50887039628526, 107.20261424396266, 79.41568689568079, 93.12927463747104, 82.22857794113048, 87.51914093369346, 90.0490840030532, 78.96625277020658, 102.97690333674663, 100.65739487478356, 93.22671599856135, 80.82424895124186, 93.71293406994705, 105.35210432554801, 97.96288839472258, 101.53205075877239, 82.92464940803056, 88.15994531744052, 83.90493649521407, 94.49320154793381, 89.01770715914314, 81.74604526812276, 97.40296784228283, 94.71589219622842, 92.75359720790803, 85.14195338657039, 102.06857292160336, 101.25332128732273, 98.3378694595407, 104.02259939422238, 78.50939399419126, 91.77913362304538, 86.31021684081999, 90.04335472483442, 93.27727073217117, 82.66660453349041, 97.65911595373223, 93.06692885994562, 88.78962794328584, 88.75073781473657, 91.48510398179286, 104.54114276610991, 100.8015218802863, 100.57618170605382, 79.97727113555455, 95.6082693280068, 63.938341199281076, 89.10469917451506, 93.36957692628418, 80.98051211972322, 99.94508650502185, 94.93702673690399, 85.59247377304341, 83.4261523645341, 92.56024068647561, 106.84414253248467, 97.87652007466326, 101.67866404649834, 80.25447481028071, 99.10939940518416, 82.67681718232174, 88.13884482834486, 94.64841827805462, 79.03379150280074, 100.96111946212523, 96.16585704020204, 94.150711043625, 83.69854882361513, 97.53407990120782, 103.68651403477361, 93.18756674782581, 105.1237821703607], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6932588892279195, "mean_inference_ms": 8.249027162368222, "mean_action_processing_ms": 0.562529817845422, "mean_env_wait_ms": 23.65889601283017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03610348701477051, "StateBufferConnector_ms": 0.06884765625, "ViewRequirementAgentConnector_ms": 1.0176000595092773}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1917838, "num_agent_steps_trained": 1917838, "num_env_steps_sampled": 1917838, "num_env_steps_trained": 1917838, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 261.92977404786666, "num_env_steps_trained_throughput_per_sec": 261.92977404786666, "timesteps_total": 1917838, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1917838, "timers": {"training_iteration_time_ms": 59789.32, "sample_time_ms": 44399.006, "load_time_ms": 1897.267, "load_throughput": 8242.383, "learn_time_ms": 12877.049, "learn_throughput": 1214.409, "synch_weights_time_ms": 497.338}, "counters": {"num_env_steps_sampled": 1917838, "num_env_steps_trained": 1917838, "num_agent_steps_sampled": 1917838, "num_agent_steps_trained": 1917838}, "done": false, "episodes_total": 2005, "training_iteration": 143, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-50-44", "timestamp": 1749307844, "time_this_iter_s": 59.72154760360718, "time_total_s": 8111.57940363884, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8111.57940363884, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 76.72500000000001, "ram_util_percent": 57.016176470588235, "gpu_util_percent0": 0.09279411764705882, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.082162000000001e-05, "total_loss": -0.0837786439912055, "policy_loss": -0.030287541234019128, "vf_loss": 0.014005821251987734, "vf_explained_var": 0.978400540785356, "kl": 0.01790097383311665, "entropy": 16.077379637631502, "entropy_coeff": 0.003623242999999999}, "model": {}, "num_grad_updates_lifetime": 67875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1933476, "num_env_steps_trained": 1933476, "num_agent_steps_sampled": 1933476, "num_agent_steps_trained": 1933476}, "sampler_results": {"episode_reward_max": 107.20261424396266, "episode_reward_min": 63.938341199281076, "episode_reward_mean": 92.01698768070558, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.00770662604886, 105.86709896417929, 81.38847723812094, 97.95602750729262, 79.25416092218892, 85.72805300288483, 93.2779523821215, 78.10912533768837, 100.3642103302183, 92.7205883151107, 96.159642765871, 81.25860413141194, 94.4745745521771, 100.5541721970902, 99.50887039628526, 107.20261424396266, 79.41568689568079, 93.12927463747104, 82.22857794113048, 87.51914093369346, 90.0490840030532, 78.96625277020658, 102.97690333674663, 100.65739487478356, 93.22671599856135, 80.82424895124186, 93.71293406994705, 105.35210432554801, 97.96288839472258, 101.53205075877239, 82.92464940803056, 88.15994531744052, 83.90493649521407, 94.49320154793381, 89.01770715914314, 81.74604526812276, 97.40296784228283, 94.71589219622842, 92.75359720790803, 85.14195338657039, 102.06857292160336, 101.25332128732273, 98.3378694595407, 104.02259939422238, 78.50939399419126, 91.77913362304538, 86.31021684081999, 90.04335472483442, 93.27727073217117, 82.66660453349041, 97.65911595373223, 93.06692885994562, 88.78962794328584, 88.75073781473657, 91.48510398179286, 104.54114276610991, 100.8015218802863, 100.57618170605382, 79.97727113555455, 95.6082693280068, 63.938341199281076, 89.10469917451506, 93.36957692628418, 80.98051211972322, 99.94508650502185, 94.93702673690399, 85.59247377304341, 83.4261523645341, 92.56024068647561, 106.84414253248467, 97.87652007466326, 101.67866404649834, 80.25447481028071, 99.10939940518416, 82.67681718232174, 88.13884482834486, 94.64841827805462, 79.03379150280074, 100.96111946212523, 96.16585704020204, 94.150711043625, 83.69854882361513, 97.53407990120782, 103.68651403477361, 93.18756674782581, 105.1237821703607, 84.46728700348454, 90.65966340454918, 81.8181180844061, 86.73937857874864, 82.77132827817455, 82.73797120445934, 100.51228151883302, 95.40811279203609, 95.00914276879958, 79.21438810861719, 89.77421825654093, 106.94059895670485, 94.8674938628885, 104.98515236833411], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6956541481688525, "mean_inference_ms": 8.255813906423656, "mean_action_processing_ms": 0.5629636269459746, "mean_env_wait_ms": 23.671914264481483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03223562240600586, "StateBufferConnector_ms": 0.07091426849365234, "ViewRequirementAgentConnector_ms": 0.9863057136535645}}, "episode_reward_max": 107.20261424396266, "episode_reward_min": 63.938341199281076, "episode_reward_mean": 92.01698768070558, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [96.00770662604886, 105.86709896417929, 81.38847723812094, 97.95602750729262, 79.25416092218892, 85.72805300288483, 93.2779523821215, 78.10912533768837, 100.3642103302183, 92.7205883151107, 96.159642765871, 81.25860413141194, 94.4745745521771, 100.5541721970902, 99.50887039628526, 107.20261424396266, 79.41568689568079, 93.12927463747104, 82.22857794113048, 87.51914093369346, 90.0490840030532, 78.96625277020658, 102.97690333674663, 100.65739487478356, 93.22671599856135, 80.82424895124186, 93.71293406994705, 105.35210432554801, 97.96288839472258, 101.53205075877239, 82.92464940803056, 88.15994531744052, 83.90493649521407, 94.49320154793381, 89.01770715914314, 81.74604526812276, 97.40296784228283, 94.71589219622842, 92.75359720790803, 85.14195338657039, 102.06857292160336, 101.25332128732273, 98.3378694595407, 104.02259939422238, 78.50939399419126, 91.77913362304538, 86.31021684081999, 90.04335472483442, 93.27727073217117, 82.66660453349041, 97.65911595373223, 93.06692885994562, 88.78962794328584, 88.75073781473657, 91.48510398179286, 104.54114276610991, 100.8015218802863, 100.57618170605382, 79.97727113555455, 95.6082693280068, 63.938341199281076, 89.10469917451506, 93.36957692628418, 80.98051211972322, 99.94508650502185, 94.93702673690399, 85.59247377304341, 83.4261523645341, 92.56024068647561, 106.84414253248467, 97.87652007466326, 101.67866404649834, 80.25447481028071, 99.10939940518416, 82.67681718232174, 88.13884482834486, 94.64841827805462, 79.03379150280074, 100.96111946212523, 96.16585704020204, 94.150711043625, 83.69854882361513, 97.53407990120782, 103.68651403477361, 93.18756674782581, 105.1237821703607, 84.46728700348454, 90.65966340454918, 81.8181180844061, 86.73937857874864, 82.77132827817455, 82.73797120445934, 100.51228151883302, 95.40811279203609, 95.00914276879958, 79.21438810861719, 89.77421825654093, 106.94059895670485, 94.8674938628885, 104.98515236833411], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6956541481688525, "mean_inference_ms": 8.255813906423656, "mean_action_processing_ms": 0.5629636269459746, "mean_env_wait_ms": 23.671914264481483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03223562240600586, "StateBufferConnector_ms": 0.07091426849365234, "ViewRequirementAgentConnector_ms": 0.9863057136535645}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1933476, "num_agent_steps_trained": 1933476, "num_env_steps_sampled": 1933476, "num_env_steps_trained": 1933476, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 265.1722604742415, "num_env_steps_trained_throughput_per_sec": 265.1722604742415, "timesteps_total": 1933476, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1933476, "timers": {"training_iteration_time_ms": 59826.234, "sample_time_ms": 44357.173, "load_time_ms": 1923.898, "load_throughput": 8128.291, "learn_time_ms": 12939.006, "learn_throughput": 1208.594, "synch_weights_time_ms": 487.98}, "counters": {"num_env_steps_sampled": 1933476, "num_env_steps_trained": 1933476, "num_agent_steps_sampled": 1933476, "num_agent_steps_trained": 1933476}, "done": false, "episodes_total": 2019, "training_iteration": 144, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-51-43", "timestamp": 1749307903, "time_this_iter_s": 58.99098753929138, "time_total_s": 8170.570391178131, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8170.570391178131, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 76.63970588235293, "ram_util_percent": 57.13676470588234, "gpu_util_percent0": 0.08705882352941177, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.066523999999999e-05, "total_loss": -0.046256364307271064, "policy_loss": 0.007238341158001938, "vf_loss": 0.012834781308616088, "vf_explained_var": 0.9799247324466706, "kl": 0.018559772313936483, "entropy": 16.091270668723368, "entropy_coeff": 0.0035997860000000002}, "model": {}, "num_grad_updates_lifetime": 68425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1949114, "num_env_steps_trained": 1949114, "num_agent_steps_sampled": 1949114, "num_agent_steps_trained": 1949114}, "sampler_results": {"episode_reward_max": 107.20261424396266, "episode_reward_min": 63.938341199281076, "episode_reward_mean": 91.94423148234408, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [99.50887039628526, 107.20261424396266, 79.41568689568079, 93.12927463747104, 82.22857794113048, 87.51914093369346, 90.0490840030532, 78.96625277020658, 102.97690333674663, 100.65739487478356, 93.22671599856135, 80.82424895124186, 93.71293406994705, 105.35210432554801, 97.96288839472258, 101.53205075877239, 82.92464940803056, 88.15994531744052, 83.90493649521407, 94.49320154793381, 89.01770715914314, 81.74604526812276, 97.40296784228283, 94.71589219622842, 92.75359720790803, 85.14195338657039, 102.06857292160336, 101.25332128732273, 98.3378694595407, 104.02259939422238, 78.50939399419126, 91.77913362304538, 86.31021684081999, 90.04335472483442, 93.27727073217117, 82.66660453349041, 97.65911595373223, 93.06692885994562, 88.78962794328584, 88.75073781473657, 91.48510398179286, 104.54114276610991, 100.8015218802863, 100.57618170605382, 79.97727113555455, 95.6082693280068, 63.938341199281076, 89.10469917451506, 93.36957692628418, 80.98051211972322, 99.94508650502185, 94.93702673690399, 85.59247377304341, 83.4261523645341, 92.56024068647561, 106.84414253248467, 97.87652007466326, 101.67866404649834, 80.25447481028071, 99.10939940518416, 82.67681718232174, 88.13884482834486, 94.64841827805462, 79.03379150280074, 100.96111946212523, 96.16585704020204, 94.150711043625, 83.69854882361513, 97.53407990120782, 103.68651403477361, 93.18756674782581, 105.1237821703607, 84.46728700348454, 90.65966340454918, 81.8181180844061, 86.73937857874864, 82.77132827817455, 82.73797120445934, 100.51228151883302, 95.40811279203609, 95.00914276879958, 79.21438810861719, 89.77421825654093, 106.94059895670485, 94.8674938628885, 104.98515236833411, 79.41279487740321, 95.49760574684106, 85.70216875300186, 87.88922920180298, 93.00756497062993, 77.61573234183945, 98.68009898831389, 94.68199784423601, 92.76745490741156, 86.5886694147898, 90.04575465604951, 99.30303951271925, 89.66602231772814, 104.98664090348511], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.697622220292708, "mean_inference_ms": 8.262343798257769, "mean_action_processing_ms": 0.563403609562165, "mean_env_wait_ms": 23.68508910043337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03274202346801758, "StateBufferConnector_ms": 0.06594347953796387, "ViewRequirementAgentConnector_ms": 0.9902157783508301}}, "episode_reward_max": 107.20261424396266, "episode_reward_min": 63.938341199281076, "episode_reward_mean": 91.94423148234408, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [99.50887039628526, 107.20261424396266, 79.41568689568079, 93.12927463747104, 82.22857794113048, 87.51914093369346, 90.0490840030532, 78.96625277020658, 102.97690333674663, 100.65739487478356, 93.22671599856135, 80.82424895124186, 93.71293406994705, 105.35210432554801, 97.96288839472258, 101.53205075877239, 82.92464940803056, 88.15994531744052, 83.90493649521407, 94.49320154793381, 89.01770715914314, 81.74604526812276, 97.40296784228283, 94.71589219622842, 92.75359720790803, 85.14195338657039, 102.06857292160336, 101.25332128732273, 98.3378694595407, 104.02259939422238, 78.50939399419126, 91.77913362304538, 86.31021684081999, 90.04335472483442, 93.27727073217117, 82.66660453349041, 97.65911595373223, 93.06692885994562, 88.78962794328584, 88.75073781473657, 91.48510398179286, 104.54114276610991, 100.8015218802863, 100.57618170605382, 79.97727113555455, 95.6082693280068, 63.938341199281076, 89.10469917451506, 93.36957692628418, 80.98051211972322, 99.94508650502185, 94.93702673690399, 85.59247377304341, 83.4261523645341, 92.56024068647561, 106.84414253248467, 97.87652007466326, 101.67866404649834, 80.25447481028071, 99.10939940518416, 82.67681718232174, 88.13884482834486, 94.64841827805462, 79.03379150280074, 100.96111946212523, 96.16585704020204, 94.150711043625, 83.69854882361513, 97.53407990120782, 103.68651403477361, 93.18756674782581, 105.1237821703607, 84.46728700348454, 90.65966340454918, 81.8181180844061, 86.73937857874864, 82.77132827817455, 82.73797120445934, 100.51228151883302, 95.40811279203609, 95.00914276879958, 79.21438810861719, 89.77421825654093, 106.94059895670485, 94.8674938628885, 104.98515236833411, 79.41279487740321, 95.49760574684106, 85.70216875300186, 87.88922920180298, 93.00756497062993, 77.61573234183945, 98.68009898831389, 94.68199784423601, 92.76745490741156, 86.5886694147898, 90.04575465604951, 99.30303951271925, 89.66602231772814, 104.98664090348511], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.697622220292708, "mean_inference_ms": 8.262343798257769, "mean_action_processing_ms": 0.563403609562165, "mean_env_wait_ms": 23.68508910043337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03274202346801758, "StateBufferConnector_ms": 0.06594347953796387, "ViewRequirementAgentConnector_ms": 0.9902157783508301}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1949114, "num_agent_steps_trained": 1949114, "num_env_steps_sampled": 1949114, "num_env_steps_trained": 1949114, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 259.79296030413224, "num_env_steps_trained_throughput_per_sec": 259.79296030413224, "timesteps_total": 1949114, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1949114, "timers": {"training_iteration_time_ms": 59918.169, "sample_time_ms": 44320.848, "load_time_ms": 1941.674, "load_throughput": 8053.876, "learn_time_ms": 13046.212, "learn_throughput": 1198.662, "synch_weights_time_ms": 492.508}, "counters": {"num_env_steps_sampled": 1949114, "num_env_steps_trained": 1949114, "num_agent_steps_sampled": 1949114, "num_agent_steps_trained": 1949114}, "done": false, "episodes_total": 2033, "training_iteration": 145, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-52-44", "timestamp": 1749307964, "time_this_iter_s": 60.209959745407104, "time_total_s": 8230.780350923538, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8230.780350923538, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 77.17391304347827, "ram_util_percent": 57.3768115942029, "gpu_util_percent0": 0.0946376811594203, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.050886e-05, "total_loss": -0.06201589951365763, "policy_loss": -0.008866692110525699, "vf_loss": 0.012559766865928065, "vf_explained_var": 0.9799075414917686, "kl": 0.018198306052553882, "entropy": 16.073977976712314, "entropy_coeff": 0.003576329}, "model": {}, "num_grad_updates_lifetime": 68975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1964752, "num_env_steps_trained": 1964752, "num_agent_steps_sampled": 1964752, "num_agent_steps_trained": 1964752}, "sampler_results": {"episode_reward_max": 106.94059895670485, "episode_reward_min": 63.938341199281076, "episode_reward_mean": 91.78746452677571, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.96288839472258, 101.53205075877239, 82.92464940803056, 88.15994531744052, 83.90493649521407, 94.49320154793381, 89.01770715914314, 81.74604526812276, 97.40296784228283, 94.71589219622842, 92.75359720790803, 85.14195338657039, 102.06857292160336, 101.25332128732273, 98.3378694595407, 104.02259939422238, 78.50939399419126, 91.77913362304538, 86.31021684081999, 90.04335472483442, 93.27727073217117, 82.66660453349041, 97.65911595373223, 93.06692885994562, 88.78962794328584, 88.75073781473657, 91.48510398179286, 104.54114276610991, 100.8015218802863, 100.57618170605382, 79.97727113555455, 95.6082693280068, 63.938341199281076, 89.10469917451506, 93.36957692628418, 80.98051211972322, 99.94508650502185, 94.93702673690399, 85.59247377304341, 83.4261523645341, 92.56024068647561, 106.84414253248467, 97.87652007466326, 101.67866404649834, 80.25447481028071, 99.10939940518416, 82.67681718232174, 88.13884482834486, 94.64841827805462, 79.03379150280074, 100.96111946212523, 96.16585704020204, 94.150711043625, 83.69854882361513, 97.53407990120782, 103.68651403477361, 93.18756674782581, 105.1237821703607, 84.46728700348454, 90.65966340454918, 81.8181180844061, 86.73937857874864, 82.77132827817455, 82.73797120445934, 100.51228151883302, 95.40811279203609, 95.00914276879958, 79.21438810861719, 89.77421825654093, 106.94059895670485, 94.8674938628885, 104.98515236833411, 79.41279487740321, 95.49760574684106, 85.70216875300186, 87.88922920180298, 93.00756497062993, 77.61573234183945, 98.68009898831389, 94.68199784423601, 92.76745490741156, 86.5886694147898, 90.04575465604951, 99.30303951271925, 89.66602231772814, 104.98664090348511, 78.59037676270037, 96.17481523143343, 82.05537942815678, 91.69521834625696, 90.72296703923742, 81.64600972226569, 100.0011521308996, 96.20692092230695, 94.27443496253088, 82.56808886055553, 90.3849801887039, 98.29909339534927, 90.39033904992009, 106.08333178115821], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.699219925486628, "mean_inference_ms": 8.269018916513003, "mean_action_processing_ms": 0.5638462703659995, "mean_env_wait_ms": 23.69841852910252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035857200622558594, "StateBufferConnector_ms": 0.02886795997619629, "ViewRequirementAgentConnector_ms": 0.97308349609375}}, "episode_reward_max": 106.94059895670485, "episode_reward_min": 63.938341199281076, "episode_reward_mean": 91.78746452677571, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [97.96288839472258, 101.53205075877239, 82.92464940803056, 88.15994531744052, 83.90493649521407, 94.49320154793381, 89.01770715914314, 81.74604526812276, 97.40296784228283, 94.71589219622842, 92.75359720790803, 85.14195338657039, 102.06857292160336, 101.25332128732273, 98.3378694595407, 104.02259939422238, 78.50939399419126, 91.77913362304538, 86.31021684081999, 90.04335472483442, 93.27727073217117, 82.66660453349041, 97.65911595373223, 93.06692885994562, 88.78962794328584, 88.75073781473657, 91.48510398179286, 104.54114276610991, 100.8015218802863, 100.57618170605382, 79.97727113555455, 95.6082693280068, 63.938341199281076, 89.10469917451506, 93.36957692628418, 80.98051211972322, 99.94508650502185, 94.93702673690399, 85.59247377304341, 83.4261523645341, 92.56024068647561, 106.84414253248467, 97.87652007466326, 101.67866404649834, 80.25447481028071, 99.10939940518416, 82.67681718232174, 88.13884482834486, 94.64841827805462, 79.03379150280074, 100.96111946212523, 96.16585704020204, 94.150711043625, 83.69854882361513, 97.53407990120782, 103.68651403477361, 93.18756674782581, 105.1237821703607, 84.46728700348454, 90.65966340454918, 81.8181180844061, 86.73937857874864, 82.77132827817455, 82.73797120445934, 100.51228151883302, 95.40811279203609, 95.00914276879958, 79.21438810861719, 89.77421825654093, 106.94059895670485, 94.8674938628885, 104.98515236833411, 79.41279487740321, 95.49760574684106, 85.70216875300186, 87.88922920180298, 93.00756497062993, 77.61573234183945, 98.68009898831389, 94.68199784423601, 92.76745490741156, 86.5886694147898, 90.04575465604951, 99.30303951271925, 89.66602231772814, 104.98664090348511, 78.59037676270037, 96.17481523143343, 82.05537942815678, 91.69521834625696, 90.72296703923742, 81.64600972226569, 100.0011521308996, 96.20692092230695, 94.27443496253088, 82.56808886055553, 90.3849801887039, 98.29909339534927, 90.39033904992009, 106.08333178115821], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.699219925486628, "mean_inference_ms": 8.269018916513003, "mean_action_processing_ms": 0.5638462703659995, "mean_env_wait_ms": 23.69841852910252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035857200622558594, "StateBufferConnector_ms": 0.02886795997619629, "ViewRequirementAgentConnector_ms": 0.97308349609375}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1964752, "num_agent_steps_trained": 1964752, "num_env_steps_sampled": 1964752, "num_env_steps_trained": 1964752, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 258.26342096212994, "num_env_steps_trained_throughput_per_sec": 258.26342096212994, "timesteps_total": 1964752, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1964752, "timers": {"training_iteration_time_ms": 59860.683, "sample_time_ms": 44234.189, "load_time_ms": 1936.213, "load_throughput": 8076.591, "learn_time_ms": 13081.55, "learn_throughput": 1195.424, "synch_weights_time_ms": 486.828}, "counters": {"num_env_steps_sampled": 1964752, "num_env_steps_trained": 1964752, "num_agent_steps_sampled": 1964752, "num_agent_steps_trained": 1964752}, "done": false, "episodes_total": 2047, "training_iteration": 146, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-53-44", "timestamp": 1749308024, "time_this_iter_s": 60.565781116485596, "time_total_s": 8291.346132040024, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8291.346132040024, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 77.12714285714287, "ram_util_percent": 57.05571428571428, "gpu_util_percent0": 0.08985714285714286, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.035248000000004e-05, "total_loss": -0.05145911739133722, "policy_loss": 0.0008884687571447681, "vf_loss": 0.014272484312426637, "vf_explained_var": 0.9791723962263628, "kl": 0.019000907109324543, "entropy": 16.106156647422097, "entropy_coeff": 0.0035528719999999995}, "model": {}, "num_grad_updates_lifetime": 69525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1980390, "num_env_steps_trained": 1980390, "num_agent_steps_sampled": 1980390, "num_agent_steps_trained": 1980390}, "sampler_results": {"episode_reward_max": 106.94059895670485, "episode_reward_min": 63.938341199281076, "episode_reward_mean": 91.5234727929962, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.3378694595407, 104.02259939422238, 78.50939399419126, 91.77913362304538, 86.31021684081999, 90.04335472483442, 93.27727073217117, 82.66660453349041, 97.65911595373223, 93.06692885994562, 88.78962794328584, 88.75073781473657, 91.48510398179286, 104.54114276610991, 100.8015218802863, 100.57618170605382, 79.97727113555455, 95.6082693280068, 63.938341199281076, 89.10469917451506, 93.36957692628418, 80.98051211972322, 99.94508650502185, 94.93702673690399, 85.59247377304341, 83.4261523645341, 92.56024068647561, 106.84414253248467, 97.87652007466326, 101.67866404649834, 80.25447481028071, 99.10939940518416, 82.67681718232174, 88.13884482834486, 94.64841827805462, 79.03379150280074, 100.96111946212523, 96.16585704020204, 94.150711043625, 83.69854882361513, 97.53407990120782, 103.68651403477361, 93.18756674782581, 105.1237821703607, 84.46728700348454, 90.65966340454918, 81.8181180844061, 86.73937857874864, 82.77132827817455, 82.73797120445934, 100.51228151883302, 95.40811279203609, 95.00914276879958, 79.21438810861719, 89.77421825654093, 106.94059895670485, 94.8674938628885, 104.98515236833411, 79.41279487740321, 95.49760574684106, 85.70216875300186, 87.88922920180298, 93.00756497062993, 77.61573234183945, 98.68009898831389, 94.68199784423601, 92.76745490741156, 86.5886694147898, 90.04575465604951, 99.30303951271925, 89.66602231772814, 104.98664090348511, 78.59037676270037, 96.17481523143343, 82.05537942815678, 91.69521834625696, 90.72296703923742, 81.64600972226569, 100.0011521308996, 96.20692092230695, 94.27443496253088, 82.56808886055553, 90.3849801887039, 98.29909339534927, 90.39033904992009, 106.08333178115821, 80.74261691513873, 95.02931245826855, 85.58081569811817, 84.42332002053722, 87.75828382263974, 83.24460617422783, 98.81461562111967, 89.57295091867068, 93.80467958893949, 78.0342329148104, 90.55088699412585, 103.51275587256076, 94.53388109954972, 101.07559771463994], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7008762118742453, "mean_inference_ms": 8.27638469787203, "mean_action_processing_ms": 0.5643283363122195, "mean_env_wait_ms": 23.713155840749465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03576159477233887, "StateBufferConnector_ms": 0.032859086990356445, "ViewRequirementAgentConnector_ms": 0.9188823699951172}}, "episode_reward_max": 106.94059895670485, "episode_reward_min": 63.938341199281076, "episode_reward_mean": 91.5234727929962, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [98.3378694595407, 104.02259939422238, 78.50939399419126, 91.77913362304538, 86.31021684081999, 90.04335472483442, 93.27727073217117, 82.66660453349041, 97.65911595373223, 93.06692885994562, 88.78962794328584, 88.75073781473657, 91.48510398179286, 104.54114276610991, 100.8015218802863, 100.57618170605382, 79.97727113555455, 95.6082693280068, 63.938341199281076, 89.10469917451506, 93.36957692628418, 80.98051211972322, 99.94508650502185, 94.93702673690399, 85.59247377304341, 83.4261523645341, 92.56024068647561, 106.84414253248467, 97.87652007466326, 101.67866404649834, 80.25447481028071, 99.10939940518416, 82.67681718232174, 88.13884482834486, 94.64841827805462, 79.03379150280074, 100.96111946212523, 96.16585704020204, 94.150711043625, 83.69854882361513, 97.53407990120782, 103.68651403477361, 93.18756674782581, 105.1237821703607, 84.46728700348454, 90.65966340454918, 81.8181180844061, 86.73937857874864, 82.77132827817455, 82.73797120445934, 100.51228151883302, 95.40811279203609, 95.00914276879958, 79.21438810861719, 89.77421825654093, 106.94059895670485, 94.8674938628885, 104.98515236833411, 79.41279487740321, 95.49760574684106, 85.70216875300186, 87.88922920180298, 93.00756497062993, 77.61573234183945, 98.68009898831389, 94.68199784423601, 92.76745490741156, 86.5886694147898, 90.04575465604951, 99.30303951271925, 89.66602231772814, 104.98664090348511, 78.59037676270037, 96.17481523143343, 82.05537942815678, 91.69521834625696, 90.72296703923742, 81.64600972226569, 100.0011521308996, 96.20692092230695, 94.27443496253088, 82.56808886055553, 90.3849801887039, 98.29909339534927, 90.39033904992009, 106.08333178115821, 80.74261691513873, 95.02931245826855, 85.58081569811817, 84.42332002053722, 87.75828382263974, 83.24460617422783, 98.81461562111967, 89.57295091867068, 93.80467958893949, 78.0342329148104, 90.55088699412585, 103.51275587256076, 94.53388109954972, 101.07559771463994], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7008762118742453, "mean_inference_ms": 8.27638469787203, "mean_action_processing_ms": 0.5643283363122195, "mean_env_wait_ms": 23.713155840749465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03576159477233887, "StateBufferConnector_ms": 0.032859086990356445, "ViewRequirementAgentConnector_ms": 0.9188823699951172}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1980390, "num_agent_steps_trained": 1980390, "num_env_steps_sampled": 1980390, "num_env_steps_trained": 1980390, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 248.45457475410544, "num_env_steps_trained_throughput_per_sec": 248.45457475410544, "timesteps_total": 1980390, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1980390, "timers": {"training_iteration_time_ms": 60232.469, "sample_time_ms": 44589.917, "load_time_ms": 1934.149, "load_throughput": 8085.208, "learn_time_ms": 13073.087, "learn_throughput": 1196.198, "synch_weights_time_ms": 514.115}, "counters": {"num_env_steps_sampled": 1980390, "num_env_steps_trained": 1980390, "num_agent_steps_sampled": 1980390, "num_agent_steps_trained": 1980390}, "done": false, "episodes_total": 2061, "training_iteration": 147, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-54-47", "timestamp": 1749308087, "time_this_iter_s": 62.958083391189575, "time_total_s": 8354.304215431213, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8354.304215431213, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 78.24507042253522, "ram_util_percent": 57.099999999999994, "gpu_util_percent0": 0.0828169014084507, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.01961e-05, "total_loss": -0.0712358993964947, "policy_loss": -0.01865349295718426, "vf_loss": 0.012858784131451764, "vf_explained_var": 0.9810262648625807, "kl": 0.018758065924926154, "entropy": 16.157417751659047, "entropy_coeff": 0.003529415}, "model": {}, "num_grad_updates_lifetime": 70075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 1996028, "num_env_steps_trained": 1996028, "num_agent_steps_sampled": 1996028, "num_agent_steps_trained": 1996028}, "sampler_results": {"episode_reward_max": 106.94059895670485, "episode_reward_min": 63.938341199281076, "episode_reward_mean": 91.06897307026752, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.8015218802863, 100.57618170605382, 79.97727113555455, 95.6082693280068, 63.938341199281076, 89.10469917451506, 93.36957692628418, 80.98051211972322, 99.94508650502185, 94.93702673690399, 85.59247377304341, 83.4261523645341, 92.56024068647561, 106.84414253248467, 97.87652007466326, 101.67866404649834, 80.25447481028071, 99.10939940518416, 82.67681718232174, 88.13884482834486, 94.64841827805462, 79.03379150280074, 100.96111946212523, 96.16585704020204, 94.150711043625, 83.69854882361513, 97.53407990120782, 103.68651403477361, 93.18756674782581, 105.1237821703607, 84.46728700348454, 90.65966340454918, 81.8181180844061, 86.73937857874864, 82.77132827817455, 82.73797120445934, 100.51228151883302, 95.40811279203609, 95.00914276879958, 79.21438810861719, 89.77421825654093, 106.94059895670485, 94.8674938628885, 104.98515236833411, 79.41279487740321, 95.49760574684106, 85.70216875300186, 87.88922920180298, 93.00756497062993, 77.61573234183945, 98.68009898831389, 94.68199784423601, 92.76745490741156, 86.5886694147898, 90.04575465604951, 99.30303951271925, 89.66602231772814, 104.98664090348511, 78.59037676270037, 96.17481523143343, 82.05537942815678, 91.69521834625696, 90.72296703923742, 81.64600972226569, 100.0011521308996, 96.20692092230695, 94.27443496253088, 82.56808886055553, 90.3849801887039, 98.29909339534927, 90.39033904992009, 106.08333178115821, 80.74261691513873, 95.02931245826855, 85.58081569811817, 84.42332002053722, 87.75828382263974, 83.24460617422783, 98.81461562111967, 89.57295091867068, 93.80467958893949, 78.0342329148104, 90.55088699412585, 103.51275587256076, 94.53388109954972, 101.07559771463994, 78.2535808257946, 95.64530603537831, 84.14089605772763, 89.69832745132021, 79.68298082749696, 75.43349359439993, 100.31419503933637, 87.83676099201328, 86.9063106074541, 80.95683622949673, 91.63928391589266, 99.13931098508662, 92.74385042974019, 101.39799535790847], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.702271749800935, "mean_inference_ms": 8.283467835947608, "mean_action_processing_ms": 0.5647900380480362, "mean_env_wait_ms": 23.727424233360622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03882956504821777, "StateBufferConnector_ms": 0.03298759460449219, "ViewRequirementAgentConnector_ms": 0.9327855110168457}}, "episode_reward_max": 106.94059895670485, "episode_reward_min": 63.938341199281076, "episode_reward_mean": 91.06897307026752, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [100.8015218802863, 100.57618170605382, 79.97727113555455, 95.6082693280068, 63.938341199281076, 89.10469917451506, 93.36957692628418, 80.98051211972322, 99.94508650502185, 94.93702673690399, 85.59247377304341, 83.4261523645341, 92.56024068647561, 106.84414253248467, 97.87652007466326, 101.67866404649834, 80.25447481028071, 99.10939940518416, 82.67681718232174, 88.13884482834486, 94.64841827805462, 79.03379150280074, 100.96111946212523, 96.16585704020204, 94.150711043625, 83.69854882361513, 97.53407990120782, 103.68651403477361, 93.18756674782581, 105.1237821703607, 84.46728700348454, 90.65966340454918, 81.8181180844061, 86.73937857874864, 82.77132827817455, 82.73797120445934, 100.51228151883302, 95.40811279203609, 95.00914276879958, 79.21438810861719, 89.77421825654093, 106.94059895670485, 94.8674938628885, 104.98515236833411, 79.41279487740321, 95.49760574684106, 85.70216875300186, 87.88922920180298, 93.00756497062993, 77.61573234183945, 98.68009898831389, 94.68199784423601, 92.76745490741156, 86.5886694147898, 90.04575465604951, 99.30303951271925, 89.66602231772814, 104.98664090348511, 78.59037676270037, 96.17481523143343, 82.05537942815678, 91.69521834625696, 90.72296703923742, 81.64600972226569, 100.0011521308996, 96.20692092230695, 94.27443496253088, 82.56808886055553, 90.3849801887039, 98.29909339534927, 90.39033904992009, 106.08333178115821, 80.74261691513873, 95.02931245826855, 85.58081569811817, 84.42332002053722, 87.75828382263974, 83.24460617422783, 98.81461562111967, 89.57295091867068, 93.80467958893949, 78.0342329148104, 90.55088699412585, 103.51275587256076, 94.53388109954972, 101.07559771463994, 78.2535808257946, 95.64530603537831, 84.14089605772763, 89.69832745132021, 79.68298082749696, 75.43349359439993, 100.31419503933637, 87.83676099201328, 86.9063106074541, 80.95683622949673, 91.63928391589266, 99.13931098508662, 92.74385042974019, 101.39799535790847], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.702271749800935, "mean_inference_ms": 8.283467835947608, "mean_action_processing_ms": 0.5647900380480362, "mean_env_wait_ms": 23.727424233360622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03882956504821777, "StateBufferConnector_ms": 0.03298759460449219, "ViewRequirementAgentConnector_ms": 0.9327855110168457}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1996028, "num_agent_steps_trained": 1996028, "num_env_steps_sampled": 1996028, "num_env_steps_trained": 1996028, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 263.9526529318703, "num_env_steps_trained_throughput_per_sec": 263.9526529318703, "timesteps_total": 1996028, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 1996028, "timers": {"training_iteration_time_ms": 60163.852, "sample_time_ms": 44458.564, "load_time_ms": 1973.828, "load_throughput": 7922.677, "learn_time_ms": 13088.722, "learn_throughput": 1194.769, "synch_weights_time_ms": 516.675}, "counters": {"num_env_steps_sampled": 1996028, "num_env_steps_trained": 1996028, "num_agent_steps_sampled": 1996028, "num_agent_steps_trained": 1996028}, "done": false, "episodes_total": 2075, "training_iteration": 148, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-55-47", "timestamp": 1749308147, "time_this_iter_s": 59.2634801864624, "time_total_s": 8413.567695617676, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8413.567695617676, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 76.94492753623189, "ram_util_percent": 57.359420289855066, "gpu_util_percent0": 0.08391304347826088, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 8.003972000000001e-05, "total_loss": -0.07233070701233704, "policy_loss": -0.019741602195479737, "vf_loss": 0.011686054488898001, "vf_explained_var": 0.9809327218749306, "kl": 0.01857839330433372, "entropy": 16.16548053221269, "entropy_coeff": 0.003505958}, "model": {}, "num_grad_updates_lifetime": 70625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2011666, "num_env_steps_trained": 2011666, "num_agent_steps_sampled": 2011666, "num_agent_steps_trained": 2011666}, "sampler_results": {"episode_reward_max": 106.94059895670485, "episode_reward_min": 75.43349359439993, "episode_reward_mean": 91.10325772542684, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.87652007466326, 101.67866404649834, 80.25447481028071, 99.10939940518416, 82.67681718232174, 88.13884482834486, 94.64841827805462, 79.03379150280074, 100.96111946212523, 96.16585704020204, 94.150711043625, 83.69854882361513, 97.53407990120782, 103.68651403477361, 93.18756674782581, 105.1237821703607, 84.46728700348454, 90.65966340454918, 81.8181180844061, 86.73937857874864, 82.77132827817455, 82.73797120445934, 100.51228151883302, 95.40811279203609, 95.00914276879958, 79.21438810861719, 89.77421825654093, 106.94059895670485, 94.8674938628885, 104.98515236833411, 79.41279487740321, 95.49760574684106, 85.70216875300186, 87.88922920180298, 93.00756497062993, 77.61573234183945, 98.68009898831389, 94.68199784423601, 92.76745490741156, 86.5886694147898, 90.04575465604951, 99.30303951271925, 89.66602231772814, 104.98664090348511, 78.59037676270037, 96.17481523143343, 82.05537942815678, 91.69521834625696, 90.72296703923742, 81.64600972226569, 100.0011521308996, 96.20692092230695, 94.27443496253088, 82.56808886055553, 90.3849801887039, 98.29909339534927, 90.39033904992009, 106.08333178115821, 80.74261691513873, 95.02931245826855, 85.58081569811817, 84.42332002053722, 87.75828382263974, 83.24460617422783, 98.81461562111967, 89.57295091867068, 93.80467958893949, 78.0342329148104, 90.55088699412585, 103.51275587256076, 94.53388109954972, 101.07559771463994, 78.2535808257946, 95.64530603537831, 84.14089605772763, 89.69832745132021, 79.68298082749696, 75.43349359439993, 100.31419503933637, 87.83676099201328, 86.9063106074541, 80.95683622949673, 91.63928391589266, 99.13931098508662, 92.74385042974019, 101.39799535790847, 77.30751985103753, 93.54381003063595, 84.02555049935285, 85.93704919939373, 87.72265489047906, 79.56598166561642, 97.33576722680587, 93.78980347559926, 90.0980634374571, 86.57086445231685, 94.50229951862303, 100.31521591146416, 95.51930812576776, 104.8560732995558], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7037330308965535, "mean_inference_ms": 8.291343935993892, "mean_action_processing_ms": 0.5653127980536862, "mean_env_wait_ms": 23.743609840260273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04179954528808594, "StateBufferConnector_ms": 0.03414201736450195, "ViewRequirementAgentConnector_ms": 0.9452517032623291}}, "episode_reward_max": 106.94059895670485, "episode_reward_min": 75.43349359439993, "episode_reward_mean": 91.10325772542684, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [97.87652007466326, 101.67866404649834, 80.25447481028071, 99.10939940518416, 82.67681718232174, 88.13884482834486, 94.64841827805462, 79.03379150280074, 100.96111946212523, 96.16585704020204, 94.150711043625, 83.69854882361513, 97.53407990120782, 103.68651403477361, 93.18756674782581, 105.1237821703607, 84.46728700348454, 90.65966340454918, 81.8181180844061, 86.73937857874864, 82.77132827817455, 82.73797120445934, 100.51228151883302, 95.40811279203609, 95.00914276879958, 79.21438810861719, 89.77421825654093, 106.94059895670485, 94.8674938628885, 104.98515236833411, 79.41279487740321, 95.49760574684106, 85.70216875300186, 87.88922920180298, 93.00756497062993, 77.61573234183945, 98.68009898831389, 94.68199784423601, 92.76745490741156, 86.5886694147898, 90.04575465604951, 99.30303951271925, 89.66602231772814, 104.98664090348511, 78.59037676270037, 96.17481523143343, 82.05537942815678, 91.69521834625696, 90.72296703923742, 81.64600972226569, 100.0011521308996, 96.20692092230695, 94.27443496253088, 82.56808886055553, 90.3849801887039, 98.29909339534927, 90.39033904992009, 106.08333178115821, 80.74261691513873, 95.02931245826855, 85.58081569811817, 84.42332002053722, 87.75828382263974, 83.24460617422783, 98.81461562111967, 89.57295091867068, 93.80467958893949, 78.0342329148104, 90.55088699412585, 103.51275587256076, 94.53388109954972, 101.07559771463994, 78.2535808257946, 95.64530603537831, 84.14089605772763, 89.69832745132021, 79.68298082749696, 75.43349359439993, 100.31419503933637, 87.83676099201328, 86.9063106074541, 80.95683622949673, 91.63928391589266, 99.13931098508662, 92.74385042974019, 101.39799535790847, 77.30751985103753, 93.54381003063595, 84.02555049935285, 85.93704919939373, 87.72265489047906, 79.56598166561642, 97.33576722680587, 93.78980347559926, 90.0980634374571, 86.57086445231685, 94.50229951862303, 100.31521591146416, 95.51930812576776, 104.8560732995558], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7037330308965535, "mean_inference_ms": 8.291343935993892, "mean_action_processing_ms": 0.5653127980536862, "mean_env_wait_ms": 23.743609840260273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04179954528808594, "StateBufferConnector_ms": 0.03414201736450195, "ViewRequirementAgentConnector_ms": 0.9452517032623291}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2011666, "num_agent_steps_trained": 2011666, "num_env_steps_sampled": 2011666, "num_env_steps_trained": 2011666, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 239.52073141208135, "num_env_steps_trained_throughput_per_sec": 239.52073141208135, "timesteps_total": 2011666, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2011666, "timers": {"training_iteration_time_ms": 60637.913, "sample_time_ms": 44791.068, "load_time_ms": 2020.903, "load_throughput": 7738.124, "learn_time_ms": 13174.701, "learn_throughput": 1186.972, "synch_weights_time_ms": 523.962}, "counters": {"num_env_steps_sampled": 2011666, "num_env_steps_trained": 2011666, "num_agent_steps_sampled": 2011666, "num_agent_steps_trained": 2011666}, "done": false, "episodes_total": 2089, "training_iteration": 149, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-56-52", "timestamp": 1749308212, "time_this_iter_s": 65.30871081352234, "time_total_s": 8478.876406431198, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8478.876406431198, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 79.6972972972973, "ram_util_percent": 58.35945945945944, "gpu_util_percent0": 0.08662162162162163, "vram_util_percent0": 0.8409830729166667}}
{"evaluation": {"sampler_results": {"episode_reward_max": 4.813040651248619, "episode_reward_min": 4.351223010767387, "episode_reward_mean": 4.565352015268125, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.813040651248619, 4.709841643181869, 4.395544942516447, 4.557109828626303, 4.351223010767387], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.723625376452381, "mean_inference_ms": 3.9555898793114586, "mean_action_processing_ms": 0.29619606791454056, "mean_env_wait_ms": 12.575466955375795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.060067176818847656, "StateBufferConnector_ms": 0.06072998046875, "ViewRequirementAgentConnector_ms": 0.32042980194091797}}, "episode_reward_max": 4.813040651248619, "episode_reward_min": 4.351223010767387, "episode_reward_mean": 4.565352015268125, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.813040651248619, 4.709841643181869, 4.395544942516447, 4.557109828626303, 4.351223010767387], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.723625376452381, "mean_inference_ms": 3.9555898793114586, "mean_action_processing_ms": 0.29619606791454056, "mean_env_wait_ms": 12.575466955375795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.060067176818847656, "StateBufferConnector_ms": 0.06072998046875, "ViewRequirementAgentConnector_ms": 0.32042980194091797}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.988333999999999e-05, "total_loss": -0.0646346705076708, "policy_loss": -0.012912075066997203, "vf_loss": 0.013846031336791137, "vf_explained_var": 0.9793249852007085, "kl": 0.017810226990820598, "entropy": 16.204726224379105, "entropy_coeff": 0.0034825010000000003}, "model": {}, "num_grad_updates_lifetime": 71175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2027304, "num_env_steps_trained": 2027304, "num_agent_steps_sampled": 2027304, "num_agent_steps_trained": 2027304}, "sampler_results": {"episode_reward_max": 106.94059895670485, "episode_reward_min": 75.43349359439993, "episode_reward_mean": 90.66305767015007, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.18756674782581, 105.1237821703607, 84.46728700348454, 90.65966340454918, 81.8181180844061, 86.73937857874864, 82.77132827817455, 82.73797120445934, 100.51228151883302, 95.40811279203609, 95.00914276879958, 79.21438810861719, 89.77421825654093, 106.94059895670485, 94.8674938628885, 104.98515236833411, 79.41279487740321, 95.49760574684106, 85.70216875300186, 87.88922920180298, 93.00756497062993, 77.61573234183945, 98.68009898831389, 94.68199784423601, 92.76745490741156, 86.5886694147898, 90.04575465604951, 99.30303951271925, 89.66602231772814, 104.98664090348511, 78.59037676270037, 96.17481523143343, 82.05537942815678, 91.69521834625696, 90.72296703923742, 81.64600972226569, 100.0011521308996, 96.20692092230695, 94.27443496253088, 82.56808886055553, 90.3849801887039, 98.29909339534927, 90.39033904992009, 106.08333178115821, 80.74261691513873, 95.02931245826855, 85.58081569811817, 84.42332002053722, 87.75828382263974, 83.24460617422783, 98.81461562111967, 89.57295091867068, 93.80467958893949, 78.0342329148104, 90.55088699412585, 103.51275587256076, 94.53388109954972, 101.07559771463994, 78.2535808257946, 95.64530603537831, 84.14089605772763, 89.69832745132021, 79.68298082749696, 75.43349359439993, 100.31419503933637, 87.83676099201328, 86.9063106074541, 80.95683622949673, 91.63928391589266, 99.13931098508662, 92.74385042974019, 101.39799535790847, 77.30751985103753, 93.54381003063595, 84.02555049935285, 85.93704919939373, 87.72265489047906, 79.56598166561642, 97.33576722680587, 93.78980347559926, 90.0980634374571, 86.57086445231685, 94.50229951862303, 100.31521591146416, 95.51930812576776, 104.8560732995558, 77.27810349369332, 97.32621791885747, 79.40927591947803, 86.36539183482355, 87.96171947576154, 77.69804841321805, 94.42941754868849, 91.73572098744692, 93.39142488318419, 86.31898581710156, 96.82463527486185, 95.94431568324386, 91.2133668478804, 99.69713080778182], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.705244730274467, "mean_inference_ms": 8.299945044266023, "mean_action_processing_ms": 0.5658754789814591, "mean_env_wait_ms": 23.76142099140553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04078531265258789, "StateBufferConnector_ms": 0.02919745445251465, "ViewRequirementAgentConnector_ms": 0.9459891319274902}}, "episode_reward_max": 106.94059895670485, "episode_reward_min": 75.43349359439993, "episode_reward_mean": 90.66305767015007, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [93.18756674782581, 105.1237821703607, 84.46728700348454, 90.65966340454918, 81.8181180844061, 86.73937857874864, 82.77132827817455, 82.73797120445934, 100.51228151883302, 95.40811279203609, 95.00914276879958, 79.21438810861719, 89.77421825654093, 106.94059895670485, 94.8674938628885, 104.98515236833411, 79.41279487740321, 95.49760574684106, 85.70216875300186, 87.88922920180298, 93.00756497062993, 77.61573234183945, 98.68009898831389, 94.68199784423601, 92.76745490741156, 86.5886694147898, 90.04575465604951, 99.30303951271925, 89.66602231772814, 104.98664090348511, 78.59037676270037, 96.17481523143343, 82.05537942815678, 91.69521834625696, 90.72296703923742, 81.64600972226569, 100.0011521308996, 96.20692092230695, 94.27443496253088, 82.56808886055553, 90.3849801887039, 98.29909339534927, 90.39033904992009, 106.08333178115821, 80.74261691513873, 95.02931245826855, 85.58081569811817, 84.42332002053722, 87.75828382263974, 83.24460617422783, 98.81461562111967, 89.57295091867068, 93.80467958893949, 78.0342329148104, 90.55088699412585, 103.51275587256076, 94.53388109954972, 101.07559771463994, 78.2535808257946, 95.64530603537831, 84.14089605772763, 89.69832745132021, 79.68298082749696, 75.43349359439993, 100.31419503933637, 87.83676099201328, 86.9063106074541, 80.95683622949673, 91.63928391589266, 99.13931098508662, 92.74385042974019, 101.39799535790847, 77.30751985103753, 93.54381003063595, 84.02555049935285, 85.93704919939373, 87.72265489047906, 79.56598166561642, 97.33576722680587, 93.78980347559926, 90.0980634374571, 86.57086445231685, 94.50229951862303, 100.31521591146416, 95.51930812576776, 104.8560732995558, 77.27810349369332, 97.32621791885747, 79.40927591947803, 86.36539183482355, 87.96171947576154, 77.69804841321805, 94.42941754868849, 91.73572098744692, 93.39142488318419, 86.31898581710156, 96.82463527486185, 95.94431568324386, 91.2133668478804, 99.69713080778182], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.705244730274467, "mean_inference_ms": 8.299945044266023, "mean_action_processing_ms": 0.5658754789814591, "mean_env_wait_ms": 23.76142099140553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04078531265258789, "StateBufferConnector_ms": 0.02919745445251465, "ViewRequirementAgentConnector_ms": 0.9459891319274902}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2027304, "num_agent_steps_trained": 2027304, "num_env_steps_sampled": 2027304, "num_env_steps_trained": 2027304, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 250.25197528549776, "num_env_steps_trained_throughput_per_sec": 250.25197528549776, "timesteps_total": 2027304, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2027304, "timers": {"training_iteration_time_ms": 60935.784, "sample_time_ms": 45027.606, "load_time_ms": 2053.047, "load_throughput": 7616.971, "learn_time_ms": 13192.051, "learn_throughput": 1185.411, "synch_weights_time_ms": 533.069}, "counters": {"num_env_steps_sampled": 2027304, "num_env_steps_trained": 2027304, "num_agent_steps_sampled": 2027304, "num_agent_steps_trained": 2027304}, "done": false, "episodes_total": 2103, "training_iteration": 150, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-58-12", "timestamp": 1749308292, "time_this_iter_s": 80.11721420288086, "time_total_s": 8558.993620634079, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8558.993620634079, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 64.77282608695653, "ram_util_percent": 59.17065217391304, "gpu_util_percent0": 0.06282608695652173, "vram_util_percent0": 0.840983072916667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.972695999999999e-05, "total_loss": -0.07656140253413468, "policy_loss": -0.024778150607069786, "vf_loss": 0.011941993874497712, "vf_explained_var": 0.9801173824613745, "kl": 0.01787991727853555, "entropy": 16.167645385048605, "entropy_coeff": 0.0034590440000000005}, "model": {}, "num_grad_updates_lifetime": 71725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2042942, "num_env_steps_trained": 2042942, "num_agent_steps_sampled": 2042942, "num_agent_steps_trained": 2042942}, "sampler_results": {"episode_reward_max": 106.08333178115821, "episode_reward_min": 75.43349359439993, "episode_reward_mean": 90.41558870692805, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.8674938628885, 104.98515236833411, 79.41279487740321, 95.49760574684106, 85.70216875300186, 87.88922920180298, 93.00756497062993, 77.61573234183945, 98.68009898831389, 94.68199784423601, 92.76745490741156, 86.5886694147898, 90.04575465604951, 99.30303951271925, 89.66602231772814, 104.98664090348511, 78.59037676270037, 96.17481523143343, 82.05537942815678, 91.69521834625696, 90.72296703923742, 81.64600972226569, 100.0011521308996, 96.20692092230695, 94.27443496253088, 82.56808886055553, 90.3849801887039, 98.29909339534927, 90.39033904992009, 106.08333178115821, 80.74261691513873, 95.02931245826855, 85.58081569811817, 84.42332002053722, 87.75828382263974, 83.24460617422783, 98.81461562111967, 89.57295091867068, 93.80467958893949, 78.0342329148104, 90.55088699412585, 103.51275587256076, 94.53388109954972, 101.07559771463994, 78.2535808257946, 95.64530603537831, 84.14089605772763, 89.69832745132021, 79.68298082749696, 75.43349359439993, 100.31419503933637, 87.83676099201328, 86.9063106074541, 80.95683622949673, 91.63928391589266, 99.13931098508662, 92.74385042974019, 101.39799535790847, 77.30751985103753, 93.54381003063595, 84.02555049935285, 85.93704919939373, 87.72265489047906, 79.56598166561642, 97.33576722680587, 93.78980347559926, 90.0980634374571, 86.57086445231685, 94.50229951862303, 100.31521591146416, 95.51930812576776, 104.8560732995558, 77.27810349369332, 97.32621791885747, 79.40927591947803, 86.36539183482355, 87.96171947576154, 77.69804841321805, 94.42941754868849, 91.73572098744692, 93.39142488318419, 86.31898581710156, 96.82463527486185, 95.94431568324386, 91.2133668478804, 99.69713080778182, 79.89956975793687, 94.04530607519565, 79.88043147901125, 87.31451676780262, 85.74291686840148, 79.90067421749448, 94.73049881864867, 91.47854548805039, 92.90748835292575, 82.57281016039958, 92.08637092216277, 96.08961233497102, 90.71406643173508, 102.25413387660096], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7067513706021846, "mean_inference_ms": 8.308809107734092, "mean_action_processing_ms": 0.5664494292746742, "mean_env_wait_ms": 23.779543743930546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0406794548034668, "StateBufferConnector_ms": 0.03218269348144531, "ViewRequirementAgentConnector_ms": 0.9681308269500732}}, "episode_reward_max": 106.08333178115821, "episode_reward_min": 75.43349359439993, "episode_reward_mean": 90.41558870692805, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [94.8674938628885, 104.98515236833411, 79.41279487740321, 95.49760574684106, 85.70216875300186, 87.88922920180298, 93.00756497062993, 77.61573234183945, 98.68009898831389, 94.68199784423601, 92.76745490741156, 86.5886694147898, 90.04575465604951, 99.30303951271925, 89.66602231772814, 104.98664090348511, 78.59037676270037, 96.17481523143343, 82.05537942815678, 91.69521834625696, 90.72296703923742, 81.64600972226569, 100.0011521308996, 96.20692092230695, 94.27443496253088, 82.56808886055553, 90.3849801887039, 98.29909339534927, 90.39033904992009, 106.08333178115821, 80.74261691513873, 95.02931245826855, 85.58081569811817, 84.42332002053722, 87.75828382263974, 83.24460617422783, 98.81461562111967, 89.57295091867068, 93.80467958893949, 78.0342329148104, 90.55088699412585, 103.51275587256076, 94.53388109954972, 101.07559771463994, 78.2535808257946, 95.64530603537831, 84.14089605772763, 89.69832745132021, 79.68298082749696, 75.43349359439993, 100.31419503933637, 87.83676099201328, 86.9063106074541, 80.95683622949673, 91.63928391589266, 99.13931098508662, 92.74385042974019, 101.39799535790847, 77.30751985103753, 93.54381003063595, 84.02555049935285, 85.93704919939373, 87.72265489047906, 79.56598166561642, 97.33576722680587, 93.78980347559926, 90.0980634374571, 86.57086445231685, 94.50229951862303, 100.31521591146416, 95.51930812576776, 104.8560732995558, 77.27810349369332, 97.32621791885747, 79.40927591947803, 86.36539183482355, 87.96171947576154, 77.69804841321805, 94.42941754868849, 91.73572098744692, 93.39142488318419, 86.31898581710156, 96.82463527486185, 95.94431568324386, 91.2133668478804, 99.69713080778182, 79.89956975793687, 94.04530607519565, 79.88043147901125, 87.31451676780262, 85.74291686840148, 79.90067421749448, 94.73049881864867, 91.47854548805039, 92.90748835292575, 82.57281016039958, 92.08637092216277, 96.08961233497102, 90.71406643173508, 102.25413387660096], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7067513706021846, "mean_inference_ms": 8.308809107734092, "mean_action_processing_ms": 0.5664494292746742, "mean_env_wait_ms": 23.779543743930546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0406794548034668, "StateBufferConnector_ms": 0.03218269348144531, "ViewRequirementAgentConnector_ms": 0.9681308269500732}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2042942, "num_agent_steps_trained": 2042942, "num_env_steps_sampled": 2042942, "num_env_steps_trained": 2042942, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 260.37246863045027, "num_env_steps_trained_throughput_per_sec": 260.37246863045027, "timesteps_total": 2042942, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2042942, "timers": {"training_iteration_time_ms": 60955.47, "sample_time_ms": 45093.822, "load_time_ms": 2035.656, "load_throughput": 7682.046, "learn_time_ms": 13159.99, "learn_throughput": 1188.299, "synch_weights_time_ms": 536.365}, "counters": {"num_env_steps_sampled": 2042942, "num_env_steps_trained": 2042942, "num_agent_steps_sampled": 2042942, "num_agent_steps_trained": 2042942}, "done": false, "episodes_total": 2117, "training_iteration": 151, "trial_id": "b7a4b_00000", "date": "2025-06-07_16-59-12", "timestamp": 1749308352, "time_this_iter_s": 60.0758171081543, "time_total_s": 8619.069437742233, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8619.069437742233, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 77.21739130434784, "ram_util_percent": 59.71014492753622, "gpu_util_percent0": 0.08275362318840579, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.957057999999999e-05, "total_loss": -0.06368016715833537, "policy_loss": -0.012656851042054107, "vf_loss": 0.013210291613782333, "vf_explained_var": 0.9807834750955755, "kl": 0.017877820484101966, "entropy": 16.167567832253194, "entropy_coeff": 0.003435587}, "model": {}, "num_grad_updates_lifetime": 72275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2058580, "num_env_steps_trained": 2058580, "num_agent_steps_sampled": 2058580, "num_agent_steps_trained": 2058580}, "sampler_results": {"episode_reward_max": 106.08333178115821, "episode_reward_min": 75.43349359439993, "episode_reward_mean": 89.99054602353688, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.66602231772814, 104.98664090348511, 78.59037676270037, 96.17481523143343, 82.05537942815678, 91.69521834625696, 90.72296703923742, 81.64600972226569, 100.0011521308996, 96.20692092230695, 94.27443496253088, 82.56808886055553, 90.3849801887039, 98.29909339534927, 90.39033904992009, 106.08333178115821, 80.74261691513873, 95.02931245826855, 85.58081569811817, 84.42332002053722, 87.75828382263974, 83.24460617422783, 98.81461562111967, 89.57295091867068, 93.80467958893949, 78.0342329148104, 90.55088699412585, 103.51275587256076, 94.53388109954972, 101.07559771463994, 78.2535808257946, 95.64530603537831, 84.14089605772763, 89.69832745132021, 79.68298082749696, 75.43349359439993, 100.31419503933637, 87.83676099201328, 86.9063106074541, 80.95683622949673, 91.63928391589266, 99.13931098508662, 92.74385042974019, 101.39799535790847, 77.30751985103753, 93.54381003063595, 84.02555049935285, 85.93704919939373, 87.72265489047906, 79.56598166561642, 97.33576722680587, 93.78980347559926, 90.0980634374571, 86.57086445231685, 94.50229951862303, 100.31521591146416, 95.51930812576776, 104.8560732995558, 77.27810349369332, 97.32621791885747, 79.40927591947803, 86.36539183482355, 87.96171947576154, 77.69804841321805, 94.42941754868849, 91.73572098744692, 93.39142488318419, 86.31898581710156, 96.82463527486185, 95.94431568324386, 91.2133668478804, 99.69713080778182, 79.89956975793687, 94.04530607519565, 79.88043147901125, 87.31451676780262, 85.74291686840148, 79.90067421749448, 94.73049881864867, 91.47854548805039, 92.90748835292575, 82.57281016039958, 92.08637092216277, 96.08961233497102, 90.71406643173508, 102.25413387660096, 78.57427429490147, 90.02910503471752, 79.80019276108166, 86.49791328394915, 86.91594764461642, 77.00930033132335, 99.75226670522852, 87.04701184060481, 92.28830386289822, 77.28276537405246, 93.60769700054132, 93.75610185826672, 96.74122867477352, 99.23838044018886], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7084353777167682, "mean_inference_ms": 8.317628084811485, "mean_action_processing_ms": 0.5669990806147551, "mean_env_wait_ms": 23.797173609200613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04108619689941406, "StateBufferConnector_ms": 0.0341649055480957, "ViewRequirementAgentConnector_ms": 0.960028886795044}}, "episode_reward_max": 106.08333178115821, "episode_reward_min": 75.43349359439993, "episode_reward_mean": 89.99054602353688, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89.66602231772814, 104.98664090348511, 78.59037676270037, 96.17481523143343, 82.05537942815678, 91.69521834625696, 90.72296703923742, 81.64600972226569, 100.0011521308996, 96.20692092230695, 94.27443496253088, 82.56808886055553, 90.3849801887039, 98.29909339534927, 90.39033904992009, 106.08333178115821, 80.74261691513873, 95.02931245826855, 85.58081569811817, 84.42332002053722, 87.75828382263974, 83.24460617422783, 98.81461562111967, 89.57295091867068, 93.80467958893949, 78.0342329148104, 90.55088699412585, 103.51275587256076, 94.53388109954972, 101.07559771463994, 78.2535808257946, 95.64530603537831, 84.14089605772763, 89.69832745132021, 79.68298082749696, 75.43349359439993, 100.31419503933637, 87.83676099201328, 86.9063106074541, 80.95683622949673, 91.63928391589266, 99.13931098508662, 92.74385042974019, 101.39799535790847, 77.30751985103753, 93.54381003063595, 84.02555049935285, 85.93704919939373, 87.72265489047906, 79.56598166561642, 97.33576722680587, 93.78980347559926, 90.0980634374571, 86.57086445231685, 94.50229951862303, 100.31521591146416, 95.51930812576776, 104.8560732995558, 77.27810349369332, 97.32621791885747, 79.40927591947803, 86.36539183482355, 87.96171947576154, 77.69804841321805, 94.42941754868849, 91.73572098744692, 93.39142488318419, 86.31898581710156, 96.82463527486185, 95.94431568324386, 91.2133668478804, 99.69713080778182, 79.89956975793687, 94.04530607519565, 79.88043147901125, 87.31451676780262, 85.74291686840148, 79.90067421749448, 94.73049881864867, 91.47854548805039, 92.90748835292575, 82.57281016039958, 92.08637092216277, 96.08961233497102, 90.71406643173508, 102.25413387660096, 78.57427429490147, 90.02910503471752, 79.80019276108166, 86.49791328394915, 86.91594764461642, 77.00930033132335, 99.75226670522852, 87.04701184060481, 92.28830386289822, 77.28276537405246, 93.60769700054132, 93.75610185826672, 96.74122867477352, 99.23838044018886], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7084353777167682, "mean_inference_ms": 8.317628084811485, "mean_action_processing_ms": 0.5669990806147551, "mean_env_wait_ms": 23.797173609200613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04108619689941406, "StateBufferConnector_ms": 0.0341649055480957, "ViewRequirementAgentConnector_ms": 0.960028886795044}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2058580, "num_agent_steps_trained": 2058580, "num_env_steps_sampled": 2058580, "num_env_steps_trained": 2058580, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 264.320118522786, "num_env_steps_trained_throughput_per_sec": 264.320118522786, "timesteps_total": 2058580, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2058580, "timers": {"training_iteration_time_ms": 60860.819, "sample_time_ms": 45082.99, "load_time_ms": 2034.944, "load_throughput": 7684.733, "learn_time_ms": 13073.577, "learn_throughput": 1196.153, "synch_weights_time_ms": 539.436}, "counters": {"num_env_steps_sampled": 2058580, "num_env_steps_trained": 2058580, "num_agent_steps_sampled": 2058580, "num_agent_steps_trained": 2058580}, "done": false, "episodes_total": 2131, "training_iteration": 152, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-00-12", "timestamp": 1749308412, "time_this_iter_s": 59.17810559272766, "time_total_s": 8678.247543334961, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8678.247543334961, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 77.28823529411765, "ram_util_percent": 59.32058823529411, "gpu_util_percent0": 0.08058823529411765, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.94142e-05, "total_loss": -0.06563284809616479, "policy_loss": -0.015534782143817706, "vf_loss": 0.014660930901935154, "vf_explained_var": 0.9760440260713751, "kl": 0.018318899698898227, "entropy": 16.139129245064474, "entropy_coeff": 0.00341213}, "model": {}, "num_grad_updates_lifetime": 72825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2074218, "num_env_steps_trained": 2074218, "num_agent_steps_sampled": 2074218, "num_agent_steps_trained": 2074218}, "sampler_results": {"episode_reward_max": 106.08333178115821, "episode_reward_min": 73.3693282684645, "episode_reward_mean": 89.5293320238407, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.39033904992009, 106.08333178115821, 80.74261691513873, 95.02931245826855, 85.58081569811817, 84.42332002053722, 87.75828382263974, 83.24460617422783, 98.81461562111967, 89.57295091867068, 93.80467958893949, 78.0342329148104, 90.55088699412585, 103.51275587256076, 94.53388109954972, 101.07559771463994, 78.2535808257946, 95.64530603537831, 84.14089605772763, 89.69832745132021, 79.68298082749696, 75.43349359439993, 100.31419503933637, 87.83676099201328, 86.9063106074541, 80.95683622949673, 91.63928391589266, 99.13931098508662, 92.74385042974019, 101.39799535790847, 77.30751985103753, 93.54381003063595, 84.02555049935285, 85.93704919939373, 87.72265489047906, 79.56598166561642, 97.33576722680587, 93.78980347559926, 90.0980634374571, 86.57086445231685, 94.50229951862303, 100.31521591146416, 95.51930812576776, 104.8560732995558, 77.27810349369332, 97.32621791885747, 79.40927591947803, 86.36539183482355, 87.96171947576154, 77.69804841321805, 94.42941754868849, 91.73572098744692, 93.39142488318419, 86.31898581710156, 96.82463527486185, 95.94431568324386, 91.2133668478804, 99.69713080778182, 79.89956975793687, 94.04530607519565, 79.88043147901125, 87.31451676780262, 85.74291686840148, 79.90067421749448, 94.73049881864867, 91.47854548805039, 92.90748835292575, 82.57281016039958, 92.08637092216277, 96.08961233497102, 90.71406643173508, 102.25413387660096, 78.57427429490147, 90.02910503471752, 79.80019276108166, 86.49791328394915, 86.91594764461642, 77.00930033132335, 99.75226670522852, 87.04701184060481, 92.28830386289822, 77.28276537405246, 93.60769700054132, 93.75610185826672, 96.74122867477352, 99.23838044018886, 73.3693282684645, 94.05726602050815, 82.6975567363105, 87.93277730277921, 89.03109526677419, 74.59803712071925, 96.4855265122377, 87.0138288313839, 85.84256647116298, 83.77578968518331, 98.98897461235781, 97.37729485938203, 79.7280490479905, 100.25260950673828], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.710200412890641, "mean_inference_ms": 8.326307783950659, "mean_action_processing_ms": 0.5675521486630936, "mean_env_wait_ms": 23.814281056011836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03972434997558594, "StateBufferConnector_ms": 0.03509402275085449, "ViewRequirementAgentConnector_ms": 0.9758329391479492}}, "episode_reward_max": 106.08333178115821, "episode_reward_min": 73.3693282684645, "episode_reward_mean": 89.5293320238407, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [90.39033904992009, 106.08333178115821, 80.74261691513873, 95.02931245826855, 85.58081569811817, 84.42332002053722, 87.75828382263974, 83.24460617422783, 98.81461562111967, 89.57295091867068, 93.80467958893949, 78.0342329148104, 90.55088699412585, 103.51275587256076, 94.53388109954972, 101.07559771463994, 78.2535808257946, 95.64530603537831, 84.14089605772763, 89.69832745132021, 79.68298082749696, 75.43349359439993, 100.31419503933637, 87.83676099201328, 86.9063106074541, 80.95683622949673, 91.63928391589266, 99.13931098508662, 92.74385042974019, 101.39799535790847, 77.30751985103753, 93.54381003063595, 84.02555049935285, 85.93704919939373, 87.72265489047906, 79.56598166561642, 97.33576722680587, 93.78980347559926, 90.0980634374571, 86.57086445231685, 94.50229951862303, 100.31521591146416, 95.51930812576776, 104.8560732995558, 77.27810349369332, 97.32621791885747, 79.40927591947803, 86.36539183482355, 87.96171947576154, 77.69804841321805, 94.42941754868849, 91.73572098744692, 93.39142488318419, 86.31898581710156, 96.82463527486185, 95.94431568324386, 91.2133668478804, 99.69713080778182, 79.89956975793687, 94.04530607519565, 79.88043147901125, 87.31451676780262, 85.74291686840148, 79.90067421749448, 94.73049881864867, 91.47854548805039, 92.90748835292575, 82.57281016039958, 92.08637092216277, 96.08961233497102, 90.71406643173508, 102.25413387660096, 78.57427429490147, 90.02910503471752, 79.80019276108166, 86.49791328394915, 86.91594764461642, 77.00930033132335, 99.75226670522852, 87.04701184060481, 92.28830386289822, 77.28276537405246, 93.60769700054132, 93.75610185826672, 96.74122867477352, 99.23838044018886, 73.3693282684645, 94.05726602050815, 82.6975567363105, 87.93277730277921, 89.03109526677419, 74.59803712071925, 96.4855265122377, 87.0138288313839, 85.84256647116298, 83.77578968518331, 98.98897461235781, 97.37729485938203, 79.7280490479905, 100.25260950673828], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.710200412890641, "mean_inference_ms": 8.326307783950659, "mean_action_processing_ms": 0.5675521486630936, "mean_env_wait_ms": 23.814281056011836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03972434997558594, "StateBufferConnector_ms": 0.03509402275085449, "ViewRequirementAgentConnector_ms": 0.9758329391479492}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2074218, "num_agent_steps_trained": 2074218, "num_env_steps_sampled": 2074218, "num_env_steps_trained": 2074218, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 258.862293878358, "num_env_steps_trained_throughput_per_sec": 258.862293878358, "timesteps_total": 2074218, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2074218, "timers": {"training_iteration_time_ms": 60931.566, "sample_time_ms": 45195.027, "load_time_ms": 2047.557, "load_throughput": 7637.395, "learn_time_ms": 13039.837, "learn_throughput": 1199.248, "synch_weights_time_ms": 515.424}, "counters": {"num_env_steps_sampled": 2074218, "num_env_steps_trained": 2074218, "num_agent_steps_sampled": 2074218, "num_agent_steps_trained": 2074218}, "done": false, "episodes_total": 2145, "training_iteration": 153, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-01-12", "timestamp": 1749308472, "time_this_iter_s": 60.425508975982666, "time_total_s": 8738.673052310944, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8738.673052310944, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 77.81304347826088, "ram_util_percent": 59.92318840579711, "gpu_util_percent0": 0.08884057971014492, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.925782e-05, "total_loss": -0.07844527478626168, "policy_loss": -0.028219860775226896, "vf_loss": 0.012683797122444957, "vf_explained_var": 0.9808931602131237, "kl": 0.0181218757595144, "entropy": 16.111575697118585, "entropy_coeff": 0.003388673000000001}, "model": {}, "num_grad_updates_lifetime": 73375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2089856, "num_env_steps_trained": 2089856, "num_agent_steps_sampled": 2089856, "num_agent_steps_trained": 2089856}, "sampler_results": {"episode_reward_max": 104.8560732995558, "episode_reward_min": 73.3693282684645, "episode_reward_mean": 89.35346465918299, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.53388109954972, 101.07559771463994, 78.2535808257946, 95.64530603537831, 84.14089605772763, 89.69832745132021, 79.68298082749696, 75.43349359439993, 100.31419503933637, 87.83676099201328, 86.9063106074541, 80.95683622949673, 91.63928391589266, 99.13931098508662, 92.74385042974019, 101.39799535790847, 77.30751985103753, 93.54381003063595, 84.02555049935285, 85.93704919939373, 87.72265489047906, 79.56598166561642, 97.33576722680587, 93.78980347559926, 90.0980634374571, 86.57086445231685, 94.50229951862303, 100.31521591146416, 95.51930812576776, 104.8560732995558, 77.27810349369332, 97.32621791885747, 79.40927591947803, 86.36539183482355, 87.96171947576154, 77.69804841321805, 94.42941754868849, 91.73572098744692, 93.39142488318419, 86.31898581710156, 96.82463527486185, 95.94431568324386, 91.2133668478804, 99.69713080778182, 79.89956975793687, 94.04530607519565, 79.88043147901125, 87.31451676780262, 85.74291686840148, 79.90067421749448, 94.73049881864867, 91.47854548805039, 92.90748835292575, 82.57281016039958, 92.08637092216277, 96.08961233497102, 90.71406643173508, 102.25413387660096, 78.57427429490147, 90.02910503471752, 79.80019276108166, 86.49791328394915, 86.91594764461642, 77.00930033132335, 99.75226670522852, 87.04701184060481, 92.28830386289822, 77.28276537405246, 93.60769700054132, 93.75610185826672, 96.74122867477352, 99.23838044018886, 73.3693282684645, 94.05726602050815, 82.6975567363105, 87.93277730277921, 89.03109526677419, 74.59803712071925, 96.4855265122377, 87.0138288313839, 85.84256647116298, 83.77578968518331, 98.98897461235781, 97.37729485938203, 79.7280490479905, 100.25260950673828, 79.3591849275108, 92.24853636182027, 84.16114008959005, 89.40194362690016, 86.55245239727948, 76.81746763513527, 96.87361163087324, 90.25535934056053, 92.27659881895497, 78.29924347392647, 91.23731776379539, 97.51413014114898, 92.16912577399657, 102.78989938297207], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.711848275641764, "mean_inference_ms": 8.334308103081353, "mean_action_processing_ms": 0.5680876122236456, "mean_env_wait_ms": 23.829522377557172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04073476791381836, "StateBufferConnector_ms": 0.031112194061279297, "ViewRequirementAgentConnector_ms": 1.0099897384643555}}, "episode_reward_max": 104.8560732995558, "episode_reward_min": 73.3693282684645, "episode_reward_mean": 89.35346465918299, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [94.53388109954972, 101.07559771463994, 78.2535808257946, 95.64530603537831, 84.14089605772763, 89.69832745132021, 79.68298082749696, 75.43349359439993, 100.31419503933637, 87.83676099201328, 86.9063106074541, 80.95683622949673, 91.63928391589266, 99.13931098508662, 92.74385042974019, 101.39799535790847, 77.30751985103753, 93.54381003063595, 84.02555049935285, 85.93704919939373, 87.72265489047906, 79.56598166561642, 97.33576722680587, 93.78980347559926, 90.0980634374571, 86.57086445231685, 94.50229951862303, 100.31521591146416, 95.51930812576776, 104.8560732995558, 77.27810349369332, 97.32621791885747, 79.40927591947803, 86.36539183482355, 87.96171947576154, 77.69804841321805, 94.42941754868849, 91.73572098744692, 93.39142488318419, 86.31898581710156, 96.82463527486185, 95.94431568324386, 91.2133668478804, 99.69713080778182, 79.89956975793687, 94.04530607519565, 79.88043147901125, 87.31451676780262, 85.74291686840148, 79.90067421749448, 94.73049881864867, 91.47854548805039, 92.90748835292575, 82.57281016039958, 92.08637092216277, 96.08961233497102, 90.71406643173508, 102.25413387660096, 78.57427429490147, 90.02910503471752, 79.80019276108166, 86.49791328394915, 86.91594764461642, 77.00930033132335, 99.75226670522852, 87.04701184060481, 92.28830386289822, 77.28276537405246, 93.60769700054132, 93.75610185826672, 96.74122867477352, 99.23838044018886, 73.3693282684645, 94.05726602050815, 82.6975567363105, 87.93277730277921, 89.03109526677419, 74.59803712071925, 96.4855265122377, 87.0138288313839, 85.84256647116298, 83.77578968518331, 98.98897461235781, 97.37729485938203, 79.7280490479905, 100.25260950673828, 79.3591849275108, 92.24853636182027, 84.16114008959005, 89.40194362690016, 86.55245239727948, 76.81746763513527, 96.87361163087324, 90.25535934056053, 92.27659881895497, 78.29924347392647, 91.23731776379539, 97.51413014114898, 92.16912577399657, 102.78989938297207], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.711848275641764, "mean_inference_ms": 8.334308103081353, "mean_action_processing_ms": 0.5680876122236456, "mean_env_wait_ms": 23.829522377557172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04073476791381836, "StateBufferConnector_ms": 0.031112194061279297, "ViewRequirementAgentConnector_ms": 1.0099897384643555}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2089856, "num_agent_steps_trained": 2089856, "num_env_steps_sampled": 2089856, "num_env_steps_trained": 2089856, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 260.75240826711206, "num_env_steps_trained_throughput_per_sec": 260.75240826711206, "timesteps_total": 2089856, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2089856, "timers": {"training_iteration_time_ms": 61031.527, "sample_time_ms": 45251.559, "load_time_ms": 2041.73, "load_throughput": 7659.191, "learn_time_ms": 13088.299, "learn_throughput": 1194.808, "synch_weights_time_ms": 514.73}, "counters": {"num_env_steps_sampled": 2089856, "num_env_steps_trained": 2089856, "num_agent_steps_sampled": 2089856, "num_agent_steps_trained": 2089856}, "done": false, "episodes_total": 2159, "training_iteration": 154, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-02-12", "timestamp": 1749308532, "time_this_iter_s": 60.04232144355774, "time_total_s": 8798.715373754501, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8798.715373754501, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 77.51884057971016, "ram_util_percent": 60.08840579710145, "gpu_util_percent0": 0.09028985507246375, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.910144e-05, "total_loss": -0.06664647842630406, "policy_loss": -0.016919010960899122, "vf_loss": 0.013440085060217164, "vf_explained_var": 0.9804597172953866, "kl": 0.019181924811967628, "entropy": 16.153176089200105, "entropy_coeff": 0.0033652160000000003}, "model": {}, "num_grad_updates_lifetime": 73925.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2105494, "num_env_steps_trained": 2105494, "num_agent_steps_sampled": 2105494, "num_agent_steps_trained": 2105494}, "sampler_results": {"episode_reward_max": 104.8560732995558, "episode_reward_min": 73.3693282684645, "episode_reward_mean": 89.23839195005738, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.74385042974019, 101.39799535790847, 77.30751985103753, 93.54381003063595, 84.02555049935285, 85.93704919939373, 87.72265489047906, 79.56598166561642, 97.33576722680587, 93.78980347559926, 90.0980634374571, 86.57086445231685, 94.50229951862303, 100.31521591146416, 95.51930812576776, 104.8560732995558, 77.27810349369332, 97.32621791885747, 79.40927591947803, 86.36539183482355, 87.96171947576154, 77.69804841321805, 94.42941754868849, 91.73572098744692, 93.39142488318419, 86.31898581710156, 96.82463527486185, 95.94431568324386, 91.2133668478804, 99.69713080778182, 79.89956975793687, 94.04530607519565, 79.88043147901125, 87.31451676780262, 85.74291686840148, 79.90067421749448, 94.73049881864867, 91.47854548805039, 92.90748835292575, 82.57281016039958, 92.08637092216277, 96.08961233497102, 90.71406643173508, 102.25413387660096, 78.57427429490147, 90.02910503471752, 79.80019276108166, 86.49791328394915, 86.91594764461642, 77.00930033132335, 99.75226670522852, 87.04701184060481, 92.28830386289822, 77.28276537405246, 93.60769700054132, 93.75610185826672, 96.74122867477352, 99.23838044018886, 73.3693282684645, 94.05726602050815, 82.6975567363105, 87.93277730277921, 89.03109526677419, 74.59803712071925, 96.4855265122377, 87.0138288313839, 85.84256647116298, 83.77578968518331, 98.98897461235781, 97.37729485938203, 79.7280490479905, 100.25260950673828, 79.3591849275108, 92.24853636182027, 84.16114008959005, 89.40194362690016, 86.55245239727948, 76.81746763513527, 96.87361163087324, 90.25535934056053, 92.27659881895497, 78.29924347392647, 91.23731776379539, 97.51413014114898, 92.16912577399657, 102.78989938297207, 79.81322410024418, 89.99423530898706, 78.97290540034838, 81.73033274217816, 89.53408489745402, 76.10921142581502, 96.66105980377897, 93.11416128330832, 87.56334299446449, 83.01791114073113, 91.58455355080801, 100.91403897762825, 88.93570114671039, 95.80472769056885], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.713640844889619, "mean_inference_ms": 8.342887532294549, "mean_action_processing_ms": 0.5686613240567074, "mean_env_wait_ms": 23.846138490884886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040613651275634766, "StateBufferConnector_ms": 0.030995845794677734, "ViewRequirementAgentConnector_ms": 0.9712374210357666}}, "episode_reward_max": 104.8560732995558, "episode_reward_min": 73.3693282684645, "episode_reward_mean": 89.23839195005738, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [92.74385042974019, 101.39799535790847, 77.30751985103753, 93.54381003063595, 84.02555049935285, 85.93704919939373, 87.72265489047906, 79.56598166561642, 97.33576722680587, 93.78980347559926, 90.0980634374571, 86.57086445231685, 94.50229951862303, 100.31521591146416, 95.51930812576776, 104.8560732995558, 77.27810349369332, 97.32621791885747, 79.40927591947803, 86.36539183482355, 87.96171947576154, 77.69804841321805, 94.42941754868849, 91.73572098744692, 93.39142488318419, 86.31898581710156, 96.82463527486185, 95.94431568324386, 91.2133668478804, 99.69713080778182, 79.89956975793687, 94.04530607519565, 79.88043147901125, 87.31451676780262, 85.74291686840148, 79.90067421749448, 94.73049881864867, 91.47854548805039, 92.90748835292575, 82.57281016039958, 92.08637092216277, 96.08961233497102, 90.71406643173508, 102.25413387660096, 78.57427429490147, 90.02910503471752, 79.80019276108166, 86.49791328394915, 86.91594764461642, 77.00930033132335, 99.75226670522852, 87.04701184060481, 92.28830386289822, 77.28276537405246, 93.60769700054132, 93.75610185826672, 96.74122867477352, 99.23838044018886, 73.3693282684645, 94.05726602050815, 82.6975567363105, 87.93277730277921, 89.03109526677419, 74.59803712071925, 96.4855265122377, 87.0138288313839, 85.84256647116298, 83.77578968518331, 98.98897461235781, 97.37729485938203, 79.7280490479905, 100.25260950673828, 79.3591849275108, 92.24853636182027, 84.16114008959005, 89.40194362690016, 86.55245239727948, 76.81746763513527, 96.87361163087324, 90.25535934056053, 92.27659881895497, 78.29924347392647, 91.23731776379539, 97.51413014114898, 92.16912577399657, 102.78989938297207, 79.81322410024418, 89.99423530898706, 78.97290540034838, 81.73033274217816, 89.53408489745402, 76.10921142581502, 96.66105980377897, 93.11416128330832, 87.56334299446449, 83.01791114073113, 91.58455355080801, 100.91403897762825, 88.93570114671039, 95.80472769056885], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.713640844889619, "mean_inference_ms": 8.342887532294549, "mean_action_processing_ms": 0.5686613240567074, "mean_env_wait_ms": 23.846138490884886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040613651275634766, "StateBufferConnector_ms": 0.030995845794677734, "ViewRequirementAgentConnector_ms": 0.9712374210357666}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2105494, "num_agent_steps_trained": 2105494, "num_env_steps_sampled": 2105494, "num_env_steps_trained": 2105494, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 253.23309040332234, "num_env_steps_trained_throughput_per_sec": 253.23309040332234, "timesteps_total": 2105494, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2105494, "timers": {"training_iteration_time_ms": 61187.457, "sample_time_ms": 45484.593, "load_time_ms": 2040.249, "load_throughput": 7664.75, "learn_time_ms": 13004.662, "learn_throughput": 1202.492, "synch_weights_time_ms": 520.854}, "counters": {"num_env_steps_sampled": 2105494, "num_env_steps_trained": 2105494, "num_agent_steps_sampled": 2105494, "num_agent_steps_trained": 2105494}, "done": false, "episodes_total": 2173, "training_iteration": 155, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-03-14", "timestamp": 1749308594, "time_this_iter_s": 61.772381067276, "time_total_s": 8860.487754821777, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8860.487754821777, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 78.46, "ram_util_percent": 59.71571428571428, "gpu_util_percent0": 0.08014285714285713, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.894506e-05, "total_loss": -0.05776430306109515, "policy_loss": -0.00842838932717727, "vf_loss": 0.013314266090535305, "vf_explained_var": 0.9826745603301308, "kl": 0.019610648108969217, "entropy": 16.142104871923273, "entropy_coeff": 0.0033417590000000006}, "model": {}, "num_grad_updates_lifetime": 74475.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2121132, "num_env_steps_trained": 2121132, "num_agent_steps_sampled": 2121132, "num_agent_steps_trained": 2121132}, "sampler_results": {"episode_reward_max": 104.8560732995558, "episode_reward_min": 73.3693282684645, "episode_reward_mean": 89.06134204010299, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.51930812576776, 104.8560732995558, 77.27810349369332, 97.32621791885747, 79.40927591947803, 86.36539183482355, 87.96171947576154, 77.69804841321805, 94.42941754868849, 91.73572098744692, 93.39142488318419, 86.31898581710156, 96.82463527486185, 95.94431568324386, 91.2133668478804, 99.69713080778182, 79.89956975793687, 94.04530607519565, 79.88043147901125, 87.31451676780262, 85.74291686840148, 79.90067421749448, 94.73049881864867, 91.47854548805039, 92.90748835292575, 82.57281016039958, 92.08637092216277, 96.08961233497102, 90.71406643173508, 102.25413387660096, 78.57427429490147, 90.02910503471752, 79.80019276108166, 86.49791328394915, 86.91594764461642, 77.00930033132335, 99.75226670522852, 87.04701184060481, 92.28830386289822, 77.28276537405246, 93.60769700054132, 93.75610185826672, 96.74122867477352, 99.23838044018886, 73.3693282684645, 94.05726602050815, 82.6975567363105, 87.93277730277921, 89.03109526677419, 74.59803712071925, 96.4855265122377, 87.0138288313839, 85.84256647116298, 83.77578968518331, 98.98897461235781, 97.37729485938203, 79.7280490479905, 100.25260950673828, 79.3591849275108, 92.24853636182027, 84.16114008959005, 89.40194362690016, 86.55245239727948, 76.81746763513527, 96.87361163087324, 90.25535934056053, 92.27659881895497, 78.29924347392647, 91.23731776379539, 97.51413014114898, 92.16912577399657, 102.78989938297207, 79.81322410024418, 89.99423530898706, 78.97290540034838, 81.73033274217816, 89.53408489745402, 76.10921142581502, 96.66105980377897, 93.11416128330832, 87.56334299446449, 83.01791114073113, 91.58455355080801, 100.91403897762825, 88.93570114671039, 95.80472769056885, 81.8109844417392, 89.03372456696337, 79.72500408907945, 86.96195840276572, 83.40627413689394, 75.02471165872836, 95.86029528427943, 93.37527942328579, 90.3417257738142, 82.24794604409354, 89.88185921125277, 99.84550825066358, 96.3870745456396, 103.24908912179264], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.715514667411789, "mean_inference_ms": 8.351153809162202, "mean_action_processing_ms": 0.5692259725714461, "mean_env_wait_ms": 23.861785124785523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034576416015625, "StateBufferConnector_ms": 0.03011798858642578, "ViewRequirementAgentConnector_ms": 0.9545767307281494}}, "episode_reward_max": 104.8560732995558, "episode_reward_min": 73.3693282684645, "episode_reward_mean": 89.06134204010299, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [95.51930812576776, 104.8560732995558, 77.27810349369332, 97.32621791885747, 79.40927591947803, 86.36539183482355, 87.96171947576154, 77.69804841321805, 94.42941754868849, 91.73572098744692, 93.39142488318419, 86.31898581710156, 96.82463527486185, 95.94431568324386, 91.2133668478804, 99.69713080778182, 79.89956975793687, 94.04530607519565, 79.88043147901125, 87.31451676780262, 85.74291686840148, 79.90067421749448, 94.73049881864867, 91.47854548805039, 92.90748835292575, 82.57281016039958, 92.08637092216277, 96.08961233497102, 90.71406643173508, 102.25413387660096, 78.57427429490147, 90.02910503471752, 79.80019276108166, 86.49791328394915, 86.91594764461642, 77.00930033132335, 99.75226670522852, 87.04701184060481, 92.28830386289822, 77.28276537405246, 93.60769700054132, 93.75610185826672, 96.74122867477352, 99.23838044018886, 73.3693282684645, 94.05726602050815, 82.6975567363105, 87.93277730277921, 89.03109526677419, 74.59803712071925, 96.4855265122377, 87.0138288313839, 85.84256647116298, 83.77578968518331, 98.98897461235781, 97.37729485938203, 79.7280490479905, 100.25260950673828, 79.3591849275108, 92.24853636182027, 84.16114008959005, 89.40194362690016, 86.55245239727948, 76.81746763513527, 96.87361163087324, 90.25535934056053, 92.27659881895497, 78.29924347392647, 91.23731776379539, 97.51413014114898, 92.16912577399657, 102.78989938297207, 79.81322410024418, 89.99423530898706, 78.97290540034838, 81.73033274217816, 89.53408489745402, 76.10921142581502, 96.66105980377897, 93.11416128330832, 87.56334299446449, 83.01791114073113, 91.58455355080801, 100.91403897762825, 88.93570114671039, 95.80472769056885, 81.8109844417392, 89.03372456696337, 79.72500408907945, 86.96195840276572, 83.40627413689394, 75.02471165872836, 95.86029528427943, 93.37527942328579, 90.3417257738142, 82.24794604409354, 89.88185921125277, 99.84550825066358, 96.3870745456396, 103.24908912179264], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.715514667411789, "mean_inference_ms": 8.351153809162202, "mean_action_processing_ms": 0.5692259725714461, "mean_env_wait_ms": 23.861785124785523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034576416015625, "StateBufferConnector_ms": 0.03011798858642578, "ViewRequirementAgentConnector_ms": 0.9545767307281494}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2121132, "num_agent_steps_trained": 2121132, "num_env_steps_sampled": 2121132, "num_env_steps_trained": 2121132, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 251.33134692347167, "num_env_steps_trained_throughput_per_sec": 251.33134692347167, "timesteps_total": 2121132, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2121132, "timers": {"training_iteration_time_ms": 61354.464, "sample_time_ms": 45672.989, "load_time_ms": 2044.173, "load_throughput": 7650.037, "learn_time_ms": 12984.4, "learn_throughput": 1204.368, "synch_weights_time_ms": 516.892}, "counters": {"num_env_steps_sampled": 2121132, "num_env_steps_trained": 2121132, "num_agent_steps_sampled": 2121132, "num_agent_steps_trained": 2121132}, "done": false, "episodes_total": 2187, "training_iteration": 156, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-04-16", "timestamp": 1749308656, "time_this_iter_s": 62.240697383880615, "time_total_s": 8922.728452205658, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8922.728452205658, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 78.28591549295776, "ram_util_percent": 59.52394366197183, "gpu_util_percent0": 0.08647887323943662, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.878867999999999e-05, "total_loss": -0.07358719059858809, "policy_loss": -0.0245811101320115, "vf_loss": 0.013183538758788596, "vf_explained_var": 0.9822238542816856, "kl": 0.018146053282415815, "entropy": 16.131203632354737, "entropy_coeff": 0.0033183019999999995}, "model": {}, "num_grad_updates_lifetime": 75025.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2136770, "num_env_steps_trained": 2136770, "num_agent_steps_sampled": 2136770, "num_agent_steps_trained": 2136770}, "sampler_results": {"episode_reward_max": 103.24908912179264, "episode_reward_min": 73.07669863270353, "episode_reward_mean": 88.83008211085398, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.2133668478804, 99.69713080778182, 79.89956975793687, 94.04530607519565, 79.88043147901125, 87.31451676780262, 85.74291686840148, 79.90067421749448, 94.73049881864867, 91.47854548805039, 92.90748835292575, 82.57281016039958, 92.08637092216277, 96.08961233497102, 90.71406643173508, 102.25413387660096, 78.57427429490147, 90.02910503471752, 79.80019276108166, 86.49791328394915, 86.91594764461642, 77.00930033132335, 99.75226670522852, 87.04701184060481, 92.28830386289822, 77.28276537405246, 93.60769700054132, 93.75610185826672, 96.74122867477352, 99.23838044018886, 73.3693282684645, 94.05726602050815, 82.6975567363105, 87.93277730277921, 89.03109526677419, 74.59803712071925, 96.4855265122377, 87.0138288313839, 85.84256647116298, 83.77578968518331, 98.98897461235781, 97.37729485938203, 79.7280490479905, 100.25260950673828, 79.3591849275108, 92.24853636182027, 84.16114008959005, 89.40194362690016, 86.55245239727948, 76.81746763513527, 96.87361163087324, 90.25535934056053, 92.27659881895497, 78.29924347392647, 91.23731776379539, 97.51413014114898, 92.16912577399657, 102.78989938297207, 79.81322410024418, 89.99423530898706, 78.97290540034838, 81.73033274217816, 89.53408489745402, 76.10921142581502, 96.66105980377897, 93.11416128330832, 87.56334299446449, 83.01791114073113, 91.58455355080801, 100.91403897762825, 88.93570114671039, 95.80472769056885, 81.8109844417392, 89.03372456696337, 79.72500408907945, 86.96195840276572, 83.40627413689394, 75.02471165872836, 95.86029528427943, 93.37527942328579, 90.3417257738142, 82.24794604409354, 89.88185921125277, 99.84550825066358, 96.3870745456396, 103.24908912179264, 77.24024909836476, 96.58254354141188, 81.28225596894033, 90.82920024004413, 81.35434928847619, 73.07669863270353, 101.01629802936358, 92.32433191402697, 81.30970550197324, 83.56455428686276, 90.90881290070939, 96.91300116970974, 93.79831575114646, 101.73232942705033], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.71726503947156, "mean_inference_ms": 8.358748330799575, "mean_action_processing_ms": 0.569727441724016, "mean_env_wait_ms": 23.876082421884263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041428327560424805, "StateBufferConnector_ms": 0.03394913673400879, "ViewRequirementAgentConnector_ms": 0.9903781414031982}}, "episode_reward_max": 103.24908912179264, "episode_reward_min": 73.07669863270353, "episode_reward_mean": 88.83008211085398, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [91.2133668478804, 99.69713080778182, 79.89956975793687, 94.04530607519565, 79.88043147901125, 87.31451676780262, 85.74291686840148, 79.90067421749448, 94.73049881864867, 91.47854548805039, 92.90748835292575, 82.57281016039958, 92.08637092216277, 96.08961233497102, 90.71406643173508, 102.25413387660096, 78.57427429490147, 90.02910503471752, 79.80019276108166, 86.49791328394915, 86.91594764461642, 77.00930033132335, 99.75226670522852, 87.04701184060481, 92.28830386289822, 77.28276537405246, 93.60769700054132, 93.75610185826672, 96.74122867477352, 99.23838044018886, 73.3693282684645, 94.05726602050815, 82.6975567363105, 87.93277730277921, 89.03109526677419, 74.59803712071925, 96.4855265122377, 87.0138288313839, 85.84256647116298, 83.77578968518331, 98.98897461235781, 97.37729485938203, 79.7280490479905, 100.25260950673828, 79.3591849275108, 92.24853636182027, 84.16114008959005, 89.40194362690016, 86.55245239727948, 76.81746763513527, 96.87361163087324, 90.25535934056053, 92.27659881895497, 78.29924347392647, 91.23731776379539, 97.51413014114898, 92.16912577399657, 102.78989938297207, 79.81322410024418, 89.99423530898706, 78.97290540034838, 81.73033274217816, 89.53408489745402, 76.10921142581502, 96.66105980377897, 93.11416128330832, 87.56334299446449, 83.01791114073113, 91.58455355080801, 100.91403897762825, 88.93570114671039, 95.80472769056885, 81.8109844417392, 89.03372456696337, 79.72500408907945, 86.96195840276572, 83.40627413689394, 75.02471165872836, 95.86029528427943, 93.37527942328579, 90.3417257738142, 82.24794604409354, 89.88185921125277, 99.84550825066358, 96.3870745456396, 103.24908912179264, 77.24024909836476, 96.58254354141188, 81.28225596894033, 90.82920024004413, 81.35434928847619, 73.07669863270353, 101.01629802936358, 92.32433191402697, 81.30970550197324, 83.56455428686276, 90.90881290070939, 96.91300116970974, 93.79831575114646, 101.73232942705033], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.71726503947156, "mean_inference_ms": 8.358748330799575, "mean_action_processing_ms": 0.569727441724016, "mean_env_wait_ms": 23.876082421884263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041428327560424805, "StateBufferConnector_ms": 0.03394913673400879, "ViewRequirementAgentConnector_ms": 0.9903781414031982}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2136770, "num_agent_steps_trained": 2136770, "num_env_steps_sampled": 2136770, "num_env_steps_trained": 2136770, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 258.6189054936658, "num_env_steps_trained_throughput_per_sec": 258.6189054936658, "timesteps_total": 2136770, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2136770, "timers": {"training_iteration_time_ms": 61107.091, "sample_time_ms": 45428.909, "load_time_ms": 2061.211, "load_throughput": 7586.801, "learn_time_ms": 12989.532, "learn_throughput": 1203.893, "synch_weights_time_ms": 488.062}, "counters": {"num_env_steps_sampled": 2136770, "num_env_steps_trained": 2136770, "num_agent_steps_sampled": 2136770, "num_agent_steps_trained": 2136770}, "done": false, "episodes_total": 2201, "training_iteration": 157, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-05-17", "timestamp": 1749308717, "time_this_iter_s": 60.48036074638367, "time_total_s": 8983.208812952042, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 8983.208812952042, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 76.98985507246377, "ram_util_percent": 59.933333333333344, "gpu_util_percent0": 0.0810144927536232, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.863230000000001e-05, "total_loss": -0.06966787640513344, "policy_loss": -0.020693751607217235, "vf_loss": 0.01148344648451629, "vf_explained_var": 0.9824275766719471, "kl": 0.018619029745199772, "entropy": 16.086037684353915, "entropy_coeff": 0.0032948450000000002}, "model": {}, "num_grad_updates_lifetime": 75575.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2152408, "num_env_steps_trained": 2152408, "num_agent_steps_sampled": 2152408, "num_agent_steps_trained": 2152408}, "sampler_results": {"episode_reward_max": 103.24908912179264, "episode_reward_min": 73.07669863270353, "episode_reward_mean": 88.99699945309541, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.71406643173508, 102.25413387660096, 78.57427429490147, 90.02910503471752, 79.80019276108166, 86.49791328394915, 86.91594764461642, 77.00930033132335, 99.75226670522852, 87.04701184060481, 92.28830386289822, 77.28276537405246, 93.60769700054132, 93.75610185826672, 96.74122867477352, 99.23838044018886, 73.3693282684645, 94.05726602050815, 82.6975567363105, 87.93277730277921, 89.03109526677419, 74.59803712071925, 96.4855265122377, 87.0138288313839, 85.84256647116298, 83.77578968518331, 98.98897461235781, 97.37729485938203, 79.7280490479905, 100.25260950673828, 79.3591849275108, 92.24853636182027, 84.16114008959005, 89.40194362690016, 86.55245239727948, 76.81746763513527, 96.87361163087324, 90.25535934056053, 92.27659881895497, 78.29924347392647, 91.23731776379539, 97.51413014114898, 92.16912577399657, 102.78989938297207, 79.81322410024418, 89.99423530898706, 78.97290540034838, 81.73033274217816, 89.53408489745402, 76.10921142581502, 96.66105980377897, 93.11416128330832, 87.56334299446449, 83.01791114073113, 91.58455355080801, 100.91403897762825, 88.93570114671039, 95.80472769056885, 81.8109844417392, 89.03372456696337, 79.72500408907945, 86.96195840276572, 83.40627413689394, 75.02471165872836, 95.86029528427943, 93.37527942328579, 90.3417257738142, 82.24794604409354, 89.88185921125277, 99.84550825066358, 96.3870745456396, 103.24908912179264, 77.24024909836476, 96.58254354141188, 81.28225596894033, 90.82920024004413, 81.35434928847619, 73.07669863270353, 101.01629802936358, 92.32433191402697, 81.30970550197324, 83.56455428686276, 90.90881290070939, 96.91300116970974, 93.79831575114646, 101.73232942705033, 81.37779467430649, 96.01744589324247, 79.86359854111542, 88.53027530489668, 85.60645771606711, 77.48690448493801, 100.31770623514262, 91.39820362870022, 94.443004700711, 85.09187475259532, 94.20723814739151, 98.65052390980536, 89.01517565219136, 102.24476948170019], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7188674233909835, "mean_inference_ms": 8.366201062929209, "mean_action_processing_ms": 0.5702149611688199, "mean_env_wait_ms": 23.890293708475063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04044079780578613, "StateBufferConnector_ms": 0.029891014099121094, "ViewRequirementAgentConnector_ms": 0.9782676696777344}}, "episode_reward_max": 103.24908912179264, "episode_reward_min": 73.07669863270353, "episode_reward_mean": 88.99699945309541, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [90.71406643173508, 102.25413387660096, 78.57427429490147, 90.02910503471752, 79.80019276108166, 86.49791328394915, 86.91594764461642, 77.00930033132335, 99.75226670522852, 87.04701184060481, 92.28830386289822, 77.28276537405246, 93.60769700054132, 93.75610185826672, 96.74122867477352, 99.23838044018886, 73.3693282684645, 94.05726602050815, 82.6975567363105, 87.93277730277921, 89.03109526677419, 74.59803712071925, 96.4855265122377, 87.0138288313839, 85.84256647116298, 83.77578968518331, 98.98897461235781, 97.37729485938203, 79.7280490479905, 100.25260950673828, 79.3591849275108, 92.24853636182027, 84.16114008959005, 89.40194362690016, 86.55245239727948, 76.81746763513527, 96.87361163087324, 90.25535934056053, 92.27659881895497, 78.29924347392647, 91.23731776379539, 97.51413014114898, 92.16912577399657, 102.78989938297207, 79.81322410024418, 89.99423530898706, 78.97290540034838, 81.73033274217816, 89.53408489745402, 76.10921142581502, 96.66105980377897, 93.11416128330832, 87.56334299446449, 83.01791114073113, 91.58455355080801, 100.91403897762825, 88.93570114671039, 95.80472769056885, 81.8109844417392, 89.03372456696337, 79.72500408907945, 86.96195840276572, 83.40627413689394, 75.02471165872836, 95.86029528427943, 93.37527942328579, 90.3417257738142, 82.24794604409354, 89.88185921125277, 99.84550825066358, 96.3870745456396, 103.24908912179264, 77.24024909836476, 96.58254354141188, 81.28225596894033, 90.82920024004413, 81.35434928847619, 73.07669863270353, 101.01629802936358, 92.32433191402697, 81.30970550197324, 83.56455428686276, 90.90881290070939, 96.91300116970974, 93.79831575114646, 101.73232942705033, 81.37779467430649, 96.01744589324247, 79.86359854111542, 88.53027530489668, 85.60645771606711, 77.48690448493801, 100.31770623514262, 91.39820362870022, 94.443004700711, 85.09187475259532, 94.20723814739151, 98.65052390980536, 89.01517565219136, 102.24476948170019], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7188674233909835, "mean_inference_ms": 8.366201062929209, "mean_action_processing_ms": 0.5702149611688199, "mean_env_wait_ms": 23.890293708475063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04044079780578613, "StateBufferConnector_ms": 0.029891014099121094, "ViewRequirementAgentConnector_ms": 0.9782676696777344}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2152408, "num_agent_steps_trained": 2152408, "num_env_steps_sampled": 2152408, "num_env_steps_trained": 2152408, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 261.17232076448596, "num_env_steps_trained_throughput_per_sec": 261.17232076448596, "timesteps_total": 2152408, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2152408, "timers": {"training_iteration_time_ms": 61170.161, "sample_time_ms": 45561.132, "load_time_ms": 2018.9, "load_throughput": 7745.802, "learn_time_ms": 12972.503, "learn_throughput": 1205.473, "synch_weights_time_ms": 484.068}, "counters": {"num_env_steps_sampled": 2152408, "num_env_steps_trained": 2152408, "num_agent_steps_sampled": 2152408, "num_agent_steps_trained": 2152408}, "done": false, "episodes_total": 2215, "training_iteration": 158, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-06-17", "timestamp": 1749308777, "time_this_iter_s": 59.89171004295349, "time_total_s": 9043.100522994995, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9043.100522994995, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 78.37794117647059, "ram_util_percent": 60.21176470588235, "gpu_util_percent0": 0.08294117647058823, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.847592e-05, "total_loss": -0.06680558655633252, "policy_loss": -0.01819790009919829, "vf_loss": 0.011551064489493994, "vf_explained_var": 0.982163290977478, "kl": 0.018415285683004184, "entropy": 16.09362343007868, "entropy_coeff": 0.003271388}, "model": {}, "num_grad_updates_lifetime": 76125.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2168046, "num_env_steps_trained": 2168046, "num_agent_steps_sampled": 2168046, "num_agent_steps_trained": 2168046}, "sampler_results": {"episode_reward_max": 103.24908912179264, "episode_reward_min": 73.07669863270353, "episode_reward_mean": 89.00217688897953, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.74122867477352, 99.23838044018886, 73.3693282684645, 94.05726602050815, 82.6975567363105, 87.93277730277921, 89.03109526677419, 74.59803712071925, 96.4855265122377, 87.0138288313839, 85.84256647116298, 83.77578968518331, 98.98897461235781, 97.37729485938203, 79.7280490479905, 100.25260950673828, 79.3591849275108, 92.24853636182027, 84.16114008959005, 89.40194362690016, 86.55245239727948, 76.81746763513527, 96.87361163087324, 90.25535934056053, 92.27659881895497, 78.29924347392647, 91.23731776379539, 97.51413014114898, 92.16912577399657, 102.78989938297207, 79.81322410024418, 89.99423530898706, 78.97290540034838, 81.73033274217816, 89.53408489745402, 76.10921142581502, 96.66105980377897, 93.11416128330832, 87.56334299446449, 83.01791114073113, 91.58455355080801, 100.91403897762825, 88.93570114671039, 95.80472769056885, 81.8109844417392, 89.03372456696337, 79.72500408907945, 86.96195840276572, 83.40627413689394, 75.02471165872836, 95.86029528427943, 93.37527942328579, 90.3417257738142, 82.24794604409354, 89.88185921125277, 99.84550825066358, 96.3870745456396, 103.24908912179264, 77.24024909836476, 96.58254354141188, 81.28225596894033, 90.82920024004413, 81.35434928847619, 73.07669863270353, 101.01629802936358, 92.32433191402697, 81.30970550197324, 83.56455428686276, 90.90881290070939, 96.91300116970974, 93.79831575114646, 101.73232942705033, 81.37779467430649, 96.01744589324247, 79.86359854111542, 88.53027530489668, 85.60645771606711, 77.48690448493801, 100.31770623514262, 91.39820362870022, 94.443004700711, 85.09187475259532, 94.20723814739151, 98.65052390980536, 89.01517565219136, 102.24476948170019, 79.47239863057696, 92.28618122639942, 78.791908184103, 85.89942123228323, 86.61301741975943, 78.52918330446428, 91.76918362754996, 92.10055831862664, 93.54271099521335, 79.39415246688127, 93.23195219858718, 94.81319240027108, 92.86632973289329, 96.73663415132029], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7202942811189974, "mean_inference_ms": 8.37328401058565, "mean_action_processing_ms": 0.5707074609119015, "mean_env_wait_ms": 23.903628179685185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04445910453796387, "StateBufferConnector_ms": 0.030913829803466797, "ViewRequirementAgentConnector_ms": 0.9623732566833496}}, "episode_reward_max": 103.24908912179264, "episode_reward_min": 73.07669863270353, "episode_reward_mean": 89.00217688897953, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [96.74122867477352, 99.23838044018886, 73.3693282684645, 94.05726602050815, 82.6975567363105, 87.93277730277921, 89.03109526677419, 74.59803712071925, 96.4855265122377, 87.0138288313839, 85.84256647116298, 83.77578968518331, 98.98897461235781, 97.37729485938203, 79.7280490479905, 100.25260950673828, 79.3591849275108, 92.24853636182027, 84.16114008959005, 89.40194362690016, 86.55245239727948, 76.81746763513527, 96.87361163087324, 90.25535934056053, 92.27659881895497, 78.29924347392647, 91.23731776379539, 97.51413014114898, 92.16912577399657, 102.78989938297207, 79.81322410024418, 89.99423530898706, 78.97290540034838, 81.73033274217816, 89.53408489745402, 76.10921142581502, 96.66105980377897, 93.11416128330832, 87.56334299446449, 83.01791114073113, 91.58455355080801, 100.91403897762825, 88.93570114671039, 95.80472769056885, 81.8109844417392, 89.03372456696337, 79.72500408907945, 86.96195840276572, 83.40627413689394, 75.02471165872836, 95.86029528427943, 93.37527942328579, 90.3417257738142, 82.24794604409354, 89.88185921125277, 99.84550825066358, 96.3870745456396, 103.24908912179264, 77.24024909836476, 96.58254354141188, 81.28225596894033, 90.82920024004413, 81.35434928847619, 73.07669863270353, 101.01629802936358, 92.32433191402697, 81.30970550197324, 83.56455428686276, 90.90881290070939, 96.91300116970974, 93.79831575114646, 101.73232942705033, 81.37779467430649, 96.01744589324247, 79.86359854111542, 88.53027530489668, 85.60645771606711, 77.48690448493801, 100.31770623514262, 91.39820362870022, 94.443004700711, 85.09187475259532, 94.20723814739151, 98.65052390980536, 89.01517565219136, 102.24476948170019, 79.47239863057696, 92.28618122639942, 78.791908184103, 85.89942123228323, 86.61301741975943, 78.52918330446428, 91.76918362754996, 92.10055831862664, 93.54271099521335, 79.39415246688127, 93.23195219858718, 94.81319240027108, 92.86632973289329, 96.73663415132029], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7202942811189974, "mean_inference_ms": 8.37328401058565, "mean_action_processing_ms": 0.5707074609119015, "mean_env_wait_ms": 23.903628179685185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04445910453796387, "StateBufferConnector_ms": 0.030913829803466797, "ViewRequirementAgentConnector_ms": 0.9623732566833496}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2168046, "num_agent_steps_trained": 2168046, "num_env_steps_sampled": 2168046, "num_env_steps_trained": 2168046, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 264.4095666911407, "num_env_steps_trained_throughput_per_sec": 264.4095666911407, "timesteps_total": 2168046, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2168046, "timers": {"training_iteration_time_ms": 60555.599, "sample_time_ms": 45076.848, "load_time_ms": 1970.025, "load_throughput": 7937.971, "learn_time_ms": 12891.469, "learn_throughput": 1213.05, "synch_weights_time_ms": 484.847}, "counters": {"num_env_steps_sampled": 2168046, "num_env_steps_trained": 2168046, "num_agent_steps_sampled": 2168046, "num_agent_steps_trained": 2168046}, "done": false, "episodes_total": 2229, "training_iteration": 159, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-07-16", "timestamp": 1749308836, "time_this_iter_s": 59.159114360809326, "time_total_s": 9102.259637355804, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9102.259637355804, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 78.14264705882353, "ram_util_percent": 60.22941176470587, "gpu_util_percent0": 0.08705882352941177, "vram_util_percent0": 0.8409830729166666}}
{"evaluation": {"sampler_results": {"episode_reward_max": 4.173012619214372, "episode_reward_min": 3.3277229740278993, "episode_reward_mean": 3.9286273766060718, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.3277229740278993, 4.0861105797006845, 4.173012619214372, 3.941568843356241, 4.114721866731162], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.722407611473513, "mean_inference_ms": 3.967636815961163, "mean_action_processing_ms": 0.29611600481065325, "mean_env_wait_ms": 12.562105443666958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0402069091796875, "ViewRequirementAgentConnector_ms": 0.5952119827270508}}, "episode_reward_max": 4.173012619214372, "episode_reward_min": 3.3277229740278993, "episode_reward_mean": 3.9286273766060718, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.3277229740278993, 4.0861105797006845, 4.173012619214372, 3.941568843356241, 4.114721866731162], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.722407611473513, "mean_inference_ms": 3.967636815961163, "mean_action_processing_ms": 0.29611600481065325, "mean_env_wait_ms": 12.562105443666958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0402069091796875, "ViewRequirementAgentConnector_ms": 0.5952119827270508}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.831954e-05, "total_loss": -0.050461105995531066, "policy_loss": -0.0018783338461071254, "vf_loss": 0.011140188950706611, "vf_explained_var": 0.9823191100900823, "kl": 0.018608532658206042, "entropy": 16.1660919120095, "entropy_coeff": 0.0032479309999999995}, "model": {}, "num_grad_updates_lifetime": 76675.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2183684, "num_env_steps_trained": 2183684, "num_agent_steps_sampled": 2183684, "num_agent_steps_trained": 2183684}, "sampler_results": {"episode_reward_max": 103.24908912179264, "episode_reward_min": 73.07669863270353, "episode_reward_mean": 88.88552669780485, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.7280490479905, 100.25260950673828, 79.3591849275108, 92.24853636182027, 84.16114008959005, 89.40194362690016, 86.55245239727948, 76.81746763513527, 96.87361163087324, 90.25535934056053, 92.27659881895497, 78.29924347392647, 91.23731776379539, 97.51413014114898, 92.16912577399657, 102.78989938297207, 79.81322410024418, 89.99423530898706, 78.97290540034838, 81.73033274217816, 89.53408489745402, 76.10921142581502, 96.66105980377897, 93.11416128330832, 87.56334299446449, 83.01791114073113, 91.58455355080801, 100.91403897762825, 88.93570114671039, 95.80472769056885, 81.8109844417392, 89.03372456696337, 79.72500408907945, 86.96195840276572, 83.40627413689394, 75.02471165872836, 95.86029528427943, 93.37527942328579, 90.3417257738142, 82.24794604409354, 89.88185921125277, 99.84550825066358, 96.3870745456396, 103.24908912179264, 77.24024909836476, 96.58254354141188, 81.28225596894033, 90.82920024004413, 81.35434928847619, 73.07669863270353, 101.01629802936358, 92.32433191402697, 81.30970550197324, 83.56455428686276, 90.90881290070939, 96.91300116970974, 93.79831575114646, 101.73232942705033, 81.37779467430649, 96.01744589324247, 79.86359854111542, 88.53027530489668, 85.60645771606711, 77.48690448493801, 100.31770623514262, 91.39820362870022, 94.443004700711, 85.09187475259532, 94.20723814739151, 98.65052390980536, 89.01517565219136, 102.24476948170019, 79.47239863057696, 92.28618122639942, 78.791908184103, 85.89942123228323, 86.61301741975943, 78.52918330446428, 91.76918362754996, 92.10055831862664, 93.54271099521335, 79.39415246688127, 93.23195219858718, 94.81319240027108, 92.86632973289329, 96.73663415132029, 76.82450674965698, 89.68342906989938, 77.27174186336359, 89.13118002503403, 86.45398682402465, 77.34645413060939, 92.80299954181389, 91.18503500327891, 91.40876894663923, 80.47919472383703, 90.35087289043649, 99.12119478781074, 91.39882885111066, 102.02643827724404], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.721424056001347, "mean_inference_ms": 8.379559014179467, "mean_action_processing_ms": 0.571138372774805, "mean_env_wait_ms": 23.916806045669738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04358172416687012, "StateBufferConnector_ms": 0.0289306640625, "ViewRequirementAgentConnector_ms": 0.9570937156677246}}, "episode_reward_max": 103.24908912179264, "episode_reward_min": 73.07669863270353, "episode_reward_mean": 88.88552669780485, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [79.7280490479905, 100.25260950673828, 79.3591849275108, 92.24853636182027, 84.16114008959005, 89.40194362690016, 86.55245239727948, 76.81746763513527, 96.87361163087324, 90.25535934056053, 92.27659881895497, 78.29924347392647, 91.23731776379539, 97.51413014114898, 92.16912577399657, 102.78989938297207, 79.81322410024418, 89.99423530898706, 78.97290540034838, 81.73033274217816, 89.53408489745402, 76.10921142581502, 96.66105980377897, 93.11416128330832, 87.56334299446449, 83.01791114073113, 91.58455355080801, 100.91403897762825, 88.93570114671039, 95.80472769056885, 81.8109844417392, 89.03372456696337, 79.72500408907945, 86.96195840276572, 83.40627413689394, 75.02471165872836, 95.86029528427943, 93.37527942328579, 90.3417257738142, 82.24794604409354, 89.88185921125277, 99.84550825066358, 96.3870745456396, 103.24908912179264, 77.24024909836476, 96.58254354141188, 81.28225596894033, 90.82920024004413, 81.35434928847619, 73.07669863270353, 101.01629802936358, 92.32433191402697, 81.30970550197324, 83.56455428686276, 90.90881290070939, 96.91300116970974, 93.79831575114646, 101.73232942705033, 81.37779467430649, 96.01744589324247, 79.86359854111542, 88.53027530489668, 85.60645771606711, 77.48690448493801, 100.31770623514262, 91.39820362870022, 94.443004700711, 85.09187475259532, 94.20723814739151, 98.65052390980536, 89.01517565219136, 102.24476948170019, 79.47239863057696, 92.28618122639942, 78.791908184103, 85.89942123228323, 86.61301741975943, 78.52918330446428, 91.76918362754996, 92.10055831862664, 93.54271099521335, 79.39415246688127, 93.23195219858718, 94.81319240027108, 92.86632973289329, 96.73663415132029, 76.82450674965698, 89.68342906989938, 77.27174186336359, 89.13118002503403, 86.45398682402465, 77.34645413060939, 92.80299954181389, 91.18503500327891, 91.40876894663923, 80.47919472383703, 90.35087289043649, 99.12119478781074, 91.39882885111066, 102.02643827724404], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.721424056001347, "mean_inference_ms": 8.379559014179467, "mean_action_processing_ms": 0.571138372774805, "mean_env_wait_ms": 23.916806045669738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04358172416687012, "StateBufferConnector_ms": 0.0289306640625, "ViewRequirementAgentConnector_ms": 0.9570937156677246}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2183684, "num_agent_steps_trained": 2183684, "num_env_steps_sampled": 2183684, "num_env_steps_trained": 2183684, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 266.6645669978456, "num_env_steps_trained_throughput_per_sec": 266.6645669978456, "timesteps_total": 2183684, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2183684, "timers": {"training_iteration_time_ms": 60170.994, "sample_time_ms": 44768.747, "load_time_ms": 1927.786, "load_throughput": 8111.896, "learn_time_ms": 12863.629, "learn_throughput": 1215.676, "synch_weights_time_ms": 481.275}, "counters": {"num_env_steps_sampled": 2183684, "num_env_steps_trained": 2183684, "num_agent_steps_sampled": 2183684, "num_agent_steps_trained": 2183684}, "done": false, "episodes_total": 2243, "training_iteration": 160, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-08-32", "timestamp": 1749308912, "time_this_iter_s": 75.83258438110352, "time_total_s": 9178.092221736908, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9178.092221736908, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 63.48522727272728, "ram_util_percent": 60.1125, "gpu_util_percent0": 0.07125, "vram_util_percent0": 0.8409830729166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.816316000000003e-05, "total_loss": -0.08124374135143378, "policy_loss": -0.03340312403081704, "vf_loss": 0.012741494339636781, "vf_explained_var": 0.9825723812796853, "kl": 0.0180580329915171, "entropy": 16.19717969894409, "entropy_coeff": 0.0032244740000000006}, "model": {}, "num_grad_updates_lifetime": 77225.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2199322, "num_env_steps_trained": 2199322, "num_agent_steps_sampled": 2199322, "num_agent_steps_trained": 2199322}, "sampler_results": {"episode_reward_max": 103.24908912179264, "episode_reward_min": 71.25914640962809, "episode_reward_mean": 88.84939283688222, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.16912577399657, 102.78989938297207, 79.81322410024418, 89.99423530898706, 78.97290540034838, 81.73033274217816, 89.53408489745402, 76.10921142581502, 96.66105980377897, 93.11416128330832, 87.56334299446449, 83.01791114073113, 91.58455355080801, 100.91403897762825, 88.93570114671039, 95.80472769056885, 81.8109844417392, 89.03372456696337, 79.72500408907945, 86.96195840276572, 83.40627413689394, 75.02471165872836, 95.86029528427943, 93.37527942328579, 90.3417257738142, 82.24794604409354, 89.88185921125277, 99.84550825066358, 96.3870745456396, 103.24908912179264, 77.24024909836476, 96.58254354141188, 81.28225596894033, 90.82920024004413, 81.35434928847619, 73.07669863270353, 101.01629802936358, 92.32433191402697, 81.30970550197324, 83.56455428686276, 90.90881290070939, 96.91300116970974, 93.79831575114646, 101.73232942705033, 81.37779467430649, 96.01744589324247, 79.86359854111542, 88.53027530489668, 85.60645771606711, 77.48690448493801, 100.31770623514262, 91.39820362870022, 94.443004700711, 85.09187475259532, 94.20723814739151, 98.65052390980536, 89.01517565219136, 102.24476948170019, 79.47239863057696, 92.28618122639942, 78.791908184103, 85.89942123228323, 86.61301741975943, 78.52918330446428, 91.76918362754996, 92.10055831862664, 93.54271099521335, 79.39415246688127, 93.23195219858718, 94.81319240027108, 92.86632973289329, 96.73663415132029, 76.82450674965698, 89.68342906989938, 77.27174186336359, 89.13118002503403, 86.45398682402465, 77.34645413060939, 92.80299954181389, 91.18503500327891, 91.40876894663923, 80.47919472383703, 90.35087289043649, 99.12119478781074, 91.39882885111066, 102.02643827724404, 76.24268801351101, 93.82909936792629, 82.12757511747786, 85.5349553412829, 89.90018088441052, 71.25914640962809, 94.80179084292656, 87.49405685554326, 88.56626717293251, 83.31755014702344, 90.29762915521025, 101.75977554220059, 89.10728268876608, 97.12626113112081], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.722010704010849, "mean_inference_ms": 8.38489458618802, "mean_action_processing_ms": 0.5715153939750217, "mean_env_wait_ms": 23.92941151794932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04149627685546875, "StateBufferConnector_ms": 0.04420828819274902, "ViewRequirementAgentConnector_ms": 0.9372701644897461}}, "episode_reward_max": 103.24908912179264, "episode_reward_min": 71.25914640962809, "episode_reward_mean": 88.84939283688222, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [92.16912577399657, 102.78989938297207, 79.81322410024418, 89.99423530898706, 78.97290540034838, 81.73033274217816, 89.53408489745402, 76.10921142581502, 96.66105980377897, 93.11416128330832, 87.56334299446449, 83.01791114073113, 91.58455355080801, 100.91403897762825, 88.93570114671039, 95.80472769056885, 81.8109844417392, 89.03372456696337, 79.72500408907945, 86.96195840276572, 83.40627413689394, 75.02471165872836, 95.86029528427943, 93.37527942328579, 90.3417257738142, 82.24794604409354, 89.88185921125277, 99.84550825066358, 96.3870745456396, 103.24908912179264, 77.24024909836476, 96.58254354141188, 81.28225596894033, 90.82920024004413, 81.35434928847619, 73.07669863270353, 101.01629802936358, 92.32433191402697, 81.30970550197324, 83.56455428686276, 90.90881290070939, 96.91300116970974, 93.79831575114646, 101.73232942705033, 81.37779467430649, 96.01744589324247, 79.86359854111542, 88.53027530489668, 85.60645771606711, 77.48690448493801, 100.31770623514262, 91.39820362870022, 94.443004700711, 85.09187475259532, 94.20723814739151, 98.65052390980536, 89.01517565219136, 102.24476948170019, 79.47239863057696, 92.28618122639942, 78.791908184103, 85.89942123228323, 86.61301741975943, 78.52918330446428, 91.76918362754996, 92.10055831862664, 93.54271099521335, 79.39415246688127, 93.23195219858718, 94.81319240027108, 92.86632973289329, 96.73663415132029, 76.82450674965698, 89.68342906989938, 77.27174186336359, 89.13118002503403, 86.45398682402465, 77.34645413060939, 92.80299954181389, 91.18503500327891, 91.40876894663923, 80.47919472383703, 90.35087289043649, 99.12119478781074, 91.39882885111066, 102.02643827724404, 76.24268801351101, 93.82909936792629, 82.12757511747786, 85.5349553412829, 89.90018088441052, 71.25914640962809, 94.80179084292656, 87.49405685554326, 88.56626717293251, 83.31755014702344, 90.29762915521025, 101.75977554220059, 89.10728268876608, 97.12626113112081], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.722010704010849, "mean_inference_ms": 8.38489458618802, "mean_action_processing_ms": 0.5715153939750217, "mean_env_wait_ms": 23.92941151794932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04149627685546875, "StateBufferConnector_ms": 0.04420828819274902, "ViewRequirementAgentConnector_ms": 0.9372701644897461}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2199322, "num_agent_steps_trained": 2199322, "num_env_steps_sampled": 2199322, "num_env_steps_trained": 2199322, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 270.3147886786266, "num_env_steps_trained_throughput_per_sec": 270.3147886786266, "timesteps_total": 2199322, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2199322, "timers": {"training_iteration_time_ms": 59950.09, "sample_time_ms": 44520.022, "load_time_ms": 1953.691, "load_throughput": 8004.337, "learn_time_ms": 12870.27, "learn_throughput": 1215.048, "synch_weights_time_ms": 476.278}, "counters": {"num_env_steps_sampled": 2199322, "num_env_steps_trained": 2199322, "num_agent_steps_sampled": 2199322, "num_agent_steps_trained": 2199322}, "done": false, "episodes_total": 2257, "training_iteration": 161, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-09-30", "timestamp": 1749308970, "time_this_iter_s": 57.86706352233887, "time_total_s": 9235.959285259247, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9235.959285259247, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 76.52272727272727, "ram_util_percent": 60.77878787878788, "gpu_util_percent0": 0.08303030303030301, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.800678e-05, "total_loss": -0.05451224931134758, "policy_loss": -0.006855902302883227, "vf_loss": 0.012260212352160703, "vf_explained_var": 0.9811245482618158, "kl": 0.0189051448985331, "entropy": 16.221469466469504, "entropy_coeff": 0.0032010169999999996}, "model": {}, "num_grad_updates_lifetime": 77775.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2214960, "num_env_steps_trained": 2214960, "num_agent_steps_sampled": 2214960, "num_agent_steps_trained": 2214960}, "sampler_results": {"episode_reward_max": 103.24908912179264, "episode_reward_min": 71.25914640962809, "episode_reward_mean": 88.66670877441732, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.93570114671039, 95.80472769056885, 81.8109844417392, 89.03372456696337, 79.72500408907945, 86.96195840276572, 83.40627413689394, 75.02471165872836, 95.86029528427943, 93.37527942328579, 90.3417257738142, 82.24794604409354, 89.88185921125277, 99.84550825066358, 96.3870745456396, 103.24908912179264, 77.24024909836476, 96.58254354141188, 81.28225596894033, 90.82920024004413, 81.35434928847619, 73.07669863270353, 101.01629802936358, 92.32433191402697, 81.30970550197324, 83.56455428686276, 90.90881290070939, 96.91300116970974, 93.79831575114646, 101.73232942705033, 81.37779467430649, 96.01744589324247, 79.86359854111542, 88.53027530489668, 85.60645771606711, 77.48690448493801, 100.31770623514262, 91.39820362870022, 94.443004700711, 85.09187475259532, 94.20723814739151, 98.65052390980536, 89.01517565219136, 102.24476948170019, 79.47239863057696, 92.28618122639942, 78.791908184103, 85.89942123228323, 86.61301741975943, 78.52918330446428, 91.76918362754996, 92.10055831862664, 93.54271099521335, 79.39415246688127, 93.23195219858718, 94.81319240027108, 92.86632973289329, 96.73663415132029, 76.82450674965698, 89.68342906989938, 77.27174186336359, 89.13118002503403, 86.45398682402465, 77.34645413060939, 92.80299954181389, 91.18503500327891, 91.40876894663923, 80.47919472383703, 90.35087289043649, 99.12119478781074, 91.39882885111066, 102.02643827724404, 76.24268801351101, 93.82909936792629, 82.12757511747786, 85.5349553412829, 89.90018088441052, 71.25914640962809, 94.80179084292656, 87.49405685554326, 88.56626717293251, 83.31755014702344, 90.29762915521025, 101.75977554220059, 89.10728268876608, 97.12626113112081, 76.02162963036163, 93.1663989956204, 81.27526219549456, 85.99339376982144, 85.25051851535092, 77.78179315027286, 89.44380008765025, 93.25191550333925, 84.8178181782494, 82.55036140846785, 90.73416338214437, 96.99862338266111, 89.8694088657194, 98.54459347107107], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7221546619632813, "mean_inference_ms": 8.389103269747888, "mean_action_processing_ms": 0.5718400786999365, "mean_env_wait_ms": 23.94062528420381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03869271278381348, "StateBufferConnector_ms": 0.04519987106323242, "ViewRequirementAgentConnector_ms": 0.9407846927642822}}, "episode_reward_max": 103.24908912179264, "episode_reward_min": 71.25914640962809, "episode_reward_mean": 88.66670877441732, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [88.93570114671039, 95.80472769056885, 81.8109844417392, 89.03372456696337, 79.72500408907945, 86.96195840276572, 83.40627413689394, 75.02471165872836, 95.86029528427943, 93.37527942328579, 90.3417257738142, 82.24794604409354, 89.88185921125277, 99.84550825066358, 96.3870745456396, 103.24908912179264, 77.24024909836476, 96.58254354141188, 81.28225596894033, 90.82920024004413, 81.35434928847619, 73.07669863270353, 101.01629802936358, 92.32433191402697, 81.30970550197324, 83.56455428686276, 90.90881290070939, 96.91300116970974, 93.79831575114646, 101.73232942705033, 81.37779467430649, 96.01744589324247, 79.86359854111542, 88.53027530489668, 85.60645771606711, 77.48690448493801, 100.31770623514262, 91.39820362870022, 94.443004700711, 85.09187475259532, 94.20723814739151, 98.65052390980536, 89.01517565219136, 102.24476948170019, 79.47239863057696, 92.28618122639942, 78.791908184103, 85.89942123228323, 86.61301741975943, 78.52918330446428, 91.76918362754996, 92.10055831862664, 93.54271099521335, 79.39415246688127, 93.23195219858718, 94.81319240027108, 92.86632973289329, 96.73663415132029, 76.82450674965698, 89.68342906989938, 77.27174186336359, 89.13118002503403, 86.45398682402465, 77.34645413060939, 92.80299954181389, 91.18503500327891, 91.40876894663923, 80.47919472383703, 90.35087289043649, 99.12119478781074, 91.39882885111066, 102.02643827724404, 76.24268801351101, 93.82909936792629, 82.12757511747786, 85.5349553412829, 89.90018088441052, 71.25914640962809, 94.80179084292656, 87.49405685554326, 88.56626717293251, 83.31755014702344, 90.29762915521025, 101.75977554220059, 89.10728268876608, 97.12626113112081, 76.02162963036163, 93.1663989956204, 81.27526219549456, 85.99339376982144, 85.25051851535092, 77.78179315027286, 89.44380008765025, 93.25191550333925, 84.8178181782494, 82.55036140846785, 90.73416338214437, 96.99862338266111, 89.8694088657194, 98.54459347107107], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7221546619632813, "mean_inference_ms": 8.389103269747888, "mean_action_processing_ms": 0.5718400786999365, "mean_env_wait_ms": 23.94062528420381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03869271278381348, "StateBufferConnector_ms": 0.04519987106323242, "ViewRequirementAgentConnector_ms": 0.9407846927642822}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2214960, "num_agent_steps_trained": 2214960, "num_env_steps_sampled": 2214960, "num_env_steps_trained": 2214960, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 269.34239533120814, "num_env_steps_trained_throughput_per_sec": 269.34239533120814, "timesteps_total": 2214960, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2214960, "timers": {"training_iteration_time_ms": 59839.771, "sample_time_ms": 44416.855, "load_time_ms": 1931.271, "load_throughput": 8097.257, "learn_time_ms": 12887.878, "learn_throughput": 1213.388, "synch_weights_time_ms": 475.609}, "counters": {"num_env_steps_sampled": 2214960, "num_env_steps_trained": 2214960, "num_agent_steps_sampled": 2214960, "num_agent_steps_trained": 2214960}, "done": false, "episodes_total": 2271, "training_iteration": 162, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-10-28", "timestamp": 1749309028, "time_this_iter_s": 58.07565665245056, "time_total_s": 9294.034941911697, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9294.034941911697, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 76.75373134328358, "ram_util_percent": 61.07014925373134, "gpu_util_percent0": 0.08462686567164178, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.785040000000001e-05, "total_loss": -0.06597200225139122, "policy_loss": -0.018590833747928793, "vf_loss": 0.011797019139313223, "vf_explained_var": 0.9835624860633503, "kl": 0.018343555122005802, "entropy": 16.20536251935092, "entropy_coeff": 0.00317756}, "model": {}, "num_grad_updates_lifetime": 78325.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2230598, "num_env_steps_trained": 2230598, "num_agent_steps_sampled": 2230598, "num_agent_steps_trained": 2230598}, "sampler_results": {"episode_reward_max": 103.24908912179264, "episode_reward_min": 71.25914640962809, "episode_reward_mean": 88.54169405044414, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.3870745456396, 103.24908912179264, 77.24024909836476, 96.58254354141188, 81.28225596894033, 90.82920024004413, 81.35434928847619, 73.07669863270353, 101.01629802936358, 92.32433191402697, 81.30970550197324, 83.56455428686276, 90.90881290070939, 96.91300116970974, 93.79831575114646, 101.73232942705033, 81.37779467430649, 96.01744589324247, 79.86359854111542, 88.53027530489668, 85.60645771606711, 77.48690448493801, 100.31770623514262, 91.39820362870022, 94.443004700711, 85.09187475259532, 94.20723814739151, 98.65052390980536, 89.01517565219136, 102.24476948170019, 79.47239863057696, 92.28618122639942, 78.791908184103, 85.89942123228323, 86.61301741975943, 78.52918330446428, 91.76918362754996, 92.10055831862664, 93.54271099521335, 79.39415246688127, 93.23195219858718, 94.81319240027108, 92.86632973289329, 96.73663415132029, 76.82450674965698, 89.68342906989938, 77.27174186336359, 89.13118002503403, 86.45398682402465, 77.34645413060939, 92.80299954181389, 91.18503500327891, 91.40876894663923, 80.47919472383703, 90.35087289043649, 99.12119478781074, 91.39882885111066, 102.02643827724404, 76.24268801351101, 93.82909936792629, 82.12757511747786, 85.5349553412829, 89.90018088441052, 71.25914640962809, 94.80179084292656, 87.49405685554326, 88.56626717293251, 83.31755014702344, 90.29762915521025, 101.75977554220059, 89.10728268876608, 97.12626113112081, 76.02162963036163, 93.1663989956204, 81.27526219549456, 85.99339376982144, 85.25051851535092, 77.78179315027286, 89.44380008765025, 93.25191550333925, 84.8178181782494, 82.55036140846785, 90.73416338214437, 96.99862338266111, 89.8694088657194, 98.54459347107107, 78.10166091554865, 92.93818096863524, 80.62412280115312, 83.16160482714604, 85.89943137948944, 74.56033868560961, 88.84128009745609, 94.52112601139198, 84.9419400280994, 81.4252797801385, 89.0253209765181, 98.92649405957775, 91.34884735987107, 95.43859983288554], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7218776172074466, "mean_inference_ms": 8.392150986193935, "mean_action_processing_ms": 0.5720882206684437, "mean_env_wait_ms": 23.950184421897625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038778066635131836, "StateBufferConnector_ms": 0.04427027702331543, "ViewRequirementAgentConnector_ms": 0.9552145004272461}}, "episode_reward_max": 103.24908912179264, "episode_reward_min": 71.25914640962809, "episode_reward_mean": 88.54169405044414, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [96.3870745456396, 103.24908912179264, 77.24024909836476, 96.58254354141188, 81.28225596894033, 90.82920024004413, 81.35434928847619, 73.07669863270353, 101.01629802936358, 92.32433191402697, 81.30970550197324, 83.56455428686276, 90.90881290070939, 96.91300116970974, 93.79831575114646, 101.73232942705033, 81.37779467430649, 96.01744589324247, 79.86359854111542, 88.53027530489668, 85.60645771606711, 77.48690448493801, 100.31770623514262, 91.39820362870022, 94.443004700711, 85.09187475259532, 94.20723814739151, 98.65052390980536, 89.01517565219136, 102.24476948170019, 79.47239863057696, 92.28618122639942, 78.791908184103, 85.89942123228323, 86.61301741975943, 78.52918330446428, 91.76918362754996, 92.10055831862664, 93.54271099521335, 79.39415246688127, 93.23195219858718, 94.81319240027108, 92.86632973289329, 96.73663415132029, 76.82450674965698, 89.68342906989938, 77.27174186336359, 89.13118002503403, 86.45398682402465, 77.34645413060939, 92.80299954181389, 91.18503500327891, 91.40876894663923, 80.47919472383703, 90.35087289043649, 99.12119478781074, 91.39882885111066, 102.02643827724404, 76.24268801351101, 93.82909936792629, 82.12757511747786, 85.5349553412829, 89.90018088441052, 71.25914640962809, 94.80179084292656, 87.49405685554326, 88.56626717293251, 83.31755014702344, 90.29762915521025, 101.75977554220059, 89.10728268876608, 97.12626113112081, 76.02162963036163, 93.1663989956204, 81.27526219549456, 85.99339376982144, 85.25051851535092, 77.78179315027286, 89.44380008765025, 93.25191550333925, 84.8178181782494, 82.55036140846785, 90.73416338214437, 96.99862338266111, 89.8694088657194, 98.54459347107107, 78.10166091554865, 92.93818096863524, 80.62412280115312, 83.16160482714604, 85.89943137948944, 74.56033868560961, 88.84128009745609, 94.52112601139198, 84.9419400280994, 81.4252797801385, 89.0253209765181, 98.92649405957775, 91.34884735987107, 95.43859983288554], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7218776172074466, "mean_inference_ms": 8.392150986193935, "mean_action_processing_ms": 0.5720882206684437, "mean_env_wait_ms": 23.950184421897625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038778066635131836, "StateBufferConnector_ms": 0.04427027702331543, "ViewRequirementAgentConnector_ms": 0.9552145004272461}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2230598, "num_agent_steps_trained": 2230598, "num_env_steps_sampled": 2230598, "num_env_steps_trained": 2230598, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 269.6879848190113, "num_env_steps_trained_throughput_per_sec": 269.6879848190113, "timesteps_total": 2230598, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2230598, "timers": {"training_iteration_time_ms": 59597.274, "sample_time_ms": 44249.424, "load_time_ms": 1908.013, "load_throughput": 8195.961, "learn_time_ms": 12839.893, "learn_throughput": 1217.923, "synch_weights_time_ms": 473.238}, "counters": {"num_env_steps_sampled": 2230598, "num_env_steps_trained": 2230598, "num_agent_steps_sampled": 2230598, "num_agent_steps_trained": 2230598}, "done": false, "episodes_total": 2285, "training_iteration": 163, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-11-26", "timestamp": 1749309086, "time_this_iter_s": 58.00152087211609, "time_total_s": 9352.036462783813, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9352.036462783813, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 76.79393939393938, "ram_util_percent": 60.922727272727265, "gpu_util_percent0": 0.08499999999999999, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.769402e-05, "total_loss": -0.061262997491708535, "policy_loss": -0.014256372355610603, "vf_loss": 0.011503167085730556, "vf_explained_var": 0.9826458006555384, "kl": 0.017264735235371247, "entropy": 16.168494971882215, "entropy_coeff": 0.0031541029999999992}, "model": {}, "num_grad_updates_lifetime": 78875.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2246236, "num_env_steps_trained": 2246236, "num_agent_steps_sampled": 2246236, "num_agent_steps_trained": 2246236}, "sampler_results": {"episode_reward_max": 102.24476948170019, "episode_reward_min": 71.25914640962809, "episode_reward_mean": 88.31488643280443, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.79831575114646, 101.73232942705033, 81.37779467430649, 96.01744589324247, 79.86359854111542, 88.53027530489668, 85.60645771606711, 77.48690448493801, 100.31770623514262, 91.39820362870022, 94.443004700711, 85.09187475259532, 94.20723814739151, 98.65052390980536, 89.01517565219136, 102.24476948170019, 79.47239863057696, 92.28618122639942, 78.791908184103, 85.89942123228323, 86.61301741975943, 78.52918330446428, 91.76918362754996, 92.10055831862664, 93.54271099521335, 79.39415246688127, 93.23195219858718, 94.81319240027108, 92.86632973289329, 96.73663415132029, 76.82450674965698, 89.68342906989938, 77.27174186336359, 89.13118002503403, 86.45398682402465, 77.34645413060939, 92.80299954181389, 91.18503500327891, 91.40876894663923, 80.47919472383703, 90.35087289043649, 99.12119478781074, 91.39882885111066, 102.02643827724404, 76.24268801351101, 93.82909936792629, 82.12757511747786, 85.5349553412829, 89.90018088441052, 71.25914640962809, 94.80179084292656, 87.49405685554326, 88.56626717293251, 83.31755014702344, 90.29762915521025, 101.75977554220059, 89.10728268876608, 97.12626113112081, 76.02162963036163, 93.1663989956204, 81.27526219549456, 85.99339376982144, 85.25051851535092, 77.78179315027286, 89.44380008765025, 93.25191550333925, 84.8178181782494, 82.55036140846785, 90.73416338214437, 96.99862338266111, 89.8694088657194, 98.54459347107107, 78.10166091554865, 92.93818096863524, 80.62412280115312, 83.16160482714604, 85.89943137948944, 74.56033868560961, 88.84128009745609, 94.52112601139198, 84.9419400280994, 81.4252797801385, 89.0253209765181, 98.92649405957775, 91.34884735987107, 95.43859983288554, 81.88949881390293, 89.85748717293127, 76.40405339375006, 85.39985540109497, 84.83210957841894, 78.22325152102741, 93.88684785033257, 88.62597931222132, 85.45646916617065, 76.60542801753965, 91.71650902678911, 97.48401863379432, 93.31252015097701, 99.66337443709673], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7212646503574387, "mean_inference_ms": 8.394192629515672, "mean_action_processing_ms": 0.5722940373845965, "mean_env_wait_ms": 23.95903629762349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03290700912475586, "StateBufferConnector_ms": 0.04138684272766113, "ViewRequirementAgentConnector_ms": 0.9302272796630859}}, "episode_reward_max": 102.24476948170019, "episode_reward_min": 71.25914640962809, "episode_reward_mean": 88.31488643280443, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [93.79831575114646, 101.73232942705033, 81.37779467430649, 96.01744589324247, 79.86359854111542, 88.53027530489668, 85.60645771606711, 77.48690448493801, 100.31770623514262, 91.39820362870022, 94.443004700711, 85.09187475259532, 94.20723814739151, 98.65052390980536, 89.01517565219136, 102.24476948170019, 79.47239863057696, 92.28618122639942, 78.791908184103, 85.89942123228323, 86.61301741975943, 78.52918330446428, 91.76918362754996, 92.10055831862664, 93.54271099521335, 79.39415246688127, 93.23195219858718, 94.81319240027108, 92.86632973289329, 96.73663415132029, 76.82450674965698, 89.68342906989938, 77.27174186336359, 89.13118002503403, 86.45398682402465, 77.34645413060939, 92.80299954181389, 91.18503500327891, 91.40876894663923, 80.47919472383703, 90.35087289043649, 99.12119478781074, 91.39882885111066, 102.02643827724404, 76.24268801351101, 93.82909936792629, 82.12757511747786, 85.5349553412829, 89.90018088441052, 71.25914640962809, 94.80179084292656, 87.49405685554326, 88.56626717293251, 83.31755014702344, 90.29762915521025, 101.75977554220059, 89.10728268876608, 97.12626113112081, 76.02162963036163, 93.1663989956204, 81.27526219549456, 85.99339376982144, 85.25051851535092, 77.78179315027286, 89.44380008765025, 93.25191550333925, 84.8178181782494, 82.55036140846785, 90.73416338214437, 96.99862338266111, 89.8694088657194, 98.54459347107107, 78.10166091554865, 92.93818096863524, 80.62412280115312, 83.16160482714604, 85.89943137948944, 74.56033868560961, 88.84128009745609, 94.52112601139198, 84.9419400280994, 81.4252797801385, 89.0253209765181, 98.92649405957775, 91.34884735987107, 95.43859983288554, 81.88949881390293, 89.85748717293127, 76.40405339375006, 85.39985540109497, 84.83210957841894, 78.22325152102741, 93.88684785033257, 88.62597931222132, 85.45646916617065, 76.60542801753965, 91.71650902678911, 97.48401863379432, 93.31252015097701, 99.66337443709673], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7212646503574387, "mean_inference_ms": 8.394192629515672, "mean_action_processing_ms": 0.5722940373845965, "mean_env_wait_ms": 23.95903629762349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03290700912475586, "StateBufferConnector_ms": 0.04138684272766113, "ViewRequirementAgentConnector_ms": 0.9302272796630859}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2246236, "num_agent_steps_trained": 2246236, "num_env_steps_sampled": 2246236, "num_env_steps_trained": 2246236, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 270.4348669195496, "num_env_steps_trained_throughput_per_sec": 270.4348669195496, "timesteps_total": 2246236, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2246236, "timers": {"training_iteration_time_ms": 59382.553, "sample_time_ms": 44133.539, "load_time_ms": 1904.78, "load_throughput": 8209.874, "learn_time_ms": 12742.368, "learn_throughput": 1227.244, "synch_weights_time_ms": 475.481}, "counters": {"num_env_steps_sampled": 2246236, "num_env_steps_trained": 2246236, "num_agent_steps_sampled": 2246236, "num_agent_steps_trained": 2246236}, "done": false, "episodes_total": 2299, "training_iteration": 164, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-12-24", "timestamp": 1749309144, "time_this_iter_s": 57.84124040603638, "time_total_s": 9409.87770318985, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9409.87770318985, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 77.50303030303029, "ram_util_percent": 60.22121212121212, "gpu_util_percent0": 0.08545454545454545, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.753764e-05, "total_loss": -0.055132896852340886, "policy_loss": -0.009149184670002962, "vf_loss": 0.013360257046508856, "vf_explained_var": 0.9810092178258029, "kl": 0.019197749465454602, "entropy": 16.16015419179743, "entropy_coeff": 0.003130646}, "model": {}, "num_grad_updates_lifetime": 79425.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2261874, "num_env_steps_trained": 2261874, "num_agent_steps_sampled": 2261874, "num_agent_steps_trained": 2261874}, "sampler_results": {"episode_reward_max": 102.24476948170019, "episode_reward_min": 71.25914640962809, "episode_reward_mean": 87.7418694098783, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.01517565219136, 102.24476948170019, 79.47239863057696, 92.28618122639942, 78.791908184103, 85.89942123228323, 86.61301741975943, 78.52918330446428, 91.76918362754996, 92.10055831862664, 93.54271099521335, 79.39415246688127, 93.23195219858718, 94.81319240027108, 92.86632973289329, 96.73663415132029, 76.82450674965698, 89.68342906989938, 77.27174186336359, 89.13118002503403, 86.45398682402465, 77.34645413060939, 92.80299954181389, 91.18503500327891, 91.40876894663923, 80.47919472383703, 90.35087289043649, 99.12119478781074, 91.39882885111066, 102.02643827724404, 76.24268801351101, 93.82909936792629, 82.12757511747786, 85.5349553412829, 89.90018088441052, 71.25914640962809, 94.80179084292656, 87.49405685554326, 88.56626717293251, 83.31755014702344, 90.29762915521025, 101.75977554220059, 89.10728268876608, 97.12626113112081, 76.02162963036163, 93.1663989956204, 81.27526219549456, 85.99339376982144, 85.25051851535092, 77.78179315027286, 89.44380008765025, 93.25191550333925, 84.8178181782494, 82.55036140846785, 90.73416338214437, 96.99862338266111, 89.8694088657194, 98.54459347107107, 78.10166091554865, 92.93818096863524, 80.62412280115312, 83.16160482714604, 85.89943137948944, 74.56033868560961, 88.84128009745609, 94.52112601139198, 84.9419400280994, 81.4252797801385, 89.0253209765181, 98.92649405957775, 91.34884735987107, 95.43859983288554, 81.88949881390293, 89.85748717293127, 76.40405339375006, 85.39985540109497, 84.83210957841894, 78.22325152102741, 93.88684785033257, 88.62597931222132, 85.45646916617065, 76.60542801753965, 91.71650902678911, 97.48401863379432, 93.31252015097701, 99.66337443709673, 75.98710442642552, 87.21450818690624, 76.36849062896461, 82.4839975365371, 84.45648935228735, 74.47648226078736, 94.06346463812235, 88.65677299655127, 91.75206755532139, 81.34549280405682, 91.00163188684587, 100.47113836562937, 83.52766770375824, 99.41466253230722], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7205224603555602, "mean_inference_ms": 8.39566388917543, "mean_action_processing_ms": 0.5724919080363633, "mean_env_wait_ms": 23.967971997177155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03288412094116211, "StateBufferConnector_ms": 0.04242277145385742, "ViewRequirementAgentConnector_ms": 0.940302848815918}}, "episode_reward_max": 102.24476948170019, "episode_reward_min": 71.25914640962809, "episode_reward_mean": 87.7418694098783, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89.01517565219136, 102.24476948170019, 79.47239863057696, 92.28618122639942, 78.791908184103, 85.89942123228323, 86.61301741975943, 78.52918330446428, 91.76918362754996, 92.10055831862664, 93.54271099521335, 79.39415246688127, 93.23195219858718, 94.81319240027108, 92.86632973289329, 96.73663415132029, 76.82450674965698, 89.68342906989938, 77.27174186336359, 89.13118002503403, 86.45398682402465, 77.34645413060939, 92.80299954181389, 91.18503500327891, 91.40876894663923, 80.47919472383703, 90.35087289043649, 99.12119478781074, 91.39882885111066, 102.02643827724404, 76.24268801351101, 93.82909936792629, 82.12757511747786, 85.5349553412829, 89.90018088441052, 71.25914640962809, 94.80179084292656, 87.49405685554326, 88.56626717293251, 83.31755014702344, 90.29762915521025, 101.75977554220059, 89.10728268876608, 97.12626113112081, 76.02162963036163, 93.1663989956204, 81.27526219549456, 85.99339376982144, 85.25051851535092, 77.78179315027286, 89.44380008765025, 93.25191550333925, 84.8178181782494, 82.55036140846785, 90.73416338214437, 96.99862338266111, 89.8694088657194, 98.54459347107107, 78.10166091554865, 92.93818096863524, 80.62412280115312, 83.16160482714604, 85.89943137948944, 74.56033868560961, 88.84128009745609, 94.52112601139198, 84.9419400280994, 81.4252797801385, 89.0253209765181, 98.92649405957775, 91.34884735987107, 95.43859983288554, 81.88949881390293, 89.85748717293127, 76.40405339375006, 85.39985540109497, 84.83210957841894, 78.22325152102741, 93.88684785033257, 88.62597931222132, 85.45646916617065, 76.60542801753965, 91.71650902678911, 97.48401863379432, 93.31252015097701, 99.66337443709673, 75.98710442642552, 87.21450818690624, 76.36849062896461, 82.4839975365371, 84.45648935228735, 74.47648226078736, 94.06346463812235, 88.65677299655127, 91.75206755532139, 81.34549280405682, 91.00163188684587, 100.47113836562937, 83.52766770375824, 99.41466253230722], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7205224603555602, "mean_inference_ms": 8.39566388917543, "mean_action_processing_ms": 0.5724919080363633, "mean_env_wait_ms": 23.967971997177155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03288412094116211, "StateBufferConnector_ms": 0.04242277145385742, "ViewRequirementAgentConnector_ms": 0.940302848815918}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2261874, "num_agent_steps_trained": 2261874, "num_env_steps_sampled": 2261874, "num_env_steps_trained": 2261874, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 262.6411642472714, "num_env_steps_trained_throughput_per_sec": 262.6411642472714, "timesteps_total": 2261874, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2261874, "timers": {"training_iteration_time_ms": 59161.346, "sample_time_ms": 43939.49, "load_time_ms": 1922.647, "load_throughput": 8133.578, "learn_time_ms": 12710.456, "learn_throughput": 1230.326, "synch_weights_time_ms": 464.735}, "counters": {"num_env_steps_sampled": 2261874, "num_env_steps_trained": 2261874, "num_agent_steps_sampled": 2261874, "num_agent_steps_trained": 2261874}, "done": false, "episodes_total": 2313, "training_iteration": 165, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-13-24", "timestamp": 1749309204, "time_this_iter_s": 59.563244342803955, "time_total_s": 9469.440947532654, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9469.440947532654, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 77.63529411764705, "ram_util_percent": 60.10588235294119, "gpu_util_percent0": 0.08455882352941177, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.738125999999999e-05, "total_loss": -0.06182263784364543, "policy_loss": -0.01576382730092684, "vf_loss": 0.012172984250567176, "vf_explained_var": 0.9806600722399625, "kl": 0.018115488514572654, "entropy": 16.18080424048684, "entropy_coeff": 0.0031071890000000002}, "model": {}, "num_grad_updates_lifetime": 79975.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2277512, "num_env_steps_trained": 2277512, "num_agent_steps_sampled": 2277512, "num_agent_steps_trained": 2277512}, "sampler_results": {"episode_reward_max": 102.02643827724404, "episode_reward_min": 71.25914640962809, "episode_reward_mean": 87.67417737367174, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.86632973289329, 96.73663415132029, 76.82450674965698, 89.68342906989938, 77.27174186336359, 89.13118002503403, 86.45398682402465, 77.34645413060939, 92.80299954181389, 91.18503500327891, 91.40876894663923, 80.47919472383703, 90.35087289043649, 99.12119478781074, 91.39882885111066, 102.02643827724404, 76.24268801351101, 93.82909936792629, 82.12757511747786, 85.5349553412829, 89.90018088441052, 71.25914640962809, 94.80179084292656, 87.49405685554326, 88.56626717293251, 83.31755014702344, 90.29762915521025, 101.75977554220059, 89.10728268876608, 97.12626113112081, 76.02162963036163, 93.1663989956204, 81.27526219549456, 85.99339376982144, 85.25051851535092, 77.78179315027286, 89.44380008765025, 93.25191550333925, 84.8178181782494, 82.55036140846785, 90.73416338214437, 96.99862338266111, 89.8694088657194, 98.54459347107107, 78.10166091554865, 92.93818096863524, 80.62412280115312, 83.16160482714604, 85.89943137948944, 74.56033868560961, 88.84128009745609, 94.52112601139198, 84.9419400280994, 81.4252797801385, 89.0253209765181, 98.92649405957775, 91.34884735987107, 95.43859983288554, 81.88949881390293, 89.85748717293127, 76.40405339375006, 85.39985540109497, 84.83210957841894, 78.22325152102741, 93.88684785033257, 88.62597931222132, 85.45646916617065, 76.60542801753965, 91.71650902678911, 97.48401863379432, 93.31252015097701, 99.66337443709673, 75.98710442642552, 87.21450818690624, 76.36849062896461, 82.4839975365371, 84.45648935228735, 74.47648226078736, 94.06346463812235, 88.65677299655127, 91.75206755532139, 81.34549280405682, 91.00163188684587, 100.47113836562937, 83.52766770375824, 99.41466253230722, 75.36233043795323, 93.17612234363114, 79.88633239652862, 81.30944318949155, 86.8205449616992, 77.48870489434319, 93.36397801710363, 93.53966350696071, 88.6250966782681, 78.66238878788943, 92.5797864593788, 98.33747206575076, 94.36188316460594, 97.42085461434493], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.719661535158155, "mean_inference_ms": 8.396928036697181, "mean_action_processing_ms": 0.5726955579776529, "mean_env_wait_ms": 23.97765055126118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030918359756469727, "StateBufferConnector_ms": 0.04539942741394043, "ViewRequirementAgentConnector_ms": 0.9338791370391846}}, "episode_reward_max": 102.02643827724404, "episode_reward_min": 71.25914640962809, "episode_reward_mean": 87.67417737367174, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [92.86632973289329, 96.73663415132029, 76.82450674965698, 89.68342906989938, 77.27174186336359, 89.13118002503403, 86.45398682402465, 77.34645413060939, 92.80299954181389, 91.18503500327891, 91.40876894663923, 80.47919472383703, 90.35087289043649, 99.12119478781074, 91.39882885111066, 102.02643827724404, 76.24268801351101, 93.82909936792629, 82.12757511747786, 85.5349553412829, 89.90018088441052, 71.25914640962809, 94.80179084292656, 87.49405685554326, 88.56626717293251, 83.31755014702344, 90.29762915521025, 101.75977554220059, 89.10728268876608, 97.12626113112081, 76.02162963036163, 93.1663989956204, 81.27526219549456, 85.99339376982144, 85.25051851535092, 77.78179315027286, 89.44380008765025, 93.25191550333925, 84.8178181782494, 82.55036140846785, 90.73416338214437, 96.99862338266111, 89.8694088657194, 98.54459347107107, 78.10166091554865, 92.93818096863524, 80.62412280115312, 83.16160482714604, 85.89943137948944, 74.56033868560961, 88.84128009745609, 94.52112601139198, 84.9419400280994, 81.4252797801385, 89.0253209765181, 98.92649405957775, 91.34884735987107, 95.43859983288554, 81.88949881390293, 89.85748717293127, 76.40405339375006, 85.39985540109497, 84.83210957841894, 78.22325152102741, 93.88684785033257, 88.62597931222132, 85.45646916617065, 76.60542801753965, 91.71650902678911, 97.48401863379432, 93.31252015097701, 99.66337443709673, 75.98710442642552, 87.21450818690624, 76.36849062896461, 82.4839975365371, 84.45648935228735, 74.47648226078736, 94.06346463812235, 88.65677299655127, 91.75206755532139, 81.34549280405682, 91.00163188684587, 100.47113836562937, 83.52766770375824, 99.41466253230722, 75.36233043795323, 93.17612234363114, 79.88633239652862, 81.30944318949155, 86.8205449616992, 77.48870489434319, 93.36397801710363, 93.53966350696071, 88.6250966782681, 78.66238878788943, 92.5797864593788, 98.33747206575076, 94.36188316460594, 97.42085461434493], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.719661535158155, "mean_inference_ms": 8.396928036697181, "mean_action_processing_ms": 0.5726955579776529, "mean_env_wait_ms": 23.97765055126118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030918359756469727, "StateBufferConnector_ms": 0.04539942741394043, "ViewRequirementAgentConnector_ms": 0.9338791370391846}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2277512, "num_agent_steps_trained": 2277512, "num_env_steps_sampled": 2277512, "num_env_steps_trained": 2277512, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 260.972241851792, "num_env_steps_trained_throughput_per_sec": 260.972241851792, "timesteps_total": 2277512, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2277512, "timers": {"training_iteration_time_ms": 58931.489, "sample_time_ms": 43664.985, "load_time_ms": 1951.839, "load_throughput": 8011.933, "learn_time_ms": 12721.311, "learn_throughput": 1229.276, "synch_weights_time_ms": 473.229}, "counters": {"num_env_steps_sampled": 2277512, "num_env_steps_trained": 2277512, "num_agent_steps_sampled": 2277512, "num_agent_steps_trained": 2277512}, "done": false, "episodes_total": 2327, "training_iteration": 166, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-14-24", "timestamp": 1749309264, "time_this_iter_s": 59.94408297538757, "time_total_s": 9529.385030508041, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9529.385030508041, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 76.9231884057971, "ram_util_percent": 60.87391304347826, "gpu_util_percent0": 0.0855072463768116, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.722488000000003e-05, "total_loss": -0.06819025677586482, "policy_loss": -0.02268198248104785, "vf_loss": 0.012985358355058865, "vf_explained_var": 0.980835583860224, "kl": 0.01861121344819705, "entropy": 16.209411449432373, "entropy_coeff": 0.0030837319999999996}, "model": {}, "num_grad_updates_lifetime": 80525.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2293150, "num_env_steps_trained": 2293150, "num_agent_steps_sampled": 2293150, "num_agent_steps_trained": 2293150}, "sampler_results": {"episode_reward_max": 102.02643827724404, "episode_reward_min": 71.25914640962809, "episode_reward_mean": 87.51931127822729, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.39882885111066, 102.02643827724404, 76.24268801351101, 93.82909936792629, 82.12757511747786, 85.5349553412829, 89.90018088441052, 71.25914640962809, 94.80179084292656, 87.49405685554326, 88.56626717293251, 83.31755014702344, 90.29762915521025, 101.75977554220059, 89.10728268876608, 97.12626113112081, 76.02162963036163, 93.1663989956204, 81.27526219549456, 85.99339376982144, 85.25051851535092, 77.78179315027286, 89.44380008765025, 93.25191550333925, 84.8178181782494, 82.55036140846785, 90.73416338214437, 96.99862338266111, 89.8694088657194, 98.54459347107107, 78.10166091554865, 92.93818096863524, 80.62412280115312, 83.16160482714604, 85.89943137948944, 74.56033868560961, 88.84128009745609, 94.52112601139198, 84.9419400280994, 81.4252797801385, 89.0253209765181, 98.92649405957775, 91.34884735987107, 95.43859983288554, 81.88949881390293, 89.85748717293127, 76.40405339375006, 85.39985540109497, 84.83210957841894, 78.22325152102741, 93.88684785033257, 88.62597931222132, 85.45646916617065, 76.60542801753965, 91.71650902678911, 97.48401863379432, 93.31252015097701, 99.66337443709673, 75.98710442642552, 87.21450818690624, 76.36849062896461, 82.4839975365371, 84.45648935228735, 74.47648226078736, 94.06346463812235, 88.65677299655127, 91.75206755532139, 81.34549280405682, 91.00163188684587, 100.47113836562937, 83.52766770375824, 99.41466253230722, 75.36233043795323, 93.17612234363114, 79.88633239652862, 81.30944318949155, 86.8205449616992, 77.48870489434319, 93.36397801710363, 93.53966350696071, 88.6250966782681, 78.66238878788943, 92.5797864593788, 98.33747206575076, 94.36188316460594, 97.42085461434493, 77.8690409639148, 92.27005349853582, 78.59520652652557, 83.5263553182595, 84.180267361214, 73.77965317563051, 94.66589494289957, 90.91403065714591, 85.27662341505048, 76.02492700784225, 91.6903011161081, 98.17242901154498, 88.87305343933072, 100.33788246217084], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7186014105281227, "mean_inference_ms": 8.398526141104648, "mean_action_processing_ms": 0.572950391810449, "mean_env_wait_ms": 23.988471598692573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035050392150878906, "StateBufferConnector_ms": 0.043703556060791016, "ViewRequirementAgentConnector_ms": 0.9182446002960205}}, "episode_reward_max": 102.02643827724404, "episode_reward_min": 71.25914640962809, "episode_reward_mean": 87.51931127822729, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [91.39882885111066, 102.02643827724404, 76.24268801351101, 93.82909936792629, 82.12757511747786, 85.5349553412829, 89.90018088441052, 71.25914640962809, 94.80179084292656, 87.49405685554326, 88.56626717293251, 83.31755014702344, 90.29762915521025, 101.75977554220059, 89.10728268876608, 97.12626113112081, 76.02162963036163, 93.1663989956204, 81.27526219549456, 85.99339376982144, 85.25051851535092, 77.78179315027286, 89.44380008765025, 93.25191550333925, 84.8178181782494, 82.55036140846785, 90.73416338214437, 96.99862338266111, 89.8694088657194, 98.54459347107107, 78.10166091554865, 92.93818096863524, 80.62412280115312, 83.16160482714604, 85.89943137948944, 74.56033868560961, 88.84128009745609, 94.52112601139198, 84.9419400280994, 81.4252797801385, 89.0253209765181, 98.92649405957775, 91.34884735987107, 95.43859983288554, 81.88949881390293, 89.85748717293127, 76.40405339375006, 85.39985540109497, 84.83210957841894, 78.22325152102741, 93.88684785033257, 88.62597931222132, 85.45646916617065, 76.60542801753965, 91.71650902678911, 97.48401863379432, 93.31252015097701, 99.66337443709673, 75.98710442642552, 87.21450818690624, 76.36849062896461, 82.4839975365371, 84.45648935228735, 74.47648226078736, 94.06346463812235, 88.65677299655127, 91.75206755532139, 81.34549280405682, 91.00163188684587, 100.47113836562937, 83.52766770375824, 99.41466253230722, 75.36233043795323, 93.17612234363114, 79.88633239652862, 81.30944318949155, 86.8205449616992, 77.48870489434319, 93.36397801710363, 93.53966350696071, 88.6250966782681, 78.66238878788943, 92.5797864593788, 98.33747206575076, 94.36188316460594, 97.42085461434493, 77.8690409639148, 92.27005349853582, 78.59520652652557, 83.5263553182595, 84.180267361214, 73.77965317563051, 94.66589494289957, 90.91403065714591, 85.27662341505048, 76.02492700784225, 91.6903011161081, 98.17242901154498, 88.87305343933072, 100.33788246217084], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7186014105281227, "mean_inference_ms": 8.398526141104648, "mean_action_processing_ms": 0.572950391810449, "mean_env_wait_ms": 23.988471598692573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035050392150878906, "StateBufferConnector_ms": 0.043703556060791016, "ViewRequirementAgentConnector_ms": 0.9182446002960205}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2293150, "num_agent_steps_trained": 2293150, "num_env_steps_sampled": 2293150, "num_env_steps_trained": 2293150, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 257.47927204257013, "num_env_steps_trained_throughput_per_sec": 257.47927204257013, "timesteps_total": 2293150, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2293150, "timers": {"training_iteration_time_ms": 58958.252, "sample_time_ms": 43740.143, "load_time_ms": 1928.115, "load_throughput": 8110.514, "learn_time_ms": 12698.231, "learn_throughput": 1231.51, "synch_weights_time_ms": 474.568}, "counters": {"num_env_steps_sampled": 2293150, "num_env_steps_trained": 2293150, "num_agent_steps_sampled": 2293150, "num_agent_steps_trained": 2293150}, "done": false, "episodes_total": 2341, "training_iteration": 167, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-15-25", "timestamp": 1749309325, "time_this_iter_s": 60.756534576416016, "time_total_s": 9590.141565084457, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9590.141565084457, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 77.62898550724637, "ram_util_percent": 60.88115942028985, "gpu_util_percent0": 0.08115942028985505, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.706850000000001e-05, "total_loss": -0.060369693572759967, "policy_loss": -0.014623657381585376, "vf_loss": 0.011426965410990472, "vf_explained_var": 0.9820043782754377, "kl": 0.01890534421429603, "entropy": 16.26158345309171, "entropy_coeff": 0.0030602750000000008}, "model": {}, "num_grad_updates_lifetime": 81075.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2308788, "num_env_steps_trained": 2308788, "num_agent_steps_sampled": 2308788, "num_agent_steps_trained": 2308788}, "sampler_results": {"episode_reward_max": 100.47113836562937, "episode_reward_min": 72.9994717119394, "episode_reward_mean": 87.17124175429439, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.10728268876608, 97.12626113112081, 76.02162963036163, 93.1663989956204, 81.27526219549456, 85.99339376982144, 85.25051851535092, 77.78179315027286, 89.44380008765025, 93.25191550333925, 84.8178181782494, 82.55036140846785, 90.73416338214437, 96.99862338266111, 89.8694088657194, 98.54459347107107, 78.10166091554865, 92.93818096863524, 80.62412280115312, 83.16160482714604, 85.89943137948944, 74.56033868560961, 88.84128009745609, 94.52112601139198, 84.9419400280994, 81.4252797801385, 89.0253209765181, 98.92649405957775, 91.34884735987107, 95.43859983288554, 81.88949881390293, 89.85748717293127, 76.40405339375006, 85.39985540109497, 84.83210957841894, 78.22325152102741, 93.88684785033257, 88.62597931222132, 85.45646916617065, 76.60542801753965, 91.71650902678911, 97.48401863379432, 93.31252015097701, 99.66337443709673, 75.98710442642552, 87.21450818690624, 76.36849062896461, 82.4839975365371, 84.45648935228735, 74.47648226078736, 94.06346463812235, 88.65677299655127, 91.75206755532139, 81.34549280405682, 91.00163188684587, 100.47113836562937, 83.52766770375824, 99.41466253230722, 75.36233043795323, 93.17612234363114, 79.88633239652862, 81.30944318949155, 86.8205449616992, 77.48870489434319, 93.36397801710363, 93.53966350696071, 88.6250966782681, 78.66238878788943, 92.5797864593788, 98.33747206575076, 94.36188316460594, 97.42085461434493, 77.8690409639148, 92.27005349853582, 78.59520652652557, 83.5263553182595, 84.180267361214, 73.77965317563051, 94.66589494289957, 90.91403065714591, 85.27662341505048, 76.02492700784225, 91.6903011161081, 98.17242901154498, 88.87305343933072, 100.33788246217084, 74.86584041068778, 90.09926462021505, 78.78910920484454, 84.90473504399748, 85.03310156322343, 72.9994717119394, 94.67475504795927, 88.14614291302553, 90.61248326083586, 79.10945362972654, 87.9921244339158, 93.75904387002072, 89.21884113806072, 93.54466273668365], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.717858588591016, "mean_inference_ms": 8.400614462999606, "mean_action_processing_ms": 0.573249456192183, "mean_env_wait_ms": 24.000671677499184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03332018852233887, "StateBufferConnector_ms": 0.02844977378845215, "ViewRequirementAgentConnector_ms": 0.9623668193817139}}, "episode_reward_max": 100.47113836562937, "episode_reward_min": 72.9994717119394, "episode_reward_mean": 87.17124175429439, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89.10728268876608, 97.12626113112081, 76.02162963036163, 93.1663989956204, 81.27526219549456, 85.99339376982144, 85.25051851535092, 77.78179315027286, 89.44380008765025, 93.25191550333925, 84.8178181782494, 82.55036140846785, 90.73416338214437, 96.99862338266111, 89.8694088657194, 98.54459347107107, 78.10166091554865, 92.93818096863524, 80.62412280115312, 83.16160482714604, 85.89943137948944, 74.56033868560961, 88.84128009745609, 94.52112601139198, 84.9419400280994, 81.4252797801385, 89.0253209765181, 98.92649405957775, 91.34884735987107, 95.43859983288554, 81.88949881390293, 89.85748717293127, 76.40405339375006, 85.39985540109497, 84.83210957841894, 78.22325152102741, 93.88684785033257, 88.62597931222132, 85.45646916617065, 76.60542801753965, 91.71650902678911, 97.48401863379432, 93.31252015097701, 99.66337443709673, 75.98710442642552, 87.21450818690624, 76.36849062896461, 82.4839975365371, 84.45648935228735, 74.47648226078736, 94.06346463812235, 88.65677299655127, 91.75206755532139, 81.34549280405682, 91.00163188684587, 100.47113836562937, 83.52766770375824, 99.41466253230722, 75.36233043795323, 93.17612234363114, 79.88633239652862, 81.30944318949155, 86.8205449616992, 77.48870489434319, 93.36397801710363, 93.53966350696071, 88.6250966782681, 78.66238878788943, 92.5797864593788, 98.33747206575076, 94.36188316460594, 97.42085461434493, 77.8690409639148, 92.27005349853582, 78.59520652652557, 83.5263553182595, 84.180267361214, 73.77965317563051, 94.66589494289957, 90.91403065714591, 85.27662341505048, 76.02492700784225, 91.6903011161081, 98.17242901154498, 88.87305343933072, 100.33788246217084, 74.86584041068778, 90.09926462021505, 78.78910920484454, 84.90473504399748, 85.03310156322343, 72.9994717119394, 94.67475504795927, 88.14614291302553, 90.61248326083586, 79.10945362972654, 87.9921244339158, 93.75904387002072, 89.21884113806072, 93.54466273668365], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.717858588591016, "mean_inference_ms": 8.400614462999606, "mean_action_processing_ms": 0.573249456192183, "mean_env_wait_ms": 24.000671677499184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03332018852233887, "StateBufferConnector_ms": 0.02844977378845215, "ViewRequirementAgentConnector_ms": 0.9623668193817139}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2308788, "num_agent_steps_trained": 2308788, "num_env_steps_sampled": 2308788, "num_env_steps_trained": 2308788, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 259.32013239841194, "num_env_steps_trained_throughput_per_sec": 259.32013239841194, "timesteps_total": 2308788, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2308788, "timers": {"training_iteration_time_ms": 59001.019, "sample_time_ms": 43798.651, "load_time_ms": 1943.654, "load_throughput": 8045.669, "learn_time_ms": 12659.431, "learn_throughput": 1235.285, "synch_weights_time_ms": 481.651}, "counters": {"num_env_steps_sampled": 2308788, "num_env_steps_trained": 2308788, "num_agent_steps_sampled": 2308788, "num_agent_steps_trained": 2308788}, "done": false, "episodes_total": 2355, "training_iteration": 168, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-16-25", "timestamp": 1749309385, "time_this_iter_s": 60.327383518218994, "time_total_s": 9650.468948602676, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9650.468948602676, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 78.6376811594203, "ram_util_percent": 60.53623188405797, "gpu_util_percent0": 0.0871014492753623, "vram_util_percent0": 0.8409830729166665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.691212e-05, "total_loss": -0.052323954924094404, "policy_loss": -0.007040719218044118, "vf_loss": 0.011568658895451915, "vf_explained_var": 0.980916624285958, "kl": 0.018052625987757576, "entropy": 16.240017507726495, "entropy_coeff": 0.0030368179999999997}, "model": {}, "num_grad_updates_lifetime": 81625.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2324426, "num_env_steps_trained": 2324426, "num_agent_steps_sampled": 2324426, "num_agent_steps_trained": 2324426}, "sampler_results": {"episode_reward_max": 100.47113836562937, "episode_reward_min": 71.18253933756127, "episode_reward_mean": 87.07281878708592, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.8694088657194, 98.54459347107107, 78.10166091554865, 92.93818096863524, 80.62412280115312, 83.16160482714604, 85.89943137948944, 74.56033868560961, 88.84128009745609, 94.52112601139198, 84.9419400280994, 81.4252797801385, 89.0253209765181, 98.92649405957775, 91.34884735987107, 95.43859983288554, 81.88949881390293, 89.85748717293127, 76.40405339375006, 85.39985540109497, 84.83210957841894, 78.22325152102741, 93.88684785033257, 88.62597931222132, 85.45646916617065, 76.60542801753965, 91.71650902678911, 97.48401863379432, 93.31252015097701, 99.66337443709673, 75.98710442642552, 87.21450818690624, 76.36849062896461, 82.4839975365371, 84.45648935228735, 74.47648226078736, 94.06346463812235, 88.65677299655127, 91.75206755532139, 81.34549280405682, 91.00163188684587, 100.47113836562937, 83.52766770375824, 99.41466253230722, 75.36233043795323, 93.17612234363114, 79.88633239652862, 81.30944318949155, 86.8205449616992, 77.48870489434319, 93.36397801710363, 93.53966350696071, 88.6250966782681, 78.66238878788943, 92.5797864593788, 98.33747206575076, 94.36188316460594, 97.42085461434493, 77.8690409639148, 92.27005349853582, 78.59520652652557, 83.5263553182595, 84.180267361214, 73.77965317563051, 94.66589494289957, 90.91403065714591, 85.27662341505048, 76.02492700784225, 91.6903011161081, 98.17242901154498, 88.87305343933072, 100.33788246217084, 74.86584041068778, 90.09926462021505, 78.78910920484454, 84.90473504399748, 85.03310156322343, 72.9994717119394, 94.67475504795927, 88.14614291302553, 90.61248326083586, 79.10945362972654, 87.9921244339158, 93.75904387002072, 89.21884113806072, 93.54466273668365, 76.12060282132184, 92.36930224324705, 75.66662139282388, 85.54052056909646, 85.88717082174902, 71.18253933756127, 93.55715261481842, 87.55834904535742, 88.20898900942157, 82.49984215105906, 86.73340244436925, 98.91401886134055, 91.78159393255149, 97.65682005375692], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.717247607141283, "mean_inference_ms": 8.40287757916725, "mean_action_processing_ms": 0.5735809030417406, "mean_env_wait_ms": 24.01376424697869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035337209701538086, "StateBufferConnector_ms": 0.0294647216796875, "ViewRequirementAgentConnector_ms": 0.9311871528625488}}, "episode_reward_max": 100.47113836562937, "episode_reward_min": 71.18253933756127, "episode_reward_mean": 87.07281878708592, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [89.8694088657194, 98.54459347107107, 78.10166091554865, 92.93818096863524, 80.62412280115312, 83.16160482714604, 85.89943137948944, 74.56033868560961, 88.84128009745609, 94.52112601139198, 84.9419400280994, 81.4252797801385, 89.0253209765181, 98.92649405957775, 91.34884735987107, 95.43859983288554, 81.88949881390293, 89.85748717293127, 76.40405339375006, 85.39985540109497, 84.83210957841894, 78.22325152102741, 93.88684785033257, 88.62597931222132, 85.45646916617065, 76.60542801753965, 91.71650902678911, 97.48401863379432, 93.31252015097701, 99.66337443709673, 75.98710442642552, 87.21450818690624, 76.36849062896461, 82.4839975365371, 84.45648935228735, 74.47648226078736, 94.06346463812235, 88.65677299655127, 91.75206755532139, 81.34549280405682, 91.00163188684587, 100.47113836562937, 83.52766770375824, 99.41466253230722, 75.36233043795323, 93.17612234363114, 79.88633239652862, 81.30944318949155, 86.8205449616992, 77.48870489434319, 93.36397801710363, 93.53966350696071, 88.6250966782681, 78.66238878788943, 92.5797864593788, 98.33747206575076, 94.36188316460594, 97.42085461434493, 77.8690409639148, 92.27005349853582, 78.59520652652557, 83.5263553182595, 84.180267361214, 73.77965317563051, 94.66589494289957, 90.91403065714591, 85.27662341505048, 76.02492700784225, 91.6903011161081, 98.17242901154498, 88.87305343933072, 100.33788246217084, 74.86584041068778, 90.09926462021505, 78.78910920484454, 84.90473504399748, 85.03310156322343, 72.9994717119394, 94.67475504795927, 88.14614291302553, 90.61248326083586, 79.10945362972654, 87.9921244339158, 93.75904387002072, 89.21884113806072, 93.54466273668365, 76.12060282132184, 92.36930224324705, 75.66662139282388, 85.54052056909646, 85.88717082174902, 71.18253933756127, 93.55715261481842, 87.55834904535742, 88.20898900942157, 82.49984215105906, 86.73340244436925, 98.91401886134055, 91.78159393255149, 97.65682005375692], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.717247607141283, "mean_inference_ms": 8.40287757916725, "mean_action_processing_ms": 0.5735809030417406, "mean_env_wait_ms": 24.01376424697869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035337209701538086, "StateBufferConnector_ms": 0.0294647216796875, "ViewRequirementAgentConnector_ms": 0.9311871528625488}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2324426, "num_agent_steps_trained": 2324426, "num_env_steps_sampled": 2324426, "num_env_steps_trained": 2324426, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 262.3132915014642, "num_env_steps_trained_throughput_per_sec": 262.3132915014642, "timesteps_total": 2324426, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2324426, "timers": {"training_iteration_time_ms": 59048.283, "sample_time_ms": 43950.196, "load_time_ms": 1940.912, "load_throughput": 8057.038, "learn_time_ms": 12562.813, "learn_throughput": 1244.785, "synch_weights_time_ms": 471.676}, "counters": {"num_env_steps_sampled": 2324426, "num_env_steps_trained": 2324426, "num_agent_steps_sampled": 2324426, "num_agent_steps_trained": 2324426}, "done": false, "episodes_total": 2369, "training_iteration": 169, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-17-25", "timestamp": 1749309445, "time_this_iter_s": 59.63088536262512, "time_total_s": 9710.099833965302, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9710.099833965302, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 77.42500000000001, "ram_util_percent": 60.43088235294118, "gpu_util_percent0": 0.0836764705882353, "vram_util_percent0": 0.8409830729166666}}
{"evaluation": {"sampler_results": {"episode_reward_max": -10.881674380275001, "episode_reward_min": -20.499998430268402, "episode_reward_mean": -15.2598911942353, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.534677319711907, -20.499998430268402, -15.647758438110111, -10.881674380275001, -13.735347402811078], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7193898117517115, "mean_inference_ms": 3.9753608406066405, "mean_action_processing_ms": 0.2986777812713141, "mean_env_wait_ms": 12.55663823352797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2262401580810547}}, "episode_reward_max": -10.881674380275001, "episode_reward_min": -20.499998430268402, "episode_reward_mean": -15.2598911942353, "episode_len_mean": 184.0, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.534677319711907, -20.499998430268402, -15.647758438110111, -10.881674380275001, -13.735347402811078], "episode_lengths": [184, 184, 184, 184, 184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7193898117517115, "mean_inference_ms": 3.9753608406066405, "mean_action_processing_ms": 0.2986777812713141, "mean_env_wait_ms": 12.55663823352797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.2262401580810547}, "num_agent_steps_sampled_this_iter": 920, "num_env_steps_sampled_this_iter": 920, "timesteps_this_iter": 920, "num_healthy_workers": 0, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.675574e-05, "total_loss": -0.04320203586063475, "policy_loss": 0.001781734353862703, "vf_loss": 0.011489492294971239, "vf_explained_var": 0.979276627518914, "kl": 0.01952031331316737, "entropy": 16.27439553347501, "entropy_coeff": 0.003013360999999999}, "model": {}, "num_grad_updates_lifetime": 82175.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2340064, "num_env_steps_trained": 2340064, "num_agent_steps_sampled": 2340064, "num_agent_steps_trained": 2340064}, "sampler_results": {"episode_reward_max": 100.47113836562937, "episode_reward_min": 71.18253933756127, "episode_reward_mean": 86.81767943546934, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.34884735987107, 95.43859983288554, 81.88949881390293, 89.85748717293127, 76.40405339375006, 85.39985540109497, 84.83210957841894, 78.22325152102741, 93.88684785033257, 88.62597931222132, 85.45646916617065, 76.60542801753965, 91.71650902678911, 97.48401863379432, 93.31252015097701, 99.66337443709673, 75.98710442642552, 87.21450818690624, 76.36849062896461, 82.4839975365371, 84.45648935228735, 74.47648226078736, 94.06346463812235, 88.65677299655127, 91.75206755532139, 81.34549280405682, 91.00163188684587, 100.47113836562937, 83.52766770375824, 99.41466253230722, 75.36233043795323, 93.17612234363114, 79.88633239652862, 81.30944318949155, 86.8205449616992, 77.48870489434319, 93.36397801710363, 93.53966350696071, 88.6250966782681, 78.66238878788943, 92.5797864593788, 98.33747206575076, 94.36188316460594, 97.42085461434493, 77.8690409639148, 92.27005349853582, 78.59520652652557, 83.5263553182595, 84.180267361214, 73.77965317563051, 94.66589494289957, 90.91403065714591, 85.27662341505048, 76.02492700784225, 91.6903011161081, 98.17242901154498, 88.87305343933072, 100.33788246217084, 74.86584041068778, 90.09926462021505, 78.78910920484454, 84.90473504399748, 85.03310156322343, 72.9994717119394, 94.67475504795927, 88.14614291302553, 90.61248326083586, 79.10945362972654, 87.9921244339158, 93.75904387002072, 89.21884113806072, 93.54466273668365, 76.12060282132184, 92.36930224324705, 75.66662139282388, 85.54052056909646, 85.88717082174902, 71.18253933756127, 93.55715261481842, 87.55834904535742, 88.20898900942157, 82.49984215105906, 86.73340244436925, 98.91401886134055, 91.78159393255149, 97.65682005375692, 79.6814021822551, 86.79197852025422, 74.7291130061753, 84.90022928147609, 78.44691024065088, 75.25302103335747, 89.02239926519266, 90.8772944228988, 86.85528215742872, 82.03449356128174, 88.74327970967913, 94.93622784154351, 90.69704169460402, 92.89817478910047], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7165869273615533, "mean_inference_ms": 8.405281787360282, "mean_action_processing_ms": 0.5739286166984691, "mean_env_wait_ms": 24.027439966221618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04380464553833008, "StateBufferConnector_ms": 0.02933526039123535, "ViewRequirementAgentConnector_ms": 0.9241814613342285}}, "episode_reward_max": 100.47113836562937, "episode_reward_min": 71.18253933756127, "episode_reward_mean": 86.81767943546934, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [91.34884735987107, 95.43859983288554, 81.88949881390293, 89.85748717293127, 76.40405339375006, 85.39985540109497, 84.83210957841894, 78.22325152102741, 93.88684785033257, 88.62597931222132, 85.45646916617065, 76.60542801753965, 91.71650902678911, 97.48401863379432, 93.31252015097701, 99.66337443709673, 75.98710442642552, 87.21450818690624, 76.36849062896461, 82.4839975365371, 84.45648935228735, 74.47648226078736, 94.06346463812235, 88.65677299655127, 91.75206755532139, 81.34549280405682, 91.00163188684587, 100.47113836562937, 83.52766770375824, 99.41466253230722, 75.36233043795323, 93.17612234363114, 79.88633239652862, 81.30944318949155, 86.8205449616992, 77.48870489434319, 93.36397801710363, 93.53966350696071, 88.6250966782681, 78.66238878788943, 92.5797864593788, 98.33747206575076, 94.36188316460594, 97.42085461434493, 77.8690409639148, 92.27005349853582, 78.59520652652557, 83.5263553182595, 84.180267361214, 73.77965317563051, 94.66589494289957, 90.91403065714591, 85.27662341505048, 76.02492700784225, 91.6903011161081, 98.17242901154498, 88.87305343933072, 100.33788246217084, 74.86584041068778, 90.09926462021505, 78.78910920484454, 84.90473504399748, 85.03310156322343, 72.9994717119394, 94.67475504795927, 88.14614291302553, 90.61248326083586, 79.10945362972654, 87.9921244339158, 93.75904387002072, 89.21884113806072, 93.54466273668365, 76.12060282132184, 92.36930224324705, 75.66662139282388, 85.54052056909646, 85.88717082174902, 71.18253933756127, 93.55715261481842, 87.55834904535742, 88.20898900942157, 82.49984215105906, 86.73340244436925, 98.91401886134055, 91.78159393255149, 97.65682005375692, 79.6814021822551, 86.79197852025422, 74.7291130061753, 84.90022928147609, 78.44691024065088, 75.25302103335747, 89.02239926519266, 90.8772944228988, 86.85528215742872, 82.03449356128174, 88.74327970967913, 94.93622784154351, 90.69704169460402, 92.89817478910047], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7165869273615533, "mean_inference_ms": 8.405281787360282, "mean_action_processing_ms": 0.5739286166984691, "mean_env_wait_ms": 24.027439966221618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04380464553833008, "StateBufferConnector_ms": 0.02933526039123535, "ViewRequirementAgentConnector_ms": 0.9241814613342285}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2340064, "num_agent_steps_trained": 2340064, "num_env_steps_sampled": 2340064, "num_env_steps_trained": 2340064, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 265.055877291145, "num_env_steps_trained_throughput_per_sec": 265.055877291145, "timesteps_total": 2340064, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2340064, "timers": {"training_iteration_time_ms": 59083.875, "sample_time_ms": 43984.946, "load_time_ms": 1961.023, "load_throughput": 7974.408, "learn_time_ms": 12548.074, "learn_throughput": 1246.247, "synch_weights_time_ms": 466.294}, "counters": {"num_env_steps_sampled": 2340064, "num_env_steps_trained": 2340064, "num_agent_steps_sampled": 2340064, "num_agent_steps_trained": 2340064}, "done": false, "episodes_total": 2383, "training_iteration": 170, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-18-41", "timestamp": 1749309521, "time_this_iter_s": 76.22860169410706, "time_total_s": 9786.328435659409, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9786.328435659409, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 63.90224719101123, "ram_util_percent": 60.28089887640449, "gpu_util_percent0": 0.06640449438202248, "vram_util_percent0": 0.8409830729166667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.659935999999999e-05, "total_loss": -0.05618488364302638, "policy_loss": -0.012145066006447781, "vf_loss": 0.01398212320340628, "vf_explained_var": 0.9790628122199665, "kl": 0.018546144503112705, "entropy": 16.326283910924737, "entropy_coeff": 0.0029899040000000007}, "model": {}, "num_grad_updates_lifetime": 82725.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2355702, "num_env_steps_trained": 2355702, "num_agent_steps_sampled": 2355702, "num_agent_steps_trained": 2355702}, "sampler_results": {"episode_reward_max": 100.47113836562937, "episode_reward_min": 70.25823875747565, "episode_reward_mean": 86.5451793636812, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.31252015097701, 99.66337443709673, 75.98710442642552, 87.21450818690624, 76.36849062896461, 82.4839975365371, 84.45648935228735, 74.47648226078736, 94.06346463812235, 88.65677299655127, 91.75206755532139, 81.34549280405682, 91.00163188684587, 100.47113836562937, 83.52766770375824, 99.41466253230722, 75.36233043795323, 93.17612234363114, 79.88633239652862, 81.30944318949155, 86.8205449616992, 77.48870489434319, 93.36397801710363, 93.53966350696071, 88.6250966782681, 78.66238878788943, 92.5797864593788, 98.33747206575076, 94.36188316460594, 97.42085461434493, 77.8690409639148, 92.27005349853582, 78.59520652652557, 83.5263553182595, 84.180267361214, 73.77965317563051, 94.66589494289957, 90.91403065714591, 85.27662341505048, 76.02492700784225, 91.6903011161081, 98.17242901154498, 88.87305343933072, 100.33788246217084, 74.86584041068778, 90.09926462021505, 78.78910920484454, 84.90473504399748, 85.03310156322343, 72.9994717119394, 94.67475504795927, 88.14614291302553, 90.61248326083586, 79.10945362972654, 87.9921244339158, 93.75904387002072, 89.21884113806072, 93.54466273668365, 76.12060282132184, 92.36930224324705, 75.66662139282388, 85.54052056909646, 85.88717082174902, 71.18253933756127, 93.55715261481842, 87.55834904535742, 88.20898900942157, 82.49984215105906, 86.73340244436925, 98.91401886134055, 91.78159393255149, 97.65682005375692, 79.6814021822551, 86.79197852025422, 74.7291130061753, 84.90022928147609, 78.44691024065088, 75.25302103335747, 89.02239926519266, 90.8772944228988, 86.85528215742872, 82.03449356128174, 88.74327970967913, 94.93622784154351, 90.69704169460402, 92.89817478910047, 75.18737309530204, 79.75769829772517, 76.75782801690029, 81.20939483464758, 82.70231666076302, 70.25823875747565, 95.31004754530538, 93.50384918046704, 89.2076893220656, 82.03496737086074, 86.50686873924782, 89.64722620538191, 90.83628502274105, 96.99916485303345], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.715985172529487, "mean_inference_ms": 8.40770935201892, "mean_action_processing_ms": 0.57427577637577, "mean_env_wait_ms": 24.04111720286762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05307364463806152, "StateBufferConnector_ms": 0.030513763427734375, "ViewRequirementAgentConnector_ms": 0.9461359977722168}}, "episode_reward_max": 100.47113836562937, "episode_reward_min": 70.25823875747565, "episode_reward_mean": 86.5451793636812, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [93.31252015097701, 99.66337443709673, 75.98710442642552, 87.21450818690624, 76.36849062896461, 82.4839975365371, 84.45648935228735, 74.47648226078736, 94.06346463812235, 88.65677299655127, 91.75206755532139, 81.34549280405682, 91.00163188684587, 100.47113836562937, 83.52766770375824, 99.41466253230722, 75.36233043795323, 93.17612234363114, 79.88633239652862, 81.30944318949155, 86.8205449616992, 77.48870489434319, 93.36397801710363, 93.53966350696071, 88.6250966782681, 78.66238878788943, 92.5797864593788, 98.33747206575076, 94.36188316460594, 97.42085461434493, 77.8690409639148, 92.27005349853582, 78.59520652652557, 83.5263553182595, 84.180267361214, 73.77965317563051, 94.66589494289957, 90.91403065714591, 85.27662341505048, 76.02492700784225, 91.6903011161081, 98.17242901154498, 88.87305343933072, 100.33788246217084, 74.86584041068778, 90.09926462021505, 78.78910920484454, 84.90473504399748, 85.03310156322343, 72.9994717119394, 94.67475504795927, 88.14614291302553, 90.61248326083586, 79.10945362972654, 87.9921244339158, 93.75904387002072, 89.21884113806072, 93.54466273668365, 76.12060282132184, 92.36930224324705, 75.66662139282388, 85.54052056909646, 85.88717082174902, 71.18253933756127, 93.55715261481842, 87.55834904535742, 88.20898900942157, 82.49984215105906, 86.73340244436925, 98.91401886134055, 91.78159393255149, 97.65682005375692, 79.6814021822551, 86.79197852025422, 74.7291130061753, 84.90022928147609, 78.44691024065088, 75.25302103335747, 89.02239926519266, 90.8772944228988, 86.85528215742872, 82.03449356128174, 88.74327970967913, 94.93622784154351, 90.69704169460402, 92.89817478910047, 75.18737309530204, 79.75769829772517, 76.75782801690029, 81.20939483464758, 82.70231666076302, 70.25823875747565, 95.31004754530538, 93.50384918046704, 89.2076893220656, 82.03496737086074, 86.50686873924782, 89.64722620538191, 90.83628502274105, 96.99916485303345], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.715985172529487, "mean_inference_ms": 8.40770935201892, "mean_action_processing_ms": 0.57427577637577, "mean_env_wait_ms": 24.04111720286762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05307364463806152, "StateBufferConnector_ms": 0.030513763427734375, "ViewRequirementAgentConnector_ms": 0.9461359977722168}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2355702, "num_agent_steps_trained": 2355702, "num_env_steps_sampled": 2355702, "num_env_steps_trained": 2355702, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 265.841426832087, "num_env_steps_trained_throughput_per_sec": 265.841426832087, "timesteps_total": 2355702, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2355702, "timers": {"training_iteration_time_ms": 59181.222, "sample_time_ms": 44117.79, "load_time_ms": 1920.655, "load_throughput": 8142.013, "learn_time_ms": 12545.397, "learn_throughput": 1246.513, "synch_weights_time_ms": 473.776}, "counters": {"num_env_steps_sampled": 2355702, "num_env_steps_trained": 2355702, "num_agent_steps_sampled": 2355702, "num_agent_steps_trained": 2355702}, "done": false, "episodes_total": 2397, "training_iteration": 171, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-19-40", "timestamp": 1749309580, "time_this_iter_s": 58.84254837036133, "time_total_s": 9845.17098402977, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9845.17098402977, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 77.08059701492537, "ram_util_percent": 61.01194029850746, "gpu_util_percent0": 0.08358208955223881, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.644298e-05, "total_loss": -0.05025626351771114, "policy_loss": -0.0062508084103253415, "vf_loss": 0.012990929464470934, "vf_explained_var": 0.9791738516634161, "kl": 0.018836360033290204, "entropy": 16.34661617452448, "entropy_coeff": 0.0029664470000000005}, "model": {}, "num_grad_updates_lifetime": 83275.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2371340, "num_env_steps_trained": 2371340, "num_agent_steps_sampled": 2371340, "num_agent_steps_trained": 2371340}, "sampler_results": {"episode_reward_max": 100.33788246217084, "episode_reward_min": 70.25823875747565, "episode_reward_mean": 86.21372830000844, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.52766770375824, 99.41466253230722, 75.36233043795323, 93.17612234363114, 79.88633239652862, 81.30944318949155, 86.8205449616992, 77.48870489434319, 93.36397801710363, 93.53966350696071, 88.6250966782681, 78.66238878788943, 92.5797864593788, 98.33747206575076, 94.36188316460594, 97.42085461434493, 77.8690409639148, 92.27005349853582, 78.59520652652557, 83.5263553182595, 84.180267361214, 73.77965317563051, 94.66589494289957, 90.91403065714591, 85.27662341505048, 76.02492700784225, 91.6903011161081, 98.17242901154498, 88.87305343933072, 100.33788246217084, 74.86584041068778, 90.09926462021505, 78.78910920484454, 84.90473504399748, 85.03310156322343, 72.9994717119394, 94.67475504795927, 88.14614291302553, 90.61248326083586, 79.10945362972654, 87.9921244339158, 93.75904387002072, 89.21884113806072, 93.54466273668365, 76.12060282132184, 92.36930224324705, 75.66662139282388, 85.54052056909646, 85.88717082174902, 71.18253933756127, 93.55715261481842, 87.55834904535742, 88.20898900942157, 82.49984215105906, 86.73340244436925, 98.91401886134055, 91.78159393255149, 97.65682005375692, 79.6814021822551, 86.79197852025422, 74.7291130061753, 84.90022928147609, 78.44691024065088, 75.25302103335747, 89.02239926519266, 90.8772944228988, 86.85528215742872, 82.03449356128174, 88.74327970967913, 94.93622784154351, 90.69704169460402, 92.89817478910047, 75.18737309530204, 79.75769829772517, 76.75782801690029, 81.20939483464758, 82.70231666076302, 70.25823875747565, 95.31004754530538, 93.50384918046704, 89.2076893220656, 82.03496737086074, 86.50686873924782, 89.64722620538191, 90.83628502274105, 96.99916485303345, 75.96604247636829, 88.71362166595802, 73.46406442319231, 85.48730571386363, 81.51829517801328, 74.71196803172545, 91.78624951659359, 87.6802254820758, 86.86131137172177, 79.92100308463156, 84.3471653386693, 95.75800861886157, 88.36533421946842, 93.52783373808934], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.715283560793401, "mean_inference_ms": 8.409913620408618, "mean_action_processing_ms": 0.5745915632557032, "mean_env_wait_ms": 24.0538500422257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04809069633483887, "StateBufferConnector_ms": 0.028465747833251953, "ViewRequirementAgentConnector_ms": 0.9436342716217041}}, "episode_reward_max": 100.33788246217084, "episode_reward_min": 70.25823875747565, "episode_reward_mean": 86.21372830000844, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [83.52766770375824, 99.41466253230722, 75.36233043795323, 93.17612234363114, 79.88633239652862, 81.30944318949155, 86.8205449616992, 77.48870489434319, 93.36397801710363, 93.53966350696071, 88.6250966782681, 78.66238878788943, 92.5797864593788, 98.33747206575076, 94.36188316460594, 97.42085461434493, 77.8690409639148, 92.27005349853582, 78.59520652652557, 83.5263553182595, 84.180267361214, 73.77965317563051, 94.66589494289957, 90.91403065714591, 85.27662341505048, 76.02492700784225, 91.6903011161081, 98.17242901154498, 88.87305343933072, 100.33788246217084, 74.86584041068778, 90.09926462021505, 78.78910920484454, 84.90473504399748, 85.03310156322343, 72.9994717119394, 94.67475504795927, 88.14614291302553, 90.61248326083586, 79.10945362972654, 87.9921244339158, 93.75904387002072, 89.21884113806072, 93.54466273668365, 76.12060282132184, 92.36930224324705, 75.66662139282388, 85.54052056909646, 85.88717082174902, 71.18253933756127, 93.55715261481842, 87.55834904535742, 88.20898900942157, 82.49984215105906, 86.73340244436925, 98.91401886134055, 91.78159393255149, 97.65682005375692, 79.6814021822551, 86.79197852025422, 74.7291130061753, 84.90022928147609, 78.44691024065088, 75.25302103335747, 89.02239926519266, 90.8772944228988, 86.85528215742872, 82.03449356128174, 88.74327970967913, 94.93622784154351, 90.69704169460402, 92.89817478910047, 75.18737309530204, 79.75769829772517, 76.75782801690029, 81.20939483464758, 82.70231666076302, 70.25823875747565, 95.31004754530538, 93.50384918046704, 89.2076893220656, 82.03496737086074, 86.50686873924782, 89.64722620538191, 90.83628502274105, 96.99916485303345, 75.96604247636829, 88.71362166595802, 73.46406442319231, 85.48730571386363, 81.51829517801328, 74.71196803172545, 91.78624951659359, 87.6802254820758, 86.86131137172177, 79.92100308463156, 84.3471653386693, 95.75800861886157, 88.36533421946842, 93.52783373808934], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.715283560793401, "mean_inference_ms": 8.409913620408618, "mean_action_processing_ms": 0.5745915632557032, "mean_env_wait_ms": 24.0538500422257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04809069633483887, "StateBufferConnector_ms": 0.028465747833251953, "ViewRequirementAgentConnector_ms": 0.9436342716217041}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2371340, "num_agent_steps_trained": 2371340, "num_env_steps_sampled": 2371340, "num_env_steps_trained": 2371340, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 272.2593689564918, "num_env_steps_trained_throughput_per_sec": 272.2593689564918, "timesteps_total": 2371340, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2371340, "timers": {"training_iteration_time_ms": 59119.017, "sample_time_ms": 44091.833, "load_time_ms": 1925.435, "load_throughput": 8121.8, "learn_time_ms": 12515.518, "learn_throughput": 1249.489, "synch_weights_time_ms": 460.95}, "counters": {"num_env_steps_sampled": 2371340, "num_env_steps_trained": 2371340, "num_agent_steps_sampled": 2371340, "num_agent_steps_trained": 2371340}, "done": false, "episodes_total": 2411, "training_iteration": 172, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-20-38", "timestamp": 1749309638, "time_this_iter_s": 57.51560187339783, "time_total_s": 9902.686585903168, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9902.686585903168, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 77.66060606060606, "ram_util_percent": 60.813636363636355, "gpu_util_percent0": 0.08287878787878789, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.62866e-05, "total_loss": -0.042977105548012665, "policy_loss": -0.0004004683100025762, "vf_loss": 0.016751863244836303, "vf_explained_var": 0.9759645190022208, "kl": 0.01826228684521315, "entropy": 16.368690175143154, "entropy_coeff": 0.00294299}, "model": {}, "num_grad_updates_lifetime": 83825.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2386978, "num_env_steps_trained": 2386978, "num_agent_steps_sampled": 2386978, "num_agent_steps_trained": 2386978}, "sampler_results": {"episode_reward_max": 100.33788246217084, "episode_reward_min": 64.8031889470513, "episode_reward_mean": 85.61899811538184, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.36188316460594, 97.42085461434493, 77.8690409639148, 92.27005349853582, 78.59520652652557, 83.5263553182595, 84.180267361214, 73.77965317563051, 94.66589494289957, 90.91403065714591, 85.27662341505048, 76.02492700784225, 91.6903011161081, 98.17242901154498, 88.87305343933072, 100.33788246217084, 74.86584041068778, 90.09926462021505, 78.78910920484454, 84.90473504399748, 85.03310156322343, 72.9994717119394, 94.67475504795927, 88.14614291302553, 90.61248326083586, 79.10945362972654, 87.9921244339158, 93.75904387002072, 89.21884113806072, 93.54466273668365, 76.12060282132184, 92.36930224324705, 75.66662139282388, 85.54052056909646, 85.88717082174902, 71.18253933756127, 93.55715261481842, 87.55834904535742, 88.20898900942157, 82.49984215105906, 86.73340244436925, 98.91401886134055, 91.78159393255149, 97.65682005375692, 79.6814021822551, 86.79197852025422, 74.7291130061753, 84.90022928147609, 78.44691024065088, 75.25302103335747, 89.02239926519266, 90.8772944228988, 86.85528215742872, 82.03449356128174, 88.74327970967913, 94.93622784154351, 90.69704169460402, 92.89817478910047, 75.18737309530204, 79.75769829772517, 76.75782801690029, 81.20939483464758, 82.70231666076302, 70.25823875747565, 95.31004754530538, 93.50384918046704, 89.2076893220656, 82.03496737086074, 86.50686873924782, 89.64722620538191, 90.83628502274105, 96.99916485303345, 75.96604247636829, 88.71362166595802, 73.46406442319231, 85.48730571386363, 81.51829517801328, 74.71196803172545, 91.78624951659359, 87.6802254820758, 86.86131137172177, 79.92100308463156, 84.3471653386693, 95.75800861886157, 88.36533421946842, 93.52783373808934, 69.45442734256889, 90.70299161651336, 73.76661134838521, 84.39373506047103, 64.8031889470513, 75.07214887030491, 88.3139501961549, 89.49840139180047, 84.65139190577065, 80.04965213200448, 88.77565395452686, 91.2637827109901, 82.9926949331452, 98.88254510271494], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.71457666531583, "mean_inference_ms": 8.41205945012376, "mean_action_processing_ms": 0.5749041314784196, "mean_env_wait_ms": 24.066130001937054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049063682556152344, "StateBufferConnector_ms": 0.028516292572021484, "ViewRequirementAgentConnector_ms": 0.9644043445587158}}, "episode_reward_max": 100.33788246217084, "episode_reward_min": 64.8031889470513, "episode_reward_mean": 85.61899811538184, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [94.36188316460594, 97.42085461434493, 77.8690409639148, 92.27005349853582, 78.59520652652557, 83.5263553182595, 84.180267361214, 73.77965317563051, 94.66589494289957, 90.91403065714591, 85.27662341505048, 76.02492700784225, 91.6903011161081, 98.17242901154498, 88.87305343933072, 100.33788246217084, 74.86584041068778, 90.09926462021505, 78.78910920484454, 84.90473504399748, 85.03310156322343, 72.9994717119394, 94.67475504795927, 88.14614291302553, 90.61248326083586, 79.10945362972654, 87.9921244339158, 93.75904387002072, 89.21884113806072, 93.54466273668365, 76.12060282132184, 92.36930224324705, 75.66662139282388, 85.54052056909646, 85.88717082174902, 71.18253933756127, 93.55715261481842, 87.55834904535742, 88.20898900942157, 82.49984215105906, 86.73340244436925, 98.91401886134055, 91.78159393255149, 97.65682005375692, 79.6814021822551, 86.79197852025422, 74.7291130061753, 84.90022928147609, 78.44691024065088, 75.25302103335747, 89.02239926519266, 90.8772944228988, 86.85528215742872, 82.03449356128174, 88.74327970967913, 94.93622784154351, 90.69704169460402, 92.89817478910047, 75.18737309530204, 79.75769829772517, 76.75782801690029, 81.20939483464758, 82.70231666076302, 70.25823875747565, 95.31004754530538, 93.50384918046704, 89.2076893220656, 82.03496737086074, 86.50686873924782, 89.64722620538191, 90.83628502274105, 96.99916485303345, 75.96604247636829, 88.71362166595802, 73.46406442319231, 85.48730571386363, 81.51829517801328, 74.71196803172545, 91.78624951659359, 87.6802254820758, 86.86131137172177, 79.92100308463156, 84.3471653386693, 95.75800861886157, 88.36533421946842, 93.52783373808934, 69.45442734256889, 90.70299161651336, 73.76661134838521, 84.39373506047103, 64.8031889470513, 75.07214887030491, 88.3139501961549, 89.49840139180047, 84.65139190577065, 80.04965213200448, 88.77565395452686, 91.2637827109901, 82.9926949331452, 98.88254510271494], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.71457666531583, "mean_inference_ms": 8.41205945012376, "mean_action_processing_ms": 0.5749041314784196, "mean_env_wait_ms": 24.066130001937054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.049063682556152344, "StateBufferConnector_ms": 0.028516292572021484, "ViewRequirementAgentConnector_ms": 0.9644043445587158}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2386978, "num_agent_steps_trained": 2386978, "num_env_steps_sampled": 2386978, "num_env_steps_trained": 2386978, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 265.85549283787844, "num_env_steps_trained_throughput_per_sec": 265.85549283787844, "timesteps_total": 2386978, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2386978, "timers": {"training_iteration_time_ms": 59202.607, "sample_time_ms": 44144.474, "load_time_ms": 1950.129, "load_throughput": 8018.956, "learn_time_ms": 12528.007, "learn_throughput": 1248.243, "synch_weights_time_ms": 455.444}, "counters": {"num_env_steps_sampled": 2386978, "num_env_steps_trained": 2386978, "num_agent_steps_sampled": 2386978, "num_agent_steps_trained": 2386978}, "done": false, "episodes_total": 2425, "training_iteration": 173, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-21-37", "timestamp": 1749309697, "time_this_iter_s": 58.83742713928223, "time_total_s": 9961.52401304245, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 9961.52401304245, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 77.36567164179105, "ram_util_percent": 60.525373134328355, "gpu_util_percent0": 0.08358208955223881, "vram_util_percent0": 0.8409830729166666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.03125, "cur_lr": 7.613021999999999e-05, "total_loss": -0.05534859250214967, "policy_loss": -0.011891019235957753, "vf_loss": 0.011727612873285331, "vf_explained_var": 0.9798295786164024, "kl": 0.018636795215828915, "entropy": 16.289679017500443, "entropy_coeff": 0.002919533}, "model": {}, "num_grad_updates_lifetime": 84375.5, "diff_num_grad_updates_vs_sampler_policy": 274.5}}, "num_env_steps_sampled": 2402616, "num_env_steps_trained": 2402616, "num_agent_steps_sampled": 2402616, "num_agent_steps_trained": 2402616}, "sampler_results": {"episode_reward_max": 100.33788246217084, "episode_reward_min": 64.8031889470513, "episode_reward_mean": 85.29592846521423, "episode_len_mean": 1117.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [88.87305343933072, 100.33788246217084, 74.86584041068778, 90.09926462021505, 78.78910920484454, 84.90473504399748, 85.03310156322343, 72.9994717119394, 94.67475504795927, 88.14614291302553, 90.61248326083586, 79.10945362972654, 87.9921244339158, 93.75904387002072, 89.21884113806072, 93.54466273668365, 76.12060282132184, 92.36930224324705, 75.66662139282388, 85.54052056909646, 85.88717082174902, 71.18253933756127, 93.55715261481842, 87.55834904535742, 88.20898900942157, 82.49984215105906, 86.73340244436925, 98.91401886134055, 91.78159393255149, 97.65682005375692, 79.6814021822551, 86.79197852025422, 74.7291130061753, 84.90022928147609, 78.44691024065088, 75.25302103335747, 89.02239926519266, 90.8772944228988, 86.85528215742872, 82.03449356128174, 88.74327970967913, 94.93622784154351, 90.69704169460402, 92.89817478910047, 75.18737309530204, 79.75769829772517, 76.75782801690029, 81.20939483464758, 82.70231666076302, 70.25823875747565, 95.31004754530538, 93.50384918046704, 89.2076893220656, 82.03496737086074, 86.50686873924782, 89.64722620538191, 90.83628502274105, 96.99916485303345, 75.96604247636829, 88.71362166595802, 73.46406442319231, 85.48730571386363, 81.51829517801328, 74.71196803172545, 91.78624951659359, 87.6802254820758, 86.86131137172177, 79.92100308463156, 84.3471653386693, 95.75800861886157, 88.36533421946842, 93.52783373808934, 69.45442734256889, 90.70299161651336, 73.76661134838521, 84.39373506047103, 64.8031889470513, 75.07214887030491, 88.3139501961549, 89.49840139180047, 84.65139190577065, 80.04965213200448, 88.77565395452686, 91.2637827109901, 82.9926949331452, 98.88254510271494, 74.51147527511418, 87.0450964136778, 79.87434681915231, 81.68055420664408, 81.7611569597882, 71.6924362750078, 91.94043555975863, 87.82519473205971, 86.55608165344319, 82.00024601398164, 88.76914483911484, 94.90346040944894, 83.21413657497796, 94.66679002469374], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.713911901187213, "mean_inference_ms": 8.41393094313255, "mean_action_processing_ms": 0.5751851027424767, "mean_env_wait_ms": 24.077655601973728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04683256149291992, "StateBufferConnector_ms": 0.029284000396728516, "ViewRequirementAgentConnector_ms": 0.9731431007385254}}, "episode_reward_max": 100.33788246217084, "episode_reward_min": 64.8031889470513, "episode_reward_mean": 85.29592846521423, "episode_len_mean": 1117.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [88.87305343933072, 100.33788246217084, 74.86584041068778, 90.09926462021505, 78.78910920484454, 84.90473504399748, 85.03310156322343, 72.9994717119394, 94.67475504795927, 88.14614291302553, 90.61248326083586, 79.10945362972654, 87.9921244339158, 93.75904387002072, 89.21884113806072, 93.54466273668365, 76.12060282132184, 92.36930224324705, 75.66662139282388, 85.54052056909646, 85.88717082174902, 71.18253933756127, 93.55715261481842, 87.55834904535742, 88.20898900942157, 82.49984215105906, 86.73340244436925, 98.91401886134055, 91.78159393255149, 97.65682005375692, 79.6814021822551, 86.79197852025422, 74.7291130061753, 84.90022928147609, 78.44691024065088, 75.25302103335747, 89.02239926519266, 90.8772944228988, 86.85528215742872, 82.03449356128174, 88.74327970967913, 94.93622784154351, 90.69704169460402, 92.89817478910047, 75.18737309530204, 79.75769829772517, 76.75782801690029, 81.20939483464758, 82.70231666076302, 70.25823875747565, 95.31004754530538, 93.50384918046704, 89.2076893220656, 82.03496737086074, 86.50686873924782, 89.64722620538191, 90.83628502274105, 96.99916485303345, 75.96604247636829, 88.71362166595802, 73.46406442319231, 85.48730571386363, 81.51829517801328, 74.71196803172545, 91.78624951659359, 87.6802254820758, 86.86131137172177, 79.92100308463156, 84.3471653386693, 95.75800861886157, 88.36533421946842, 93.52783373808934, 69.45442734256889, 90.70299161651336, 73.76661134838521, 84.39373506047103, 64.8031889470513, 75.07214887030491, 88.3139501961549, 89.49840139180047, 84.65139190577065, 80.04965213200448, 88.77565395452686, 91.2637827109901, 82.9926949331452, 98.88254510271494, 74.51147527511418, 87.0450964136778, 79.87434681915231, 81.68055420664408, 81.7611569597882, 71.6924362750078, 91.94043555975863, 87.82519473205971, 86.55608165344319, 82.00024601398164, 88.76914483911484, 94.90346040944894, 83.21413657497796, 94.66679002469374], "episode_lengths": [1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117, 1117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.713911901187213, "mean_inference_ms": 8.41393094313255, "mean_action_processing_ms": 0.5751851027424767, "mean_env_wait_ms": 24.077655601973728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04683256149291992, "StateBufferConnector_ms": 0.029284000396728516, "ViewRequirementAgentConnector_ms": 0.9731431007385254}, "num_healthy_workers": 14, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2402616, "num_agent_steps_trained": 2402616, "num_env_steps_sampled": 2402616, "num_env_steps_trained": 2402616, "num_env_steps_sampled_this_iter": 15638, "num_env_steps_trained_this_iter": 15638, "num_env_steps_sampled_throughput_per_sec": 263.23508189242347, "num_env_steps_trained_throughput_per_sec": 263.23508189242347, "timesteps_total": 2402616, "num_steps_trained_this_iter": 15638, "agent_timesteps_total": 2402616, "timers": {"training_iteration_time_ms": 59360.766, "sample_time_ms": 44226.863, "load_time_ms": 1993.259, "load_throughput": 7845.444, "learn_time_ms": 12531.132, "learn_throughput": 1247.932, "synch_weights_time_ms": 485.065}, "counters": {"num_env_steps_sampled": 2402616, "num_env_steps_trained": 2402616, "num_agent_steps_sampled": 2402616, "num_agent_steps_trained": 2402616}, "done": false, "episodes_total": 2439, "training_iteration": 174, "trial_id": "b7a4b_00000", "date": "2025-06-07_17-22-36", "timestamp": 1749309756, "time_this_iter_s": 59.43385434150696, "time_total_s": 10020.957867383957, "pid": 129224, "hostname": "Marko-G14", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "trade_env_ray_portfolio", "env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_portfolio_dataset_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\train_raw_ohlcv_100_1d_NewVal2.npy", "states": null, "mode": "train", "leverage": 5, "input_length": 100, "market_fee": 0.0005, "limit_fee": 0.0002, "slippage_mean": 1e-06, "slippage_std": 5e-05, "initial_balance": 1000, "total_episodes": 1, "episode_length": 180, "max_risk": 0.02, "min_risk": 0.001, "min_profit": 0, "limit_bounds": false, "margin_mode": "cross", "predict_leverage": false, "ppo_mode": true, "full_invest": true}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.97, "lr": 0.0001, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 1680, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": true, "fcnet_hiddens": [128, 128], "fcnet_activation": "relu", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 100, "lstm_cell_size": 128, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": true, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x0000018F4FC57640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 10, "evaluation_duration": 5, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180, "evaluation_parallel_to_training": false, "evaluation_config": {"env_config": {"data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_portfolio_data_100_1d_normalized_states_add_macro_and_lunarcrush_close_NewVal2_17", "raw_data_path": "C:\\Users\\marko\\Marko_documents\\Etudes\\Master_2\u00e8me\\2\u00e8me_semestre\\Master_thesis\\Deep_RL_PPO_LSTM\\val_raw_ohlcv_100_1d_NewVal2.npy", "mode": "val", "limit_bounds": false}, "explore": false, "num_gpus": 0}, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": [[0, 0.0001], [5000000.0, 5e-05], [10000000.0, 2e-05], [15000000.0, 1e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.5, "kl_target": 0.015, "sgd_minibatch_size": 280, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": false, "vf_loss_coeff": 0.3, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [1000000.0, 0.005], [3000000.0, 0.002]], "clip_param": 0.1, "vf_clip_param": 0.5, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 14}, "time_since_restore": 10020.957867383957, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 77.53529411764708, "ram_util_percent": 60.8735294117647, "gpu_util_percent0": 0.08897058823529413, "vram_util_percent0": 0.8409830729166666}}
